var VM=e=>{throw TypeError(e)};var i_=(e,t,n)=>t.has(e)||VM("Cannot "+n);var ne=(e,t,n)=>(i_(e,t,"read from private field"),n?n.call(e):t.get(e)),rt=(e,t,n)=>t.has(e)?VM("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),We=(e,t,n,r)=>(i_(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),zt=(e,t,n)=>(i_(e,t,"access private method"),n);var iw=(e,t,n,r)=>({set _(a){We(e,t,a,n)},get _(){return ne(e,t,r)}});function see(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(r,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();var Ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function VE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function iee(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),n}var a4={exports:{}},uN={},s4={exports:{}},Kt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bv=Symbol.for("react.element"),oee=Symbol.for("react.portal"),lee=Symbol.for("react.fragment"),uee=Symbol.for("react.strict_mode"),cee=Symbol.for("react.profiler"),dee=Symbol.for("react.provider"),hee=Symbol.for("react.context"),pee=Symbol.for("react.forward_ref"),fee=Symbol.for("react.suspense"),mee=Symbol.for("react.memo"),gee=Symbol.for("react.lazy"),HM=Symbol.iterator;function yee(e){return e===null||typeof e!="object"?null:(e=HM&&e[HM]||e["@@iterator"],typeof e=="function"?e:null)}var i4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o4=Object.assign,l4={};function Cm(e,t,n){this.props=e,this.context=t,this.refs=l4,this.updater=n||i4}Cm.prototype.isReactComponent={};Cm.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Cm.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function u4(){}u4.prototype=Cm.prototype;function HE(e,t,n){this.props=e,this.context=t,this.refs=l4,this.updater=n||i4}var GE=HE.prototype=new u4;GE.constructor=HE;o4(GE,Cm.prototype);GE.isPureReactComponent=!0;var GM=Array.isArray,c4=Object.prototype.hasOwnProperty,qE={current:null},d4={key:!0,ref:!0,__self:!0,__source:!0};function h4(e,t,n){var r,a={},s=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)c4.call(t,r)&&!d4.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:bv,type:e,key:s,ref:i,props:a,_owner:qE.current}}function xee(e,t){return{$$typeof:bv,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function KE(e){return typeof e=="object"&&e!==null&&e.$$typeof===bv}function vee(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var qM=/\/+/g;function o_(e,t){return typeof e=="object"&&e!==null&&e.key!=null?vee(""+e.key):t.toString(36)}function n0(e,t,n,r,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case bv:case oee:i=!0}}if(i)return i=e,a=a(i),e=r===""?"."+o_(i,0):r,GM(a)?(n="",e!=null&&(n=e.replace(qM,"$&/")+"/"),n0(a,t,n,"",function(c){return c})):a!=null&&(KE(a)&&(a=xee(a,n+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(qM,"$&/")+"/")+e)),t.push(a)),1;if(i=0,r=r===""?".":r+":",GM(e))for(var o=0;o<e.length;o++){s=e[o];var l=r+o_(s,o);i+=n0(s,t,n,l,a)}else if(l=yee(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=r+o_(s,o++),i+=n0(s,t,n,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function ow(e,t,n){if(e==null)return e;var r=[],a=0;return n0(e,r,"","",function(s){return t.call(n,s,a++)}),r}function bee(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ga={current:null},r0={transition:null},wee={ReactCurrentDispatcher:Ga,ReactCurrentBatchConfig:r0,ReactCurrentOwner:qE};function p4(){throw Error("act(...) is not supported in production builds of React.")}Kt.Children={map:ow,forEach:function(e,t,n){ow(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ow(e,function(){t++}),t},toArray:function(e){return ow(e,function(t){return t})||[]},only:function(e){if(!KE(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Kt.Component=Cm;Kt.Fragment=lee;Kt.Profiler=cee;Kt.PureComponent=HE;Kt.StrictMode=uee;Kt.Suspense=fee;Kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wee;Kt.act=p4;Kt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=o4({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=qE.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)c4.call(t,l)&&!d4.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:bv,type:e.type,key:a,ref:s,props:r,_owner:i}};Kt.createContext=function(e){return e={$$typeof:hee,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:dee,_context:e},e.Consumer=e};Kt.createElement=h4;Kt.createFactory=function(e){var t=h4.bind(null,e);return t.type=e,t};Kt.createRef=function(){return{current:null}};Kt.forwardRef=function(e){return{$$typeof:pee,render:e}};Kt.isValidElement=KE;Kt.lazy=function(e){return{$$typeof:gee,_payload:{_status:-1,_result:e},_init:bee}};Kt.memo=function(e,t){return{$$typeof:mee,type:e,compare:t===void 0?null:t}};Kt.startTransition=function(e){var t=r0.transition;r0.transition={};try{e()}finally{r0.transition=t}};Kt.unstable_act=p4;Kt.useCallback=function(e,t){return Ga.current.useCallback(e,t)};Kt.useContext=function(e){return Ga.current.useContext(e)};Kt.useDebugValue=function(){};Kt.useDeferredValue=function(e){return Ga.current.useDeferredValue(e)};Kt.useEffect=function(e,t){return Ga.current.useEffect(e,t)};Kt.useId=function(){return Ga.current.useId()};Kt.useImperativeHandle=function(e,t,n){return Ga.current.useImperativeHandle(e,t,n)};Kt.useInsertionEffect=function(e,t){return Ga.current.useInsertionEffect(e,t)};Kt.useLayoutEffect=function(e,t){return Ga.current.useLayoutEffect(e,t)};Kt.useMemo=function(e,t){return Ga.current.useMemo(e,t)};Kt.useReducer=function(e,t,n){return Ga.current.useReducer(e,t,n)};Kt.useRef=function(e){return Ga.current.useRef(e)};Kt.useState=function(e){return Ga.current.useState(e)};Kt.useSyncExternalStore=function(e,t,n){return Ga.current.useSyncExternalStore(e,t,n)};Kt.useTransition=function(){return Ga.current.useTransition()};Kt.version="18.3.1";s4.exports=Kt;var N=s4.exports;const $e=VE(N),QE=see({__proto__:null,default:$e},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nee=N,kee=Symbol.for("react.element"),See=Symbol.for("react.fragment"),_ee=Object.prototype.hasOwnProperty,Cee=Nee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Iee={key:!0,ref:!0,__self:!0,__source:!0};function f4(e,t,n){var r,a={},s=null,i=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)_ee.call(t,r)&&!Iee.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:kee,type:e,key:s,ref:i,props:a,_owner:Cee.current}}uN.Fragment=See;uN.jsx=f4;uN.jsxs=f4;a4.exports=uN;var d=a4.exports,m4={exports:{}},Vs={},g4={exports:{}},y4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,R){var V=D.length;D.push(R);e:for(;0<V;){var G=V-1>>>1,W=D[G];if(0<a(W,R))D[G]=R,D[V]=W,V=G;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var R=D[0],V=D.pop();if(V!==R){D[0]=V;e:for(var G=0,W=D.length,B=W>>>1;G<B;){var Q=2*(G+1)-1,X=D[Q],pe=Q+1,ie=D[pe];if(0>a(X,V))pe<W&&0>a(ie,X)?(D[G]=ie,D[pe]=V,G=pe):(D[G]=X,D[Q]=V,G=Q);else if(pe<W&&0>a(ie,V))D[G]=ie,D[pe]=V,G=pe;else break e}}return R}function a(D,R){var V=D.sortIndex-R.sortIndex;return V!==0?V:D.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,h=null,p=3,f=!1,g=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(D){for(var R=n(c);R!==null;){if(R.callback===null)r(c);else if(R.startTime<=D)r(c),R.sortIndex=R.expirationTime,t(l,R);else break;R=n(c)}}function w(D){if(m=!1,b(D),!g)if(n(l)!==null)g=!0,O(k);else{var R=n(c);R!==null&&F(w,R.startTime-D)}}function k(D,R){g=!1,m&&(m=!1,x(S),S=-1),f=!0;var V=p;try{for(b(R),h=n(l);h!==null&&(!(h.expirationTime>R)||D&&!$());){var G=h.callback;if(typeof G=="function"){h.callback=null,p=h.priorityLevel;var W=G(h.expirationTime<=R);R=e.unstable_now(),typeof W=="function"?h.callback=W:h===n(l)&&r(l),b(R)}else r(l);h=n(l)}if(h!==null)var B=!0;else{var Q=n(c);Q!==null&&F(w,Q.startTime-R),B=!1}return B}finally{h=null,p=V,f=!1}}var I=!1,C=null,S=-1,E=5,T=-1;function $(){return!(e.unstable_now()-T<E)}function _(){if(C!==null){var D=e.unstable_now();T=D;var R=!0;try{R=C(!0,D)}finally{R?M():(I=!1,C=null)}}else I=!1}var M;if(typeof v=="function")M=function(){v(_)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,U=L.port2;L.port1.onmessage=_,M=function(){U.postMessage(null)}}else M=function(){y(_,0)};function O(D){C=D,I||(I=!0,M())}function F(D,R){S=y(function(){D(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){g||f||(g=!0,O(k))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(D){switch(p){case 1:case 2:case 3:var R=3;break;default:R=p}var V=p;p=R;try{return D()}finally{p=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,R){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var V=p;p=D;try{return R()}finally{p=V}},e.unstable_scheduleCallback=function(D,R,V){var G=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?G+V:G):V=G,D){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=V+W,D={id:u++,callback:R,priorityLevel:D,startTime:V,expirationTime:W,sortIndex:-1},V>G?(D.sortIndex=V,t(c,D),n(l)===null&&D===n(c)&&(m?(x(S),S=-1):m=!0,F(w,V-G))):(D.sortIndex=W,t(l,D),g||f||(g=!0,O(k))),D},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(D){var R=p;return function(){var V=p;p=R;try{return D.apply(this,arguments)}finally{p=V}}}})(y4);g4.exports=y4;var Eee=g4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tee=N,zs=Eee;function Ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var x4=new Set,Nx={};function Jd(e,t){Gf(e,t),Gf(e+"Capture",t)}function Gf(e,t){for(Nx[e]=t,e=0;e<t.length;e++)x4.add(t[e])}var gl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),MC=Object.prototype.hasOwnProperty,jee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,KM={},QM={};function Aee(e){return MC.call(QM,e)?!0:MC.call(KM,e)?!1:jee.test(e)?QM[e]=!0:(KM[e]=!0,!1)}function $ee(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ree(e,t,n,r){if(t===null||typeof t>"u"||$ee(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qa(e,t,n,r,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var ea={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ea[e]=new qa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ea[t]=new qa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ea[e]=new qa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ea[e]=new qa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ea[e]=new qa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ea[e]=new qa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ea[e]=new qa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ea[e]=new qa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ea[e]=new qa(e,5,!1,e.toLowerCase(),null,!1,!1)});var XE=/[\-:]([a-z])/g;function YE(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(XE,YE);ea[t]=new qa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(XE,YE);ea[t]=new qa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(XE,YE);ea[t]=new qa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ea[e]=new qa(e,1,!1,e.toLowerCase(),null,!1,!1)});ea.xlinkHref=new qa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ea[e]=new qa(e,1,!1,e.toLowerCase(),null,!0,!0)});function JE(e,t,n,r){var a=ea.hasOwnProperty(t)?ea[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ree(t,n,a,r)&&(n=null),r||a===null?Aee(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Sl=Tee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lw=Symbol.for("react.element"),af=Symbol.for("react.portal"),sf=Symbol.for("react.fragment"),ZE=Symbol.for("react.strict_mode"),OC=Symbol.for("react.profiler"),v4=Symbol.for("react.provider"),b4=Symbol.for("react.context"),eT=Symbol.for("react.forward_ref"),FC=Symbol.for("react.suspense"),PC=Symbol.for("react.suspense_list"),tT=Symbol.for("react.memo"),Kl=Symbol.for("react.lazy"),w4=Symbol.for("react.offscreen"),XM=Symbol.iterator;function vy(e){return e===null||typeof e!="object"?null:(e=XM&&e[XM]||e["@@iterator"],typeof e=="function"?e:null)}var Jn=Object.assign,l_;function zy(e){if(l_===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);l_=t&&t[1]||""}return`
`+l_+e}var u_=!1;function c_(e,t){if(!e||u_)return"";u_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=r.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{u_=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?zy(e):""}function Dee(e){switch(e.tag){case 5:return zy(e.type);case 16:return zy("Lazy");case 13:return zy("Suspense");case 19:return zy("SuspenseList");case 0:case 2:case 15:return e=c_(e.type,!1),e;case 11:return e=c_(e.type.render,!1),e;case 1:return e=c_(e.type,!0),e;default:return""}}function LC(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case sf:return"Fragment";case af:return"Portal";case OC:return"Profiler";case ZE:return"StrictMode";case FC:return"Suspense";case PC:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case b4:return(e.displayName||"Context")+".Consumer";case v4:return(e._context.displayName||"Context")+".Provider";case eT:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tT:return t=e.displayName||null,t!==null?t:LC(e.type)||"Memo";case Kl:t=e._payload,e=e._init;try{return LC(e(t))}catch{}}return null}function Mee(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return LC(t);case 8:return t===ZE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Du(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function N4(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Oee(e){var t=N4(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){r=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function uw(e){e._valueTracker||(e._valueTracker=Oee(e))}function k4(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=N4(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function O0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zC(e,t){var n=t.checked;return Jn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function YM(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Du(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function S4(e,t){t=t.checked,t!=null&&JE(e,"checked",t,!1)}function BC(e,t){S4(e,t);var n=Du(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?UC(e,t.type,n):t.hasOwnProperty("defaultValue")&&UC(e,t.type,Du(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function JM(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function UC(e,t,n){(t!=="number"||O0(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var By=Array.isArray;function vf(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Du(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function WC(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ie(91));return Jn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ZM(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Ie(92));if(By(n)){if(1<n.length)throw Error(Ie(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Du(n)}}function _4(e,t){var n=Du(t.value),r=Du(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function eO(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function C4(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function VC(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?C4(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var cw,I4=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(cw=cw||document.createElement("div"),cw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=cw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function kx(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ax={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fee=["Webkit","ms","Moz","O"];Object.keys(ax).forEach(function(e){Fee.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ax[t]=ax[e]})});function E4(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ax.hasOwnProperty(e)&&ax[e]?(""+t).trim():t+"px"}function T4(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=E4(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var Pee=Jn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function HC(e,t){if(t){if(Pee[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ie(62))}}function GC(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qC=null;function nT(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var KC=null,bf=null,wf=null;function tO(e){if(e=kv(e)){if(typeof KC!="function")throw Error(Ie(280));var t=e.stateNode;t&&(t=fN(t),KC(e.stateNode,e.type,t))}}function j4(e){bf?wf?wf.push(e):wf=[e]:bf=e}function A4(){if(bf){var e=bf,t=wf;if(wf=bf=null,tO(e),t)for(e=0;e<t.length;e++)tO(t[e])}}function $4(e,t){return e(t)}function R4(){}var d_=!1;function D4(e,t,n){if(d_)return e(t,n);d_=!0;try{return $4(e,t,n)}finally{d_=!1,(bf!==null||wf!==null)&&(R4(),A4())}}function Sx(e,t){var n=e.stateNode;if(n===null)return null;var r=fN(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Ie(231,t,typeof n));return n}var QC=!1;if(gl)try{var by={};Object.defineProperty(by,"passive",{get:function(){QC=!0}}),window.addEventListener("test",by,by),window.removeEventListener("test",by,by)}catch{QC=!1}function Lee(e,t,n,r,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var sx=!1,F0=null,P0=!1,XC=null,zee={onError:function(e){sx=!0,F0=e}};function Bee(e,t,n,r,a,s,i,o,l){sx=!1,F0=null,Lee.apply(zee,arguments)}function Uee(e,t,n,r,a,s,i,o,l){if(Bee.apply(this,arguments),sx){if(sx){var c=F0;sx=!1,F0=null}else throw Error(Ie(198));P0||(P0=!0,XC=c)}}function Zd(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function M4(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function nO(e){if(Zd(e)!==e)throw Error(Ie(188))}function Wee(e){var t=e.alternate;if(!t){if(t=Zd(e),t===null)throw Error(Ie(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var s=a.alternate;if(s===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return nO(a),e;if(s===r)return nO(a),t;s=s.sibling}throw Error(Ie(188))}if(n.return!==r.return)n=a,r=s;else{for(var i=!1,o=a.child;o;){if(o===n){i=!0,n=a,r=s;break}if(o===r){i=!0,r=a,n=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===n){i=!0,n=s,r=a;break}if(o===r){i=!0,r=s,n=a;break}o=o.sibling}if(!i)throw Error(Ie(189))}}if(n.alternate!==r)throw Error(Ie(190))}if(n.tag!==3)throw Error(Ie(188));return n.stateNode.current===n?e:t}function O4(e){return e=Wee(e),e!==null?F4(e):null}function F4(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=F4(e);if(t!==null)return t;e=e.sibling}return null}var P4=zs.unstable_scheduleCallback,rO=zs.unstable_cancelCallback,Vee=zs.unstable_shouldYield,Hee=zs.unstable_requestPaint,cr=zs.unstable_now,Gee=zs.unstable_getCurrentPriorityLevel,rT=zs.unstable_ImmediatePriority,L4=zs.unstable_UserBlockingPriority,L0=zs.unstable_NormalPriority,qee=zs.unstable_LowPriority,z4=zs.unstable_IdlePriority,cN=null,vo=null;function Kee(e){if(vo&&typeof vo.onCommitFiberRoot=="function")try{vo.onCommitFiberRoot(cN,e,void 0,(e.current.flags&128)===128)}catch{}}var Ti=Math.clz32?Math.clz32:Yee,Qee=Math.log,Xee=Math.LN2;function Yee(e){return e>>>=0,e===0?32:31-(Qee(e)/Xee|0)|0}var dw=64,hw=4194304;function Uy(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function z0(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,s=e.pingedLanes,i=n&268435455;if(i!==0){var o=i&~a;o!==0?r=Uy(o):(s&=i,s!==0&&(r=Uy(s)))}else i=n&~a,i!==0?r=Uy(i):s!==0&&(r=Uy(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ti(t),a=1<<n,r|=e[n],t&=~a;return r}function Jee(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zee(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Ti(s),o=1<<i,l=a[i];l===-1?(!(o&n)||o&r)&&(a[i]=Jee(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function YC(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function B4(){var e=dw;return dw<<=1,!(dw&4194240)&&(dw=64),e}function h_(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wv(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ti(t),e[t]=n}function ete(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Ti(n),s=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~s}}function aT(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ti(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bn=0;function U4(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var W4,sT,V4,H4,G4,JC=!1,pw=[],bu=null,wu=null,Nu=null,_x=new Map,Cx=new Map,Zl=[],tte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function aO(e,t){switch(e){case"focusin":case"focusout":bu=null;break;case"dragenter":case"dragleave":wu=null;break;case"mouseover":case"mouseout":Nu=null;break;case"pointerover":case"pointerout":_x.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cx.delete(t.pointerId)}}function wy(e,t,n,r,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},t!==null&&(t=kv(t),t!==null&&sT(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function nte(e,t,n,r,a){switch(t){case"focusin":return bu=wy(bu,e,t,n,r,a),!0;case"dragenter":return wu=wy(wu,e,t,n,r,a),!0;case"mouseover":return Nu=wy(Nu,e,t,n,r,a),!0;case"pointerover":var s=a.pointerId;return _x.set(s,wy(_x.get(s)||null,e,t,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,Cx.set(s,wy(Cx.get(s)||null,e,t,n,r,a)),!0}return!1}function q4(e){var t=Kc(e.target);if(t!==null){var n=Zd(t);if(n!==null){if(t=n.tag,t===13){if(t=M4(n),t!==null){e.blockedOn=t,G4(e.priority,function(){V4(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function a0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ZC(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);qC=r,n.target.dispatchEvent(r),qC=null}else return t=kv(n),t!==null&&sT(t),e.blockedOn=n,!1;t.shift()}return!0}function sO(e,t,n){a0(e)&&n.delete(t)}function rte(){JC=!1,bu!==null&&a0(bu)&&(bu=null),wu!==null&&a0(wu)&&(wu=null),Nu!==null&&a0(Nu)&&(Nu=null),_x.forEach(sO),Cx.forEach(sO)}function Ny(e,t){e.blockedOn===t&&(e.blockedOn=null,JC||(JC=!0,zs.unstable_scheduleCallback(zs.unstable_NormalPriority,rte)))}function Ix(e){function t(a){return Ny(a,e)}if(0<pw.length){Ny(pw[0],e);for(var n=1;n<pw.length;n++){var r=pw[n];r.blockedOn===e&&(r.blockedOn=null)}}for(bu!==null&&Ny(bu,e),wu!==null&&Ny(wu,e),Nu!==null&&Ny(Nu,e),_x.forEach(t),Cx.forEach(t),n=0;n<Zl.length;n++)r=Zl[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Zl.length&&(n=Zl[0],n.blockedOn===null);)q4(n),n.blockedOn===null&&Zl.shift()}var Nf=Sl.ReactCurrentBatchConfig,B0=!0;function ate(e,t,n,r){var a=bn,s=Nf.transition;Nf.transition=null;try{bn=1,iT(e,t,n,r)}finally{bn=a,Nf.transition=s}}function ste(e,t,n,r){var a=bn,s=Nf.transition;Nf.transition=null;try{bn=4,iT(e,t,n,r)}finally{bn=a,Nf.transition=s}}function iT(e,t,n,r){if(B0){var a=ZC(e,t,n,r);if(a===null)N_(e,t,r,U0,n),aO(e,r);else if(nte(a,e,t,n,r))r.stopPropagation();else if(aO(e,r),t&4&&-1<tte.indexOf(e)){for(;a!==null;){var s=kv(a);if(s!==null&&W4(s),s=ZC(e,t,n,r),s===null&&N_(e,t,r,U0,n),s===a)break;a=s}a!==null&&r.stopPropagation()}else N_(e,t,r,null,n)}}var U0=null;function ZC(e,t,n,r){if(U0=null,e=nT(r),e=Kc(e),e!==null)if(t=Zd(e),t===null)e=null;else if(n=t.tag,n===13){if(e=M4(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return U0=e,null}function K4(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gee()){case rT:return 1;case L4:return 4;case L0:case qee:return 16;case z4:return 536870912;default:return 16}default:return 16}}var pu=null,oT=null,s0=null;function Q4(){if(s0)return s0;var e,t=oT,n=t.length,r,a="value"in pu?pu.value:pu.textContent,s=a.length;for(e=0;e<n&&t[e]===a[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===a[s-r];r++);return s0=a.slice(e,1<r?1-r:void 0)}function i0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function fw(){return!0}function iO(){return!1}function Hs(e){function t(n,r,a,s,i){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?fw:iO,this.isPropagationStopped=iO,this}return Jn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fw)},persist:function(){},isPersistent:fw}),t}var Im={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lT=Hs(Im),Nv=Jn({},Im,{view:0,detail:0}),ite=Hs(Nv),p_,f_,ky,dN=Jn({},Nv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uT,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ky&&(ky&&e.type==="mousemove"?(p_=e.screenX-ky.screenX,f_=e.screenY-ky.screenY):f_=p_=0,ky=e),p_)},movementY:function(e){return"movementY"in e?e.movementY:f_}}),oO=Hs(dN),ote=Jn({},dN,{dataTransfer:0}),lte=Hs(ote),ute=Jn({},Nv,{relatedTarget:0}),m_=Hs(ute),cte=Jn({},Im,{animationName:0,elapsedTime:0,pseudoElement:0}),dte=Hs(cte),hte=Jn({},Im,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pte=Hs(hte),fte=Jn({},Im,{data:0}),lO=Hs(fte),mte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yte={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xte(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=yte[e])?!!t[e]:!1}function uT(){return xte}var vte=Jn({},Nv,{key:function(e){if(e.key){var t=mte[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=i0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gte[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uT,charCode:function(e){return e.type==="keypress"?i0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?i0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),bte=Hs(vte),wte=Jn({},dN,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uO=Hs(wte),Nte=Jn({},Nv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uT}),kte=Hs(Nte),Ste=Jn({},Im,{propertyName:0,elapsedTime:0,pseudoElement:0}),_te=Hs(Ste),Cte=Jn({},dN,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ite=Hs(Cte),Ete=[9,13,27,32],cT=gl&&"CompositionEvent"in window,ix=null;gl&&"documentMode"in document&&(ix=document.documentMode);var Tte=gl&&"TextEvent"in window&&!ix,X4=gl&&(!cT||ix&&8<ix&&11>=ix),cO=" ",dO=!1;function Y4(e,t){switch(e){case"keyup":return Ete.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function J4(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var of=!1;function jte(e,t){switch(e){case"compositionend":return J4(t);case"keypress":return t.which!==32?null:(dO=!0,cO);case"textInput":return e=t.data,e===cO&&dO?null:e;default:return null}}function Ate(e,t){if(of)return e==="compositionend"||!cT&&Y4(e,t)?(e=Q4(),s0=oT=pu=null,of=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return X4&&t.locale!=="ko"?null:t.data;default:return null}}var $te={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hO(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!$te[e.type]:t==="textarea"}function Z4(e,t,n,r){j4(r),t=W0(t,"onChange"),0<t.length&&(n=new lT("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ox=null,Ex=null;function Rte(e){cz(e,0)}function hN(e){var t=cf(e);if(k4(t))return e}function Dte(e,t){if(e==="change")return t}var ez=!1;if(gl){var g_;if(gl){var y_="oninput"in document;if(!y_){var pO=document.createElement("div");pO.setAttribute("oninput","return;"),y_=typeof pO.oninput=="function"}g_=y_}else g_=!1;ez=g_&&(!document.documentMode||9<document.documentMode)}function fO(){ox&&(ox.detachEvent("onpropertychange",tz),Ex=ox=null)}function tz(e){if(e.propertyName==="value"&&hN(Ex)){var t=[];Z4(t,Ex,e,nT(e)),D4(Rte,t)}}function Mte(e,t,n){e==="focusin"?(fO(),ox=t,Ex=n,ox.attachEvent("onpropertychange",tz)):e==="focusout"&&fO()}function Ote(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hN(Ex)}function Fte(e,t){if(e==="click")return hN(t)}function Pte(e,t){if(e==="input"||e==="change")return hN(t)}function Lte(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Oi=typeof Object.is=="function"?Object.is:Lte;function Tx(e,t){if(Oi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!MC.call(t,a)||!Oi(e[a],t[a]))return!1}return!0}function mO(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gO(e,t){var n=mO(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mO(n)}}function nz(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?nz(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function rz(){for(var e=window,t=O0();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=O0(e.document)}return t}function dT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function zte(e){var t=rz(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&nz(n.ownerDocument.documentElement,n)){if(r!==null&&dT(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,s=Math.min(r.start,a);r=r.end===void 0?s:Math.min(r.end,a),!e.extend&&s>r&&(a=r,r=s,s=a),a=gO(n,s);var i=gO(n,r);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Bte=gl&&"documentMode"in document&&11>=document.documentMode,lf=null,e2=null,lx=null,t2=!1;function yO(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;t2||lf==null||lf!==O0(r)||(r=lf,"selectionStart"in r&&dT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),lx&&Tx(lx,r)||(lx=r,r=W0(e2,"onSelect"),0<r.length&&(t=new lT("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=lf)))}function mw(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var uf={animationend:mw("Animation","AnimationEnd"),animationiteration:mw("Animation","AnimationIteration"),animationstart:mw("Animation","AnimationStart"),transitionend:mw("Transition","TransitionEnd")},x_={},az={};gl&&(az=document.createElement("div").style,"AnimationEvent"in window||(delete uf.animationend.animation,delete uf.animationiteration.animation,delete uf.animationstart.animation),"TransitionEvent"in window||delete uf.transitionend.transition);function pN(e){if(x_[e])return x_[e];if(!uf[e])return e;var t=uf[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in az)return x_[e]=t[n];return e}var sz=pN("animationend"),iz=pN("animationiteration"),oz=pN("animationstart"),lz=pN("transitionend"),uz=new Map,xO="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ac(e,t){uz.set(e,t),Jd(t,[e])}for(var v_=0;v_<xO.length;v_++){var b_=xO[v_],Ute=b_.toLowerCase(),Wte=b_[0].toUpperCase()+b_.slice(1);ac(Ute,"on"+Wte)}ac(sz,"onAnimationEnd");ac(iz,"onAnimationIteration");ac(oz,"onAnimationStart");ac("dblclick","onDoubleClick");ac("focusin","onFocus");ac("focusout","onBlur");ac(lz,"onTransitionEnd");Gf("onMouseEnter",["mouseout","mouseover"]);Gf("onMouseLeave",["mouseout","mouseover"]);Gf("onPointerEnter",["pointerout","pointerover"]);Gf("onPointerLeave",["pointerout","pointerover"]);Jd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vte=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wy));function vO(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Uee(r,t,void 0,e),e.currentTarget=null}function cz(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;vO(a,o,c),s=l}else for(i=0;i<r.length;i++){if(o=r[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;vO(a,o,c),s=l}}}if(P0)throw e=XC,P0=!1,XC=null,e}function Dn(e,t){var n=t[i2];n===void 0&&(n=t[i2]=new Set);var r=e+"__bubble";n.has(r)||(dz(t,e,2,!1),n.add(r))}function w_(e,t,n){var r=0;t&&(r|=4),dz(n,e,r,t)}var gw="_reactListening"+Math.random().toString(36).slice(2);function jx(e){if(!e[gw]){e[gw]=!0,x4.forEach(function(n){n!=="selectionchange"&&(Vte.has(n)||w_(n,!1,e),w_(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[gw]||(t[gw]=!0,w_("selectionchange",!1,t))}}function dz(e,t,n,r){switch(K4(t)){case 1:var a=ate;break;case 4:a=ste;break;default:a=iT}n=a.bind(null,t,n,e),a=void 0,!QC||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function N_(e,t,n,r,a){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Kc(o),i===null)return;if(l=i.tag,l===5||l===6){r=s=i;continue e}o=o.parentNode}}r=r.return}D4(function(){var c=s,u=nT(n),h=[];e:{var p=uz.get(e);if(p!==void 0){var f=lT,g=e;switch(e){case"keypress":if(i0(n)===0)break e;case"keydown":case"keyup":f=bte;break;case"focusin":g="focus",f=m_;break;case"focusout":g="blur",f=m_;break;case"beforeblur":case"afterblur":f=m_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=oO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=lte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=kte;break;case sz:case iz:case oz:f=dte;break;case lz:f=_te;break;case"scroll":f=ite;break;case"wheel":f=Ite;break;case"copy":case"cut":case"paste":f=pte;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=uO}var m=(t&4)!==0,y=!m&&e==="scroll",x=m?p!==null?p+"Capture":null:p;m=[];for(var v=c,b;v!==null;){b=v;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,x!==null&&(w=Sx(v,x),w!=null&&m.push(Ax(v,w,b)))),y)break;v=v.return}0<m.length&&(p=new f(p,g,null,n,u),h.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&n!==qC&&(g=n.relatedTarget||n.fromElement)&&(Kc(g)||g[yl]))break e;if((f||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,f?(g=n.relatedTarget||n.toElement,f=c,g=g?Kc(g):null,g!==null&&(y=Zd(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(f=null,g=c),f!==g)){if(m=oO,w="onMouseLeave",x="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=uO,w="onPointerLeave",x="onPointerEnter",v="pointer"),y=f==null?p:cf(f),b=g==null?p:cf(g),p=new m(w,v+"leave",f,n,u),p.target=y,p.relatedTarget=b,w=null,Kc(u)===c&&(m=new m(x,v+"enter",g,n,u),m.target=b,m.relatedTarget=y,w=m),y=w,f&&g)t:{for(m=f,x=g,v=0,b=m;b;b=Lp(b))v++;for(b=0,w=x;w;w=Lp(w))b++;for(;0<v-b;)m=Lp(m),v--;for(;0<b-v;)x=Lp(x),b--;for(;v--;){if(m===x||x!==null&&m===x.alternate)break t;m=Lp(m),x=Lp(x)}m=null}else m=null;f!==null&&bO(h,p,f,m,!1),g!==null&&y!==null&&bO(h,y,g,m,!0)}}e:{if(p=c?cf(c):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var k=Dte;else if(hO(p))if(ez)k=Pte;else{k=Ote;var I=Mte}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=Fte);if(k&&(k=k(e,c))){Z4(h,k,n,u);break e}I&&I(e,p,c),e==="focusout"&&(I=p._wrapperState)&&I.controlled&&p.type==="number"&&UC(p,"number",p.value)}switch(I=c?cf(c):window,e){case"focusin":(hO(I)||I.contentEditable==="true")&&(lf=I,e2=c,lx=null);break;case"focusout":lx=e2=lf=null;break;case"mousedown":t2=!0;break;case"contextmenu":case"mouseup":case"dragend":t2=!1,yO(h,n,u);break;case"selectionchange":if(Bte)break;case"keydown":case"keyup":yO(h,n,u)}var C;if(cT)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else of?Y4(e,n)&&(S="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(X4&&n.locale!=="ko"&&(of||S!=="onCompositionStart"?S==="onCompositionEnd"&&of&&(C=Q4()):(pu=u,oT="value"in pu?pu.value:pu.textContent,of=!0)),I=W0(c,S),0<I.length&&(S=new lO(S,e,null,n,u),h.push({event:S,listeners:I}),C?S.data=C:(C=J4(n),C!==null&&(S.data=C)))),(C=Tte?jte(e,n):Ate(e,n))&&(c=W0(c,"onBeforeInput"),0<c.length&&(u=new lO("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=C))}cz(h,t)})}function Ax(e,t,n){return{instance:e,listener:t,currentTarget:n}}function W0(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Sx(e,n),s!=null&&r.unshift(Ax(e,s,a)),s=Sx(e,t),s!=null&&r.push(Ax(e,s,a))),e=e.return}return r}function Lp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bO(e,t,n,r,a){for(var s=t._reactName,i=[];n!==null&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,a?(l=Sx(n,s),l!=null&&i.unshift(Ax(n,l,o))):a||(l=Sx(n,s),l!=null&&i.push(Ax(n,l,o)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var Hte=/\r\n?/g,Gte=/\u0000|\uFFFD/g;function wO(e){return(typeof e=="string"?e:""+e).replace(Hte,`
`).replace(Gte,"")}function yw(e,t,n){if(t=wO(t),wO(e)!==t&&n)throw Error(Ie(425))}function V0(){}var n2=null,r2=null;function a2(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var s2=typeof setTimeout=="function"?setTimeout:void 0,qte=typeof clearTimeout=="function"?clearTimeout:void 0,NO=typeof Promise=="function"?Promise:void 0,Kte=typeof queueMicrotask=="function"?queueMicrotask:typeof NO<"u"?function(e){return NO.resolve(null).then(e).catch(Qte)}:s2;function Qte(e){setTimeout(function(){throw e})}function k_(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Ix(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ix(t)}function ku(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kO(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Em=Math.random().toString(36).slice(2),ho="__reactFiber$"+Em,$x="__reactProps$"+Em,yl="__reactContainer$"+Em,i2="__reactEvents$"+Em,Xte="__reactListeners$"+Em,Yte="__reactHandles$"+Em;function Kc(e){var t=e[ho];if(t)return t;for(var n=e.parentNode;n;){if(t=n[yl]||n[ho]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=kO(e);e!==null;){if(n=e[ho])return n;e=kO(e)}return t}e=n,n=e.parentNode}return null}function kv(e){return e=e[ho]||e[yl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function cf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ie(33))}function fN(e){return e[$x]||null}var o2=[],df=-1;function sc(e){return{current:e}}function Mn(e){0>df||(e.current=o2[df],o2[df]=null,df--)}function jn(e,t){df++,o2[df]=e.current,e.current=t}var Mu={},ba=sc(Mu),hs=sc(!1),xd=Mu;function qf(e,t){var n=e.type.contextTypes;if(!n)return Mu;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in n)a[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ps(e){return e=e.childContextTypes,e!=null}function H0(){Mn(hs),Mn(ba)}function SO(e,t,n){if(ba.current!==Mu)throw Error(Ie(168));jn(ba,t),jn(hs,n)}function hz(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(Ie(108,Mee(e)||"Unknown",a));return Jn({},n,r)}function G0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Mu,xd=ba.current,jn(ba,e),jn(hs,hs.current),!0}function _O(e,t,n){var r=e.stateNode;if(!r)throw Error(Ie(169));n?(e=hz(e,t,xd),r.__reactInternalMemoizedMergedChildContext=e,Mn(hs),Mn(ba),jn(ba,e)):Mn(hs),jn(hs,n)}var Zo=null,mN=!1,S_=!1;function pz(e){Zo===null?Zo=[e]:Zo.push(e)}function Jte(e){mN=!0,pz(e)}function ic(){if(!S_&&Zo!==null){S_=!0;var e=0,t=bn;try{var n=Zo;for(bn=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Zo=null,mN=!1}catch(a){throw Zo!==null&&(Zo=Zo.slice(e+1)),P4(rT,ic),a}finally{bn=t,S_=!1}}return null}var hf=[],pf=0,q0=null,K0=0,ei=[],ti=0,vd=null,ol=1,ll="";function Mc(e,t){hf[pf++]=K0,hf[pf++]=q0,q0=e,K0=t}function fz(e,t,n){ei[ti++]=ol,ei[ti++]=ll,ei[ti++]=vd,vd=e;var r=ol;e=ll;var a=32-Ti(r)-1;r&=~(1<<a),n+=1;var s=32-Ti(t)+a;if(30<s){var i=a-a%5;s=(r&(1<<i)-1).toString(32),r>>=i,a-=i,ol=1<<32-Ti(t)+a|n<<a|r,ll=s+e}else ol=1<<s|n<<a|r,ll=e}function hT(e){e.return!==null&&(Mc(e,1),fz(e,1,0))}function pT(e){for(;e===q0;)q0=hf[--pf],hf[pf]=null,K0=hf[--pf],hf[pf]=null;for(;e===vd;)vd=ei[--ti],ei[ti]=null,ll=ei[--ti],ei[ti]=null,ol=ei[--ti],ei[ti]=null}var Os=null,js=null,Un=!1,Ii=null;function mz(e,t){var n=ni(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function CO(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Os=e,js=ku(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Os=e,js=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=vd!==null?{id:ol,overflow:ll}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ni(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Os=e,js=null,!0):!1;default:return!1}}function l2(e){return(e.mode&1)!==0&&(e.flags&128)===0}function u2(e){if(Un){var t=js;if(t){var n=t;if(!CO(e,t)){if(l2(e))throw Error(Ie(418));t=ku(n.nextSibling);var r=Os;t&&CO(e,t)?mz(r,n):(e.flags=e.flags&-4097|2,Un=!1,Os=e)}}else{if(l2(e))throw Error(Ie(418));e.flags=e.flags&-4097|2,Un=!1,Os=e}}}function IO(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Os=e}function xw(e){if(e!==Os)return!1;if(!Un)return IO(e),Un=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!a2(e.type,e.memoizedProps)),t&&(t=js)){if(l2(e))throw gz(),Error(Ie(418));for(;t;)mz(e,t),t=ku(t.nextSibling)}if(IO(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){js=ku(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}js=null}}else js=Os?ku(e.stateNode.nextSibling):null;return!0}function gz(){for(var e=js;e;)e=ku(e.nextSibling)}function Kf(){js=Os=null,Un=!1}function fT(e){Ii===null?Ii=[e]:Ii.push(e)}var Zte=Sl.ReactCurrentBatchConfig;function Sy(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ie(309));var r=n.stateNode}if(!r)throw Error(Ie(147,e));var a=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ie(284));if(!n._owner)throw Error(Ie(290,e))}return e}function vw(e,t){throw e=Object.prototype.toString.call(t),Error(Ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function EO(e){var t=e._init;return t(e._payload)}function yz(e){function t(x,v){if(e){var b=x.deletions;b===null?(x.deletions=[v],x.flags|=16):b.push(v)}}function n(x,v){if(!e)return null;for(;v!==null;)t(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function a(x,v){return x=Iu(x,v),x.index=0,x.sibling=null,x}function s(x,v,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<v?(x.flags|=2,v):b):(x.flags|=2,v)):(x.flags|=1048576,v)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,v,b,w){return v===null||v.tag!==6?(v=A_(b,x.mode,w),v.return=x,v):(v=a(v,b),v.return=x,v)}function l(x,v,b,w){var k=b.type;return k===sf?u(x,v,b.props.children,w,b.key):v!==null&&(v.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Kl&&EO(k)===v.type)?(w=a(v,b.props),w.ref=Sy(x,v,b),w.return=x,w):(w=p0(b.type,b.key,b.props,null,x.mode,w),w.ref=Sy(x,v,b),w.return=x,w)}function c(x,v,b,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=$_(b,x.mode,w),v.return=x,v):(v=a(v,b.children||[]),v.return=x,v)}function u(x,v,b,w,k){return v===null||v.tag!==7?(v=cd(b,x.mode,w,k),v.return=x,v):(v=a(v,b),v.return=x,v)}function h(x,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=A_(""+v,x.mode,b),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case lw:return b=p0(v.type,v.key,v.props,null,x.mode,b),b.ref=Sy(x,null,v),b.return=x,b;case af:return v=$_(v,x.mode,b),v.return=x,v;case Kl:var w=v._init;return h(x,w(v._payload),b)}if(By(v)||vy(v))return v=cd(v,x.mode,b,null),v.return=x,v;vw(x,v)}return null}function p(x,v,b,w){var k=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:o(x,v,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case lw:return b.key===k?l(x,v,b,w):null;case af:return b.key===k?c(x,v,b,w):null;case Kl:return k=b._init,p(x,v,k(b._payload),w)}if(By(b)||vy(b))return k!==null?null:u(x,v,b,w,null);vw(x,b)}return null}function f(x,v,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(b)||null,o(v,x,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case lw:return x=x.get(w.key===null?b:w.key)||null,l(v,x,w,k);case af:return x=x.get(w.key===null?b:w.key)||null,c(v,x,w,k);case Kl:var I=w._init;return f(x,v,b,I(w._payload),k)}if(By(w)||vy(w))return x=x.get(b)||null,u(v,x,w,k,null);vw(v,w)}return null}function g(x,v,b,w){for(var k=null,I=null,C=v,S=v=0,E=null;C!==null&&S<b.length;S++){C.index>S?(E=C,C=null):E=C.sibling;var T=p(x,C,b[S],w);if(T===null){C===null&&(C=E);break}e&&C&&T.alternate===null&&t(x,C),v=s(T,v,S),I===null?k=T:I.sibling=T,I=T,C=E}if(S===b.length)return n(x,C),Un&&Mc(x,S),k;if(C===null){for(;S<b.length;S++)C=h(x,b[S],w),C!==null&&(v=s(C,v,S),I===null?k=C:I.sibling=C,I=C);return Un&&Mc(x,S),k}for(C=r(x,C);S<b.length;S++)E=f(C,x,S,b[S],w),E!==null&&(e&&E.alternate!==null&&C.delete(E.key===null?S:E.key),v=s(E,v,S),I===null?k=E:I.sibling=E,I=E);return e&&C.forEach(function($){return t(x,$)}),Un&&Mc(x,S),k}function m(x,v,b,w){var k=vy(b);if(typeof k!="function")throw Error(Ie(150));if(b=k.call(b),b==null)throw Error(Ie(151));for(var I=k=null,C=v,S=v=0,E=null,T=b.next();C!==null&&!T.done;S++,T=b.next()){C.index>S?(E=C,C=null):E=C.sibling;var $=p(x,C,T.value,w);if($===null){C===null&&(C=E);break}e&&C&&$.alternate===null&&t(x,C),v=s($,v,S),I===null?k=$:I.sibling=$,I=$,C=E}if(T.done)return n(x,C),Un&&Mc(x,S),k;if(C===null){for(;!T.done;S++,T=b.next())T=h(x,T.value,w),T!==null&&(v=s(T,v,S),I===null?k=T:I.sibling=T,I=T);return Un&&Mc(x,S),k}for(C=r(x,C);!T.done;S++,T=b.next())T=f(C,x,S,T.value,w),T!==null&&(e&&T.alternate!==null&&C.delete(T.key===null?S:T.key),v=s(T,v,S),I===null?k=T:I.sibling=T,I=T);return e&&C.forEach(function(_){return t(x,_)}),Un&&Mc(x,S),k}function y(x,v,b,w){if(typeof b=="object"&&b!==null&&b.type===sf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case lw:e:{for(var k=b.key,I=v;I!==null;){if(I.key===k){if(k=b.type,k===sf){if(I.tag===7){n(x,I.sibling),v=a(I,b.props.children),v.return=x,x=v;break e}}else if(I.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Kl&&EO(k)===I.type){n(x,I.sibling),v=a(I,b.props),v.ref=Sy(x,I,b),v.return=x,x=v;break e}n(x,I);break}else t(x,I);I=I.sibling}b.type===sf?(v=cd(b.props.children,x.mode,w,b.key),v.return=x,x=v):(w=p0(b.type,b.key,b.props,null,x.mode,w),w.ref=Sy(x,v,b),w.return=x,x=w)}return i(x);case af:e:{for(I=b.key;v!==null;){if(v.key===I)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){n(x,v.sibling),v=a(v,b.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else t(x,v);v=v.sibling}v=$_(b,x.mode,w),v.return=x,x=v}return i(x);case Kl:return I=b._init,y(x,v,I(b._payload),w)}if(By(b))return g(x,v,b,w);if(vy(b))return m(x,v,b,w);vw(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(n(x,v.sibling),v=a(v,b),v.return=x,x=v):(n(x,v),v=A_(b,x.mode,w),v.return=x,x=v),i(x)):n(x,v)}return y}var Qf=yz(!0),xz=yz(!1),Q0=sc(null),X0=null,ff=null,mT=null;function gT(){mT=ff=X0=null}function yT(e){var t=Q0.current;Mn(Q0),e._currentValue=t}function c2(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function kf(e,t){X0=e,mT=ff=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ls=!0),e.firstContext=null)}function ii(e){var t=e._currentValue;if(mT!==e)if(e={context:e,memoizedValue:t,next:null},ff===null){if(X0===null)throw Error(Ie(308));ff=e,X0.dependencies={lanes:0,firstContext:e}}else ff=ff.next=e;return t}var Qc=null;function xT(e){Qc===null?Qc=[e]:Qc.push(e)}function vz(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,xT(t)):(n.next=a.next,a.next=n),t.interleaved=n,xl(e,r)}function xl(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ql=!1;function vT(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bz(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Su(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ln&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,xl(e,n)}return a=r.interleaved,a===null?(t.next=t,xT(r)):(t.next=a.next,a.next=t),r.interleaved=t,xl(e,n)}function o0(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,aT(e,n)}}function TO(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?a=s=i:s=s.next=i,n=n.next}while(n!==null);s===null?a=s=t:s=s.next=t}else a=s=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Y0(e,t,n,r){var a=e.updateQueue;Ql=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=a.baseState;i=0,u=c=l=null,o=s;do{var p=o.lane,f=o.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(p=t,f=n,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(f,h,p);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,p=typeof g=="function"?g.call(f,h,p):g,p==null)break e;h=Jn({},h,p);break e;case 2:Ql=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else f={eventTime:f,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,i|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(u===null&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);wd|=i,e.lanes=i,e.memoizedState=h}}function jO(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Ie(191,a));a.call(r)}}}var Sv={},bo=sc(Sv),Rx=sc(Sv),Dx=sc(Sv);function Xc(e){if(e===Sv)throw Error(Ie(174));return e}function bT(e,t){switch(jn(Dx,t),jn(Rx,e),jn(bo,Sv),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:VC(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=VC(t,e)}Mn(bo),jn(bo,t)}function Xf(){Mn(bo),Mn(Rx),Mn(Dx)}function wz(e){Xc(Dx.current);var t=Xc(bo.current),n=VC(t,e.type);t!==n&&(jn(Rx,e),jn(bo,n))}function wT(e){Rx.current===e&&(Mn(bo),Mn(Rx))}var Kn=sc(0);function J0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var __=[];function NT(){for(var e=0;e<__.length;e++)__[e]._workInProgressVersionPrimary=null;__.length=0}var l0=Sl.ReactCurrentDispatcher,C_=Sl.ReactCurrentBatchConfig,bd=0,Xn=null,Er=null,Wr=null,Z0=!1,ux=!1,Mx=0,ene=0;function ca(){throw Error(Ie(321))}function kT(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Oi(e[n],t[n]))return!1;return!0}function ST(e,t,n,r,a,s){if(bd=s,Xn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,l0.current=e===null||e.memoizedState===null?ane:sne,e=n(r,a),ux){s=0;do{if(ux=!1,Mx=0,25<=s)throw Error(Ie(301));s+=1,Wr=Er=null,t.updateQueue=null,l0.current=ine,e=n(r,a)}while(ux)}if(l0.current=e1,t=Er!==null&&Er.next!==null,bd=0,Wr=Er=Xn=null,Z0=!1,t)throw Error(Ie(300));return e}function _T(){var e=Mx!==0;return Mx=0,e}function ro(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?Xn.memoizedState=Wr=e:Wr=Wr.next=e,Wr}function oi(){if(Er===null){var e=Xn.alternate;e=e!==null?e.memoizedState:null}else e=Er.next;var t=Wr===null?Xn.memoizedState:Wr.next;if(t!==null)Wr=t,Er=e;else{if(e===null)throw Error(Ie(310));Er=e,e={memoizedState:Er.memoizedState,baseState:Er.baseState,baseQueue:Er.baseQueue,queue:Er.queue,next:null},Wr===null?Xn.memoizedState=Wr=e:Wr=Wr.next=e}return Wr}function Ox(e,t){return typeof t=="function"?t(e):t}function I_(e){var t=oi(),n=t.queue;if(n===null)throw Error(Ie(311));n.lastRenderedReducer=e;var r=Er,a=r.baseQueue,s=n.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}r.baseQueue=a=s,n.pending=null}if(a!==null){s=a.next,r=r.baseState;var o=i=null,l=null,c=s;do{var u=c.lane;if((bd&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=r):l=l.next=h,Xn.lanes|=u,wd|=u}c=c.next}while(c!==null&&c!==s);l===null?i=r:l.next=o,Oi(r,t.memoizedState)||(ls=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do s=a.lane,Xn.lanes|=s,wd|=s,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function E_(e){var t=oi(),n=t.queue;if(n===null)throw Error(Ie(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(a!==null){n.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Oi(s,t.memoizedState)||(ls=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Nz(){}function kz(e,t){var n=Xn,r=oi(),a=t(),s=!Oi(r.memoizedState,a);if(s&&(r.memoizedState=a,ls=!0),r=r.queue,CT(Cz.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Wr!==null&&Wr.memoizedState.tag&1){if(n.flags|=2048,Fx(9,_z.bind(null,n,r,a,t),void 0,null),Kr===null)throw Error(Ie(349));bd&30||Sz(n,t,a)}return a}function Sz(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function _z(e,t,n,r){t.value=n,t.getSnapshot=r,Iz(t)&&Ez(e)}function Cz(e,t,n){return n(function(){Iz(t)&&Ez(e)})}function Iz(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Oi(e,n)}catch{return!0}}function Ez(e){var t=xl(e,1);t!==null&&ji(t,e,1,-1)}function AO(e){var t=ro();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ox,lastRenderedState:e},t.queue=e,e=e.dispatch=rne.bind(null,Xn,e),[t.memoizedState,e]}function Fx(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Tz(){return oi().memoizedState}function u0(e,t,n,r){var a=ro();Xn.flags|=e,a.memoizedState=Fx(1|t,n,void 0,r===void 0?null:r)}function gN(e,t,n,r){var a=oi();r=r===void 0?null:r;var s=void 0;if(Er!==null){var i=Er.memoizedState;if(s=i.destroy,r!==null&&kT(r,i.deps)){a.memoizedState=Fx(t,n,s,r);return}}Xn.flags|=e,a.memoizedState=Fx(1|t,n,s,r)}function $O(e,t){return u0(8390656,8,e,t)}function CT(e,t){return gN(2048,8,e,t)}function jz(e,t){return gN(4,2,e,t)}function Az(e,t){return gN(4,4,e,t)}function $z(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Rz(e,t,n){return n=n!=null?n.concat([e]):null,gN(4,4,$z.bind(null,t,e),n)}function IT(){}function Dz(e,t){var n=oi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&kT(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Mz(e,t){var n=oi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&kT(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Oz(e,t,n){return bd&21?(Oi(n,t)||(n=B4(),Xn.lanes|=n,wd|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ls=!0),e.memoizedState=n)}function tne(e,t){var n=bn;bn=n!==0&&4>n?n:4,e(!0);var r=C_.transition;C_.transition={};try{e(!1),t()}finally{bn=n,C_.transition=r}}function Fz(){return oi().memoizedState}function nne(e,t,n){var r=Cu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Pz(e))Lz(t,n);else if(n=vz(e,t,n,r),n!==null){var a=La();ji(n,e,r,a),zz(n,t,r)}}function rne(e,t,n){var r=Cu(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Pz(e))Lz(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,n);if(a.hasEagerState=!0,a.eagerState=o,Oi(o,i)){var l=t.interleaved;l===null?(a.next=a,xT(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}n=vz(e,t,a,r),n!==null&&(a=La(),ji(n,e,r,a),zz(n,t,r))}}function Pz(e){var t=e.alternate;return e===Xn||t!==null&&t===Xn}function Lz(e,t){ux=Z0=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function zz(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,aT(e,n)}}var e1={readContext:ii,useCallback:ca,useContext:ca,useEffect:ca,useImperativeHandle:ca,useInsertionEffect:ca,useLayoutEffect:ca,useMemo:ca,useReducer:ca,useRef:ca,useState:ca,useDebugValue:ca,useDeferredValue:ca,useTransition:ca,useMutableSource:ca,useSyncExternalStore:ca,useId:ca,unstable_isNewReconciler:!1},ane={readContext:ii,useCallback:function(e,t){return ro().memoizedState=[e,t===void 0?null:t],e},useContext:ii,useEffect:$O,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,u0(4194308,4,$z.bind(null,t,e),n)},useLayoutEffect:function(e,t){return u0(4194308,4,e,t)},useInsertionEffect:function(e,t){return u0(4,2,e,t)},useMemo:function(e,t){var n=ro();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ro();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=nne.bind(null,Xn,e),[r.memoizedState,e]},useRef:function(e){var t=ro();return e={current:e},t.memoizedState=e},useState:AO,useDebugValue:IT,useDeferredValue:function(e){return ro().memoizedState=e},useTransition:function(){var e=AO(!1),t=e[0];return e=tne.bind(null,e[1]),ro().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Xn,a=ro();if(Un){if(n===void 0)throw Error(Ie(407));n=n()}else{if(n=t(),Kr===null)throw Error(Ie(349));bd&30||Sz(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,$O(Cz.bind(null,r,s,e),[e]),r.flags|=2048,Fx(9,_z.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ro(),t=Kr.identifierPrefix;if(Un){var n=ll,r=ol;n=(r&~(1<<32-Ti(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Mx++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ene++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sne={readContext:ii,useCallback:Dz,useContext:ii,useEffect:CT,useImperativeHandle:Rz,useInsertionEffect:jz,useLayoutEffect:Az,useMemo:Mz,useReducer:I_,useRef:Tz,useState:function(){return I_(Ox)},useDebugValue:IT,useDeferredValue:function(e){var t=oi();return Oz(t,Er.memoizedState,e)},useTransition:function(){var e=I_(Ox)[0],t=oi().memoizedState;return[e,t]},useMutableSource:Nz,useSyncExternalStore:kz,useId:Fz,unstable_isNewReconciler:!1},ine={readContext:ii,useCallback:Dz,useContext:ii,useEffect:CT,useImperativeHandle:Rz,useInsertionEffect:jz,useLayoutEffect:Az,useMemo:Mz,useReducer:E_,useRef:Tz,useState:function(){return E_(Ox)},useDebugValue:IT,useDeferredValue:function(e){var t=oi();return Er===null?t.memoizedState=e:Oz(t,Er.memoizedState,e)},useTransition:function(){var e=E_(Ox)[0],t=oi().memoizedState;return[e,t]},useMutableSource:Nz,useSyncExternalStore:kz,useId:Fz,unstable_isNewReconciler:!1};function Ni(e,t){if(e&&e.defaultProps){t=Jn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function d2(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Jn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var yN={isMounted:function(e){return(e=e._reactInternals)?Zd(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=La(),a=Cu(e),s=cl(r,a);s.payload=t,n!=null&&(s.callback=n),t=Su(e,s,a),t!==null&&(ji(t,e,a,r),o0(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=La(),a=Cu(e),s=cl(r,a);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Su(e,s,a),t!==null&&(ji(t,e,a,r),o0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=La(),r=Cu(e),a=cl(n,r);a.tag=2,t!=null&&(a.callback=t),t=Su(e,a,r),t!==null&&(ji(t,e,r,n),o0(t,e,r))}};function RO(e,t,n,r,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,i):t.prototype&&t.prototype.isPureReactComponent?!Tx(n,r)||!Tx(a,s):!0}function Bz(e,t,n){var r=!1,a=Mu,s=t.contextType;return typeof s=="object"&&s!==null?s=ii(s):(a=ps(t)?xd:ba.current,r=t.contextTypes,s=(r=r!=null)?qf(e,a):Mu),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yN,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function DO(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&yN.enqueueReplaceState(t,t.state,null)}function h2(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},vT(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=ii(s):(s=ps(t)?xd:ba.current,a.context=qf(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(d2(e,t,s,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&yN.enqueueReplaceState(a,a.state,null),Y0(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Yf(e,t){try{var n="",r=t;do n+=Dee(r),r=r.return;while(r);var a=n}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function T_(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function p2(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var one=typeof WeakMap=="function"?WeakMap:Map;function Uz(e,t,n){n=cl(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){n1||(n1=!0,k2=r),p2(e,t)},n}function Wz(e,t,n){n=cl(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){p2(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){p2(e,t),typeof r!="function"&&(_u===null?_u=new Set([this]):_u.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function MO(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new one;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=wne.bind(null,e,t,n),t.then(e,e))}function OO(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function FO(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=cl(-1,1),t.tag=2,Su(n,t,1))),n.lanes|=1),e)}var lne=Sl.ReactCurrentOwner,ls=!1;function Ra(e,t,n,r){t.child=e===null?xz(t,null,n,r):Qf(t,e.child,n,r)}function PO(e,t,n,r,a){n=n.render;var s=t.ref;return kf(t,a),r=ST(e,t,n,r,s,a),n=_T(),e!==null&&!ls?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,vl(e,t,a)):(Un&&n&&hT(t),t.flags|=1,Ra(e,t,r,a),t.child)}function LO(e,t,n,r,a){if(e===null){var s=n.type;return typeof s=="function"&&!MT(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,Vz(e,t,s,r,a)):(e=p0(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(n=n.compare,n=n!==null?n:Tx,n(i,r)&&e.ref===t.ref)return vl(e,t,a)}return t.flags|=1,e=Iu(s,r),e.ref=t.ref,e.return=t,t.child=e}function Vz(e,t,n,r,a){if(e!==null){var s=e.memoizedProps;if(Tx(s,r)&&e.ref===t.ref)if(ls=!1,t.pendingProps=r=s,(e.lanes&a)!==0)e.flags&131072&&(ls=!0);else return t.lanes=e.lanes,vl(e,t,a)}return f2(e,t,n,r,a)}function Hz(e,t,n){var r=t.pendingProps,a=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},jn(gf,Es),Es|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,jn(gf,Es),Es|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,jn(gf,Es),Es|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,jn(gf,Es),Es|=r;return Ra(e,t,a,n),t.child}function Gz(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function f2(e,t,n,r,a){var s=ps(n)?xd:ba.current;return s=qf(t,s),kf(t,a),n=ST(e,t,n,r,s,a),r=_T(),e!==null&&!ls?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,vl(e,t,a)):(Un&&r&&hT(t),t.flags|=1,Ra(e,t,n,a),t.child)}function zO(e,t,n,r,a){if(ps(n)){var s=!0;G0(t)}else s=!1;if(kf(t,a),t.stateNode===null)c0(e,t),Bz(t,n,r),h2(t,n,r,a),r=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=ii(c):(c=ps(n)?xd:ba.current,c=qf(t,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==r||l!==c)&&DO(t,i,r,c),Ql=!1;var p=t.memoizedState;i.state=p,Y0(t,r,i,a),l=t.memoizedState,o!==r||p!==l||hs.current||Ql?(typeof u=="function"&&(d2(t,n,u,r),l=t.memoizedState),(o=Ql||RO(t,n,o,r,p,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,bz(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Ni(t.type,o),i.props=c,h=t.pendingProps,p=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=ii(l):(l=ps(n)?xd:ba.current,l=qf(t,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||p!==l)&&DO(t,i,r,l),Ql=!1,p=t.memoizedState,i.state=p,Y0(t,r,i,a);var g=t.memoizedState;o!==h||p!==g||hs.current||Ql?(typeof f=="function"&&(d2(t,n,f,r),g=t.memoizedState),(c=Ql||RO(t,n,c,r,p,g,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,g,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),i.props=r,i.state=g,i.context=l,r=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return m2(e,t,n,r,s,a)}function m2(e,t,n,r,a,s){Gz(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return a&&_O(t,n,!1),vl(e,t,s);r=t.stateNode,lne.current=t;var o=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Qf(t,e.child,null,s),t.child=Qf(t,null,o,s)):Ra(e,t,o,s),t.memoizedState=r.state,a&&_O(t,n,!0),t.child}function qz(e){var t=e.stateNode;t.pendingContext?SO(e,t.pendingContext,t.pendingContext!==t.context):t.context&&SO(e,t.context,!1),bT(e,t.containerInfo)}function BO(e,t,n,r,a){return Kf(),fT(a),t.flags|=256,Ra(e,t,n,r),t.child}var g2={dehydrated:null,treeContext:null,retryLane:0};function y2(e){return{baseLanes:e,cachePool:null,transitions:null}}function Kz(e,t,n){var r=t.pendingProps,a=Kn.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),jn(Kn,a&1),e===null)return u2(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,s?(r=t.mode,s=t.child,i={mode:"hidden",children:i},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=bN(i,r,0,null),e=cd(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=y2(n),t.memoizedState=g2,e):ET(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return une(e,t,i,r,o,a,n);if(s){s=r.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Iu(a,l),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Iu(o,s):(s=cd(s,i,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,i=e.child.memoizedState,i=i===null?y2(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~n,t.memoizedState=g2,r}return s=e.child,e=s.sibling,r=Iu(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function ET(e,t){return t=bN({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bw(e,t,n,r){return r!==null&&fT(r),Qf(t,e.child,null,n),e=ET(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function une(e,t,n,r,a,s,i){if(n)return t.flags&256?(t.flags&=-257,r=T_(Error(Ie(422))),bw(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=bN({mode:"visible",children:r.children},a,0,null),s=cd(s,a,i,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&Qf(t,e.child,null,i),t.child.memoizedState=y2(i),t.memoizedState=g2,s);if(!(t.mode&1))return bw(e,t,i,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(Ie(419)),r=T_(s,r,void 0),bw(e,t,i,r)}if(o=(i&e.childLanes)!==0,ls||o){if(r=Kr,r!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,xl(e,a),ji(r,e,a,-1))}return DT(),r=T_(Error(Ie(421))),bw(e,t,i,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Nne.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,js=ku(a.nextSibling),Os=t,Un=!0,Ii=null,e!==null&&(ei[ti++]=ol,ei[ti++]=ll,ei[ti++]=vd,ol=e.id,ll=e.overflow,vd=t),t=ET(t,r.children),t.flags|=4096,t)}function UO(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),c2(e.return,t,n)}function j_(e,t,n,r,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function Qz(e,t,n){var r=t.pendingProps,a=r.revealOrder,s=r.tail;if(Ra(e,t,r.children,n),r=Kn.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&UO(e,n,t);else if(e.tag===19)UO(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(jn(Kn,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&J0(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),j_(t,!1,a,n,s);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&J0(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}j_(t,!0,n,null,s);break;case"together":j_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function c0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function vl(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),wd|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ie(153));if(t.child!==null){for(e=t.child,n=Iu(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Iu(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cne(e,t,n){switch(t.tag){case 3:qz(t),Kf();break;case 5:wz(t);break;case 1:ps(t.type)&&G0(t);break;case 4:bT(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;jn(Q0,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(jn(Kn,Kn.current&1),t.flags|=128,null):n&t.child.childLanes?Kz(e,t,n):(jn(Kn,Kn.current&1),e=vl(e,t,n),e!==null?e.sibling:null);jn(Kn,Kn.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Qz(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),jn(Kn,Kn.current),r)break;return null;case 22:case 23:return t.lanes=0,Hz(e,t,n)}return vl(e,t,n)}var Xz,x2,Yz,Jz;Xz=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};x2=function(){};Yz=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Xc(bo.current);var s=null;switch(n){case"input":a=zC(e,a),r=zC(e,r),s=[];break;case"select":a=Jn({},a,{value:void 0}),r=Jn({},r,{value:void 0}),s=[];break;case"textarea":a=WC(e,a),r=WC(e,r),s=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=V0)}HC(n,r);var i;n=null;for(c in a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Nx.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(o=a!=null?a[c]:void 0,r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Nx.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Dn("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Jz=function(e,t,n,r){n!==r&&(t.flags|=4)};function _y(e,t){if(!Un)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function da(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function dne(e,t,n){var r=t.pendingProps;switch(pT(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return da(t),null;case 1:return ps(t.type)&&H0(),da(t),null;case 3:return r=t.stateNode,Xf(),Mn(hs),Mn(ba),NT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(xw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ii!==null&&(C2(Ii),Ii=null))),x2(e,t),da(t),null;case 5:wT(t);var a=Xc(Dx.current);if(n=t.type,e!==null&&t.stateNode!=null)Yz(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Ie(166));return da(t),null}if(e=Xc(bo.current),xw(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ho]=t,r[$x]=s,e=(t.mode&1)!==0,n){case"dialog":Dn("cancel",r),Dn("close",r);break;case"iframe":case"object":case"embed":Dn("load",r);break;case"video":case"audio":for(a=0;a<Wy.length;a++)Dn(Wy[a],r);break;case"source":Dn("error",r);break;case"img":case"image":case"link":Dn("error",r),Dn("load",r);break;case"details":Dn("toggle",r);break;case"input":YM(r,s),Dn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Dn("invalid",r);break;case"textarea":ZM(r,s),Dn("invalid",r)}HC(n,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&yw(r.textContent,o,e),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&yw(r.textContent,o,e),a=["children",""+o]):Nx.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Dn("scroll",r)}switch(n){case"input":uw(r),JM(r,s,!0);break;case"textarea":uw(r),eO(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=V0)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=C4(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[ho]=t,e[$x]=r,Xz(e,t,!1,!1),t.stateNode=e;e:{switch(i=GC(n,r),n){case"dialog":Dn("cancel",e),Dn("close",e),a=r;break;case"iframe":case"object":case"embed":Dn("load",e),a=r;break;case"video":case"audio":for(a=0;a<Wy.length;a++)Dn(Wy[a],e);a=r;break;case"source":Dn("error",e),a=r;break;case"img":case"image":case"link":Dn("error",e),Dn("load",e),a=r;break;case"details":Dn("toggle",e),a=r;break;case"input":YM(e,r),a=zC(e,r),Dn("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Jn({},r,{value:void 0}),Dn("invalid",e);break;case"textarea":ZM(e,r),a=WC(e,r),Dn("invalid",e);break;default:a=r}HC(n,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?T4(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&I4(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&kx(e,l):typeof l=="number"&&kx(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Nx.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Dn("scroll",e):l!=null&&JE(e,s,l,i))}switch(n){case"input":uw(e),JM(e,r,!1);break;case"textarea":uw(e),eO(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Du(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?vf(e,!!r.multiple,s,!1):r.defaultValue!=null&&vf(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=V0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return da(t),null;case 6:if(e&&t.stateNode!=null)Jz(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Ie(166));if(n=Xc(Dx.current),Xc(bo.current),xw(t)){if(r=t.stateNode,n=t.memoizedProps,r[ho]=t,(s=r.nodeValue!==n)&&(e=Os,e!==null))switch(e.tag){case 3:yw(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&yw(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ho]=t,t.stateNode=r}return da(t),null;case 13:if(Mn(Kn),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Un&&js!==null&&t.mode&1&&!(t.flags&128))gz(),Kf(),t.flags|=98560,s=!1;else if(s=xw(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(Ie(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ie(317));s[ho]=t}else Kf(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;da(t),s=!1}else Ii!==null&&(C2(Ii),Ii=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Kn.current&1?Rr===0&&(Rr=3):DT())),t.updateQueue!==null&&(t.flags|=4),da(t),null);case 4:return Xf(),x2(e,t),e===null&&jx(t.stateNode.containerInfo),da(t),null;case 10:return yT(t.type._context),da(t),null;case 17:return ps(t.type)&&H0(),da(t),null;case 19:if(Mn(Kn),s=t.memoizedState,s===null)return da(t),null;if(r=(t.flags&128)!==0,i=s.rendering,i===null)if(r)_y(s,!1);else{if(Rr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=J0(e),i!==null){for(t.flags|=128,_y(s,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return jn(Kn,Kn.current&1|2),t.child}e=e.sibling}s.tail!==null&&cr()>Jf&&(t.flags|=128,r=!0,_y(s,!1),t.lanes=4194304)}else{if(!r)if(e=J0(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),_y(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Un)return da(t),null}else 2*cr()-s.renderingStartTime>Jf&&n!==1073741824&&(t.flags|=128,r=!0,_y(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(n=s.last,n!==null?n.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=cr(),t.sibling=null,n=Kn.current,jn(Kn,r?n&1|2:n&1),t):(da(t),null);case 22:case 23:return RT(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Es&1073741824&&(da(t),t.subtreeFlags&6&&(t.flags|=8192)):da(t),null;case 24:return null;case 25:return null}throw Error(Ie(156,t.tag))}function hne(e,t){switch(pT(t),t.tag){case 1:return ps(t.type)&&H0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Xf(),Mn(hs),Mn(ba),NT(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wT(t),null;case 13:if(Mn(Kn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ie(340));Kf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Mn(Kn),null;case 4:return Xf(),null;case 10:return yT(t.type._context),null;case 22:case 23:return RT(),null;case 24:return null;default:return null}}var ww=!1,fa=!1,pne=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function mf(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nr(e,t,r)}else n.current=null}function v2(e,t,n){try{n()}catch(r){nr(e,t,r)}}var WO=!1;function fne(e,t){if(n2=B0,e=rz(),dT(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var i=0,o=-1,l=-1,c=0,u=0,h=e,p=null;t:for(;;){for(var f;h!==n||a!==0&&h.nodeType!==3||(o=i+a),h!==s||r!==0&&h.nodeType!==3||(l=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===a&&(o=i),p===s&&++u===r&&(l=i),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(r2={focusedElem:e,selectionRange:n},B0=!1,Ke=t;Ke!==null;)if(t=Ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ke=e;else for(;Ke!==null;){t=Ke;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,y=g.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ni(t.type,m),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ie(163))}}catch(w){nr(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ke=e;break}Ke=t.return}return g=WO,WO=!1,g}function cx(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&v2(t,n,s)}a=a.next}while(a!==r)}}function xN(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function b2(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Zz(e){var t=e.alternate;t!==null&&(e.alternate=null,Zz(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ho],delete t[$x],delete t[i2],delete t[Xte],delete t[Yte])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function eB(e){return e.tag===5||e.tag===3||e.tag===4}function VO(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||eB(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function w2(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=V0));else if(r!==4&&(e=e.child,e!==null))for(w2(e,t,n),e=e.sibling;e!==null;)w2(e,t,n),e=e.sibling}function N2(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(N2(e,t,n),e=e.sibling;e!==null;)N2(e,t,n),e=e.sibling}var Jr=null,_i=!1;function Ml(e,t,n){for(n=n.child;n!==null;)tB(e,t,n),n=n.sibling}function tB(e,t,n){if(vo&&typeof vo.onCommitFiberUnmount=="function")try{vo.onCommitFiberUnmount(cN,n)}catch{}switch(n.tag){case 5:fa||mf(n,t);case 6:var r=Jr,a=_i;Jr=null,Ml(e,t,n),Jr=r,_i=a,Jr!==null&&(_i?(e=Jr,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Jr.removeChild(n.stateNode));break;case 18:Jr!==null&&(_i?(e=Jr,n=n.stateNode,e.nodeType===8?k_(e.parentNode,n):e.nodeType===1&&k_(e,n),Ix(e)):k_(Jr,n.stateNode));break;case 4:r=Jr,a=_i,Jr=n.stateNode.containerInfo,_i=!0,Ml(e,t,n),Jr=r,_i=a;break;case 0:case 11:case 14:case 15:if(!fa&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&v2(n,t,i),a=a.next}while(a!==r)}Ml(e,t,n);break;case 1:if(!fa&&(mf(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){nr(n,t,o)}Ml(e,t,n);break;case 21:Ml(e,t,n);break;case 22:n.mode&1?(fa=(r=fa)||n.memoizedState!==null,Ml(e,t,n),fa=r):Ml(e,t,n);break;default:Ml(e,t,n)}}function HO(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new pne),t.forEach(function(r){var a=kne.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function mi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Jr=o.stateNode,_i=!1;break e;case 3:Jr=o.stateNode.containerInfo,_i=!0;break e;case 4:Jr=o.stateNode.containerInfo,_i=!0;break e}o=o.return}if(Jr===null)throw Error(Ie(160));tB(s,i,a),Jr=null,_i=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){nr(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)nB(t,e),t=t.sibling}function nB(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mi(t,e),Yi(e),r&4){try{cx(3,e,e.return),xN(3,e)}catch(m){nr(e,e.return,m)}try{cx(5,e,e.return)}catch(m){nr(e,e.return,m)}}break;case 1:mi(t,e),Yi(e),r&512&&n!==null&&mf(n,n.return);break;case 5:if(mi(t,e),Yi(e),r&512&&n!==null&&mf(n,n.return),e.flags&32){var a=e.stateNode;try{kx(a,"")}catch(m){nr(e,e.return,m)}}if(r&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=n!==null?n.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&S4(a,s),GC(o,i);var c=GC(o,s);for(i=0;i<l.length;i+=2){var u=l[i],h=l[i+1];u==="style"?T4(a,h):u==="dangerouslySetInnerHTML"?I4(a,h):u==="children"?kx(a,h):JE(a,u,h,c)}switch(o){case"input":BC(a,s);break;case"textarea":_4(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?vf(a,!!s.multiple,f,!1):p!==!!s.multiple&&(s.defaultValue!=null?vf(a,!!s.multiple,s.defaultValue,!0):vf(a,!!s.multiple,s.multiple?[]:"",!1))}a[$x]=s}catch(m){nr(e,e.return,m)}}break;case 6:if(mi(t,e),Yi(e),r&4){if(e.stateNode===null)throw Error(Ie(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){nr(e,e.return,m)}}break;case 3:if(mi(t,e),Yi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ix(t.containerInfo)}catch(m){nr(e,e.return,m)}break;case 4:mi(t,e),Yi(e);break;case 13:mi(t,e),Yi(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(AT=cr())),r&4&&HO(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(fa=(c=fa)||u,mi(t,e),fa=c):mi(t,e),Yi(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ke=e,u=e.child;u!==null;){for(h=Ke=u;Ke!==null;){switch(p=Ke,f=p.child,p.tag){case 0:case 11:case 14:case 15:cx(4,p,p.return);break;case 1:mf(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){nr(r,n,m)}}break;case 5:mf(p,p.return);break;case 22:if(p.memoizedState!==null){qO(h);continue}}f!==null?(f.return=p,Ke=f):qO(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=E4("display",i))}catch(m){nr(e,e.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){nr(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:mi(t,e),Yi(e),r&4&&HO(e);break;case 21:break;default:mi(t,e),Yi(e)}}function Yi(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(eB(n)){var r=n;break e}n=n.return}throw Error(Ie(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(kx(a,""),r.flags&=-33);var s=VO(e);N2(e,s,a);break;case 3:case 4:var i=r.stateNode.containerInfo,o=VO(e);w2(e,o,i);break;default:throw Error(Ie(161))}}catch(l){nr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mne(e,t,n){Ke=e,rB(e)}function rB(e,t,n){for(var r=(e.mode&1)!==0;Ke!==null;){var a=Ke,s=a.child;if(a.tag===22&&r){var i=a.memoizedState!==null||ww;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||fa;o=ww;var c=fa;if(ww=i,(fa=l)&&!c)for(Ke=a;Ke!==null;)i=Ke,l=i.child,i.tag===22&&i.memoizedState!==null?KO(a):l!==null?(l.return=i,Ke=l):KO(a);for(;s!==null;)Ke=s,rB(s),s=s.sibling;Ke=a,ww=o,fa=c}GO(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ke=s):GO(e)}}function GO(e){for(;Ke!==null;){var t=Ke;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:fa||xN(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!fa)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Ni(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&jO(t,s,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}jO(t,i,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Ix(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ie(163))}fa||t.flags&512&&b2(t)}catch(p){nr(t,t.return,p)}}if(t===e){Ke=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ke=n;break}Ke=t.return}}function qO(e){for(;Ke!==null;){var t=Ke;if(t===e){Ke=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ke=n;break}Ke=t.return}}function KO(e){for(;Ke!==null;){var t=Ke;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{xN(4,t)}catch(l){nr(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(l){nr(t,a,l)}}var s=t.return;try{b2(t)}catch(l){nr(t,s,l)}break;case 5:var i=t.return;try{b2(t)}catch(l){nr(t,i,l)}}}catch(l){nr(t,t.return,l)}if(t===e){Ke=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ke=o;break}Ke=t.return}}var gne=Math.ceil,t1=Sl.ReactCurrentDispatcher,TT=Sl.ReactCurrentOwner,ri=Sl.ReactCurrentBatchConfig,ln=0,Kr=null,xr=null,Zr=0,Es=0,gf=sc(0),Rr=0,Px=null,wd=0,vN=0,jT=0,dx=null,ss=null,AT=0,Jf=1/0,Yo=null,n1=!1,k2=null,_u=null,Nw=!1,fu=null,r1=0,hx=0,S2=null,d0=-1,h0=0;function La(){return ln&6?cr():d0!==-1?d0:d0=cr()}function Cu(e){return e.mode&1?ln&2&&Zr!==0?Zr&-Zr:Zte.transition!==null?(h0===0&&(h0=B4()),h0):(e=bn,e!==0||(e=window.event,e=e===void 0?16:K4(e.type)),e):1}function ji(e,t,n,r){if(50<hx)throw hx=0,S2=null,Error(Ie(185));wv(e,n,r),(!(ln&2)||e!==Kr)&&(e===Kr&&(!(ln&2)&&(vN|=n),Rr===4&&eu(e,Zr)),fs(e,r),n===1&&ln===0&&!(t.mode&1)&&(Jf=cr()+500,mN&&ic()))}function fs(e,t){var n=e.callbackNode;Zee(e,t);var r=z0(e,e===Kr?Zr:0);if(r===0)n!==null&&rO(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&rO(n),t===1)e.tag===0?Jte(QO.bind(null,e)):pz(QO.bind(null,e)),Kte(function(){!(ln&6)&&ic()}),n=null;else{switch(U4(r)){case 1:n=rT;break;case 4:n=L4;break;case 16:n=L0;break;case 536870912:n=z4;break;default:n=L0}n=dB(n,aB.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function aB(e,t){if(d0=-1,h0=0,ln&6)throw Error(Ie(327));var n=e.callbackNode;if(Sf()&&e.callbackNode!==n)return null;var r=z0(e,e===Kr?Zr:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=a1(e,r);else{t=r;var a=ln;ln|=2;var s=iB();(Kr!==e||Zr!==t)&&(Yo=null,Jf=cr()+500,ud(e,t));do try{vne();break}catch(o){sB(e,o)}while(!0);gT(),t1.current=s,ln=a,xr!==null?t=0:(Kr=null,Zr=0,t=Rr)}if(t!==0){if(t===2&&(a=YC(e),a!==0&&(r=a,t=_2(e,a))),t===1)throw n=Px,ud(e,0),eu(e,r),fs(e,cr()),n;if(t===6)eu(e,r);else{if(a=e.current.alternate,!(r&30)&&!yne(a)&&(t=a1(e,r),t===2&&(s=YC(e),s!==0&&(r=s,t=_2(e,s))),t===1))throw n=Px,ud(e,0),eu(e,r),fs(e,cr()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(Ie(345));case 2:Oc(e,ss,Yo);break;case 3:if(eu(e,r),(r&130023424)===r&&(t=AT+500-cr(),10<t)){if(z0(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){La(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=s2(Oc.bind(null,e,ss,Yo),t);break}Oc(e,ss,Yo);break;case 4:if(eu(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-Ti(r);s=1<<i,i=t[i],i>a&&(a=i),r&=~s}if(r=a,r=cr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*gne(r/1960))-r,10<r){e.timeoutHandle=s2(Oc.bind(null,e,ss,Yo),r);break}Oc(e,ss,Yo);break;case 5:Oc(e,ss,Yo);break;default:throw Error(Ie(329))}}}return fs(e,cr()),e.callbackNode===n?aB.bind(null,e):null}function _2(e,t){var n=dx;return e.current.memoizedState.isDehydrated&&(ud(e,t).flags|=256),e=a1(e,t),e!==2&&(t=ss,ss=n,t!==null&&C2(t)),e}function C2(e){ss===null?ss=e:ss.push.apply(ss,e)}function yne(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!Oi(s(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function eu(e,t){for(t&=~jT,t&=~vN,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ti(t),r=1<<n;e[n]=-1,t&=~r}}function QO(e){if(ln&6)throw Error(Ie(327));Sf();var t=z0(e,0);if(!(t&1))return fs(e,cr()),null;var n=a1(e,t);if(e.tag!==0&&n===2){var r=YC(e);r!==0&&(t=r,n=_2(e,r))}if(n===1)throw n=Px,ud(e,0),eu(e,t),fs(e,cr()),n;if(n===6)throw Error(Ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Oc(e,ss,Yo),fs(e,cr()),null}function $T(e,t){var n=ln;ln|=1;try{return e(t)}finally{ln=n,ln===0&&(Jf=cr()+500,mN&&ic())}}function Nd(e){fu!==null&&fu.tag===0&&!(ln&6)&&Sf();var t=ln;ln|=1;var n=ri.transition,r=bn;try{if(ri.transition=null,bn=1,e)return e()}finally{bn=r,ri.transition=n,ln=t,!(ln&6)&&ic()}}function RT(){Es=gf.current,Mn(gf)}function ud(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,qte(n)),xr!==null)for(n=xr.return;n!==null;){var r=n;switch(pT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&H0();break;case 3:Xf(),Mn(hs),Mn(ba),NT();break;case 5:wT(r);break;case 4:Xf();break;case 13:Mn(Kn);break;case 19:Mn(Kn);break;case 10:yT(r.type._context);break;case 22:case 23:RT()}n=n.return}if(Kr=e,xr=e=Iu(e.current,null),Zr=Es=t,Rr=0,Px=null,jT=vN=wd=0,ss=dx=null,Qc!==null){for(t=0;t<Qc.length;t++)if(n=Qc[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,s=n.pending;if(s!==null){var i=s.next;s.next=a,r.next=i}n.pending=r}Qc=null}return e}function sB(e,t){do{var n=xr;try{if(gT(),l0.current=e1,Z0){for(var r=Xn.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Z0=!1}if(bd=0,Wr=Er=Xn=null,ux=!1,Mx=0,TT.current=null,n===null||n.return===null){Rr=1,Px=t,xr=null;break}e:{var s=e,i=n.return,o=n,l=t;if(t=Zr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=OO(i);if(f!==null){f.flags&=-257,FO(f,i,o,s,t),f.mode&1&&MO(s,c,t),t=f,l=c;var g=t.updateQueue;if(g===null){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}else{if(!(t&1)){MO(s,c,t),DT();break e}l=Error(Ie(426))}}else if(Un&&o.mode&1){var y=OO(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),FO(y,i,o,s,t),fT(Yf(l,o));break e}}s=l=Yf(l,o),Rr!==4&&(Rr=2),dx===null?dx=[s]:dx.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=Uz(s,l,t);TO(s,x);break e;case 1:o=l;var v=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(_u===null||!_u.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=Wz(s,o,t);TO(s,w);break e}}s=s.return}while(s!==null)}lB(n)}catch(k){t=k,xr===n&&n!==null&&(xr=n=n.return);continue}break}while(!0)}function iB(){var e=t1.current;return t1.current=e1,e===null?e1:e}function DT(){(Rr===0||Rr===3||Rr===2)&&(Rr=4),Kr===null||!(wd&268435455)&&!(vN&268435455)||eu(Kr,Zr)}function a1(e,t){var n=ln;ln|=2;var r=iB();(Kr!==e||Zr!==t)&&(Yo=null,ud(e,t));do try{xne();break}catch(a){sB(e,a)}while(!0);if(gT(),ln=n,t1.current=r,xr!==null)throw Error(Ie(261));return Kr=null,Zr=0,Rr}function xne(){for(;xr!==null;)oB(xr)}function vne(){for(;xr!==null&&!Vee();)oB(xr)}function oB(e){var t=cB(e.alternate,e,Es);e.memoizedProps=e.pendingProps,t===null?lB(e):xr=t,TT.current=null}function lB(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=hne(n,t),n!==null){n.flags&=32767,xr=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rr=6,xr=null;return}}else if(n=dne(n,t,Es),n!==null){xr=n;return}if(t=t.sibling,t!==null){xr=t;return}xr=t=e}while(t!==null);Rr===0&&(Rr=5)}function Oc(e,t,n){var r=bn,a=ri.transition;try{ri.transition=null,bn=1,bne(e,t,n,r)}finally{ri.transition=a,bn=r}return null}function bne(e,t,n,r){do Sf();while(fu!==null);if(ln&6)throw Error(Ie(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Ie(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(ete(e,s),e===Kr&&(xr=Kr=null,Zr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Nw||(Nw=!0,dB(L0,function(){return Sf(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ri.transition,ri.transition=null;var i=bn;bn=1;var o=ln;ln|=4,TT.current=null,fne(e,n),nB(n,e),zte(r2),B0=!!n2,r2=n2=null,e.current=n,mne(n),Hee(),ln=o,bn=i,ri.transition=s}else e.current=n;if(Nw&&(Nw=!1,fu=e,r1=a),s=e.pendingLanes,s===0&&(_u=null),Kee(n.stateNode),fs(e,cr()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(n1)throw n1=!1,e=k2,k2=null,e;return r1&1&&e.tag!==0&&Sf(),s=e.pendingLanes,s&1?e===S2?hx++:(hx=0,S2=e):hx=0,ic(),null}function Sf(){if(fu!==null){var e=U4(r1),t=ri.transition,n=bn;try{if(ri.transition=null,bn=16>e?16:e,fu===null)var r=!1;else{if(e=fu,fu=null,r1=0,ln&6)throw Error(Ie(331));var a=ln;for(ln|=4,Ke=e.current;Ke!==null;){var s=Ke,i=s.child;if(Ke.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ke=c;Ke!==null;){var u=Ke;switch(u.tag){case 0:case 11:case 15:cx(8,u,s)}var h=u.child;if(h!==null)h.return=u,Ke=h;else for(;Ke!==null;){u=Ke;var p=u.sibling,f=u.return;if(Zz(u),u===c){Ke=null;break}if(p!==null){p.return=f,Ke=p;break}Ke=f}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}Ke=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ke=i;else e:for(;Ke!==null;){if(s=Ke,s.flags&2048)switch(s.tag){case 0:case 11:case 15:cx(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Ke=x;break e}Ke=s.return}}var v=e.current;for(Ke=v;Ke!==null;){i=Ke;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,Ke=b;else e:for(i=v;Ke!==null;){if(o=Ke,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:xN(9,o)}}catch(k){nr(o,o.return,k)}if(o===i){Ke=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,Ke=w;break e}Ke=o.return}}if(ln=a,ic(),vo&&typeof vo.onPostCommitFiberRoot=="function")try{vo.onPostCommitFiberRoot(cN,e)}catch{}r=!0}return r}finally{bn=n,ri.transition=t}}return!1}function XO(e,t,n){t=Yf(n,t),t=Uz(e,t,1),e=Su(e,t,1),t=La(),e!==null&&(wv(e,1,t),fs(e,t))}function nr(e,t,n){if(e.tag===3)XO(e,e,n);else for(;t!==null;){if(t.tag===3){XO(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_u===null||!_u.has(r))){e=Yf(n,e),e=Wz(t,e,1),t=Su(t,e,1),e=La(),t!==null&&(wv(t,1,e),fs(t,e));break}}t=t.return}}function wne(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=La(),e.pingedLanes|=e.suspendedLanes&n,Kr===e&&(Zr&n)===n&&(Rr===4||Rr===3&&(Zr&130023424)===Zr&&500>cr()-AT?ud(e,0):jT|=n),fs(e,t)}function uB(e,t){t===0&&(e.mode&1?(t=hw,hw<<=1,!(hw&130023424)&&(hw=4194304)):t=1);var n=La();e=xl(e,t),e!==null&&(wv(e,t,n),fs(e,n))}function Nne(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),uB(e,n)}function kne(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Ie(314))}r!==null&&r.delete(t),uB(e,n)}var cB;cB=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||hs.current)ls=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return ls=!1,cne(e,t,n);ls=!!(e.flags&131072)}else ls=!1,Un&&t.flags&1048576&&fz(t,K0,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;c0(e,t),e=t.pendingProps;var a=qf(t,ba.current);kf(t,n),a=ST(null,t,r,e,a,n);var s=_T();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ps(r)?(s=!0,G0(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,vT(t),a.updater=yN,t.stateNode=a,a._reactInternals=t,h2(t,r,e,n),t=m2(null,t,r,!0,s,n)):(t.tag=0,Un&&s&&hT(t),Ra(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(c0(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=_ne(r),e=Ni(r,e),a){case 0:t=f2(null,t,r,e,n);break e;case 1:t=zO(null,t,r,e,n);break e;case 11:t=PO(null,t,r,e,n);break e;case 14:t=LO(null,t,r,Ni(r.type,e),n);break e}throw Error(Ie(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ni(r,a),f2(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ni(r,a),zO(e,t,r,a,n);case 3:e:{if(qz(t),e===null)throw Error(Ie(387));r=t.pendingProps,s=t.memoizedState,a=s.element,bz(e,t),Y0(t,r,null,n);var i=t.memoizedState;if(r=i.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Yf(Error(Ie(423)),t),t=BO(e,t,r,n,a);break e}else if(r!==a){a=Yf(Error(Ie(424)),t),t=BO(e,t,r,n,a);break e}else for(js=ku(t.stateNode.containerInfo.firstChild),Os=t,Un=!0,Ii=null,n=xz(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kf(),r===a){t=vl(e,t,n);break e}Ra(e,t,r,n)}t=t.child}return t;case 5:return wz(t),e===null&&u2(t),r=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,a2(r,a)?i=null:s!==null&&a2(r,s)&&(t.flags|=32),Gz(e,t),Ra(e,t,i,n),t.child;case 6:return e===null&&u2(t),null;case 13:return Kz(e,t,n);case 4:return bT(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Qf(t,null,r,n):Ra(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ni(r,a),PO(e,t,r,a,n);case 7:return Ra(e,t,t.pendingProps,n),t.child;case 8:return Ra(e,t,t.pendingProps.children,n),t.child;case 12:return Ra(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,jn(Q0,r._currentValue),r._currentValue=i,s!==null)if(Oi(s.value,i)){if(s.children===a.children&&!hs.current){t=vl(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=cl(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),c2(s.return,n,t),o.lanes|=n;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(Ie(341));i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),c2(i,n,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Ra(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,kf(t,n),a=ii(a),r=r(a),t.flags|=1,Ra(e,t,r,n),t.child;case 14:return r=t.type,a=Ni(r,t.pendingProps),a=Ni(r.type,a),LO(e,t,r,a,n);case 15:return Vz(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ni(r,a),c0(e,t),t.tag=1,ps(r)?(e=!0,G0(t)):e=!1,kf(t,n),Bz(t,r,a),h2(t,r,a,n),m2(null,t,r,!0,e,n);case 19:return Qz(e,t,n);case 22:return Hz(e,t,n)}throw Error(Ie(156,t.tag))};function dB(e,t){return P4(e,t)}function Sne(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ni(e,t,n,r){return new Sne(e,t,n,r)}function MT(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _ne(e){if(typeof e=="function")return MT(e)?1:0;if(e!=null){if(e=e.$$typeof,e===eT)return 11;if(e===tT)return 14}return 2}function Iu(e,t){var n=e.alternate;return n===null?(n=ni(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function p0(e,t,n,r,a,s){var i=2;if(r=e,typeof e=="function")MT(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case sf:return cd(n.children,a,s,t);case ZE:i=8,a|=8;break;case OC:return e=ni(12,n,t,a|2),e.elementType=OC,e.lanes=s,e;case FC:return e=ni(13,n,t,a),e.elementType=FC,e.lanes=s,e;case PC:return e=ni(19,n,t,a),e.elementType=PC,e.lanes=s,e;case w4:return bN(n,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case v4:i=10;break e;case b4:i=9;break e;case eT:i=11;break e;case tT:i=14;break e;case Kl:i=16,r=null;break e}throw Error(Ie(130,e==null?e:typeof e,""))}return t=ni(i,n,t,a),t.elementType=e,t.type=r,t.lanes=s,t}function cd(e,t,n,r){return e=ni(7,e,r,t),e.lanes=n,e}function bN(e,t,n,r){return e=ni(22,e,r,t),e.elementType=w4,e.lanes=n,e.stateNode={isHidden:!1},e}function A_(e,t,n){return e=ni(6,e,null,t),e.lanes=n,e}function $_(e,t,n){return t=ni(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cne(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=h_(0),this.expirationTimes=h_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=h_(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function OT(e,t,n,r,a,s,i,o,l){return e=new Cne(e,t,n,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=ni(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vT(s),e}function Ine(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:af,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function hB(e){if(!e)return Mu;e=e._reactInternals;e:{if(Zd(e)!==e||e.tag!==1)throw Error(Ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ps(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ie(171))}if(e.tag===1){var n=e.type;if(ps(n))return hz(e,n,t)}return t}function pB(e,t,n,r,a,s,i,o,l){return e=OT(n,r,!0,e,a,s,i,o,l),e.context=hB(null),n=e.current,r=La(),a=Cu(n),s=cl(r,a),s.callback=t??null,Su(n,s,a),e.current.lanes=a,wv(e,a,r),fs(e,r),e}function wN(e,t,n,r){var a=t.current,s=La(),i=Cu(a);return n=hB(n),t.context===null?t.context=n:t.pendingContext=n,t=cl(s,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Su(a,t,i),e!==null&&(ji(e,a,i,s),o0(e,a,i)),i}function s1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function YO(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function FT(e,t){YO(e,t),(e=e.alternate)&&YO(e,t)}function Ene(){return null}var fB=typeof reportError=="function"?reportError:function(e){console.error(e)};function PT(e){this._internalRoot=e}NN.prototype.render=PT.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ie(409));wN(e,t,null,null)};NN.prototype.unmount=PT.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nd(function(){wN(null,e,null,null)}),t[yl]=null}};function NN(e){this._internalRoot=e}NN.prototype.unstable_scheduleHydration=function(e){if(e){var t=H4();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Zl.length&&t!==0&&t<Zl[n].priority;n++);Zl.splice(n,0,e),n===0&&q4(e)}};function LT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function kN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function JO(){}function Tne(e,t,n,r,a){if(a){if(typeof r=="function"){var s=r;r=function(){var c=s1(i);s.call(c)}}var i=pB(t,r,e,0,null,!1,!1,"",JO);return e._reactRootContainer=i,e[yl]=i.current,jx(e.nodeType===8?e.parentNode:e),Nd(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var c=s1(l);o.call(c)}}var l=OT(e,0,!1,null,null,!1,!1,"",JO);return e._reactRootContainer=l,e[yl]=l.current,jx(e.nodeType===8?e.parentNode:e),Nd(function(){wN(t,l,n,r)}),l}function SN(e,t,n,r,a){var s=n._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=s1(i);o.call(l)}}wN(t,i,e,a)}else i=Tne(n,t,e,a,r);return s1(i)}W4=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Uy(t.pendingLanes);n!==0&&(aT(t,n|1),fs(t,cr()),!(ln&6)&&(Jf=cr()+500,ic()))}break;case 13:Nd(function(){var r=xl(e,1);if(r!==null){var a=La();ji(r,e,1,a)}}),FT(e,1)}};sT=function(e){if(e.tag===13){var t=xl(e,134217728);if(t!==null){var n=La();ji(t,e,134217728,n)}FT(e,134217728)}};V4=function(e){if(e.tag===13){var t=Cu(e),n=xl(e,t);if(n!==null){var r=La();ji(n,e,t,r)}FT(e,t)}};H4=function(){return bn};G4=function(e,t){var n=bn;try{return bn=e,t()}finally{bn=n}};KC=function(e,t,n){switch(t){case"input":if(BC(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=fN(r);if(!a)throw Error(Ie(90));k4(r),BC(r,a)}}}break;case"textarea":_4(e,n);break;case"select":t=n.value,t!=null&&vf(e,!!n.multiple,t,!1)}};$4=$T;R4=Nd;var jne={usingClientEntryPoint:!1,Events:[kv,cf,fN,j4,A4,$T]},Cy={findFiberByHostInstance:Kc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ane={bundleType:Cy.bundleType,version:Cy.version,rendererPackageName:Cy.rendererPackageName,rendererConfig:Cy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=O4(e),e===null?null:e.stateNode},findFiberByHostInstance:Cy.findFiberByHostInstance||Ene,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kw.isDisabled&&kw.supportsFiber)try{cN=kw.inject(Ane),vo=kw}catch{}}Vs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jne;Vs.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!LT(t))throw Error(Ie(200));return Ine(e,t,null,n)};Vs.createRoot=function(e,t){if(!LT(e))throw Error(Ie(299));var n=!1,r="",a=fB;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=OT(e,1,!1,null,null,n,!1,r,a),e[yl]=t.current,jx(e.nodeType===8?e.parentNode:e),new PT(t)};Vs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ie(188)):(e=Object.keys(e).join(","),Error(Ie(268,e)));return e=O4(t),e=e===null?null:e.stateNode,e};Vs.flushSync=function(e){return Nd(e)};Vs.hydrate=function(e,t,n){if(!kN(t))throw Error(Ie(200));return SN(null,e,t,!0,n)};Vs.hydrateRoot=function(e,t,n){if(!LT(e))throw Error(Ie(405));var r=n!=null&&n.hydratedSources||null,a=!1,s="",i=fB;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=pB(t,null,e,1,n??null,a,!1,s,i),e[yl]=t.current,jx(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new NN(t)};Vs.render=function(e,t,n){if(!kN(t))throw Error(Ie(200));return SN(null,e,t,!1,n)};Vs.unmountComponentAtNode=function(e){if(!kN(e))throw Error(Ie(40));return e._reactRootContainer?(Nd(function(){SN(null,null,e,!1,function(){e._reactRootContainer=null,e[yl]=null})}),!0):!1};Vs.unstable_batchedUpdates=$T;Vs.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!kN(n))throw Error(Ie(200));if(e==null||e._reactInternals===void 0)throw Error(Ie(38));return SN(e,t,n,!1,r)};Vs.version="18.3.1-next-f1338f8080-20240426";function mB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mB)}catch(e){console.error(e)}}mB(),m4.exports=Vs;var eh=m4.exports;const gB=VE(eh);var yB,ZO=eh;yB=ZO.createRoot,ZO.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lx(){return Lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lx.apply(this,arguments)}var mu;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(mu||(mu={}));const eF="popstate";function $ne(e){e===void 0&&(e={});function t(r,a){let{pathname:s,search:i,hash:o}=r.location;return I2("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:i1(a)}return Dne(t,n,null,e)}function Yn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function xB(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Rne(){return Math.random().toString(36).substr(2,8)}function tF(e,t){return{usr:e.state,key:e.key,idx:t}}function I2(e,t,n,r){return n===void 0&&(n=null),Lx({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Tm(t):t,{state:n,key:t&&t.key||r||Rne()})}function i1(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Tm(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Dne(e,t,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:s=!1}=r,i=a.history,o=mu.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(Lx({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function h(){o=mu.Pop;let y=u(),x=y==null?null:y-c;c=y,l&&l({action:o,location:m.location,delta:x})}function p(y,x){o=mu.Push;let v=I2(m.location,y,x);c=u()+1;let b=tF(v,c),w=m.createHref(v);try{i.pushState(b,"",w)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;a.location.assign(w)}s&&l&&l({action:o,location:m.location,delta:1})}function f(y,x){o=mu.Replace;let v=I2(m.location,y,x);c=u();let b=tF(v,c),w=m.createHref(v);i.replaceState(b,"",w),s&&l&&l({action:o,location:m.location,delta:0})}function g(y){let x=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof y=="string"?y:i1(y);return v=v.replace(/ $/,"%20"),Yn(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let m={get action(){return o},get location(){return e(a,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(eF,h),l=y,()=>{a.removeEventListener(eF,h),l=null}},createHref(y){return t(a,y)},createURL:g,encodeLocation(y){let x=g(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:f,go(y){return i.go(y)}};return m}var nF;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(nF||(nF={}));function Mne(e,t,n){return n===void 0&&(n="/"),One(e,t,n)}function One(e,t,n,r){let a=typeof t=="string"?Tm(t):t,s=Zf(a.pathname||"/",n);if(s==null)return null;let i=vB(e);Fne(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=Kne(s);o=Gne(i[l],c)}return o}function vB(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(Yn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Eu([r,l.relativePath]),u=n.concat(l);s.children&&s.children.length>0&&(Yn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),vB(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:Vne(c,s.index),routesMeta:u})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of bB(s.path))a(s,i,l)}),t}function bB(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return a?[s,""]:[s];let i=bB(r.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Fne(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Hne(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Pne=/^:[\w-]+$/,Lne=3,zne=2,Bne=1,Une=10,Wne=-2,rF=e=>e==="*";function Vne(e,t){let n=e.split("/"),r=n.length;return n.some(rF)&&(r+=Wne),t&&(r+=zne),n.filter(a=>!rF(a)).reduce((a,s)=>a+(Pne.test(s)?Lne:s===""?Bne:Une),r)}function Hne(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function Gne(e,t,n){let{routesMeta:r}=e,a={},s="/",i=[];for(let o=0;o<r.length;++o){let l=r[o],c=o===r.length-1,u=s==="/"?t:t.slice(s.length)||"/",h=E2({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!h)return null;Object.assign(a,h.params),i.push({params:a,pathname:Eu([s,h.pathname]),pathnameBase:Jne(Eu([s,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(s=Eu([s,h.pathnameBase]))}return i}function E2(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=qne(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((c,u,h)=>{let{paramName:p,isOptional:f}=u;if(p==="*"){let m=o[h]||"";i=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[h];return f&&!g?c[p]=void 0:c[p]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function qne(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),xB(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function Kne(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return xB(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Zf(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Qne(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?Tm(e):e;return{pathname:n?n.startsWith("/")?n:Xne(n,t):t,search:Zne(r),hash:ere(a)}}function Xne(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function R_(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Yne(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function zT(e,t){let n=Yne(e);return t?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function BT(e,t,n,r){r===void 0&&(r=!1);let a;typeof e=="string"?a=Tm(e):(a=Lx({},e),Yn(!a.pathname||!a.pathname.includes("?"),R_("?","pathname","search",a)),Yn(!a.pathname||!a.pathname.includes("#"),R_("#","pathname","hash",a)),Yn(!a.search||!a.search.includes("#"),R_("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=n;else{let h=t.length-1;if(!r&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),h-=1;a.pathname=p.join("/")}o=h>=0?t[h]:"/"}let l=Qne(a,o),c=i&&i!=="/"&&i.endsWith("/"),u=(s||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Eu=e=>e.join("/").replace(/\/\/+/g,"/"),Jne=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Zne=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ere=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tre(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const wB=["post","put","patch","delete"];new Set(wB);const nre=["get",...wB];new Set(nre);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zx(){return zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zx.apply(this,arguments)}const _N=N.createContext(null),NB=N.createContext(null),_l=N.createContext(null),CN=N.createContext(null),Oo=N.createContext({outlet:null,matches:[],isDataRoute:!1}),kB=N.createContext(null);function rre(e,t){let{relative:n}=t===void 0?{}:t;jm()||Yn(!1);let{basename:r,navigator:a}=N.useContext(_l),{hash:s,pathname:i,search:o}=IN(e,{relative:n}),l=i;return r!=="/"&&(l=i==="/"?r:Eu([r,i])),a.createHref({pathname:l,search:o,hash:s})}function jm(){return N.useContext(CN)!=null}function ci(){return jm()||Yn(!1),N.useContext(CN).location}function SB(e){N.useContext(_l).static||N.useLayoutEffect(e)}function Pr(){let{isDataRoute:e}=N.useContext(Oo);return e?xre():are()}function are(){jm()||Yn(!1);let e=N.useContext(_N),{basename:t,future:n,navigator:r}=N.useContext(_l),{matches:a}=N.useContext(Oo),{pathname:s}=ci(),i=JSON.stringify(zT(a,n.v7_relativeSplatPath)),o=N.useRef(!1);return SB(()=>{o.current=!0}),N.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){r.go(c);return}let h=BT(c,JSON.parse(i),s,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Eu([t,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[t,r,i,s,e])}const sre=N.createContext(null);function ire(e){let t=N.useContext(Oo).outlet;return t&&N.createElement(sre.Provider,{value:e},t)}function UT(){let{matches:e}=N.useContext(Oo),t=e[e.length-1];return t?t.params:{}}function IN(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=N.useContext(_l),{matches:a}=N.useContext(Oo),{pathname:s}=ci(),i=JSON.stringify(zT(a,r.v7_relativeSplatPath));return N.useMemo(()=>BT(e,JSON.parse(i),s,n==="path"),[e,i,s,n])}function ore(e,t){return lre(e,t)}function lre(e,t,n,r){jm()||Yn(!1);let{navigator:a}=N.useContext(_l),{matches:s}=N.useContext(Oo),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=ci(),u;if(t){var h;let y=typeof t=="string"?Tm(t):t;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||Yn(!1),u=y}else u=c;let p=u.pathname||"/",f=p;if(l!=="/"){let y=l.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=Mne(e,{pathname:f}),m=pre(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Eu([l,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Eu([l,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,n,r);return t&&m?N.createElement(CN.Provider,{value:{location:zx({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:mu.Pop}},m):m}function ure(){let e=yre(),t=tre(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},t),n?N.createElement("pre",{style:a},n):null,null)}const cre=N.createElement(ure,null);class dre extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?N.createElement(Oo.Provider,{value:this.props.routeContext},N.createElement(kB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hre(e){let{routeContext:t,match:n,children:r}=e,a=N.useContext(_N);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(Oo.Provider,{value:t},r)}function pre(e,t,n,r){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var s;if(!n)return null;if(n.errors)e=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,o=(a=n)==null?void 0:a.errors;if(o!=null){let u=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||Yn(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:p,errors:f}=n,g=h.route.loader&&p[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||g){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,h,p)=>{let f,g=!1,m=null,y=null;n&&(f=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||cre,l&&(c<0&&p===0?(vre("route-fallback"),g=!0,y=null):c===p&&(g=!0,y=h.route.hydrateFallbackElement||null)));let x=t.concat(i.slice(0,p+1)),v=()=>{let b;return f?b=m:g?b=y:h.route.Component?b=N.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,N.createElement(hre,{match:h,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?N.createElement(dre,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var _B=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(_B||{}),CB=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(CB||{});function fre(e){let t=N.useContext(_N);return t||Yn(!1),t}function mre(e){let t=N.useContext(NB);return t||Yn(!1),t}function gre(e){let t=N.useContext(Oo);return t||Yn(!1),t}function IB(e){let t=gre(),n=t.matches[t.matches.length-1];return n.route.id||Yn(!1),n.route.id}function yre(){var e;let t=N.useContext(kB),n=mre(),r=IB();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function xre(){let{router:e}=fre(_B.UseNavigateStable),t=IB(CB.UseNavigateStable),n=N.useRef(!1);return SB(()=>{n.current=!0}),N.useCallback(function(a,s){s===void 0&&(s={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,zx({fromRouteId:t},s)))},[e,t])}const aF={};function vre(e,t,n){aF[e]||(aF[e]=!0)}function bre(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function sl(e){let{to:t,replace:n,state:r,relative:a}=e;jm()||Yn(!1);let{future:s,static:i}=N.useContext(_l),{matches:o}=N.useContext(Oo),{pathname:l}=ci(),c=Pr(),u=BT(t,zT(o,s.v7_relativeSplatPath),l,a==="path"),h=JSON.stringify(u);return N.useEffect(()=>c(JSON.parse(h),{replace:n,state:r,relative:a}),[c,h,a,n,r]),null}function T2(e){return ire(e.context)}function xt(e){Yn(!1)}function wre(e){let{basename:t="/",children:n=null,location:r,navigationType:a=mu.Pop,navigator:s,static:i=!1,future:o}=e;jm()&&Yn(!1);let l=t.replace(/^\/*/,"/"),c=N.useMemo(()=>({basename:l,navigator:s,static:i,future:zx({v7_relativeSplatPath:!1},o)}),[l,o,s,i]);typeof r=="string"&&(r=Tm(r));let{pathname:u="/",search:h="",hash:p="",state:f=null,key:g="default"}=r,m=N.useMemo(()=>{let y=Zf(u,l);return y==null?null:{location:{pathname:y,search:h,hash:p,state:f,key:g},navigationType:a}},[l,u,h,p,f,g,a]);return m==null?null:N.createElement(_l.Provider,{value:c},N.createElement(CN.Provider,{children:n,value:m}))}function EB(e){let{children:t,location:n}=e;return ore(j2(t),n)}new Promise(()=>{});function j2(e,t){t===void 0&&(t=[]);let n=[];return N.Children.forEach(e,(r,a)=>{if(!N.isValidElement(r))return;let s=[...t,a];if(r.type===N.Fragment){n.push.apply(n,j2(r.props.children,s));return}r.type!==xt&&Yn(!1),!r.props.index||!r.props.children||Yn(!1);let i={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=j2(r.props.children,s)),n.push(i)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function o1(){return o1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o1.apply(this,arguments)}function TB(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,s;for(s=0;s<r.length;s++)a=r[s],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function Nre(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function kre(e,t){return e.button===0&&(!t||t==="_self")&&!Nre(e)}const Sre=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_re=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Cre="6";try{window.__reactRouterVersion=Cre}catch{}const Ire=N.createContext({isTransitioning:!1}),Ere="startTransition",sF=QE[Ere];function Tre(e){let{basename:t,children:n,future:r,window:a}=e,s=N.useRef();s.current==null&&(s.current=$ne({window:a,v5Compat:!0}));let i=s.current,[o,l]=N.useState({action:i.action,location:i.location}),{v7_startTransition:c}=r||{},u=N.useCallback(h=>{c&&sF?sF(()=>l(h)):l(h)},[l,c]);return N.useLayoutEffect(()=>i.listen(u),[i,u]),N.useEffect(()=>bre(r),[r]),N.createElement(wre,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:i,future:r})}const jre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Are=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jB=N.forwardRef(function(t,n){let{onClick:r,relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:h}=t,p=TB(t,Sre),{basename:f}=N.useContext(_l),g,m=!1;if(typeof c=="string"&&Are.test(c)&&(g=c,jre))try{let b=new URL(window.location.href),w=c.startsWith("//")?new URL(b.protocol+c):new URL(c),k=Zf(w.pathname,f);w.origin===b.origin&&k!=null?c=k+w.search+w.hash:m=!0}catch{}let y=rre(c,{relative:a}),x=Rre(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:h});function v(b){r&&r(b),b.defaultPrevented||x(b)}return N.createElement("a",o1({},p,{href:g||y,onClick:m||s?r:v,ref:n,target:l}))}),AB=N.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:a=!1,className:s="",end:i=!1,style:o,to:l,viewTransition:c,children:u}=t,h=TB(t,_re),p=IN(l,{relative:h.relative}),f=ci(),g=N.useContext(NB),{navigator:m,basename:y}=N.useContext(_l),x=g!=null&&Dre(p)&&c===!0,v=m.encodeLocation?m.encodeLocation(p).pathname:p.pathname,b=f.pathname,w=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;a||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&y&&(w=Zf(w,y)||w);const k=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let I=b===v||!i&&b.startsWith(v)&&b.charAt(k)==="/",C=w!=null&&(w===v||!i&&w.startsWith(v)&&w.charAt(v.length)==="/"),S={isActive:I,isPending:C,isTransitioning:x},E=I?r:void 0,T;typeof s=="function"?T=s(S):T=[s,I?"active":null,C?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let $=typeof o=="function"?o(S):o;return N.createElement(jB,o1({},h,{"aria-current":E,className:T,ref:n,style:$,to:l,viewTransition:c}),typeof u=="function"?u(S):u)});var A2;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(A2||(A2={}));var iF;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(iF||(iF={}));function $re(e){let t=N.useContext(_N);return t||Yn(!1),t}function Rre(e,t){let{target:n,replace:r,state:a,preventScrollReset:s,relative:i,viewTransition:o}=t===void 0?{}:t,l=Pr(),c=ci(),u=IN(e,{relative:i});return N.useCallback(h=>{if(kre(h,n)){h.preventDefault();let p=r!==void 0?r:i1(c)===i1(u);l(e,{replace:p,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,u,r,a,n,e,s,i,o])}function Dre(e,t){t===void 0&&(t={});let n=N.useContext(Ire);n==null&&Yn(!1);let{basename:r}=$re(A2.useViewTransitionState),a=IN(e,{relative:t.relative});if(!n.isTransitioning)return!1;let s=Zf(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Zf(n.nextLocation.pathname,r)||n.nextLocation.pathname;return E2(a.pathname,i)!=null||E2(a.pathname,s)!=null}const Mre=1,Ore=1e6;let D_=0;function Fre(){return D_=(D_+1)%Number.MAX_SAFE_INTEGER,D_.toString()}const M_=new Map,oF=e=>{if(M_.has(e))return;const t=setTimeout(()=>{M_.delete(e),px({type:"REMOVE_TOAST",toastId:e})},Ore);M_.set(e,t)},Pre=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,Mre)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?oF(n):e.toasts.forEach(r=>{oF(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},f0=[];let m0={toasts:[]};function px(e){m0=Pre(m0,e),f0.forEach(t=>{t(m0)})}function as({...e}){const t=Fre(),n=a=>px({type:"UPDATE_TOAST",toast:{...a,id:t}}),r=()=>px({type:"DISMISS_TOAST",toastId:t});return px({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||r()}}}),{id:t,dismiss:r,update:n}}function Qt(){const[e,t]=N.useState(m0);return N.useEffect(()=>(f0.push(t),()=>{const n=f0.indexOf(t);n>-1&&f0.splice(n,1)}),[e]),{...e,toast:as,dismiss:n=>px({type:"DISMISS_TOAST",toastId:n})}}function Te(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function lF(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function EN(...e){return t=>{let n=!1;const r=e.map(a=>{const s=lF(a,t);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let a=0;a<r.length;a++){const s=r[a];typeof s=="function"?s():lF(e[a],null)}}}}function kt(...e){return N.useCallback(EN(...e),e)}function Lre(e,t){const n=N.createContext(t),r=s=>{const{children:i,...o}=s,l=N.useMemo(()=>o,Object.values(o));return d.jsx(n.Provider,{value:l,children:i})};r.displayName=e+"Provider";function a(s){const i=N.useContext(n);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[r,a]}function ia(e,t=[]){let n=[];function r(s,i){const o=N.createContext(i),l=n.length;n=[...n,i];const c=h=>{var x;const{scope:p,children:f,...g}=h,m=((x=p==null?void 0:p[e])==null?void 0:x[l])||o,y=N.useMemo(()=>g,Object.values(g));return d.jsx(m.Provider,{value:y,children:f})};c.displayName=s+"Provider";function u(h,p){var m;const f=((m=p==null?void 0:p[e])==null?void 0:m[l])||o,g=N.useContext(f);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${s}\``)}return[c,u]}const a=()=>{const s=n.map(i=>N.createContext(i));return function(o){const l=(o==null?void 0:o[e])||s;return N.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return a.scopeName=e,[r,zre(a,...t)]}function zre(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const i=r.reduce((o,{useScope:l,scopeName:c})=>{const h=l(s)[`__scope${c}`];return{...o,...h}},{});return N.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}function Ou(e){const t=Ure(e),n=N.forwardRef((r,a)=>{const{children:s,...i}=r,o=N.Children.toArray(s),l=o.find(Vre);if(l){const c=l.props.children,u=o.map(h=>h===l?N.Children.count(c)>1?N.Children.only(null):N.isValidElement(c)?c.props.children:null:h);return d.jsx(t,{...i,ref:a,children:N.isValidElement(c)?N.cloneElement(c,void 0,u):null})}return d.jsx(t,{...i,ref:a,children:s})});return n.displayName=`${e}.Slot`,n}var Bre=Ou("Slot");function Ure(e){const t=N.forwardRef((n,r)=>{const{children:a,...s}=n;if(N.isValidElement(a)){const i=Gre(a),o=Hre(s,a.props);return a.type!==N.Fragment&&(o.ref=r?EN(r,i):i),N.cloneElement(a,o)}return N.Children.count(a)>1?N.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var $B=Symbol("radix.slottable");function Wre(e){const t=({children:n})=>d.jsx(d.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=$B,t}function Vre(e){return N.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===$B}function Hre(e,t){const n={...t};for(const r in t){const a=e[r],s=t[r];/^on[A-Z]/.test(r)?a&&s?n[r]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(n[r]=a):r==="style"?n[r]={...a,...s}:r==="className"&&(n[r]=[a,s].filter(Boolean).join(" "))}return{...e,...n}}function Gre(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function TN(e){const t=e+"CollectionProvider",[n,r]=ia(t),[a,s]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:y,children:x}=m,v=$e.useRef(null),b=$e.useRef(new Map).current;return d.jsx(a,{scope:y,itemMap:b,collectionRef:v,children:x})};i.displayName=t;const o=e+"CollectionSlot",l=Ou(o),c=$e.forwardRef((m,y)=>{const{scope:x,children:v}=m,b=s(o,x),w=kt(y,b.collectionRef);return d.jsx(l,{ref:w,children:v})});c.displayName=o;const u=e+"CollectionItemSlot",h="data-radix-collection-item",p=Ou(u),f=$e.forwardRef((m,y)=>{const{scope:x,children:v,...b}=m,w=$e.useRef(null),k=kt(y,w),I=s(u,x);return $e.useEffect(()=>(I.itemMap.set(w,{ref:w,...b}),()=>void I.itemMap.delete(w))),d.jsx(p,{[h]:"",ref:k,children:v})});f.displayName=u;function g(m){const y=s(e+"CollectionConsumer",m);return $e.useCallback(()=>{const v=y.collectionRef.current;if(!v)return[];const b=Array.from(v.querySelectorAll(`[${h}]`));return Array.from(y.itemMap.values()).sort((I,C)=>b.indexOf(I.ref.current)-b.indexOf(C.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:c,ItemSlot:f},g,r]}var qre=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Qe=qre.reduce((e,t)=>{const n=Ou(`Primitive.${t}`),r=N.forwardRef((a,s)=>{const{asChild:i,...o}=a,l=i?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(l,{...o,ref:s})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function WT(e,t){e&&eh.flushSync(()=>e.dispatchEvent(t))}function rr(e){const t=N.useRef(e);return N.useEffect(()=>{t.current=e}),N.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function Kre(e,t=globalThis==null?void 0:globalThis.document){const n=rr(e);N.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Qre="DismissableLayer",$2="dismissableLayer.update",Xre="dismissableLayer.pointerDownOutside",Yre="dismissableLayer.focusOutside",uF,RB=N.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),th=N.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:i,onDismiss:o,...l}=e,c=N.useContext(RB),[u,h]=N.useState(null),p=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=N.useState({}),g=kt(t,C=>h(C)),m=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=m.indexOf(y),v=u?m.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,w=v>=x,k=Zre(C=>{const S=C.target,E=[...c.branches].some(T=>T.contains(S));!w||E||(a==null||a(C),i==null||i(C),C.defaultPrevented||o==null||o())},p),I=eae(C=>{const S=C.target;[...c.branches].some(T=>T.contains(S))||(s==null||s(C),i==null||i(C),C.defaultPrevented||o==null||o())},p);return Kre(C=>{v===c.layers.size-1&&(r==null||r(C),!C.defaultPrevented&&o&&(C.preventDefault(),o()))},p),N.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(uF=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),cF(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=uF)}},[u,p,n,c]),N.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),cF())},[u,c]),N.useEffect(()=>{const C=()=>f({});return document.addEventListener($2,C),()=>document.removeEventListener($2,C)},[]),d.jsx(Qe.div,{...l,ref:g,style:{pointerEvents:b?w?"auto":"none":void 0,...e.style},onFocusCapture:Te(e.onFocusCapture,I.onFocusCapture),onBlurCapture:Te(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:Te(e.onPointerDownCapture,k.onPointerDownCapture)})});th.displayName=Qre;var Jre="DismissableLayerBranch",DB=N.forwardRef((e,t)=>{const n=N.useContext(RB),r=N.useRef(null),a=kt(t,r);return N.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),d.jsx(Qe.div,{...e,ref:a})});DB.displayName=Jre;function Zre(e,t=globalThis==null?void 0:globalThis.document){const n=rr(e),r=N.useRef(!1),a=N.useRef(()=>{});return N.useEffect(()=>{const s=o=>{if(o.target&&!r.current){let l=function(){MB(Xre,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=l,t.addEventListener("click",a.current,{once:!0})):l()}else t.removeEventListener("click",a.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function eae(e,t=globalThis==null?void 0:globalThis.document){const n=rr(e),r=N.useRef(!1);return N.useEffect(()=>{const a=s=>{s.target&&!r.current&&MB(Yre,n,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function cF(){const e=new CustomEvent($2);document.dispatchEvent(e)}function MB(e,t,n,{discrete:r}){const a=n.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?WT(a,s):a.dispatchEvent(s)}var tae=th,nae=DB,fr=globalThis!=null&&globalThis.document?N.useLayoutEffect:()=>{},rae="Portal",Am=N.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[a,s]=N.useState(!1);fr(()=>s(!0),[]);const i=n||a&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return i?gB.createPortal(d.jsx(Qe.div,{...r,ref:t}),i):null});Am.displayName=rae;function aae(e,t){return N.useReducer((n,r)=>t[n][r]??n,e)}var Lr=e=>{const{present:t,children:n}=e,r=sae(t),a=typeof n=="function"?n({present:r.isPresent}):N.Children.only(n),s=kt(r.ref,iae(a));return typeof n=="function"||r.isPresent?N.cloneElement(a,{ref:s}):null};Lr.displayName="Presence";function sae(e){const[t,n]=N.useState(),r=N.useRef(null),a=N.useRef(e),s=N.useRef("none"),i=e?"mounted":"unmounted",[o,l]=aae(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return N.useEffect(()=>{const c=Sw(r.current);s.current=o==="mounted"?c:"none"},[o]),fr(()=>{const c=r.current,u=a.current;if(u!==e){const p=s.current,f=Sw(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&p!==f?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,l]),fr(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,h=f=>{const m=Sw(r.current).includes(f.animationName);if(f.target===t&&m&&(l("ANIMATION_END"),!a.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},p=f=>{f.target===t&&(s.current=Sw(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:N.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function Sw(e){return(e==null?void 0:e.animationName)||"none"}function iae(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var oae=QE[" useInsertionEffect ".trim().toString()]||fr;function Io({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[a,s,i]=lae({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:a;{const u=N.useRef(e!==void 0);N.useEffect(()=>{const h=u.current;h!==o&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=N.useCallback(u=>{var h;if(o){const p=uae(u)?u(e):u;p!==e&&((h=i.current)==null||h.call(i,p))}else s(u)},[o,e,s,i]);return[l,c]}function lae({defaultProp:e,onChange:t}){const[n,r]=N.useState(e),a=N.useRef(n),s=N.useRef(t);return oae(()=>{s.current=t},[t]),N.useEffect(()=>{var i;a.current!==n&&((i=s.current)==null||i.call(s,n),a.current=n)},[n,a]),[n,r,s]}function uae(e){return typeof e=="function"}var OB=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),cae="VisuallyHidden",jN=N.forwardRef((e,t)=>d.jsx(Qe.span,{...e,ref:t,style:{...OB,...e.style}}));jN.displayName=cae;var dae=jN,VT="ToastProvider",[HT,hae,pae]=TN("Toast"),[FB,sat]=ia("Toast",[pae]),[fae,AN]=FB(VT),PB=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:a="right",swipeThreshold:s=50,children:i}=e,[o,l]=N.useState(null),[c,u]=N.useState(0),h=N.useRef(!1),p=N.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${VT}\`. Expected non-empty \`string\`.`),d.jsx(HT.Provider,{scope:t,children:d.jsx(fae,{scope:t,label:n,duration:r,swipeDirection:a,swipeThreshold:s,toastCount:c,viewport:o,onViewportChange:l,onToastAdd:N.useCallback(()=>u(f=>f+1),[]),onToastRemove:N.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:p,children:i})})};PB.displayName=VT;var LB="ToastViewport",mae=["F8"],R2="toast.viewportPause",D2="toast.viewportResume",zB=N.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=mae,label:a="Notifications ({hotkey})",...s}=e,i=AN(LB,n),o=hae(n),l=N.useRef(null),c=N.useRef(null),u=N.useRef(null),h=N.useRef(null),p=kt(t,h,i.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=i.toastCount>0;N.useEffect(()=>{const y=x=>{var b;r.length!==0&&r.every(w=>x[w]||x.code===w)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),N.useEffect(()=>{const y=l.current,x=h.current;if(g&&y&&x){const v=()=>{if(!i.isClosePausedRef.current){const I=new CustomEvent(R2);x.dispatchEvent(I),i.isClosePausedRef.current=!0}},b=()=>{if(i.isClosePausedRef.current){const I=new CustomEvent(D2);x.dispatchEvent(I),i.isClosePausedRef.current=!1}},w=I=>{!y.contains(I.relatedTarget)&&b()},k=()=>{y.contains(document.activeElement)||b()};return y.addEventListener("focusin",v),y.addEventListener("focusout",w),y.addEventListener("pointermove",v),y.addEventListener("pointerleave",k),window.addEventListener("blur",v),window.addEventListener("focus",b),()=>{y.removeEventListener("focusin",v),y.removeEventListener("focusout",w),y.removeEventListener("pointermove",v),y.removeEventListener("pointerleave",k),window.removeEventListener("blur",v),window.removeEventListener("focus",b)}}},[g,i.isClosePausedRef]);const m=N.useCallback(({tabbingDirection:y})=>{const v=o().map(b=>{const w=b.ref.current,k=[w,...Eae(w)];return y==="forwards"?k:k.reverse()});return(y==="forwards"?v.reverse():v).flat()},[o]);return N.useEffect(()=>{const y=h.current;if(y){const x=v=>{var k,I,C;const b=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!b){const S=document.activeElement,E=v.shiftKey;if(v.target===y&&E){(k=c.current)==null||k.focus();return}const _=m({tabbingDirection:E?"backwards":"forwards"}),M=_.findIndex(L=>L===S);O_(_.slice(M+1))?v.preventDefault():E?(I=c.current)==null||I.focus():(C=u.current)==null||C.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[o,m]),d.jsxs(nae,{ref:l,role:"region","aria-label":a.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&d.jsx(M2,{ref:c,onFocusFromOutsideViewport:()=>{const y=m({tabbingDirection:"forwards"});O_(y)}}),d.jsx(HT.Slot,{scope:n,children:d.jsx(Qe.ol,{tabIndex:-1,...s,ref:p})}),g&&d.jsx(M2,{ref:u,onFocusFromOutsideViewport:()=>{const y=m({tabbingDirection:"backwards"});O_(y)}})]})});zB.displayName=LB;var BB="ToastFocusProxy",M2=N.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...a}=e,s=AN(BB,n);return d.jsx(jN,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:i=>{var c;const o=i.relatedTarget;!((c=s.viewport)!=null&&c.contains(o))&&r()}})});M2.displayName=BB;var _v="Toast",gae="toast.swipeStart",yae="toast.swipeMove",xae="toast.swipeCancel",vae="toast.swipeEnd",UB=N.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:a,onOpenChange:s,...i}=e,[o,l]=Io({prop:r,defaultProp:a??!0,onChange:s,caller:_v});return d.jsx(Lr,{present:n||o,children:d.jsx(Nae,{open:o,...i,ref:t,onClose:()=>l(!1),onPause:rr(e.onPause),onResume:rr(e.onResume),onSwipeStart:Te(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Te(e.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Te(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Te(e.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});UB.displayName=_v;var[bae,wae]=FB(_v,{onClose(){}}),Nae=N.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:a,open:s,onClose:i,onEscapeKeyDown:o,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:p,onSwipeEnd:f,...g}=e,m=AN(_v,n),[y,x]=N.useState(null),v=kt(t,L=>x(L)),b=N.useRef(null),w=N.useRef(null),k=a||m.duration,I=N.useRef(0),C=N.useRef(k),S=N.useRef(0),{onToastAdd:E,onToastRemove:T}=m,$=rr(()=>{var U;(y==null?void 0:y.contains(document.activeElement))&&((U=m.viewport)==null||U.focus()),i()}),_=N.useCallback(L=>{!L||L===1/0||(window.clearTimeout(S.current),I.current=new Date().getTime(),S.current=window.setTimeout($,L))},[$]);N.useEffect(()=>{const L=m.viewport;if(L){const U=()=>{_(C.current),c==null||c()},O=()=>{const F=new Date().getTime()-I.current;C.current=C.current-F,window.clearTimeout(S.current),l==null||l()};return L.addEventListener(R2,O),L.addEventListener(D2,U),()=>{L.removeEventListener(R2,O),L.removeEventListener(D2,U)}}},[m.viewport,k,l,c,_]),N.useEffect(()=>{s&&!m.isClosePausedRef.current&&_(k)},[s,k,m.isClosePausedRef,_]),N.useEffect(()=>(E(),()=>T()),[E,T]);const M=N.useMemo(()=>y?QB(y):null,[y]);return m.viewport?d.jsxs(d.Fragment,{children:[M&&d.jsx(kae,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),d.jsx(bae,{scope:n,onClose:$,children:eh.createPortal(d.jsx(HT.ItemSlot,{scope:n,children:d.jsx(tae,{asChild:!0,onEscapeKeyDown:Te(o,()=>{m.isFocusedToastEscapeKeyDownRef.current||$(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:d.jsx(Qe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection,...g,ref:v,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Te(e.onKeyDown,L=>{L.key==="Escape"&&(o==null||o(L.nativeEvent),L.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,$()))}),onPointerDown:Te(e.onPointerDown,L=>{L.button===0&&(b.current={x:L.clientX,y:L.clientY})}),onPointerMove:Te(e.onPointerMove,L=>{if(!b.current)return;const U=L.clientX-b.current.x,O=L.clientY-b.current.y,F=!!w.current,D=["left","right"].includes(m.swipeDirection),R=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,V=D?R(0,U):0,G=D?0:R(0,O),W=L.pointerType==="touch"?10:2,B={x:V,y:G},Q={originalEvent:L,delta:B};F?(w.current=B,_w(yae,h,Q,{discrete:!1})):dF(B,m.swipeDirection,W)?(w.current=B,_w(gae,u,Q,{discrete:!1}),L.target.setPointerCapture(L.pointerId)):(Math.abs(U)>W||Math.abs(O)>W)&&(b.current=null)}),onPointerUp:Te(e.onPointerUp,L=>{const U=w.current,O=L.target;if(O.hasPointerCapture(L.pointerId)&&O.releasePointerCapture(L.pointerId),w.current=null,b.current=null,U){const F=L.currentTarget,D={originalEvent:L,delta:U};dF(U,m.swipeDirection,m.swipeThreshold)?_w(vae,f,D,{discrete:!0}):_w(xae,p,D,{discrete:!0}),F.addEventListener("click",R=>R.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),kae=e=>{const{__scopeToast:t,children:n,...r}=e,a=AN(_v,t),[s,i]=N.useState(!1),[o,l]=N.useState(!1);return Cae(()=>i(!0)),N.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),o?null:d.jsx(Am,{asChild:!0,children:d.jsx(jN,{...r,children:s&&d.jsxs(d.Fragment,{children:[a.label," ",n]})})})},Sae="ToastTitle",WB=N.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return d.jsx(Qe.div,{...r,ref:t})});WB.displayName=Sae;var _ae="ToastDescription",VB=N.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return d.jsx(Qe.div,{...r,ref:t})});VB.displayName=_ae;var HB="ToastAction",GB=N.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?d.jsx(KB,{altText:n,asChild:!0,children:d.jsx(GT,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${HB}\`. Expected non-empty \`string\`.`),null)});GB.displayName=HB;var qB="ToastClose",GT=N.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,a=wae(qB,n);return d.jsx(KB,{asChild:!0,children:d.jsx(Qe.button,{type:"button",...r,ref:t,onClick:Te(e.onClick,a.onClose)})})});GT.displayName=qB;var KB=N.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...a}=e;return d.jsx(Qe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...a,ref:t})});function QB(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),Iae(r)){const a=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!a)if(s){const i=r.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...QB(r))}}),t}function _w(e,t,n,{discrete:r}){const a=n.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?WT(a,s):a.dispatchEvent(s)}var dF=(e,t,n=0)=>{const r=Math.abs(e.x),a=Math.abs(e.y),s=r>a;return t==="left"||t==="right"?s&&r>n:!s&&a>n};function Cae(e=()=>{}){const t=rr(e);fr(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function Iae(e){return e.nodeType===e.ELEMENT_NODE}function Eae(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function O_(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var Tae=PB,XB=zB,YB=UB,JB=WB,ZB=VB,eU=GB,tU=GT;function nU(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=nU(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function rU(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=nU(e))&&(r&&(r+=" "),r+=t);return r}const hF=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,pF=rU,Cv=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return pF(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:s}=t,i=Object.keys(a).map(c=>{const u=n==null?void 0:n[c],h=s==null?void 0:s[c];if(u===null)return null;const p=hF(u)||hF(h);return a[c][p]}),o=n&&Object.entries(n).reduce((c,u)=>{let[h,p]=u;return p===void 0||(c[h]=p),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:p,...f}=u;return Object.entries(f).every(g=>{let[m,y]=g;return Array.isArray(y)?y.includes({...s,...o}[m]):{...s,...o}[m]===y})?[...c,h,p]:c},[]);return pF(e,i,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jae=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Aae=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),fF=e=>{const t=Aae(e);return t.charAt(0).toUpperCase()+t.slice(1)},aU=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),$ae=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Rae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dae=N.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:s,iconNode:i,...o},l)=>N.createElement("svg",{ref:l,...Rae,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:aU("lucide",a),...!s&&!$ae(o)&&{"aria-hidden":"true"},...o},[...i.map(([c,u])=>N.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=(e,t)=>{const n=N.forwardRef(({className:r,...a},s)=>N.createElement(Dae,{ref:s,iconNode:t,className:aU(`lucide-${jae(fF(e))}`,`lucide-${e}`,r),...a}));return n.displayName=fF(e),n};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mae=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Oae=Ve("align-center",Mae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fae=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Pae=Ve("align-left",Fae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lae=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],zae=Ve("align-right",Lae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bae=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Uae=Ve("arrow-left",Bae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Vae=Ve("arrow-right",Wae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hae=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Gae=Ve("award",Hae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qae=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],Kae=Ve("bold",qae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qae=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Xae=Ve("book-open",Qae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yae=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Eo=Ve("calendar",Yae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jae=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],qT=Ve("check",Jae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zae=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],sU=Ve("chevron-down",Zae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ese=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],tse=Ve("chevron-left",ese);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nse=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],iU=Ve("chevron-right",nse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rse=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ase=Ve("chevron-up",rse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sse=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],yf=Ve("circle-alert",sse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ise=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],dd=Ve("circle-check-big",ise);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ose=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],oU=Ve("circle-check",ose);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lse=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],l1=Ve("circle-x",lse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const use=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],KT=Ve("circle",use);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cse=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],O2=Ve("clipboard-check",cse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dse=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],To=Ve("clock",dse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hse=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],pse=Ve("copy",hse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fse=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],F2=Ve("database",fse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mse=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],$N=Ve("download",mse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gse=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],yse=Ve("ellipsis",gse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xse=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lU=Ve("eye",xse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vse=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],bse=Ve("file-question-mark",vse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wse=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],hd=Ve("file-text",wse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nse=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],$m=Ve("funnel",Nse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kse=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Sse=Ve("graduation-cap",kse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _se=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],uU=Ve("handshake",_se);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cse=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Ise=Ve("history",Cse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ese=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Tse=Ve("italic",Ese);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jse=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Ase=Ve("layout-dashboard",jse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $se=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Rse=Ve("link",$se);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dse=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],Mse=Ve("list-checks",Dse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ose=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],Fse=Ve("list-ordered",Ose);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pse=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Lse=Ve("list",Pse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zse=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],wo=Ve("loader-circle",zse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bse=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Use=Ve("loader",Bse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wse=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],cU=Ve("log-out",Wse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vse=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Bx=Ve("mail",Vse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hse=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Gse=Ve("map-pin",Hse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qse=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Kse=Ve("menu",qse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qse=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],Ux=Ve("message-square",Qse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xse=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Fu=Ve("pencil",Xse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yse=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],mF=Ve("phone",Yse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jse=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Qn=Ve("plus",Jse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zse=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],QT=Ve("refresh-cw",Zse);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eie=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Rm=Ve("save",eie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tie=[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],gF=Ve("school",tie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nie=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],wa=Ve("search",nie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rie=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],aie=Ve("send",rie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sie=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],P2=Ve("settings",sie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iie=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],g0=Ve("shield",iie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oie=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],oc=Ve("square-pen",oie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],uie=Ve("target",lie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cie=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Na=Ve("trash-2",cie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const die=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],XT=Ve("trending-up",die);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hie=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],pie=Ve("underline",hie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fie=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],mie=Ve("undo-2",fie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gie=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Dm=Ve("upload",gie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yie=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],fx=Ve("user-check",yie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xie=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],yF=Ve("user-plus",xie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vie=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ai=Ve("user",vie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bie=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],kd=Ve("users",bie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wie=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],F_=Ve("video",wie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nie=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],us=Ve("x",Nie),YT="-",kie=e=>{const t=_ie(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const o=i.split(YT);return o[0]===""&&o.length!==1&&o.shift(),dU(o,t)||Sie(i)},getConflictingClassGroupIds:(i,o)=>{const l=n[i]||[];return o&&r[i]?[...l,...r[i]]:l}}},dU=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),a=r?dU(e.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const s=e.join(YT);return(i=t.validators.find(({validator:o})=>o(s)))==null?void 0:i.classGroupId},xF=/^\[(.+)\]$/,Sie=e=>{if(xF.test(e)){const t=xF.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},_ie=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return Iie(Object.entries(e.classGroups),n).forEach(([s,i])=>{L2(i,r,s,t)}),r},L2=(e,t,n,r)=>{e.forEach(a=>{if(typeof a=="string"){const s=a===""?t:vF(t,a);s.classGroupId=n;return}if(typeof a=="function"){if(Cie(a)){L2(a(r),t,n,r);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([s,i])=>{L2(i,vF(t,s),n,r)})})},vF=(e,t)=>{let n=e;return t.split(YT).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Cie=e=>e.isThemeGetter,Iie=(e,t)=>t?e.map(([n,r])=>{const a=r.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,o])=>[t+i,o])):s);return[n,a]}):e,Eie=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const a=(s,i)=>{n.set(s,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(s){let i=n.get(s);if(i!==void 0)return i;if((i=r.get(s))!==void 0)return a(s,i),i},set(s,i){n.has(s)?n.set(s,i):a(s,i)}}},hU="!",Tie=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,a=t[0],s=t.length,i=o=>{const l=[];let c=0,u=0,h;for(let y=0;y<o.length;y++){let x=o[y];if(c===0){if(x===a&&(r||o.slice(y,y+s)===t)){l.push(o.slice(u,y)),u=y+s;continue}if(x==="/"){h=y;continue}}x==="["?c++:x==="]"&&c--}const p=l.length===0?o:o.substring(u),f=p.startsWith(hU),g=f?p.substring(1):p,m=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:g,maybePostfixModifierPosition:m}};return n?o=>n({className:o,parseClassName:i}):i},jie=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},Aie=e=>({cache:Eie(e.cacheSize),parseClassName:Tie(e),...kie(e)}),$ie=/\s+/,Rie=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=t,s=[],i=e.trim().split($ie);let o="";for(let l=i.length-1;l>=0;l-=1){const c=i[l],{modifiers:u,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:f}=n(c);let g=!!f,m=r(g?p.substring(0,f):p);if(!m){if(!g){o=c+(o.length>0?" "+o:o);continue}if(m=r(p),!m){o=c+(o.length>0?" "+o:o);continue}g=!1}const y=jie(u).join(":"),x=h?y+hU:y,v=x+m;if(s.includes(v))continue;s.push(v);const b=a(m,g);for(let w=0;w<b.length;++w){const k=b[w];s.push(x+k)}o=c+(o.length>0?" "+o:o)}return o};function Die(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=pU(t))&&(r&&(r+=" "),r+=n);return r}const pU=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=pU(e[r]))&&(n&&(n+=" "),n+=t);return n};function Mie(e,...t){let n,r,a,s=i;function i(l){const c=t.reduce((u,h)=>h(u),e());return n=Aie(c),r=n.cache.get,a=n.cache.set,s=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Rie(l,n);return a(l,u),u}return function(){return s(Die.apply(null,arguments))}}const Rn=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},fU=/^\[(?:([a-z-]+):)?(.+)\]$/i,Oie=/^\d+\/\d+$/,Fie=new Set(["px","full","screen"]),Pie=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lie=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,zie=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Bie=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Uie=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ho=e=>_f(e)||Fie.has(e)||Oie.test(e),Ol=e=>Mm(e,"length",Xie),_f=e=>!!e&&!Number.isNaN(Number(e)),P_=e=>Mm(e,"number",_f),Iy=e=>!!e&&Number.isInteger(Number(e)),Wie=e=>e.endsWith("%")&&_f(e.slice(0,-1)),Ot=e=>fU.test(e),Fl=e=>Pie.test(e),Vie=new Set(["length","size","percentage"]),Hie=e=>Mm(e,Vie,mU),Gie=e=>Mm(e,"position",mU),qie=new Set(["image","url"]),Kie=e=>Mm(e,qie,Jie),Qie=e=>Mm(e,"",Yie),Ey=()=>!0,Mm=(e,t,n)=>{const r=fU.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},Xie=e=>Lie.test(e)&&!zie.test(e),mU=()=>!1,Yie=e=>Bie.test(e),Jie=e=>Uie.test(e),Zie=()=>{const e=Rn("colors"),t=Rn("spacing"),n=Rn("blur"),r=Rn("brightness"),a=Rn("borderColor"),s=Rn("borderRadius"),i=Rn("borderSpacing"),o=Rn("borderWidth"),l=Rn("contrast"),c=Rn("grayscale"),u=Rn("hueRotate"),h=Rn("invert"),p=Rn("gap"),f=Rn("gradientColorStops"),g=Rn("gradientColorStopPositions"),m=Rn("inset"),y=Rn("margin"),x=Rn("opacity"),v=Rn("padding"),b=Rn("saturate"),w=Rn("scale"),k=Rn("sepia"),I=Rn("skew"),C=Rn("space"),S=Rn("translate"),E=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],$=()=>["auto",Ot,t],_=()=>[Ot,t],M=()=>["",Ho,Ol],L=()=>["auto",_f,Ot],U=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],O=()=>["solid","dashed","dotted","double","none"],F=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],D=()=>["start","end","center","between","around","evenly","stretch"],R=()=>["","0",Ot],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],G=()=>[_f,Ot];return{cacheSize:500,separator:":",theme:{colors:[Ey],spacing:[Ho,Ol],blur:["none","",Fl,Ot],brightness:G(),borderColor:[e],borderRadius:["none","","full",Fl,Ot],borderSpacing:_(),borderWidth:M(),contrast:G(),grayscale:R(),hueRotate:G(),invert:R(),gap:_(),gradientColorStops:[e],gradientColorStopPositions:[Wie,Ol],inset:$(),margin:$(),opacity:G(),padding:_(),saturate:G(),scale:G(),sepia:R(),skew:G(),space:_(),translate:_()},classGroups:{aspect:[{aspect:["auto","square","video",Ot]}],container:["container"],columns:[{columns:[Fl]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...U(),Ot]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Iy,Ot]}],basis:[{basis:$()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ot]}],grow:[{grow:R()}],shrink:[{shrink:R()}],order:[{order:["first","last","none",Iy,Ot]}],"grid-cols":[{"grid-cols":[Ey]}],"col-start-end":[{col:["auto",{span:["full",Iy,Ot]},Ot]}],"col-start":[{"col-start":L()}],"col-end":[{"col-end":L()}],"grid-rows":[{"grid-rows":[Ey]}],"row-start-end":[{row:["auto",{span:[Iy,Ot]},Ot]}],"row-start":[{"row-start":L()}],"row-end":[{"row-end":L()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ot]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ot]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...D()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...D(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...D(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ot,t]}],"min-w":[{"min-w":[Ot,t,"min","max","fit"]}],"max-w":[{"max-w":[Ot,t,"none","full","min","max","fit","prose",{screen:[Fl]},Fl]}],h:[{h:[Ot,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ot,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ot,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ot,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Fl,Ol]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",P_]}],"font-family":[{font:[Ey]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ot]}],"line-clamp":[{"line-clamp":["none",_f,P_]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ho,Ot]}],"list-image":[{"list-image":["none",Ot]}],"list-style-type":[{list:["none","disc","decimal",Ot]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...O(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ho,Ol]}],"underline-offset":[{"underline-offset":["auto",Ho,Ot]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:_()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ot]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ot]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...U(),Gie]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Hie]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Kie]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...O(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:O()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...O()]}],"outline-offset":[{"outline-offset":[Ho,Ot]}],"outline-w":[{outline:[Ho,Ol]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Ho,Ol]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Fl,Qie]}],"shadow-color":[{shadow:[Ey]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...F(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Fl,Ot]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ot]}],duration:[{duration:G()}],ease:[{ease:["linear","in","out","in-out",Ot]}],delay:[{delay:G()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ot]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Iy,Ot]}],"translate-x":[{"translate-x":[S]}],"translate-y":[{"translate-y":[S]}],"skew-x":[{"skew-x":[I]}],"skew-y":[{"skew-y":[I]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ot]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ot]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":_()}],"scroll-mx":[{"scroll-mx":_()}],"scroll-my":[{"scroll-my":_()}],"scroll-ms":[{"scroll-ms":_()}],"scroll-me":[{"scroll-me":_()}],"scroll-mt":[{"scroll-mt":_()}],"scroll-mr":[{"scroll-mr":_()}],"scroll-mb":[{"scroll-mb":_()}],"scroll-ml":[{"scroll-ml":_()}],"scroll-p":[{"scroll-p":_()}],"scroll-px":[{"scroll-px":_()}],"scroll-py":[{"scroll-py":_()}],"scroll-ps":[{"scroll-ps":_()}],"scroll-pe":[{"scroll-pe":_()}],"scroll-pt":[{"scroll-pt":_()}],"scroll-pr":[{"scroll-pr":_()}],"scroll-pb":[{"scroll-pb":_()}],"scroll-pl":[{"scroll-pl":_()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ot]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ho,Ol,P_]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},eoe=Mie(Zie);function Fe(...e){return eoe(rU(e))}const toe=Tae,gU=N.forwardRef(({className:e,...t},n)=>d.jsx(XB,{ref:n,className:Fe("fixed bottom-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:right-0 sm:flex-col md:max-w-[420px]",e),...t}));gU.displayName=XB.displayName;const noe=Cv("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),yU=N.forwardRef(({className:e,variant:t,...n},r)=>d.jsx(YB,{ref:r,className:Fe(noe({variant:t}),e),...n}));yU.displayName=YB.displayName;const roe=N.forwardRef(({className:e,...t},n)=>d.jsx(eU,{ref:n,className:Fe("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));roe.displayName=eU.displayName;const xU=N.forwardRef(({className:e,...t},n)=>d.jsx(tU,{ref:n,className:Fe("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:d.jsx(us,{className:"h-4 w-4"})}));xU.displayName=tU.displayName;const vU=N.forwardRef(({className:e,...t},n)=>d.jsx(JB,{ref:n,className:Fe("text-sm font-semibold",e),...t}));vU.displayName=JB.displayName;const bU=N.forwardRef(({className:e,...t},n)=>d.jsx(ZB,{ref:n,className:Fe("text-sm opacity-90",e),...t}));bU.displayName=ZB.displayName;function aoe(){const{toasts:e}=Qt();return d.jsxs(toe,{children:[e.map(function({id:t,title:n,description:r,action:a,...s}){return d.jsxs(yU,{...s,children:[d.jsxs("div",{className:"grid gap-1",children:[n&&d.jsx(vU,{children:n}),r&&d.jsx(bU,{children:r})]}),a,d.jsx(xU,{})]},t)}),d.jsx(gU,{})]})}var bF=["light","dark"],soe="(prefers-color-scheme: dark)",ioe=N.createContext(void 0),ooe={setTheme:e=>{},themes:[]},loe=()=>{var e;return(e=N.useContext(ioe))!=null?e:ooe};N.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:a,defaultTheme:s,value:i,attrs:o,nonce:l})=>{let c=s==="system",u=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=a?bF.includes(s)&&s?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${s}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",p=(g,m=!1,y=!0)=>{let x=i?i[g]:g,v=m?g+"|| ''":`'${x}'`,b="";return a&&y&&!m&&bF.includes(g)&&(b+=`d.style.colorScheme = '${g}';`),n==="class"?m||x?b+=`c.add(${v})`:b+="null":x&&(b+=`d[s](n,${v})`),b},f=e?`!function(){${u}${p(e)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${c})){var t='${soe}',m=window.matchMedia(t);if(m.media!==t||m.matches){${p("dark")}}else{${p("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}${c?"":"else{"+p(s,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}else{${p(s,!1,!1)};}${h}}catch(t){}}();`;return N.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:f}})});var uoe=e=>{switch(e){case"success":return hoe;case"info":return foe;case"warning":return poe;case"error":return moe;default:return null}},coe=Array(12).fill(0),doe=({visible:e,className:t})=>$e.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},$e.createElement("div",{className:"sonner-spinner"},coe.map((n,r)=>$e.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),hoe=$e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},$e.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),poe=$e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},$e.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),foe=$e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},$e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),moe=$e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},$e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),goe=$e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},$e.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),$e.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),yoe=()=>{let[e,t]=$e.useState(document.hidden);return $e.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},z2=1,xoe=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;let{message:r,...a}=t,s=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:z2++,i=this.toasts.find(l=>l.id===s),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),i?this.toasts=this.toasts.map(l=>l.id===s?(this.publish({...l,...t,id:s,title:r}),{...l,...t,id:s,dismissible:o,title:r}):l):this.addToast({title:r,...a,dismissible:o,id:s}),s},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:t,dismiss:!0})),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let a=t instanceof Promise?t:t(),s=r!==void 0,i,o=a.then(async c=>{if(i=["resolve",c],$e.isValidElement(c))s=!1,this.create({id:r,type:"default",message:c});else if(boe(c)&&!c.ok){s=!1;let u=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description;this.create({id:r,type:"error",message:u,description:h})}else if(n.success!==void 0){s=!1;let u=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"success",message:u,description:h})}}).catch(async c=>{if(i=["reject",c],n.error!==void 0){s=!1;let u=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description;this.create({id:r,type:"error",message:u,description:h})}}).finally(()=>{var c;s&&(this.dismiss(r),r=void 0),(c=n.finally)==null||c.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>i[0]==="reject"?u(i[1]):c(i[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{let r=(n==null?void 0:n.id)||z2++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ns=new xoe,voe=(e,t)=>{let n=(t==null?void 0:t.id)||z2++;return ns.addToast({title:e,...t,id:n}),n},boe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",woe=voe,Noe=()=>ns.toasts,koe=()=>ns.getActiveToasts();Object.assign(woe,{success:ns.success,info:ns.info,warning:ns.warning,error:ns.error,custom:ns.custom,message:ns.message,promise:ns.promise,dismiss:ns.dismiss,loading:ns.loading},{getHistory:Noe,getToasts:koe});function Soe(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}Soe(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Cw(e){return e.label!==void 0}var _oe=3,Coe="32px",Ioe="16px",wF=4e3,Eoe=356,Toe=14,joe=20,Aoe=200;function gi(...e){return e.filter(Boolean).join(" ")}function $oe(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var Roe=e=>{var t,n,r,a,s,i,o,l,c,u,h;let{invert:p,toast:f,unstyled:g,interacting:m,setHeights:y,visibleToasts:x,heights:v,index:b,toasts:w,expanded:k,removeToast:I,defaultRichColors:C,closeButton:S,style:E,cancelButtonStyle:T,actionButtonStyle:$,className:_="",descriptionClassName:M="",duration:L,position:U,gap:O,loadingIcon:F,expandByDefault:D,classNames:R,icons:V,closeButtonAriaLabel:G="Close toast",pauseWhenPageIsHidden:W}=e,[B,Q]=$e.useState(null),[X,pe]=$e.useState(null),[ie,oe]=$e.useState(!1),[q,de]=$e.useState(!1),[ye,be]=$e.useState(!1),[Ce,se]=$e.useState(!1),[ae,ue]=$e.useState(!1),[ke,_e]=$e.useState(0),[qe,Ue]=$e.useState(0),it=$e.useRef(f.duration||L||wF),yt=$e.useRef(null),At=$e.useRef(null),Bt=b===0,an=b+1<=x,nt=f.type,ht=f.dismissible!==!1,un=f.className||"",er=f.descriptionClassName||"",xe=$e.useMemo(()=>v.findIndex(ct=>ct.toastId===f.id)||0,[v,f.id]),$n=$e.useMemo(()=>{var ct;return(ct=f.closeButton)!=null?ct:S},[f.closeButton,S]),Pn=$e.useMemo(()=>f.duration||L||wF,[f.duration,L]),sn=$e.useRef(0),tn=$e.useRef(0),Ln=$e.useRef(0),Qa=$e.useRef(null),[De,Le]=U.split("-"),Mt=$e.useMemo(()=>v.reduce((ct,he,Ne)=>Ne>=xe?ct:ct+he.height,0),[v,xe]),gn=yoe(),or=f.invert||p,Xi=nt==="loading";tn.current=$e.useMemo(()=>xe*O+Mt,[xe,Mt]),$e.useEffect(()=>{it.current=Pn},[Pn]),$e.useEffect(()=>{oe(!0)},[]),$e.useEffect(()=>{let ct=At.current;if(ct){let he=ct.getBoundingClientRect().height;return Ue(he),y(Ne=>[{toastId:f.id,height:he,position:f.position},...Ne]),()=>y(Ne=>Ne.filter(He=>He.toastId!==f.id))}},[y,f.id]),$e.useLayoutEffect(()=>{if(!ie)return;let ct=At.current,he=ct.style.height;ct.style.height="auto";let Ne=ct.getBoundingClientRect().height;ct.style.height=he,Ue(Ne),y(He=>He.find(Ae=>Ae.toastId===f.id)?He.map(Ae=>Ae.toastId===f.id?{...Ae,height:Ne}:Ae):[{toastId:f.id,height:Ne,position:f.position},...He])},[ie,f.title,f.description,y,f.id]);let Br=$e.useCallback(()=>{de(!0),_e(tn.current),y(ct=>ct.filter(he=>he.toastId!==f.id)),setTimeout(()=>{I(f)},Aoe)},[f,I,y,tn]);$e.useEffect(()=>{if(f.promise&&nt==="loading"||f.duration===1/0||f.type==="loading")return;let ct;return k||m||W&&gn?(()=>{if(Ln.current<sn.current){let he=new Date().getTime()-sn.current;it.current=it.current-he}Ln.current=new Date().getTime()})():it.current!==1/0&&(sn.current=new Date().getTime(),ct=setTimeout(()=>{var he;(he=f.onAutoClose)==null||he.call(f,f),Br()},it.current)),()=>clearTimeout(ct)},[k,m,f,nt,W,gn,Br]),$e.useEffect(()=>{f.delete&&Br()},[Br,f.delete]);function _n(){var ct,he,Ne;return V!=null&&V.loading?$e.createElement("div",{className:gi(R==null?void 0:R.loader,(ct=f==null?void 0:f.classNames)==null?void 0:ct.loader,"sonner-loader"),"data-visible":nt==="loading"},V.loading):F?$e.createElement("div",{className:gi(R==null?void 0:R.loader,(he=f==null?void 0:f.classNames)==null?void 0:he.loader,"sonner-loader"),"data-visible":nt==="loading"},F):$e.createElement(doe,{className:gi(R==null?void 0:R.loader,(Ne=f==null?void 0:f.classNames)==null?void 0:Ne.loader),visible:nt==="loading"})}return $e.createElement("li",{tabIndex:0,ref:At,className:gi(_,un,R==null?void 0:R.toast,(t=f==null?void 0:f.classNames)==null?void 0:t.toast,R==null?void 0:R.default,R==null?void 0:R[nt],(n=f==null?void 0:f.classNames)==null?void 0:n[nt]),"data-sonner-toast":"","data-rich-colors":(r=f.richColors)!=null?r:C,"data-styled":!(f.jsx||f.unstyled||g),"data-mounted":ie,"data-promise":!!f.promise,"data-swiped":ae,"data-removed":q,"data-visible":an,"data-y-position":De,"data-x-position":Le,"data-index":b,"data-front":Bt,"data-swiping":ye,"data-dismissible":ht,"data-type":nt,"data-invert":or,"data-swipe-out":Ce,"data-swipe-direction":X,"data-expanded":!!(k||D&&ie),style:{"--index":b,"--toasts-before":b,"--z-index":w.length-b,"--offset":`${q?ke:tn.current}px`,"--initial-height":D?"auto":`${qe}px`,...E,...f.style},onDragEnd:()=>{be(!1),Q(null),Qa.current=null},onPointerDown:ct=>{Xi||!ht||(yt.current=new Date,_e(tn.current),ct.target.setPointerCapture(ct.pointerId),ct.target.tagName!=="BUTTON"&&(be(!0),Qa.current={x:ct.clientX,y:ct.clientY}))},onPointerUp:()=>{var ct,he,Ne,He;if(Ce||!ht)return;Qa.current=null;let Ae=Number(((ct=At.current)==null?void 0:ct.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Xt=Number(((he=At.current)==null?void 0:he.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),on=new Date().getTime()-((Ne=yt.current)==null?void 0:Ne.getTime()),at=B==="x"?Ae:Xt,st=Math.abs(at)/on;if(Math.abs(at)>=joe||st>.11){_e(tn.current),(He=f.onDismiss)==null||He.call(f,f),pe(B==="x"?Ae>0?"right":"left":Xt>0?"down":"up"),Br(),se(!0),ue(!1);return}be(!1),Q(null)},onPointerMove:ct=>{var he,Ne,He,Ae;if(!Qa.current||!ht||((he=window.getSelection())==null?void 0:he.toString().length)>0)return;let Xt=ct.clientY-Qa.current.y,on=ct.clientX-Qa.current.x,at=(Ne=e.swipeDirections)!=null?Ne:$oe(U);!B&&(Math.abs(on)>1||Math.abs(Xt)>1)&&Q(Math.abs(on)>Math.abs(Xt)?"x":"y");let st={x:0,y:0};B==="y"?(at.includes("top")||at.includes("bottom"))&&(at.includes("top")&&Xt<0||at.includes("bottom")&&Xt>0)&&(st.y=Xt):B==="x"&&(at.includes("left")||at.includes("right"))&&(at.includes("left")&&on<0||at.includes("right")&&on>0)&&(st.x=on),(Math.abs(st.x)>0||Math.abs(st.y)>0)&&ue(!0),(He=At.current)==null||He.style.setProperty("--swipe-amount-x",`${st.x}px`),(Ae=At.current)==null||Ae.style.setProperty("--swipe-amount-y",`${st.y}px`)}},$n&&!f.jsx?$e.createElement("button",{"aria-label":G,"data-disabled":Xi,"data-close-button":!0,onClick:Xi||!ht?()=>{}:()=>{var ct;Br(),(ct=f.onDismiss)==null||ct.call(f,f)},className:gi(R==null?void 0:R.closeButton,(a=f==null?void 0:f.classNames)==null?void 0:a.closeButton)},(s=V==null?void 0:V.close)!=null?s:goe):null,f.jsx||N.isValidElement(f.title)?f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title:$e.createElement($e.Fragment,null,nt||f.icon||f.promise?$e.createElement("div",{"data-icon":"",className:gi(R==null?void 0:R.icon,(i=f==null?void 0:f.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||_n():null,f.type!=="loading"?f.icon||(V==null?void 0:V[nt])||uoe(nt):null):null,$e.createElement("div",{"data-content":"",className:gi(R==null?void 0:R.content,(o=f==null?void 0:f.classNames)==null?void 0:o.content)},$e.createElement("div",{"data-title":"",className:gi(R==null?void 0:R.title,(l=f==null?void 0:f.classNames)==null?void 0:l.title)},typeof f.title=="function"?f.title():f.title),f.description?$e.createElement("div",{"data-description":"",className:gi(M,er,R==null?void 0:R.description,(c=f==null?void 0:f.classNames)==null?void 0:c.description)},typeof f.description=="function"?f.description():f.description):null),N.isValidElement(f.cancel)?f.cancel:f.cancel&&Cw(f.cancel)?$e.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||T,onClick:ct=>{var he,Ne;Cw(f.cancel)&&ht&&((Ne=(he=f.cancel).onClick)==null||Ne.call(he,ct),Br())},className:gi(R==null?void 0:R.cancelButton,(u=f==null?void 0:f.classNames)==null?void 0:u.cancelButton)},f.cancel.label):null,N.isValidElement(f.action)?f.action:f.action&&Cw(f.action)?$e.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||$,onClick:ct=>{var he,Ne;Cw(f.action)&&((Ne=(he=f.action).onClick)==null||Ne.call(he,ct),!ct.defaultPrevented&&Br())},className:gi(R==null?void 0:R.actionButton,(h=f==null?void 0:f.classNames)==null?void 0:h.actionButton)},f.action.label):null))};function NF(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Doe(e,t){let n={};return[e,t].forEach((r,a)=>{let s=a===1,i=s?"--mobile-offset":"--offset",o=s?Ioe:Coe;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${i}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${i}-${c}`]=o:n[`${i}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}var Moe=N.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:i,className:o,offset:l,mobileOffset:c,theme:u="light",richColors:h,duration:p,style:f,visibleToasts:g=_oe,toastOptions:m,dir:y=NF(),gap:x=Toe,loadingIcon:v,icons:b,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:k}=e,[I,C]=$e.useState([]),S=$e.useMemo(()=>Array.from(new Set([r].concat(I.filter(W=>W.position).map(W=>W.position)))),[I,r]),[E,T]=$e.useState([]),[$,_]=$e.useState(!1),[M,L]=$e.useState(!1),[U,O]=$e.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),F=$e.useRef(null),D=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),R=$e.useRef(null),V=$e.useRef(!1),G=$e.useCallback(W=>{C(B=>{var Q;return(Q=B.find(X=>X.id===W.id))!=null&&Q.delete||ns.dismiss(W.id),B.filter(({id:X})=>X!==W.id)})},[]);return $e.useEffect(()=>ns.subscribe(W=>{if(W.dismiss){C(B=>B.map(Q=>Q.id===W.id?{...Q,delete:!0}:Q));return}setTimeout(()=>{gB.flushSync(()=>{C(B=>{let Q=B.findIndex(X=>X.id===W.id);return Q!==-1?[...B.slice(0,Q),{...B[Q],...W},...B.slice(Q+1)]:[W,...B]})})})}),[]),$e.useEffect(()=>{if(u!=="system"){O(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?O("dark"):O("light")),typeof window>"u")return;let W=window.matchMedia("(prefers-color-scheme: dark)");try{W.addEventListener("change",({matches:B})=>{O(B?"dark":"light")})}catch{W.addListener(({matches:Q})=>{try{O(Q?"dark":"light")}catch(X){console.error(X)}})}},[u]),$e.useEffect(()=>{I.length<=1&&_(!1)},[I]),$e.useEffect(()=>{let W=B=>{var Q,X;a.every(pe=>B[pe]||B.code===pe)&&(_(!0),(Q=F.current)==null||Q.focus()),B.code==="Escape"&&(document.activeElement===F.current||(X=F.current)!=null&&X.contains(document.activeElement))&&_(!1)};return document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)},[a]),$e.useEffect(()=>{if(F.current)return()=>{R.current&&(R.current.focus({preventScroll:!0}),R.current=null,V.current=!1)}},[F.current]),$e.createElement("section",{ref:t,"aria-label":`${w} ${D}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},S.map((W,B)=>{var Q;let[X,pe]=W.split("-");return I.length?$e.createElement("ol",{key:W,dir:y==="auto"?NF():y,tabIndex:-1,ref:F,className:o,"data-sonner-toaster":!0,"data-theme":U,"data-y-position":X,"data-lifted":$&&I.length>1&&!s,"data-x-position":pe,style:{"--front-toast-height":`${((Q=E[0])==null?void 0:Q.height)||0}px`,"--width":`${Eoe}px`,"--gap":`${x}px`,...f,...Doe(l,c)},onBlur:ie=>{V.current&&!ie.currentTarget.contains(ie.relatedTarget)&&(V.current=!1,R.current&&(R.current.focus({preventScroll:!0}),R.current=null))},onFocus:ie=>{ie.target instanceof HTMLElement&&ie.target.dataset.dismissible==="false"||V.current||(V.current=!0,R.current=ie.relatedTarget)},onMouseEnter:()=>_(!0),onMouseMove:()=>_(!0),onMouseLeave:()=>{M||_(!1)},onDragEnd:()=>_(!1),onPointerDown:ie=>{ie.target instanceof HTMLElement&&ie.target.dataset.dismissible==="false"||L(!0)},onPointerUp:()=>L(!1)},I.filter(ie=>!ie.position&&B===0||ie.position===W).map((ie,oe)=>{var q,de;return $e.createElement(Roe,{key:ie.id,icons:b,index:oe,toast:ie,defaultRichColors:h,duration:(q=m==null?void 0:m.duration)!=null?q:p,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:n,visibleToasts:g,closeButton:(de=m==null?void 0:m.closeButton)!=null?de:i,interacting:M,position:W,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:G,toasts:I.filter(ye=>ye.position==ie.position),heights:E.filter(ye=>ye.position==ie.position),setHeights:T,expandByDefault:s,gap:x,loadingIcon:v,expanded:$,pauseWhenPageIsHidden:k,swipeDirections:e.swipeDirections})})):null}))});const Ooe=({...e})=>{const{theme:t="system"}=loe();return d.jsx(Moe,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Foe=QE[" useId ".trim().toString()]||(()=>{}),Poe=0;function $i(e){const[t,n]=N.useState(Foe());return fr(()=>{n(r=>r??String(Poe++))},[e]),t?`radix-${t}`:""}const Loe=["top","right","bottom","left"],Pu=Math.min,Ts=Math.max,u1=Math.round,Iw=Math.floor,No=e=>({x:e,y:e}),zoe={left:"right",right:"left",bottom:"top",top:"bottom"},Boe={start:"end",end:"start"};function B2(e,t,n){return Ts(e,Pu(t,n))}function bl(e,t){return typeof e=="function"?e(t):e}function wl(e){return e.split("-")[0]}function Om(e){return e.split("-")[1]}function JT(e){return e==="x"?"y":"x"}function ZT(e){return e==="y"?"height":"width"}const Uoe=new Set(["top","bottom"]);function fo(e){return Uoe.has(wl(e))?"y":"x"}function ej(e){return JT(fo(e))}function Woe(e,t,n){n===void 0&&(n=!1);const r=Om(e),a=ej(e),s=ZT(a);let i=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=c1(i)),[i,c1(i)]}function Voe(e){const t=c1(e);return[U2(e),t,U2(t)]}function U2(e){return e.replace(/start|end/g,t=>Boe[t])}const kF=["left","right"],SF=["right","left"],Hoe=["top","bottom"],Goe=["bottom","top"];function qoe(e,t,n){switch(e){case"top":case"bottom":return n?t?SF:kF:t?kF:SF;case"left":case"right":return t?Hoe:Goe;default:return[]}}function Koe(e,t,n,r){const a=Om(e);let s=qoe(wl(e),n==="start",r);return a&&(s=s.map(i=>i+"-"+a),t&&(s=s.concat(s.map(U2)))),s}function c1(e){return e.replace(/left|right|bottom|top/g,t=>zoe[t])}function Qoe(e){return{top:0,right:0,bottom:0,left:0,...e}}function wU(e){return typeof e!="number"?Qoe(e):{top:e,right:e,bottom:e,left:e}}function d1(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function _F(e,t,n){let{reference:r,floating:a}=e;const s=fo(t),i=ej(t),o=ZT(i),l=wl(t),c=s==="y",u=r.x+r.width/2-a.width/2,h=r.y+r.height/2-a.height/2,p=r[o]/2-a[o]/2;let f;switch(l){case"top":f={x:u,y:r.y-a.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:h};break;case"left":f={x:r.x-a.width,y:h};break;default:f={x:r.x,y:r.y}}switch(Om(t)){case"start":f[i]-=p*(n&&c?-1:1);break;case"end":f[i]+=p*(n&&c?-1:1);break}return f}const Xoe=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:s=[],platform:i}=n,o=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let c=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:h}=_F(c,r,l),p=r,f={},g=0;for(let m=0;m<o.length;m++){const{name:y,fn:x}=o[m],{x:v,y:b,data:w,reset:k}=await x({x:u,y:h,initialPlacement:r,placement:p,strategy:a,middlewareData:f,rects:c,platform:i,elements:{reference:e,floating:t}});u=v??u,h=b??h,f={...f,[y]:{...f[y],...w}},k&&g<=50&&(g++,typeof k=="object"&&(k.placement&&(p=k.placement),k.rects&&(c=k.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):k.rects),{x:u,y:h}=_F(c,p,l)),m=-1)}return{x:u,y:h,placement:p,strategy:a,middlewareData:f}};async function Wx(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:s,rects:i,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:p=!1,padding:f=0}=bl(t,e),g=wU(f),y=o[p?h==="floating"?"reference":"floating":h],x=d1(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),v=h==="floating"?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),w=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},k=d1(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:b,strategy:l}):v);return{top:(x.top-k.top+g.top)/w.y,bottom:(k.bottom-x.bottom+g.bottom)/w.y,left:(x.left-k.left+g.left)/w.x,right:(k.right-x.right+g.right)/w.x}}const Yoe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:s,platform:i,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=bl(e,t)||{};if(c==null)return{};const h=wU(u),p={x:n,y:r},f=ej(a),g=ZT(f),m=await i.getDimensions(c),y=f==="y",x=y?"top":"left",v=y?"bottom":"right",b=y?"clientHeight":"clientWidth",w=s.reference[g]+s.reference[f]-p[f]-s.floating[g],k=p[f]-s.reference[f],I=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let C=I?I[b]:0;(!C||!await(i.isElement==null?void 0:i.isElement(I)))&&(C=o.floating[b]||s.floating[g]);const S=w/2-k/2,E=C/2-m[g]/2-1,T=Pu(h[x],E),$=Pu(h[v],E),_=T,M=C-m[g]-$,L=C/2-m[g]/2+S,U=B2(_,L,M),O=!l.arrow&&Om(a)!=null&&L!==U&&s.reference[g]/2-(L<_?T:$)-m[g]/2<0,F=O?L<_?L-_:L-M:0;return{[f]:p[f]+F,data:{[f]:U,centerOffset:L-U-F,...O&&{alignmentOffset:F}},reset:O}}}),Joe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:s,rects:i,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:m=!0,...y}=bl(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const x=wl(a),v=fo(o),b=wl(o)===o,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=p||(b||!m?[c1(o)]:Voe(o)),I=g!=="none";!p&&I&&k.push(...Koe(o,m,g,w));const C=[o,...k],S=await Wx(t,y),E=[];let T=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&E.push(S[x]),h){const L=Woe(a,i,w);E.push(S[L[0]],S[L[1]])}if(T=[...T,{placement:a,overflows:E}],!E.every(L=>L<=0)){var $,_;const L=((($=s.flip)==null?void 0:$.index)||0)+1,U=C[L];if(U&&(!(h==="alignment"?v!==fo(U):!1)||T.every(D=>D.overflows[0]>0&&fo(D.placement)===v)))return{data:{index:L,overflows:T},reset:{placement:U}};let O=(_=T.filter(F=>F.overflows[0]<=0).sort((F,D)=>F.overflows[1]-D.overflows[1])[0])==null?void 0:_.placement;if(!O)switch(f){case"bestFit":{var M;const F=(M=T.filter(D=>{if(I){const R=fo(D.placement);return R===v||R==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(R=>R>0).reduce((R,V)=>R+V,0)]).sort((D,R)=>D[1]-R[1])[0])==null?void 0:M[0];F&&(O=F);break}case"initialPlacement":O=o;break}if(a!==O)return{reset:{placement:O}}}return{}}}};function CF(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function IF(e){return Loe.some(t=>e[t]>=0)}const Zoe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=bl(e,t);switch(r){case"referenceHidden":{const s=await Wx(t,{...a,elementContext:"reference"}),i=CF(s,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:IF(i)}}}case"escaped":{const s=await Wx(t,{...a,altBoundary:!0}),i=CF(s,n.floating);return{data:{escapedOffsets:i,escaped:IF(i)}}}default:return{}}}}},NU=new Set(["left","top"]);async function ele(e,t){const{placement:n,platform:r,elements:a}=e,s=await(r.isRTL==null?void 0:r.isRTL(a.floating)),i=wl(n),o=Om(n),l=fo(n)==="y",c=NU.has(i)?-1:1,u=s&&l?-1:1,h=bl(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&typeof g=="number"&&(f=o==="end"?g*-1:g),l?{x:f*u,y:p*c}:{x:p*c,y:f*u}}const tle=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:s,placement:i,middlewareData:o}=t,l=await ele(t,e);return i===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:a+l.x,y:s+l.y,data:{...l,placement:i}}}}},nle=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:o={fn:y=>{let{x,y:v}=y;return{x,y:v}}},...l}=bl(e,t),c={x:n,y:r},u=await Wx(t,l),h=fo(wl(a)),p=JT(h);let f=c[p],g=c[h];if(s){const y=p==="y"?"top":"left",x=p==="y"?"bottom":"right",v=f+u[y],b=f-u[x];f=B2(v,f,b)}if(i){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",v=g+u[y],b=g-u[x];g=B2(v,g,b)}const m=o.fn({...t,[p]:f,[h]:g});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[p]:s,[h]:i}}}}}},rle=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:s,middlewareData:i}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=bl(e,t),u={x:n,y:r},h=fo(a),p=JT(h);let f=u[p],g=u[h];const m=bl(o,t),y=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const b=p==="y"?"height":"width",w=s.reference[p]-s.floating[b]+y.mainAxis,k=s.reference[p]+s.reference[b]-y.mainAxis;f<w?f=w:f>k&&(f=k)}if(c){var x,v;const b=p==="y"?"width":"height",w=NU.has(wl(a)),k=s.reference[h]-s.floating[b]+(w&&((x=i.offset)==null?void 0:x[h])||0)+(w?0:y.crossAxis),I=s.reference[h]+s.reference[b]+(w?0:((v=i.offset)==null?void 0:v[h])||0)-(w?y.crossAxis:0);g<k?g=k:g>I&&(g=I)}return{[p]:f,[h]:g}}}},ale=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:a,rects:s,platform:i,elements:o}=t,{apply:l=()=>{},...c}=bl(e,t),u=await Wx(t,c),h=wl(a),p=Om(a),f=fo(a)==="y",{width:g,height:m}=s.floating;let y,x;h==="top"||h==="bottom"?(y=h,x=p===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(x=h,y=p==="end"?"top":"bottom");const v=m-u.top-u.bottom,b=g-u.left-u.right,w=Pu(m-u[y],v),k=Pu(g-u[x],b),I=!t.middlewareData.shift;let C=w,S=k;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(S=b),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(C=v),I&&!p){const T=Ts(u.left,0),$=Ts(u.right,0),_=Ts(u.top,0),M=Ts(u.bottom,0);f?S=g-2*(T!==0||$!==0?T+$:Ts(u.left,u.right)):C=m-2*(_!==0||M!==0?_+M:Ts(u.top,u.bottom))}await l({...t,availableWidth:S,availableHeight:C});const E=await i.getDimensions(o.floating);return g!==E.width||m!==E.height?{reset:{rects:!0}}:{}}}};function RN(){return typeof window<"u"}function Fm(e){return kU(e)?(e.nodeName||"").toLowerCase():"#document"}function Fs(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Fo(e){var t;return(t=(kU(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function kU(e){return RN()?e instanceof Node||e instanceof Fs(e).Node:!1}function Fi(e){return RN()?e instanceof Element||e instanceof Fs(e).Element:!1}function jo(e){return RN()?e instanceof HTMLElement||e instanceof Fs(e).HTMLElement:!1}function EF(e){return!RN()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Fs(e).ShadowRoot}const sle=new Set(["inline","contents"]);function Iv(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Pi(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!sle.has(a)}const ile=new Set(["table","td","th"]);function ole(e){return ile.has(Fm(e))}const lle=[":popover-open",":modal"];function DN(e){return lle.some(t=>{try{return e.matches(t)}catch{return!1}})}const ule=["transform","translate","scale","rotate","perspective"],cle=["transform","translate","scale","rotate","perspective","filter"],dle=["paint","layout","strict","content"];function tj(e){const t=nj(),n=Fi(e)?Pi(e):e;return ule.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||cle.some(r=>(n.willChange||"").includes(r))||dle.some(r=>(n.contain||"").includes(r))}function hle(e){let t=Lu(e);for(;jo(t)&&!em(t);){if(tj(t))return t;if(DN(t))return null;t=Lu(t)}return null}function nj(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const ple=new Set(["html","body","#document"]);function em(e){return ple.has(Fm(e))}function Pi(e){return Fs(e).getComputedStyle(e)}function MN(e){return Fi(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Lu(e){if(Fm(e)==="html")return e;const t=e.assignedSlot||e.parentNode||EF(e)&&e.host||Fo(e);return EF(t)?t.host:t}function SU(e){const t=Lu(e);return em(t)?e.ownerDocument?e.ownerDocument.body:e.body:jo(t)&&Iv(t)?t:SU(t)}function Vx(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=SU(e),s=a===((r=e.ownerDocument)==null?void 0:r.body),i=Fs(a);if(s){const o=W2(i);return t.concat(i,i.visualViewport||[],Iv(a)?a:[],o&&n?Vx(o):[])}return t.concat(a,Vx(a,[],n))}function W2(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function _U(e){const t=Pi(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=jo(e),s=a?e.offsetWidth:n,i=a?e.offsetHeight:r,o=u1(n)!==s||u1(r)!==i;return o&&(n=s,r=i),{width:n,height:r,$:o}}function rj(e){return Fi(e)?e:e.contextElement}function Cf(e){const t=rj(e);if(!jo(t))return No(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:s}=_U(t);let i=(s?u1(n.width):n.width)/r,o=(s?u1(n.height):n.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const fle=No(0);function CU(e){const t=Fs(e);return!nj()||!t.visualViewport?fle:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function mle(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Fs(e)?!1:t}function Sd(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),s=rj(e);let i=No(1);t&&(r?Fi(r)&&(i=Cf(r)):i=Cf(e));const o=mle(s,n,r)?CU(s):No(0);let l=(a.left+o.x)/i.x,c=(a.top+o.y)/i.y,u=a.width/i.x,h=a.height/i.y;if(s){const p=Fs(s),f=r&&Fi(r)?Fs(r):r;let g=p,m=W2(g);for(;m&&r&&f!==g;){const y=Cf(m),x=m.getBoundingClientRect(),v=Pi(m),b=x.left+(m.clientLeft+parseFloat(v.paddingLeft))*y.x,w=x.top+(m.clientTop+parseFloat(v.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,h*=y.y,l+=b,c+=w,g=Fs(m),m=W2(g)}}return d1({width:u,height:h,x:l,y:c})}function aj(e,t){const n=MN(e).scrollLeft;return t?t.left+n:Sd(Fo(e)).left+n}function IU(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),a=r.left+t.scrollLeft-(n?0:aj(e,r)),s=r.top+t.scrollTop;return{x:a,y:s}}function gle(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const s=a==="fixed",i=Fo(r),o=t?DN(t.floating):!1;if(r===i||o&&s)return n;let l={scrollLeft:0,scrollTop:0},c=No(1);const u=No(0),h=jo(r);if((h||!h&&!s)&&((Fm(r)!=="body"||Iv(i))&&(l=MN(r)),jo(r))){const f=Sd(r);c=Cf(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}const p=i&&!h&&!s?IU(i,l,!0):No(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+p.x,y:n.y*c.y-l.scrollTop*c.y+u.y+p.y}}function yle(e){return Array.from(e.getClientRects())}function xle(e){const t=Fo(e),n=MN(e),r=e.ownerDocument.body,a=Ts(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=Ts(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+aj(e);const o=-n.scrollTop;return Pi(r).direction==="rtl"&&(i+=Ts(t.clientWidth,r.clientWidth)-a),{width:a,height:s,x:i,y:o}}function vle(e,t){const n=Fs(e),r=Fo(e),a=n.visualViewport;let s=r.clientWidth,i=r.clientHeight,o=0,l=0;if(a){s=a.width,i=a.height;const c=nj();(!c||c&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:s,height:i,x:o,y:l}}const ble=new Set(["absolute","fixed"]);function wle(e,t){const n=Sd(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,s=jo(e)?Cf(e):No(1),i=e.clientWidth*s.x,o=e.clientHeight*s.y,l=a*s.x,c=r*s.y;return{width:i,height:o,x:l,y:c}}function TF(e,t,n){let r;if(t==="viewport")r=vle(e,n);else if(t==="document")r=xle(Fo(e));else if(Fi(t))r=wle(t,n);else{const a=CU(e);r={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return d1(r)}function EU(e,t){const n=Lu(e);return n===t||!Fi(n)||em(n)?!1:Pi(n).position==="fixed"||EU(n,t)}function Nle(e,t){const n=t.get(e);if(n)return n;let r=Vx(e,[],!1).filter(o=>Fi(o)&&Fm(o)!=="body"),a=null;const s=Pi(e).position==="fixed";let i=s?Lu(e):e;for(;Fi(i)&&!em(i);){const o=Pi(i),l=tj(i);!l&&o.position==="fixed"&&(a=null),(s?!l&&!a:!l&&o.position==="static"&&!!a&&ble.has(a.position)||Iv(i)&&!l&&EU(e,i))?r=r.filter(u=>u!==i):a=o,i=Lu(i)}return t.set(e,r),r}function kle(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const i=[...n==="clippingAncestors"?DN(t)?[]:Nle(t,this._c):[].concat(n),r],o=i[0],l=i.reduce((c,u)=>{const h=TF(t,u,a);return c.top=Ts(h.top,c.top),c.right=Pu(h.right,c.right),c.bottom=Pu(h.bottom,c.bottom),c.left=Ts(h.left,c.left),c},TF(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Sle(e){const{width:t,height:n}=_U(e);return{width:t,height:n}}function _le(e,t,n){const r=jo(t),a=Fo(t),s=n==="fixed",i=Sd(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=No(0);function c(){l.x=aj(a)}if(r||!r&&!s)if((Fm(t)!=="body"||Iv(a))&&(o=MN(t)),r){const f=Sd(t,!0,s,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else a&&c();s&&!r&&a&&c();const u=a&&!r&&!s?IU(a,o):No(0),h=i.left+o.scrollLeft-l.x-u.x,p=i.top+o.scrollTop-l.y-u.y;return{x:h,y:p,width:i.width,height:i.height}}function L_(e){return Pi(e).position==="static"}function jF(e,t){if(!jo(e)||Pi(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Fo(e)===n&&(n=n.ownerDocument.body),n}function TU(e,t){const n=Fs(e);if(DN(e))return n;if(!jo(e)){let a=Lu(e);for(;a&&!em(a);){if(Fi(a)&&!L_(a))return a;a=Lu(a)}return n}let r=jF(e,t);for(;r&&ole(r)&&L_(r);)r=jF(r,t);return r&&em(r)&&L_(r)&&!tj(r)?n:r||hle(e)||n}const Cle=async function(e){const t=this.getOffsetParent||TU,n=this.getDimensions,r=await n(e.floating);return{reference:_le(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Ile(e){return Pi(e).direction==="rtl"}const Ele={convertOffsetParentRelativeRectToViewportRelativeRect:gle,getDocumentElement:Fo,getClippingRect:kle,getOffsetParent:TU,getElementRects:Cle,getClientRects:yle,getDimensions:Sle,getScale:Cf,isElement:Fi,isRTL:Ile};function jU(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Tle(e,t){let n=null,r;const a=Fo(e);function s(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function i(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:u,top:h,width:p,height:f}=c;if(o||t(),!p||!f)return;const g=Iw(h),m=Iw(a.clientWidth-(u+p)),y=Iw(a.clientHeight-(h+f)),x=Iw(u),b={rootMargin:-g+"px "+-m+"px "+-y+"px "+-x+"px",threshold:Ts(0,Pu(1,l))||1};let w=!0;function k(I){const C=I[0].intersectionRatio;if(C!==l){if(!w)return i();C?i(!1,C):r=setTimeout(()=>{i(!1,1e-7)},1e3)}C===1&&!jU(c,e.getBoundingClientRect())&&i(),w=!1}try{n=new IntersectionObserver(k,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(k,b)}n.observe(e)}return i(!0),s}function jle(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=rj(e),u=a||s?[...c?Vx(c):[],...Vx(t)]:[];u.forEach(x=>{a&&x.addEventListener("scroll",n,{passive:!0}),s&&x.addEventListener("resize",n)});const h=c&&o?Tle(c,n):null;let p=-1,f=null;i&&(f=new ResizeObserver(x=>{let[v]=x;v&&v.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(t)})),n()}),c&&!l&&f.observe(c),f.observe(t));let g,m=l?Sd(e):null;l&&y();function y(){const x=Sd(e);m&&!jU(m,x)&&n(),m=x,g=requestAnimationFrame(y)}return n(),()=>{var x;u.forEach(v=>{a&&v.removeEventListener("scroll",n),s&&v.removeEventListener("resize",n)}),h==null||h(),(x=f)==null||x.disconnect(),f=null,l&&cancelAnimationFrame(g)}}const Ale=tle,$le=nle,Rle=Joe,Dle=ale,Mle=Zoe,AF=Yoe,Ole=rle,Fle=(e,t,n)=>{const r=new Map,a={platform:Ele,...n},s={...a.platform,_c:r};return Xoe(e,t,{...a,platform:s})};var Ple=typeof document<"u",Lle=function(){},y0=Ple?N.useLayoutEffect:Lle;function h1(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!h1(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const s=a[r];if(!(s==="_owner"&&e.$$typeof)&&!h1(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function AU(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function $F(e,t){const n=AU(e);return Math.round(t*n)/n}function z_(e){const t=N.useRef(e);return y0(()=>{t.current=e}),t}function zle(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:s,floating:i}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,h]=N.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,f]=N.useState(r);h1(p,r)||f(r);const[g,m]=N.useState(null),[y,x]=N.useState(null),v=N.useCallback(D=>{D!==I.current&&(I.current=D,m(D))},[]),b=N.useCallback(D=>{D!==C.current&&(C.current=D,x(D))},[]),w=s||g,k=i||y,I=N.useRef(null),C=N.useRef(null),S=N.useRef(u),E=l!=null,T=z_(l),$=z_(a),_=z_(c),M=N.useCallback(()=>{if(!I.current||!C.current)return;const D={placement:t,strategy:n,middleware:p};$.current&&(D.platform=$.current),Fle(I.current,C.current,D).then(R=>{const V={...R,isPositioned:_.current!==!1};L.current&&!h1(S.current,V)&&(S.current=V,eh.flushSync(()=>{h(V)}))})},[p,t,n,$,_]);y0(()=>{c===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,h(D=>({...D,isPositioned:!1})))},[c]);const L=N.useRef(!1);y0(()=>(L.current=!0,()=>{L.current=!1}),[]),y0(()=>{if(w&&(I.current=w),k&&(C.current=k),w&&k){if(T.current)return T.current(w,k,M);M()}},[w,k,M,T,E]);const U=N.useMemo(()=>({reference:I,floating:C,setReference:v,setFloating:b}),[v,b]),O=N.useMemo(()=>({reference:w,floating:k}),[w,k]),F=N.useMemo(()=>{const D={position:n,left:0,top:0};if(!O.floating)return D;const R=$F(O.floating,u.x),V=$F(O.floating,u.y);return o?{...D,transform:"translate("+R+"px, "+V+"px)",...AU(O.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:R,top:V}},[n,o,O.floating,u.x,u.y]);return N.useMemo(()=>({...u,update:M,refs:U,elements:O,floatingStyles:F}),[u,M,U,O,F])}const Ble=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?AF({element:r.current,padding:a}).fn(n):{}:r?AF({element:r,padding:a}).fn(n):{}}}},Ule=(e,t)=>({...Ale(e),options:[e,t]}),Wle=(e,t)=>({...$le(e),options:[e,t]}),Vle=(e,t)=>({...Ole(e),options:[e,t]}),Hle=(e,t)=>({...Rle(e),options:[e,t]}),Gle=(e,t)=>({...Dle(e),options:[e,t]}),qle=(e,t)=>({...Mle(e),options:[e,t]}),Kle=(e,t)=>({...Ble(e),options:[e,t]});var Qle="Arrow",$U=N.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...s}=e;return d.jsx(Qe.svg,{...s,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:d.jsx("polygon",{points:"0,0 30,0 15,10"})})});$U.displayName=Qle;var Xle=$U;function sj(e){const[t,n]=N.useState(void 0);return fr(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const s=a[0];let i,o;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,o=c.blockSize}else i=e.offsetWidth,o=e.offsetHeight;n({width:i,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var ij="Popper",[RU,lc]=ia(ij),[Yle,DU]=RU(ij),MU=e=>{const{__scopePopper:t,children:n}=e,[r,a]=N.useState(null);return d.jsx(Yle,{scope:t,anchor:r,onAnchorChange:a,children:n})};MU.displayName=ij;var OU="PopperAnchor",FU=N.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,s=DU(OU,n),i=N.useRef(null),o=kt(t,i);return N.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:d.jsx(Qe.div,{...a,ref:o})});FU.displayName=OU;var oj="PopperContent",[Jle,Zle]=RU(oj),PU=N.forwardRef((e,t)=>{var ie,oe,q,de,ye,be;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:s="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:g,...m}=e,y=DU(oj,n),[x,v]=N.useState(null),b=kt(t,Ce=>v(Ce)),[w,k]=N.useState(null),I=sj(w),C=(I==null?void 0:I.width)??0,S=(I==null?void 0:I.height)??0,E=r+(s!=="center"?"-"+s:""),T=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},$=Array.isArray(c)?c:[c],_=$.length>0,M={padding:T,boundary:$.filter(tue),altBoundary:_},{refs:L,floatingStyles:U,placement:O,isPositioned:F,middlewareData:D}=zle({strategy:"fixed",placement:E,whileElementsMounted:(...Ce)=>jle(...Ce,{animationFrame:f==="always"}),elements:{reference:y.anchor},middleware:[Ule({mainAxis:a+S,alignmentAxis:i}),l&&Wle({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?Vle():void 0,...M}),l&&Hle({...M}),Gle({...M,apply:({elements:Ce,rects:se,availableWidth:ae,availableHeight:ue})=>{const{width:ke,height:_e}=se.reference,qe=Ce.floating.style;qe.setProperty("--radix-popper-available-width",`${ae}px`),qe.setProperty("--radix-popper-available-height",`${ue}px`),qe.setProperty("--radix-popper-anchor-width",`${ke}px`),qe.setProperty("--radix-popper-anchor-height",`${_e}px`)}}),w&&Kle({element:w,padding:o}),nue({arrowWidth:C,arrowHeight:S}),p&&qle({strategy:"referenceHidden",...M})]}),[R,V]=BU(O),G=rr(g);fr(()=>{F&&(G==null||G())},[F,G]);const W=(ie=D.arrow)==null?void 0:ie.x,B=(oe=D.arrow)==null?void 0:oe.y,Q=((q=D.arrow)==null?void 0:q.centerOffset)!==0,[X,pe]=N.useState();return fr(()=>{x&&pe(window.getComputedStyle(x).zIndex)},[x]),d.jsx("div",{ref:L.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:F?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(de=D.transformOrigin)==null?void 0:de.x,(ye=D.transformOrigin)==null?void 0:ye.y].join(" "),...((be=D.hide)==null?void 0:be.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:d.jsx(Jle,{scope:n,placedSide:R,onArrowChange:k,arrowX:W,arrowY:B,shouldHideArrow:Q,children:d.jsx(Qe.div,{"data-side":R,"data-align":V,...m,ref:b,style:{...m.style,animation:F?void 0:"none"}})})})});PU.displayName=oj;var LU="PopperArrow",eue={top:"bottom",right:"left",bottom:"top",left:"right"},zU=N.forwardRef(function(t,n){const{__scopePopper:r,...a}=t,s=Zle(LU,r),i=eue[s.placedSide];return d.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:d.jsx(Xle,{...a,ref:n,style:{...a.style,display:"block"}})})});zU.displayName=LU;function tue(e){return e!==null}var nue=e=>({name:"transformOrigin",options:e,fn(t){var y,x,v;const{placement:n,rects:r,middlewareData:a}=t,i=((y=a.arrow)==null?void 0:y.centerOffset)!==0,o=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[c,u]=BU(n),h={start:"0%",center:"50%",end:"100%"}[u],p=(((x=a.arrow)==null?void 0:x.x)??0)+o/2,f=(((v=a.arrow)==null?void 0:v.y)??0)+l/2;let g="",m="";return c==="bottom"?(g=i?h:`${p}px`,m=`${-l}px`):c==="top"?(g=i?h:`${p}px`,m=`${r.floating.height+l}px`):c==="right"?(g=`${-l}px`,m=i?h:`${f}px`):c==="left"&&(g=`${r.floating.width+l}px`,m=i?h:`${f}px`),{data:{x:g,y:m}}}});function BU(e){const[t,n="center"]=e.split("-");return[t,n]}var lj=MU,Ev=FU,ON=PU,FN=zU,[PN,oat]=ia("Tooltip",[lc]),uj=lc(),UU="TooltipProvider",rue=700,RF="tooltip.open",[aue,WU]=PN(UU),VU=e=>{const{__scopeTooltip:t,delayDuration:n=rue,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:s}=e,i=N.useRef(!0),o=N.useRef(!1),l=N.useRef(0);return N.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),d.jsx(aue,{scope:t,isOpenDelayedRef:i,delayDuration:n,onOpen:N.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:N.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:N.useCallback(c=>{o.current=c},[]),disableHoverableContent:a,children:s})};VU.displayName=UU;var HU="Tooltip",[lat,LN]=PN(HU),V2="TooltipTrigger",sue=N.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=LN(V2,n),s=WU(V2,n),i=uj(n),o=N.useRef(null),l=kt(t,o,a.onTriggerChange),c=N.useRef(!1),u=N.useRef(!1),h=N.useCallback(()=>c.current=!1,[]);return N.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),d.jsx(Ev,{asChild:!0,...i,children:d.jsx(Qe.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:l,onPointerMove:Te(e.onPointerMove,p=>{p.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:Te(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:Te(e.onPointerDown,()=>{a.open&&a.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Te(e.onFocus,()=>{c.current||a.onOpen()}),onBlur:Te(e.onBlur,a.onClose),onClick:Te(e.onClick,a.onClose)})})});sue.displayName=V2;var iue="TooltipPortal",[uat,oue]=PN(iue,{forceMount:void 0}),tm="TooltipContent",GU=N.forwardRef((e,t)=>{const n=oue(tm,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...s}=e,i=LN(tm,e.__scopeTooltip);return d.jsx(Lr,{present:r||i.open,children:i.disableHoverableContent?d.jsx(qU,{side:a,...s,ref:t}):d.jsx(lue,{side:a,...s,ref:t})})}),lue=N.forwardRef((e,t)=>{const n=LN(tm,e.__scopeTooltip),r=WU(tm,e.__scopeTooltip),a=N.useRef(null),s=kt(t,a),[i,o]=N.useState(null),{trigger:l,onClose:c}=n,u=a.current,{onPointerInTransitChange:h}=r,p=N.useCallback(()=>{o(null),h(!1)},[h]),f=N.useCallback((g,m)=>{const y=g.currentTarget,x={x:g.clientX,y:g.clientY},v=pue(x,y.getBoundingClientRect()),b=fue(x,v),w=mue(m.getBoundingClientRect()),k=yue([...b,...w]);o(k),h(!0)},[h]);return N.useEffect(()=>()=>p(),[p]),N.useEffect(()=>{if(l&&u){const g=y=>f(y,u),m=y=>f(y,l);return l.addEventListener("pointerleave",g),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",m)}}},[l,u,f,p]),N.useEffect(()=>{if(i){const g=m=>{const y=m.target,x={x:m.clientX,y:m.clientY},v=(l==null?void 0:l.contains(y))||(u==null?void 0:u.contains(y)),b=!gue(x,i);v?p():b&&(p(),c())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,u,i,c,p]),d.jsx(qU,{...e,ref:s})}),[uue,cue]=PN(HU,{isInside:!1}),due=Wre("TooltipContent"),qU=N.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:s,onPointerDownOutside:i,...o}=e,l=LN(tm,n),c=uj(n),{onClose:u}=l;return N.useEffect(()=>(document.addEventListener(RF,u),()=>document.removeEventListener(RF,u)),[u]),N.useEffect(()=>{if(l.trigger){const h=p=>{const f=p.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),d.jsx(th,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:d.jsxs(ON,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[d.jsx(due,{children:r}),d.jsx(uue,{scope:n,isInside:!0,children:d.jsx(dae,{id:l.contentId,role:"tooltip",children:a||r})})]})})});GU.displayName=tm;var KU="TooltipArrow",hue=N.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=uj(n);return cue(KU,n).isInside?null:d.jsx(FN,{...a,...r,ref:t})});hue.displayName=KU;function pue(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(n,r,a,s)){case s:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function fue(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function mue(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function gue(e,t){const{x:n,y:r}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],l=t[i],c=o.x,u=o.y,h=l.x,p=l.y;u>r!=p>r&&n<(h-c)*(r-u)/(p-u)+c&&(a=!a)}return a}function yue(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),xue(t)}function xue(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const s=t[t.length-1],i=t[t.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const s=n[n.length-1],i=n[n.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var vue=VU,QU=GU;const bue=vue,wue=N.forwardRef(({className:e,sideOffset:t=4,...n},r)=>d.jsx(QU,{ref:r,sideOffset:t,className:Fe("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));wue.displayName=QU.displayName;var Pm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},_d=typeof window>"u"||"Deno"in globalThis;function Da(){}function Nue(e,t){return typeof e=="function"?e(t):e}function H2(e){return typeof e=="number"&&e>=0&&e!==1/0}function XU(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Tu(e,t){return typeof e=="function"?e(t):e}function Zs(e,t){return typeof e=="function"?e(t):e}function DF(e,t){const{type:n="all",exact:r,fetchStatus:a,predicate:s,queryKey:i,stale:o}=e;if(i){if(r){if(t.queryHash!==cj(i,t.options))return!1}else if(!Hx(t.queryKey,i))return!1}if(n!=="all"){const l=t.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||s&&!s(t))}function MF(e,t){const{exact:n,status:r,predicate:a,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(n){if(Cd(t.options.mutationKey)!==Cd(s))return!1}else if(!Hx(t.options.mutationKey,s))return!1}return!(r&&t.state.status!==r||a&&!a(t))}function cj(e,t){return((t==null?void 0:t.queryKeyHashFn)||Cd)(e)}function Cd(e){return JSON.stringify(e,(t,n)=>G2(n)?Object.keys(n).sort().reduce((r,a)=>(r[a]=n[a],r),{}):n)}function Hx(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Hx(e[n],t[n])):!1}function YU(e,t){if(e===t)return e;const n=OF(e)&&OF(t);if(n||G2(e)&&G2(t)){const r=n?e:Object.keys(e),a=r.length,s=n?t:Object.keys(t),i=s.length,o=n?[]:{},l=new Set(r);let c=0;for(let u=0;u<i;u++){const h=n?u:s[u];(!n&&l.has(h)||n)&&e[h]===void 0&&t[h]===void 0?(o[h]=void 0,c++):(o[h]=YU(e[h],t[h]),o[h]===e[h]&&e[h]!==void 0&&c++)}return a===i&&c===a?e:o}return t}function p1(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function OF(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function G2(e){if(!FF(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!FF(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function FF(e){return Object.prototype.toString.call(e)==="[object Object]"}function kue(e){return new Promise(t=>{setTimeout(t,e)})}function q2(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?YU(e,t):t}function Sue(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function _ue(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var dj=Symbol();function JU(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===dj?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function ZU(e,t){return typeof e=="function"?e(...t):!!e}var ed,ru,Df,K3,Cue=(K3=class extends Pm{constructor(){super();rt(this,ed);rt(this,ru);rt(this,Df);We(this,Df,t=>{if(!_d&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ne(this,ru)||this.setEventListener(ne(this,Df))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,ru))==null||t.call(this),We(this,ru,void 0))}setEventListener(t){var n;We(this,Df,t),(n=ne(this,ru))==null||n.call(this),We(this,ru,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){ne(this,ed)!==t&&(We(this,ed,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof ne(this,ed)=="boolean"?ne(this,ed):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ed=new WeakMap,ru=new WeakMap,Df=new WeakMap,K3),hj=new Cue,Mf,au,Of,Q3,Iue=(Q3=class extends Pm{constructor(){super();rt(this,Mf,!0);rt(this,au);rt(this,Of);We(this,Of,t=>{if(!_d&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){ne(this,au)||this.setEventListener(ne(this,Of))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,au))==null||t.call(this),We(this,au,void 0))}setEventListener(t){var n;We(this,Of,t),(n=ne(this,au))==null||n.call(this),We(this,au,t(this.setOnline.bind(this)))}setOnline(t){ne(this,Mf)!==t&&(We(this,Mf,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return ne(this,Mf)}},Mf=new WeakMap,au=new WeakMap,Of=new WeakMap,Q3),f1=new Iue;function K2(){let e,t;const n=new Promise((a,s)=>{e=a,t=s});n.status="pending",n.catch(()=>{});function r(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{r({status:"fulfilled",value:a}),e(a)},n.reject=a=>{r({status:"rejected",reason:a}),t(a)},n}function Eue(e){return Math.min(1e3*2**e,3e4)}function eW(e){return(e??"online")==="online"?f1.isOnline():!0}var tW=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function B_(e){return e instanceof tW}function nW(e){let t=!1,n=0,r=!1,a;const s=K2(),i=m=>{var y;r||(p(new tW(m)),(y=e.abort)==null||y.call(e))},o=()=>{t=!0},l=()=>{t=!1},c=()=>hj.isFocused()&&(e.networkMode==="always"||f1.isOnline())&&e.canRun(),u=()=>eW(e.networkMode)&&e.canRun(),h=m=>{var y;r||(r=!0,(y=e.onSuccess)==null||y.call(e,m),a==null||a(),s.resolve(m))},p=m=>{var y;r||(r=!0,(y=e.onError)==null||y.call(e,m),a==null||a(),s.reject(m))},f=()=>new Promise(m=>{var y;a=x=>{(r||c())&&m(x)},(y=e.onPause)==null||y.call(e)}).then(()=>{var m;a=void 0,r||(m=e.onContinue)==null||m.call(e)}),g=()=>{if(r)return;let m;const y=n===0?e.initialPromise:void 0;try{m=y??e.fn()}catch(x){m=Promise.reject(x)}Promise.resolve(m).then(h).catch(x=>{var I;if(r)return;const v=e.retry??(_d?0:3),b=e.retryDelay??Eue,w=typeof b=="function"?b(n,x):b,k=v===!0||typeof v=="number"&&n<v||typeof v=="function"&&v(n,x);if(t||!k){p(x);return}n++,(I=e.onFail)==null||I.call(e,n,x),kue(w).then(()=>c()?void 0:f()).then(()=>{t?p(x):g()})})};return{promise:s,cancel:i,continue:()=>(a==null||a(),s),cancelRetry:o,continueRetry:l,canStart:u,start:()=>(u()?g():f().then(g),s)}}var Tue=e=>setTimeout(e,0);function jue(){let e=[],t=0,n=o=>{o()},r=o=>{o()},a=Tue;const s=o=>{t?e.push(o):a(()=>{n(o)})},i=()=>{const o=e;e=[],o.length&&a(()=>{r(()=>{o.forEach(l=>{n(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{a=o}}}var Tr=jue(),td,X3,rW=(X3=class{constructor(){rt(this,td)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),H2(this.gcTime)&&We(this,td,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(_d?1/0:5*60*1e3))}clearGcTimeout(){ne(this,td)&&(clearTimeout(ne(this,td)),We(this,td,void 0))}},td=new WeakMap,X3),Ff,nd,Xs,rd,pa,gv,ad,ki,Qo,Y3,Aue=(Y3=class extends rW{constructor(t){super();rt(this,ki);rt(this,Ff);rt(this,nd);rt(this,Xs);rt(this,rd);rt(this,pa);rt(this,gv);rt(this,ad);We(this,ad,!1),We(this,gv,t.defaultOptions),this.setOptions(t.options),this.observers=[],We(this,rd,t.client),We(this,Xs,ne(this,rd).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,We(this,Ff,$ue(this.options)),this.state=t.state??ne(this,Ff),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ne(this,pa))==null?void 0:t.promise}setOptions(t){this.options={...ne(this,gv),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ne(this,Xs).remove(this)}setData(t,n){const r=q2(this.state.data,t,this.options);return zt(this,ki,Qo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){zt(this,ki,Qo).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,a;const n=(r=ne(this,pa))==null?void 0:r.promise;return(a=ne(this,pa))==null||a.cancel(t),n?n.then(Da).catch(Da):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ne(this,Ff))}isActive(){return this.observers.some(t=>Zs(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===dj||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Tu(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!XU(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,pa))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,pa))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ne(this,Xs).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(ne(this,pa)&&(ne(this,ad)?ne(this,pa).cancel({revert:!0}):ne(this,pa).cancelRetry()),this.scheduleGc()),ne(this,Xs).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||zt(this,ki,Qo).call(this,{type:"invalidate"})}fetch(t,n){var c,u,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ne(this,pa))return ne(this,pa).continueRetry(),ne(this,pa).promise}if(t&&this.setOptions(t),!this.options.queryFn){const p=this.observers.find(f=>f.options.queryFn);p&&this.setOptions(p.options)}const r=new AbortController,a=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(We(this,ad,!0),r.signal)})},s=()=>{const p=JU(this.options,n),g=(()=>{const m={client:ne(this,rd),queryKey:this.queryKey,meta:this.meta};return a(m),m})();return We(this,ad,!1),this.options.persister?this.options.persister(p,g,this):p(g)},o=(()=>{const p={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:ne(this,rd),state:this.state,fetchFn:s};return a(p),p})();(c=this.options.behavior)==null||c.onFetch(o,this),We(this,nd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&zt(this,ki,Qo).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta});const l=p=>{var f,g,m,y;B_(p)&&p.silent||zt(this,ki,Qo).call(this,{type:"error",error:p}),B_(p)||((g=(f=ne(this,Xs).config).onError)==null||g.call(f,p,this),(y=(m=ne(this,Xs).config).onSettled)==null||y.call(m,this.state.data,p,this)),this.scheduleGc()};return We(this,pa,nW({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,abort:r.abort.bind(r),onSuccess:p=>{var f,g,m,y;if(p===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(x){l(x);return}(g=(f=ne(this,Xs).config).onSuccess)==null||g.call(f,p,this),(y=(m=ne(this,Xs).config).onSettled)==null||y.call(m,p,this.state.error,this),this.scheduleGc()},onError:l,onFail:(p,f)=>{zt(this,ki,Qo).call(this,{type:"failed",failureCount:p,error:f})},onPause:()=>{zt(this,ki,Qo).call(this,{type:"pause"})},onContinue:()=>{zt(this,ki,Qo).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),ne(this,pa).start()}},Ff=new WeakMap,nd=new WeakMap,Xs=new WeakMap,rd=new WeakMap,pa=new WeakMap,gv=new WeakMap,ad=new WeakMap,ki=new WeakSet,Qo=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...aW(r.data,this.options),fetchMeta:t.meta??null};case"success":return We(this,nd,void 0),{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return B_(a)&&a.revert&&ne(this,nd)?{...ne(this,nd),fetchStatus:"idle"}:{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Tr.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),ne(this,Xs).notify({query:this,type:"updated",action:t})})},Y3);function aW(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:eW(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function $ue(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var so,J3,Rue=(J3=class extends Pm{constructor(t={}){super();rt(this,so);this.config=t,We(this,so,new Map)}build(t,n,r){const a=n.queryKey,s=n.queryHash??cj(a,n);let i=this.get(s);return i||(i=new Aue({client:t,queryKey:a,queryHash:s,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){ne(this,so).has(t.queryHash)||(ne(this,so).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=ne(this,so).get(t.queryHash);n&&(t.destroy(),n===t&&ne(this,so).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Tr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ne(this,so).get(t)}getAll(){return[...ne(this,so).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>DF(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>DF(t,r)):n}notify(t){Tr.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Tr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Tr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},so=new WeakMap,J3),io,Aa,sd,oo,Ul,Z3,Due=(Z3=class extends rW{constructor(t){super();rt(this,oo);rt(this,io);rt(this,Aa);rt(this,sd);this.mutationId=t.mutationId,We(this,Aa,t.mutationCache),We(this,io,[]),this.state=t.state||sW(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ne(this,io).includes(t)||(ne(this,io).push(t),this.clearGcTimeout(),ne(this,Aa).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){We(this,io,ne(this,io).filter(n=>n!==t)),this.scheduleGc(),ne(this,Aa).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ne(this,io).length||(this.state.status==="pending"?this.scheduleGc():ne(this,Aa).remove(this))}continue(){var t;return((t=ne(this,sd))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,i,o,l,c,u,h,p,f,g,m,y,x,v,b,w,k,I,C,S;const n=()=>{zt(this,oo,Ul).call(this,{type:"continue"})};We(this,sd,nW({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(E,T)=>{zt(this,oo,Ul).call(this,{type:"failed",failureCount:E,error:T})},onPause:()=>{zt(this,oo,Ul).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ne(this,Aa).canRun(this)}));const r=this.state.status==="pending",a=!ne(this,sd).canStart();try{if(r)n();else{zt(this,oo,Ul).call(this,{type:"pending",variables:t,isPaused:a}),await((i=(s=ne(this,Aa).config).onMutate)==null?void 0:i.call(s,t,this));const T=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,t));T!==this.state.context&&zt(this,oo,Ul).call(this,{type:"pending",context:T,variables:t,isPaused:a})}const E=await ne(this,sd).start();return await((u=(c=ne(this,Aa).config).onSuccess)==null?void 0:u.call(c,E,t,this.state.context,this)),await((p=(h=this.options).onSuccess)==null?void 0:p.call(h,E,t,this.state.context)),await((g=(f=ne(this,Aa).config).onSettled)==null?void 0:g.call(f,E,null,this.state.variables,this.state.context,this)),await((y=(m=this.options).onSettled)==null?void 0:y.call(m,E,null,t,this.state.context)),zt(this,oo,Ul).call(this,{type:"success",data:E}),E}catch(E){try{throw await((v=(x=ne(this,Aa).config).onError)==null?void 0:v.call(x,E,t,this.state.context,this)),await((w=(b=this.options).onError)==null?void 0:w.call(b,E,t,this.state.context)),await((I=(k=ne(this,Aa).config).onSettled)==null?void 0:I.call(k,void 0,E,this.state.variables,this.state.context,this)),await((S=(C=this.options).onSettled)==null?void 0:S.call(C,void 0,E,t,this.state.context)),E}finally{zt(this,oo,Ul).call(this,{type:"error",error:E})}}finally{ne(this,Aa).runNext(this)}}},io=new WeakMap,Aa=new WeakMap,sd=new WeakMap,oo=new WeakSet,Ul=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Tr.batch(()=>{ne(this,io).forEach(r=>{r.onMutationUpdate(t)}),ne(this,Aa).notify({mutation:this,type:"updated",action:t})})},Z3);function sW(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var rl,Si,yv,e4,Mue=(e4=class extends Pm{constructor(t={}){super();rt(this,rl);rt(this,Si);rt(this,yv);this.config=t,We(this,rl,new Set),We(this,Si,new Map),We(this,yv,0)}build(t,n,r){const a=new Due({mutationCache:this,mutationId:++iw(this,yv)._,options:t.defaultMutationOptions(n),state:r});return this.add(a),a}add(t){ne(this,rl).add(t);const n=Ew(t);if(typeof n=="string"){const r=ne(this,Si).get(n);r?r.push(t):ne(this,Si).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ne(this,rl).delete(t)){const n=Ew(t);if(typeof n=="string"){const r=ne(this,Si).get(n);if(r)if(r.length>1){const a=r.indexOf(t);a!==-1&&r.splice(a,1)}else r[0]===t&&ne(this,Si).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Ew(t);if(typeof n=="string"){const r=ne(this,Si).get(n),a=r==null?void 0:r.find(s=>s.state.status==="pending");return!a||a===t}else return!0}runNext(t){var r;const n=Ew(t);if(typeof n=="string"){const a=(r=ne(this,Si).get(n))==null?void 0:r.find(s=>s!==t&&s.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Tr.batch(()=>{ne(this,rl).forEach(t=>{this.notify({type:"removed",mutation:t})}),ne(this,rl).clear(),ne(this,Si).clear()})}getAll(){return Array.from(ne(this,rl))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>MF(n,r))}findAll(t={}){return this.getAll().filter(n=>MF(t,n))}notify(t){Tr.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Tr.batch(()=>Promise.all(t.map(n=>n.continue().catch(Da))))}},rl=new WeakMap,Si=new WeakMap,yv=new WeakMap,e4);function Ew(e){var t;return(t=e.options.scope)==null?void 0:t.id}function PF(e){return{onFetch:(t,n)=>{var u,h,p,f,g;const r=t.options,a=(p=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,s=((f=t.state.data)==null?void 0:f.pages)||[],i=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let m=!1;const y=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},x=JU(t.options,t.fetchOptions),v=async(b,w,k)=>{if(m)return Promise.reject();if(w==null&&b.pages.length)return Promise.resolve(b);const C=(()=>{const $={client:t.client,queryKey:t.queryKey,pageParam:w,direction:k?"backward":"forward",meta:t.options.meta};return y($),$})(),S=await x(C),{maxPages:E}=t.options,T=k?_ue:Sue;return{pages:T(b.pages,S,E),pageParams:T(b.pageParams,w,E)}};if(a&&s.length){const b=a==="backward",w=b?Oue:LF,k={pages:s,pageParams:i},I=w(r,k);o=await v(k,I,b)}else{const b=e??s.length;do{const w=l===0?i[0]??r.initialPageParam:LF(r,o);if(l>0&&w==null)break;o=await v(o,w),l++}while(l<b)}return o};t.options.persister?t.fetchFn=()=>{var m,y;return(y=(m=t.options).persister)==null?void 0:y.call(m,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=c}}}function LF(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function Oue(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var tr,su,iu,Pf,Lf,ou,zf,Bf,t4,Fue=(t4=class{constructor(e={}){rt(this,tr);rt(this,su);rt(this,iu);rt(this,Pf);rt(this,Lf);rt(this,ou);rt(this,zf);rt(this,Bf);We(this,tr,e.queryCache||new Rue),We(this,su,e.mutationCache||new Mue),We(this,iu,e.defaultOptions||{}),We(this,Pf,new Map),We(this,Lf,new Map),We(this,ou,0)}mount(){iw(this,ou)._++,ne(this,ou)===1&&(We(this,zf,hj.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,tr).onFocus())})),We(this,Bf,f1.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,tr).onOnline())})))}unmount(){var e,t;iw(this,ou)._--,ne(this,ou)===0&&((e=ne(this,zf))==null||e.call(this),We(this,zf,void 0),(t=ne(this,Bf))==null||t.call(this),We(this,Bf,void 0))}isFetching(e){return ne(this,tr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ne(this,su).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,tr).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=ne(this,tr).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Tu(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return ne(this,tr).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),a=ne(this,tr).get(r.queryHash),s=a==null?void 0:a.state.data,i=Nue(t,s);if(i!==void 0)return ne(this,tr).build(this,r).setData(i,{...n,manual:!0})}setQueriesData(e,t,n){return Tr.batch(()=>ne(this,tr).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,tr).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=ne(this,tr);Tr.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=ne(this,tr);return Tr.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=Tr.batch(()=>ne(this,tr).findAll(e).map(a=>a.cancel(n)));return Promise.all(r).then(Da).catch(Da)}invalidateQueries(e,t={}){return Tr.batch(()=>(ne(this,tr).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=Tr.batch(()=>ne(this,tr).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,n);return n.throwOnError||(s=s.catch(Da)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(Da)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=ne(this,tr).build(this,t);return n.isStaleByTime(Tu(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Da).catch(Da)}fetchInfiniteQuery(e){return e.behavior=PF(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Da).catch(Da)}ensureInfiniteQueryData(e){return e.behavior=PF(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return f1.isOnline()?ne(this,su).resumePausedMutations():Promise.resolve()}getQueryCache(){return ne(this,tr)}getMutationCache(){return ne(this,su)}getDefaultOptions(){return ne(this,iu)}setDefaultOptions(e){We(this,iu,e)}setQueryDefaults(e,t){ne(this,Pf).set(Cd(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ne(this,Pf).values()],n={};return t.forEach(r=>{Hx(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){ne(this,Lf).set(Cd(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ne(this,Lf).values()],n={};return t.forEach(r=>{Hx(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ne(this,iu).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=cj(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===dj&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ne(this,iu).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ne(this,tr).clear(),ne(this,su).clear()}},tr=new WeakMap,su=new WeakMap,iu=new WeakMap,Pf=new WeakMap,Lf=new WeakMap,ou=new WeakMap,zf=new WeakMap,Bf=new WeakMap,t4),Za,Zt,xv,$a,id,Uf,lu,uu,vv,Wf,Vf,od,ld,cu,Hf,pn,Vy,Q2,X2,Y2,J2,Z2,eI,tI,iW,n4,Pue=(n4=class extends Pm{constructor(t,n){super();rt(this,pn);rt(this,Za);rt(this,Zt);rt(this,xv);rt(this,$a);rt(this,id);rt(this,Uf);rt(this,lu);rt(this,uu);rt(this,vv);rt(this,Wf);rt(this,Vf);rt(this,od);rt(this,ld);rt(this,cu);rt(this,Hf,new Set);this.options=n,We(this,Za,t),We(this,uu,null),We(this,lu,K2()),this.options.experimental_prefetchInRender||ne(this,lu).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ne(this,Zt).addObserver(this),zF(ne(this,Zt),this.options)?zt(this,pn,Vy).call(this):this.updateResult(),zt(this,pn,J2).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return nI(ne(this,Zt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return nI(ne(this,Zt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,zt(this,pn,Z2).call(this),zt(this,pn,eI).call(this),ne(this,Zt).removeObserver(this)}setOptions(t){const n=this.options,r=ne(this,Zt);if(this.options=ne(this,Za).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Zs(this.options.enabled,ne(this,Zt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");zt(this,pn,tI).call(this),ne(this,Zt).setOptions(this.options),n._defaulted&&!p1(this.options,n)&&ne(this,Za).getQueryCache().notify({type:"observerOptionsUpdated",query:ne(this,Zt),observer:this});const a=this.hasListeners();a&&BF(ne(this,Zt),r,this.options,n)&&zt(this,pn,Vy).call(this),this.updateResult(),a&&(ne(this,Zt)!==r||Zs(this.options.enabled,ne(this,Zt))!==Zs(n.enabled,ne(this,Zt))||Tu(this.options.staleTime,ne(this,Zt))!==Tu(n.staleTime,ne(this,Zt)))&&zt(this,pn,Q2).call(this);const s=zt(this,pn,X2).call(this);a&&(ne(this,Zt)!==r||Zs(this.options.enabled,ne(this,Zt))!==Zs(n.enabled,ne(this,Zt))||s!==ne(this,cu))&&zt(this,pn,Y2).call(this,s)}getOptimisticResult(t){const n=ne(this,Za).getQueryCache().build(ne(this,Za),t),r=this.createResult(n,t);return zue(this,r)&&(We(this,$a,r),We(this,Uf,this.options),We(this,id,ne(this,Zt).state)),r}getCurrentResult(){return ne(this,$a)}trackResult(t,n){return new Proxy(t,{get:(r,a)=>(this.trackProp(a),n==null||n(a),Reflect.get(r,a))})}trackProp(t){ne(this,Hf).add(t)}getCurrentQuery(){return ne(this,Zt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=ne(this,Za).defaultQueryOptions(t),r=ne(this,Za).getQueryCache().build(ne(this,Za),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return zt(this,pn,Vy).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ne(this,$a)))}createResult(t,n){var E;const r=ne(this,Zt),a=this.options,s=ne(this,$a),i=ne(this,id),o=ne(this,Uf),c=t!==r?t.state:ne(this,xv),{state:u}=t;let h={...u},p=!1,f;if(n._optimisticResults){const T=this.hasListeners(),$=!T&&zF(t,n),_=T&&BF(t,r,n,a);($||_)&&(h={...h,...aW(u.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:m,status:y}=h;f=h.data;let x=!1;if(n.placeholderData!==void 0&&f===void 0&&y==="pending"){let T;s!=null&&s.isPlaceholderData&&n.placeholderData===(o==null?void 0:o.placeholderData)?(T=s.data,x=!0):T=typeof n.placeholderData=="function"?n.placeholderData((E=ne(this,Vf))==null?void 0:E.state.data,ne(this,Vf)):n.placeholderData,T!==void 0&&(y="success",f=q2(s==null?void 0:s.data,T,n),p=!0)}if(n.select&&f!==void 0&&!x)if(s&&f===(i==null?void 0:i.data)&&n.select===ne(this,vv))f=ne(this,Wf);else try{We(this,vv,n.select),f=n.select(f),f=q2(s==null?void 0:s.data,f,n),We(this,Wf,f),We(this,uu,null)}catch(T){We(this,uu,T)}ne(this,uu)&&(g=ne(this,uu),f=ne(this,Wf),m=Date.now(),y="error");const v=h.fetchStatus==="fetching",b=y==="pending",w=y==="error",k=b&&v,I=f!==void 0,S={status:y,fetchStatus:h.fetchStatus,isPending:b,isSuccess:y==="success",isError:w,isInitialLoading:k,isLoading:k,data:f,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:m,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>c.dataUpdateCount||h.errorUpdateCount>c.errorUpdateCount,isFetching:v,isRefetching:v&&!b,isLoadingError:w&&!I,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&I,isStale:pj(t,n),refetch:this.refetch,promise:ne(this,lu),isEnabled:Zs(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=M=>{S.status==="error"?M.reject(S.error):S.data!==void 0&&M.resolve(S.data)},$=()=>{const M=We(this,lu,S.promise=K2());T(M)},_=ne(this,lu);switch(_.status){case"pending":t.queryHash===r.queryHash&&T(_);break;case"fulfilled":(S.status==="error"||S.data!==_.value)&&$();break;case"rejected":(S.status!=="error"||S.error!==_.reason)&&$();break}}return S}updateResult(){const t=ne(this,$a),n=this.createResult(ne(this,Zt),this.options);if(We(this,id,ne(this,Zt).state),We(this,Uf,this.options),ne(this,id).data!==void 0&&We(this,Vf,ne(this,Zt)),p1(n,t))return;We(this,$a,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,s=typeof a=="function"?a():a;if(s==="all"||!s&&!ne(this,Hf).size)return!0;const i=new Set(s??ne(this,Hf));return this.options.throwOnError&&i.add("error"),Object.keys(ne(this,$a)).some(o=>{const l=o;return ne(this,$a)[l]!==t[l]&&i.has(l)})};zt(this,pn,iW).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&zt(this,pn,J2).call(this)}},Za=new WeakMap,Zt=new WeakMap,xv=new WeakMap,$a=new WeakMap,id=new WeakMap,Uf=new WeakMap,lu=new WeakMap,uu=new WeakMap,vv=new WeakMap,Wf=new WeakMap,Vf=new WeakMap,od=new WeakMap,ld=new WeakMap,cu=new WeakMap,Hf=new WeakMap,pn=new WeakSet,Vy=function(t){zt(this,pn,tI).call(this);let n=ne(this,Zt).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Da)),n},Q2=function(){zt(this,pn,Z2).call(this);const t=Tu(this.options.staleTime,ne(this,Zt));if(_d||ne(this,$a).isStale||!H2(t))return;const r=XU(ne(this,$a).dataUpdatedAt,t)+1;We(this,od,setTimeout(()=>{ne(this,$a).isStale||this.updateResult()},r))},X2=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ne(this,Zt)):this.options.refetchInterval)??!1},Y2=function(t){zt(this,pn,eI).call(this),We(this,cu,t),!(_d||Zs(this.options.enabled,ne(this,Zt))===!1||!H2(ne(this,cu))||ne(this,cu)===0)&&We(this,ld,setInterval(()=>{(this.options.refetchIntervalInBackground||hj.isFocused())&&zt(this,pn,Vy).call(this)},ne(this,cu)))},J2=function(){zt(this,pn,Q2).call(this),zt(this,pn,Y2).call(this,zt(this,pn,X2).call(this))},Z2=function(){ne(this,od)&&(clearTimeout(ne(this,od)),We(this,od,void 0))},eI=function(){ne(this,ld)&&(clearInterval(ne(this,ld)),We(this,ld,void 0))},tI=function(){const t=ne(this,Za).getQueryCache().build(ne(this,Za),this.options);if(t===ne(this,Zt))return;const n=ne(this,Zt);We(this,Zt,t),We(this,xv,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},iW=function(t){Tr.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(ne(this,$a))}),ne(this,Za).getQueryCache().notify({query:ne(this,Zt),type:"observerResultsUpdated"})})},n4);function Lue(e,t){return Zs(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function zF(e,t){return Lue(e,t)||e.state.data!==void 0&&nI(e,t,t.refetchOnMount)}function nI(e,t,n){if(Zs(t.enabled,e)!==!1&&Tu(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&pj(e,t)}return!1}function BF(e,t,n,r){return(e!==t||Zs(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&pj(e,n)}function pj(e,t){return Zs(t.enabled,e)!==!1&&e.isStaleByTime(Tu(t.staleTime,e))}function zue(e,t){return!p1(e.getCurrentResult(),t)}var du,hu,es,al,ml,x0,rI,r4,Bue=(r4=class extends Pm{constructor(n,r){super();rt(this,ml);rt(this,du);rt(this,hu);rt(this,es);rt(this,al);We(this,du,n),this.setOptions(r),this.bindMethods(),zt(this,ml,x0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var a;const r=this.options;this.options=ne(this,du).defaultMutationOptions(n),p1(this.options,r)||ne(this,du).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ne(this,es),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Cd(r.mutationKey)!==Cd(this.options.mutationKey)?this.reset():((a=ne(this,es))==null?void 0:a.state.status)==="pending"&&ne(this,es).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=ne(this,es))==null||n.removeObserver(this)}onMutationUpdate(n){zt(this,ml,x0).call(this),zt(this,ml,rI).call(this,n)}getCurrentResult(){return ne(this,hu)}reset(){var n;(n=ne(this,es))==null||n.removeObserver(this),We(this,es,void 0),zt(this,ml,x0).call(this),zt(this,ml,rI).call(this)}mutate(n,r){var a;return We(this,al,r),(a=ne(this,es))==null||a.removeObserver(this),We(this,es,ne(this,du).getMutationCache().build(ne(this,du),this.options)),ne(this,es).addObserver(this),ne(this,es).execute(n)}},du=new WeakMap,hu=new WeakMap,es=new WeakMap,al=new WeakMap,ml=new WeakSet,x0=function(){var r;const n=((r=ne(this,es))==null?void 0:r.state)??sW();We(this,hu,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},rI=function(n){Tr.batch(()=>{var r,a,s,i,o,l,c,u;if(ne(this,al)&&this.hasListeners()){const h=ne(this,hu).variables,p=ne(this,hu).context;(n==null?void 0:n.type)==="success"?((a=(r=ne(this,al)).onSuccess)==null||a.call(r,n.data,h,p),(i=(s=ne(this,al)).onSettled)==null||i.call(s,n.data,null,h,p)):(n==null?void 0:n.type)==="error"&&((l=(o=ne(this,al)).onError)==null||l.call(o,n.error,h,p),(u=(c=ne(this,al)).onSettled)==null||u.call(c,void 0,n.error,h,p))}this.listeners.forEach(h=>{h(ne(this,hu))})})},r4),oW=N.createContext(void 0),Tv=e=>{const t=N.useContext(oW);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Uue=({client:e,children:t})=>(N.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),d.jsx(oW.Provider,{value:e,children:t})),lW=N.createContext(!1),Wue=()=>N.useContext(lW);lW.Provider;function Vue(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Hue=N.createContext(Vue()),Gue=()=>N.useContext(Hue),que=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Kue=e=>{N.useEffect(()=>{e.clearReset()},[e])},Que=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(a&&e.data===void 0||ZU(n,[e.error,r])),Xue=e=>{if(e.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...r)=>t(n(...r)):t(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Yue=(e,t)=>e.isLoading&&e.isFetching&&!t,Jue=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,UF=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Zue(e,t,n){var h,p,f,g,m;const r=Wue(),a=Gue(),s=Tv(),i=s.defaultQueryOptions(e);(p=(h=s.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,i),i._optimisticResults=r?"isRestoring":"optimistic",Xue(i),que(i,a),Kue(a);const o=!s.getQueryCache().get(i.queryHash),[l]=N.useState(()=>new t(s,i)),c=l.getOptimisticResult(i),u=!r&&e.subscribed!==!1;if(N.useSyncExternalStore(N.useCallback(y=>{const x=u?l.subscribe(Tr.batchCalls(y)):Da;return l.updateResult(),x},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),N.useEffect(()=>{l.setOptions(i)},[i,l]),Jue(i,c))throw UF(i,l,a);if(Que({result:c,errorResetBoundary:a,throwOnError:i.throwOnError,query:s.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw c.error;if((g=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||g.call(f,i,c),i.experimental_prefetchInRender&&!_d&&Yue(c,r)){const y=o?UF(i,l,a):(m=s.getQueryCache().get(i.queryHash))==null?void 0:m.promise;y==null||y.catch(Da).finally(()=>{l.updateResult()})}return i.notifyOnChangeProps?c:l.trackResult(c)}function nh(e,t){return Zue(e,Pue)}function If(e,t){const n=Tv(),[r]=N.useState(()=>new Bue(n,e));N.useEffect(()=>{r.setOptions(e)},[r,e]);const a=N.useSyncExternalStore(N.useCallback(i=>r.subscribe(Tr.batchCalls(i)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),s=N.useCallback((i,o)=>{r.mutate(i,o).catch(Da)},[r]);if(a.error&&ZU(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:s,mutateAsync:a.mutate}}const ece=()=>{const e=ci(),t=Pr();return N.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:d.jsxs("div",{className:"text-center",children:[d.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),d.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),d.jsx("button",{onClick:()=>t("/auth"),className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};function uW(e,t){return function(){return e.apply(t,arguments)}}const{toString:tce}=Object.prototype,{getPrototypeOf:fj}=Object,{iterator:zN,toStringTag:cW}=Symbol,BN=(e=>t=>{const n=tce.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Gi=e=>(e=e.toLowerCase(),t=>BN(t)===e),UN=e=>t=>typeof t===e,{isArray:Lm}=Array,Gx=UN("undefined");function jv(e){return e!==null&&!Gx(e)&&e.constructor!==null&&!Gx(e.constructor)&&ms(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const dW=Gi("ArrayBuffer");function nce(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&dW(e.buffer),t}const rce=UN("string"),ms=UN("function"),hW=UN("number"),Av=e=>e!==null&&typeof e=="object",ace=e=>e===!0||e===!1,v0=e=>{if(BN(e)!=="object")return!1;const t=fj(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(cW in e)&&!(zN in e)},sce=e=>{if(!Av(e)||jv(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},ice=Gi("Date"),oce=Gi("File"),lce=Gi("Blob"),uce=Gi("FileList"),cce=e=>Av(e)&&ms(e.pipe),dce=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ms(e.append)&&((t=BN(e))==="formdata"||t==="object"&&ms(e.toString)&&e.toString()==="[object FormData]"))},hce=Gi("URLSearchParams"),[pce,fce,mce,gce]=["ReadableStream","Request","Response","Headers"].map(Gi),yce=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function $v(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),Lm(e))for(r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else{if(jv(e))return;const s=n?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let o;for(r=0;r<i;r++)o=s[r],t.call(null,e[o],o,e)}}function pW(e,t){if(jv(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,a;for(;r-- >0;)if(a=n[r],t===a.toLowerCase())return a;return null}const Yc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,fW=e=>!Gx(e)&&e!==Yc;function aI(){const{caseless:e}=fW(this)&&this||{},t={},n=(r,a)=>{const s=e&&pW(t,a)||a;v0(t[s])&&v0(r)?t[s]=aI(t[s],r):v0(r)?t[s]=aI({},r):Lm(r)?t[s]=r.slice():t[s]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&$v(arguments[r],n);return t}const xce=(e,t,n,{allOwnKeys:r}={})=>($v(t,(a,s)=>{n&&ms(a)?e[s]=uW(a,n):e[s]=a},{allOwnKeys:r}),e),vce=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),bce=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},wce=(e,t,n,r)=>{let a,s,i;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],(!r||r(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=n!==!1&&fj(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Nce=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},kce=e=>{if(!e)return null;if(Lm(e))return e;let t=e.length;if(!hW(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Sce=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&fj(Uint8Array)),_ce=(e,t)=>{const r=(e&&e[zN]).call(e);let a;for(;(a=r.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},Cce=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Ice=Gi("HTMLFormElement"),Ece=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,a){return r.toUpperCase()+a}),WF=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Tce=Gi("RegExp"),mW=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};$v(n,(a,s)=>{let i;(i=t(a,s,e))!==!1&&(r[s]=i||a)}),Object.defineProperties(e,r)},jce=e=>{mW(e,(t,n)=>{if(ms(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(ms(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ace=(e,t)=>{const n={},r=a=>{a.forEach(s=>{n[s]=!0})};return Lm(e)?r(e):r(String(e).split(t)),n},$ce=()=>{},Rce=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Dce(e){return!!(e&&ms(e.append)&&e[cW]==="FormData"&&e[zN])}const Mce=e=>{const t=new Array(10),n=(r,a)=>{if(Av(r)){if(t.indexOf(r)>=0)return;if(jv(r))return r;if(!("toJSON"in r)){t[a]=r;const s=Lm(r)?[]:{};return $v(r,(i,o)=>{const l=n(i,a+1);!Gx(l)&&(s[o]=l)}),t[a]=void 0,s}}return r};return n(e,0)},Oce=Gi("AsyncFunction"),Fce=e=>e&&(Av(e)||ms(e))&&ms(e.then)&&ms(e.catch),gW=((e,t)=>e?setImmediate:t?((n,r)=>(Yc.addEventListener("message",({source:a,data:s})=>{a===Yc&&s===n&&r.length&&r.shift()()},!1),a=>{r.push(a),Yc.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",ms(Yc.postMessage)),Pce=typeof queueMicrotask<"u"?queueMicrotask.bind(Yc):typeof process<"u"&&process.nextTick||gW,Lce=e=>e!=null&&ms(e[zN]),ve={isArray:Lm,isArrayBuffer:dW,isBuffer:jv,isFormData:dce,isArrayBufferView:nce,isString:rce,isNumber:hW,isBoolean:ace,isObject:Av,isPlainObject:v0,isEmptyObject:sce,isReadableStream:pce,isRequest:fce,isResponse:mce,isHeaders:gce,isUndefined:Gx,isDate:ice,isFile:oce,isBlob:lce,isRegExp:Tce,isFunction:ms,isStream:cce,isURLSearchParams:hce,isTypedArray:Sce,isFileList:uce,forEach:$v,merge:aI,extend:xce,trim:yce,stripBOM:vce,inherits:bce,toFlatObject:wce,kindOf:BN,kindOfTest:Gi,endsWith:Nce,toArray:kce,forEachEntry:_ce,matchAll:Cce,isHTMLForm:Ice,hasOwnProperty:WF,hasOwnProp:WF,reduceDescriptors:mW,freezeMethods:jce,toObjectSet:Ace,toCamelCase:Ece,noop:$ce,toFiniteNumber:Rce,findKey:pW,global:Yc,isContextDefined:fW,isSpecCompliantForm:Dce,toJSONObject:Mce,isAsyncFn:Oce,isThenable:Fce,setImmediate:gW,asap:Pce,isIterable:Lce};function Rt(e,t,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}ve.inherits(Rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ve.toJSONObject(this.config),code:this.code,status:this.status}}});const yW=Rt.prototype,xW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{xW[e]={value:e}});Object.defineProperties(Rt,xW);Object.defineProperty(yW,"isAxiosError",{value:!0});Rt.from=(e,t,n,r,a,s)=>{const i=Object.create(yW);return ve.toFlatObject(e,i,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),Rt.call(i,e.message,t,n,r,a),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const zce=null;function sI(e){return ve.isPlainObject(e)||ve.isArray(e)}function vW(e){return ve.endsWith(e,"[]")?e.slice(0,-2):e}function VF(e,t,n){return e?e.concat(t).map(function(a,s){return a=vW(a),!n&&s?"["+a+"]":a}).join(n?".":""):t}function Bce(e){return ve.isArray(e)&&!e.some(sI)}const Uce=ve.toFlatObject(ve,{},null,function(t){return/^is[A-Z]/.test(t)});function WN(e,t,n){if(!ve.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=ve.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,y){return!ve.isUndefined(y[m])});const r=n.metaTokens,a=n.visitor||u,s=n.dots,i=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&ve.isSpecCompliantForm(t);if(!ve.isFunction(a))throw new TypeError("visitor must be a function");function c(g){if(g===null)return"";if(ve.isDate(g))return g.toISOString();if(ve.isBoolean(g))return g.toString();if(!l&&ve.isBlob(g))throw new Rt("Blob is not supported. Use a Buffer instead.");return ve.isArrayBuffer(g)||ve.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,m,y){let x=g;if(g&&!y&&typeof g=="object"){if(ve.endsWith(m,"{}"))m=r?m:m.slice(0,-2),g=JSON.stringify(g);else if(ve.isArray(g)&&Bce(g)||(ve.isFileList(g)||ve.endsWith(m,"[]"))&&(x=ve.toArray(g)))return m=vW(m),x.forEach(function(b,w){!(ve.isUndefined(b)||b===null)&&t.append(i===!0?VF([m],w,s):i===null?m:m+"[]",c(b))}),!1}return sI(g)?!0:(t.append(VF(y,m,s),c(g)),!1)}const h=[],p=Object.assign(Uce,{defaultVisitor:u,convertValue:c,isVisitable:sI});function f(g,m){if(!ve.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(g),ve.forEach(g,function(x,v){(!(ve.isUndefined(x)||x===null)&&a.call(t,x,ve.isString(v)?v.trim():v,m,p))===!0&&f(x,m?m.concat(v):[v])}),h.pop()}}if(!ve.isObject(e))throw new TypeError("data must be an object");return f(e),t}function HF(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function mj(e,t){this._pairs=[],e&&WN(e,this,t)}const bW=mj.prototype;bW.append=function(t,n){this._pairs.push([t,n])};bW.toString=function(t){const n=t?function(r){return t.call(this,r,HF)}:HF;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function Wce(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function wW(e,t,n){if(!t)return e;const r=n&&n.encode||Wce;ve.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let s;if(a?s=a(t,n):s=ve.isURLSearchParams(t)?t.toString():new mj(t,n).toString(r),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class GF{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ve.forEach(this.handlers,function(r){r!==null&&t(r)})}}const NW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Vce=typeof URLSearchParams<"u"?URLSearchParams:mj,Hce=typeof FormData<"u"?FormData:null,Gce=typeof Blob<"u"?Blob:null,qce={isBrowser:!0,classes:{URLSearchParams:Vce,FormData:Hce,Blob:Gce},protocols:["http","https","file","blob","url","data"]},gj=typeof window<"u"&&typeof document<"u",iI=typeof navigator=="object"&&navigator||void 0,Kce=gj&&(!iI||["ReactNative","NativeScript","NS"].indexOf(iI.product)<0),Qce=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Xce=gj&&window.location.href||"http://localhost",Yce=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:gj,hasStandardBrowserEnv:Kce,hasStandardBrowserWebWorkerEnv:Qce,navigator:iI,origin:Xce},Symbol.toStringTag,{value:"Module"})),ga={...Yce,...qce};function Jce(e,t){return WN(e,new ga.classes.URLSearchParams,{visitor:function(n,r,a,s){return ga.isNode&&ve.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function Zce(e){return ve.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function ede(e){const t={},n=Object.keys(e);let r;const a=n.length;let s;for(r=0;r<a;r++)s=n[r],t[s]=e[s];return t}function kW(e){function t(n,r,a,s){let i=n[s++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),l=s>=n.length;return i=!i&&ve.isArray(a)?a.length:i,l?(ve.hasOwnProp(a,i)?a[i]=[a[i],r]:a[i]=r,!o):((!a[i]||!ve.isObject(a[i]))&&(a[i]=[]),t(n,r,a[i],s)&&ve.isArray(a[i])&&(a[i]=ede(a[i])),!o)}if(ve.isFormData(e)&&ve.isFunction(e.entries)){const n={};return ve.forEachEntry(e,(r,a)=>{t(Zce(r),a,n,0)}),n}return null}function tde(e,t,n){if(ve.isString(e))try{return(t||JSON.parse)(e),ve.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Rv={transitional:NW,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",a=r.indexOf("application/json")>-1,s=ve.isObject(t);if(s&&ve.isHTMLForm(t)&&(t=new FormData(t)),ve.isFormData(t))return a?JSON.stringify(kW(t)):t;if(ve.isArrayBuffer(t)||ve.isBuffer(t)||ve.isStream(t)||ve.isFile(t)||ve.isBlob(t)||ve.isReadableStream(t))return t;if(ve.isArrayBufferView(t))return t.buffer;if(ve.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Jce(t,this.formSerializer).toString();if((o=ve.isFileList(t))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return WN(o?{"files[]":t}:t,l&&new l,this.formSerializer)}}return s||a?(n.setContentType("application/json",!1),tde(t)):t}],transformResponse:[function(t){const n=this.transitional||Rv.transitional,r=n&&n.forcedJSONParsing,a=this.responseType==="json";if(ve.isResponse(t)||ve.isReadableStream(t))return t;if(t&&ve.isString(t)&&(r&&!this.responseType||a)){const i=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(o){if(i)throw o.name==="SyntaxError"?Rt.from(o,Rt.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ga.classes.FormData,Blob:ga.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ve.forEach(["delete","get","head","post","put","patch"],e=>{Rv.headers[e]={}});const nde=ve.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),rde=e=>{const t={};let n,r,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),n=i.substring(0,a).trim().toLowerCase(),r=i.substring(a+1).trim(),!(!n||t[n]&&nde[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},qF=Symbol("internals");function Ty(e){return e&&String(e).trim().toLowerCase()}function b0(e){return e===!1||e==null?e:ve.isArray(e)?e.map(b0):String(e)}function ade(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const sde=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function U_(e,t,n,r,a){if(ve.isFunction(r))return r.call(this,t,n);if(a&&(t=n),!!ve.isString(t)){if(ve.isString(r))return t.indexOf(r)!==-1;if(ve.isRegExp(r))return r.test(t)}}function ide(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function ode(e,t){const n=ve.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(a,s,i){return this[r].call(this,t,a,s,i)},configurable:!0})})}let gs=class{constructor(t){t&&this.set(t)}set(t,n,r){const a=this;function s(o,l,c){const u=Ty(l);if(!u)throw new Error("header name must be a non-empty string");const h=ve.findKey(a,u);(!h||a[h]===void 0||c===!0||c===void 0&&a[h]!==!1)&&(a[h||l]=b0(o))}const i=(o,l)=>ve.forEach(o,(c,u)=>s(c,u,l));if(ve.isPlainObject(t)||t instanceof this.constructor)i(t,n);else if(ve.isString(t)&&(t=t.trim())&&!sde(t))i(rde(t),n);else if(ve.isObject(t)&&ve.isIterable(t)){let o={},l,c;for(const u of t){if(!ve.isArray(u))throw TypeError("Object iterator must return a key-value pair");o[c=u[0]]=(l=o[c])?ve.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}i(o,n)}else t!=null&&s(n,t,r);return this}get(t,n){if(t=Ty(t),t){const r=ve.findKey(this,t);if(r){const a=this[r];if(!n)return a;if(n===!0)return ade(a);if(ve.isFunction(n))return n.call(this,a,r);if(ve.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ty(t),t){const r=ve.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||U_(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let a=!1;function s(i){if(i=Ty(i),i){const o=ve.findKey(r,i);o&&(!n||U_(r,r[o],o,n))&&(delete r[o],a=!0)}}return ve.isArray(t)?t.forEach(s):s(t),a}clear(t){const n=Object.keys(this);let r=n.length,a=!1;for(;r--;){const s=n[r];(!t||U_(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const n=this,r={};return ve.forEach(this,(a,s)=>{const i=ve.findKey(r,s);if(i){n[i]=b0(a),delete n[s];return}const o=t?ide(s):String(s).trim();o!==s&&delete n[s],n[o]=b0(a),r[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return ve.forEach(this,(r,a)=>{r!=null&&r!==!1&&(n[a]=t&&ve.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(a=>r.set(a)),r}static accessor(t){const r=(this[qF]=this[qF]={accessors:{}}).accessors,a=this.prototype;function s(i){const o=Ty(i);r[o]||(ode(a,i),r[o]=!0)}return ve.isArray(t)?t.forEach(s):s(t),this}};gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ve.reduceDescriptors(gs.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});ve.freezeMethods(gs);function W_(e,t){const n=this||Rv,r=t||n,a=gs.from(r.headers);let s=r.data;return ve.forEach(e,function(o){s=o.call(n,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function SW(e){return!!(e&&e.__CANCEL__)}function zm(e,t,n){Rt.call(this,e??"canceled",Rt.ERR_CANCELED,t,n),this.name="CanceledError"}ve.inherits(zm,Rt,{__CANCEL__:!0});function _W(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Rt("Request failed with status code "+n.status,[Rt.ERR_BAD_REQUEST,Rt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function lde(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function ude(e,t){e=e||10;const n=new Array(e),r=new Array(e);let a=0,s=0,i;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),u=r[s];i||(i=c),n[a]=l,r[a]=c;let h=s,p=0;for(;h!==a;)p+=n[h++],h=h%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),c-i<t)return;const f=u&&c-u;return f?Math.round(p*1e3/f):void 0}}function cde(e,t){let n=0,r=1e3/t,a,s;const i=(c,u=Date.now())=>{n=u,a=null,s&&(clearTimeout(s),s=null),e(...c)};return[(...c)=>{const u=Date.now(),h=u-n;h>=r?i(c,u):(a=c,s||(s=setTimeout(()=>{s=null,i(a)},r-h)))},()=>a&&i(a)]}const m1=(e,t,n=3)=>{let r=0;const a=ude(50,250);return cde(s=>{const i=s.loaded,o=s.lengthComputable?s.total:void 0,l=i-r,c=a(l),u=i<=o;r=i;const h={loaded:i,total:o,progress:o?i/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&u?(o-i)/c:void 0,event:s,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},n)},KF=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},QF=e=>(...t)=>ve.asap(()=>e(...t)),dde=ga.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ga.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ga.origin),ga.navigator&&/(msie|trident)/i.test(ga.navigator.userAgent)):()=>!0,hde=ga.hasStandardBrowserEnv?{write(e,t,n,r,a,s){const i=[e+"="+encodeURIComponent(t)];ve.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),ve.isString(r)&&i.push("path="+r),ve.isString(a)&&i.push("domain="+a),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pde(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function fde(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function CW(e,t,n){let r=!pde(t);return e&&(r||n==!1)?fde(e,t):t}const XF=e=>e instanceof gs?{...e}:e;function Id(e,t){t=t||{};const n={};function r(c,u,h,p){return ve.isPlainObject(c)&&ve.isPlainObject(u)?ve.merge.call({caseless:p},c,u):ve.isPlainObject(u)?ve.merge({},u):ve.isArray(u)?u.slice():u}function a(c,u,h,p){if(ve.isUndefined(u)){if(!ve.isUndefined(c))return r(void 0,c,h,p)}else return r(c,u,h,p)}function s(c,u){if(!ve.isUndefined(u))return r(void 0,u)}function i(c,u){if(ve.isUndefined(u)){if(!ve.isUndefined(c))return r(void 0,c)}else return r(void 0,u)}function o(c,u,h){if(h in t)return r(c,u);if(h in e)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(c,u,h)=>a(XF(c),XF(u),h,!0)};return ve.forEach(Object.keys({...e,...t}),function(u){const h=l[u]||a,p=h(e[u],t[u],u);ve.isUndefined(p)&&h!==o||(n[u]=p)}),n}const IW=e=>{const t=Id({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:s,headers:i,auth:o}=t;t.headers=i=gs.from(i),t.url=wW(CW(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(ve.isFormData(n)){if(ga.hasStandardBrowserEnv||ga.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((l=i.getContentType())!==!1){const[c,...u]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([c||"multipart/form-data",...u].join("; "))}}if(ga.hasStandardBrowserEnv&&(r&&ve.isFunction(r)&&(r=r(t)),r||r!==!1&&dde(t.url))){const c=a&&s&&hde.read(s);c&&i.set(a,c)}return t},mde=typeof XMLHttpRequest<"u",gde=mde&&function(e){return new Promise(function(n,r){const a=IW(e);let s=a.data;const i=gs.from(a.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=a,u,h,p,f,g;function m(){f&&f(),g&&g(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let y=new XMLHttpRequest;y.open(a.method.toUpperCase(),a.url,!0),y.timeout=a.timeout;function x(){if(!y)return;const b=gs.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:e,request:y};_W(function(C){n(C),m()},function(C){r(C),m()},k),y=null}"onloadend"in y?y.onloadend=x:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(x)},y.onabort=function(){y&&(r(new Rt("Request aborted",Rt.ECONNABORTED,e,y)),y=null)},y.onerror=function(){r(new Rt("Network Error",Rt.ERR_NETWORK,e,y)),y=null},y.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const k=a.transitional||NW;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),r(new Rt(w,k.clarifyTimeoutError?Rt.ETIMEDOUT:Rt.ECONNABORTED,e,y)),y=null},s===void 0&&i.setContentType(null),"setRequestHeader"in y&&ve.forEach(i.toJSON(),function(w,k){y.setRequestHeader(k,w)}),ve.isUndefined(a.withCredentials)||(y.withCredentials=!!a.withCredentials),o&&o!=="json"&&(y.responseType=a.responseType),c&&([p,g]=m1(c,!0),y.addEventListener("progress",p)),l&&y.upload&&([h,f]=m1(l),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",f)),(a.cancelToken||a.signal)&&(u=b=>{y&&(r(!b||b.type?new zm(null,e,y):b),y.abort(),y=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const v=lde(a.url);if(v&&ga.protocols.indexOf(v)===-1){r(new Rt("Unsupported protocol "+v+":",Rt.ERR_BAD_REQUEST,e));return}y.send(s||null)})},yde=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,a;const s=function(c){if(!a){a=!0,o();const u=c instanceof Error?c:this.reason;r.abort(u instanceof Rt?u:new zm(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,s(new Rt(`timeout ${t} of ms exceeded`,Rt.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>ve.asap(o),l}},xde=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,a;for(;r<n;)a=r+t,yield e.slice(r,a),r=a},vde=async function*(e,t){for await(const n of bde(e))yield*xde(n,t)},bde=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},YF=(e,t,n,r)=>{const a=vde(e,t);let s=0,i,o=l=>{i||(i=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await a.next();if(c){o(),l.close();return}let h=u.byteLength;if(n){let p=s+=h;n(p)}l.enqueue(new Uint8Array(u))}catch(c){throw o(c),c}},cancel(l){return o(l),a.return()}},{highWaterMark:2})},VN=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",EW=VN&&typeof ReadableStream=="function",wde=VN&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),TW=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Nde=EW&&TW(()=>{let e=!1;const t=new Request(ga.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),JF=64*1024,oI=EW&&TW(()=>ve.isReadableStream(new Response("").body)),g1={stream:oI&&(e=>e.body)};VN&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!g1[t]&&(g1[t]=ve.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Rt(`Response type '${t}' is not supported`,Rt.ERR_NOT_SUPPORT,r)})})})(new Response);const kde=async e=>{if(e==null)return 0;if(ve.isBlob(e))return e.size;if(ve.isSpecCompliantForm(e))return(await new Request(ga.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ve.isArrayBufferView(e)||ve.isArrayBuffer(e))return e.byteLength;if(ve.isURLSearchParams(e)&&(e=e+""),ve.isString(e))return(await wde(e)).byteLength},Sde=async(e,t)=>{const n=ve.toFiniteNumber(e.getContentLength());return n??kde(t)},_de=VN&&(async e=>{let{url:t,method:n,data:r,signal:a,cancelToken:s,timeout:i,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:p}=IW(e);c=c?(c+"").toLowerCase():"text";let f=yde([a,s&&s.toAbortSignal()],i),g;const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let y;try{if(l&&Nde&&n!=="get"&&n!=="head"&&(y=await Sde(u,r))!==0){let k=new Request(t,{method:"POST",body:r,duplex:"half"}),I;if(ve.isFormData(r)&&(I=k.headers.get("content-type"))&&u.setContentType(I),k.body){const[C,S]=KF(y,m1(QF(l)));r=YF(k.body,JF,C,S)}}ve.isString(h)||(h=h?"include":"omit");const x="credentials"in Request.prototype;g=new Request(t,{...p,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:x?h:void 0});let v=await fetch(g,p);const b=oI&&(c==="stream"||c==="response");if(oI&&(o||b&&m)){const k={};["status","statusText","headers"].forEach(E=>{k[E]=v[E]});const I=ve.toFiniteNumber(v.headers.get("content-length")),[C,S]=o&&KF(I,m1(QF(o),!0))||[];v=new Response(YF(v.body,JF,C,()=>{S&&S(),m&&m()}),k)}c=c||"text";let w=await g1[ve.findKey(g1,c)||"text"](v,e);return!b&&m&&m(),await new Promise((k,I)=>{_W(k,I,{data:w,headers:gs.from(v.headers),status:v.status,statusText:v.statusText,config:e,request:g})})}catch(x){throw m&&m(),x&&x.name==="TypeError"&&/Load failed|fetch/i.test(x.message)?Object.assign(new Rt("Network Error",Rt.ERR_NETWORK,e,g),{cause:x.cause||x}):Rt.from(x,x&&x.code,e,g)}}),lI={http:zce,xhr:gde,fetch:_de};ve.forEach(lI,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ZF=e=>`- ${e}`,Cde=e=>ve.isFunction(e)||e===null||e===!1,jW={getAdapter:e=>{e=ve.isArray(e)?e:[e];const{length:t}=e;let n,r;const a={};for(let s=0;s<t;s++){n=e[s];let i;if(r=n,!Cde(n)&&(r=lI[(i=String(n)).toLowerCase()],r===void 0))throw new Rt(`Unknown adapter '${i}'`);if(r)break;a[i||"#"+s]=r}if(!r){const s=Object.entries(a).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let i=t?s.length>1?`since :
`+s.map(ZF).join(`
`):" "+ZF(s[0]):"as no adapter specified";throw new Rt("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return r},adapters:lI};function V_(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new zm(null,e)}function eP(e){return V_(e),e.headers=gs.from(e.headers),e.data=W_.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),jW.getAdapter(e.adapter||Rv.adapter)(e).then(function(r){return V_(e),r.data=W_.call(e,e.transformResponse,r),r.headers=gs.from(r.headers),r},function(r){return SW(r)||(V_(e),r&&r.response&&(r.response.data=W_.call(e,e.transformResponse,r.response),r.response.headers=gs.from(r.response.headers))),Promise.reject(r)})}const AW="1.11.0",HN={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{HN[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const tP={};HN.transitional=function(t,n,r){function a(s,i){return"[Axios v"+AW+"] Transitional option '"+s+"'"+i+(r?". "+r:"")}return(s,i,o)=>{if(t===!1)throw new Rt(a(i," has been removed"+(n?" in "+n:"")),Rt.ERR_DEPRECATED);return n&&!tP[i]&&(tP[i]=!0,console.warn(a(i," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,i,o):!0}};HN.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function Ide(e,t,n){if(typeof e!="object")throw new Rt("options must be an object",Rt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const s=r[a],i=t[s];if(i){const o=e[s],l=o===void 0||i(o,s,e);if(l!==!0)throw new Rt("option "+s+" must be "+l,Rt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Rt("Unknown option "+s,Rt.ERR_BAD_OPTION)}}const w0={assertOptions:Ide,validators:HN},Ji=w0.validators;let pd=class{constructor(t){this.defaults=t||{},this.interceptors={request:new GF,response:new GF}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Id(this.defaults,n);const{transitional:r,paramsSerializer:a,headers:s}=n;r!==void 0&&w0.assertOptions(r,{silentJSONParsing:Ji.transitional(Ji.boolean),forcedJSONParsing:Ji.transitional(Ji.boolean),clarifyTimeoutError:Ji.transitional(Ji.boolean)},!1),a!=null&&(ve.isFunction(a)?n.paramsSerializer={serialize:a}:w0.assertOptions(a,{encode:Ji.function,serialize:Ji.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),w0.assertOptions(n,{baseUrl:Ji.spelling("baseURL"),withXsrfToken:Ji.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=s&&ve.merge(s.common,s[n.method]);s&&ve.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),n.headers=gs.concat(i,s);const o=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,h=0,p;if(!l){const g=[eP.bind(this),void 0];for(g.unshift(...o),g.push(...c),p=g.length,u=Promise.resolve(n);h<p;)u=u.then(g[h++],g[h++]);return u}p=o.length;let f=n;for(h=0;h<p;){const g=o[h++],m=o[h++];try{f=g(f)}catch(y){m.call(this,y);break}}try{u=eP.call(this,f)}catch(g){return Promise.reject(g)}for(h=0,p=c.length;h<p;)u=u.then(c[h++],c[h++]);return u}getUri(t){t=Id(this.defaults,t);const n=CW(t.baseURL,t.url,t.allowAbsoluteUrls);return wW(n,t.params,t.paramsSerializer)}};ve.forEach(["delete","get","head","options"],function(t){pd.prototype[t]=function(n,r){return this.request(Id(r||{},{method:t,url:n,data:(r||{}).data}))}});ve.forEach(["post","put","patch"],function(t){function n(r){return function(s,i,o){return this.request(Id(o||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}pd.prototype[t]=n(),pd.prototype[t+"Form"]=n(!0)});let Ede=class $W{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(a=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](a);r._listeners=null}),this.promise.then=a=>{let s;const i=new Promise(o=>{r.subscribe(o),s=o}).then(a);return i.cancel=function(){r.unsubscribe(s)},i},t(function(s,i,o){r.reason||(r.reason=new zm(s,i,o),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new $W(function(a){t=a}),cancel:t}}};function Tde(e){return function(n){return e.apply(null,n)}}function jde(e){return ve.isObject(e)&&e.isAxiosError===!0}const uI={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(uI).forEach(([e,t])=>{uI[t]=e});function RW(e){const t=new pd(e),n=uW(pd.prototype.request,t);return ve.extend(n,pd.prototype,t,{allOwnKeys:!0}),ve.extend(n,t,null,{allOwnKeys:!0}),n.create=function(a){return RW(Id(e,a))},n}const Gn=RW(Rv);Gn.Axios=pd;Gn.CanceledError=zm;Gn.CancelToken=Ede;Gn.isCancel=SW;Gn.VERSION=AW;Gn.toFormData=WN;Gn.AxiosError=Rt;Gn.Cancel=Gn.CanceledError;Gn.all=function(t){return Promise.all(t)};Gn.spread=Tde;Gn.isAxiosError=jde;Gn.mergeConfig=Id;Gn.AxiosHeaders=gs;Gn.formToJSON=e=>kW(ve.isHTMLForm(e)?new FormData(e):e);Gn.getAdapter=jW.getAdapter;Gn.HttpStatusCode=uI;Gn.default=Gn;const{Axios:pat,AxiosError:fat,CanceledError:mat,isCancel:gat,CancelToken:yat,VERSION:xat,all:vat,Cancel:bat,isAxiosError:wat,spread:Nat,toFormData:kat,AxiosHeaders:Sat,HttpStatusCode:_at,formToJSON:Cat,getAdapter:Iat,mergeConfig:Eat}=Gn,tt="https://dev-new-admissions.navgurukul.org/api/v1",Ade=()=>localStorage.getItem("authToken"),Ht=(e=!0)=>{const t=Ade();return{...e?{"Content-Type":"application/json"}:{},...t?{Authorization:`Bearer ${t}`}:{}}},$de=async(e,t={})=>{const n=`${tt}${e}`,r=Ht(),a={...t,headers:{...r,...t.headers}};return fetch(n,a)},Rde=async e=>{const t=await fetch(`${tt}/users/login`,{method:"POST",headers:Ht(),body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||"Login failed");return n},nP=async(e=1,t=10)=>{const n=await fetch(`${tt}/users?page=${e}&limit=${t}`,{method:"GET",headers:Ht()}),r=await n.json();if(!n.ok)throw new Error(r.message||"Failed to fetch users");return r},Dde=async e=>{const t=await fetch(`${tt}/users/onboard`,{method:"POST",headers:Ht(),body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||"Failed to onboard user");return n},Mde=async(e,t)=>{const n=await fetch(`${tt}/users/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify(t)}),r=await n.json();if(!n.ok)throw new Error(r.message||"Failed to update user");return r},Ode=async e=>{const t=await fetch(`${tt}/users/${e}`,{method:"DELETE",headers:Ht(),body:JSON.stringify(e)});if(!t.ok){const n=await t.json();throw new Error(n.message||"Failed to delete user")}},Fde=async e=>{const t=new FormData;t.append("file",e);const n=await fetch("https://dev-new-admissions.navgurukul.org/api/v1/students/bulkUploadStudents",{method:"POST",body:t});if(!n.ok){const r=await n.text();throw new Error(`Upload failed: ${n.status} ${r}`)}return n.json()},Pde=async e=>{const t=await fetch(`${tt}/students/deleteStudents/${e}`,{method:"DELETE",headers:Ht(),body:JSON.stringify(e)});if(!t.ok){const n=await t.json();throw new Error(n.message||"Failed to delete student")}},Lde=async e=>{const t=await fetch(`${tt}/roles/createRoles`,{method:"POST",headers:Ht(),body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||"Failed to create role");return n.data},DW=async()=>{var n;const e=await fetch(`${tt}/roles/getRoles`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch roles");return((n=t.data)==null?void 0:n.data)||[]},zde=async(e,t)=>{const n=await fetch(`${tt}/roles/updateRole/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify(t)}),r=await n.json();if(!n.ok)throw new Error(r.message||"Failed to update role");return r.data??r},Bde=async e=>{const t=Ht();t["Content-Type"]&&delete t["Content-Type"];const n=await fetch(`${tt}/roles/deleteRole/${e}`,{method:"DELETE",headers:t});if(!n.ok){const r=await n.json();throw new Error(r.message||"Failed to delete role")}},Ude=async e=>fetch(`${tt}/students/submit/learningRoundFeedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),Wde=async(e,t)=>fetch(`${tt}/students/update/learningRoundFeedback/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),MW=async e=>fetch(`${tt}/students/submit/screeningRoundFeedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),Vde=async(e,t)=>fetch(`${tt}/students/update/screeningRoundFeedback/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),Hde=async e=>fetch(`${tt}/students/submit/culturalFitRoundFeedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),Gde=async(e,t)=>fetch(`${tt}/students/update/culturalFitRoundFeedback/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),Zi={learning:{submit:Ude,update:Wde},cultural:{submit:Hde,update:Gde},screening:{submit:MW,update:Vde}},qde=async e=>fetch(`${tt}/students/submit/finalDecision`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),Kde=async e=>{const t=await fetch(`${tt}/casts/createCast`,{method:"POST",headers:Ht(),body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||"Failed to create cast");return n},GN=async()=>{const e=await fetch(`${tt}/casts/getCasts`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch casts");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.castes&&Array.isArray(t.castes)?t.castes:Array.isArray(t)?t:[]},Qde=async(e,t)=>{const n=await fetch(`${tt}/casts/updateCast/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify(t)}),r=await n.json();if(!n.ok)throw new Error(r.message||"Failed to update cast");return r},Xde=async e=>{const t=Ht();t["Content-Type"]&&delete t["Content-Type"];const n=await fetch(`${tt}/casts/deleteCast/${e}`,{method:"DELETE",headers:Ht(),body:JSON.stringify(e)});if(!n.ok){const r=await n.json();throw new Error(r.message||"Failed to delete cast")}},Yde=async e=>{const t=await fetch(`${tt}/religions/createReligion`,{method:"POST",headers:Ht(),body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||"Failed to create religion");return n},qN=async()=>{const e=await fetch(`${tt}/religions/getReligions`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch religions");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.religions&&Array.isArray(t.religions)?t.religions:Array.isArray(t)?t:(console.error("Unexpected API response format:",t),console.error("Data structure:",JSON.stringify(t,null,2)),[])},Jde=async(e,t)=>{const n=await fetch(`${tt}/religions/updateReligion/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify(t)}),r=await n.json();if(!n.ok)throw new Error(r.message||"Failed to update religion");return r},Zde=async e=>{const t=await fetch(`${tt}/religions/deleteReligion/${e}`,{method:"DELETE",headers:Ht()});if(!t.ok){const n=await t.json();throw new Error(n.message||"Failed to delete religion")}},ehe=async(e,t)=>{var i,o;const n=await $de(`/students/getStudents?page=${e}&limit=${t}`,{method:"GET",headers:Ht()}),r=await n.json();if(!n.ok)throw new Error(r.message||"Failed to fetch students");const a=((i=r.data)==null?void 0:i.data)||[],s=((o=r.data)==null?void 0:o.pagination)||{};return{data:a,totalCount:Number(s.total)||a.length,totalPages:Number(s.totalPages)||Math.ceil(a.length/t),page:s.page||e,limit:s.limit||t}},rP=async e=>{var t,n;try{return(await Gn.get(`${tt}/students/getStudentsById/${e}`)).data}catch(r){throw new Error(((n=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch student")}},aP=async(e,t)=>{const n=await fetch(`${tt}/students/updateStudents/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.message||"Failed to update student")}return n.json()},yj=async()=>{const e=await fetch(`${tt}/qualifications/getQualifications`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch qualification");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.religions&&Array.isArray(t.religions)?t.religions:Array.isArray(t)?t:[]},the=async()=>{const e=await fetch(`${tt}/current-statuses/currentallstatuses`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch statuses");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.statuses&&Array.isArray(t.statuses)?t.statuses:Array.isArray(t)?t:(console.error("Data structure:",JSON.stringify(t,null,2)),[])},OW=async e=>{var r;const t=await fetch(`${tt}/students/createStudent`,{method:"POST",headers:Ht(),body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||"Failed to create student");if(((r=n==null?void 0:n.data)==null?void 0:r.error)===!0)throw new Error(n.data.message||"Validation failed");return n},nhe=async e=>{const t=await fetch(`${tt}/questions/createQuestions`,{method:"POST",headers:Ht(),body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||"Failed to create questions");return n.data},rhe=async()=>{const e=await fetch(`${tt}/questions/getQuestions`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch Questions");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.statuses&&Array.isArray(t.statuses)?t.statuses:Array.isArray(t)?t:(console.error("Data structure:",JSON.stringify(t,null,2)),[])},ahe=async e=>{const t=await fetch(`${tt}/questions/deleteQuestions/${e}`,{method:"DELETE"});if(!t.ok){const n=await t.json();throw new Error(n.message||"Failed to delete question")}},she=async(e,t)=>{const n=await fetch(`${tt}/questions/updateQuestions/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify(t)}),r=await n.json();if(!n.ok)throw new Error(r.message||"Failed to update question");return r.data},xj=async()=>{const t=await(await fetch(`${tt}/questions/question-sets`)).json();return Array.isArray(t.data)?t.data:[]},ihe=async e=>{var t;try{return(await Gn.post(`${tt}/questions/question-set-mappings`,e,{headers:{...Ht()}})).data}catch(n){throw console.error("Failed to create mappings:",((t=n.response)==null?void 0:t.data)||n.message),n}},ohe=async(e="english")=>{var t,n;try{const a=((n=(t=(await Gn.get(`${tt}/questions/random-for-test`)).data)==null?void 0:t.data)==null?void 0:n.map(s=>({id:s.id,question:s[`${e}_text`],options:s[`${e}_options`],difficulty_level:s.difficulty_level,answer:s.answer_key[0]})))||[];return console.log("questions1",a),a}catch(r){throw console.error("Error fetching questions:",r),r}},cI=async e=>{try{const t=`${tt}/questions/set/${e}`;return(await Gn.get(t)).data}catch(t){throw console.error(`Error fetching questions for set ${e}:`,t),t}},lhe=async e=>{const t=await fetch(`${tt}/questions/question-set-mappings/remove/${e}`,{method:"DELETE"});if(!t.ok){const n=await t.json();throw new Error(n.message||"Failed to delete question from set")}},uhe=async e=>{const t=new Blob([e],{type:"text/csv"}),n=new File([t],"questions.csv",{type:"text/csv"}),r=new FormData;r.append("file",n),r.append("uploadType","bulk"),r.append("timestamp",new Date().toISOString());const s={...Ht()};delete s["Content-Type"],delete s["content-type"];const i=await fetch(`${tt}/questions/bulkUpload`,{method:"POST",headers:s,body:r}),o=await i.json();if(!i.ok)throw new Error(o.message||"Failed to upload questions");return o},che=async()=>{const e=await fetch(`${tt}/stages/getStages`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch stages");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.stages&&Array.isArray(t.stages)?t.stages:Array.isArray(t)?t:[]},vj=async()=>{const e=await fetch(`${tt}/current-statuses/currentallstatuses`,{method:"GET",headers:Ht()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch statuses");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.statuses&&Array.isArray(t.statuses)?t.statuses:Array.isArray(t)?t:[]},KN=async()=>{const t=await(await fetch(`${tt}/campuses/getCampuses`)).json();let n=[];return Array.isArray(t)?n=t:t.data&&Array.isArray(t.data)?n=t.data:t.data&&typeof t.data=="object"&&t.data.data&&Array.isArray(t.data.data)?n=t.data.data:t.data&&typeof t.data=="object"&&t.data.campuses&&Array.isArray(t.data.campuses)?n=t.data.campuses:t.data&&typeof t.data=="object"&&t.data.result&&Array.isArray(t.data.result)?n=t.data.result:t.campuses&&Array.isArray(t.campuses)?n=t.campuses:t.result&&Array.isArray(t.result)?n=t.result:n=[],n.map(r=>({id:r.id||r.campus_id,campus_name:r.campus_name||r.name||r.campusName||r.campus||""}))},dhe=async e=>{const t=await fetch(`${tt}/campuses/createCampus`,{method:"POST",headers:Ht(),body:JSON.stringify({campus_name:e})});if(!t.ok)throw await t.text(),new Error(`Failed to create campus: ${t.status} ${t.statusText}`);return t.json()},hhe=async(e,t)=>{const n=await fetch(`${tt}/campuses/updateCampus/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify({updatedName:t})});if(!n.ok)throw new Error("Failed to update campus");return n.json()},phe=async e=>{const t=await fetch(`${tt}/campuses/deleteCampus/${e}`,{method:"DELETE",headers:Ht(),body:JSON.stringify({id:e})});if(!t.ok)throw new Error("Failed to delete campus");return t.json()},fhe=async e=>{try{const t=await fetch(`${tt}/schools/createSchool`,{method:"POST",headers:Ht(),body:JSON.stringify({school_name:e})});if(!t.ok){const n=await t.text();throw new Error(`Failed to create school: ${t.status} ${t.statusText} - ${n}`)}return await t.json()}catch(t){throw t}},QN=async()=>{const t=await(await fetch(`${tt}/schools/getSchools`)).json();let n=[];return Array.isArray(t)?n=t:t.data&&Array.isArray(t.data)?n=t.data:t.data&&typeof t.data=="object"&&t.data.data&&Array.isArray(t.data.data)?n=t.data.data:t.data&&typeof t.data=="object"&&t.data.schools&&Array.isArray(t.data.schools)?n=t.data.schools:t.data&&typeof t.data=="object"&&t.data.result&&Array.isArray(t.data.result)?n=t.data.result:t.schools&&Array.isArray(t.schools)?n=t.schools:t.result&&Array.isArray(t.result)?n=t.result:n=[],n.map(r=>({id:r.id||r.school_id,school_name:r.school_name||r.name||r.schoolName||""}))},mhe=async(e,t)=>{try{const n=await fetch(`${tt}/schools/updateSchool/${e}`,{method:"PUT",headers:Ht(),body:JSON.stringify({school_name:t})});if(!n.ok){const r=await n.text();throw new Error(`Failed to update school: ${n.status} ${n.statusText} - ${r}`)}return await n.json()}catch(n){throw n}},ghe=async e=>{try{const t=await fetch(`${tt}/schools/deleteSchool/${e}`,{method:"DELETE",headers:Ht(),body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(`Failed to delete school: ${t.status} ${t.statusText} - ${n}`)}return await t.json()}catch(t){throw t}},XN=async()=>{try{const e=await fetch(`${tt}/states/getAll`,{method:"GET"});if(!e.ok)throw new Error("Failed to fetch states");return await e.json()}catch(e){throw e}},YN=async e=>{try{const t=await fetch(`${tt}/states/getByState/${e}`,{method:"GET"});if(!t.ok)throw new Error(`Failed to fetch districts for ${e}`);return await t.json()}catch(t){throw t}},bj=async e=>{try{const t=await fetch(`${tt}/districts/getByDistrict/${e}`,{method:"GET"});if(!t.ok)throw new Error(`Failed to fetch blocks for ${e}`);return await t.json()}catch(t){throw t}},yhe="654022633429-fv4rgcs654a0f9r0464tl6o8jvjk3dco.apps.googleusercontent.com",Gs=()=>{const e=Pr(),[t,n]=N.useState({user:null,loading:!0,isAuthenticated:!1}),{toast:r}=Qt();N.useEffect(()=>{a();const u=()=>{if(document.querySelector('script[src="https://accounts.google.com/gsi/client"]')){window.google&&h();return}const p=document.createElement("script");p.src="https://accounts.google.com/gsi/client",p.async=!0,p.defer=!0,document.head.appendChild(p),p.onload=()=>{h()},p.onerror=()=>{console.error("Failed to load Google OAuth script"),n({user:null,loading:!1,isAuthenticated:!1})}},h=()=>{if(window.google)try{window.google.accounts.id.initialize({client_id:yhe,callback:s,auto_select:!1,cancel_on_tap_outside:!0})}catch(p){console.error("Error initializing Google OAuth:",p),n({user:null,loading:!1,isAuthenticated:!1})}};u()},[]);const a=()=>{const u=localStorage.getItem("user"),h=localStorage.getItem("authToken");if(u&&h)try{const p=JSON.parse(u),f={id:p.id.toString(),email:p.email,name:p.name,avatar:p.profile_pic||"",provider:"google",role_id:p.user_role_id,role:p.role,role_name:p.role_name,profile_pic:p.profile_pic};n({user:f,isAuthenticated:!0,loading:!1})}catch(p){console.error("Error parsing stored user:",p),localStorage.removeItem("user"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),n({user:null,loading:!1,isAuthenticated:!1})}else n({user:null,loading:!1,isAuthenticated:!1})},s=async u=>{try{n(g=>({...g,loading:!0}));const h=JSON.parse(atob(u.credential.split(".")[1]));console.log("Google JWT payload:",h);const p={iss:h.iss,aud:h.aud,sub:h.sub,email:h.email,email_verified:h.email_verified||!0,name:h.name,iat:h.iat,exp:h.exp,picture:h.picture},f=await Rde(p);if(console.log("NG login response:",f),f.success&&f.data){const{user:g,token:m}=f.data;localStorage.setItem("authToken",m),localStorage.setItem("user",JSON.stringify(g)),g.role_name&&localStorage.setItem("userRole",JSON.stringify(g.role_name));const y={id:g.id.toString(),email:g.email,name:g.name,avatar:g.profile_pic||h.picture||"",provider:"google",role_id:g.role_id||g.role_id,role_name:g.role_name,profile_pic:g.profile_pic};n({user:y,loading:!1,isAuthenticated:!0}),console.log("Logged in user:",g),g.role_name==="ADMIN"||g.role_name==="USER"?(localStorage.setItem("userRole",JSON.stringify(g.role_name)),e("/"),r({title:"Welcome!",description:`Successfully signed in as ${g.name}`})):(localStorage.setItem("userRole",JSON.stringify("student")),e("/students"),r({title:"No Role Assigned",description:"No role assigned. Please contact admin to assign a role."}))}else throw new Error(f.message||"Login failed")}catch(h){console.error("Login error:",h),n({user:null,loading:!1,isAuthenticated:!1}),r({title:"Sign In Failed",description:h instanceof Error?h.message:"Failed to sign in. Please try again.",variant:"destructive"})}},i=()=>{if(window.google)try{window.google.accounts.id.disableAutoSelect()}catch(u){console.error("Error disabling Google auto select:",u)}localStorage.removeItem("authToken"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),localStorage.removeItem("googleUser"),localStorage.removeItem("roleAccess"),n({user:null,loading:!1,isAuthenticated:!1}),r({title:"Signed Out",description:"You have been successfully signed out."})},o=N.useCallback(u=>{if(window.google)try{const h=document.getElementById(u);h&&window.google.accounts.id.renderButton(h,{theme:"outline",size:"large",text:"continue_with",shape:"rectangular",width:250})}catch(h){console.error("Error rendering Google button:",h)}},[]),l=()=>{var u,h;return((h=(u=t.user)==null?void 0:u.role)==null?void 0:h.name)||null};return{...t,signOut:i,renderGoogleSignInButton:o,getUserRole:l,hasRole:u=>{const h=l();return h?h.toLowerCase()===u.toLowerCase():!1}}},FW=N.createContext(void 0);function xhe({children:e}){const[t,n]=N.useState(null),[r,a]=N.useState(null),[s,i]=N.useState(!0),{toast:o}=Qt(),{user:l,isAuthenticated:c,loading:u,getUserRole:h,hasRole:p,signOut:f}=Gs();N.useEffect(()=>{u||(()=>{l&&c?(l.id,l.email,l.name,l.avatar,h(),l.role_id,l.role_name):(n(null),a(null)),i(!1)})()},[l,c,u,h]);const g=async()=>{try{await f(),n(null),a(null),o({title:"Signed out successfully",description:"You have been logged out from all systems."})}catch(w){console.error("Logout error:",w),o({title:"Logout Error",description:"There was an issue signing you out. Please try again.",variant:"destructive"})}},m=()=>t,y=h(),b={user:t,session:r,loading:s||u,signOut:g,getUserInfo:m,isAuthenticated:c,userRole:y,hasRole:w=>p(w)};return d.jsx(FW.Provider,{value:b,children:e})}function vhe(){const e=N.useContext(FW);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const sP=10,PW=()=>{const[e,t]=N.useState([]),[n,r]=N.useState([]),[a,s]=N.useState(!0),[i,o]=N.useState(1),[l,c]=N.useState(1),[u,h]=N.useState(""),[p,f]=N.useState(!1),[g,m]=N.useState(""),[y,x]=N.useState({open:!1,email:"",name:"",phone:"",username:"",selectedRoleId:"",editId:null});N.useEffect(()=>{v(i),b()},[i]);const v=async(T=i)=>{var $,_;s(!0);try{const M=await nP(T,sP),L=(($=M==null?void 0:M.data)==null?void 0:$.data)||[],U=((_=M==null?void 0:M.data)==null?void 0:_.totalPages)||1;t(L),c(U)}catch(M){console.error("Error fetching users:",M),t([])}finally{s(!1)}},b=async()=>{try{const T=await DW();r(T)}catch(T){console.error("Error fetching roles:",T),r([])}},w=async T=>{var _;if(T.preventDefault(),/^\d{10}$/.test(y.phone.trim()))m("");else{console.error("Phone number must be exactly 10 digits"),m("Phone number must be exactly 10 digits");return}if(!y.name.trim()||!y.email.trim()||!y.phone.trim()||!y.selectedRoleId){console.error("Please fill all required fields");return}const $={name:y.name.trim(),mobile:y.phone.trim(),email:y.email.trim(),mail_id:y.email.trim(),user_name:y.username.trim()||y.email.split("@")[0],user_role_id:parseInt(y.selectedRoleId)};try{if(y.editId)await Mde(y.editId.toString(),$),await v();else{await Dde($);const M=await nP(1,sP),L=((_=M==null?void 0:M.data)==null?void 0:_.totalPages)||1;o(L),await v(L)}I()}catch(M){console.error("Error saving user:",M)}},k=()=>x({open:!0,email:"",name:"",phone:"",username:"",selectedRoleId:"",editId:null}),I=()=>x({open:!1,email:"",name:"",phone:"",username:"",selectedRoleId:"",editId:null}),C=async T=>{try{await Ode(T.toString()),await v()}catch($){console.error("Error deleting user:",$)}},S=T=>{const $=n.find(_=>_.id===T);return $?$.name:`Role ${T}`},E=e.filter(T=>T.name.toLowerCase().includes(u.toLowerCase())||T.email.toLowerCase().includes(u.toLowerCase())||T.user_name&&T.user_name.toLowerCase().includes(u.toLowerCase()));return d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[p&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>f(!1)}),d.jsx("div",{className:`fixed inset-y-0 left-0 z-50 transition-transform duration-300 ease-in-out lg:translate-x-0 ${p?"translate-x-0":"-translate-x-full"}`,children:d.jsx(ar,{})}),d.jsx("div",{className:"lg:pl-64",children:d.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:d.jsxs("div",{className:"max-w-7xl mx-auto",children:[d.jsx("div",{className:"lg:hidden mb-4",children:d.jsx("button",{onClick:()=>f(!0),className:"p-2 rounded-md bg-white shadow-sm border border-gray-200",children:d.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),d.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-3",children:[d.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:d.jsx(Ai,{className:"h-6 w-6 text-orange-600"})}),"User Management"]}),d.jsx("p",{className:"text-gray-600 mt-1",children:"Manage system users and their roles"})]}),d.jsxs("button",{onClick:k,className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2.5 rounded-lg flex items-center gap-2 transition-colors duration-200 shadow-sm hover:shadow-md",children:[d.jsx(Qn,{className:"h-4 w-4"}),d.jsx("span",{className:"hidden sm:inline",children:"Add User"}),d.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),d.jsxs("div",{className:"mt-4 relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(wa,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",placeholder:"Search users by name, email, or username...",value:u,onChange:T=>h(T.target.value),className:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-orange-500 focus:border-orange-500"}),u&&d.jsx("button",{onClick:()=>h(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:d.jsx(us,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})})]})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[d.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:d.jsx(Ai,{className:"h-5 w-5 text-blue-600"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),d.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:e.length})]})]})}),d.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:d.jsx(g0,{className:"h-5 w-5 text-green-600"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Roles"}),d.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n.length})]})]})}),d.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:d.jsx(wa,{className:"h-5 w-5 text-orange-600"})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Search Results"}),d.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:E.length})]})]})})]}),a?d.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12",children:d.jsxs("div",{className:"flex flex-col items-center justify-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"}),d.jsx("div",{className:"text-lg text-gray-600 mt-4",children:"Loading users..."})]})}):d.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[d.jsx("div",{className:"hidden md:block overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"User"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Contact"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Username"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Role"}),d.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(T=>d.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"h-10 w-10 bg-orange-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-orange-600 font-semibold text-sm",children:T.name.charAt(0).toUpperCase()})}),d.jsxs("div",{className:"ml-4",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.name}),d.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[d.jsx(Bx,{className:"h-3 w-3"}),T.email]})]})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-1",children:[d.jsx(mF,{className:"h-3 w-3"}),T.mobile||"-"]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("div",{className:"text-sm text-gray-900",children:T.user_name||"-"})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[d.jsx(g0,{className:"h-3 w-3 mr-1"}),S(T.user_role_id)]})}),d.jsx("td",{className:"px-6 py-4 text-center",children:d.jsxs("div",{className:"flex justify-center gap-2",children:[d.jsx("button",{onClick:()=>{var $;return x({open:!0,name:T.name,email:T.email,username:T.user_name||"",phone:T.mobile||"",selectedRoleId:(($=T.user_role_id)==null?void 0:$.toString())||"",editId:T.id})},className:"p-2 text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded-lg transition-colors duration-200",title:"Edit User",children:d.jsx(Fu,{size:16})}),d.jsx("button",{onClick:()=>C(T.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Delete User",children:d.jsx(Na,{size:16})})]})})]},T.id))})]})}),d.jsx("div",{className:"md:hidden divide-y divide-gray-200",children:E.map(T=>d.jsx("div",{className:"p-4",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[d.jsx("div",{className:"h-12 w-12 bg-orange-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-orange-600 font-semibold",children:T.name.charAt(0).toUpperCase()})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:T.name}),d.jsxs("p",{className:"text-sm text-gray-500 truncate flex items-center gap-1",children:[d.jsx(Bx,{className:"h-3 w-3"}),T.email]}),d.jsxs("div",{className:"mt-1 flex items-center gap-4 text-xs text-gray-500",children:[T.mobile&&d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsx(mF,{className:"h-3 w-3"}),T.mobile]}),d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[d.jsx(g0,{className:"h-3 w-3 mr-1"}),S(T.user_role_id)]})]})]})]}),d.jsxs("div",{className:"flex gap-2 ml-2",children:[d.jsx("button",{onClick:()=>{var $;return x({open:!0,name:T.name,email:T.email,username:T.user_name||"",phone:T.mobile||"",selectedRoleId:(($=T.user_role_id)==null?void 0:$.toString())||"",editId:T.id})},className:"p-2 text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded-lg transition-colors duration-200",children:d.jsx(Fu,{size:16})}),d.jsx("button",{onClick:()=>C(T.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-200",children:d.jsx(Na,{size:16})})]})]})},T.id))}),E.length===0&&d.jsxs("div",{className:"p-12 text-center",children:[d.jsx(Ai,{className:"mx-auto h-12 w-12 text-gray-400"}),d.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No users found"}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:u?"Try adjusting your search criteria.":"Get started by adding a new user."})]})]}),l>1&&d.jsx("div",{className:"flex justify-center mt-6",children:d.jsx("nav",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{onClick:()=>o(T=>Math.max(1,T-1)),disabled:i===1,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${i===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-orange-50 hover:text-orange-600"}`,children:"Previous"}),d.jsx("div",{className:"flex gap-1 mx-2",children:[...Array(l)].map((T,$)=>d.jsx("button",{onClick:()=>o($+1),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${i===$+1?"bg-orange-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-orange-50 hover:text-orange-600"}`,children:$+1},$))}),d.jsx("button",{onClick:()=>o(T=>Math.min(l,T+1)),disabled:i===l,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${i===l?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-orange-50 hover:text-orange-600"}`,children:"Next"})]})})}),y.open&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-bold text-gray-900",children:y.editId?"Edit User":"Add New User"}),d.jsx("button",{onClick:I,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:d.jsx(us,{className:"h-5 w-5 text-gray-500"})})]}),d.jsxs("form",{onSubmit:w,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),d.jsx("input",{type:"text",required:!0,value:y.name,onChange:T=>x($=>({...$,name:T.target.value})),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200",placeholder:"Enter full name"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),d.jsx("input",{type:"email",required:!0,value:y.email,onChange:T=>x($=>({...$,email:T.target.value})),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200",placeholder:"Enter email address"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),d.jsx("input",{type:"tel",required:!0,value:y.phone,onChange:T=>{const $=T.target.value;x(_=>({..._,phone:$})),/^\d{0,10}$/.test($)?m(""):m("Only numbers allowed, 10 digits")},className:`w-full px-3 py-2.5 border rounded-lg focus:ring-2 transition-colors duration-200 ${g?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-orange-500 focus:border-orange-500"}`,placeholder:"Enter 10-digit phone number"}),g&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),d.jsx("input",{type:"text",value:y.username,onChange:T=>x($=>({...$,username:T.target.value})),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200",placeholder:"Enter username (optional)"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only letters, numbers, underscores allowed. Defaults to email prefix if empty."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),d.jsxs("select",{required:!0,value:y.selectedRoleId,onChange:T=>x($=>({...$,selectedRoleId:T.target.value})),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200",children:[d.jsx("option",{value:"",disabled:!0,children:"Select a role"}),n.map(T=>d.jsx("option",{value:T.id,children:T.name},T.id))]})]}),d.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-4 border-t border-gray-200",children:[d.jsx("button",{type:"button",onClick:I,className:"px-4 py-2.5 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2.5 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors duration-200 shadow-sm hover:shadow-md",children:y.editId?"Update User":"Create User"})]})]})]})})]})})})]})};var H_="focusScope.autoFocusOnMount",G_="focusScope.autoFocusOnUnmount",iP={bubbles:!1,cancelable:!0},bhe="FocusScope",Dv=N.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:s,...i}=e,[o,l]=N.useState(null),c=rr(a),u=rr(s),h=N.useRef(null),p=kt(t,m=>l(m)),f=N.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;N.useEffect(()=>{if(r){let m=function(b){if(f.paused||!o)return;const w=b.target;o.contains(w)?h.current=w:Wl(h.current,{select:!0})},y=function(b){if(f.paused||!o)return;const w=b.relatedTarget;w!==null&&(o.contains(w)||Wl(h.current,{select:!0}))},x=function(b){if(document.activeElement===document.body)for(const k of b)k.removedNodes.length>0&&Wl(o)};document.addEventListener("focusin",m),document.addEventListener("focusout",y);const v=new MutationObserver(x);return o&&v.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",y),v.disconnect()}}},[r,o,f.paused]),N.useEffect(()=>{if(o){lP.add(f);const m=document.activeElement;if(!o.contains(m)){const x=new CustomEvent(H_,iP);o.addEventListener(H_,c),o.dispatchEvent(x),x.defaultPrevented||(whe(Che(LW(o)),{select:!0}),document.activeElement===m&&Wl(o))}return()=>{o.removeEventListener(H_,c),setTimeout(()=>{const x=new CustomEvent(G_,iP);o.addEventListener(G_,u),o.dispatchEvent(x),x.defaultPrevented||Wl(m??document.body,{select:!0}),o.removeEventListener(G_,u),lP.remove(f)},0)}}},[o,c,u,f]);const g=N.useCallback(m=>{if(!n&&!r||f.paused)return;const y=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,x=document.activeElement;if(y&&x){const v=m.currentTarget,[b,w]=Nhe(v);b&&w?!m.shiftKey&&x===w?(m.preventDefault(),n&&Wl(b,{select:!0})):m.shiftKey&&x===b&&(m.preventDefault(),n&&Wl(w,{select:!0})):x===v&&m.preventDefault()}},[n,r,f.paused]);return d.jsx(Qe.div,{tabIndex:-1,...i,ref:p,onKeyDown:g})});Dv.displayName=bhe;function whe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Wl(r,{select:t}),document.activeElement!==n)return}function Nhe(e){const t=LW(e),n=oP(t,e),r=oP(t.reverse(),e);return[n,r]}function LW(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function oP(e,t){for(const n of e)if(!khe(n,{upTo:t}))return n}function khe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function She(e){return e instanceof HTMLInputElement&&"select"in e}function Wl(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&She(e)&&t&&e.select()}}var lP=_he();function _he(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=uP(e,t),e.unshift(t)},remove(t){var n;e=uP(e,t),(n=e[0])==null||n.resume()}}}function uP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Che(e){return e.filter(t=>t.tagName!=="A")}var q_=0;function JN(){N.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??cP()),document.body.insertAdjacentElement("beforeend",e[1]??cP()),q_++,()=>{q_===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),q_--}},[])}function cP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var po=function(){return po=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},po.apply(this,arguments)};function zW(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function Ihe(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,s;r<a;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}var N0="right-scroll-bar-position",k0="width-before-scroll-bar",Ehe="with-scroll-bars-hidden",The="--removed-body-scroll-bar-size";function K_(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function jhe(e,t){var n=N.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var Ahe=typeof window<"u"?N.useLayoutEffect:N.useEffect,dP=new WeakMap;function $he(e,t){var n=jhe(null,function(r){return e.forEach(function(a){return K_(a,r)})});return Ahe(function(){var r=dP.get(n);if(r){var a=new Set(r),s=new Set(e),i=n.current;a.forEach(function(o){s.has(o)||K_(o,null)}),s.forEach(function(o){a.has(o)||K_(o,i)})}dP.set(n,e)},[e]),n}function Rhe(e){return e}function Dhe(e,t){t===void 0&&(t=Rhe);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(s){var i=t(s,r);return n.push(i),function(){n=n.filter(function(o){return o!==i})}},assignSyncMedium:function(s){for(r=!0;n.length;){var i=n;n=[],i.forEach(s)}n={push:function(o){return s(o)},filter:function(){return n}}},assignMedium:function(s){r=!0;var i=[];if(n.length){var o=n;n=[],o.forEach(s),i=n}var l=function(){var u=i;i=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){i.push(u),c()},filter:function(u){return i=i.filter(u),n}}}};return a}function Mhe(e){e===void 0&&(e={});var t=Dhe(null);return t.options=po({async:!0,ssr:!1},e),t}var BW=function(e){var t=e.sideCar,n=zW(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return N.createElement(r,po({},n))};BW.isSideCarExport=!0;function Ohe(e,t){return e.useMedium(t),BW}var UW=Mhe(),Q_=function(){},ZN=N.forwardRef(function(e,t){var n=N.useRef(null),r=N.useState({onScrollCapture:Q_,onWheelCapture:Q_,onTouchMoveCapture:Q_}),a=r[0],s=r[1],i=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,h=e.shards,p=e.sideCar,f=e.noRelative,g=e.noIsolation,m=e.inert,y=e.allowPinchZoom,x=e.as,v=x===void 0?"div":x,b=e.gapMode,w=zW(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=p,I=$he([n,t]),C=po(po({},w),a);return N.createElement(N.Fragment,null,u&&N.createElement(k,{sideCar:UW,removeScrollBar:c,shards:h,noRelative:f,noIsolation:g,inert:m,setCallbacks:s,allowPinchZoom:!!y,lockRef:n,gapMode:b}),i?N.cloneElement(N.Children.only(o),po(po({},C),{ref:I})):N.createElement(v,po({},C,{className:l,ref:I}),o))});ZN.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};ZN.classNames={fullWidth:k0,zeroRight:N0};var Fhe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Phe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Fhe();return t&&e.setAttribute("nonce",t),e}function Lhe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function zhe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Bhe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Phe())&&(Lhe(t,n),zhe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Uhe=function(){var e=Bhe();return function(t,n){N.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},WW=function(){var e=Uhe(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},Whe={left:0,top:0,right:0,gap:0},X_=function(e){return parseInt(e||"",10)||0},Vhe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[X_(n),X_(r),X_(a)]},Hhe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Whe;var t=Vhe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},Ghe=WW(),Ef="data-scroll-locked",qhe=function(e,t,n,r){var a=e.left,s=e.top,i=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ehe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(Ef,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(N0,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(k0,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(N0," .").concat(N0,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(k0," .").concat(k0,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ef,`] {
    `).concat(The,": ").concat(o,`px;
  }
`)},hP=function(){var e=parseInt(document.body.getAttribute(Ef)||"0",10);return isFinite(e)?e:0},Khe=function(){N.useEffect(function(){return document.body.setAttribute(Ef,(hP()+1).toString()),function(){var e=hP()-1;e<=0?document.body.removeAttribute(Ef):document.body.setAttribute(Ef,e.toString())}},[])},Qhe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;Khe();var s=N.useMemo(function(){return Hhe(a)},[a]);return N.createElement(Ghe,{styles:qhe(s,!t,a,n?"":"!important")})},dI=!1;if(typeof window<"u")try{var Tw=Object.defineProperty({},"passive",{get:function(){return dI=!0,!0}});window.addEventListener("test",Tw,Tw),window.removeEventListener("test",Tw,Tw)}catch{dI=!1}var zp=dI?{passive:!1}:!1,Xhe=function(e){return e.tagName==="TEXTAREA"},VW=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Xhe(e)&&n[t]==="visible")},Yhe=function(e){return VW(e,"overflowY")},Jhe=function(e){return VW(e,"overflowX")},pP=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=HW(e,r);if(a){var s=GW(e,r),i=s[1],o=s[2];if(i>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Zhe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},epe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},HW=function(e,t){return e==="v"?Yhe(t):Jhe(t)},GW=function(e,t){return e==="v"?Zhe(t):epe(t)},tpe=function(e,t){return e==="h"&&t==="rtl"?-1:1},npe=function(e,t,n,r,a){var s=tpe(e,window.getComputedStyle(t).direction),i=s*r,o=n.target,l=t.contains(o),c=!1,u=i>0,h=0,p=0;do{if(!o)break;var f=GW(e,o),g=f[0],m=f[1],y=f[2],x=m-y-s*g;(g||x)&&HW(e,o)&&(h+=x,p+=g);var v=o.parentNode;o=v&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE?v.host:v}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(h)<1||!u&&Math.abs(p)<1)&&(c=!0),c},jw=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},fP=function(e){return[e.deltaX,e.deltaY]},mP=function(e){return e&&"current"in e?e.current:e},rpe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},ape=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},spe=0,Bp=[];function ipe(e){var t=N.useRef([]),n=N.useRef([0,0]),r=N.useRef(),a=N.useState(spe++)[0],s=N.useState(WW)[0],i=N.useRef(e);N.useEffect(function(){i.current=e},[e]),N.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=Ihe([e.lockRef.current],(e.shards||[]).map(mP),!0).filter(Boolean);return m.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=N.useCallback(function(m,y){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var x=jw(m),v=n.current,b="deltaX"in m?m.deltaX:v[0]-x[0],w="deltaY"in m?m.deltaY:v[1]-x[1],k,I=m.target,C=Math.abs(b)>Math.abs(w)?"h":"v";if("touches"in m&&C==="h"&&I.type==="range")return!1;var S=pP(C,I);if(!S)return!0;if(S?k=C:(k=C==="v"?"h":"v",S=pP(C,I)),!S)return!1;if(!r.current&&"changedTouches"in m&&(b||w)&&(r.current=k),!k)return!0;var E=r.current||k;return npe(E,y,m,E==="h"?b:w)},[]),l=N.useCallback(function(m){var y=m;if(!(!Bp.length||Bp[Bp.length-1]!==s)){var x="deltaY"in y?fP(y):jw(y),v=t.current.filter(function(k){return k.name===y.type&&(k.target===y.target||y.target===k.shadowParent)&&rpe(k.delta,x)})[0];if(v&&v.should){y.cancelable&&y.preventDefault();return}if(!v){var b=(i.current.shards||[]).map(mP).filter(Boolean).filter(function(k){return k.contains(y.target)}),w=b.length>0?o(y,b[0]):!i.current.noIsolation;w&&y.cancelable&&y.preventDefault()}}},[]),c=N.useCallback(function(m,y,x,v){var b={name:m,delta:y,target:x,should:v,shadowParent:ope(x)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(w){return w!==b})},1)},[]),u=N.useCallback(function(m){n.current=jw(m),r.current=void 0},[]),h=N.useCallback(function(m){c(m.type,fP(m),m.target,o(m,e.lockRef.current))},[]),p=N.useCallback(function(m){c(m.type,jw(m),m.target,o(m,e.lockRef.current))},[]);N.useEffect(function(){return Bp.push(s),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:p}),document.addEventListener("wheel",l,zp),document.addEventListener("touchmove",l,zp),document.addEventListener("touchstart",u,zp),function(){Bp=Bp.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,zp),document.removeEventListener("touchmove",l,zp),document.removeEventListener("touchstart",u,zp)}},[]);var f=e.removeScrollBar,g=e.inert;return N.createElement(N.Fragment,null,g?N.createElement(s,{styles:ape(a)}):null,f?N.createElement(Qhe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function ope(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const lpe=Ohe(UW,ipe);var Mv=N.forwardRef(function(e,t){return N.createElement(ZN,po({},e,{ref:t,sideCar:lpe}))});Mv.classNames=ZN.classNames;var upe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Up=new WeakMap,Aw=new WeakMap,$w={},Y_=0,qW=function(e){return e&&(e.host||qW(e.parentNode))},cpe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=qW(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},dpe=function(e,t,n,r){var a=cpe(t,Array.isArray(e)?e:[e]);$w[n]||($w[n]=new WeakMap);var s=$w[n],i=[],o=new Set,l=new Set(a),c=function(h){!h||o.has(h)||(o.add(h),c(h.parentNode))};a.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(p){if(o.has(p))u(p);else try{var f=p.getAttribute(r),g=f!==null&&f!=="false",m=(Up.get(p)||0)+1,y=(s.get(p)||0)+1;Up.set(p,m),s.set(p,y),i.push(p),m===1&&g&&Aw.set(p,!0),y===1&&p.setAttribute(n,"true"),g||p.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",p,x)}})};return u(t),o.clear(),Y_++,function(){i.forEach(function(h){var p=Up.get(h)-1,f=s.get(h)-1;Up.set(h,p),s.set(h,f),p||(Aw.has(h)||h.removeAttribute(r),Aw.delete(h)),f||h.removeAttribute(n)}),Y_--,Y_||(Up=new WeakMap,Up=new WeakMap,Aw=new WeakMap,$w={})}},ek=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=upe(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live], script"))),dpe(r,a,n,"aria-hidden")):function(){return null}},tk="Dialog",[KW,Tat]=ia(tk),[hpe,qi]=KW(tk),QW=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:s,modal:i=!0}=e,o=N.useRef(null),l=N.useRef(null),[c,u]=Io({prop:r,defaultProp:a??!1,onChange:s,caller:tk});return d.jsx(hpe,{scope:t,triggerRef:o,contentRef:l,contentId:$i(),titleId:$i(),descriptionId:$i(),open:c,onOpenChange:u,onOpenToggle:N.useCallback(()=>u(h=>!h),[u]),modal:i,children:n})};QW.displayName=tk;var XW="DialogTrigger",YW=N.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=qi(XW,n),s=kt(t,a.triggerRef);return d.jsx(Qe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":kj(a.open),...r,ref:s,onClick:Te(e.onClick,a.onOpenToggle)})});YW.displayName=XW;var wj="DialogPortal",[ppe,JW]=KW(wj,{forceMount:void 0}),ZW=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,s=qi(wj,t);return d.jsx(ppe,{scope:t,forceMount:n,children:N.Children.map(r,i=>d.jsx(Lr,{present:n||s.open,children:d.jsx(Am,{asChild:!0,container:a,children:i})}))})};ZW.displayName=wj;var y1="DialogOverlay",e5=N.forwardRef((e,t)=>{const n=JW(y1,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,s=qi(y1,e.__scopeDialog);return s.modal?d.jsx(Lr,{present:r||s.open,children:d.jsx(mpe,{...a,ref:t})}):null});e5.displayName=y1;var fpe=Ou("DialogOverlay.RemoveScroll"),mpe=N.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=qi(y1,n);return d.jsx(Mv,{as:fpe,allowPinchZoom:!0,shards:[a.contentRef],children:d.jsx(Qe.div,{"data-state":kj(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Ed="DialogContent",t5=N.forwardRef((e,t)=>{const n=JW(Ed,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,s=qi(Ed,e.__scopeDialog);return d.jsx(Lr,{present:r||s.open,children:s.modal?d.jsx(gpe,{...a,ref:t}):d.jsx(ype,{...a,ref:t})})});t5.displayName=Ed;var gpe=N.forwardRef((e,t)=>{const n=qi(Ed,e.__scopeDialog),r=N.useRef(null),a=kt(t,n.contentRef,r);return N.useEffect(()=>{const s=r.current;if(s)return ek(s)},[]),d.jsx(n5,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Te(e.onCloseAutoFocus,s=>{var i;s.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:Te(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&s.preventDefault()}),onFocusOutside:Te(e.onFocusOutside,s=>s.preventDefault())})}),ype=N.forwardRef((e,t)=>{const n=qi(Ed,e.__scopeDialog),r=N.useRef(!1),a=N.useRef(!1);return d.jsx(n5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),s.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),n5=N.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:s,...i}=e,o=qi(Ed,n),l=N.useRef(null),c=kt(t,l);return JN(),d.jsxs(d.Fragment,{children:[d.jsx(Dv,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:s,children:d.jsx(th,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":kj(o.open),...i,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),d.jsxs(d.Fragment,{children:[d.jsx(xpe,{titleId:o.titleId}),d.jsx(bpe,{contentRef:l,descriptionId:o.descriptionId})]})]})}),Nj="DialogTitle",r5=N.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=qi(Nj,n);return d.jsx(Qe.h2,{id:a.titleId,...r,ref:t})});r5.displayName=Nj;var a5="DialogDescription",s5=N.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=qi(a5,n);return d.jsx(Qe.p,{id:a.descriptionId,...r,ref:t})});s5.displayName=a5;var i5="DialogClose",o5=N.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=qi(i5,n);return d.jsx(Qe.button,{type:"button",...r,ref:t,onClick:Te(e.onClick,()=>a.onOpenChange(!1))})});o5.displayName=i5;function kj(e){return e?"open":"closed"}var l5="DialogTitleWarning",[jat,u5]=Lre(l5,{contentName:Ed,titleName:Nj,docsSlug:"dialog"}),xpe=({titleId:e})=>{const t=u5(l5),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return N.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},vpe="DialogDescriptionWarning",bpe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${u5(vpe).contentName}}.`;return N.useEffect(()=>{var s;const a=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},wpe=QW,Npe=YW,kpe=ZW,c5=e5,d5=t5,h5=r5,p5=s5,Spe=o5;const ta=wpe,f5=Npe,_pe=kpe,m5=N.forwardRef(({className:e,...t},n)=>d.jsx(c5,{ref:n,className:Fe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));m5.displayName=c5.displayName;const na=N.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(_pe,{children:[d.jsx(m5,{}),d.jsxs(d5,{ref:r,className:Fe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,d.jsxs(Spe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[d.jsx(us,{className:"h-4 w-4"}),d.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));na.displayName=d5.displayName;const ka=({className:e,...t})=>d.jsx("div",{className:Fe("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ka.displayName="DialogHeader";const Sj=({className:e,...t})=>d.jsx("div",{className:Fe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Sj.displayName="DialogFooter";const ra=N.forwardRef(({className:e,...t},n)=>d.jsx(h5,{ref:n,className:Fe("text-lg font-semibold leading-none tracking-tight",e),...t}));ra.displayName=h5.displayName;const _j=N.forwardRef(({className:e,...t},n)=>d.jsx(p5,{ref:n,className:Fe("text-sm text-muted-foreground",e),...t}));_j.displayName=p5.displayName;const hI=Cv("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),fe=N.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},s)=>{const i=r?Bre:"button";return d.jsx(i,{className:Fe(hI({variant:t,size:n,className:e})),ref:s,...a})});fe.displayName="Button";const Je=N.forwardRef(({className:e,type:t,...n},r)=>d.jsx("input",{type:t,className:Fe("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));Je.displayName="Input";function pI(e,[t,n]){return Math.min(n,Math.max(t,e))}var Cpe=N.createContext(void 0);function Bm(e){const t=N.useContext(Cpe);return e||t||"ltr"}function Cj(e){const t=N.useRef({value:e,previous:e});return N.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Ipe=[" ","Enter","ArrowUp","ArrowDown"],Epe=[" ","Enter"],Td="Select",[nk,rk,Tpe]=TN(Td),[Um,Aat]=ia(Td,[Tpe,lc]),ak=lc(),[jpe,uc]=Um(Td),[Ape,$pe]=Um(Td),g5=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:s,value:i,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:h,disabled:p,required:f,form:g}=e,m=ak(t),[y,x]=N.useState(null),[v,b]=N.useState(null),[w,k]=N.useState(!1),I=Bm(c),[C,S]=Io({prop:r,defaultProp:a??!1,onChange:s,caller:Td}),[E,T]=Io({prop:i,defaultProp:o,onChange:l,caller:Td}),$=N.useRef(null),_=y?g||!!y.closest("form"):!0,[M,L]=N.useState(new Set),U=Array.from(M).map(O=>O.props.value).join(";");return d.jsx(lj,{...m,children:d.jsxs(jpe,{required:f,scope:t,trigger:y,onTriggerChange:x,valueNode:v,onValueNodeChange:b,valueNodeHasChildren:w,onValueNodeHasChildrenChange:k,contentId:$i(),value:E,onValueChange:T,open:C,onOpenChange:S,dir:I,triggerPointerDownPosRef:$,disabled:p,children:[d.jsx(nk.Provider,{scope:t,children:d.jsx(Ape,{scope:e.__scopeSelect,onNativeOptionAdd:N.useCallback(O=>{L(F=>new Set(F).add(O))},[]),onNativeOptionRemove:N.useCallback(O=>{L(F=>{const D=new Set(F);return D.delete(O),D})},[]),children:n})}),_?d.jsxs(z5,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:h,value:E,onChange:O=>T(O.target.value),disabled:p,form:g,children:[E===void 0?d.jsx("option",{value:""}):null,Array.from(M)]},U):null]})})};g5.displayName=Td;var y5="SelectTrigger",x5=N.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,s=ak(n),i=uc(y5,n),o=i.disabled||r,l=kt(t,i.onTriggerChange),c=rk(n),u=N.useRef("touch"),[h,p,f]=U5(m=>{const y=c().filter(b=>!b.disabled),x=y.find(b=>b.value===i.value),v=W5(y,m,x);v!==void 0&&i.onValueChange(v.value)}),g=m=>{o||(i.onOpenChange(!0),f()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return d.jsx(Ev,{asChild:!0,...s,children:d.jsx(Qe.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":B5(i.value)?"":void 0,...a,ref:l,onClick:Te(a.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&g(m)}),onPointerDown:Te(a.onPointerDown,m=>{u.current=m.pointerType;const y=m.target;y.hasPointerCapture(m.pointerId)&&y.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(g(m),m.preventDefault())}),onKeyDown:Te(a.onKeyDown,m=>{const y=h.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&p(m.key),!(y&&m.key===" ")&&Ipe.includes(m.key)&&(g(),m.preventDefault())})})})});x5.displayName=y5;var v5="SelectValue",b5=N.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:s,placeholder:i="",...o}=e,l=uc(v5,n),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,h=kt(t,l.onValueNodeChange);return fr(()=>{c(u)},[c,u]),d.jsx(Qe.span,{...o,ref:h,style:{pointerEvents:"none"},children:B5(l.value)?d.jsx(d.Fragment,{children:i}):s})});b5.displayName=v5;var Rpe="SelectIcon",w5=N.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return d.jsx(Qe.span,{"aria-hidden":!0,...a,ref:t,children:r||"▼"})});w5.displayName=Rpe;var Dpe="SelectPortal",N5=e=>d.jsx(Am,{asChild:!0,...e});N5.displayName=Dpe;var jd="SelectContent",k5=N.forwardRef((e,t)=>{const n=uc(jd,e.__scopeSelect),[r,a]=N.useState();if(fr(()=>{a(new DocumentFragment)},[]),!n.open){const s=r;return s?eh.createPortal(d.jsx(S5,{scope:e.__scopeSelect,children:d.jsx(nk.Slot,{scope:e.__scopeSelect,children:d.jsx("div",{children:e.children})})}),s):null}return d.jsx(_5,{...e,ref:t})});k5.displayName=jd;var wi=10,[S5,cc]=Um(jd),Mpe="SelectContentImpl",Ope=Ou("SelectContent.RemoveScroll"),_5=N.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:s,onPointerDownOutside:i,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:p,collisionPadding:f,sticky:g,hideWhenDetached:m,avoidCollisions:y,...x}=e,v=uc(jd,n),[b,w]=N.useState(null),[k,I]=N.useState(null),C=kt(t,ie=>w(ie)),[S,E]=N.useState(null),[T,$]=N.useState(null),_=rk(n),[M,L]=N.useState(!1),U=N.useRef(!1);N.useEffect(()=>{if(b)return ek(b)},[b]),JN();const O=N.useCallback(ie=>{const[oe,...q]=_().map(be=>be.ref.current),[de]=q.slice(-1),ye=document.activeElement;for(const be of ie)if(be===ye||(be==null||be.scrollIntoView({block:"nearest"}),be===oe&&k&&(k.scrollTop=0),be===de&&k&&(k.scrollTop=k.scrollHeight),be==null||be.focus(),document.activeElement!==ye))return},[_,k]),F=N.useCallback(()=>O([S,b]),[O,S,b]);N.useEffect(()=>{M&&F()},[M,F]);const{onOpenChange:D,triggerPointerDownPosRef:R}=v;N.useEffect(()=>{if(b){let ie={x:0,y:0};const oe=de=>{var ye,be;ie={x:Math.abs(Math.round(de.pageX)-(((ye=R.current)==null?void 0:ye.x)??0)),y:Math.abs(Math.round(de.pageY)-(((be=R.current)==null?void 0:be.y)??0))}},q=de=>{ie.x<=10&&ie.y<=10?de.preventDefault():b.contains(de.target)||D(!1),document.removeEventListener("pointermove",oe),R.current=null};return R.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",q,{capture:!0})}}},[b,D,R]),N.useEffect(()=>{const ie=()=>D(!1);return window.addEventListener("blur",ie),window.addEventListener("resize",ie),()=>{window.removeEventListener("blur",ie),window.removeEventListener("resize",ie)}},[D]);const[V,G]=U5(ie=>{const oe=_().filter(ye=>!ye.disabled),q=oe.find(ye=>ye.ref.current===document.activeElement),de=W5(oe,ie,q);de&&setTimeout(()=>de.ref.current.focus())}),W=N.useCallback((ie,oe,q)=>{const de=!U.current&&!q;(v.value!==void 0&&v.value===oe||de)&&(E(ie),de&&(U.current=!0))},[v.value]),B=N.useCallback(()=>b==null?void 0:b.focus(),[b]),Q=N.useCallback((ie,oe,q)=>{const de=!U.current&&!q;(v.value!==void 0&&v.value===oe||de)&&$(ie)},[v.value]),X=r==="popper"?fI:C5,pe=X===fI?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:p,collisionPadding:f,sticky:g,hideWhenDetached:m,avoidCollisions:y}:{};return d.jsx(S5,{scope:n,content:b,viewport:k,onViewportChange:I,itemRefCallback:W,selectedItem:S,onItemLeave:B,itemTextRefCallback:Q,focusSelectedItem:F,selectedItemText:T,position:r,isPositioned:M,searchRef:V,children:d.jsx(Mv,{as:Ope,allowPinchZoom:!0,children:d.jsx(Dv,{asChild:!0,trapped:v.open,onMountAutoFocus:ie=>{ie.preventDefault()},onUnmountAutoFocus:Te(a,ie=>{var oe;(oe=v.trigger)==null||oe.focus({preventScroll:!0}),ie.preventDefault()}),children:d.jsx(th,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:ie=>ie.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:d.jsx(X,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:ie=>ie.preventDefault(),...x,...pe,onPlaced:()=>L(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Te(x.onKeyDown,ie=>{const oe=ie.ctrlKey||ie.altKey||ie.metaKey;if(ie.key==="Tab"&&ie.preventDefault(),!oe&&ie.key.length===1&&G(ie.key),["ArrowUp","ArrowDown","Home","End"].includes(ie.key)){let de=_().filter(ye=>!ye.disabled).map(ye=>ye.ref.current);if(["ArrowUp","End"].includes(ie.key)&&(de=de.slice().reverse()),["ArrowUp","ArrowDown"].includes(ie.key)){const ye=ie.target,be=de.indexOf(ye);de=de.slice(be+1)}setTimeout(()=>O(de)),ie.preventDefault()}})})})})})})});_5.displayName=Mpe;var Fpe="SelectItemAlignedPosition",C5=N.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,s=uc(jd,n),i=cc(jd,n),[o,l]=N.useState(null),[c,u]=N.useState(null),h=kt(t,C=>u(C)),p=rk(n),f=N.useRef(!1),g=N.useRef(!0),{viewport:m,selectedItem:y,selectedItemText:x,focusSelectedItem:v}=i,b=N.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&c&&m&&y&&x){const C=s.trigger.getBoundingClientRect(),S=c.getBoundingClientRect(),E=s.valueNode.getBoundingClientRect(),T=x.getBoundingClientRect();if(s.dir!=="rtl"){const ye=T.left-S.left,be=E.left-ye,Ce=C.left-be,se=C.width+Ce,ae=Math.max(se,S.width),ue=window.innerWidth-wi,ke=pI(be,[wi,Math.max(wi,ue-ae)]);o.style.minWidth=se+"px",o.style.left=ke+"px"}else{const ye=S.right-T.right,be=window.innerWidth-E.right-ye,Ce=window.innerWidth-C.right-be,se=C.width+Ce,ae=Math.max(se,S.width),ue=window.innerWidth-wi,ke=pI(be,[wi,Math.max(wi,ue-ae)]);o.style.minWidth=se+"px",o.style.right=ke+"px"}const $=p(),_=window.innerHeight-wi*2,M=m.scrollHeight,L=window.getComputedStyle(c),U=parseInt(L.borderTopWidth,10),O=parseInt(L.paddingTop,10),F=parseInt(L.borderBottomWidth,10),D=parseInt(L.paddingBottom,10),R=U+O+M+D+F,V=Math.min(y.offsetHeight*5,R),G=window.getComputedStyle(m),W=parseInt(G.paddingTop,10),B=parseInt(G.paddingBottom,10),Q=C.top+C.height/2-wi,X=_-Q,pe=y.offsetHeight/2,ie=y.offsetTop+pe,oe=U+O+ie,q=R-oe;if(oe<=Q){const ye=$.length>0&&y===$[$.length-1].ref.current;o.style.bottom="0px";const be=c.clientHeight-m.offsetTop-m.offsetHeight,Ce=Math.max(X,pe+(ye?B:0)+be+F),se=oe+Ce;o.style.height=se+"px"}else{const ye=$.length>0&&y===$[0].ref.current;o.style.top="0px";const Ce=Math.max(Q,U+m.offsetTop+(ye?W:0)+pe)+q;o.style.height=Ce+"px",m.scrollTop=oe-Q+m.offsetTop}o.style.margin=`${wi}px 0`,o.style.minHeight=V+"px",o.style.maxHeight=_+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[p,s.trigger,s.valueNode,o,c,m,y,x,s.dir,r]);fr(()=>b(),[b]);const[w,k]=N.useState();fr(()=>{c&&k(window.getComputedStyle(c).zIndex)},[c]);const I=N.useCallback(C=>{C&&g.current===!0&&(b(),v==null||v(),g.current=!1)},[b,v]);return d.jsx(Lpe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:f,onScrollButtonChange:I,children:d.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:d.jsx(Qe.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});C5.displayName=Fpe;var Ppe="SelectPopperPosition",fI=N.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=wi,...s}=e,i=ak(n);return d.jsx(ON,{...i,...s,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});fI.displayName=Ppe;var[Lpe,Ij]=Um(jd,{}),mI="SelectViewport",I5=N.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,s=cc(mI,n),i=Ij(mI,n),o=kt(t,s.onViewportChange),l=N.useRef(0);return d.jsxs(d.Fragment,{children:[d.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),d.jsx(nk.Slot,{scope:n,children:d.jsx(Qe.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Te(a.onScroll,c=>{const u=c.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:p}=i;if(p!=null&&p.current&&h){const f=Math.abs(l.current-u.scrollTop);if(f>0){const g=window.innerHeight-wi*2,m=parseFloat(h.style.minHeight),y=parseFloat(h.style.height),x=Math.max(m,y);if(x<g){const v=x+f,b=Math.min(g,v),w=v-b;h.style.height=b+"px",h.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,h.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});I5.displayName=mI;var E5="SelectGroup",[zpe,Bpe]=Um(E5),Upe=N.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=$i();return d.jsx(zpe,{scope:n,id:a,children:d.jsx(Qe.div,{role:"group","aria-labelledby":a,...r,ref:t})})});Upe.displayName=E5;var T5="SelectLabel",j5=N.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Bpe(T5,n);return d.jsx(Qe.div,{id:a.id,...r,ref:t})});j5.displayName=T5;var x1="SelectItem",[Wpe,A5]=Um(x1),$5=N.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:s,...i}=e,o=uc(x1,n),l=cc(x1,n),c=o.value===r,[u,h]=N.useState(s??""),[p,f]=N.useState(!1),g=kt(t,v=>{var b;return(b=l.itemRefCallback)==null?void 0:b.call(l,v,r,a)}),m=$i(),y=N.useRef("touch"),x=()=>{a||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return d.jsx(Wpe,{scope:n,value:r,disabled:a,textId:m,isSelected:c,onItemTextChange:N.useCallback(v=>{h(b=>b||((v==null?void 0:v.textContent)??"").trim())},[]),children:d.jsx(nk.ItemSlot,{scope:n,value:r,disabled:a,textValue:u,children:d.jsx(Qe.div,{role:"option","aria-labelledby":m,"data-highlighted":p?"":void 0,"aria-selected":c&&p,"data-state":c?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:g,onFocus:Te(i.onFocus,()=>f(!0)),onBlur:Te(i.onBlur,()=>f(!1)),onClick:Te(i.onClick,()=>{y.current!=="mouse"&&x()}),onPointerUp:Te(i.onPointerUp,()=>{y.current==="mouse"&&x()}),onPointerDown:Te(i.onPointerDown,v=>{y.current=v.pointerType}),onPointerMove:Te(i.onPointerMove,v=>{var b;y.current=v.pointerType,a?(b=l.onItemLeave)==null||b.call(l):y.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Te(i.onPointerLeave,v=>{var b;v.currentTarget===document.activeElement&&((b=l.onItemLeave)==null||b.call(l))}),onKeyDown:Te(i.onKeyDown,v=>{var w;((w=l.searchRef)==null?void 0:w.current)!==""&&v.key===" "||(Epe.includes(v.key)&&x(),v.key===" "&&v.preventDefault())})})})})});$5.displayName=x1;var Hy="SelectItemText",R5=N.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...s}=e,i=uc(Hy,n),o=cc(Hy,n),l=A5(Hy,n),c=$pe(Hy,n),[u,h]=N.useState(null),p=kt(t,x=>h(x),l.onItemTextChange,x=>{var v;return(v=o.itemTextRefCallback)==null?void 0:v.call(o,x,l.value,l.disabled)}),f=u==null?void 0:u.textContent,g=N.useMemo(()=>d.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:m,onNativeOptionRemove:y}=c;return fr(()=>(m(g),()=>y(g)),[m,y,g]),d.jsxs(d.Fragment,{children:[d.jsx(Qe.span,{id:l.textId,...s,ref:p}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?eh.createPortal(s.children,i.valueNode):null]})});R5.displayName=Hy;var D5="SelectItemIndicator",M5=N.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return A5(D5,n).isSelected?d.jsx(Qe.span,{"aria-hidden":!0,...r,ref:t}):null});M5.displayName=D5;var gI="SelectScrollUpButton",O5=N.forwardRef((e,t)=>{const n=cc(gI,e.__scopeSelect),r=Ij(gI,e.__scopeSelect),[a,s]=N.useState(!1),i=kt(t,r.onScrollButtonChange);return fr(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),a?d.jsx(P5,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});O5.displayName=gI;var yI="SelectScrollDownButton",F5=N.forwardRef((e,t)=>{const n=cc(yI,e.__scopeSelect),r=Ij(yI,e.__scopeSelect),[a,s]=N.useState(!1),i=kt(t,r.onScrollButtonChange);return fr(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),a?d.jsx(P5,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});F5.displayName=yI;var P5=N.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,s=cc("SelectScrollButton",n),i=N.useRef(null),o=rk(n),l=N.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return N.useEffect(()=>()=>l(),[l]),fr(()=>{var u;const c=o().find(h=>h.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),d.jsx(Qe.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Te(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:Te(a.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:Te(a.onPointerLeave,()=>{l()})})}),Vpe="SelectSeparator",L5=N.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return d.jsx(Qe.div,{"aria-hidden":!0,...r,ref:t})});L5.displayName=Vpe;var xI="SelectArrow",Hpe=N.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=ak(n),s=uc(xI,n),i=cc(xI,n);return s.open&&i.position==="popper"?d.jsx(FN,{...a,...r,ref:t}):null});Hpe.displayName=xI;var Gpe="SelectBubbleInput",z5=N.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const a=N.useRef(null),s=kt(r,a),i=Cj(t);return N.useEffect(()=>{const o=a.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(i!==t&&u){const h=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(h)}},[i,t]),d.jsx(Qe.select,{...n,style:{...OB,...n.style},ref:s,defaultValue:t})});z5.displayName=Gpe;function B5(e){return e===""||e===void 0}function U5(e){const t=rr(e),n=N.useRef(""),r=N.useRef(0),a=N.useCallback(i=>{const o=n.current+i;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=N.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return N.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,s]}function W5(e,t,n){const a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let i=qpe(e,Math.max(s,0));a.length===1&&(i=i.filter(c=>c!==n));const l=i.find(c=>c.textValue.toLowerCase().startsWith(a.toLowerCase()));return l!==n?l:void 0}function qpe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Kpe=g5,V5=x5,Qpe=b5,Xpe=w5,Ype=N5,H5=k5,Jpe=I5,G5=j5,q5=$5,Zpe=R5,efe=M5,K5=O5,Q5=F5,X5=L5;const vt=Kpe,bt=Qpe,pt=N.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(V5,{ref:r,className:Fe("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,d.jsx(Xpe,{asChild:!0,children:d.jsx(sU,{className:"h-4 w-4 opacity-50"})})]}));pt.displayName=V5.displayName;const Y5=N.forwardRef(({className:e,...t},n)=>d.jsx(K5,{ref:n,className:Fe("flex cursor-default items-center justify-center py-1",e),...t,children:d.jsx(ase,{className:"h-4 w-4"})}));Y5.displayName=K5.displayName;const J5=N.forwardRef(({className:e,...t},n)=>d.jsx(Q5,{ref:n,className:Fe("flex cursor-default items-center justify-center py-1",e),...t,children:d.jsx(sU,{className:"h-4 w-4"})}));J5.displayName=Q5.displayName;const ft=N.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>d.jsx(Ype,{children:d.jsxs(H5,{ref:a,className:Fe("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[d.jsx(Y5,{}),d.jsx(Jpe,{className:Fe("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),d.jsx(J5,{})]})}));ft.displayName=H5.displayName;const tfe=N.forwardRef(({className:e,...t},n)=>d.jsx(G5,{ref:n,className:Fe("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));tfe.displayName=G5.displayName;const Ee=N.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(q5,{ref:r,className:Fe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(efe,{children:d.jsx(qT,{className:"h-4 w-4"})})}),d.jsx(Zpe,{children:t})]}));Ee.displayName=q5.displayName;const nfe=N.forwardRef(({className:e,...t},n)=>d.jsx(X5,{ref:n,className:Fe("-mx-1 my-1 h-px bg-muted",e),...t}));nfe.displayName=X5.displayName;var rfe="Label",Z5=N.forwardRef((e,t)=>d.jsx(Qe.label,{...e,ref:t,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Z5.displayName=rfe;var e6=Z5;const afe=Cv("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Pe=N.forwardRef(({className:e,...t},n)=>d.jsx(e6,{ref:n,className:Fe(afe(),e),...t}));Pe.displayName=e6.displayName;const gP=[{value:1,label:"Female"},{value:2,label:"Male"}],sfe=[{value:!0,label:"Yes"},{value:!1,label:"No"}],ife=[{value:"CultureFitInterview",label:"CultureFitInterview"},{value:"EnglishInterview",label:"EnglishInterview"},{value:"AlgebraInterview",label:"AlgebraInterview"}];function t6(){const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(!1),[i,o]=N.useState({owner:"",gender:"",available:"",stage:"",limit:""}),[l,c]=N.useState([]),[u,h]=N.useState("add"),[p,f]=N.useState(null),[g,m]=N.useState(1),y=10,x=Math.ceil(e.length/y),v=e.slice((g-1)*y,g*y),b=()=>{g>1&&m(g-1)},w=()=>{g<x&&m(g+1)},k=()=>{h("add"),f(null),o({owner:"",gender:"",available:"",stage:"",limit:""}),s(!0)},I=S=>{h("edit"),f(S),o({owner:String(S.user.id),gender:String(S.gender),available:String(S.available),stage:S.type[0]||"",limit:String(S.max_limit)}),s(!0)};N.useEffect(()=>{fetch("https://dev-join.navgurukul.org/api/owner").then(S=>S.json()).then(S=>{t(S.data||[]),r(!1),c((S.data||[]).map(E=>({id:E.user.id,name:E.user.user_name+" ("+E.user.mail_id+")"})))})},[]);const C=(S,E)=>{o(T=>({...T,[S]:E}))};return d.jsxs("div",{className:"min-h-screen bg-background flex",children:[d.jsx(ar,{}),d.jsxs("main",{className:"md:ml-64 flex-1 p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border",children:[d.jsx("div",{className:"p-6 border-b border-border",children:d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Owners"}),d.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Manage and track owner details"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white h-9",children:"Interview Schedule"}),d.jsx(fe,{className:"bg-orange-500 hover:bg-orange-600 text-white rounded-md px-6 py-2 font-semibold shadow h-9",onClick:k,children:"Add Owner"})]})]})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b border-border/50",children:[d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Edit"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Name"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Gender"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Available"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Pending Interviews"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Interview Types"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Assigned Interviews Limit"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Loading owners..."})]})})}):v.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"py-12 text-center text-muted-foreground",children:d.jsx("span",{children:"No owners found"})})}):v.map(S=>{var E;return d.jsxs("tr",{className:"border-b border-border/30 hover:bg-muted/30 transition-colors group",children:[d.jsx("td",{className:"py-4 px-6",children:d.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>I(S),children:d.jsxs("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[d.jsx("path",{d:"M12 20h9"}),d.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19.5 3 21l1.5-4L16.5 3.5z"})]})})}),d.jsx("td",{className:"py-4 px-6 font-medium",children:S.user.user_name}),d.jsx("td",{className:"py-4 px-6",children:((E=gP.find(T=>T.value===S.gender))==null?void 0:E.label)||"Other"}),d.jsx("td",{className:"py-4 px-6",children:S.available?"Yes":"No"}),d.jsx("td",{className:"py-4 px-6",children:S.pending_interview_count}),d.jsx("td",{className:"py-4 px-6",children:S.type.map(T=>d.jsx("span",{className:"inline-block bg-orange-100 text-orange-700 rounded px-2 py-1 text-xs font-semibold mr-1 mb-1",children:T},T))}),d.jsx("td",{className:"py-4 px-6",children:S.max_limit})]},S.id)})})]})}),d.jsxs("div",{className:"flex justify-between items-center px-6 py-4",children:[d.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",g," of ",x]}),d.jsxs("div",{className:"space-x-2",children:[d.jsx(fe,{variant:"outline",onClick:b,disabled:g===1,children:"Previous"}),d.jsx(fe,{variant:"outline",onClick:w,disabled:g===x,children:"Next"})]})]})]}),a&&d.jsx(ta,{open:a,onOpenChange:s,children:d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-8 w-full max-w-md shadow-lg",children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:u==="edit"?"Edit Owner":"Add New Owner"}),d.jsxs("form",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"owner",children:"Select Owner"}),d.jsxs(vt,{value:i.owner,onValueChange:S=>C("owner",S),children:[d.jsx(pt,{id:"owner",className:"mt-1",children:d.jsx(bt,{placeholder:"Please Select Owner"})}),d.jsx(ft,{children:l.map(S=>d.jsx(Ee,{value:String(S.id),children:S.name},S.id))})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"gender",children:"Select Gender"}),d.jsxs(vt,{value:i.gender,onValueChange:S=>C("gender",S),children:[d.jsx(pt,{id:"gender",className:"mt-1",children:d.jsx(bt,{placeholder:"Please select your gender"})}),d.jsx(ft,{children:gP.map(S=>d.jsx(Ee,{value:String(S.value),children:S.label},S.value))})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"available",children:"Select Availability"}),d.jsxs(vt,{value:i.available,onValueChange:S=>C("available",S),children:[d.jsx(pt,{id:"available",className:"mt-1",children:d.jsx(bt,{placeholder:"Select Yes/No"})}),d.jsx(ft,{children:sfe.map(S=>d.jsx(Ee,{value:String(S.value),children:S.label},String(S.value)))})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"stage",children:"Select Stage"}),d.jsxs(vt,{value:i.stage,onValueChange:S=>C("stage",S),children:[d.jsx(pt,{id:"stage",className:"mt-1",children:d.jsx(bt,{placeholder:"Select Stage"})}),d.jsx(ft,{children:ife.map(S=>d.jsx(Ee,{value:S.value,children:S.label},S.value))})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"limit",children:"Interview Limit"}),d.jsx(Je,{id:"limit",type:"number",min:"0",value:i.limit,onChange:S=>C("limit",S.target.value),placeholder:"Ek student kitne interviews le sakta hai."})]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[d.jsx(fe,{variant:"outline",type:"button",onClick:()=>s(!1),children:"Cancel"}),d.jsx(fe,{className:"bg-orange-500 text-white",type:"submit",children:u==="edit"?"Update Owner":"Add Owner"})]})]})]})})})]})]})}function ofe(){const[e,t]=N.useState({totalApplicants:0,activeApplications:0,interviewsScheduled:0,successfullyOnboarded:0}),[n,r]=N.useState(!0),{user:a}=Gs(),s=async()=>{try{if(r(!0),!a){console.warn("No active session, skipping metrics fetch");return}const o=[],l=o.length,c=o.filter(p=>p.lr_status&&p.lr_status.trim()!==""||p.cfr_status&&p.cfr_status.trim()!=="").length,u=o.filter(p=>p.offer_letter_status&&p.offer_letter_status.trim()!=="").length,h=o.filter(p=>p.joining_status&&(p.joining_status.toLowerCase().includes("joined")||p.joining_status.toLowerCase().includes("onboarded"))).length;t({totalApplicants:l,activeApplications:c,interviewsScheduled:u,successfullyOnboarded:h})}catch(o){console.error("Error calculating metrics:",o)}finally{r(!1)}};N.useEffect(()=>{s()},[a]);const i=[{title:"Total Applicants",value:n?"...":e.totalApplicants.toLocaleString(),change:"+12%",changeType:"increase",icon:kd,color:"text-primary",bgColor:"bg-primary/10"},{title:"Active Applications",value:n?"...":e.activeApplications.toLocaleString(),change:"+8%",changeType:"increase",icon:To,color:"text-status-pending",bgColor:"bg-status-pending/10"},{title:"Interviews Scheduled",value:n?"...":e.interviewsScheduled.toLocaleString(),change:"+24%",changeType:"increase",icon:XT,color:"text-status-prospect",bgColor:"bg-status-prospect/10"},{title:"Successfully Onboarded",value:n?"...":e.successfullyOnboarded.toLocaleString(),change:"+16%",changeType:"increase",icon:dd,color:"text-status-active",bgColor:"bg-status-active/10"}];return d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:i.map(o=>d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:o.title}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:o.value}),d.jsxs("div",{className:"flex items-center mt-2",children:[d.jsx("span",{className:`text-xs font-medium ${o.changeType==="increase"?"text-status-active":"text-status-fail"}`,children:o.change}),d.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"from last month"})]})]}),d.jsx("div",{className:`w-12 h-12 ${o.bgColor} rounded-lg flex items-center justify-center`,children:d.jsx(o.icon,{className:`w-6 h-6 ${o.color}`})})]})},o.title))})}const Ct=N.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:Fe("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Ct.displayName="Card";const Vt=N.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:Fe("flex flex-col space-y-1.5 p-6",e),...t}));Vt.displayName="CardHeader";const Yt=N.forwardRef(({className:e,...t},n)=>d.jsx("h3",{ref:n,className:Fe("text-2xl font-semibold leading-none tracking-tight",e),...t}));Yt.displayName="CardTitle";const vs=N.forwardRef(({className:e,...t},n)=>d.jsx("p",{ref:n,className:Fe("text-sm text-muted-foreground",e),...t}));vs.displayName="CardDescription";const It=N.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:Fe("p-6 pt-0",e),...t}));It.displayName="CardContent";const lfe=N.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:Fe("flex items-center p-6 pt-0",e),...t}));lfe.displayName="CardFooter";const zu=N.forwardRef(({className:e,...t},n)=>d.jsx("div",{className:"relative w-full overflow-auto",children:d.jsx("table",{ref:n,className:Fe("w-full caption-bottom text-sm min-w-max",e),...t})}));zu.displayName="Table";const Bu=N.forwardRef(({className:e,...t},n)=>d.jsx("thead",{ref:n,className:Fe("[&_tr]:border-b",e),...t}));Bu.displayName="TableHeader";const Uu=N.forwardRef(({className:e,...t},n)=>d.jsx("tbody",{ref:n,className:Fe("[&_tr:last-child]:border-0",e),...t}));Uu.displayName="TableBody";const ufe=N.forwardRef(({className:e,...t},n)=>d.jsx("tfoot",{ref:n,className:Fe("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));ufe.displayName="TableFooter";const Gr=N.forwardRef(({className:e,...t},n)=>d.jsx("tr",{ref:n,className:Fe("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Gr.displayName="TableRow";const Ft=N.forwardRef(({className:e,...t},n)=>d.jsx("th",{ref:n,className:Fe("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Ft.displayName="TableHead";const Nt=N.forwardRef(({className:e,...t},n)=>d.jsx("td",{ref:n,className:Fe("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Nt.displayName="TableCell";const cfe=N.forwardRef(({className:e,...t},n)=>d.jsx("caption",{ref:n,className:Fe("mt-4 text-sm text-muted-foreground",e),...t}));cfe.displayName="TableCaption";var sk="Checkbox",[dfe,$at]=ia(sk),[hfe,Ej]=dfe(sk);function pfe(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:a,disabled:s,form:i,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:h}=e,[p,f]=Io({prop:n,defaultProp:a??!1,onChange:l,caller:sk}),[g,m]=N.useState(null),[y,x]=N.useState(null),v=N.useRef(!1),b=g?!!i||!!g.closest("form"):!0,w={checked:p,disabled:s,setChecked:f,control:g,setControl:m,name:o,form:i,value:u,hasConsumerStoppedPropagationRef:v,required:c,defaultChecked:ju(a)?!1:a,isFormControl:b,bubbleInput:y,setBubbleInput:x};return d.jsx(hfe,{scope:t,...w,children:ffe(h)?h(w):r})}var n6="CheckboxTrigger",r6=N.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},a)=>{const{control:s,value:i,disabled:o,checked:l,required:c,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:p,isFormControl:f,bubbleInput:g}=Ej(n6,e),m=kt(a,u),y=N.useRef(l);return N.useEffect(()=>{const x=s==null?void 0:s.form;if(x){const v=()=>h(y.current);return x.addEventListener("reset",v),()=>x.removeEventListener("reset",v)}},[s,h]),d.jsx(Qe.button,{type:"button",role:"checkbox","aria-checked":ju(l)?"mixed":l,"aria-required":c,"data-state":l6(l),"data-disabled":o?"":void 0,disabled:o,value:i,...r,ref:m,onKeyDown:Te(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Te(n,x=>{h(v=>ju(v)?!0:!v),g&&f&&(p.current=x.isPropagationStopped(),p.current||x.stopPropagation())})})});r6.displayName=n6;var Tj=N.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:s,required:i,disabled:o,value:l,onCheckedChange:c,form:u,...h}=e;return d.jsx(pfe,{__scopeCheckbox:n,checked:a,defaultChecked:s,disabled:o,required:i,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:p})=>d.jsxs(d.Fragment,{children:[d.jsx(r6,{...h,ref:t,__scopeCheckbox:n}),p&&d.jsx(o6,{__scopeCheckbox:n})]})})});Tj.displayName=sk;var a6="CheckboxIndicator",s6=N.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...a}=e,s=Ej(a6,n);return d.jsx(Lr,{present:r||ju(s.checked)||s.checked===!0,children:d.jsx(Qe.span,{"data-state":l6(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});s6.displayName=a6;var i6="CheckboxBubbleInput",o6=N.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:a,checked:s,defaultChecked:i,required:o,disabled:l,name:c,value:u,form:h,bubbleInput:p,setBubbleInput:f}=Ej(i6,e),g=kt(n,f),m=Cj(s),y=sj(r);N.useEffect(()=>{const v=p;if(!v)return;const b=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(b,"checked").set,I=!a.current;if(m!==s&&k){const C=new Event("click",{bubbles:I});v.indeterminate=ju(s),k.call(v,ju(s)?!1:s),v.dispatchEvent(C)}},[p,m,s,a]);const x=N.useRef(ju(s)?!1:s);return d.jsx(Qe.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??x.current,required:o,disabled:l,name:c,value:u,form:h,...t,tabIndex:-1,ref:g,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});o6.displayName=i6;function ffe(e){return typeof e=="function"}function ju(e){return e==="indeterminate"}function l6(e){return ju(e)?"indeterminate":e?"checked":"unchecked"}const ik=N.forwardRef(({className:e,...t},n)=>d.jsx(Tj,{ref:n,className:Fe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:d.jsx(s6,{className:Fe("flex items-center justify-center text-current"),children:d.jsx(qT,{className:"h-4 w-4"})})}));ik.displayName=Tj.displayName;var J_="rovingFocusGroup.onEntryFocus",mfe={bubbles:!1,cancelable:!0},Ov="RovingFocusGroup",[vI,u6,gfe]=TN(Ov),[yfe,Wm]=ia(Ov,[gfe]),[xfe,vfe]=yfe(Ov),c6=N.forwardRef((e,t)=>d.jsx(vI.Provider,{scope:e.__scopeRovingFocusGroup,children:d.jsx(vI.Slot,{scope:e.__scopeRovingFocusGroup,children:d.jsx(bfe,{...e,ref:t})})}));c6.displayName=Ov;var bfe=N.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=e,p=N.useRef(null),f=kt(t,p),g=Bm(s),[m,y]=Io({prop:i,defaultProp:o??null,onChange:l,caller:Ov}),[x,v]=N.useState(!1),b=rr(c),w=u6(n),k=N.useRef(!1),[I,C]=N.useState(0);return N.useEffect(()=>{const S=p.current;if(S)return S.addEventListener(J_,b),()=>S.removeEventListener(J_,b)},[b]),d.jsx(xfe,{scope:n,orientation:r,dir:g,loop:a,currentTabStopId:m,onItemFocus:N.useCallback(S=>y(S),[y]),onItemShiftTab:N.useCallback(()=>v(!0),[]),onFocusableItemAdd:N.useCallback(()=>C(S=>S+1),[]),onFocusableItemRemove:N.useCallback(()=>C(S=>S-1),[]),children:d.jsx(Qe.div,{tabIndex:x||I===0?-1:0,"data-orientation":r,...h,ref:f,style:{outline:"none",...e.style},onMouseDown:Te(e.onMouseDown,()=>{k.current=!0}),onFocus:Te(e.onFocus,S=>{const E=!k.current;if(S.target===S.currentTarget&&E&&!x){const T=new CustomEvent(J_,mfe);if(S.currentTarget.dispatchEvent(T),!T.defaultPrevented){const $=w().filter(O=>O.focusable),_=$.find(O=>O.active),M=$.find(O=>O.id===m),U=[_,M,...$].filter(Boolean).map(O=>O.ref.current);p6(U,u)}}k.current=!1}),onBlur:Te(e.onBlur,()=>v(!1))})})}),d6="RovingFocusGroupItem",h6=N.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:s,children:i,...o}=e,l=$i(),c=s||l,u=vfe(d6,n),h=u.currentTabStopId===c,p=u6(n),{onFocusableItemAdd:f,onFocusableItemRemove:g,currentTabStopId:m}=u;return N.useEffect(()=>{if(r)return f(),()=>g()},[r,f,g]),d.jsx(vI.ItemSlot,{scope:n,id:c,focusable:r,active:a,children:d.jsx(Qe.span,{tabIndex:h?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Te(e.onMouseDown,y=>{r?u.onItemFocus(c):y.preventDefault()}),onFocus:Te(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Te(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=kfe(y,u.orientation,u.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let b=p().filter(w=>w.focusable).map(w=>w.ref.current);if(x==="last")b.reverse();else if(x==="prev"||x==="next"){x==="prev"&&b.reverse();const w=b.indexOf(y.currentTarget);b=u.loop?Sfe(b,w+1):b.slice(w+1)}setTimeout(()=>p6(b))}}),children:typeof i=="function"?i({isCurrentTabStop:h,hasTabStop:m!=null}):i})})});h6.displayName=d6;var wfe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Nfe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function kfe(e,t,n){const r=Nfe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return wfe[r]}function p6(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function Sfe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var jj=c6,Aj=h6,ok="Tabs",[_fe,Rat]=ia(ok,[Wm]),f6=Wm(),[Cfe,$j]=_fe(ok),m6=N.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:s,orientation:i="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=Bm(o),[h,p]=Io({prop:r,onChange:a,defaultProp:s??"",caller:ok});return d.jsx(Cfe,{scope:n,baseId:$i(),value:h,onValueChange:p,orientation:i,dir:u,activationMode:l,children:d.jsx(Qe.div,{dir:u,"data-orientation":i,...c,ref:t})})});m6.displayName=ok;var g6="TabsList",y6=N.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,s=$j(g6,n),i=f6(n);return d.jsx(jj,{asChild:!0,...i,orientation:s.orientation,dir:s.dir,loop:r,children:d.jsx(Qe.div,{role:"tablist","aria-orientation":s.orientation,...a,ref:t})})});y6.displayName=g6;var x6="TabsTrigger",v6=N.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...s}=e,i=$j(x6,n),o=f6(n),l=N6(i.baseId,r),c=k6(i.baseId,r),u=r===i.value;return d.jsx(Aj,{asChild:!0,...o,focusable:!a,active:u,children:d.jsx(Qe.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...s,ref:t,onMouseDown:Te(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?i.onValueChange(r):h.preventDefault()}),onKeyDown:Te(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&i.onValueChange(r)}),onFocus:Te(e.onFocus,()=>{const h=i.activationMode!=="manual";!u&&!a&&h&&i.onValueChange(r)})})})});v6.displayName=x6;var b6="TabsContent",w6=N.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:s,...i}=e,o=$j(b6,n),l=N6(o.baseId,r),c=k6(o.baseId,r),u=r===o.value,h=N.useRef(u);return N.useEffect(()=>{const p=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(p)},[]),d.jsx(Lr,{present:a||u,children:({present:p})=>d.jsx(Qe.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!p,id:c,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:p&&s})})});w6.displayName=b6;function N6(e,t){return`${e}-trigger-${t}`}function k6(e,t){return`${e}-content-${t}`}var Ife=m6,S6=y6,_6=v6,C6=w6;const Rj=Ife,lk=N.forwardRef(({className:e,...t},n)=>d.jsx(S6,{ref:n,className:Fe("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));lk.displayName=S6.displayName;const mo=N.forwardRef(({className:e,...t},n)=>d.jsx(_6,{ref:n,className:Fe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));mo.displayName=_6.displayName;const go=N.forwardRef(({className:e,...t},n)=>d.jsx(C6,{ref:n,className:Fe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));go.displayName=C6.displayName;const As=N.forwardRef(({className:e,...t},n)=>d.jsx("textarea",{className:Fe("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));As.displayName="Textarea";const yP=(...e)=>e.filter(Boolean).join(" ");function Efe({isOpen:e,onClose:t,onSuccess:n,campusList:r,schoolList:a,currentstatusList:s,religionList:i,questionSetList:o}){const[l,c]=N.useState(!1),[u,h]=N.useState("basic"),{toast:p}=Qt(),[f,g]=N.useState({}),[m,y]=N.useState([]),[x,v]=N.useState([]),[b,w]=N.useState([]),[k,I]=N.useState([]),[C,S]=N.useState([]),[E,T]=N.useState(""),[$,_]=N.useState(""),[M,L]=N.useState(!1),[U,O]=N.useState(!1),[F,D]=N.useState(""),[R,V]=N.useState({first_name:"",middle_name:"",last_name:"",phone_number:"",whatsapp_number:"",email:"",dob:"",city:"",block:"",state:"",district:"",pin_code:"",cast_id:"",gender:"",qualification_id:"",current_status_id:"",religion_id:"",qualifying_school_id:"",campus_id:"",school_medium:"",status:"",is_passed:!1,question_set_id:"",total_marks:0,obtained_marks:"",exam_centre:"",date_of_test:"",communication_notes:""}),G=()=>{V({first_name:"",middle_name:"",last_name:"",phone_number:"",whatsapp_number:"",email:"",dob:"",city:"",block:"",state:"",district:"",pin_code:"",cast_id:"",gender:"",campus_id:"",qualification_id:"",current_status_id:"",qualifying_school_id:"",religion_id:"",status:"",is_passed:!1,question_set_id:"",total_marks:0,obtained_marks:"",exam_centre:"",date_of_test:"",communication_notes:"",school_medium:""}),T(""),_(""),D(""),I([]),S([]),h("basic"),g({})};N.useEffect(()=>{(async()=>{try{const de=await GN();y(de||[])}catch{}})()},[]),N.useEffect(()=>{(async()=>{try{const de=await yj();v(de||[])}catch{}})()},[]),N.useEffect(()=>{if(R.question_set_id&&o.length>0){const q=o.find(de=>de.id===Number(R.question_set_id));q&&V(de=>({...de,total_marks:q.maximumMarks}))}},[R.question_set_id,o]);const W=(q,de)=>{V(ye=>({...ye,[q]:de})),f[q]&&g(ye=>{const be={...ye};return delete be[q],be})};N.useEffect(()=>{e&&(async()=>{try{const de=await XN(),be=((de==null?void 0:de.data)||de||[]).map(Ce=>({value:Ce.state_code,label:Ce.state_name}));w(be)}catch{w([{value:"S-UP",label:"Uttar Pradesh"},{value:"S-DL",label:"Delhi"}])}})()},[e]),N.useEffect(()=>{if(!E){I([]),S([]),V(de=>({...de,district:"",block:""}));return}(async()=>{L(!0);try{const de=await YN(E),be=((de==null?void 0:de.data)||de||[]).map(Ce=>({value:Ce.district_code,label:Ce.district_name}));I(be),V(Ce=>{var se;return{...Ce,district:"",block:"",state:((se=b.find(ae=>ae.value===E))==null?void 0:se.label)||E}})}catch{I([])}finally{L(!1)}})()},[E,b]),N.useEffect(()=>{if(!$){S([]),D(""),V(de=>({...de,block:""}));return}(async()=>{O(!0);try{const de=await bj($),be=((de==null?void 0:de.data)||de||[]).map(Ce=>({value:Ce.block_code,label:Ce.block_name}));S(be),D(""),V(Ce=>{var se;return{...Ce,district:((se=k.find(ae=>ae.value===$))==null?void 0:se.label)||$,block:""}})}catch(de){console.error("Failed to fetch blocks:",de),S([])}finally{O(!1)}})()},[$,k]);const B=()=>{const q={};return R.first_name.trim()||(q.first_name="First name is required"),R.phone_number.trim()?/^\d{10}$/.test(R.phone_number)||(q.phone_number="Mobile number must be 10 digits"):q.phone_number="Mobile number is required",R.gender||(q.gender="Gender is required"),R.dob?new Date(R.dob)>=new Date&&(q.dob="Date of birth cannot be today or in the future"):q.dob="Date of birth is required",g(q),Object.keys(q).length===0},Q=async()=>{var q,de,ye,be,Ce,se,ae,ue,ke,_e,qe,Ue,it,yt,At,Bt,an,nt,ht,un;if(!B()){p({title:"Validation Error",description:"Please fill the required fields first",variant:"destructive"});return}c(!0);try{const er={image_url:null,first_name:R.first_name,middle_name:R.middle_name,last_name:R.last_name,gender:R.gender||null,dob:R.dob||null,email:R.email||`${R.phone_number}@example.com`,phone_number:R.phone_number,whatsapp_number:R.whatsapp_number||null,state:R.state||null,city:R.city||null,district:R.district||null,pin_code:R.pin_code||null,cast_id:R.cast_id?Number(R.cast_id):null,qualification_id:R.qualification_id?Number(R.qualification_id):null,current_status_id:R.current_status_id?Number(R.current_status_id):null,religion_id:R.religion_id?Number(R.religion_id):null,school_medium:R.school_medium||null,communication_notes:R.communication_notes||"",campus_id:R.campus_id?Number(R.campus_id):null},xe=await OW(er),$n=((q=xe==null?void 0:xe.data)==null?void 0:q.id)||(xe==null?void 0:xe.id);if($n&&(R.status||R.question_set_id)){const sn={student_id:$n,status:R.status||null,question_set_id:R.question_set_id?Number(R.question_set_id):null,obtained_marks:R.obtained_marks?Number(R.obtained_marks):null,school_id:R.qualifying_school_id?Number(R.qualifying_school_id):null,exam_centre:R.exam_centre||null,date_of_test:R.date_of_test||null},tn=await MW(sn)}const Pn={id:$n,name:(((de=xe==null?void 0:xe.data)==null?void 0:de.first_name)||(xe==null?void 0:xe.first_name)||"")+((ye=xe==null?void 0:xe.data)!=null&&ye.middle_name||xe!=null&&xe.middle_name?` ${((be=xe==null?void 0:xe.data)==null?void 0:be.middle_name)||(xe==null?void 0:xe.middle_name)}`:"")+((Ce=xe==null?void 0:xe.data)!=null&&Ce.last_name||xe!=null&&xe.last_name?` ${((se=xe==null?void 0:xe.data)==null?void 0:se.last_name)||(xe==null?void 0:xe.last_name)}`:""),mobile_no:((ae=xe==null?void 0:xe.data)==null?void 0:ae.phone_number)||(xe==null?void 0:xe.phone_number),whatsapp_number:((ue=xe==null?void 0:xe.data)==null?void 0:ue.whatsapp_number)||(xe==null?void 0:xe.whatsapp_number),email:((ke=xe==null?void 0:xe.data)==null?void 0:ke.email)||(xe==null?void 0:xe.email),city:((_e=xe==null?void 0:xe.data)==null?void 0:_e.city)||(xe==null?void 0:xe.city),campus_id:((qe=xe==null?void 0:xe.data)==null?void 0:qe.campus_id)||(xe==null?void 0:xe.campus_id),campus:((Ue=r==null?void 0:r.find(sn=>{var tn;return Number(sn.id)===Number(((tn=xe==null?void 0:xe.data)==null?void 0:tn.campus_id)||(xe==null?void 0:xe.campus_id))}))==null?void 0:Ue.campus_name)||"",school_id:((it=xe==null?void 0:xe.data)==null?void 0:it.school_id)||(xe==null?void 0:xe.school_id),school:((yt=a==null?void 0:a.find(sn=>{var tn;return sn.id===(((tn=xe==null?void 0:xe.data)==null?void 0:tn.school_id)||(xe==null?void 0:xe.school_id))}))==null?void 0:yt.school_name)||"",gender:((At=xe==null?void 0:xe.data)==null?void 0:At.gender)||(xe==null?void 0:xe.gender),qualification_id:((Bt=xe==null?void 0:xe.data)==null?void 0:Bt.qualification_id)||(xe==null?void 0:xe.qualification_id),qualification:((an=x==null?void 0:x.find(sn=>{var tn;return sn.id===(((tn=xe==null?void 0:xe.data)==null?void 0:tn.qualification_id)||(xe==null?void 0:xe.qualification_id))}))==null?void 0:an.qualification_name)||"",current_status_id:((nt=xe==null?void 0:xe.data)==null?void 0:nt.current_status_id)||(xe==null?void 0:xe.current_status_id),current_work:((ht=s==null?void 0:s.find(sn=>{var tn;return sn.id===(((tn=xe==null?void 0:xe.data)==null?void 0:tn.current_status_id)||(xe==null?void 0:xe.current_status_id))}))==null?void 0:ht.current_status_name)||"",status:R.status,obtained_marks:R.obtained_marks,question_set_id:R.question_set_id,exam_centre:R.exam_centre,date_of_test:R.date_of_test,communication_notes:((un=xe==null?void 0:xe.data)==null?void 0:un.communication_notes)||(xe==null?void 0:xe.communication_notes)};p({title:"Success!",description:"Applicant created successfully"}),n(Pn),G(),t()}catch(er){console.error("Error creating student:",er),p({title:"Error",description:er.message||"Failed to create student",variant:"destructive"})}finally{c(!1)}},X=q=>({basic:Ai,screening:hd})[q]||KT,pe=q=>{switch(q){case"basic":return R.first_name&&R.phone_number&&R.gender&&R.dob;case"screening":return!!R.status;default:return!1}},ie=()=>{const q=new Date;return q.setFullYear(q.getFullYear()-16),q.setMonth(q.getMonth()-6),q.toISOString().split("T")[0]},oe=()=>{G(),t()};return d.jsx(ta,{open:e,onOpenChange:oe,children:d.jsxs(na,{className:"w-[95vw] max-w-5xl h-[95vh] max-h-[95vh] overflow-hidden flex flex-col p-0 sm:p-6",children:[d.jsxs(ka,{className:"pb-4 sm:pb-6 px-4 sm:px-0 pt-4 sm:pt-0 flex-shrink-0",children:[d.jsx(ra,{className:"text-xl sm:text-2xl font-bold text-center",children:"Add New Applicant"}),d.jsx("div",{className:"flex justify-center mt-3 sm:mt-4",children:d.jsx("div",{className:"flex item-center space-x-4 sm:space-x-6 justify-between",children:["basic","screening"].map((q,de,ye)=>{const be=X(q),Ce=pe(q),se=u===q;return d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:yP("flex items-center justify-center w-8 h-8 sm:w-8 sm:h-8 rounded-full border-2 transition-colors",se||Ce?"bg-orange-500 border-orange-500 text-white":"border-gray-300 text-gray-400"),children:Ce?d.jsx(oU,{className:"w-3 h-3 sm:w-4 sm:h-4"}):d.jsx(be,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),de<ye.length-1&&d.jsx("div",{className:yP("w-6 sm:w-12 h-0.5 mx-1 sm:mx-2",Ce?"bg-orange-400":"bg-orange-300")})]},q)})})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto px-4 sm:px-0",children:d.jsxs(Rj,{value:u,onValueChange:h,className:"w-full",children:[d.jsxs(lk,{className:"flex w-full justify-between mb-4 sm:mb-8 h-auto",children:[d.jsxs(mo,{value:"basic",className:"flex-1 flex flex-col sm:flex-row items-center space-y-1 sm:space-y-0 sm:space-x-2 p-2 sm:p-3",children:[d.jsx(Ai,{className:"w-4 h-4"}),d.jsx("span",{className:"text-xs sm:text-sm",children:"Basic"})]}),d.jsxs(mo,{value:"screening",className:"flex-1 flex flex-col sm:flex-row items-center space-y-1 sm:space-y-0 sm:space-x-2 p-2 sm:p-3",children:[d.jsx(hd,{className:"w-4 h-4"}),d.jsx("span",{className:"text-xs sm:text-sm",children:"Screening"})]})]}),d.jsxs(go,{value:"basic",className:"space-y-4 sm:space-y-6",children:[d.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-indigo-50 p-4 sm:p-6 rounded-lg",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[d.jsx(Ai,{className:"w-5 h-5 mr-2 text-blue-600"}),"Applicant Information"]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"first_name",className:"text-sm font-medium",children:"First Name *"}),d.jsx(Je,{id:"first_name",value:R.first_name,onChange:q=>W("first_name",q.target.value),placeholder:"Enter first name",className:f.first_name?"border-red-500":""}),f.first_name&&d.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[d.jsx(yf,{className:"w-3 h-3 mr-1"}),f.first_name]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"middle_name",className:"text-sm font-medium",children:"Middle Name"}),d.jsx(Je,{id:"middle_name",value:R.middle_name,onChange:q=>W("middle_name",q.target.value),placeholder:"Enter middle name"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"last_name",className:"text-sm font-medium",children:"Last Name"}),d.jsx(Je,{id:"last_name",value:R.last_name,onChange:q=>W("last_name",q.target.value),placeholder:"Enter last name"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"mobile",className:"text-sm font-medium",children:"Phone Number *"}),d.jsx(Je,{id:"mobile",value:R.phone_number,onChange:q=>W("phone_number",q.target.value),placeholder:"Enter 10-digit phone number",maxLength:10,className:f.phone_number?"border-red-500":""}),f.phone_number&&d.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[d.jsx(yf,{className:"w-3 h-3 mr-1"}),f.phone_number]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"whatsapp",className:"text-sm font-medium",children:"WhatsApp Number"}),d.jsx(Je,{id:"whatsapp",value:R.whatsapp_number,onChange:q=>W("whatsapp_number",q.target.value),placeholder:"Enter WhatsApp number",maxLength:10})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),d.jsx(Je,{id:"email",type:"email",value:R.email,onChange:q=>W("email",q.target.value),placeholder:"Enter email address"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"dob",className:"text-sm font-medium",children:"Date of Birth *"}),d.jsx(Je,{id:"dob",type:"date",value:R.dob,max:ie(),onChange:q=>W("dob",q.target.value),className:f.dob?"border-red-500":""}),f.dob&&d.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[d.jsx(yf,{className:"w-3 h-3 mr-1"}),f.dob]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"gender",className:"text-sm font-medium",children:"Gender *"}),d.jsxs(vt,{value:R.gender,onValueChange:q=>W("gender",q),children:[d.jsx(pt,{className:f.gender?"border-red-500":"",children:d.jsx(bt,{placeholder:"Select gender"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"male",children:"Male"}),d.jsx(Ee,{value:"female",children:"Female"}),d.jsx(Ee,{value:"other",children:"Other"})]})]}),f.gender&&d.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[d.jsx(yf,{className:"w-3 h-3 mr-1"}),f.gender]})]})]})]}),d.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-emerald-50 p-4 sm:p-6 rounded-lg",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Location Details"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"state",className:"text-sm font-medium",children:"State"}),d.jsxs(vt,{value:E,onValueChange:q=>{T(q),_(""),S([])},children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select state"})}),d.jsx(ft,{children:b.map(q=>d.jsx(Ee,{value:q.value,children:q.label},q.value))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"district",className:"text-sm font-medium",children:"District"}),d.jsxs(vt,{value:$,onValueChange:q=>{_(q),V(de=>({...de,block:""}))},disabled:!E||M,children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:M?"Loading districts...":E?"Select district":"Select state first"})}),d.jsx(ft,{children:k.map(q=>d.jsx(Ee,{value:q.value,children:q.label},q.value))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"city",className:"text-sm font-medium",children:"City"}),d.jsx(Je,{id:"city",value:R.city,onChange:q=>W("city",q.target.value),placeholder:"Enter city"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"block",className:"text-sm font-medium",children:"Block"}),d.jsxs(vt,{value:F,onValueChange:D,disabled:!$||U,children:[d.jsx(pt,{children:U?d.jsxs("div",{className:"flex items-center",children:[d.jsx(wo,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading blocks..."]}):d.jsx(bt,{placeholder:$?"Select block":"Select district first"})}),d.jsx(ft,{children:C.map(q=>d.jsx(Ee,{value:q.value,children:q.label},q.value))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"pin_code",className:"text-sm font-medium",children:"PIN Code"}),d.jsx(Je,{type:"text",id:"pin_code",value:R.pin_code,onChange:q=>W("pin_code",q.target.value),placeholder:"Enter PIN code",maxLength:6,pattern:"[0-9]{6}",inputMode:"numeric"})]})]})]}),d.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-pink-50 p-4 sm:p-6 rounded-lg",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Additional Information"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"caste_id",className:"text-sm font-medium",children:"Caste"}),d.jsxs(vt,{value:R.cast_id?String(R.cast_id):"",onValueChange:q=>W("cast_id",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select caste"})}),d.jsx(ft,{children:m==null?void 0:m.map(q=>d.jsx(Ee,{value:String(q.id),children:q.cast_name},q.id))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"qualification_id",className:"text-sm font-medium",children:"Qualification"}),d.jsxs(vt,{value:R.qualification_id?String(R.qualification_id):"",onValueChange:q=>W("qualification_id",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select qualification"})}),d.jsx(ft,{children:x==null?void 0:x.map(q=>d.jsx(Ee,{value:String(q.id),children:q.qualification_name},q.id))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"current_work",className:"text-sm font-medium",children:"Current Work"}),d.jsxs(vt,{value:R.current_status_id?String(R.current_status_id):"",onValueChange:q=>W("current_status_id",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select current work"})}),d.jsx(ft,{children:s==null?void 0:s.map(q=>d.jsx(Ee,{value:String(q.id),children:q.current_status_name},q.id))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"campus_id",className:"text-sm font-medium",children:"Campus"}),d.jsxs(vt,{value:R.campus_id?String(R.campus_id):"",onValueChange:q=>W("campus_id",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select Campus"})}),d.jsx(ft,{side:"bottom",align:"end",children:r==null?void 0:r.map(q=>d.jsx(Ee,{value:String(q.id),children:q.campus_name},q.id))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"religion_id",className:"text-sm font-medium",children:"Religion"}),d.jsxs(vt,{value:R.religion_id?String(R.religion_id):"",onValueChange:q=>W("religion_id",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select religion"})}),d.jsx(ft,{children:i==null?void 0:i.map(q=>d.jsx(Ee,{value:String(q.id),children:q.religion_name},q.id))})]})]})]}),d.jsxs("div",{className:"space-y-2 mt-4",children:[d.jsx(Pe,{htmlFor:"communication_notes",className:"text-sm font-medium",children:"Communication Notes"}),d.jsx(As,{id:"communication_notes",value:R.communication_notes,onChange:q=>W("communication_notes",q.target.value),placeholder:"Enter communication notes",rows:3,className:"resize-none"})]})]})]}),d.jsx(go,{value:"screening",className:"space-y-4 sm:space-y-6",children:d.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 p-4 sm:p-6 rounded-lg",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[d.jsx(hd,{className:"w-5 h-5 mr-2 text-orange-600"}),"Screening Details"]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4",children:d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"screening_status",className:"text-sm font-medium",children:"Screening Status"}),d.jsxs(vt,{value:R.status,onValueChange:q=>W("status",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select screening status"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"Screening Test Pass",children:"Screening Test Pass"}),d.jsx(Ee,{value:"Screening Test Fail",children:"Screening Test Fail"}),d.jsx(Ee,{value:"Created Student Without Exam",children:"Created Student Without Exam"})]})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"question_set_id",className:"text-sm font-medium",children:"Question Set"}),d.jsxs(vt,{value:R.question_set_id?String(R.question_set_id):"",onValueChange:q=>W("question_set_id",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select question set"})}),d.jsx(ft,{children:o==null?void 0:o.map(q=>d.jsx(Ee,{value:String(q.id),children:q.name},q.id))})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"exam_centre",className:"text-sm font-medium",children:"Exam Centre"}),d.jsx(Je,{id:"exam_centre",value:R.exam_centre,onChange:q=>W("exam_centre",q.target.value),placeholder:"Enter exam centre"})]}),d.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[d.jsx(Pe,{htmlFor:"date_of_test",className:"text-sm font-medium",children:"Date of Testing"}),d.jsx(Je,{id:"date_of_test",type:"date",value:R.date_of_test,onChange:q=>W("date_of_test",q.target.value)})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"total_marks",className:"text-sm font-medium",children:"Total Marks"}),d.jsx(Je,{id:"total_marks",type:"number",value:R.total_marks,onChange:q=>W("total_marks",q.target.value),placeholder:"Enter total marks",disabled:!0}),R.question_set_id&&d.jsx("p",{className:"text-xs text-gray-500",children:"Auto-filled from selected question set"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"obtained_marks",className:"text-sm font-medium",children:"Obtained Marks"}),d.jsx(Je,{id:"obtained_marks",type:"number",value:R.obtained_marks,onChange:q=>W("obtained_marks",q.target.value),placeholder:"Enter obtained marks",min:"0"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"qualifying_school_id",className:"text-sm font-medium",children:"Qualifying School"}),d.jsxs(vt,{value:R.qualifying_school_id?String(R.qualifying_school_id):"",onValueChange:q=>W("qualifying_school_id",q),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select qualifying school"})}),d.jsx(ft,{children:a==null?void 0:a.map(q=>d.jsx(Ee,{value:String(q.id),children:q.school_name},q.id))})]})]})]})]})})]})}),d.jsxs("div",{className:"flex-shrink-0 flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 p-4 sm:pt-4 border-t bg-white",children:[d.jsx(fe,{variant:"outline",onClick:oe,className:"w-full sm:w-auto",disabled:l,children:"Cancel"}),d.jsx(fe,{onClick:Q,disabled:l,className:"w-full sm:w-auto",children:l?d.jsxs(d.Fragment,{children:[d.jsx(wo,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save Applicant"})]})]})})}function nm(e){"@babel/helpers - typeof";return nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nm(e)}function Xr(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function lt(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Wt(e){lt(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||nm(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Ma(e,t){lt(2,arguments);var n=Wt(e),r=Xr(t);return isNaN(r)?new Date(NaN):(r&&n.setDate(n.getDate()+r),n)}function Li(e,t){lt(2,arguments);var n=Wt(e),r=Xr(t);if(isNaN(r))return new Date(NaN);if(!r)return n;var a=n.getDate(),s=new Date(n.getTime());s.setMonth(n.getMonth()+r+1,0);var i=s.getDate();return a>=i?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}function Tfe(e,t){lt(2,arguments);var n=Wt(e).getTime(),r=Xr(t);return new Date(n+r)}var jfe={};function dc(){return jfe}function Ao(e,t){var n,r,a,s,i,o,l,c;lt(1,arguments);var u=dc(),h=Xr((n=(r=(a=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=Wt(e),f=p.getDay(),g=(f<h?7:0)+f-h;return p.setDate(p.getDate()-g),p.setHours(0,0,0,0),p}function Ad(e){return lt(1,arguments),Ao(e,{weekStartsOn:1})}function Afe(e){lt(1,arguments);var t=Wt(e),n=t.getFullYear(),r=new Date(0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);var a=Ad(r),s=new Date(0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);var i=Ad(s);return t.getTime()>=a.getTime()?n+1:t.getTime()>=i.getTime()?n:n-1}function $fe(e){lt(1,arguments);var t=Afe(e),n=new Date(0);n.setFullYear(t,0,4),n.setHours(0,0,0,0);var r=Ad(n);return r}function qx(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function rm(e){lt(1,arguments);var t=Wt(e);return t.setHours(0,0,0,0),t}var Rfe=864e5;function ul(e,t){lt(2,arguments);var n=rm(e),r=rm(t),a=n.getTime()-qx(n),s=r.getTime()-qx(r);return Math.round((a-s)/Rfe)}function bI(e,t){lt(2,arguments);var n=Xr(t),r=n*7;return Ma(e,r)}function Dfe(e,t){lt(2,arguments);var n=Xr(t);return Li(e,n*12)}function Mfe(e){lt(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(nm(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var n;return t.forEach(function(r){var a=Wt(r);(n===void 0||n<a||isNaN(Number(a)))&&(n=a)}),n||new Date(NaN)}function Ofe(e){lt(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(nm(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var n;return t.forEach(function(r){var a=Wt(r);(n===void 0||n>a||isNaN(a.getDate()))&&(n=a)}),n||new Date(NaN)}function cs(e,t){lt(2,arguments);var n=rm(e),r=rm(t);return n.getTime()===r.getTime()}function Dj(e){return lt(1,arguments),e instanceof Date||nm(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Ffe(e){if(lt(1,arguments),!Dj(e)&&typeof e!="number")return!1;var t=Wt(e);return!isNaN(Number(t))}function Kx(e,t){lt(2,arguments);var n=Wt(e),r=Wt(t),a=n.getFullYear()-r.getFullYear(),s=n.getMonth()-r.getMonth();return a*12+s}var Pfe=6048e5;function Lfe(e,t,n){lt(2,arguments);var r=Ao(e,n),a=Ao(t,n),s=r.getTime()-qx(r),i=a.getTime()-qx(a);return Math.round((s-i)/Pfe)}function Mj(e){lt(1,arguments);var t=Wt(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function ys(e){lt(1,arguments);var t=Wt(e);return t.setDate(1),t.setHours(0,0,0,0),t}function zfe(e){lt(1,arguments);var t=Wt(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Oj(e,t){var n,r,a,s,i,o,l,c;lt(1,arguments);var u=dc(),h=Xr((n=(r=(a=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=Wt(e),f=p.getDay(),g=(f<h?-7:0)+6-(f-h);return p.setDate(p.getDate()+g),p.setHours(23,59,59,999),p}function I6(e){return lt(1,arguments),Oj(e,{weekStartsOn:1})}function Bfe(e,t){lt(2,arguments);var n=Xr(t);return Tfe(e,-n)}var Ufe=864e5;function Wfe(e){lt(1,arguments);var t=Wt(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=t.getTime(),a=n-r;return Math.floor(a/Ufe)+1}function v1(e){lt(1,arguments);var t=1,n=Wt(e),r=n.getUTCDay(),a=(r<t?7:0)+r-t;return n.setUTCDate(n.getUTCDate()-a),n.setUTCHours(0,0,0,0),n}function E6(e){lt(1,arguments);var t=Wt(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var a=v1(r),s=new Date(0);s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0);var i=v1(s);return t.getTime()>=a.getTime()?n+1:t.getTime()>=i.getTime()?n:n-1}function Vfe(e){lt(1,arguments);var t=E6(e),n=new Date(0);n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0);var r=v1(n);return r}var Hfe=6048e5;function Gfe(e){lt(1,arguments);var t=Wt(e),n=v1(t).getTime()-Vfe(t).getTime();return Math.round(n/Hfe)+1}function b1(e,t){var n,r,a,s,i,o,l,c;lt(1,arguments);var u=dc(),h=Xr((n=(r=(a=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=Wt(e),f=p.getUTCDay(),g=(f<h?7:0)+f-h;return p.setUTCDate(p.getUTCDate()-g),p.setUTCHours(0,0,0,0),p}function T6(e,t){var n,r,a,s,i,o,l,c;lt(1,arguments);var u=Wt(e),h=u.getUTCFullYear(),p=dc(),f=Xr((n=(r=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:p.firstWeekContainsDate)!==null&&r!==void 0?r:(l=p.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var g=new Date(0);g.setUTCFullYear(h+1,0,f),g.setUTCHours(0,0,0,0);var m=b1(g,t),y=new Date(0);y.setUTCFullYear(h,0,f),y.setUTCHours(0,0,0,0);var x=b1(y,t);return u.getTime()>=m.getTime()?h+1:u.getTime()>=x.getTime()?h:h-1}function qfe(e,t){var n,r,a,s,i,o,l,c;lt(1,arguments);var u=dc(),h=Xr((n=(r=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:u.firstWeekContainsDate)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1),p=T6(e,t),f=new Date(0);f.setUTCFullYear(p,0,h),f.setUTCHours(0,0,0,0);var g=b1(f,t);return g}var Kfe=6048e5;function Qfe(e,t){lt(1,arguments);var n=Wt(e),r=b1(n,t).getTime()-qfe(n,t).getTime();return Math.round(r/Kfe)+1}function yn(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var Pl={y:function(t,n){var r=t.getUTCFullYear(),a=r>0?r:1-r;return yn(n==="yy"?a%100:a,n.length)},M:function(t,n){var r=t.getUTCMonth();return n==="M"?String(r+1):yn(r+1,2)},d:function(t,n){return yn(t.getUTCDate(),n.length)},a:function(t,n){var r=t.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(t,n){return yn(t.getUTCHours()%12||12,n.length)},H:function(t,n){return yn(t.getUTCHours(),n.length)},m:function(t,n){return yn(t.getUTCMinutes(),n.length)},s:function(t,n){return yn(t.getUTCSeconds(),n.length)},S:function(t,n){var r=n.length,a=t.getUTCMilliseconds(),s=Math.floor(a*Math.pow(10,r-3));return yn(s,n.length)}},Wp={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Xfe={G:function(t,n,r){var a=t.getUTCFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(t,n,r){if(n==="yo"){var a=t.getUTCFullYear(),s=a>0?a:1-a;return r.ordinalNumber(s,{unit:"year"})}return Pl.y(t,n)},Y:function(t,n,r,a){var s=T6(t,a),i=s>0?s:1-s;if(n==="YY"){var o=i%100;return yn(o,2)}return n==="Yo"?r.ordinalNumber(i,{unit:"year"}):yn(i,n.length)},R:function(t,n){var r=E6(t);return yn(r,n.length)},u:function(t,n){var r=t.getUTCFullYear();return yn(r,n.length)},Q:function(t,n,r){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"Q":return String(a);case"QQ":return yn(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,n,r){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"q":return String(a);case"qq":return yn(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,n,r){var a=t.getUTCMonth();switch(n){case"M":case"MM":return Pl.M(t,n);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(t,n,r){var a=t.getUTCMonth();switch(n){case"L":return String(a+1);case"LL":return yn(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(t,n,r,a){var s=Qfe(t,a);return n==="wo"?r.ordinalNumber(s,{unit:"week"}):yn(s,n.length)},I:function(t,n,r){var a=Gfe(t);return n==="Io"?r.ordinalNumber(a,{unit:"week"}):yn(a,n.length)},d:function(t,n,r){return n==="do"?r.ordinalNumber(t.getUTCDate(),{unit:"date"}):Pl.d(t,n)},D:function(t,n,r){var a=Wfe(t);return n==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):yn(a,n.length)},E:function(t,n,r){var a=t.getUTCDay();switch(n){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(t,n,r,a){var s=t.getUTCDay(),i=(s-a.weekStartsOn+8)%7||7;switch(n){case"e":return String(i);case"ee":return yn(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,n,r,a){var s=t.getUTCDay(),i=(s-a.weekStartsOn+8)%7||7;switch(n){case"c":return String(i);case"cc":return yn(i,n.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,n,r){var a=t.getUTCDay(),s=a===0?7:a;switch(n){case"i":return String(s);case"ii":return yn(s,n.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(t,n,r){var a=t.getUTCHours(),s=a/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,n,r){var a=t.getUTCHours(),s;switch(a===12?s=Wp.noon:a===0?s=Wp.midnight:s=a/12>=1?"pm":"am",n){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,n,r){var a=t.getUTCHours(),s;switch(a>=17?s=Wp.evening:a>=12?s=Wp.afternoon:a>=4?s=Wp.morning:s=Wp.night,n){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,n,r){if(n==="ho"){var a=t.getUTCHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Pl.h(t,n)},H:function(t,n,r){return n==="Ho"?r.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Pl.H(t,n)},K:function(t,n,r){var a=t.getUTCHours()%12;return n==="Ko"?r.ordinalNumber(a,{unit:"hour"}):yn(a,n.length)},k:function(t,n,r){var a=t.getUTCHours();return a===0&&(a=24),n==="ko"?r.ordinalNumber(a,{unit:"hour"}):yn(a,n.length)},m:function(t,n,r){return n==="mo"?r.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Pl.m(t,n)},s:function(t,n,r){return n==="so"?r.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Pl.s(t,n)},S:function(t,n){return Pl.S(t,n)},X:function(t,n,r,a){var s=a._originalDate||t,i=s.getTimezoneOffset();if(i===0)return"Z";switch(n){case"X":return vP(i);case"XXXX":case"XX":return Fc(i);case"XXXXX":case"XXX":default:return Fc(i,":")}},x:function(t,n,r,a){var s=a._originalDate||t,i=s.getTimezoneOffset();switch(n){case"x":return vP(i);case"xxxx":case"xx":return Fc(i);case"xxxxx":case"xxx":default:return Fc(i,":")}},O:function(t,n,r,a){var s=a._originalDate||t,i=s.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+xP(i,":");case"OOOO":default:return"GMT"+Fc(i,":")}},z:function(t,n,r,a){var s=a._originalDate||t,i=s.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+xP(i,":");case"zzzz":default:return"GMT"+Fc(i,":")}},t:function(t,n,r,a){var s=a._originalDate||t,i=Math.floor(s.getTime()/1e3);return yn(i,n.length)},T:function(t,n,r,a){var s=a._originalDate||t,i=s.getTime();return yn(i,n.length)}};function xP(e,t){var n=e>0?"-":"+",r=Math.abs(e),a=Math.floor(r/60),s=r%60;if(s===0)return n+String(a);var i=t;return n+String(a)+i+yn(s,2)}function vP(e,t){if(e%60===0){var n=e>0?"-":"+";return n+yn(Math.abs(e)/60,2)}return Fc(e,t)}function Fc(e,t){var n=t||"",r=e>0?"-":"+",a=Math.abs(e),s=yn(Math.floor(a/60),2),i=yn(a%60,2);return r+s+n+i}var bP=function(t,n){switch(t){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},j6=function(t,n){switch(t){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},Yfe=function(t,n){var r=t.match(/(P+)(p+)?/)||[],a=r[1],s=r[2];if(!s)return bP(t,n);var i;switch(a){case"P":i=n.dateTime({width:"short"});break;case"PP":i=n.dateTime({width:"medium"});break;case"PPP":i=n.dateTime({width:"long"});break;case"PPPP":default:i=n.dateTime({width:"full"});break}return i.replace("{{date}}",bP(a,n)).replace("{{time}}",j6(s,n))},Jfe={p:j6,P:Yfe},Zfe=["D","DD"],eme=["YY","YYYY"];function tme(e){return Zfe.indexOf(e)!==-1}function nme(e){return eme.indexOf(e)!==-1}function wP(e,t,n){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var rme={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ame=function(t,n,r){var a,s=rme[t];return typeof s=="string"?a=s:n===1?a=s.one:a=s.other.replace("{{count}}",n.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function Z_(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth,r=e.formats[n]||e.formats[e.defaultWidth];return r}}var sme={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ime={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ome={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},lme={date:Z_({formats:sme,defaultWidth:"full"}),time:Z_({formats:ime,defaultWidth:"full"}),dateTime:Z_({formats:ome,defaultWidth:"full"})},ume={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},cme=function(t,n,r,a){return ume[t]};function jy(e){return function(t,n){var r=n!=null&&n.context?String(n.context):"standalone",a;if(r==="formatting"&&e.formattingValues){var s=e.defaultFormattingWidth||e.defaultWidth,i=n!=null&&n.width?String(n.width):s;a=e.formattingValues[i]||e.formattingValues[s]}else{var o=e.defaultWidth,l=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[l]||e.values[o]}var c=e.argumentCallback?e.argumentCallback(t):t;return a[c]}}var dme={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},hme={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},pme={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},fme={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},mme={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},gme={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},yme=function(t,n){var r=Number(t),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},xme={ordinalNumber:yme,era:jy({values:dme,defaultWidth:"wide"}),quarter:jy({values:hme,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:jy({values:pme,defaultWidth:"wide"}),day:jy({values:fme,defaultWidth:"wide"}),dayPeriod:jy({values:mme,defaultWidth:"wide",formattingValues:gme,defaultFormattingWidth:"wide"})};function Ay(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;var i=s[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?bme(o,function(h){return h.test(i)}):vme(o,function(h){return h.test(i)}),c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;var u=t.slice(i.length);return{value:c,rest:u}}}function vme(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}function bme(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}function wme(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var a=r[0],s=t.match(e.parsePattern);if(!s)return null;var i=e.valueCallback?e.valueCallback(s[0]):s[0];i=n.valueCallback?n.valueCallback(i):i;var o=t.slice(a.length);return{value:i,rest:o}}}var Nme=/^(\d+)(th|st|nd|rd)?/i,kme=/\d+/i,Sme={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_me={any:[/^b/i,/^(a|c)/i]},Cme={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ime={any:[/1/i,/2/i,/3/i,/4/i]},Eme={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Tme={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jme={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ame={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},$me={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Rme={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Dme={ordinalNumber:wme({matchPattern:Nme,parsePattern:kme,valueCallback:function(t){return parseInt(t,10)}}),era:Ay({matchPatterns:Sme,defaultMatchWidth:"wide",parsePatterns:_me,defaultParseWidth:"any"}),quarter:Ay({matchPatterns:Cme,defaultMatchWidth:"wide",parsePatterns:Ime,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Ay({matchPatterns:Eme,defaultMatchWidth:"wide",parsePatterns:Tme,defaultParseWidth:"any"}),day:Ay({matchPatterns:jme,defaultMatchWidth:"wide",parsePatterns:Ame,defaultParseWidth:"any"}),dayPeriod:Ay({matchPatterns:$me,defaultMatchWidth:"any",parsePatterns:Rme,defaultParseWidth:"any"})},A6={code:"en-US",formatDistance:ame,formatLong:lme,formatRelative:cme,localize:xme,match:Dme,options:{weekStartsOn:0,firstWeekContainsDate:1}},Mme=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ome=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Fme=/^'([^]*?)'?$/,Pme=/''/g,Lme=/[a-zA-Z]/;function li(e,t,n){var r,a,s,i,o,l,c,u,h,p,f,g,m,y,x,v,b,w;lt(2,arguments);var k=String(t),I=dc(),C=(r=(a=n==null?void 0:n.locale)!==null&&a!==void 0?a:I.locale)!==null&&r!==void 0?r:A6,S=Xr((s=(i=(o=(l=n==null?void 0:n.firstWeekContainsDate)!==null&&l!==void 0?l:n==null||(c=n.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&o!==void 0?o:I.firstWeekContainsDate)!==null&&i!==void 0?i:(h=I.locale)===null||h===void 0||(p=h.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(S>=1&&S<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var E=Xr((f=(g=(m=(y=n==null?void 0:n.weekStartsOn)!==null&&y!==void 0?y:n==null||(x=n.locale)===null||x===void 0||(v=x.options)===null||v===void 0?void 0:v.weekStartsOn)!==null&&m!==void 0?m:I.weekStartsOn)!==null&&g!==void 0?g:(b=I.locale)===null||b===void 0||(w=b.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&f!==void 0?f:0);if(!(E>=0&&E<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!C.localize)throw new RangeError("locale must contain localize property");if(!C.formatLong)throw new RangeError("locale must contain formatLong property");var T=Wt(e);if(!Ffe(T))throw new RangeError("Invalid time value");var $=qx(T),_=Bfe(T,$),M={firstWeekContainsDate:S,weekStartsOn:E,locale:C,_originalDate:T},L=k.match(Ome).map(function(U){var O=U[0];if(O==="p"||O==="P"){var F=Jfe[O];return F(U,C.formatLong)}return U}).join("").match(Mme).map(function(U){if(U==="''")return"'";var O=U[0];if(O==="'")return zme(U);var F=Xfe[O];if(F)return!(n!=null&&n.useAdditionalWeekYearTokens)&&nme(U)&&wP(U,t,String(e)),!(n!=null&&n.useAdditionalDayOfYearTokens)&&tme(U)&&wP(U,t,String(e)),F(_,U,C.localize,M);if(O.match(Lme))throw new RangeError("Format string contains an unescaped latin alphabet character `"+O+"`");return U}).join("");return L}function zme(e){var t=e.match(Fme);return t?t[1].replace(Pme,"'"):e}function Bme(e){lt(1,arguments);var t=Wt(e),n=t.getFullYear(),r=t.getMonth(),a=new Date(0);return a.setFullYear(n,r+1,0),a.setHours(0,0,0,0),a.getDate()}var Ume=6048e5;function Wme(e){lt(1,arguments);var t=Wt(e),n=Ad(t).getTime()-$fe(t).getTime();return Math.round(n/Ume)+1}function Vme(e){lt(1,arguments);var t=Wt(e),n=t.getTime();return n}function Hme(e){return lt(1,arguments),Math.floor(Vme(e)/1e3)}function Gme(e,t){var n,r,a,s,i,o,l,c;lt(1,arguments);var u=Wt(e),h=u.getFullYear(),p=dc(),f=Xr((n=(r=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:p.firstWeekContainsDate)!==null&&r!==void 0?r:(l=p.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var g=new Date(0);g.setFullYear(h+1,0,f),g.setHours(0,0,0,0);var m=Ao(g,t),y=new Date(0);y.setFullYear(h,0,f),y.setHours(0,0,0,0);var x=Ao(y,t);return u.getTime()>=m.getTime()?h+1:u.getTime()>=x.getTime()?h:h-1}function qme(e,t){var n,r,a,s,i,o,l,c;lt(1,arguments);var u=dc(),h=Xr((n=(r=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:u.firstWeekContainsDate)!==null&&r!==void 0?r:(l=u.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1),p=Gme(e,t),f=new Date(0);f.setFullYear(p,0,h),f.setHours(0,0,0,0);var g=Ao(f,t);return g}var Kme=6048e5;function Qme(e,t){lt(1,arguments);var n=Wt(e),r=Ao(n,t).getTime()-qme(n,t).getTime();return Math.round(r/Kme)+1}function Xme(e){lt(1,arguments);var t=Wt(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function Yme(e,t){return lt(1,arguments),Lfe(Xme(e),ys(e),t)+1}function wI(e,t){lt(2,arguments);var n=Wt(e),r=Wt(t);return n.getTime()>r.getTime()}function $6(e,t){lt(2,arguments);var n=Wt(e),r=Wt(t);return n.getTime()<r.getTime()}function Fj(e,t){lt(2,arguments);var n=Wt(e),r=Wt(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function Jme(e,t){lt(2,arguments);var n=Wt(e),r=Wt(t);return n.getFullYear()===r.getFullYear()}function eC(e,t){lt(2,arguments);var n=Xr(t);return Ma(e,-n)}function tC(e,t){lt(2,arguments);var n=Wt(e),r=Xr(t),a=n.getFullYear(),s=n.getDate(),i=new Date(0);i.setFullYear(a,r,15),i.setHours(0,0,0,0);var o=Bme(i);return n.setMonth(r,Math.min(s,o)),n}function NP(e,t){lt(2,arguments);var n=Wt(e),r=Xr(t);return isNaN(n.getTime())?new Date(NaN):(n.setFullYear(r),n)}var dt=function(){return dt=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},dt.apply(this,arguments)};function Zme(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function R6(e,t,n){for(var r=0,a=t.length,s;r<a;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}function Fv(e){return e.mode==="multiple"}function Pv(e){return e.mode==="range"}function uk(e){return e.mode==="single"}var ege={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function tge(e,t){return li(e,"LLLL y",t)}function nge(e,t){return li(e,"d",t)}function rge(e,t){return li(e,"LLLL",t)}function age(e){return"".concat(e)}function sge(e,t){return li(e,"cccccc",t)}function ige(e,t){return li(e,"yyyy",t)}var oge=Object.freeze({__proto__:null,formatCaption:tge,formatDay:nge,formatMonthCaption:rge,formatWeekNumber:age,formatWeekdayName:sge,formatYearCaption:ige}),lge=function(e,t,n){return li(e,"do MMMM (EEEE)",n)},uge=function(){return"Month: "},cge=function(){return"Go to next month"},dge=function(){return"Go to previous month"},hge=function(e,t){return li(e,"cccc",t)},pge=function(e){return"Week n. ".concat(e)},fge=function(){return"Year: "},mge=Object.freeze({__proto__:null,labelDay:lge,labelMonthDropdown:uge,labelNext:cge,labelPrevious:dge,labelWeekNumber:pge,labelWeekday:hge,labelYearDropdown:fge});function gge(){var e="buttons",t=ege,n=A6,r={},a={},s=1,i={},o=new Date;return{captionLayout:e,classNames:t,formatters:oge,labels:mge,locale:n,modifiersClassNames:r,modifiers:a,numberOfMonths:s,styles:i,today:o,mode:"default"}}function yge(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,a=e.toMonth,s=e.fromDate,i=e.toDate;return r?s=ys(r):t&&(s=new Date(t,0,1)),a?i=Mj(a):n&&(i=new Date(n,11,31)),{fromDate:s?rm(s):void 0,toDate:i?rm(i):void 0}}var D6=N.createContext(void 0);function xge(e){var t,n=e.initialProps,r=gge(),a=yge(n),s=a.fromDate,i=a.toDate,o=(t=n.captionLayout)!==null&&t!==void 0?t:r.captionLayout;o!=="buttons"&&(!s||!i)&&(o="buttons");var l;(uk(n)||Fv(n)||Pv(n))&&(l=n.onSelect);var c=dt(dt(dt({},r),n),{captionLayout:o,classNames:dt(dt({},r.classNames),n.classNames),components:dt({},n.components),formatters:dt(dt({},r.formatters),n.formatters),fromDate:s,labels:dt(dt({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:dt(dt({},r.modifiers),n.modifiers),modifiersClassNames:dt(dt({},r.modifiersClassNames),n.modifiersClassNames),onSelect:l,styles:dt(dt({},r.styles),n.styles),toDate:i});return d.jsx(D6.Provider,{value:c,children:e.children})}function An(){var e=N.useContext(D6);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function M6(e){var t=An(),n=t.locale,r=t.classNames,a=t.styles,s=t.formatters.formatCaption;return d.jsx("div",{className:r.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:n})})}function vge(e){return d.jsx("svg",dt({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:d.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function O6(e){var t,n,r=e.onChange,a=e.value,s=e.children,i=e.caption,o=e.className,l=e.style,c=An(),u=(n=(t=c.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:vge;return d.jsxs("div",{className:o,style:l,children:[d.jsx("span",{className:c.classNames.vhidden,children:e["aria-label"]}),d.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:c.classNames.dropdown,style:c.styles.dropdown,value:a,onChange:r,children:s}),d.jsxs("div",{className:c.classNames.caption_label,style:c.styles.caption_label,"aria-hidden":"true",children:[i,d.jsx(u,{className:c.classNames.dropdown_icon,style:c.styles.dropdown_icon})]})]})}function bge(e){var t,n=An(),r=n.fromDate,a=n.toDate,s=n.styles,i=n.locale,o=n.formatters.formatMonthCaption,l=n.classNames,c=n.components,u=n.labels.labelMonthDropdown;if(!r)return d.jsx(d.Fragment,{});if(!a)return d.jsx(d.Fragment,{});var h=[];if(Jme(r,a))for(var p=ys(r),f=r.getMonth();f<=a.getMonth();f++)h.push(tC(p,f));else for(var p=ys(new Date),f=0;f<=11;f++)h.push(tC(p,f));var g=function(y){var x=Number(y.target.value),v=tC(ys(e.displayMonth),x);e.onChange(v)},m=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:O6;return d.jsx(m,{name:"months","aria-label":u(),className:l.dropdown_month,style:s.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:o(e.displayMonth,{locale:i}),children:h.map(function(y){return d.jsx("option",{value:y.getMonth(),children:o(y,{locale:i})},y.getMonth())})})}function wge(e){var t,n=e.displayMonth,r=An(),a=r.fromDate,s=r.toDate,i=r.locale,o=r.styles,l=r.classNames,c=r.components,u=r.formatters.formatYearCaption,h=r.labels.labelYearDropdown,p=[];if(!a)return d.jsx(d.Fragment,{});if(!s)return d.jsx(d.Fragment,{});for(var f=a.getFullYear(),g=s.getFullYear(),m=f;m<=g;m++)p.push(NP(zfe(new Date),m));var y=function(v){var b=NP(ys(n),Number(v.target.value));e.onChange(b)},x=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:O6;return d.jsx(x,{name:"years","aria-label":h(),className:l.dropdown_year,style:o.dropdown_year,onChange:y,value:n.getFullYear(),caption:u(n,{locale:i}),children:p.map(function(v){return d.jsx("option",{value:v.getFullYear(),children:u(v,{locale:i})},v.getFullYear())})})}function Nge(e,t){var n=N.useState(e),r=n[0],a=n[1],s=t===void 0?r:t;return[s,a]}function kge(e){var t=e.month,n=e.defaultMonth,r=e.today,a=t||n||r||new Date,s=e.toDate,i=e.fromDate,o=e.numberOfMonths,l=o===void 0?1:o;if(s&&Kx(s,a)<0){var c=-1*(l-1);a=Li(s,c)}return i&&Kx(a,i)<0&&(a=i),ys(a)}function Sge(){var e=An(),t=kge(e),n=Nge(t,e.month),r=n[0],a=n[1],s=function(i){var o;if(!e.disableNavigation){var l=ys(i);a(l),(o=e.onMonthChange)===null||o===void 0||o.call(e,l)}};return[r,s]}function _ge(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,a=ys(e),s=ys(Li(a,r)),i=Kx(s,a),o=[],l=0;l<i;l++){var c=Li(a,l);o.push(c)}return n&&(o=o.reverse()),o}function Cge(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=r?s:1,o=ys(e);if(!n)return Li(o,i);var l=Kx(n,e);if(!(l<s))return Li(o,i)}}function Ige(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=r?s:1,o=ys(e);if(!n)return Li(o,-i);var l=Kx(o,n);if(!(l<=0))return Li(o,-i)}}var F6=N.createContext(void 0);function Ege(e){var t=An(),n=Sge(),r=n[0],a=n[1],s=_ge(r,t),i=Cge(r,t),o=Ige(r,t),l=function(h){return s.some(function(p){return Fj(h,p)})},c=function(h,p){l(h)||(p&&$6(h,p)?a(Li(h,1+t.numberOfMonths*-1)):a(h))},u={currentMonth:r,displayMonths:s,goToMonth:a,goToDate:c,previousMonth:o,nextMonth:i,isDateDisplayed:l};return d.jsx(F6.Provider,{value:u,children:e.children})}function Lv(){var e=N.useContext(F6);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function kP(e){var t,n=An(),r=n.classNames,a=n.styles,s=n.components,i=Lv().goToMonth,o=function(u){i(Li(u,e.displayIndex?-e.displayIndex:0))},l=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:M6,c=d.jsx(l,{id:e.id,displayMonth:e.displayMonth});return d.jsxs("div",{className:r.caption_dropdowns,style:a.caption_dropdowns,children:[d.jsx("div",{className:r.vhidden,children:c}),d.jsx(bge,{onChange:o,displayMonth:e.displayMonth}),d.jsx(wge,{onChange:o,displayMonth:e.displayMonth})]})}function Tge(e){return d.jsx("svg",dt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:d.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function jge(e){return d.jsx("svg",dt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:d.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var w1=N.forwardRef(function(e,t){var n=An(),r=n.classNames,a=n.styles,s=[r.button_reset,r.button];e.className&&s.push(e.className);var i=s.join(" "),o=dt(dt({},a.button_reset),a.button);return e.style&&Object.assign(o,e.style),d.jsx("button",dt({},e,{ref:t,type:"button",className:i,style:o}))});function Age(e){var t,n,r=An(),a=r.dir,s=r.locale,i=r.classNames,o=r.styles,l=r.labels,c=l.labelPrevious,u=l.labelNext,h=r.components;if(!e.nextMonth&&!e.previousMonth)return d.jsx(d.Fragment,{});var p=c(e.previousMonth,{locale:s}),f=[i.nav_button,i.nav_button_previous].join(" "),g=u(e.nextMonth,{locale:s}),m=[i.nav_button,i.nav_button_next].join(" "),y=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:jge,x=(n=h==null?void 0:h.IconLeft)!==null&&n!==void 0?n:Tge;return d.jsxs("div",{className:i.nav,style:o.nav,children:[!e.hidePrevious&&d.jsx(w1,{name:"previous-month","aria-label":p,className:f,style:o.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?d.jsx(y,{className:i.nav_icon,style:o.nav_icon}):d.jsx(x,{className:i.nav_icon,style:o.nav_icon})}),!e.hideNext&&d.jsx(w1,{name:"next-month","aria-label":g,className:m,style:o.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?d.jsx(x,{className:i.nav_icon,style:o.nav_icon}):d.jsx(y,{className:i.nav_icon,style:o.nav_icon})})]})}function SP(e){var t=An().numberOfMonths,n=Lv(),r=n.previousMonth,a=n.nextMonth,s=n.goToMonth,i=n.displayMonths,o=i.findIndex(function(g){return Fj(e.displayMonth,g)}),l=o===0,c=o===i.length-1,u=t>1&&(l||!c),h=t>1&&(c||!l),p=function(){r&&s(r)},f=function(){a&&s(a)};return d.jsx(Age,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:h,nextMonth:a,previousMonth:r,onPreviousClick:p,onNextClick:f})}function $ge(e){var t,n=An(),r=n.classNames,a=n.disableNavigation,s=n.styles,i=n.captionLayout,o=n.components,l=(t=o==null?void 0:o.CaptionLabel)!==null&&t!==void 0?t:M6,c;return a?c=d.jsx(l,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?c=d.jsx(kP,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?c=d.jsxs(d.Fragment,{children:[d.jsx(kP,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),d.jsx(SP,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):c=d.jsxs(d.Fragment,{children:[d.jsx(l,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),d.jsx(SP,{displayMonth:e.displayMonth,id:e.id})]}),d.jsx("div",{className:r.caption,style:s.caption,children:c})}function Rge(e){var t=An(),n=t.footer,r=t.styles,a=t.classNames.tfoot;return n?d.jsx("tfoot",{className:a,style:r.tfoot,children:d.jsx("tr",{children:d.jsx("td",{colSpan:8,children:n})})}):d.jsx(d.Fragment,{})}function Dge(e,t,n){for(var r=n?Ad(new Date):Ao(new Date,{locale:e,weekStartsOn:t}),a=[],s=0;s<7;s++){var i=Ma(r,s);a.push(i)}return a}function Mge(){var e=An(),t=e.classNames,n=e.styles,r=e.showWeekNumber,a=e.locale,s=e.weekStartsOn,i=e.ISOWeek,o=e.formatters.formatWeekdayName,l=e.labels.labelWeekday,c=Dge(a,s,i);return d.jsxs("tr",{style:n.head_row,className:t.head_row,children:[r&&d.jsx("td",{style:n.head_cell,className:t.head_cell}),c.map(function(u,h){return d.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":l(u,{locale:a}),children:o(u,{locale:a})},h)})]})}function Oge(){var e,t=An(),n=t.classNames,r=t.styles,a=t.components,s=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:Mge;return d.jsx("thead",{style:r.head,className:n.head,children:d.jsx(s,{})})}function Fge(e){var t=An(),n=t.locale,r=t.formatters.formatDay;return d.jsx(d.Fragment,{children:r(e.date,{locale:n})})}var Pj=N.createContext(void 0);function Pge(e){if(!Fv(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return d.jsx(Pj.Provider,{value:t,children:e.children})}return d.jsx(Lge,{initialProps:e.initialProps,children:e.children})}function Lge(e){var t=e.initialProps,n=e.children,r=t.selected,a=t.min,s=t.max,i=function(c,u,h){var p,f;(p=t.onDayClick)===null||p===void 0||p.call(t,c,u,h);var g=!!(u.selected&&a&&(r==null?void 0:r.length)===a);if(!g){var m=!!(!u.selected&&s&&(r==null?void 0:r.length)===s);if(!m){var y=r?R6([],r):[];if(u.selected){var x=y.findIndex(function(v){return cs(c,v)});y.splice(x,1)}else y.push(c);(f=t.onSelect)===null||f===void 0||f.call(t,y,c,u,h)}}},o={disabled:[]};r&&o.disabled.push(function(c){var u=s&&r.length>s-1,h=r.some(function(p){return cs(p,c)});return!!(u&&!h)});var l={selected:r,onDayClick:i,modifiers:o};return d.jsx(Pj.Provider,{value:l,children:n})}function Lj(){var e=N.useContext(Pj);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function zge(e,t){var n=t||{},r=n.from,a=n.to;return r&&a?cs(a,e)&&cs(r,e)?void 0:cs(a,e)?{from:a,to:void 0}:cs(r,e)?void 0:wI(r,e)?{from:e,to:a}:{from:r,to:e}:a?wI(e,a)?{from:a,to:e}:{from:e,to:a}:r?$6(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var zj=N.createContext(void 0);function Bge(e){if(!Pv(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return d.jsx(zj.Provider,{value:t,children:e.children})}return d.jsx(Uge,{initialProps:e.initialProps,children:e.children})}function Uge(e){var t=e.initialProps,n=e.children,r=t.selected,a=r||{},s=a.from,i=a.to,o=t.min,l=t.max,c=function(f,g,m){var y,x;(y=t.onDayClick)===null||y===void 0||y.call(t,f,g,m);var v=zge(f,r);(x=t.onSelect)===null||x===void 0||x.call(t,v,f,g,m)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(u.range_start=[s],i?(u.range_end=[i],cs(s,i)||(u.range_middle=[{after:s,before:i}])):u.range_end=[s]):i&&(u.range_start=[i],u.range_end=[i]),o&&(s&&!i&&u.disabled.push({after:eC(s,o-1),before:Ma(s,o-1)}),s&&i&&u.disabled.push({after:s,before:Ma(s,o-1)}),!s&&i&&u.disabled.push({after:eC(i,o-1),before:Ma(i,o-1)})),l){if(s&&!i&&(u.disabled.push({before:Ma(s,-l+1)}),u.disabled.push({after:Ma(s,l-1)})),s&&i){var h=ul(i,s)+1,p=l-h;u.disabled.push({before:eC(s,p)}),u.disabled.push({after:Ma(i,p)})}!s&&i&&(u.disabled.push({before:Ma(i,-l+1)}),u.disabled.push({after:Ma(i,l-1)}))}return d.jsx(zj.Provider,{value:{selected:r,onDayClick:c,modifiers:u},children:n})}function Bj(){var e=N.useContext(zj);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function S0(e){return Array.isArray(e)?R6([],e):e!==void 0?[e]:[]}function Wge(e){var t={};return Object.entries(e).forEach(function(n){var r=n[0],a=n[1];t[r]=S0(a)}),t}var zi;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(zi||(zi={}));var Vge=zi.Selected,Go=zi.Disabled,Hge=zi.Hidden,Gge=zi.Today,nC=zi.RangeEnd,rC=zi.RangeMiddle,aC=zi.RangeStart,qge=zi.Outside;function Kge(e,t,n){var r,a=(r={},r[Vge]=S0(e.selected),r[Go]=S0(e.disabled),r[Hge]=S0(e.hidden),r[Gge]=[e.today],r[nC]=[],r[rC]=[],r[aC]=[],r[qge]=[],r);return e.fromDate&&a[Go].push({before:e.fromDate}),e.toDate&&a[Go].push({after:e.toDate}),Fv(e)?a[Go]=a[Go].concat(t.modifiers[Go]):Pv(e)&&(a[Go]=a[Go].concat(n.modifiers[Go]),a[aC]=n.modifiers[aC],a[rC]=n.modifiers[rC],a[nC]=n.modifiers[nC]),a}var P6=N.createContext(void 0);function Qge(e){var t=An(),n=Lj(),r=Bj(),a=Kge(t,n,r),s=Wge(t.modifiers),i=dt(dt({},a),s);return d.jsx(P6.Provider,{value:i,children:e.children})}function L6(){var e=N.useContext(P6);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Xge(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Yge(e){return!!(e&&typeof e=="object"&&"from"in e)}function Jge(e){return!!(e&&typeof e=="object"&&"after"in e)}function Zge(e){return!!(e&&typeof e=="object"&&"before"in e)}function eye(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function tye(e,t){var n,r=t.from,a=t.to;if(r&&a){var s=ul(a,r)<0;s&&(n=[a,r],r=n[0],a=n[1]);var i=ul(e,r)>=0&&ul(a,e)>=0;return i}return a?cs(a,e):r?cs(r,e):!1}function nye(e){return Dj(e)}function rye(e){return Array.isArray(e)&&e.every(Dj)}function aye(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if(nye(n))return cs(e,n);if(rye(n))return n.includes(e);if(Yge(n))return tye(e,n);if(eye(n))return n.dayOfWeek.includes(e.getDay());if(Xge(n)){var r=ul(n.before,e),a=ul(n.after,e),s=r>0,i=a<0,o=wI(n.before,n.after);return o?i&&s:s||i}return Jge(n)?ul(e,n.after)>0:Zge(n)?ul(n.before,e)>0:typeof n=="function"?n(e):!1})}function Uj(e,t,n){var r=Object.keys(t).reduce(function(s,i){var o=t[i];return aye(e,o)&&s.push(i),s},[]),a={};return r.forEach(function(s){return a[s]=!0}),n&&!Fj(e,n)&&(a.outside=!0),a}function sye(e,t){for(var n=ys(e[0]),r=Mj(e[e.length-1]),a,s,i=n;i<=r;){var o=Uj(i,t),l=!o.disabled&&!o.hidden;if(!l){i=Ma(i,1);continue}if(o.selected)return i;o.today&&!s&&(s=i),a||(a=i),i=Ma(i,1)}return s||a}var iye=365;function z6(e,t){var n=t.moveBy,r=t.direction,a=t.context,s=t.modifiers,i=t.retry,o=i===void 0?{count:0,lastFocused:e}:i,l=a.weekStartsOn,c=a.fromDate,u=a.toDate,h=a.locale,p={day:Ma,week:bI,month:Li,year:Dfe,startOfWeek:function(y){return a.ISOWeek?Ad(y):Ao(y,{locale:h,weekStartsOn:l})},endOfWeek:function(y){return a.ISOWeek?I6(y):Oj(y,{locale:h,weekStartsOn:l})}},f=p[n](e,r==="after"?1:-1);r==="before"&&c?f=Mfe([c,f]):r==="after"&&u&&(f=Ofe([u,f]));var g=!0;if(s){var m=Uj(f,s);g=!m.disabled&&!m.hidden}return g?f:o.count>iye?o.lastFocused:z6(f,{moveBy:n,direction:r,context:a,modifiers:s,retry:dt(dt({},o),{count:o.count+1})})}var B6=N.createContext(void 0);function oye(e){var t=Lv(),n=L6(),r=N.useState(),a=r[0],s=r[1],i=N.useState(),o=i[0],l=i[1],c=sye(t.displayMonths,n),u=a??(o&&t.isDateDisplayed(o))?o:c,h=function(){l(a),s(void 0)},p=function(y){s(y)},f=An(),g=function(y,x){if(a){var v=z6(a,{moveBy:y,direction:x,context:f,modifiers:n});cs(a,v)||(t.goToDate(v,a),p(v))}},m={focusedDay:a,focusTarget:u,blur:h,focus:p,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return d.jsx(B6.Provider,{value:m,children:e.children})}function Wj(){var e=N.useContext(B6);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function lye(e,t){var n=L6(),r=Uj(e,n,t);return r}var Vj=N.createContext(void 0);function uye(e){if(!uk(e.initialProps)){var t={selected:void 0};return d.jsx(Vj.Provider,{value:t,children:e.children})}return d.jsx(cye,{initialProps:e.initialProps,children:e.children})}function cye(e){var t=e.initialProps,n=e.children,r=function(s,i,o){var l,c,u;if((l=t.onDayClick)===null||l===void 0||l.call(t,s,i,o),i.selected&&!t.required){(c=t.onSelect)===null||c===void 0||c.call(t,void 0,s,i,o);return}(u=t.onSelect)===null||u===void 0||u.call(t,s,s,i,o)},a={selected:t.selected,onDayClick:r};return d.jsx(Vj.Provider,{value:a,children:n})}function U6(){var e=N.useContext(Vj);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function dye(e,t){var n=An(),r=U6(),a=Lj(),s=Bj(),i=Wj(),o=i.focusDayAfter,l=i.focusDayBefore,c=i.focusWeekAfter,u=i.focusWeekBefore,h=i.blur,p=i.focus,f=i.focusMonthBefore,g=i.focusMonthAfter,m=i.focusYearBefore,y=i.focusYearAfter,x=i.focusStartOfWeek,v=i.focusEndOfWeek,b=function(F){var D,R,V,G;uk(n)?(D=r.onDayClick)===null||D===void 0||D.call(r,e,t,F):Fv(n)?(R=a.onDayClick)===null||R===void 0||R.call(a,e,t,F):Pv(n)?(V=s.onDayClick)===null||V===void 0||V.call(s,e,t,F):(G=n.onDayClick)===null||G===void 0||G.call(n,e,t,F)},w=function(F){var D;p(e),(D=n.onDayFocus)===null||D===void 0||D.call(n,e,t,F)},k=function(F){var D;h(),(D=n.onDayBlur)===null||D===void 0||D.call(n,e,t,F)},I=function(F){var D;(D=n.onDayMouseEnter)===null||D===void 0||D.call(n,e,t,F)},C=function(F){var D;(D=n.onDayMouseLeave)===null||D===void 0||D.call(n,e,t,F)},S=function(F){var D;(D=n.onDayPointerEnter)===null||D===void 0||D.call(n,e,t,F)},E=function(F){var D;(D=n.onDayPointerLeave)===null||D===void 0||D.call(n,e,t,F)},T=function(F){var D;(D=n.onDayTouchCancel)===null||D===void 0||D.call(n,e,t,F)},$=function(F){var D;(D=n.onDayTouchEnd)===null||D===void 0||D.call(n,e,t,F)},_=function(F){var D;(D=n.onDayTouchMove)===null||D===void 0||D.call(n,e,t,F)},M=function(F){var D;(D=n.onDayTouchStart)===null||D===void 0||D.call(n,e,t,F)},L=function(F){var D;(D=n.onDayKeyUp)===null||D===void 0||D.call(n,e,t,F)},U=function(F){var D;switch(F.key){case"ArrowLeft":F.preventDefault(),F.stopPropagation(),n.dir==="rtl"?o():l();break;case"ArrowRight":F.preventDefault(),F.stopPropagation(),n.dir==="rtl"?l():o();break;case"ArrowDown":F.preventDefault(),F.stopPropagation(),c();break;case"ArrowUp":F.preventDefault(),F.stopPropagation(),u();break;case"PageUp":F.preventDefault(),F.stopPropagation(),F.shiftKey?m():f();break;case"PageDown":F.preventDefault(),F.stopPropagation(),F.shiftKey?y():g();break;case"Home":F.preventDefault(),F.stopPropagation(),x();break;case"End":F.preventDefault(),F.stopPropagation(),v();break}(D=n.onDayKeyDown)===null||D===void 0||D.call(n,e,t,F)},O={onClick:b,onFocus:w,onBlur:k,onKeyDown:U,onKeyUp:L,onMouseEnter:I,onMouseLeave:C,onPointerEnter:S,onPointerLeave:E,onTouchCancel:T,onTouchEnd:$,onTouchMove:_,onTouchStart:M};return O}function hye(){var e=An(),t=U6(),n=Lj(),r=Bj(),a=uk(e)?t.selected:Fv(e)?n.selected:Pv(e)?r.selected:void 0;return a}function pye(e){return Object.values(zi).includes(e)}function fye(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(r){var a=e.modifiersClassNames[r];if(a)n.push(a);else if(pye(r)){var s=e.classNames["day_".concat(r)];s&&n.push(s)}}),n}function mye(e,t){var n=dt({},e.styles.day);return Object.keys(t).forEach(function(r){var a;n=dt(dt({},n),(a=e.modifiersStyles)===null||a===void 0?void 0:a[r])}),n}function gye(e,t,n){var r,a,s,i=An(),o=Wj(),l=lye(e,t),c=dye(e,l),u=hye(),h=!!(i.onDayClick||i.mode!=="default");N.useEffect(function(){var I;l.outside||o.focusedDay&&h&&cs(o.focusedDay,e)&&((I=n.current)===null||I===void 0||I.focus())},[o.focusedDay,e,n,h,l.outside]);var p=fye(i,l).join(" "),f=mye(i,l),g=!!(l.outside&&!i.showOutsideDays||l.hidden),m=(s=(a=i.components)===null||a===void 0?void 0:a.DayContent)!==null&&s!==void 0?s:Fge,y=d.jsx(m,{date:e,displayMonth:t,activeModifiers:l}),x={style:f,className:p,children:y,role:"gridcell"},v=o.focusTarget&&cs(o.focusTarget,e)&&!l.outside,b=o.focusedDay&&cs(o.focusedDay,e),w=dt(dt(dt({},x),(r={disabled:l.disabled,role:"gridcell"},r["aria-selected"]=l.selected,r.tabIndex=b||v?0:-1,r)),c),k={isButton:h,isHidden:g,activeModifiers:l,selectedDays:u,buttonProps:w,divProps:x};return k}function yye(e){var t=N.useRef(null),n=gye(e.date,e.displayMonth,t);return n.isHidden?d.jsx("div",{role:"gridcell"}):n.isButton?d.jsx(w1,dt({name:"day",ref:t},n.buttonProps)):d.jsx("div",dt({},n.divProps))}function xye(e){var t=e.number,n=e.dates,r=An(),a=r.onWeekNumberClick,s=r.styles,i=r.classNames,o=r.locale,l=r.labels.labelWeekNumber,c=r.formatters.formatWeekNumber,u=c(Number(t),{locale:o});if(!a)return d.jsx("span",{className:i.weeknumber,style:s.weeknumber,children:u});var h=l(Number(t),{locale:o}),p=function(f){a(t,n,f)};return d.jsx(w1,{name:"week-number","aria-label":h,className:i.weeknumber,style:s.weeknumber,onClick:p,children:u})}function vye(e){var t,n,r=An(),a=r.styles,s=r.classNames,i=r.showWeekNumber,o=r.components,l=(t=o==null?void 0:o.Day)!==null&&t!==void 0?t:yye,c=(n=o==null?void 0:o.WeekNumber)!==null&&n!==void 0?n:xye,u;return i&&(u=d.jsx("td",{className:s.cell,style:a.cell,children:d.jsx(c,{number:e.weekNumber,dates:e.dates})})),d.jsxs("tr",{className:s.row,style:a.row,children:[u,e.dates.map(function(h){return d.jsx("td",{className:s.cell,style:a.cell,role:"presentation",children:d.jsx(l,{displayMonth:e.displayMonth,date:h})},Hme(h))})]})}function _P(e,t,n){for(var r=n!=null&&n.ISOWeek?I6(t):Oj(t,n),a=n!=null&&n.ISOWeek?Ad(e):Ao(e,n),s=ul(r,a),i=[],o=0;o<=s;o++)i.push(Ma(a,o));var l=i.reduce(function(c,u){var h=n!=null&&n.ISOWeek?Wme(u):Qme(u,n),p=c.find(function(f){return f.weekNumber===h});return p?(p.dates.push(u),c):(c.push({weekNumber:h,dates:[u]}),c)},[]);return l}function bye(e,t){var n=_P(ys(e),Mj(e),t);if(t!=null&&t.useFixedWeeks){var r=Yme(e,t);if(r<6){var a=n[n.length-1],s=a.dates[a.dates.length-1],i=bI(s,6-r),o=_P(bI(s,1),i,t);n.push.apply(n,o)}}return n}function wye(e){var t,n,r,a=An(),s=a.locale,i=a.classNames,o=a.styles,l=a.hideHead,c=a.fixedWeeks,u=a.components,h=a.weekStartsOn,p=a.firstWeekContainsDate,f=a.ISOWeek,g=bye(e.displayMonth,{useFixedWeeks:!!c,ISOWeek:f,locale:s,weekStartsOn:h,firstWeekContainsDate:p}),m=(t=u==null?void 0:u.Head)!==null&&t!==void 0?t:Oge,y=(n=u==null?void 0:u.Row)!==null&&n!==void 0?n:vye,x=(r=u==null?void 0:u.Footer)!==null&&r!==void 0?r:Rge;return d.jsxs("table",{id:e.id,className:i.table,style:o.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!l&&d.jsx(m,{}),d.jsx("tbody",{className:i.tbody,style:o.tbody,children:g.map(function(v){return d.jsx(y,{displayMonth:e.displayMonth,dates:v.dates,weekNumber:v.weekNumber},v.weekNumber)})}),d.jsx(x,{displayMonth:e.displayMonth})]})}function Nye(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var kye=Nye()?N.useLayoutEffect:N.useEffect,sC=!1,Sye=0;function CP(){return"react-day-picker-".concat(++Sye)}function _ye(e){var t,n=e??(sC?CP():null),r=N.useState(n),a=r[0],s=r[1];return kye(function(){a===null&&s(CP())},[]),N.useEffect(function(){sC===!1&&(sC=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function Cye(e){var t,n,r=An(),a=r.dir,s=r.classNames,i=r.styles,o=r.components,l=Lv().displayMonths,c=_ye(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),u=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,h=[s.month],p=i.month,f=e.displayIndex===0,g=e.displayIndex===l.length-1,m=!f&&!g;a==="rtl"&&(t=[f,g],g=t[0],f=t[1]),f&&(h.push(s.caption_start),p=dt(dt({},p),i.caption_start)),g&&(h.push(s.caption_end),p=dt(dt({},p),i.caption_end)),m&&(h.push(s.caption_between),p=dt(dt({},p),i.caption_between));var y=(n=o==null?void 0:o.Caption)!==null&&n!==void 0?n:$ge;return d.jsxs("div",{className:h.join(" "),style:p,children:[d.jsx(y,{id:c,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),d.jsx(wye,{id:u,"aria-labelledby":c,displayMonth:e.displayMonth})]},e.displayIndex)}function Iye(e){var t=An(),n=t.classNames,r=t.styles;return d.jsx("div",{className:n.months,style:r.months,children:e.children})}function Eye(e){var t,n,r=e.initialProps,a=An(),s=Wj(),i=Lv(),o=N.useState(!1),l=o[0],c=o[1];N.useEffect(function(){a.initialFocus&&s.focusTarget&&(l||(s.focus(s.focusTarget),c(!0)))},[a.initialFocus,l,s.focus,s.focusTarget,s]);var u=[a.classNames.root,a.className];a.numberOfMonths>1&&u.push(a.classNames.multiple_months),a.showWeekNumber&&u.push(a.classNames.with_weeknumber);var h=dt(dt({},a.styles.root),a.style),p=Object.keys(r).filter(function(g){return g.startsWith("data-")}).reduce(function(g,m){var y;return dt(dt({},g),(y={},y[m]=r[m],y))},{}),f=(n=(t=r.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:Iye;return d.jsx("div",dt({className:u.join(" "),style:h,dir:a.dir,id:a.id,nonce:r.nonce,title:r.title,lang:r.lang},p,{children:d.jsx(f,{children:i.displayMonths.map(function(g,m){return d.jsx(Cye,{displayIndex:m,displayMonth:g},m)})})}))}function Tye(e){var t=e.children,n=Zme(e,["children"]);return d.jsx(xge,{initialProps:n,children:d.jsx(Ege,{children:d.jsx(uye,{initialProps:n,children:d.jsx(Pge,{initialProps:n,children:d.jsx(Bge,{initialProps:n,children:d.jsx(Qge,{children:d.jsx(oye,{children:t})})})})})})})}function jye(e){return d.jsx(Tye,dt({},e,{children:d.jsx(Eye,{initialProps:e})}))}function N1({className:e,classNames:t,showOutsideDays:n=!0,...r}){return d.jsx(jye,{showOutsideDays:n,className:Fe("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Fe(hI({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Fe(hI({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>d.jsx(tse,{className:"h-4 w-4"}),IconRight:({...a})=>d.jsx(iU,{className:"h-4 w-4"})},...r})}N1.displayName="Calendar";var ck="Popover",[W6,Dat]=ia(ck,[lc]),zv=lc(),[Aye,hc]=W6(ck),V6=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:a,onOpenChange:s,modal:i=!1}=e,o=zv(t),l=N.useRef(null),[c,u]=N.useState(!1),[h,p]=Io({prop:r,defaultProp:a??!1,onChange:s,caller:ck});return d.jsx(lj,{...o,children:d.jsx(Aye,{scope:t,contentId:$i(),triggerRef:l,open:h,onOpenChange:p,onOpenToggle:N.useCallback(()=>p(f=>!f),[p]),hasCustomAnchor:c,onCustomAnchorAdd:N.useCallback(()=>u(!0),[]),onCustomAnchorRemove:N.useCallback(()=>u(!1),[]),modal:i,children:n})})};V6.displayName=ck;var H6="PopoverAnchor",$ye=N.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hc(H6,n),s=zv(n),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=a;return N.useEffect(()=>(i(),()=>o()),[i,o]),d.jsx(Ev,{...s,...r,ref:t})});$ye.displayName=H6;var G6="PopoverTrigger",q6=N.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hc(G6,n),s=zv(n),i=kt(t,a.triggerRef),o=d.jsx(Qe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":J6(a.open),...r,ref:i,onClick:Te(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:d.jsx(Ev,{asChild:!0,...s,children:o})});q6.displayName=G6;var Hj="PopoverPortal",[Rye,Dye]=W6(Hj,{forceMount:void 0}),K6=e=>{const{__scopePopover:t,forceMount:n,children:r,container:a}=e,s=hc(Hj,t);return d.jsx(Rye,{scope:t,forceMount:n,children:d.jsx(Lr,{present:n||s.open,children:d.jsx(Am,{asChild:!0,container:a,children:r})})})};K6.displayName=Hj;var am="PopoverContent",Q6=N.forwardRef((e,t)=>{const n=Dye(am,e.__scopePopover),{forceMount:r=n.forceMount,...a}=e,s=hc(am,e.__scopePopover);return d.jsx(Lr,{present:r||s.open,children:s.modal?d.jsx(Oye,{...a,ref:t}):d.jsx(Fye,{...a,ref:t})})});Q6.displayName=am;var Mye=Ou("PopoverContent.RemoveScroll"),Oye=N.forwardRef((e,t)=>{const n=hc(am,e.__scopePopover),r=N.useRef(null),a=kt(t,r),s=N.useRef(!1);return N.useEffect(()=>{const i=r.current;if(i)return ek(i)},[]),d.jsx(Mv,{as:Mye,allowPinchZoom:!0,children:d.jsx(X6,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Te(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),s.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Te(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Te(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Fye=N.forwardRef((e,t)=>{const n=hc(am,e.__scopePopover),r=N.useRef(!1),a=N.useRef(!1);return d.jsx(X6,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),s.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),X6=N.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...h}=e,p=hc(am,n),f=zv(n);return JN(),d.jsx(Dv,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:s,children:d.jsx(th,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>p.onOpenChange(!1),children:d.jsx(ON,{"data-state":J6(p.open),role:"dialog",id:p.contentId,...f,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Y6="PopoverClose",Pye=N.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=hc(Y6,n);return d.jsx(Qe.button,{type:"button",...r,ref:t,onClick:Te(e.onClick,()=>a.onOpenChange(!1))})});Pye.displayName=Y6;var Lye="PopoverArrow",zye=N.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,a=zv(n);return d.jsx(FN,{...a,...r,ref:t})});zye.displayName=Lye;function J6(e){return e?"open":"closed"}var Bye=V6,Uye=q6,Wye=K6,Z6=Q6;const NI=Bye,kI=Uye,k1=N.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},a)=>d.jsx(Wye,{children:d.jsx(Z6,{ref:a,align:t,sideOffset:n,className:Fe("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));k1.displayName=Z6.displayName;const Qr={states:null,campuses:null,schools:null,religions:null,statuses:null,districts:new Map},Vye=async()=>{if(Qr.states)return Qr.states;try{const e=await XN();let t=[];Array.isArray(e)?t=e:e.data&&Array.isArray(e.data)?t=e.data:e.states&&Array.isArray(e.states)&&(t=e.states);const n=t.map(r=>({id:r.id||r.state_id||r.code,name:r.name||r.state_name||"Unknown State",state_code:r.state_code||r.code}));return Qr.states=n,n}catch{return[]}},Hye=async e=>{if(Qr.districts.has(e))return Qr.districts.get(e);try{const t=await YN(e);let n=[];Array.isArray(t)?n=t:t.data&&Array.isArray(t.data)?n=t.data:t.districts&&Array.isArray(t.districts)&&(n=t.districts);const r=n.map(a=>({id:a.id||a.district_id||a.code,name:a.name||a.district_name||"Unknown District",district_code:a.district_code||a.code,state_code:a.state_code||e}));return Qr.districts.set(e,r),r}catch{return[]}},Gye=async()=>{if(Qr.campuses)return Qr.campuses;try{const e=await KN();return Qr.campuses=e,e}catch{return[]}},qye=async()=>{if(Qr.schools)return Qr.schools;try{const e=await QN();return Qr.schools=e,e}catch{return[]}},Kye=async()=>{if(Qr.religions)return Qr.religions;try{const e=await qN();return Qr.religions=e,e}catch{return[]}},Qye=async()=>{if(Qr.statuses)return Qr.statuses;try{const e=await vj();return Qr.statuses=e,e}catch{return[]}},Gj=(e,t,n=[])=>{if(!e||e.length===0)return[];const r=[t,...n],a=new Set;return e.forEach(s=>{if(!(!s||typeof s!="object"))for(const i of r){const o=s[i];if(o&&typeof o=="string"&&o.trim()!==""){a.add(o.trim());break}}}),Array.from(a).sort()},Xye=e=>Gj(e,"partner",["partner_name","partnerName","partner_organization"]),Yye=e=>Gj(e,"district",["city","district_name","city_name","location"]),Jye=e=>Gj(e,"state",["state_name","current_state"]),Zye={sourcing:["Enrollment Key Generated","Basic Details Entered","Duplicate","Unreachable","Became Disinterested"],screening:["Screening Test Pass","Screening Test Fail","Created Student Without Exam"]};function eV({isOpen:e,onClose:t,onApplyFilters:n,currentFilters:r,students:a,campusList:s=[],schoolList:i=[],religionList:o=[],currentstatusList:l=[]}){var T,$,_,M,L,U;const[c,u]=N.useState(r),[h,p]=N.useState({partners:[],districts:[],schools:[],religions:[],currentStatuses:[],campuses:[]}),[f,g]=N.useState([]),[m,y]=N.useState([]),[x,v]=N.useState({states:!1,districts:!1,general:!1}),{toast:b}=Qt();N.useEffect(()=>{(async()=>{if(e){v(F=>({...F,general:!0})),u(r);try{const[F,D,R,V,G]=await Promise.all([Vye(),Gye(),qye(),Kye(),Qye()]),W=Xye(a),B=Yye(a),Q=Jye(a),X=[...F];Q.forEach(de=>{X.find(ye=>ye.name===de)||X.push({id:de,name:de})});const pe=s.length>0?s:D,ie=i.length>0?i:R,oe=o.length>0?o:V,q=l.length>0?l:G;p({partners:W,districts:B,schools:ie,religions:oe,currentStatuses:q,campuses:pe}),g(X),r.state&&r.state!=="all"&&await w(r.state,!1)}catch{b({title:"Error",description:"Failed to load filter options",variant:"destructive"})}finally{v(F=>({...F,general:!1}))}}})()},[e,r,a,s,i,o,l]);const w=async(O,F=!0)=>{if(F&&u(D=>({...D,state:O==="all"?void 0:O,district:[]})),O==="all"){y([]);return}v(D=>({...D,districts:!0}));try{const D=f.find(G=>G.name===O),R=(D==null?void 0:D.state_code)||(D==null?void 0:D.id);let V=[];R&&R!==O?V=await Hye(R):V=h.districts.map(W=>({id:W,name:W})),y(V)}catch{y([])}finally{v(D=>({...D,districts:!1}))}},k=()=>{u({stage:"all",status:"all",examMode:"all",interviewMode:"all",partner:[],district:[],school:[],religion:[],currentStatus:[],state:void 0,dateRange:{type:"application"}}),y([])},I=()=>{n(c),t(),b({title:"Filters Applied",description:"Your filters have been successfully applied."})},C=c.stage&&c.stage!=="all"?Zye[c.stage]||[]:[],S=(O,F="name",D="Item")=>{if(!O)return`${D}`;if(typeof O=="string")return O;const R=[F,"name","title","label","school_name","religion_name","current_status_name","campus_name","partner_name","district_name"];for(const V of R)if(O[V]&&typeof O[V]=="string")return O[V];return O.id?`${D} ${O.id}`:`${D}`},E=(O,F="id")=>O?typeof O=="string"?O:O[F]?String(O[F]):O.id?String(O.id):O.value?String(O.value):String(O):"";return d.jsx(ta,{open:e,onOpenChange:t,children:d.jsxs(na,{className:"max-w-2xl max-h-[90vh] overflow-y-auto mx-4",children:[d.jsx(ka,{className:"flex-shrink-0 pb-4",children:d.jsxs(ra,{className:"flex items-center gap-2 text-lg",children:[d.jsx($m,{className:"w-5 h-5"}),"Advanced Filters",x.general&&d.jsx("span",{className:"text-sm text-muted-foreground",children:"(Loading...)"})]})}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-muted/30 rounded-lg",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsx("h3",{className:"font-semibold text-sm",children:"Stage"}),d.jsxs(vt,{value:c.stage,onValueChange:O=>u(F=>({...F,stage:O,status:"all"})),children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:"Select stage"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Stages"}),d.jsx(Ee,{value:"sourcing",children:"Sourcing"}),d.jsx(Ee,{value:"screening",children:"Screening"})]})]}),C.length>0&&d.jsxs(d.Fragment,{children:[d.jsx(Pe,{className:"text-sm",children:"Status"}),d.jsxs(vt,{value:c.status,onValueChange:O=>u(F=>({...F,status:O})),children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:"Select status"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Statuses"}),C.map(O=>d.jsx(Ee,{value:O,children:O},O))]})]})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("h3",{className:"font-semibold text-sm",children:"Exam Mode"}),d.jsxs(vt,{value:c.examMode,onValueChange:O=>u(F=>({...F,examMode:O})),children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:"Select exam mode"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Modes"}),d.jsx(Ee,{value:"online",children:"Online"}),d.jsx(Ee,{value:"offline",children:"Offline"})]})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("h3",{className:"font-semibold text-sm",children:"Interview Mode"}),d.jsxs(vt,{value:c.interviewMode,onValueChange:O=>u(F=>({...F,interviewMode:O})),children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:"Select interview mode"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Modes"}),d.jsx(Ee,{value:"online",children:"Online"}),d.jsx(Ee,{value:"offline",children:"Offline"})]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-muted/30 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-sm mb-2",children:"State"}),d.jsxs(vt,{value:c.state||"all",onValueChange:w,disabled:x.general,children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:"Select State",children:c.state||"All States"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All States"}),f.map(O=>d.jsx(Ee,{value:O.name,children:O.name},O.id))]})]}),d.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:x.general&&" - Loading..."})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-sm mb-2",children:"City / District"}),d.jsxs(vt,{value:((T=c.district)==null?void 0:T[0])||"all",onValueChange:O=>u(F=>({...F,district:O==="all"?[]:[O]})),disabled:!c.state||c.state==="all"||x.districts,children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:!c.state||c.state==="all"?"Select state first":x.districts?"Loading districts...":"Select district"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Districts"}),m.map(O=>d.jsx(Ee,{value:O.name,children:O.name},O.id))]})]}),d.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Select state first",x.districts&&" - Loading..."]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Partner"}),d.jsxs(vt,{value:(($=c.partner)==null?void 0:$[0])||"all",onValueChange:O=>u(F=>({...F,partner:O==="all"?[]:[O]})),disabled:x.general,children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:x.general?"Loading...":"Select partner"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Partners"}),h.partners.map(O=>d.jsx(Ee,{value:O,children:O},O))]})]}),d.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[h.partners.length," partners available"]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Campus"}),d.jsxs(vt,{value:((_=c.partner)==null?void 0:_[1])||"all",onValueChange:O=>{u(O==="all"?F=>({...F,partner:F.partner.length>0?[F.partner[0]]:[]}):F=>({...F,partner:F.partner.length>0?[F.partner[0],O]:[O]}))},disabled:x.general,children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:x.general?"Loading...":"Select campus"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Campuses"}),h.campuses.map(O=>d.jsx(Ee,{value:E(O),children:S(O,"campus_name","Campus")},E(O)))]})]}),d.jsx("p",{className:"text-xs text-muted-foreground mt-1"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-muted/30 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Qualifying School"}),d.jsxs(vt,{value:((M=c.school)==null?void 0:M[0])||"all",onValueChange:O=>u(F=>({...F,school:O==="all"?[]:[O]})),disabled:x.general,children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:x.general?"Loading...":"Select school"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Schools"}),h.schools.map(O=>d.jsx(Ee,{value:E(O),children:S(O,"school_name","School")},E(O)))]})]}),d.jsx("p",{className:"text-xs text-muted-foreground mt-1"})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Religion"}),d.jsxs(vt,{value:((L=c.religion)==null?void 0:L[0])||"all",onValueChange:O=>u(F=>({...F,religion:O==="all"?[]:[O]})),disabled:x.general,children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:x.general?"Loading...":"Select religion"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Religions"}),h.religions.map(O=>d.jsx(Ee,{value:E(O),children:S(O,"religion_name","Religion")},E(O)))]})]}),d.jsx("p",{className:"text-xs text-muted-foreground mt-1"})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Current Status"}),d.jsxs(vt,{value:((U=c.currentStatus)==null?void 0:U[0])||"all",onValueChange:O=>u(F=>({...F,currentStatus:O==="all"?[]:[O]})),disabled:x.general,children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{placeholder:x.general?"Loading...":"Select status"})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"all",children:"All Statuses"}),h.currentStatuses.map(O=>d.jsx(Ee,{value:E(O),children:S(O,"current_status_name","Status")},E(O)))]})]}),d.jsx("p",{className:"text-xs text-muted-foreground mt-1"})]})]}),d.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[d.jsx("h3",{className:"font-semibold text-sm mb-3",children:"Date Range"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[d.jsxs("div",{children:[d.jsx(Pe,{className:"text-sm",children:"Date Type"}),d.jsxs(vt,{value:c.dateRange.type,onValueChange:O=>u(F=>({...F,dateRange:{...F.dateRange,type:O}})),children:[d.jsx(pt,{className:"w-full",children:d.jsx(bt,{})}),d.jsxs(ft,{className:"z-50",children:[d.jsx(Ee,{value:"application",children:"Application Date"}),d.jsx(Ee,{value:"lastUpdate",children:"Last Update"}),d.jsx(Ee,{value:"interview",children:"Interview Date"})]})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{className:"text-sm",children:"From"}),d.jsxs(NI,{children:[d.jsx(kI,{asChild:!0,children:d.jsxs(fe,{variant:"outline",className:"w-full justify-start",children:[d.jsx(Eo,{className:"mr-2 h-3 w-3"}),c.dateRange.from?li(c.dateRange.from,"PP"):"Pick a date"]})}),d.jsx(k1,{className:"w-auto p-0 z-50",children:d.jsx(N1,{mode:"single",selected:c.dateRange.from,onSelect:O=>u(F=>({...F,dateRange:{...F.dateRange,from:O}}))})})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{className:"text-sm",children:"To"}),d.jsxs(NI,{children:[d.jsx(kI,{asChild:!0,children:d.jsxs(fe,{variant:"outline",className:"w-full justify-start",children:[d.jsx(Eo,{className:"mr-2 h-3 w-3"}),c.dateRange.to?li(c.dateRange.to,"PP"):"Pick a date"]})}),d.jsx(k1,{className:"w-auto p-0 z-50",children:d.jsx(N1,{mode:"single",selected:c.dateRange.to,onSelect:O=>u(F=>({...F,dateRange:{...F.dateRange,to:O}}))})})]})]})]})]})]}),d.jsxs("div",{className:"flex justify-between pt-4 border-t mt-4",children:[d.jsx(fe,{variant:"outline",onClick:k,size:"sm",disabled:x.general,children:"Reset All"}),d.jsxs("div",{className:"space-x-2",children:[d.jsx(fe,{variant:"outline",onClick:t,size:"sm",disabled:x.general,children:"Cancel"}),d.jsx(fe,{onClick:I,size:"sm",className:"bg-primary text-primary-foreground",disabled:x.general,children:"Apply Filters"})]})]})]})})}const exe="modulepreload",txe=function(e){return"/Admission-Dashboard/"+e},IP={},Bv=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(n.map(l=>{if(l=txe(l),l in IP)return;IP[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":exe,c||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((p,f)=>{h.addEventListener("load",p),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},nxe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Bv(async()=>{const{default:r}=await Promise.resolve().then(()=>Vm);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class qj extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class rxe extends qj{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class EP extends qj{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class TP extends qj{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var SI;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(SI||(SI={}));var axe=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};class sxe{constructor(t,{headers:n={},customFetch:r,region:a=SI.Any}={}){this.url=t,this.headers=n,this.region=a,this.fetch=nxe(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return axe(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=n;let o={},{region:l}=n;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const h=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(m=>{throw new rxe(m)}),p=h.headers.get("x-relay-error");if(p&&p==="true")throw new EP(h);if(!h.ok)throw new TP(h);let f=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),g;return f==="application/json"?g=yield h.json():f==="application/octet-stream"?g=yield h.blob():f==="text/event-stream"?g=h:f==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof TP||a instanceof EP?a.context:void 0}}})}}var is={},Kj={},dk={},Uv={},hk={},pk={},ixe=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},sm=ixe();const oxe=sm.fetch,tV=sm.fetch.bind(sm),nV=sm.Headers,lxe=sm.Request,uxe=sm.Response,Vm=Object.freeze(Object.defineProperty({__proto__:null,Headers:nV,Request:lxe,Response:uxe,default:tV,fetch:oxe},Symbol.toStringTag,{value:"Module"})),cxe=iee(Vm);var fk={};Object.defineProperty(fk,"__esModule",{value:!0});let dxe=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};fk.default=dxe;var rV=Ls&&Ls.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pk,"__esModule",{value:!0});const hxe=rV(cxe),pxe=rV(fk);let fxe=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=hxe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l;let c=null,u=null,h=null,p=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const x=await s.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const m=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),y=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,p=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await s.text();try{c=JSON.parse(m),Array.isArray(c)&&s.status===404&&(u=[],c=null,p=200,f="OK")}catch{s.status===404&&m===""?(p=204,f="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new pxe.default(c)}return{error:c,data:u,count:h,status:p,statusText:f}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,n)}returns(){return this}overrideTypes(){return this}};pk.default=fxe;var mxe=Ls&&Ls.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hk,"__esModule",{value:!0});const gxe=mxe(pk);let yxe=class extends gxe.default{select(t){let n=!1;const r=(t??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};hk.default=yxe;var xxe=Ls&&Ls.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Uv,"__esModule",{value:!0});const vxe=xxe(hk);let bxe=class extends vxe.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${s}fts${i}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};Uv.default=bxe;var wxe=Ls&&Ls.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dk,"__esModule",{value:!0});const $y=wxe(Uv);let Nxe=class{constructor(t,{headers:n={},schema:r,fetch:a}){this.url=t,this.headers=n,this.schema=r,this.fetch=a}select(t,{head:n=!1,count:r}={}){const a=n?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),new $y.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new $y.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new $y.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new $y.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new $y.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};dk.default=Nxe;var mk={},gk={};Object.defineProperty(gk,"__esModule",{value:!0});gk.version=void 0;gk.version="0.0.0-automated";Object.defineProperty(mk,"__esModule",{value:!0});mk.DEFAULT_HEADERS=void 0;const kxe=gk;mk.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${kxe.version}`};var aV=Ls&&Ls.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Kj,"__esModule",{value:!0});const Sxe=aV(dk),_xe=aV(Uv),Cxe=mk;let Ixe=class sV{constructor(t,{headers:n={},schema:r,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},Cxe.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=a}from(t){const n=new URL(`${this.url}/${t}`);return new Sxe.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new sV(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:a=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let l;r||a?(i=r?"HEAD":"GET",Object.entries(n).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{o.searchParams.append(u,h)})):(i="POST",l=n);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new _xe.default({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Kj.default=Ixe;var Hm=Ls&&Ls.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(is,"__esModule",{value:!0});is.PostgrestError=is.PostgrestBuilder=is.PostgrestTransformBuilder=is.PostgrestFilterBuilder=is.PostgrestQueryBuilder=is.PostgrestClient=void 0;const iV=Hm(Kj);is.PostgrestClient=iV.default;const oV=Hm(dk);is.PostgrestQueryBuilder=oV.default;const lV=Hm(Uv);is.PostgrestFilterBuilder=lV.default;const uV=Hm(hk);is.PostgrestTransformBuilder=uV.default;const cV=Hm(pk);is.PostgrestBuilder=cV.default;const dV=Hm(fk);is.PostgrestError=dV.default;var Exe=is.default={PostgrestClient:iV.default,PostgrestQueryBuilder:oV.default,PostgrestFilterBuilder:lV.default,PostgrestTransformBuilder:uV.default,PostgrestBuilder:cV.default,PostgrestError:dV.default};const{PostgrestClient:Txe,PostgrestQueryBuilder:zat,PostgrestFilterBuilder:Bat,PostgrestTransformBuilder:Uat,PostgrestBuilder:Wat,PostgrestError:Vat}=Exe;function jxe(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Axe=jxe(),$xe="2.11.15",Rxe=`realtime-js/${$xe}`,Dxe="1.0.0",hV=1e4,Mxe=1e3;var mx;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(mx||(mx={}));var ha;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ha||(ha={}));var Ci;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ci||(Ci={}));var _I;(function(e){e.websocket="websocket"})(_I||(_I={}));var Uc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Uc||(Uc={}));class Oxe{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const a=n.getUint8(1),s=n.getUint8(2);let i=this.HEADER_LENGTH+2;const o=r.decode(t.slice(i,i+a));i=i+a;const l=r.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(r.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class pV{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Tn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Tn||(Tn={}));const jP=(e,t,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((s,i)=>(s[i]=Fxe(i,e,t,a),s),{})},Fxe=(e,t,n,r)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=n[e];return s&&!r.includes(s)?fV(s,i):CI(i)},fV=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return Bxe(t,n)}switch(e){case Tn.bool:return Pxe(t);case Tn.float4:case Tn.float8:case Tn.int2:case Tn.int4:case Tn.int8:case Tn.numeric:case Tn.oid:return Lxe(t);case Tn.json:case Tn.jsonb:return zxe(t);case Tn.timestamp:return Uxe(t);case Tn.abstime:case Tn.date:case Tn.daterange:case Tn.int4range:case Tn.int8range:case Tn.money:case Tn.reltime:case Tn.text:case Tn.time:case Tn.timestamptz:case Tn.timetz:case Tn.tsrange:case Tn.tstzrange:return CI(t);default:return CI(t)}},CI=e=>e,Pxe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Lxe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},zxe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Bxe=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let s;const i=e.slice(1,n);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>fV(t,o))}return e},Uxe=e=>typeof e=="string"?e.replace(" ","T"):e,mV=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class iC{constructor(t,n,r={},a=hV){this.channel=t,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var AP;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(AP||(AP={}));class gx{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gx.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=gx.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=gx.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,a){const s=this.cloneDeep(t),i=this.transformState(n),o={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const h=s[c];if(h){const p=u.map(y=>y.presence_ref),f=h.map(y=>y.presence_ref),g=u.filter(y=>f.indexOf(y.presence_ref)<0),m=h.filter(y=>p.indexOf(y.presence_ref)<0);g.length>0&&(o[c]=g),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},r,a)}static syncDiff(t,n,r,a){const{joins:s,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const h=t[o].map(f=>f.presence_ref),p=u.filter(f=>h.indexOf(f.presence_ref)<0);t[o].unshift(...p)}r(o,u,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const a=t[r];return"metas"in a?n[r]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=a,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $P;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})($P||($P={}));var RP;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(RP||(RP={}));var Jo;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Jo||(Jo={}));class Qj{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=ha.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new iC(this,Ci.join,this.params,this.timeout),this.rejoinTimer=new pV(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ha.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ha.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ha.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ha.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ci.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new gx(this),this.broadcastEndpointURL=mV(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ha.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(u=>t==null?void 0:t(Jo.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(Jo.CLOSED));const l={},c={broadcast:s,presence:i,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){t==null||t(Jo.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,f=(h=p==null?void 0:p.length)!==null&&h!==void 0?h:0,g=[];for(let m=0;m<f;m++){const y=p[m],{filter:{event:x,schema:v,table:b,filter:w}}=y,k=u&&u[m];if(k&&k.event===x&&k.schema===v&&k.table===b&&k.filter===w)g.push(Object.assign(Object.assign({},y),{id:k.id}));else{this.unsubscribe(),this.state=ha.errored,t==null||t(Jo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Jo.SUBSCRIBED);return}}).receive("error",u=>{this.state=ha.errored,t==null||t(Jo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Jo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this._on(t,n,r)}async send(t,n={}){var r,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ha.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ci.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new iC(this,Ci.leave,{},t),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,n,r){const a=new AbortController,s=setTimeout(()=>a.abort(),r),i=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(s),i}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new iC(this,t,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Ci;if(r&&[o,l,c,u].indexOf(i)>=0&&r!==this._joinRef())return;let p=this._onMessage(i,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(f=>{var g,m,y;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(m=f.filter)===null||m===void 0?void 0:m.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(f=>f.callback(p,r)):(s=this.bindings[i])===null||s===void 0||s.filter(f=>{var g,m,y,x,v,b;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in f){const w=f.id,k=(g=f.filter)===null||g===void 0?void 0:g.event;return w&&((m=n.ids)===null||m===void 0?void 0:m.includes(w))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const w=(v=(x=f==null?void 0:f.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return w==="*"||w===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===i}).map(f=>{if(typeof p=="object"&&"ids"in p){const g=p.data,{schema:m,table:y,commit_timestamp:x,type:v,errors:b}=g;p=Object.assign(Object.assign({},{schema:m,table:y,commit_timestamp:x,eventType:v,new:{},old:{},errors:b}),this._getPayloadRecords(g))}f.callback(p,r)})}_isClosed(){return this.state===ha.closed}_isJoined(){return this.state===ha.joined}_isJoining(){return this.state===ha.joining}_isLeaving(){return this.state===ha.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const a=t.toLocaleLowerCase(),s={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Qj.isEqual(a.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ci.close,{},t)}_onError(t){this._on(Ci.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ha.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=jP(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=jP(t.columns,t.old_record)),n}}const DP=()=>{},Wxe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Vxe{constructor(t,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=hV,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=DP,this.ref=0,this.logger=DP,this.conn=null,this.sendBuffer=[],this.serializer=new Oxe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>Bv(async()=>{const{default:l}=await Promise.resolve().then(()=>Vm);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${t}/${_I.websocket}`,this.httpEndpoint=mV(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,i)=>i(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new pV(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Axe),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Dxe}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case mx.connecting:return Uc.Connecting;case mx.open:return Uc.Open;case mx.closing:return Uc.Closing;default:return Uc.Closed}}isConnected(){return this.connectionState()===Uc.Open}channel(t,n={config:{}}){const r=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===r);if(a)return a;{const s=new Qj(`realtime:${t}`,n,this);return this.channels.push(s),s}}push(t){const{topic:n,event:r,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${n} ${r} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:Rxe};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(Ci.access_token,{access_token:n})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(Mxe,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:r,event:a,payload:s,ref:i}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${a} ${i&&"("+i+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(r)).forEach(o=>o._trigger(a,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ci.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${t}${r}${a}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([Wxe],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Xj extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ur(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Hxe extends Xj{constructor(t,n){super(t),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class II extends Xj{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var Gxe=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};const gV=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Bv(async()=>{const{default:r}=await Promise.resolve().then(()=>Vm);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},qxe=()=>Gxe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Bv(()=>Promise.resolve().then(()=>Vm),void 0)).Response:Response}),EI=e=>{if(Array.isArray(e))return e.map(n=>EI(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=EI(r)}),t};var rh=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};const oC=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Kxe=(e,t,n)=>rh(void 0,void 0,void 0,function*(){const r=yield qxe();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(a=>{t(new Hxe(oC(a),e.status||500))}).catch(a=>{t(new II(oC(a),a))}):t(new II(oC(e),e))}),Qxe=(e,t,n,r)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function Wv(e,t,n,r,a,s){return rh(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(n,Qxe(t,r,a,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>Kxe(l,o,r))})})}function S1(e,t,n,r){return rh(this,void 0,void 0,function*(){return Wv(e,"GET",t,n,r)})}function Xl(e,t,n,r,a){return rh(this,void 0,void 0,function*(){return Wv(e,"POST",t,r,a,n)})}function Xxe(e,t,n,r,a){return rh(this,void 0,void 0,function*(){return Wv(e,"PUT",t,r,a,n)})}function Yxe(e,t,n,r){return rh(this,void 0,void 0,function*(){return Wv(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function yV(e,t,n,r,a){return rh(this,void 0,void 0,function*(){return Wv(e,"DELETE",t,r,a,n)})}var Xa=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};const Jxe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},MP={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Zxe{constructor(t,n={},r,a){this.url=t,this.headers=n,this.bucketId=r,this.fetch=gV(a)}uploadOrUpdate(t,n,r,a){return Xa(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},MP),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(n),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),p=yield h.json();return h.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(s){if(Ur(s))return{data:null,error:s};throw s}})}upload(t,n,r){return Xa(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,a){return Xa(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",n);try{let l;const c=Object.assign({upsert:MP.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),p=yield h.json();return h.ok?{data:{path:s,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(Ur(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,n){return Xa(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const s=yield Xl(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new Xj("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(r){if(Ur(r))return{data:null,error:r};throw r}})}update(t,n,r){return Xa(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return Xa(this,void 0,void 0,function*(){try{return{data:yield Xl(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Ur(a))return{data:null,error:a};throw a}})}copy(t,n,r){return Xa(this,void 0,void 0,function*(){try{return{data:{path:(yield Xl(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Ur(a))return{data:null,error:a};throw a}})}createSignedUrl(t,n,r){return Xa(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Xl(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(Ur(a))return{data:null,error:a};throw a}})}createSignedUrls(t,n,r){return Xa(this,void 0,void 0,function*(){try{const a=yield Xl(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(Ur(a))return{data:null,error:a};throw a}})}download(t,n){return Xa(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield S1(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Ur(o))return{data:null,error:o};throw o}})}info(t){return Xa(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield S1(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:EI(r),error:null}}catch(r){if(Ur(r))return{data:null,error:r};throw r}})}exists(t){return Xa(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield Yxe(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Ur(r)&&r instanceof II){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),a=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&a.push(s);const o=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${c}`)}}}remove(t){return Xa(this,void 0,void 0,function*(){try{return{data:yield yV(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(Ur(n))return{data:null,error:n};throw n}})}list(t,n,r){return Xa(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Jxe),n),{prefix:t||""});return{data:yield Xl(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Ur(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const eve="2.7.1",tve={"X-Client-Info":`storage-js/${eve}`};var Vp=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};class nve{constructor(t,n={},r){this.url=t,this.headers=Object.assign(Object.assign({},tve),n),this.fetch=gV(r)}listBuckets(){return Vp(this,void 0,void 0,function*(){try{return{data:yield S1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Ur(t))return{data:null,error:t};throw t}})}getBucket(t){return Vp(this,void 0,void 0,function*(){try{return{data:yield S1(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(Ur(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return Vp(this,void 0,void 0,function*(){try{return{data:yield Xl(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ur(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return Vp(this,void 0,void 0,function*(){try{return{data:yield Xxe(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ur(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Vp(this,void 0,void 0,function*(){try{return{data:yield Xl(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Ur(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Vp(this,void 0,void 0,function*(){try{return{data:yield yV(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(Ur(n))return{data:null,error:n};throw n}})}}class rve extends nve{constructor(t,n={},r){super(t,n,r)}from(t){return new Zxe(this.url,this.headers,t,this.fetch)}}const ave="2.51.0";let Gy="";typeof Deno<"u"?Gy="deno":typeof document<"u"?Gy="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Gy="react-native":Gy="node";const sve={"X-Client-Info":`supabase-js-${Gy}/${ave}`},ive={headers:sve},ove={schema:"public"},lve={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uve={};var cve=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};const dve=e=>{let t;return e?t=e:typeof fetch>"u"?t=tV:t=fetch,(...n)=>t(...n)},hve=()=>typeof Headers>"u"?nV:Headers,pve=(e,t,n)=>{const r=dve(n),a=hve();return(s,i)=>cve(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},i),{headers:c}))})};var fve=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};function mve(e){return e.endsWith("/")?e:e+"/"}function gve(e,t){var n,r;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:h}=t,p={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=o==null?void 0:o.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>fve(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const xV="2.71.0",Zp=30*1e3,TI=3,lC=TI*Zp,yve="http://localhost:9999",xve="supabase.auth.token",vve={"X-Client-Info":`gotrue-js/${xV}`},jI="X-Supabase-Api-Version",vV={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bve=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wve=10*60*1e3;class Yj extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function $t(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Nve extends Yj{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function kve(e){return $t(e)&&e.name==="AuthApiError"}class bV extends Yj{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class pc extends Yj{constructor(t,n,r,a){super(t,r,a),this.name=n,this.status=r}}class Vl extends pc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Sve(e){return $t(e)&&e.name==="AuthSessionMissingError"}class Rw extends pc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Dw extends pc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Mw extends pc{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _ve(e){return $t(e)&&e.name==="AuthImplicitGrantRedirectError"}class OP extends pc{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AI extends pc{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function uC(e){return $t(e)&&e.name==="AuthRetryableFetchError"}class FP extends pc{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class $I extends pc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const _1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),PP=` 	
\r=`.split(""),Cve=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<PP.length;t+=1)e[PP[t].charCodeAt(0)]=-2;for(let t=0;t<_1.length;t+=1)e[_1[t].charCodeAt(0)]=t;return e})();function LP(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(_1[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(_1[r]),t.queuedBits-=6}}function wV(e,t,n){const r=Cve[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function zP(e){const t=[],n=i=>{t.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{Tve(i,r,n)};for(let i=0;i<e.length;i+=1)wV(e.charCodeAt(i),a,s);return t.join("")}function Ive(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Eve(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}Ive(r,t)}}function Tve(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function jve(e){const t=[],n={queue:0,queuedBits:0},r=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)wV(e.charCodeAt(a),n,r);return new Uint8Array(t)}function Ave(e){const t=[];return Eve(e,n=>t.push(n)),new Uint8Array(t)}function $ve(e){const t=[],n={queue:0,queuedBits:0},r=a=>{t.push(a)};return e.forEach(a=>LP(a,n,r)),LP(null,n,r),t.join("")}function Rve(e){return Math.round(Date.now()/1e3)+e}function Dve(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const xi=()=>typeof window<"u"&&typeof document<"u",Ac={tested:!1,writable:!1},NV=()=>{if(!xi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ac.tested)return Ac.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ac.tested=!0,Ac.writable=!0}catch{Ac.tested=!0,Ac.writable=!1}return Ac.writable};function Mve(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return n.searchParams.forEach((r,a)=>{t[a]=r}),t}const kV=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Bv(async()=>{const{default:r}=await Promise.resolve().then(()=>Vm);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},Ove=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ef=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},$c=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ll=async(e,t)=>{await e.removeItem(t)};class yk{constructor(){this.promise=new yk.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}yk.promiseConstructor=Promise;function cC(e){const t=e.split(".");if(t.length!==3)throw new $I("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!bve.test(t[r]))throw new $I("JWT not in base64url format");return{header:JSON.parse(zP(t[0])),payload:JSON.parse(zP(t[1])),signature:jve(t[2]),raw:{header:t[0],payload:t[1]}}}async function Fve(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Pve(e,t){return new Promise((r,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){r(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function Lve(e){return("0"+e.toString(16)).substr(-2)}function zve(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let s=0;s<56;s++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(t),Array.from(t,Lve).join("")}async function Bve(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function Uve(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await Bve(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Hp(e,t,n=!1){const r=zve();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await ef(e,`${t}-code-verifier`,a);const s=await Uve(r);return[s,r===s?"plain":"s256"]}const Wve=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Vve(e){const t=e.headers.get(jI);if(!t||!t.match(Wve))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Hve(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Gve(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const qve=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Gp(e){if(!qve.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dC(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var Kve=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};const Pc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qve=[502,503,504];async function BP(e){var t;if(!Ove(e))throw new AI(Pc(e),0);if(Qve.includes(e.status))throw new AI(Pc(e),e.status);let n;try{n=await e.json()}catch(s){throw new bV(Pc(s),s)}let r;const a=Vve(e);if(a&&a.getTime()>=vV["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new FP(Pc(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new Vl}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new FP(Pc(n),e.status,n.weak_password.reasons);throw new Nve(Pc(n),e.status||500,r)}const Xve=(e,t,n,r)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function Gt(e,t,n,r){var a;const s=Object.assign({},r==null?void 0:r.headers);s[jI]||(s[jI]=vV["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const i=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await Yve(e,t,n+o,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Yve(e,t,n,r,a,s){const i=Xve(t,r,a,s);let o;try{o=await e(n,Object.assign({},i))}catch(l){throw console.error(l),new AI(Pc(l),0)}if(o.ok||await BP(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await BP(l)}}function Xo(e){var t;let n=null;tbe(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=Rve(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function UP(e){const t=Xo(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function tu(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Jve(e){return{data:e,error:null}}function Zve(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s}=e,i=Kve(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function ebe(e){return e}function tbe(e){return e.access_token&&e.refresh_token&&e.expires_in}const hC=["global","local","others"];var nbe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};class rbe{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=kV(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n=hC[0]){if(hC.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hC.join(", ")}`);try{return await Gt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if($t(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await Gt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:tu})}catch(r){if($t(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=nbe(t,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Gt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Zve,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if($t(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Gt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:tu})}catch(n){if($t(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Gt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:ebe});if(u.error)throw u.error;const h=await u.json(),p=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);c[`${y}Page`]=m}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if($t(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Gp(t);try{return await Gt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:tu})}catch(n){if($t(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Gp(t);try{return await Gt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:tu})}catch(r){if($t(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){Gp(t);try{return await Gt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:tu})}catch(r){if($t(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){Gp(t.userId);try{const{data:n,error:r}=await Gt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if($t(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Gp(t.userId),Gp(t.id);try{return{data:await Gt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if($t(n))return{data:null,error:n};throw n}}}function WP(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function abe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const qp={debug:!!(globalThis&&NV()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class SV extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class sbe extends SV{}async function ibe(e,t,n){qp.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),qp.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){qp.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await n()}finally{qp.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw qp.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new sbe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(qp.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}abe();const obe={url:yve,storageKey:xve,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vve,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function VP(e,t,n){return await n()}const Kp={};class Qx{constructor(t){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Qx.nextInstanceID,Qx.nextInstanceID+=1,this.instanceID>0&&xi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},obe),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new rbe({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=kV(a.fetch),this.lock=a.lock||VP,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:xi()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=ibe:this.lock=VP,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:NV()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=WP(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=WP(this.memoryStorage)),xi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,n;return(n=(t=Kp[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Kp[this.storageKey]=Object.assign(Object.assign({},Kp[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Kp[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Kp[this.storageKey]=Object.assign(Object.assign({},Kp[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${xV}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=Mve(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),xi()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),_ve(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return $t(n)?{error:n}:{error:new bV("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,a;try{const s=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Xo}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if($t(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var n,r,a;try{let s;if("email"in t){const{email:u,password:h,options:p}=t;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await Hp(this.storage,this.storageKey)),s=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:f,code_challenge_method:g},xform:Xo})}else if("phone"in t){const{phone:u,password:h,options:p}=t;s=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Xo})}else throw new Dw("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if($t(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let n;if("email"in t){const{email:s,password:i,options:o}=t;n=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:UP})}else if("phone"in t){const{phone:s,password:i,options:o}=t;n=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:UP})}else throw new Dw("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Rw}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if($t(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;if(n==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(t){var n,r,a,s,i,o,l,c,u,h,p,f;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:y,wallet:x,statement:v,options:b}=t;let w;if(xi())if(typeof x=="object")w=x;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))w=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=x}const k=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const I=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),v?{statement:v}:null));let C;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")C=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)C=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)g=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${k.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(a=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const I=await w.signMessage(new TextEncoder().encode(g),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=I}}try{const{data:y,error:x}=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:$ve(m)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Xo});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Rw}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if($t(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const n=await $c(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:s,error:i}=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Xo});if(await Ll(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Rw}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if($t(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:n,provider:r,token:a,access_token:s,nonce:i}=t,o=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Xo}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Rw}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(n){if($t(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Hp(this.storage,this.storageKey));const{error:h}=await Gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Dw("You must provide either an email or phone number.")}catch(o){if($t(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var n,r;try{let a,s;"options"in t&&(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo,s=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:o}=await Gt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Xo});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if($t(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var n,r,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Hp(this.storage,this.storageKey)),await Gt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:Jve})}catch(s){if($t(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new Vl;const{error:a}=await Gt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if($t(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:a,options:s}=t,{error:i}=await Gt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:r,type:a,options:s}=t,{data:i,error:o}=await Gt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Dw("You must provide either an email or phone number and a type")}catch(n){if($t(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await $c(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<lC:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const i=await $c(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=dC()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:tu}):await this._useSession(async n=>{var r,a,s;const{data:i,error:o}=n;if(o)throw o;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vl}:await Gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:tu})})}catch(n){if($t(n))return Sve(n)&&(await this._removeSession(),await Ll(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:a,error:s}=r;if(s)throw s;if(!a.session)throw new Vl;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Hp(this.storage,this.storageKey));const{data:c,error:u}=await Gt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:tu});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if($t(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Vl;const n=Date.now()/1e3;let r=n,a=!0,s=null;const{payload:i}=cC(t.access_token);if(i.exp&&(r=i.exp,a=r<=n),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if($t(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:i,error:o}=n;if(o)throw o;t=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new Vl;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if($t(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!xi())throw new Mw("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Mw(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new OP("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Mw("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new OP("No code detected.");const{data:v,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new Mw("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let p=u+h;l&&(p=parseInt(l));const f=p-u;f*1e3<=Zp&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=p-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,p,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,p,u);const{data:m,error:y}=await this._getUser(s);if(y)throw y;const x={provider_token:r,provider_refresh_token:a,access_token:s,expires_in:h,expires_at:p,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(r){if($t(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await $c(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{error:s};const i=(r=a.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(kve(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Ll(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=Dve(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,a;try{const{data:{session:s},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await Hp(this.storage,this.storageKey,!0));try{return await Gt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if($t(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if($t(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:a}=await this._useSession(async s=>{var i,o,l,c,u;const{data:h,error:p}=s;if(p)throw p;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Gt(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return xi()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if($t(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,a;const{data:s,error:i}=n;if(i)throw i;return await Gt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if($t(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Pve(async a=>(a>0&&await Fve(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Gt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Xo})),(a,s)=>{const i=200*Math.pow(2,a);return s&&uC(s)&&Date.now()+i-r<Zp})}catch(r){if(this._debug(n,"error",r),$t(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),xi()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await $c(this.storage,this.storageKey);if(a&&this.userStorage){let i=await $c(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await ef(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:dC()}else if(a&&!a.user&&!a.user){const i=await $c(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await Ll(this.storage,this.storageKey+"-user"),await ef(this.storage,this.storageKey,a)):a.user=dC()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const s=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<lC;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${lC}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),uC(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new Vl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new yk;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Vl;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),$t(s)){const i={session:null,error:s};return uC(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,n,r=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,n)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await ef(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const s=structuredClone(a);await ef(this.storage,this.storageKey,s)}else{const a=structuredClone(n);await ef(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ll(this.storage,this.storageKey),await Ll(this.storage,this.storageKey+"-code-verifier"),await Ll(this.storage,this.storageKey+"-user"),this.userStorage&&await Ll(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&xi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Zp);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-t)/Zp);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Zp}ms, refresh threshold is ${TI} ticks`),a<=TI&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof SV)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,i]=await Hp(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);a.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await Gt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if($t(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,a;const{data:s,error:i}=n;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Gt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if($t(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{data:null,error:s};const{data:i,error:o}=await Gt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(n){if($t(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await Gt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if($t(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],a=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=cC(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(o=>o.kid===t);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(o=>o.kid===t),r&&this.jwks_cached_at+wve>a)return r;const{data:s,error:i}=await Gt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,r=s.keys.find(o=>o.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};r=f.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=cC(r);n!=null&&n.allowExpired||Hve(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:s,header:a,signature:i},error:null}}const u=Gve(a.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,Ave(`${o}.${l}`)))throw new $I("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(r){if($t(r))return{data:null,error:r};throw r}}}Qx.nextInstanceID=0;const lbe=Qx;class ube extends lbe{constructor(t){super(t)}}var cbe=function(e,t,n,r){function a(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(u){try{c(r.next(u))}catch(h){i(h)}}function l(u){try{c(r.throw(u))}catch(h){i(h)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((r=r.apply(e,t||[])).next())})};class dbe{constructor(t,n,r){var a,s,i;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const o=mve(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:ove,realtime:uve,auth:Object.assign(Object.assign({},lve),{storageKey:c}),global:ive},h=gve(r??{},u);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=pve(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Txe(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new sxe(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new rve(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return cbe(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:s,flowType:i,lock:o,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ube({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:s,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:a,flowType:i,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Vxe(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const hbe=(e,t,n)=>new dbe(e,t,n),pbe="https://prqzcsajwpipfeqnqhlf.supabase.co",fbe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBycXpjc2Fqd3BpcGZlcW5xaGxmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwMDExNjksImV4cCI6MjA2NzU3NzE2OX0.vb18DnFwvqxCxVIF32FDsB8jY5sJ8iOZEEtrgNELGQQ",Et=hbe(pbe,fbe),_V="admission_dashboard_applicants",mbe=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),CV=()=>new Date().toISOString(),IV=()=>{try{const e=localStorage.getItem(_V),t=e?JSON.parse(e):[];return console.log("getApplicants called, found",t.length,"applicants in localStorage"),t}catch(e){return console.error("Error reading from localStorage:",e),[]}},EV=e=>{try{localStorage.setItem(_V,JSON.stringify(e)),console.log("saveApplicants: saved",e.length,"applicants to localStorage")}catch(t){console.error("Error saving to localStorage:",t)}},gbe=e=>{const t=IV(),n=CV(),r=e.map(s=>({...s,id:mbe(),created_at:n,updated_at:n})),a=[...t,...r];return console.log("addApplicants: adding",e.length,"applicants to",t.length,"existing =",a.length,"total"),EV(a),a},ybe=(e,t)=>{const r=IV().map(a=>e.includes(a.id)?{...a,...t,updated_at:CV()}:a);return EV(r),r},xbe={contact:[],screening:[{value:"pending",label:"Pending"},{value:"pass",label:"Pass"},{value:"fail",label:"Fail"}],interviews:[{value:"pending",label:"Pending"},{value:"booked",label:"Booked"},{value:"rescheduled",label:"Rescheduled"},{value:"lr_qualified",label:"LR Qualified"},{value:"lr_failed",label:"LR Failed"},{value:"cfr_qualified",label:"CFR Qualified"},{value:"cfr_failed",label:"CFR Failed"}],decision:[{value:"offer_pending",label:"Offer Pending"},{value:"offer_sent",label:"Offer Sent"},{value:"offer_rejected",label:"Offer Rejected"},{value:"offer_accepted",label:"Offer Accepted"}]};function vbe({selectedApplicants:e,isOpen:t,onClose:n,onSuccess:r}){const[a,s]=N.useState({stage:"no_change",status:"no_change",campus:"no_change"}),[i,o]=N.useState([]),[l,c]=N.useState(!1),{toast:u}=Qt();N.useEffect(()=>{t&&h()},[t]);const h=async()=>{try{const{data:m,error:y}=await Et.from("campus_options").select("*").eq("is_active",!0).order("name");if(y)throw y;o(m||[])}catch(m){console.error("Error fetching campus options:",m)}},p=m=>{s(y=>({...y,stage:m,status:m==="contact"?"no_change":"pending"}))},f=async()=>{if(a.stage==="no_change"&&a.campus==="no_change"){u({title:"Error",description:"Please select at least a stage or campus to update",variant:"destructive"});return}c(!0);try{const m={last_updated:new Date().toISOString()};a.stage!=="no_change"&&(m.stage=a.stage,a.status!=="no_change"&&a.stage!=="contact"?m.status=a.status:a.stage==="contact"&&(m.status=null)),a.campus!=="no_change"&&(m.campus=a.campus==="unassigned"?null:a.campus),ybe(e,m);const{error:y}=await Et.from("admission_dashboard").update(m).in("id",e);y&&console.warn("Supabase bulk update failed, but data saved to localStorage:",y),u({title:"Success",description:`Updated ${e.length} applicant(s) successfully and saved to localStorage`}),r(),n(),s({stage:"no_change",status:"no_change",campus:"no_change"})}catch(m){console.error("Error bulk updating applicants:",m),u({title:"Error",description:"Failed to update applicants",variant:"destructive"})}finally{c(!1)}},g=xbe[a.stage]||[];return d.jsx(ta,{open:t,onOpenChange:n,children:d.jsxs(na,{className:"max-w-md",children:[d.jsx(ka,{children:d.jsxs(ra,{className:"flex items-center gap-2",children:[d.jsx(kd,{className:"w-5 h-5"}),"Bulk Update - ",e.length," Applicant(s)"]})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"bg-muted/50 p-3 rounded-lg",children:d.jsxs("p",{className:"text-sm text-muted-foreground",children:["This will update the selected fields for ",e.length," selected applicant(s). Leave fields empty to keep them unchanged."]})}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Stage (Optional)"}),d.jsxs(vt,{value:a.stage,onValueChange:p,children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select new stage (optional)"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"no_change",children:"No change"}),d.jsx(Ee,{value:"contact",children:"Contact"}),d.jsx(Ee,{value:"screening",children:"Screening"}),d.jsx(Ee,{value:"interviews",children:"Interviews"}),d.jsx(Ee,{value:"decision",children:"Decision"})]})]})]}),g.length>0&&a.stage!=="no_change"&&d.jsxs("div",{children:[d.jsx(Pe,{children:"Status"}),d.jsxs(vt,{value:a.status,onValueChange:m=>s(y=>({...y,status:m})),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select new status"})}),d.jsx(ft,{children:g.map(m=>d.jsx(Ee,{value:m.value,children:m.label},m.value))})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Campus (Optional)"}),d.jsxs(vt,{value:a.campus,onValueChange:m=>s(y=>({...y,campus:m})),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select new campus (optional)"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"no_change",children:"No change"}),d.jsx(Ee,{value:"unassigned",children:"Not assigned"}),i.map(m=>d.jsx(Ee,{value:m.name,children:m.name},m.id))]})]})]}),a.stage==="contact"&&d.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:d.jsx("p",{className:"text-sm text-blue-700",children:"Contact stage doesn't have status options. Status will be cleared for selected applicants."})}),d.jsx("div",{className:"flex items-center justify-center py-2",children:d.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[d.jsx("span",{children:"Bulk Update"}),d.jsx(Vae,{className:"w-4 h-4"}),d.jsx("span",{className:"font-medium",children:a.stage!=="no_change"||a.campus!=="no_change"?`${a.stage!=="no_change"?`Stage: ${a.stage.charAt(0).toUpperCase()+a.stage.slice(1)}`:""}${a.stage!=="no_change"&&a.campus!=="no_change"?", ":""}${a.campus!=="no_change"?`Campus: ${a.campus==="unassigned"?"Not assigned":a.campus}`:""}`:"Select fields to update"})]})})]}),d.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[d.jsx(fe,{variant:"outline",onClick:n,children:"Cancel"}),d.jsx(fe,{onClick:f,disabled:l||a.stage==="no_change"&&a.campus==="no_change",children:l?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating..."]}):`Update ${e.length} Applicant(s)`})]})]})})}const bbe={contact:[],screening:[{value:"pending",label:"Pending"},{value:"pass",label:"Pass"},{value:"fail",label:"Fail"}],interviews:[{value:"pending",label:"Pending"},{value:"booked",label:"Booked"},{value:"rescheduled",label:"Rescheduled"},{value:"lr_qualified",label:"LR Qualified"},{value:"lr_failed",label:"LR Failed"},{value:"offer_pending",label:"Offer Pending"},{value:"cfr_failed",label:"CFR Failed"}],decision:[{value:"offer_pending",label:"Offer Pending"},{value:"offer_sent",label:"Offer Sent"},{value:"offer_rejected",label:"Offer Rejected"},{value:"offer_accepted",label:"Offer Accepted"}]};function wbe({applicant:e,isOpen:t,onClose:n,onSuccess:r}){const[a,s]=N.useState({name:"",mobile_no:"",whatsapp_number:"",city:"",stage:"contact",status:"none",campus:"none"}),[i,o]=N.useState(a),[l,c]=N.useState([]),[u,h]=N.useState(!1),[p,f]=N.useState(!1),[g,m]=N.useState(null),{toast:y}=Qt();N.useEffect(()=>{if(e&&t){const C={name:e.name||"",mobile_no:e.mobile_no||"",whatsapp_number:e.whatsapp_number||"",city:e.city||"",stage:e.stage||"contact",status:e.status||"none",campus:e.campus||"none"};s(C),o(C),f(!1),g&&(clearTimeout(g),m(null))}},[e,t]),N.useEffect(()=>{t&&x()},[t]);const x=async()=>{try{const{data:C,error:S}=await Et.from("campus_options").select("*").eq("is_active",!0).order("name");if(S)throw S;c(C||[])}catch(C){console.error("Error fetching campus options:",C)}},v=(C,S)=>{s(E=>({...E,[C]:S}))},b=C=>{s(S=>({...S,stage:C,status:C==="contact"?"none":"pending"}))},w=async()=>{if(e){h(!0);try{const{error:C}=await Et.from("admission_dashboard").update({name:a.name||null,mobile_no:a.mobile_no,whatsapp_number:a.whatsapp_number||null,city:a.city||null,stage:a.stage,status:a.status==="none"?null:a.status,campus:a.campus==="none"?null:a.campus,last_updated:new Date().toISOString()}).eq("id",e.id);if(C)throw C;y({title:"Success",description:"Applicant updated successfully"}),f(!0);const S=setTimeout(()=>{f(!1),m(null)},5e3);m(S),r(),n()}catch(C){console.error("Error updating applicant:",C),y({title:"Error",description:"Failed to update applicant",variant:"destructive"})}finally{h(!1)}}},k=async()=>{if(e)try{const{error:C}=await Et.from("admission_dashboard").update({name:i.name||null,mobile_no:i.mobile_no,whatsapp_number:i.whatsapp_number||null,city:i.city||null,stage:i.stage,status:i.status==="none"?null:i.status,campus:i.campus==="none"?null:i.campus,last_updated:new Date().toISOString()}).eq("id",e.id);if(C)throw C;y({title:"Undone",description:"Changes have been reverted"}),f(!1),g&&(clearTimeout(g),m(null)),r()}catch(C){console.error("Error undoing changes:",C),y({title:"Error",description:"Failed to undo changes",variant:"destructive"})}},I=bbe[a.stage]||[];return d.jsxs(d.Fragment,{children:[d.jsx(ta,{open:t,onOpenChange:n,children:d.jsxs(na,{className:"max-w-md",children:[d.jsx(ka,{children:d.jsxs(ra,{children:["Quick Edit - ",(e==null?void 0:e.name)||"Applicant"]})}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"name",children:"Name"}),d.jsx(Je,{id:"name",value:a.name,onChange:C=>v("name",C.target.value),placeholder:"Enter name"})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"mobile",children:"Mobile Number"}),d.jsx(Je,{id:"mobile",value:a.mobile_no,onChange:C=>v("mobile_no",C.target.value),placeholder:"Enter mobile number",required:!0})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"whatsapp",children:"WhatsApp Number"}),d.jsx(Je,{id:"whatsapp",value:a.whatsapp_number,onChange:C=>v("whatsapp_number",C.target.value),placeholder:"Enter WhatsApp number"})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"city",children:"City"}),d.jsx(Je,{id:"city",value:a.city,onChange:C=>v("city",C.target.value),placeholder:"Enter city"})]}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Stage"}),d.jsxs(vt,{value:a.stage,onValueChange:b,children:[d.jsx(pt,{children:d.jsx(bt,{})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"contact",children:"Contact"}),d.jsx(Ee,{value:"screening",children:"Screening"}),d.jsx(Ee,{value:"interviews",children:"Interviews"}),d.jsx(Ee,{value:"decision",children:"Decision"})]})]})]}),I.length>0&&d.jsxs("div",{children:[d.jsx(Pe,{children:"Status"}),d.jsxs(vt,{value:a.status,onValueChange:C=>v("status",C),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select status"})}),d.jsx(ft,{children:I.map(C=>d.jsx(Ee,{value:C.value,children:C.label},C.value))})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Campus"}),d.jsxs(vt,{value:a.campus,onValueChange:C=>v("campus",C),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select campus"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"none",children:"Not assigned"}),l.map(C=>d.jsx(Ee,{value:C.name,children:C.name},C.id))]})]})]})]}),d.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[d.jsx(fe,{variant:"outline",onClick:n,children:"Cancel"}),d.jsx(fe,{onClick:w,disabled:u,children:u?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Rm,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})}),p&&d.jsxs("div",{className:"fixed bottom-4 right-4 bg-card border border-border rounded-lg shadow-lg p-4 flex items-center space-x-3 z-50",children:[d.jsx("span",{className:"text-sm",children:"Changes saved successfully"}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:k,children:[d.jsx(mie,{className:"w-4 h-4 mr-1"}),"Undo"]}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>f(!1),children:d.jsx(us,{className:"w-4 h-4"})})]})]})}var TV={exports:{}},jV={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var im=N;function Nbe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kbe=typeof Object.is=="function"?Object.is:Nbe,Sbe=im.useState,_be=im.useEffect,Cbe=im.useLayoutEffect,Ibe=im.useDebugValue;function Ebe(e,t){var n=t(),r=Sbe({inst:{value:n,getSnapshot:t}}),a=r[0].inst,s=r[1];return Cbe(function(){a.value=n,a.getSnapshot=t,pC(a)&&s({inst:a})},[e,n,t]),_be(function(){return pC(a)&&s({inst:a}),e(function(){pC(a)&&s({inst:a})})},[e]),Ibe(n),n}function pC(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!kbe(e,n)}catch{return!0}}function Tbe(e,t){return t()}var jbe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Tbe:Ebe;jV.useSyncExternalStore=im.useSyncExternalStore!==void 0?im.useSyncExternalStore:jbe;TV.exports=jV;var Abe=TV.exports;function $be(){return Abe.useSyncExternalStore(Rbe,()=>!0,()=>!1)}function Rbe(){return()=>{}}var Jj="Avatar",[Dbe,Hat]=ia(Jj),[Mbe,AV]=Dbe(Jj),$V=N.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,s]=N.useState("idle");return d.jsx(Mbe,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:s,children:d.jsx(Qe.span,{...r,ref:t})})});$V.displayName=Jj;var RV="AvatarImage",DV=N.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...s}=e,i=AV(RV,n),o=Obe(r,s),l=rr(c=>{a(c),i.onImageLoadingStatusChange(c)});return fr(()=>{o!=="idle"&&l(o)},[o,l]),o==="loaded"?d.jsx(Qe.img,{...s,ref:t,src:r}):null});DV.displayName=RV;var MV="AvatarFallback",OV=N.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,s=AV(MV,n),[i,o]=N.useState(r===void 0);return N.useEffect(()=>{if(r!==void 0){const l=window.setTimeout(()=>o(!0),r);return()=>window.clearTimeout(l)}},[r]),i&&s.imageLoadingStatus!=="loaded"?d.jsx(Qe.span,{...a,ref:t}):null});OV.displayName=MV;function HP(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Obe(e,{referrerPolicy:t,crossOrigin:n}){const r=$be(),a=N.useRef(null),s=r?(a.current||(a.current=new window.Image),a.current):null,[i,o]=N.useState(()=>HP(s,e));return fr(()=>{o(HP(s,e))},[s,e]),fr(()=>{const l=h=>()=>{o(h)};if(!s)return;const c=l("loaded"),u=l("error");return s.addEventListener("load",c),s.addEventListener("error",u),t&&(s.referrerPolicy=t),typeof n=="string"&&(s.crossOrigin=n),()=>{s.removeEventListener("load",c),s.removeEventListener("error",u)}},[s,n,t]),i}var FV=$V,PV=DV,LV=OV;const Zj=N.forwardRef(({className:e,...t},n)=>d.jsx(FV,{ref:n,className:Fe("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));Zj.displayName=FV.displayName;const zV=N.forwardRef(({className:e,...t},n)=>d.jsx(PV,{ref:n,className:Fe("aspect-square h-full w-full",e),...t}));zV.displayName=PV.displayName;const eA=N.forwardRef(({className:e,...t},n)=>d.jsx(LV,{ref:n,className:Fe("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));eA.displayName=LV.displayName;const BV=({applicantId:e,applicantName:t,isOpen:n,onClose:r})=>{const[a,s]=N.useState(""),[i,o]=N.useState(null),{toast:l}=Qt();Tv();const{user:c}=Gs();N.useEffect(()=>{(async()=>{c&&o({id:c.id,name:c.name||c.email||"Unknown User"})})()},[c]);const{data:u,refetch:h}=nh({queryKey:["applicant-comments",e],queryFn:async()=>{const{data:m,error:y}=await Et.from("applicant_comments").select("*").eq("applicant_id",e).order("created_at",{ascending:!1});if(y)throw y;return m},enabled:n}),p=If({mutationFn:async m=>{if(!i)throw new Error("User not authenticated");const{error:y}=await Et.from("applicant_comments").insert({applicant_id:e,user_id:i.id,user_name:i.name,comment_text:m});if(y)throw y;await Et.from("system_logs").insert({user_id:i.id,user_name:i.name,action_type:"comment_added",entity_type:"applicant",entity_id:e,description:`Added comment to applicant ${t}`,metadata:{comment_text:m}})},onSuccess:()=>{l({title:"Comment Added",description:"Your comment has been successfully added"}),s(""),h()},onError:()=>{l({title:"Error",description:"Failed to add comment",variant:"destructive"})}}),f=If({mutationFn:async m=>{const{error:y}=await Et.from("applicant_comments").delete().eq("id",m);if(y)throw y;i&&await Et.from("system_logs").insert({user_id:i.id,user_name:i.name,action_type:"comment_deleted",entity_type:"applicant",entity_id:e,description:`Deleted comment from applicant ${t}`})},onSuccess:()=>{l({title:"Comment Deleted",description:"Comment has been successfully deleted"}),h()},onError:()=>{l({title:"Error",description:"Failed to delete comment",variant:"destructive"})}}),g=()=>{a.trim()&&i&&p.mutate(a.trim())};return d.jsx(ta,{open:n,onOpenChange:r,children:d.jsxs(na,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[d.jsx(ka,{children:d.jsxs(ra,{className:"flex items-center gap-2",children:[d.jsx(Ux,{className:"h-5 w-5"}),"Comments for ",t]})}),d.jsx("div",{className:"flex-1 overflow-auto space-y-4",children:(u==null?void 0:u.length)===0?d.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No comments yet. Be the first to add one!"}):u==null?void 0:u.map(m=>d.jsxs(Ct,{children:[d.jsx(Vt,{className:"pb-2",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Zj,{className:"h-8 w-8",children:d.jsx(eA,{children:m.user_name.charAt(0).toUpperCase()})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium",children:m.user_name}),d.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(m.created_at).toLocaleString()})]})]}),(i==null?void 0:i.id)===m.user_id&&d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>f.mutate(m.id),disabled:f.isPending,children:d.jsx(Na,{className:"h-4 w-4"})})]})}),d.jsx(It,{children:d.jsx("p",{className:"text-sm",children:m.comment_text})})]},m.id))}),d.jsxs("div",{className:"border-t pt-4 space-y-4",children:[d.jsx(As,{placeholder:"Add a comment...",value:a,onChange:m=>s(m.target.value),className:"min-h-[80px]"}),d.jsx("div",{className:"flex justify-end",children:d.jsxs(fe,{onClick:g,disabled:!a.trim()||p.isPending,children:[d.jsx(aie,{className:"h-4 w-4 mr-2"}),p.isPending?"Adding...":"Add Comment"]})})]})]})})};function Fbe(e){return e?e.map(t=>({id:t.id!==void 0?String(t.id):String(t.value??""),name:t.name??t.label??String(t.value??"")})):[]}function Bn({applicant:e,field:t,displayValue:n,value:r,onUpdate:a,showPencil:s=!1,options:i,showActionButtons:o=!0,disabled:l,renderInput:c,tooltipMessage:u}){const[h,p]=N.useState(null),[f,g]=N.useState(r??n??""),[m,y]=N.useState(!1),{toast:x}=Qt();N.useEffect(()=>{g(r??n??"")},[r,n]);const v=(T,$,_)=>{p({id:T,field:$}),g(_??r??n??"")},b=async()=>{if(!(e!=null&&e.id)){console.error("Applicant ID is missing in EditableCell:",e),x({title:"Error",description:"Cannot update: Student ID is missing",variant:"destructive"});return}if((t==="phone_number"||t==="whatsapp_number")&&!/^\d{10}$/.test(f)){x({title:"Invalid Mobile Number",description:"Mobile number must be exactly 10 digits",variant:"destructive"});return}if(!(!h||m)){y(!0);try{const T=String(t).endsWith("_id"),$={};T?$[t]=f===""||f==="none"?null:Number(f):$[t]=f??"",await aP(e.id,$),x({title:"Success",description:"Field updated successfully"}),p(null),a&&a($[t])}catch(T){console.error("Error updating field:",T),x({title:"Error",description:(T==null?void 0:T.message)||"Failed to update field",variant:"destructive"})}finally{y(!1)}}},w=()=>{p(null),g("")},k=async T=>{if(!(e!=null&&e.id)){console.error("Applicant ID is missing in EditableCell:",e),x({title:"Error",description:"Cannot update: Student ID is missing",variant:"destructive"});return}if(!m){y(!0);try{const $=String(t).endsWith("_id"),_={};T==="none"||T===""?_[t]=null:$?_[t]=Number(T):_[t]=T,await aP(e.id,_),x({title:"Success",description:"Field updated successfully"}),g(_[t]),a&&a(_[t])}catch($){console.error("Error updating field:",$),x({title:"Error",description:($==null?void 0:$.message)||"Failed to update field",variant:"destructive"})}finally{y(!1)}}},I=()=>r!=null?String(r):"none",C=(h==null?void 0:h.id)===e.id&&(h==null?void 0:h.field)===t,S=Fbe(i);return S.length>0?d.jsxs(vt,{value:I(),onValueChange:T=>!l&&k(T),disabled:m||l,children:[d.jsx(pt,{className:"h-8 text-xs border-0 shadow-none hover:bg-muted/50 focus:ring-1 focus:ring-ring",children:d.jsx(bt,{placeholder:"Select option",children:m?"Updating...":n||"Select option"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"none",children:d.jsx("span",{className:"text-muted-foreground",children:"Select"})}),S.map(T=>d.jsx(Ee,{value:T.id,children:T.name},T.id))]})]}):C?d.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[c?d.jsx("div",{className:"flex-1 min-w-0",children:c({value:f,onChange:g})}):d.jsx(Je,{value:f??"",onChange:T=>g(T.target.value),onKeyDown:T=>{T.key==="Enter"&&b(),T.key==="Escape"&&w()},className:"h-7 text-xs flex-1  min-w-0",autoFocus:!0,disabled:m||l}),o&&d.jsxs("div",{className:"flex gap-2 mt-1",children:[d.jsx(fe,{size:"sm",onClick:b,className:"h-6 px-2",disabled:m||l,children:m?"...":"✓"}),d.jsx(fe,{size:"sm",variant:"outline",onClick:w,className:"h-6 px-2",disabled:m,children:"✕"})]})]}):d.jsxs("div",{className:`p-1 rounded min-h-[24px] flex items-center gap-2 group ${l?"cursor-default opacity-70":"cursor-pointer hover:bg-muted/50"}`,onClick:()=>{!l&&!m&&v(e.id,t,r??n)},title:l&&u?u:l?"Editing disabled":"Click to edit",children:[d.jsx("span",{className:"flex-1 whitespace-pre-wrap break-words",children:m?"Updating...":n||"Click to add"}),s&&!m&&d.jsx(Fu,{className:"h-3 w-3 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}const Pbe=[{value:"Andhra Pradesh",label:"Andhra Pradesh"},{value:"Arunachal Pradesh",label:"Arunachal Pradesh"},{value:"Assam",label:"Assam"},{value:"Bihar",label:"Bihar"},{value:"Chhattisgarh",label:"Chhattisgarh"},{value:"Goa",label:"Goa"},{value:"Gujarat",label:"Gujarat"},{value:"Haryana",label:"Haryana"},{value:"Himachal Pradesh",label:"Himachal Pradesh"},{value:"Jharkhand",label:"Jharkhand"},{value:"Karnataka",label:"Karnataka"},{value:"Kerala",label:"Kerala"},{value:"Madhya Pradesh",label:"Madhya Pradesh"},{value:"Maharashtra",label:"Maharashtra"},{value:"Manipur",label:"Manipur"},{value:"Meghalaya",label:"Meghalaya"},{value:"Mizoram",label:"Mizoram"},{value:"Nagaland",label:"Nagaland"},{value:"Odisha",label:"Odisha"},{value:"Punjab",label:"Punjab"},{value:"Rajasthan",label:"Rajasthan"},{value:"Sikkim",label:"Sikkim"},{value:"Tamil Nadu",label:"Tamil Nadu"},{value:"Telangana",label:"Telangana"},{value:"Tripura",label:"Tripura"},{value:"Uttar Pradesh",label:"Uttar Pradesh"},{value:"Uttarakhand",label:"Uttarakhand"},{value:"West Bengal",label:"West Bengal"},{value:"Andaman and Nicobar Islands",label:"Andaman and Nicobar Islands"},{value:"Chandigarh",label:"Chandigarh"},{value:"Dadra and Nagar Haveli and Daman & Diu",label:"Dadra and Nagar Haveli and Daman & Diu"},{value:"Delhi",label:"Delhi"},{value:"Jammu and Kashmir",label:"Jammu and Kashmir"},{value:"Ladakh",label:"Ladakh"},{value:"Lakshadweep",label:"Lakshadweep"},{value:"Puducherry",label:"Puducherry"}];function Lbe(e,t,n){if(t.some(a=>["question_set_id","obtained_marks","is_passed","school_id","exam_centre","date_of_test"].includes(a.name))){const a=e.status??e.status_name??void 0,s={question_set_id:e.question_set_id||null,obtained_marks:e.obtained_marks===""?null:e.obtained_marks,school_id:e.school_id||null,exam_centre:e.exam_centre||null,date_of_test:e.date_of_test||null,status:a};return e.id?s:{student_id:n,...s}}return"learning_round_status"in e?e.id?{learning_round_status:e.learning_round_status,comments:e.comments}:{student_id:n,learning_round_status:e.learning_round_status,comments:e.comments}:"cultural_fit_status"in e?e.id?{cultural_fit_status:e.cultural_fit_status,comments:e.comments}:{student_id:n,cultural_fit_status:e.cultural_fit_status,comments:e.comments}:{...e,student_id:n}}const GP=(e,t)=>e.id?t.filter(n=>!!(["status","school_id"].includes(n.name)||["learning_round_status","comments"].includes(n.name)||["cultural_fit_status","comments"].includes(n.name))):t,zbe=({row:e,field:t,isEditable:n,updateRow:r})=>{var a;return t.type==="select"?d.jsxs(vt,{value:e[t.name],onValueChange:s=>r(t.name,s),disabled:!n,children:[d.jsx(pt,{className:`w-full ${n?"":"cursor-text pointer-events-none"}`,children:d.jsx(bt,{placeholder:`Select ${t.label}`})}),d.jsx(ft,{children:(a=t.options)==null?void 0:a.map(s=>d.jsx(Ee,{value:s.value,children:s.label},s.value))})]}):t.type==="component"&&t.component?d.jsx(t.component,{row:e,updateRow:(s,i)=>r(s,i),disabled:!n,className:n?"":"cursor-text pointer-events-none"}):d.jsx(Je,{value:e[t.name],onChange:s=>r(t.name,s.target.value),disabled:!n,className:n?"":"cursor-text"})};function fC({title:e,initialData:t,fields:n,studentId:r,submitApi:a,updateApi:s,onSave:i}){const[o,l]=N.useState(t.map(y=>({...y}))),{toast:c}=Qt();N.useEffect(()=>{l(t.map(y=>({...y})))},[t]);const u=N.useMemo(()=>o.map(y=>new Set(GP(y,n).map(x=>x.name))),[o,n]),h=(y,x,v)=>{l(b=>{const w=[...b];return w[y]={...w[y],[x]:v},w})},p=()=>{const y={};n.forEach(x=>y[x.name]=""),l(x=>[...x,{...y,isEditing:!0}])},f=(y,x)=>{l(v=>{const b=[...v];return b[y].isEditing=x,b})},g=async y=>{const x=o[y],v=GP(x,n);if(!x.id){for(let w of v)if(!x[w.name]||x[w.name].toString().trim()===""){c({title:"Validation Error",description:`Please fill the field: ${w.label}`,variant:"destructive"});return}}const b=Lbe(x,n,r);try{let w;if(x.id){const k=await s(x.id,b);w=typeof k.json=="function"?await k.json():k,c({title:"Updated Successfully",description:"Row updated successfully.",variant:"default"})}else{const k=await a(b);w=typeof k.json=="function"?await k.json():k,c({title:"Created Successfully",description:"Row created successfully.",variant:"default"})}l(k=>{const I=[...k];return I[y]={...x,...w,isEditing:!1},I}),i==null||i()}catch(w){console.error("Save failed",w),c({title:"Save Failed",description:"Something went wrong while saving.",variant:"destructive"})}},m=(y,x)=>{if(x.options){const v=x.options.find(b=>b.value===y[x.name]);return v?v.label:y[x.name]||"—"}return y[x.name]||"—"};return d.jsxs("div",{className:"space-y-3 border rounded-lg p-4",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("h3",{className:"text-base font-semibold",children:e}),d.jsxs(fe,{size:"sm",variant:"outline",onClick:p,children:[d.jsx(Qn,{className:"h-4 w-4 mr-1"})," Add Row"]})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full border-collapse text-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-gray-100 text-left font-medium text-gray-700",children:[n.map(y=>d.jsx("th",{className:"px-3 py-2 border-b",children:y.label},y.name)),d.jsx("th",{className:"px-3 py-2 border-b text-right",children:"Actions"})]})}),d.jsx("tbody",{children:o.map((y,x)=>d.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[n.map(v=>{const b=y.isEditing&&u[x].has(v.name);return d.jsx("td",{className:`px-3 py-2 align-top ${v.name==="comments"?"whitespace-pre-wrap break-words min-w-[150px] max-w-[250px]":""}`,children:!b&&v.type==="readonly"?d.jsx("p",{className:"p-1 bg-gray-100 rounded",children:m(y,v)}):d.jsx(zbe,{row:y,field:v,isEditable:b,updateRow:(w,k)=>h(x,w,k)})},v.name)}),d.jsx("td",{className:"px-3 py-2 text-right",children:y.isEditing?d.jsx(fe,{size:"icon",variant:"ghost",className:"text-green-600 hover:bg-green-50",onClick:()=>g(x),children:d.jsx(Rm,{className:"h-4 w-4"})}):d.jsx(fe,{size:"icon",variant:"ghost",className:"text-blue-600 hover:bg-blue-50",onClick:()=>f(x,!0),children:d.jsx(Fu,{className:"h-4 w-4"})})})]},x))})]})})]})}function Bbe({applicant:e,isOpen:t,onClose:n}){var ke,_e,qe,Ue,it,yt,At,Bt,an,nt,ht,un,er,xe,$n,Pn,sn,tn,Ln,Qa;const[r,a]=N.useState(e),[s,i]=N.useState(!1),[o,l]=N.useState(!1),[c,u]=N.useState(0),[h,p]=N.useState([]),[f,g]=N.useState([]),[m,y]=N.useState([]),[x,v]=N.useState([]),[b,w]=N.useState([]),[k,I]=N.useState(""),[C,S]=N.useState([]),[E,T]=N.useState([]),[$,_]=N.useState([]),[M,L]=N.useState(null),[U,O]=N.useState(null),[F,D]=N.useState(!1),[R,V]=N.useState(!1),[G,W]=N.useState([]),[B,Q]=N.useState(!1),X=De=>{if(!De)return null;if(De.startsWith("S-"))return De;const Le=C.find(Mt=>Mt.label.toUpperCase()===De.toUpperCase());return Le?Le.value:De},pe=De=>{if(!De)return null;if(De.startsWith("D-"))return De;const Le=E.find(Mt=>Mt.label.toUpperCase()===De.toUpperCase());return Le?Le.value:De};N.useEffect(()=>{t&&(async()=>{try{const Le=await XN(),gn=((Le==null?void 0:Le.data)||Le||[]).map(or=>({value:or.state_code,label:or.state_name}));S(gn)}catch{S(Pbe)}})()},[t]),N.useEffect(()=>{if(e!=null&&e.id){if(a(e),e.state){const De=X(e.state);L(De)}if(e.district){const De=pe(e.district);O(De)}}},[e]),N.useEffect(()=>{t&&(e!=null&&e.id)&&(async()=>{try{const Le=await rP(e.id);let Mt=Le;if(Le&&typeof Le=="object"&&"data"in Le&&(Mt=Le.data),Mt!=null&&Mt.id){if(a(Mt),Mt.state){const gn=X(Mt.state);L(gn)}if(Mt.district){const gn=pe(Mt.district);O(gn)}}else console.error("Invalid response - no ID found:",Le)}catch(Le){console.error("Failed to fetch student data",Le)}})()},[t,e==null?void 0:e.id,c,C,E]),N.useEffect(()=>{async function De(){try{const[Le,Mt,gn,or,Xi,Br]=await Promise.all([GN(),yj(),vj(),QN(),KN(),xj()]);W((Xi||[]).map(_n=>({value:_n.id.toString(),label:_n.campus_name}))),v((or||[]).map(_n=>({value:_n.id.toString(),label:_n.school_name}))),p((Le||[]).map(_n=>({value:_n.id.toString(),label:_n.cast_name}))),g((Mt||[]).map(_n=>({value:_n.id.toString(),label:_n.qualification_name}))),y((gn||[]).map(_n=>({value:_n.id.toString(),label:_n.current_status_name}))),w((Br||[]).map(_n=>({value:_n.id.toString(),label:_n.name})))}catch{}}t&&De()},[t]),N.useEffect(()=>{r!=null&&r.joining_date&&I(r.joining_date.split("T")[0])},[r==null?void 0:r.joining_date]),N.useEffect(()=>{if(!M){T([]),_([]);return}(async()=>{D(!0);try{const Le=await YN(M),gn=((Le==null?void 0:Le.data)||Le||[]).map(or=>({value:or.district_code,label:or.district_name}));T(gn)}catch{T([])}finally{D(!1)}})()},[M]),N.useEffect(()=>{if(!U){_([]);return}(async()=>{V(!0);try{const Le=await bj(U),gn=((Le==null?void 0:Le.data)||Le||[]).map(or=>({value:or.block_code,label:or.block_name}));_(gn)}catch{_([])}finally{V(!1)}})()},[U]);const ie=async(De,Le)=>{if(r!=null&&r.id)try{const Mt={student_id:r.id,[De]:Le};console.log("value",Le),console.log(1,Mt),De==="joining_date"&&(Mt.joining_date=Le),await qde(Mt),await q()}catch(Mt){console.error("Failed to update final decision",Mt)}};if(!e||!r)return null;const oe=()=>{i(!1),u(De=>De+1)},q=async()=>{if(r!=null&&r.id)try{const De=await rP(r.id);let Le=De;De&&typeof De=="object"&&"data"in De&&(Le=De.data),Le!=null&&Le.id?a(Le):console.error("Invalid response - no ID found:",De)}catch(De){console.error("Failed to refresh applicant",De)}},de=(De,Le,Mt="Not provided")=>{var gn;return((gn=De.find(or=>or.value===(Le==null?void 0:Le.toString())))==null?void 0:gn.label)||Mt},ye=async De=>{L(De),O(null),T([]),_([]),await q()},be=async De=>{O(De),_([]),await q()};(ke=r.exam_sessions)==null||ke[0];const Ce=[{name:"status",label:"Status *",type:"select",options:[{value:"Screening Test Pass",label:"Screening Test Pass"},{value:"Screening Test Fail",label:"Screening Test Fail"},{value:"Created Student Without Exam",label:"Created Student Without Exam"}]},{name:"question_set_id",label:"Set Name *",type:"select",options:b},{name:"obtained_marks",label:"Obtained Marks *",type:"readonly"},{name:"school_id",label:"Qualifying School *",type:"select",options:x},{name:"exam_centre",label:"Exam Centre *",type:"readonly"},{name:"date_of_test",label:"Date of Testing *",type:"component",component:({row:De,updateRow:Le,disabled:Mt})=>d.jsx("input",{type:"date",value:(De==null?void 0:De.date_of_test)||"",onChange:gn=>Le==null?void 0:Le("date_of_test",gn.target.value),className:"border p-1 rounded w-full",disabled:!!Mt})}],se=((_e=r.exam_sessions)==null?void 0:_e.map(De=>{var Le,Mt;return{id:De.id,status:De.status??r.status??"",question_set_id:((Le=De.question_set_id)==null?void 0:Le.toString())||"",obtained_marks:De.obtained_marks!==null&&De.obtained_marks!==void 0?De.obtained_marks.toString():"",school_id:De.school_id!==null&&De.school_id!==void 0?De.school_id.toString():"",exam_centre:De.exam_centre||"",date_of_test:((Mt=De.date_of_test)==null?void 0:Mt.split("T")[0])||""}}))||[];if(!e)return null;const ae=((qe=Zi==null?void 0:Zi.screening)==null?void 0:qe.submit)??(async De=>{throw console.error("API_MAP.screening.submit is not available",De),new Error("screening submit API not available")}),ue=((Ue=Zi==null?void 0:Zi.screening)==null?void 0:Ue.update)??(async(De,Le)=>{throw console.error("API_MAP.screening.update is not available",De,Le),new Error("screening update API not available")});return d.jsxs(d.Fragment,{children:[d.jsx(ta,{open:t,onOpenChange:n,children:d.jsxs(na,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[d.jsxs(ka,{className:"flex flex-row items-center justify-between",children:[d.jsx(ra,{children:"Applicant Details"}),d.jsx("div",{className:"flex items-center gap-2"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-lg font-semibold",children:"Personal Information"}),d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"First Name"}),d.jsx(Bn,{applicant:r,field:"first_name",displayValue:(r==null?void 0:r.first_name)||"Not provided",onUpdate:q})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Middle Name"}),d.jsx(Bn,{applicant:r,field:"middle_name",displayValue:(r==null?void 0:r.middle_name)||"Not provided",onUpdate:q})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Name"}),d.jsx(Bn,{applicant:r,field:"last_name",displayValue:(r==null?void 0:r.last_name)||"Not provided",onUpdate:q})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Mobile Number"}),d.jsx(Bn,{applicant:r,field:"phone_number",displayValue:r.phone_number,onUpdate:q})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"WhatsApp Number"}),d.jsx(Bn,{applicant:r,field:"whatsapp_number",displayValue:r.whatsapp_number||"Not provided",onUpdate:q})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),d.jsx(Bn,{applicant:r,field:"gender",displayValue:r.gender||"Not provided",options:[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"other",label:"Other"}],onUpdate:q})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Cast"}),d.jsx(Bn,{applicant:r,field:"cast_id",value:r.cast_id,displayValue:de(h,r.cast_id),onUpdate:q,options:h})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Qualification"}),d.jsx(Bn,{applicant:r,field:"qualification_id",value:r.qualification_id,displayValue:de(f,r.qualification_id),onUpdate:q,options:f})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Current Work"}),d.jsx(Bn,{applicant:r,field:"current_status_id",displayValue:((it=m.find(De=>{var Le;return De.value===((Le=r.current_status_id)==null?void 0:Le.toString())}))==null?void 0:it.label)||"Not provided",onUpdate:q,options:m})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"State"}),d.jsx(Bn,{applicant:r,field:"state",displayValue:de(C,r.state),value:r.state,onUpdate:ye,options:C})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"City"}),d.jsx(Bn,{applicant:r,field:"city",displayValue:r.city||"Not provided",onUpdate:q})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"District"}),d.jsx(Bn,{applicant:r,field:"district",displayValue:F?"Loading...":de(E,r.district),value:r.district,onUpdate:be,options:E,disabled:!M||F})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Block"}),d.jsx(Bn,{applicant:r,field:"block",displayValue:R?"Loading...":de($,r.block),value:r.block,onUpdate:q,options:$,disabled:!U||R})]})]})]}),d.jsx(fC,{title:"Screening Round",studentId:r.id,initialData:se,fields:Ce,submitApi:ae,updateApi:ue,onSave:q}),d.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[d.jsx("div",{className:"col-span-full w-full",children:d.jsx(fC,{title:"Learning Round",studentId:r.id,initialData:r.interview_learner_round||[],fields:[{name:"learning_round_status",label:"Status *",type:"select",options:[{value:"Learner Round Pass",label:"Learner Round Pass"},{value:"Learner Round Fail",label:"Learner Round Fail"},{value:"Reschedule",label:"Reschedule"},{value:"No Show",label:"No Show"}]},{name:"comments",label:"Comments *",type:"text"}],submitApi:Zi.learning.submit,updateApi:Zi.learning.update,onSave:q})}),d.jsx("div",{className:"col-span-full w-full",children:d.jsx(fC,{title:"Cultural Fit Round",studentId:r.id,initialData:r.interview_cultural_fit_round||[],fields:[{name:"cultural_fit_status",label:"Status *",type:"select",options:[{value:"Cultural Fit Interview Pass",label:"Cultural Fit Interview Pass"},{value:"Cultural Fit Interview Fail",label:"Cultural Fit Interview Fail"},{value:"Reschedule",label:"Reschedule"},{value:"No Show",label:"No Show"}]},{name:"comments",label:"Comments *",type:"text"}],submitApi:Zi.cultural.submit,updateApi:Zi.cultural.update,onSave:q})}),d.jsxs("div",{className:"space-y-4 md:col-span-2",children:[d.jsx("h3",{className:"text-lg font-semibold",children:"Offer & Final Status"}),d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Campus"}),d.jsx(Bn,{applicant:r,field:"campus_id",displayValue:de(G,r.campus_id),onUpdate:q,options:G})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Offer Letter Status"}),d.jsx(Bn,{applicant:r,field:"offer_letter_status",value:(At=(yt=r.final_decisions)==null?void 0:yt[0])==null?void 0:At.offer_letter_status,displayValue:((an=(Bt=r.final_decisions)==null?void 0:Bt[0])==null?void 0:an.offer_letter_status)||"Not provided",options:[{value:"Offer Pending",label:"Offer Pending"},{value:"Offer Sent",label:"Offer Sent"},{value:"Offer Accepted",label:"Offer Accepted"},{value:"Offer Declined",label:"Offer Declined"},{value:"Waitlisted",label:"Waitlisted"},{value:"Selected but not joined",label:"Selected but not joined"}],onUpdate:async De=>{await ie("offer_letter_status",De)}})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Onboarded Status"}),d.jsx(Bn,{applicant:r,field:"onboarded_status",value:(ht=(nt=r.final_decisions)==null?void 0:nt[0])==null?void 0:ht.onboarded_status,displayValue:((er=(un=r.final_decisions)==null?void 0:un[0])==null?void 0:er.onboarded_status)||"Not provided",options:[{value:"Onboarded",label:"Onboarded"}],onUpdate:async De=>{await ie("onboarded_status",De)}})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Joining Date"}),d.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:k||((Pn=($n=(xe=r.final_decisions)==null?void 0:xe[0])==null?void 0:$n.joining_date)==null?void 0:Pn.split("T")[0])||"",onChange:De=>I(De.target.value),onBlur:async()=>{k&&await ie("joining_date",k)}})]})]}),d.jsxs("div",{className:"space-y-4 md:col-span-2",children:[d.jsx("h3",{className:"text-lg font-semibold",children:"Notes"}),d.jsx("div",{className:"grid grid-cols-2 gap-4",children:d.jsx(Bn,{applicant:r,field:"final_notes",value:((tn=(sn=r.final_decisions)==null?void 0:sn[0])==null?void 0:tn.final_notes)||"",displayValue:((Qa=(Ln=r.final_decisions)==null?void 0:Ln[0])==null?void 0:Qa.final_notes)||"No final notes",renderInput:({value:De,onChange:Le})=>d.jsx("textarea",{value:De,onChange:Mt=>Le(Mt.target.value),rows:4,className:"border rounded px-2 py-1 w-full resize-none",placeholder:"Enter final notes here..."}),onUpdate:async De=>{var Le;(Le=r==null?void 0:r.final_decisions)!=null&&Le[0]&&await ie("final_notes",De)}})})]}),d.jsxs("div",{className:"space-y-4 md:col-span-2",children:[d.jsx("h3",{className:"text-lg font-semibold",children:"Timestamps"}),d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Created At"}),d.jsx("p",{className:"text-sm",children:r.created_at?new Date(r.created_at).toLocaleString():"Not available"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last updated At"}),d.jsx("p",{className:"text-sm",children:r.updated_at?new Date(r.updated_at).toLocaleString():"Not available"})]})]})]})]})]})]})}),s&&d.jsx(wbe,{applicant:r,isOpen:s,onClose:()=>i(!1),onSuccess:oe}),o&&d.jsx(BV,{applicantId:r.id||"",applicantName:r.name||"",isOpen:o,onClose:()=>l(!1)})]})}var UV={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((n,r)=>{e.exports=r()})(Ls,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},a,s=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(E){var T=k(E);T.chunkSize=parseInt(T.chunkSize),E.step||E.chunk||(T.chunkSize=null),this._handle=new m(T),(this._handle.streamer=this)._config=T}).call(this,S),this.parseChunk=function(E,T){var $=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<$){let M=this._config.newline;M||(_=this._config.quoteChar||'"',M=this._handle.guessLineEndings(E,_)),E=[...E.split(M).slice($)].join(M)}this.isFirstChunk&&C(this._config.beforeFirstChunk)&&(_=this._config.beforeFirstChunk(E))!==void 0&&(E=_),this.isFirstChunk=!1,this._halted=!1;var $=this._partialLine+E,_=(this._partialLine="",this._handle.parse($,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(E=_.meta.cursor,$=(this._finished||(this._partialLine=$.substring(E-this._baseIndex),this._baseIndex=E),_&&_.data&&(this._rowCount+=_.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)r.postMessage({results:_,workerId:c.WORKER_ID,finished:$});else if(C(this._config.chunk)&&!T){if(this._config.chunk(_,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=_=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(_.data),this._completeResults.errors=this._completeResults.errors.concat(_.errors),this._completeResults.meta=_.meta),this._completed||!$||!C(this._config.complete)||_&&_.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),$||_&&_.meta.paused||this._nextChunk(),_}this._halted=!0},this._sendError=function(E){C(this._config.error)?this._config.error(E):i&&this._config.error&&r.postMessage({workerId:c.WORKER_ID,error:E,finished:!1})}}function h(S){var E;(S=S||{}).chunkSize||(S.chunkSize=c.RemoteChunkSize),u.call(this,S),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(T){this._input=T,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(E=new XMLHttpRequest,this._config.withCredentials&&(E.withCredentials=this._config.withCredentials),s||(E.onload=I(this._chunkLoaded,this),E.onerror=I(this._chunkError,this)),E.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var T,$=this._config.downloadRequestHeaders;for(T in $)E.setRequestHeader(T,$[T])}var _;this._config.chunkSize&&(_=this._start+this._config.chunkSize-1,E.setRequestHeader("Range","bytes="+this._start+"-"+_));try{E.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}s&&E.status===0&&this._chunkError()}},this._chunkLoaded=function(){E.readyState===4&&(E.status<200||400<=E.status?this._chunkError():(this._start+=this._config.chunkSize||E.responseText.length,this._finished=!this._config.chunkSize||this._start>=(T=>(T=T.getResponseHeader("Content-Range"))!==null?parseInt(T.substring(T.lastIndexOf("/")+1)):-1)(E),this.parseChunk(E.responseText)))},this._chunkError=function(T){T=E.statusText||T,this._sendError(new Error(T))}}function p(S){(S=S||{}).chunkSize||(S.chunkSize=c.LocalChunkSize),u.call(this,S);var E,T,$=typeof FileReader<"u";this.stream=function(_){this._input=_,T=_.slice||_.webkitSlice||_.mozSlice,$?((E=new FileReader).onload=I(this._chunkLoaded,this),E.onerror=I(this._chunkError,this)):E=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var _=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),_=T.call(_,this._start,M)),E.readAsText(_,this._config.encoding));$||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(_){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(_.target.result)},this._chunkError=function(){this._sendError(E.error)}}function f(S){var E;u.call(this,S=S||{}),this.stream=function(T){return E=T,this._nextChunk()},this._nextChunk=function(){var T,$;if(!this._finished)return T=this._config.chunkSize,E=T?($=E.substring(0,T),E.substring(T)):($=E,""),this._finished=!E,this.parseChunk($)}}function g(S){u.call(this,S=S||{});var E=[],T=!0,$=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(_){this._input=_,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){$&&E.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),E.length?this.parseChunk(E.shift()):T=!0},this._streamData=I(function(_){try{E.push(typeof _=="string"?_:_.toString(this._config.encoding)),T&&(T=!1,this._checkIsFinished(),this.parseChunk(E.shift()))}catch(M){this._streamError(M)}},this),this._streamError=I(function(_){this._streamCleanUp(),this._sendError(_)},this),this._streamEnd=I(function(){this._streamCleanUp(),$=!0,this._streamData("")},this),this._streamCleanUp=I(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(S){var E,T,$,_,M=Math.pow(2,53),L=-M,U=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,O=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,F=this,D=0,R=0,V=!1,G=!1,W=[],B={data:[],errors:[],meta:{}};function Q(oe){return S.skipEmptyLines==="greedy"?oe.join("").trim()==="":oe.length===1&&oe[0].length===0}function X(){if(B&&$&&(ie("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),$=!1),S.skipEmptyLines&&(B.data=B.data.filter(function(be){return!Q(be)})),pe()){let be=function(Ce,se){C(S.transformHeader)&&(Ce=S.transformHeader(Ce,se)),W.push(Ce)};var ye=be;if(B)if(Array.isArray(B.data[0])){for(var oe=0;pe()&&oe<B.data.length;oe++)B.data[oe].forEach(be);B.data.splice(0,1)}else B.data.forEach(be)}function q(be,Ce){for(var se=S.header?{}:[],ae=0;ae<be.length;ae++){var ue=ae,ke=be[ae],ke=((_e,qe)=>(Ue=>(S.dynamicTypingFunction&&S.dynamicTyping[Ue]===void 0&&(S.dynamicTyping[Ue]=S.dynamicTypingFunction(Ue)),(S.dynamicTyping[Ue]||S.dynamicTyping)===!0))(_e)?qe==="true"||qe==="TRUE"||qe!=="false"&&qe!=="FALSE"&&((Ue=>{if(U.test(Ue)&&(Ue=parseFloat(Ue),L<Ue&&Ue<M))return 1})(qe)?parseFloat(qe):O.test(qe)?new Date(qe):qe===""?null:qe):qe)(ue=S.header?ae>=W.length?"__parsed_extra":W[ae]:ue,ke=S.transform?S.transform(ke,ue):ke);ue==="__parsed_extra"?(se[ue]=se[ue]||[],se[ue].push(ke)):se[ue]=ke}return S.header&&(ae>W.length?ie("FieldMismatch","TooManyFields","Too many fields: expected "+W.length+" fields but parsed "+ae,R+Ce):ae<W.length&&ie("FieldMismatch","TooFewFields","Too few fields: expected "+W.length+" fields but parsed "+ae,R+Ce)),se}var de;B&&(S.header||S.dynamicTyping||S.transform)&&(de=1,!B.data.length||Array.isArray(B.data[0])?(B.data=B.data.map(q),de=B.data.length):B.data=q(B.data,0),S.header&&B.meta&&(B.meta.fields=W),R+=de)}function pe(){return S.header&&W.length===0}function ie(oe,q,de,ye){oe={type:oe,code:q,message:de},ye!==void 0&&(oe.row=ye),B.errors.push(oe)}C(S.step)&&(_=S.step,S.step=function(oe){B=oe,pe()?X():(X(),B.data.length!==0&&(D+=oe.data.length,S.preview&&D>S.preview?T.abort():(B.data=B.data[0],_(B,F))))}),this.parse=function(oe,q,de){var ye=S.quoteChar||'"',ye=(S.newline||(S.newline=this.guessLineEndings(oe,ye)),$=!1,S.delimiter?C(S.delimiter)&&(S.delimiter=S.delimiter(oe),B.meta.delimiter=S.delimiter):((ye=((be,Ce,se,ae,ue)=>{var ke,_e,qe,Ue;ue=ue||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var it=0;it<ue.length;it++){for(var yt,At=ue[it],Bt=0,an=0,nt=0,ht=(qe=void 0,new x({comments:ae,delimiter:At,newline:Ce,preview:10}).parse(be)),un=0;un<ht.data.length;un++)se&&Q(ht.data[un])?nt++:(yt=ht.data[un].length,an+=yt,qe===void 0?qe=yt:0<yt&&(Bt+=Math.abs(yt-qe),qe=yt));0<ht.data.length&&(an/=ht.data.length-nt),(_e===void 0||Bt<=_e)&&(Ue===void 0||Ue<an)&&1.99<an&&(_e=Bt,ke=At,Ue=an)}return{successful:!!(S.delimiter=ke),bestDelimiter:ke}})(oe,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess)).successful?S.delimiter=ye.bestDelimiter:($=!0,S.delimiter=c.DefaultDelimiter),B.meta.delimiter=S.delimiter),k(S));return S.preview&&S.header&&ye.preview++,E=oe,T=new x(ye),B=T.parse(E,q,de),X(),V?{meta:{paused:!0}}:B||{meta:{paused:!1}}},this.paused=function(){return V},this.pause=function(){V=!0,T.abort(),E=C(S.chunk)?"":E.substring(T.getCharIndex())},this.resume=function(){F.streamer._halted?(V=!1,F.streamer.parseChunk(E,!0)):setTimeout(F.resume,3)},this.aborted=function(){return G},this.abort=function(){G=!0,T.abort(),B.meta.aborted=!0,C(S.complete)&&S.complete(B),E=""},this.guessLineEndings=function(be,ye){be=be.substring(0,1048576);var ye=new RegExp(y(ye)+"([^]*?)"+y(ye),"gm"),de=(be=be.replace(ye,"")).split("\r"),ye=be.split(`
`),be=1<ye.length&&ye[0].length<de[0].length;if(de.length===1||be)return`
`;for(var Ce=0,se=0;se<de.length;se++)de[se][0]===`
`&&Ce++;return Ce>=de.length/2?`\r
`:"\r"}}function y(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function x(S){var E=(S=S||{}).delimiter,T=S.newline,$=S.comments,_=S.step,M=S.preview,L=S.fastMode,U=null,O=!1,F=S.quoteChar==null?'"':S.quoteChar,D=F;if(S.escapeChar!==void 0&&(D=S.escapeChar),(typeof E!="string"||-1<c.BAD_DELIMITERS.indexOf(E))&&(E=","),$===E)throw new Error("Comment character same as delimiter");$===!0?$="#":(typeof $!="string"||-1<c.BAD_DELIMITERS.indexOf($))&&($=!1),T!==`
`&&T!=="\r"&&T!==`\r
`&&(T=`
`);var R=0,V=!1;this.parse=function(G,W,B){if(typeof G!="string")throw new Error("Input must be a string");var Q=G.length,X=E.length,pe=T.length,ie=$.length,oe=C(_),q=[],de=[],ye=[],be=R=0;if(!G)return Bt();if(L||L!==!1&&G.indexOf(F)===-1){for(var Ce=G.split(T),se=0;se<Ce.length;se++){if(ye=Ce[se],R+=ye.length,se!==Ce.length-1)R+=T.length;else if(B)return Bt();if(!$||ye.substring(0,ie)!==$){if(oe){if(q=[],Ue(ye.split(E)),an(),V)return Bt()}else Ue(ye.split(E));if(M&&M<=se)return q=q.slice(0,M),Bt(!0)}}return Bt()}for(var ae=G.indexOf(E,R),ue=G.indexOf(T,R),ke=new RegExp(y(D)+y(F),"g"),_e=G.indexOf(F,R);;)if(G[R]===F)for(_e=R,R++;;){if((_e=G.indexOf(F,_e+1))===-1)return B||de.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:q.length,index:R}),yt();if(_e===Q-1)return yt(G.substring(R,_e).replace(ke,F));if(F===D&&G[_e+1]===D)_e++;else if(F===D||_e===0||G[_e-1]!==D){ae!==-1&&ae<_e+1&&(ae=G.indexOf(E,_e+1));var qe=it((ue=ue!==-1&&ue<_e+1?G.indexOf(T,_e+1):ue)===-1?ae:Math.min(ae,ue));if(G.substr(_e+1+qe,X)===E){ye.push(G.substring(R,_e).replace(ke,F)),G[R=_e+1+qe+X]!==F&&(_e=G.indexOf(F,R)),ae=G.indexOf(E,R),ue=G.indexOf(T,R);break}if(qe=it(ue),G.substring(_e+1+qe,_e+1+qe+pe)===T){if(ye.push(G.substring(R,_e).replace(ke,F)),At(_e+1+qe+pe),ae=G.indexOf(E,R),_e=G.indexOf(F,R),oe&&(an(),V))return Bt();if(M&&q.length>=M)return Bt(!0);break}de.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:q.length,index:R}),_e++}}else if($&&ye.length===0&&G.substring(R,R+ie)===$){if(ue===-1)return Bt();R=ue+pe,ue=G.indexOf(T,R),ae=G.indexOf(E,R)}else if(ae!==-1&&(ae<ue||ue===-1))ye.push(G.substring(R,ae)),R=ae+X,ae=G.indexOf(E,R);else{if(ue===-1)break;if(ye.push(G.substring(R,ue)),At(ue+pe),oe&&(an(),V))return Bt();if(M&&q.length>=M)return Bt(!0)}return yt();function Ue(nt){q.push(nt),be=R}function it(nt){var ht=0;return ht=nt!==-1&&(nt=G.substring(_e+1,nt))&&nt.trim()===""?nt.length:ht}function yt(nt){return B||(nt===void 0&&(nt=G.substring(R)),ye.push(nt),R=Q,Ue(ye),oe&&an()),Bt()}function At(nt){R=nt,Ue(ye),ye=[],ue=G.indexOf(T,R)}function Bt(nt){if(S.header&&!W&&q.length&&!O){var ht=q[0],un=Object.create(null),er=new Set(ht);let xe=!1;for(let $n=0;$n<ht.length;$n++){let Pn=ht[$n];if(un[Pn=C(S.transformHeader)?S.transformHeader(Pn,$n):Pn]){let sn,tn=un[Pn];for(;sn=Pn+"_"+tn,tn++,er.has(sn););er.add(sn),ht[$n]=sn,un[Pn]++,xe=!0,(U=U===null?{}:U)[sn]=Pn}else un[Pn]=1,ht[$n]=Pn;er.add(Pn)}xe&&console.warn("Duplicate headers found and renamed."),O=!0}return{data:q,errors:de,meta:{delimiter:E,linebreak:T,aborted:V,truncated:!!nt,cursor:be+(W||0),renamedHeaders:U}}}function an(){_(Bt()),q=[],de=[]}},this.abort=function(){V=!0},this.getCharIndex=function(){return R}}function v(S){var E=S.data,T=o[E.workerId],$=!1;if(E.error)T.userError(E.error,E.file);else if(E.results&&E.results.data){var _={abort:function(){$=!0,b(E.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(C(T.userStep)){for(var M=0;M<E.results.data.length&&(T.userStep({data:E.results.data[M],errors:E.results.errors,meta:E.results.meta},_),!$);M++);delete E.results}else C(T.userChunk)&&(T.userChunk(E.results,_,E.file),delete E.results)}E.finished&&!$&&b(E.workerId,E.results)}function b(S,E){var T=o[S];C(T.userComplete)&&T.userComplete(E),T.terminate(),delete o[S]}function w(){throw new Error("Not implemented.")}function k(S){if(typeof S!="object"||S===null)return S;var E,T=Array.isArray(S)?[]:{};for(E in S)T[E]=k(S[E]);return T}function I(S,E){return function(){S.apply(E,arguments)}}function C(S){return typeof S=="function"}return c.parse=function(S,E){var T=(E=E||{}).dynamicTyping||!1;if(C(T)&&(E.dynamicTypingFunction=T,T={}),E.dynamicTyping=T,E.transform=!!C(E.transform)&&E.transform,!E.worker||!c.WORKERS_SUPPORTED)return T=null,c.NODE_STREAM_INPUT,typeof S=="string"?(S=($=>$.charCodeAt(0)!==65279?$:$.slice(1))(S),T=new(E.download?h:f)(E)):S.readable===!0&&C(S.read)&&C(S.on)?T=new g(E):(r.File&&S instanceof File||S instanceof Object)&&(T=new p(E)),T.stream(S);(T=(()=>{var $;return!!c.WORKERS_SUPPORTED&&($=(()=>{var _=r.URL||r.webkitURL||null,M=n.toString();return c.BLOB_URL||(c.BLOB_URL=_.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),($=new r.Worker($)).onmessage=v,$.id=l++,o[$.id]=$)})()).userStep=E.step,T.userChunk=E.chunk,T.userComplete=E.complete,T.userError=E.error,E.step=C(E.step),E.chunk=C(E.chunk),E.complete=C(E.complete),E.error=C(E.error),delete E.worker,T.postMessage({input:S,config:E,workerId:T.id})},c.unparse=function(S,E){var T=!1,$=!0,_=",",M=`\r
`,L='"',U=L+L,O=!1,F=null,D=!1,R=((()=>{if(typeof E=="object"){if(typeof E.delimiter!="string"||c.BAD_DELIMITERS.filter(function(W){return E.delimiter.indexOf(W)!==-1}).length||(_=E.delimiter),typeof E.quotes!="boolean"&&typeof E.quotes!="function"&&!Array.isArray(E.quotes)||(T=E.quotes),typeof E.skipEmptyLines!="boolean"&&typeof E.skipEmptyLines!="string"||(O=E.skipEmptyLines),typeof E.newline=="string"&&(M=E.newline),typeof E.quoteChar=="string"&&(L=E.quoteChar),typeof E.header=="boolean"&&($=E.header),Array.isArray(E.columns)){if(E.columns.length===0)throw new Error("Option columns is empty");F=E.columns}E.escapeChar!==void 0&&(U=E.escapeChar+L),E.escapeFormulae instanceof RegExp?D=E.escapeFormulae:typeof E.escapeFormulae=="boolean"&&E.escapeFormulae&&(D=/^[=+\-@\t\r].*$/)}})(),new RegExp(y(L),"g"));if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return V(null,S,O);if(typeof S[0]=="object")return V(F||Object.keys(S[0]),S,O)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||F),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),V(S.fields||[],S.data||[],O);throw new Error("Unable to serialize unrecognized input");function V(W,B,Q){var X="",pe=(typeof W=="string"&&(W=JSON.parse(W)),typeof B=="string"&&(B=JSON.parse(B)),Array.isArray(W)&&0<W.length),ie=!Array.isArray(B[0]);if(pe&&$){for(var oe=0;oe<W.length;oe++)0<oe&&(X+=_),X+=G(W[oe],oe);0<B.length&&(X+=M)}for(var q=0;q<B.length;q++){var de=(pe?W:B[q]).length,ye=!1,be=pe?Object.keys(B[q]).length===0:B[q].length===0;if(Q&&!pe&&(ye=Q==="greedy"?B[q].join("").trim()==="":B[q].length===1&&B[q][0].length===0),Q==="greedy"&&pe){for(var Ce=[],se=0;se<de;se++){var ae=ie?W[se]:se;Ce.push(B[q][ae])}ye=Ce.join("").trim()===""}if(!ye){for(var ue=0;ue<de;ue++){0<ue&&!be&&(X+=_);var ke=pe&&ie?W[ue]:ue;X+=G(B[q][ke],ue)}q<B.length-1&&(!Q||0<de&&!be)&&(X+=M)}}return X}function G(W,B){var Q,X;return W==null?"":W.constructor===Date?JSON.stringify(W).slice(1,25):(X=!1,D&&typeof W=="string"&&D.test(W)&&(W="'"+W,X=!0),Q=W.toString().replace(R,U),(X=X||T===!0||typeof T=="function"&&T(W,B)||Array.isArray(T)&&T[B]||((pe,ie)=>{for(var oe=0;oe<ie.length;oe++)if(-1<pe.indexOf(ie[oe]))return!0;return!1})(Q,c.BAD_DELIMITERS)||-1<Q.indexOf(_)||Q.charAt(0)===" "||Q.charAt(Q.length-1)===" ")?L+Q+L:Q)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!s&&!!r.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=x,c.ParserHandle=m,c.NetworkStreamer=h,c.FileStreamer=p,c.StringStreamer=f,c.ReadableStreamStreamer=g,r.jQuery&&((a=r.jQuery).fn.parse=function(S){var E=S.config||{},T=[];return this.each(function(M){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var L=0;L<this.files.length;L++)T.push({file:this.files[L],inputElem:this,instanceConfig:a.extend({},E)})}),$(),this;function $(){if(T.length===0)C(S.complete)&&S.complete();else{var M,L,U,O,F=T[0];if(C(S.before)){var D=S.before(F.file,F.inputElem);if(typeof D=="object"){if(D.action==="abort")return M="AbortError",L=F.file,U=F.inputElem,O=D.reason,void(C(S.error)&&S.error({name:M},L,U,O));if(D.action==="skip")return void _();typeof D.config=="object"&&(F.instanceConfig=a.extend(F.instanceConfig,D.config))}else if(D==="skip")return void _()}var R=F.instanceConfig.complete;F.instanceConfig.complete=function(V){C(R)&&R(V,F.file,F.inputElem),_()},c.parse(F.file,F.instanceConfig)}}function _(){T.splice(0,1),$()}}),i&&(r.onmessage=function(S){S=S.data,c.WORKER_ID===void 0&&S&&(c.WORKER_ID=S.workerId),typeof S.input=="string"?r.postMessage({workerId:c.WORKER_ID,results:c.parse(S.input,S.config),finished:!0}):(r.File&&S.input instanceof File||S.input instanceof Object)&&(S=c.parse(S.input,S.config))&&r.postMessage({workerId:c.WORKER_ID,results:S,finished:!0})}),(h.prototype=Object.create(u.prototype)).constructor=h,(p.prototype=Object.create(u.prototype)).constructor=p,(f.prototype=Object.create(f.prototype)).constructor=f,(g.prototype=Object.create(u.prototype)).constructor=g,c})})(UV);var Ube=UV.exports;const WV=VE(Ube);var tA="Progress",nA=100,[Wbe,Gat]=ia(tA),[Vbe,Hbe]=Wbe(tA),VV=N.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:s=Gbe,...i}=e;(a||a===0)&&!qP(a)&&console.error(qbe(`${a}`,"Progress"));const o=qP(a)?a:nA;r!==null&&!KP(r,o)&&console.error(Kbe(`${r}`,"Progress"));const l=KP(r,o)?r:null,c=C1(l)?s(l,o):void 0;return d.jsx(Vbe,{scope:n,value:l,max:o,children:d.jsx(Qe.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":C1(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":qV(l,o),"data-value":l??void 0,"data-max":o,...i,ref:t})})});VV.displayName=tA;var HV="ProgressIndicator",GV=N.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,a=Hbe(HV,n);return d.jsx(Qe.div,{"data-state":qV(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:t})});GV.displayName=HV;function Gbe(e,t){return`${Math.round(e/t*100)}%`}function qV(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function C1(e){return typeof e=="number"}function qP(e){return C1(e)&&!isNaN(e)&&e>0}function KP(e,t){return C1(e)&&!isNaN(e)&&e<=t&&e>=0}function qbe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${nA}\`.`}function Kbe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${nA} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var KV=VV,Qbe=GV;const rA=N.forwardRef(({className:e,value:t,...n},r)=>d.jsx(KV,{ref:r,className:Fe("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:d.jsx(Qbe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));rA.displayName=KV.displayName;const Xbe=({isOpen:e,onClose:t,onSuccess:n})=>{const[r,a]=N.useState(null),[s,i]=N.useState([]),[o,l]=N.useState(null),[c,u]=N.useState(!1),[h,p]=N.useState(0),[f,g]=N.useState(!1),[m,y]=N.useState(0),{toast:x}=Qt();N.useEffect(()=>{e&&(a(null),i([]),l(null),g(!1),p(0),y(0),u(!1))},[e]);const v=I=>{l(null),g(!1),p(0),y(0);const C=I.target.files&&I.target.files[0];C&&C.type==="text/csv"?a(C):(a(null),l("Please select a valid CSV file."))},b=async()=>{if(!r){l("Please select a CSV file.");return}l(null),g(!1),p(0),u(!0);try{await Fde(r),WV.parse(r,{header:!0,skipEmptyLines:!0,dynamicTyping:!1,complete:I=>{i(I.data),k(I.data)},error:I=>{l("Something went wrong while uploading your CSV file. Please check it and try again."),u(!1)}})}catch(I){console.error("Upload failed:",I),l(I&&"Something went wrong while uploading your CSV file. Please check it and try again."),u(!1)}},w=I=>{if(!I||I.trim()==="")return null;const C=I.trim();if(C.includes("/")){const E=C.split("/");if(E.length===2){const T=parseFloat(E[0]),$=parseFloat(E[1]);if(!isNaN(T)&&!isNaN($)&&$!==0){const _=T/$;return console.log(`Converted ${C} to ${_}`),_}}}const S=parseFloat(C);return isNaN(S)?null:S},k=async I=>{try{u(!0);const C=I.map((S,E)=>{var $,_,M,L;return{mobile_no:(($=S["Mobile No."])==null?void 0:$.toString())||"",unique_number:((_=S["Unique Number"])==null?void 0:_.toString())||null,name:S.Name||null,city:S.City||null,block:S.Block||null,caste:S.Caste||null,gender:S.Gender||null,qualification:S.Qualification||null,current_work:S["Current Work"]||null,qualifying_school:S["Qualifying SOP/SOB"]||null,whatsapp_number:((M=S["WA NO."])==null?void 0:M.toString())||null,set_name:S.Set||null,exam_centre:S["Offline Exam Centre"]||null,date_of_testing:S["Date of Testing"]||null,final_marks:w((L=S["Final Marks"])==null?void 0:L.toString()),final_notes:S["Final Notes"]||null,triptis_notes:S["Triptis Notes"]||null}});gbe(C),p(C.length),g(!0),x({title:"Success",description:`Successfully imported ${C.length} applicants!`}),n(),t()}catch(C){console.error("Import error:",C),l(C instanceof Error?C.message:"Unknown error occurred")}finally{u(!1)}};return d.jsx(ta,{open:e,onOpenChange:t,children:d.jsxs(na,{className:"sm:max-w-[425px]",children:[d.jsxs(ka,{children:[d.jsx(ra,{children:"Import Applicants from CSV"}),d.jsx(_j,{children:"Upload a CSV file to add multiple applicants at once. Duplicate mobile numbers are now allowed."})]}),d.jsxs("div",{className:"grid gap-4 py-4",children:[d.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[d.jsx(Pe,{htmlFor:"file",className:"text-right",children:"CSV File"}),d.jsx(Je,{type:"file",id:"file",className:"col-span-3",accept:".csv",onChange:v})]}),o&&d.jsxs("div",{className:"flex items-center text-sm text-destructive",children:[d.jsx(yf,{className:"mr-2 h-4 w-4"}),o]}),c&&d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-muted-foreground",children:"Processing CSV data..."}),d.jsx(rA,{value:m})]}),f&&d.jsxs("div",{className:"flex items-center text-sm text-green-500",children:[d.jsx(dd,{className:"mr-2 h-4 w-4"}),"Successfully imported ",h," applicants!"]})]}),d.jsxs(fe,{onClick:b,disabled:!r||c,className:"flex items-center gap-2",children:[c&&d.jsx(wo,{className:"animate-spin h-4 w-4"}),c?"Importing...":"Import"]})]})})},Ybe=Cv("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Fa({className:e,variant:t,...n}){return d.jsx("div",{className:Fe(Ybe({variant:t}),e),...n})}const Jbe=({selectedRowsCount:e,onBulkUpdate:t,onSendOfferLetters:n,onBulkDelete:r})=>e===0?null:d.jsxs("div",{className:"flex items-center gap-2 mr-4",children:[d.jsxs(Fa,{variant:"secondary",children:[e," selected"]}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:t,children:[d.jsx(oc,{className:"h-4 w-4 mr-2"}),"Bulk Update"]}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:n,children:[d.jsx(Bx,{className:"h-4 w-4 mr-2"}),"Send Offer Letters"]}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:r,children:[d.jsx(Na,{className:"h-4 w-4 mr-2"}),"Delete"]})]}),Zbe=({onCSVImport:e,onExportCSV:t,onShowFilters:n,onAddApplicant:r})=>d.jsxs(d.Fragment,{children:[d.jsxs(fe,{onClick:e,variant:"outline",size:"sm",children:[d.jsx(Dm,{className:"h-4 w-4 mr-2"}),"Import CSV"]}),d.jsxs(fe,{onClick:t,variant:"outline",size:"sm",children:[d.jsx($N,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),d.jsxs(fe,{onClick:n,variant:"outline",size:"sm",children:[d.jsx($m,{className:"h-4 w-4 mr-2"}),"Filters"]}),d.jsxs(fe,{onClick:r,size:"sm",children:[d.jsx(Qn,{className:"h-4 w-4 mr-2"}),"Add Applicant"]})]});var RI=["Enter"," "],ewe=["ArrowDown","PageUp","Home"],QV=["ArrowUp","PageDown","End"],twe=[...ewe,...QV],nwe={ltr:[...RI,"ArrowRight"],rtl:[...RI,"ArrowLeft"]},rwe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Vv="Menu",[Xx,awe,swe]=TN(Vv),[ah,XV]=ia(Vv,[swe,lc,Wm]),xk=lc(),YV=Wm(),[iwe,sh]=ah(Vv),[owe,Hv]=ah(Vv),JV=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:s,modal:i=!0}=e,o=xk(t),[l,c]=N.useState(null),u=N.useRef(!1),h=rr(s),p=Bm(a);return N.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),d.jsx(lj,{...o,children:d.jsx(iwe,{scope:t,open:n,onOpenChange:h,content:l,onContentChange:c,children:d.jsx(owe,{scope:t,onClose:N.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:p,modal:i,children:r})})})};JV.displayName=Vv;var lwe="MenuAnchor",aA=N.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=xk(n);return d.jsx(Ev,{...a,...r,ref:t})});aA.displayName=lwe;var sA="MenuPortal",[uwe,ZV]=ah(sA,{forceMount:void 0}),eH=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,s=sh(sA,t);return d.jsx(uwe,{scope:t,forceMount:n,children:d.jsx(Lr,{present:n||s.open,children:d.jsx(Am,{asChild:!0,container:a,children:r})})})};eH.displayName=sA;var ai="MenuContent",[cwe,iA]=ah(ai),tH=N.forwardRef((e,t)=>{const n=ZV(ai,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,s=sh(ai,e.__scopeMenu),i=Hv(ai,e.__scopeMenu);return d.jsx(Xx.Provider,{scope:e.__scopeMenu,children:d.jsx(Lr,{present:r||s.open,children:d.jsx(Xx.Slot,{scope:e.__scopeMenu,children:i.modal?d.jsx(dwe,{...a,ref:t}):d.jsx(hwe,{...a,ref:t})})})})}),dwe=N.forwardRef((e,t)=>{const n=sh(ai,e.__scopeMenu),r=N.useRef(null),a=kt(t,r);return N.useEffect(()=>{const s=r.current;if(s)return ek(s)},[]),d.jsx(oA,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Te(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),hwe=N.forwardRef((e,t)=>{const n=sh(ai,e.__scopeMenu);return d.jsx(oA,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),pwe=Ou("MenuContent.ScrollLock"),oA=N.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:f,disableOutsideScroll:g,...m}=e,y=sh(ai,n),x=Hv(ai,n),v=xk(n),b=YV(n),w=awe(n),[k,I]=N.useState(null),C=N.useRef(null),S=kt(t,C,y.onContentChange),E=N.useRef(0),T=N.useRef(""),$=N.useRef(0),_=N.useRef(null),M=N.useRef("right"),L=N.useRef(0),U=g?Mv:N.Fragment,O=g?{as:pwe,allowPinchZoom:!0}:void 0,F=R=>{var ie,oe;const V=T.current+R,G=w().filter(q=>!q.disabled),W=document.activeElement,B=(ie=G.find(q=>q.ref.current===W))==null?void 0:ie.textValue,Q=G.map(q=>q.textValue),X=_we(Q,V,B),pe=(oe=G.find(q=>q.textValue===X))==null?void 0:oe.ref.current;(function q(de){T.current=de,window.clearTimeout(E.current),de!==""&&(E.current=window.setTimeout(()=>q(""),1e3))})(V),pe&&setTimeout(()=>pe.focus())};N.useEffect(()=>()=>window.clearTimeout(E.current),[]),JN();const D=N.useCallback(R=>{var G,W;return M.current===((G=_.current)==null?void 0:G.side)&&Iwe(R,(W=_.current)==null?void 0:W.area)},[]);return d.jsx(cwe,{scope:n,searchRef:T,onItemEnter:N.useCallback(R=>{D(R)&&R.preventDefault()},[D]),onItemLeave:N.useCallback(R=>{var V;D(R)||((V=C.current)==null||V.focus(),I(null))},[D]),onTriggerLeave:N.useCallback(R=>{D(R)&&R.preventDefault()},[D]),pointerGraceTimerRef:$,onPointerGraceIntentChange:N.useCallback(R=>{_.current=R},[]),children:d.jsx(U,{...O,children:d.jsx(Dv,{asChild:!0,trapped:a,onMountAutoFocus:Te(s,R=>{var V;R.preventDefault(),(V=C.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:d.jsx(th,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:f,children:d.jsx(jj,{asChild:!0,...b,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:k,onCurrentTabStopIdChange:I,onEntryFocus:Te(l,R=>{x.isUsingKeyboardRef.current||R.preventDefault()}),preventScrollOnEntryFocus:!0,children:d.jsx(ON,{role:"menu","aria-orientation":"vertical","data-state":yH(y.open),"data-radix-menu-content":"",dir:x.dir,...v,...m,ref:S,style:{outline:"none",...m.style},onKeyDown:Te(m.onKeyDown,R=>{const G=R.target.closest("[data-radix-menu-content]")===R.currentTarget,W=R.ctrlKey||R.altKey||R.metaKey,B=R.key.length===1;G&&(R.key==="Tab"&&R.preventDefault(),!W&&B&&F(R.key));const Q=C.current;if(R.target!==Q||!twe.includes(R.key))return;R.preventDefault();const pe=w().filter(ie=>!ie.disabled).map(ie=>ie.ref.current);QV.includes(R.key)&&pe.reverse(),kwe(pe)}),onBlur:Te(e.onBlur,R=>{R.currentTarget.contains(R.target)||(window.clearTimeout(E.current),T.current="")}),onPointerMove:Te(e.onPointerMove,Yx(R=>{const V=R.target,G=L.current!==R.clientX;if(R.currentTarget.contains(V)&&G){const W=R.clientX>L.current?"right":"left";M.current=W,L.current=R.clientX}}))})})})})})})});tH.displayName=ai;var fwe="MenuGroup",lA=N.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return d.jsx(Qe.div,{role:"group",...r,ref:t})});lA.displayName=fwe;var mwe="MenuLabel",nH=N.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return d.jsx(Qe.div,{...r,ref:t})});nH.displayName=mwe;var I1="MenuItem",QP="menu.itemSelect",vk=N.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,s=N.useRef(null),i=Hv(I1,e.__scopeMenu),o=iA(I1,e.__scopeMenu),l=kt(t,s),c=N.useRef(!1),u=()=>{const h=s.current;if(!n&&h){const p=new CustomEvent(QP,{bubbles:!0,cancelable:!0});h.addEventListener(QP,f=>r==null?void 0:r(f),{once:!0}),WT(h,p),p.defaultPrevented?c.current=!1:i.onClose()}};return d.jsx(rH,{...a,ref:l,disabled:n,onClick:Te(e.onClick,u),onPointerDown:h=>{var p;(p=e.onPointerDown)==null||p.call(e,h),c.current=!0},onPointerUp:Te(e.onPointerUp,h=>{var p;c.current||(p=h.currentTarget)==null||p.click()}),onKeyDown:Te(e.onKeyDown,h=>{const p=o.searchRef.current!=="";n||p&&h.key===" "||RI.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});vk.displayName=I1;var rH=N.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...s}=e,i=iA(I1,n),o=YV(n),l=N.useRef(null),c=kt(t,l),[u,h]=N.useState(!1),[p,f]=N.useState("");return N.useEffect(()=>{const g=l.current;g&&f((g.textContent??"").trim())},[s.children]),d.jsx(Xx.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:d.jsx(Aj,{asChild:!0,...o,focusable:!r,children:d.jsx(Qe.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:c,onPointerMove:Te(e.onPointerMove,Yx(g=>{r?i.onItemLeave(g):(i.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Te(e.onPointerLeave,Yx(g=>i.onItemLeave(g))),onFocus:Te(e.onFocus,()=>h(!0)),onBlur:Te(e.onBlur,()=>h(!1))})})})}),gwe="MenuCheckboxItem",aH=N.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return d.jsx(uH,{scope:e.__scopeMenu,checked:n,children:d.jsx(vk,{role:"menuitemcheckbox","aria-checked":E1(n)?"mixed":n,...a,ref:t,"data-state":cA(n),onSelect:Te(a.onSelect,()=>r==null?void 0:r(E1(n)?!0:!n),{checkForDefaultPrevented:!1})})})});aH.displayName=gwe;var sH="MenuRadioGroup",[ywe,xwe]=ah(sH,{value:void 0,onValueChange:()=>{}}),iH=N.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,s=rr(r);return d.jsx(ywe,{scope:e.__scopeMenu,value:n,onValueChange:s,children:d.jsx(lA,{...a,ref:t})})});iH.displayName=sH;var oH="MenuRadioItem",lH=N.forwardRef((e,t)=>{const{value:n,...r}=e,a=xwe(oH,e.__scopeMenu),s=n===a.value;return d.jsx(uH,{scope:e.__scopeMenu,checked:s,children:d.jsx(vk,{role:"menuitemradio","aria-checked":s,...r,ref:t,"data-state":cA(s),onSelect:Te(r.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,n)},{checkForDefaultPrevented:!1})})})});lH.displayName=oH;var uA="MenuItemIndicator",[uH,vwe]=ah(uA,{checked:!1}),cH=N.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,s=vwe(uA,n);return d.jsx(Lr,{present:r||E1(s.checked)||s.checked===!0,children:d.jsx(Qe.span,{...a,ref:t,"data-state":cA(s.checked)})})});cH.displayName=uA;var bwe="MenuSeparator",dH=N.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return d.jsx(Qe.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});dH.displayName=bwe;var wwe="MenuArrow",hH=N.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=xk(n);return d.jsx(FN,{...a,...r,ref:t})});hH.displayName=wwe;var Nwe="MenuSub",[qat,pH]=ah(Nwe),qy="MenuSubTrigger",fH=N.forwardRef((e,t)=>{const n=sh(qy,e.__scopeMenu),r=Hv(qy,e.__scopeMenu),a=pH(qy,e.__scopeMenu),s=iA(qy,e.__scopeMenu),i=N.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},u=N.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return N.useEffect(()=>u,[u]),N.useEffect(()=>{const h=o.current;return()=>{window.clearTimeout(h),l(null)}},[o,l]),d.jsx(aA,{asChild:!0,...c,children:d.jsx(rH,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":yH(n.open),...e,ref:EN(t,a.onTriggerChange),onClick:h=>{var p;(p=e.onClick)==null||p.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Te(e.onPointerMove,Yx(h=>{s.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Te(e.onPointerLeave,Yx(h=>{var f,g;u();const p=(f=n.content)==null?void 0:f.getBoundingClientRect();if(p){const m=(g=n.content)==null?void 0:g.dataset.side,y=m==="right",x=y?-5:5,v=p[y?"left":"right"],b=p[y?"right":"left"];s.onPointerGraceIntentChange({area:[{x:h.clientX+x,y:h.clientY},{x:v,y:p.top},{x:b,y:p.top},{x:b,y:p.bottom},{x:v,y:p.bottom}],side:m}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(h),h.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:Te(e.onKeyDown,h=>{var f;const p=s.searchRef.current!=="";e.disabled||p&&h.key===" "||nwe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),h.preventDefault())})})})});fH.displayName=qy;var mH="MenuSubContent",gH=N.forwardRef((e,t)=>{const n=ZV(ai,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,s=sh(ai,e.__scopeMenu),i=Hv(ai,e.__scopeMenu),o=pH(mH,e.__scopeMenu),l=N.useRef(null),c=kt(t,l);return d.jsx(Xx.Provider,{scope:e.__scopeMenu,children:d.jsx(Lr,{present:r||s.open,children:d.jsx(Xx.Slot,{scope:e.__scopeMenu,children:d.jsx(oA,{id:o.contentId,"aria-labelledby":o.triggerId,...a,ref:c,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;i.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Te(e.onFocusOutside,u=>{u.target!==o.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:Te(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:Te(e.onKeyDown,u=>{var f;const h=u.currentTarget.contains(u.target),p=rwe[i.dir].includes(u.key);h&&p&&(s.onOpenChange(!1),(f=o.trigger)==null||f.focus(),u.preventDefault())})})})})})});gH.displayName=mH;function yH(e){return e?"open":"closed"}function E1(e){return e==="indeterminate"}function cA(e){return E1(e)?"indeterminate":e?"checked":"unchecked"}function kwe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Swe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function _we(e,t,n){const a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let i=Swe(e,Math.max(s,0));a.length===1&&(i=i.filter(c=>c!==n));const l=i.find(c=>c.toLowerCase().startsWith(a.toLowerCase()));return l!==n?l:void 0}function Cwe(e,t){const{x:n,y:r}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],l=t[i],c=o.x,u=o.y,h=l.x,p=l.y;u>r!=p>r&&n<(h-c)*(r-u)/(p-u)+c&&(a=!a)}return a}function Iwe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Cwe(n,t)}function Yx(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Ewe=JV,Twe=aA,jwe=eH,Awe=tH,$we=lA,Rwe=nH,Dwe=vk,Mwe=aH,Owe=iH,Fwe=lH,Pwe=cH,Lwe=dH,zwe=hH,Bwe=fH,Uwe=gH,bk="DropdownMenu",[Wwe,Kat]=ia(bk,[XV]),Ka=XV(),[Vwe,xH]=Wwe(bk),vH=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,l=Ka(t),c=N.useRef(null),[u,h]=Io({prop:a,defaultProp:s??!1,onChange:i,caller:bk});return d.jsx(Vwe,{scope:t,triggerId:$i(),triggerRef:c,contentId:$i(),open:u,onOpenChange:h,onOpenToggle:N.useCallback(()=>h(p=>!p),[h]),modal:o,children:d.jsx(Ewe,{...l,open:u,onOpenChange:h,dir:r,modal:o,children:n})})};vH.displayName=bk;var bH="DropdownMenuTrigger",wH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,s=xH(bH,n),i=Ka(n);return d.jsx(Twe,{asChild:!0,...i,children:d.jsx(Qe.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:EN(t,s.triggerRef),onPointerDown:Te(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(s.onOpenToggle(),s.open||o.preventDefault())}),onKeyDown:Te(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&s.onOpenToggle(),o.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});wH.displayName=bH;var Hwe="DropdownMenuPortal",NH=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Ka(t);return d.jsx(jwe,{...r,...n})};NH.displayName=Hwe;var kH="DropdownMenuContent",SH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=xH(kH,n),s=Ka(n),i=N.useRef(!1);return d.jsx(Awe,{id:a.contentId,"aria-labelledby":a.triggerId,...s,...r,ref:t,onCloseAutoFocus:Te(e.onCloseAutoFocus,o=>{var l;i.current||(l=a.triggerRef.current)==null||l.focus(),i.current=!1,o.preventDefault()}),onInteractOutside:Te(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!a.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});SH.displayName=kH;var Gwe="DropdownMenuGroup",qwe=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx($we,{...a,...r,ref:t})});qwe.displayName=Gwe;var Kwe="DropdownMenuLabel",_H=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Rwe,{...a,...r,ref:t})});_H.displayName=Kwe;var Qwe="DropdownMenuItem",CH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Dwe,{...a,...r,ref:t})});CH.displayName=Qwe;var Xwe="DropdownMenuCheckboxItem",IH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Mwe,{...a,...r,ref:t})});IH.displayName=Xwe;var Ywe="DropdownMenuRadioGroup",Jwe=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Owe,{...a,...r,ref:t})});Jwe.displayName=Ywe;var Zwe="DropdownMenuRadioItem",EH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Fwe,{...a,...r,ref:t})});EH.displayName=Zwe;var e0e="DropdownMenuItemIndicator",TH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Pwe,{...a,...r,ref:t})});TH.displayName=e0e;var t0e="DropdownMenuSeparator",jH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Lwe,{...a,...r,ref:t})});jH.displayName=t0e;var n0e="DropdownMenuArrow",r0e=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(zwe,{...a,...r,ref:t})});r0e.displayName=n0e;var a0e="DropdownMenuSubTrigger",AH=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Bwe,{...a,...r,ref:t})});AH.displayName=a0e;var s0e="DropdownMenuSubContent",$H=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Ka(n);return d.jsx(Uwe,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$H.displayName=s0e;var i0e=vH,o0e=wH,l0e=NH,RH=SH,DH=_H,MH=CH,OH=IH,FH=EH,PH=TH,LH=jH,zH=AH,BH=$H;const u0e=i0e,c0e=o0e,d0e=N.forwardRef(({className:e,inset:t,children:n,...r},a)=>d.jsxs(zH,{ref:a,className:Fe("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...r,children:[n,d.jsx(iU,{className:"ml-auto h-4 w-4"})]}));d0e.displayName=zH.displayName;const h0e=N.forwardRef(({className:e,...t},n)=>d.jsx(BH,{ref:n,className:Fe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));h0e.displayName=BH.displayName;const UH=N.forwardRef(({className:e,sideOffset:t=4,...n},r)=>d.jsx(l0e,{children:d.jsx(RH,{ref:r,sideOffset:t,className:Fe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));UH.displayName=RH.displayName;const DI=N.forwardRef(({className:e,inset:t,...n},r)=>d.jsx(MH,{ref:r,className:Fe("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));DI.displayName=MH.displayName;const p0e=N.forwardRef(({className:e,children:t,checked:n,...r},a)=>d.jsxs(OH,{ref:a,className:Fe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(PH,{children:d.jsx(qT,{className:"h-4 w-4"})})}),t]}));p0e.displayName=OH.displayName;const f0e=N.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(FH,{ref:r,className:Fe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(PH,{children:d.jsx(KT,{className:"h-2 w-2 fill-current"})})}),t]}));f0e.displayName=FH.displayName;const m0e=N.forwardRef(({className:e,inset:t,...n},r)=>d.jsx(DH,{ref:r,className:Fe("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));m0e.displayName=DH.displayName;const g0e=N.forwardRef(({className:e,...t},n)=>d.jsx(LH,{ref:n,className:Fe("-mx-1 my-1 h-px bg-muted",e),...t}));g0e.displayName=LH.displayName;const y0e=({applicant:e,isSelected:t,onSelect:n,onUpdate:r,onViewDetails:a,onViewComments:s,onCampusChange:i,campusList:o,schoolList:l,religionList:c,currentstatusList:u,questionSetList:h})=>{var g;const p=[e.first_name,e.middle_name,e.last_name].filter(Boolean).join(" ")||e.name||"No name",f=m=>m.split(" ").map(y=>y.charAt(0)).join("").toUpperCase().slice(0,2);return d.jsxs(Gr,{children:[d.jsx(Nt,{className:"sticky left-0 z-30 bg-white w-12 px-2",children:d.jsx(ik,{checked:t,onCheckedChange:()=>n(e.id),"aria-label":`Select ${p}`})}),d.jsx(Nt,{className:"w-12 px-2",children:d.jsxs(Zj,{className:"h-8 w-8",children:[d.jsx(zV,{src:e.image,alt:p}),d.jsx(eA,{className:"text-xs",children:f(p)})]})}),d.jsx(Nt,{className:"sticky left-10  bg-white z-20 min-w-[150px] max-w-[180px] px-2",children:d.jsx("div",{className:"truncate",children:d.jsx(Bn,{applicant:e,field:"first_name",displayValue:p,onUpdate:r,showPencil:!0})})}),d.jsx(Nt,{className:"min-w-[110px] max-w-[130px] px-2",children:d.jsx("div",{className:"truncate",children:d.jsx(Bn,{applicant:e,field:"phone_number",displayValue:e.phone_number||e.mobile_no||"No phone",onUpdate:r,showPencil:!0,showActionButtons:!1})})}),d.jsx(Nt,{className:"min-w-[110px] max-w-[130px] px-2",children:d.jsx("div",{className:"truncate",children:d.jsx(Bn,{applicant:e,field:"whatsapp_number",displayValue:e.whatsapp_number||"No WhatsApp",onUpdate:r,showPencil:!0,showActionButtons:!1})})}),d.jsx(Nt,{className:"min-w-[80px] max-w-[100px] px-2",children:d.jsx("div",{className:"truncate",children:d.jsx(Bn,{applicant:e,field:"gender",displayValue:e.gender||"Not specified",options:[{id:"male",name:"Male"},{id:"female",name:"Female"},{id:"other",name:"Other"}],onUpdate:r,showPencil:!1,showActionButtons:!1})})}),d.jsx(Nt,{className:"min-w-[90px] max-w-[120px] px-2",children:d.jsx("div",{className:"truncate",children:d.jsx(Bn,{applicant:e,field:"city",displayValue:e.city||"Not specified",onUpdate:r,showPencil:!0,showActionButtons:!1})})}),d.jsx(Nt,{className:"min-w-[120px] max-w-[150px] px-2",children:d.jsx("div",{className:"truncate",children:d.jsx(Bn,{applicant:e,field:"campus_id",displayValue:((g=o.find(m=>m.id===e.campus_id))==null?void 0:g.campus_name)||"N/A",value:e.campus_id,onUpdate:r,options:o.map(m=>({id:m.id,name:m.campus_name})),showPencil:!1,showActionButtons:!1})})}),d.jsx(Nt,{className:"min-w-[100px] max-w-[120px] px-2",children:d.jsx("div",{className:"truncate",children:d.jsx(Bn,{applicant:e,field:"stage_name",displayValue:e.stage_name||"N/A",value:e.stage_name,onUpdate:r,showPencil:!1,showActionButtons:!1,disabled:!0,tooltipMessage:"Current stage update by student details"})})}),d.jsx(Nt,{className:"w-16 px-2",children:d.jsxs(u0e,{children:[d.jsx(c0e,{asChild:!0,children:d.jsx(fe,{variant:"ghost",size:"sm",children:d.jsx(yse,{className:"h-4 w-4"})})}),d.jsxs(UH,{align:"end",side:"bottom",sideOffset:5,className:"bg-background border border-border shadow-lg z-50",children:[d.jsx(DI,{onClick:()=>a(e),children:"View Details"}),d.jsx(DI,{onClick:()=>s(e),children:"Comments"})]})]})})]},e.id)},WH=()=>{const[e,t]=N.useState(!1),[n,r]=N.useState(!1),[a,s]=N.useState(!1),[i,o]=N.useState(!1),[l,c]=N.useState(null),[u,h]=N.useState(null),[p,f]=N.useState([]),[g,m]=N.useState([]),[y,x]=N.useState([]),[v,b]=N.useState([]),[w,k]=N.useState([]),[I,C]=N.useState([]),[S,E]=N.useState(""),[T,$]=N.useState({stage:"all",status:"all",examMode:"all",interviewMode:"all",partner:[],district:[],market:[],dateRange:{type:"application"}}),[_,M]=N.useState([]),[L,U]=N.useState(1),O=10,{toast:F}=Qt(),{data:D,isLoading:R,refetch:V}=nh({queryKey:["students",L,O],queryFn:()=>ehe(L,O),keepPreviousData:!0}),G=(D==null?void 0:D.data)||[];console.log("Fetched students:",G);const W=(D==null?void 0:D.totalCount)||0,B=(D==null?void 0:D.totalPages)||Math.max(1,Math.ceil(W/O));N.useEffect(()=>{(async()=>{try{const[ue,ke,_e]=await Promise.all([KN(),QN(),qN()]);f(ue||[]),m(ke||[]),k(_e||[])}catch(ue){console.error("Failed to fetch campuses/schools:",ue)}})()},[]),N.useEffect(()=>{(async()=>{try{const[ue,ke]=await Promise.all([che(),vj()]);b(ue||[]),x(ke||[])}catch(ue){console.error("Failed to fetch stages/statuses:",ue)}})()},[]),N.useEffect(()=>{(async()=>{try{const ue=await xj();C(ue||[])}catch(ue){console.error("Error fetching question sets:",ue)}})()},[]);const Q=N.useMemo(()=>G.map(ae=>{const ue=g.find(it=>it.id===ae.school_id),ke=p.find(it=>it.id===ae.campus_id),_e=y.find(it=>it.id===ae.current_status_id),qe=w.find(it=>it.id===ae.religion_id),Ue=I.find(it=>it.id===ae.question_set_id);return{...ae,mobile_no:ae.mobile_no||ae.phone_number||"",name:`${ae.first_name||""} ${ae.middle_name||""} ${ae.last_name||""}`.trim(),school_name:ue?ue.school_name:"N/A",campus_name:ke?ke.campus_name:"N/A",current_status_name:_e?_e.current_status_name:"N/A",religion_name:qe?qe.religion_name:"N/A",question_set_name:Ue?Ue.name:"N/A",maximumMarks:Ue?Ue.maximumMarks:0}}),[G,g,p,y,w,I]),X=N.useMemo(()=>{if(!Q)return[];if(!S)return Q;const ae=new RegExp(S,"i");return Q.filter(ue=>ae.test(ue.name||"")||ae.test(ue.phone_number||"")||ae.test(ue.whatsapp_number||""))},[Q,S]),pe=N.useCallback(ae=>{M(ue=>ue.includes(ae)?ue.filter(ke=>ke!==ae):[...ue,ae])},[]),ie=N.useCallback(()=>{M(ae=>ae.length===X.length?[]:X.map(ue=>ue.id))},[X]),oe=N.useCallback(()=>{U(1),V()},[V]),q=async()=>{if(!_.length){F({title:"No Selection",description:"Please select applicants to delete",variant:"destructive"});return}try{await Promise.all(_.map(ae=>Pde(ae))),F({title:"Applicants Deleted",description:"Successfully deleted selected applicants"}),M([]),oe()}catch(ae){console.error("Error deleting applicants:",ae),F({title:"Error",description:"Failed to delete applicants",variant:"destructive"})}},de=async()=>{_.length||F({title:"No Selection",description:"Please select applicants to send offer letters to",variant:"destructive"})},ye=ae=>$(ae),be=()=>{if(!X.length){F({title:"No Data",description:"No applicants to export",variant:"destructive"});return}const ae=["first_name","middle_name","last_name","dob","gender","email","phone_number","whatsapp_number","state","district","city","block","pin_code","school_medium","cast_name","religion_name"],ue=[ae.join(","),...X.map(Ue=>ae.map(it=>{const yt=Ue[it];if(yt==null)return"";const At=String(yt);return At.includes(",")?`"${At}"`:At}).join(","))].join(`
`),ke=new Blob([ue],{type:"text/csv;charset=utf-8;"}),_e=document.createElement("a"),qe=URL.createObjectURL(ke);_e.setAttribute("href",qe),_e.setAttribute("download",`applicants_${new Date().toISOString().split("T")[0]}.csv`),_e.style.visibility="hidden",document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),F({title:"Export Complete",description:`Exported ${X.length} applicants to CSV`})},Ce=G.length===0?0:(L-1)*O+1,se=Math.min(L*O,W);return d.jsxs(Ct,{className:"h-full flex flex-col",children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 md:gap-0",children:[d.jsxs("div",{className:"flex flex-col mr-10",children:[d.jsx(Yt,{children:"Applicants"}),d.jsx(vs,{className:"text-sm text-muted-foreground",children:S?`${X.length} applicants found (filtered)`:`${W} total applicants`})]}),d.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 md:mt-0",children:[d.jsx(Jbe,{selectedRowsCount:_.length,onBulkUpdate:()=>s(!0),onSendOfferLetters:de,onBulkDelete:q}),d.jsx(Zbe,{onCSVImport:()=>o(!0),onExportCSV:be,onShowFilters:()=>r(!0),onAddApplicant:()=>t(!0)})]})]})}),d.jsxs(It,{className:"flex-1 flex flex-col",children:[d.jsx("div",{className:"mb-4 space-y-2",children:d.jsxs("div",{className:"relative",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),d.jsx(Je,{type:"search",placeholder:"Search applicants...",className:"pl-10",value:S,onChange:ae=>E(ae.target.value)})]})}),d.jsx("div",{className:"flex-1 border rounded-md overflow-hidden",children:d.jsx("div",{className:"h-full overflow-auto",children:d.jsxs(zu,{children:[d.jsx(Bu,{className:"sticky top-0 bg-background z-10 border-b",children:d.jsxs(Gr,{children:[d.jsx(Ft,{className:"sticky left-0 bg-background z-10 w-12 px-2",children:d.jsx(ik,{checked:X.length>0&&_.length===X.length,onCheckedChange:ie,"aria-label":"Select all applicants"})}),d.jsx(Ft,{className:"font-bold w-12 px-3",children:"Image"}),d.jsx(Ft,{className:"sticky left-12 bg-background z-10 min-w-[150px] px-3",children:"Full Name"}),d.jsx(Ft,{className:"font-bold min-w-[110px] max-w-[130px] px-3",children:"Phone Number"}),d.jsx(Ft,{className:"font-bold min-w-[140px] max-w-[180px] px-3",children:"WhatsApp Number"}),d.jsx(Ft,{className:"font-bold min-w-[80px] max-w-[100px] px-3",children:"Gender"}),d.jsx(Ft,{className:"font-bold min-w-[90px] max-w-[120px] px-3",children:"City"}),d.jsx(Ft,{className:"font-bold min-w-[120px] max-w-[150px] px-3",children:"Campus"}),d.jsx(Ft,{className:"font-bold min-w-[120px] max-w-[150px] px-3",children:"Current Stage"}),d.jsx(Ft,{className:"w-16 font-bold px-3",children:"Actions"})]})}),d.jsx(Uu,{children:X.length===0?d.jsx(Gr,{children:d.jsx(Nt,{colSpan:13,className:"text-center text-muted-foreground py-6",children:"No applicants found."})}):X.map(ae=>d.jsx(y0e,{applicant:ae,isSelected:_.includes(ae.id),onSelect:pe,onUpdate:oe,onViewDetails:c,onViewComments:h,schoolList:g,campusList:p,religionList:w,currentstatusList:y,questionSetList:I},ae.id))})]})})}),d.jsxs("div",{className:"flex justify-between items-center mt-4",children:[d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",Ce," – ",se," of ",W]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>U(ae=>Math.max(ae-1,1)),disabled:L===1,className:"px-3 py-1 rounded border bg-white disabled:opacity-50",children:"Previous"}),d.jsx("button",{onClick:()=>U(ae=>Math.min(ae+1,B)),disabled:L===B,className:"px-3 py-1 rounded border bg-white disabled:opacity-50",children:"Next"})]})]})]}),d.jsx(Efe,{isOpen:e,onClose:()=>t(!1),onSuccess:oe,schoolList:g,campusList:p,currentstatusList:y,religionList:w,questionSetList:I}),d.jsx(Xbe,{isOpen:i,onClose:()=>o(!1),onSuccess:oe}),d.jsx(eV,{isOpen:n,onClose:()=>r(!1),onApplyFilters:ye,currentFilters:T,students:G,campusList:p,schoolList:g,religionList:w,currentstatusList:y}),d.jsx(vbe,{isOpen:a,onClose:()=>s(!1),selectedApplicants:_,onSuccess:oe}),d.jsx(Bbe,{applicant:l,isOpen:!!l,onClose:()=>c(null)}),d.jsx(BV,{applicantId:(u==null?void 0:u.id)||"",applicantName:(u==null?void 0:u.name)||"",isOpen:!!u,onClose:()=>h(null)})]})},VH=()=>d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Admissions Dashboard"}),d.jsx("p",{className:"text-muted-foreground",children:"Track and manage applicant progress through Navgurukul's admission process"})]}),d.jsx("div",{className:"mb-8",children:d.jsx(ofe,{})}),d.jsx(WH,{})]})})]}),MI=[{id:1,name:"Rukhsar khan",number:"9960511321",altNumber:"",email:"rukh­sarkhan20@navgurukul.org",gender:"Female",joinedDate:"25 Jul 2021",stage:"offerLetterSent",jobKab:"N/A",daysPassed:"N/A",kitneAurDin:"",kitneDinLaenge:"",qualification:"Class 10th",partnerName:"Akanksha Foundation",campus:""},{id:2,name:"Akash Deshmukh",number:"9623738495",altNumber:"",email:"Update Email",gender:"Male",joinedDate:"12 Sep 2022",stage:"offerLetterSent",jobKab:"N/A",daysPassed:"N/A",kitneAurDin:"",kitneDinLaenge:"",qualification:"Graduate",partnerName:"jojopulli@gmail",campus:""},{id:3,name:"Ankur Singhalvbb",number:"8755531363",altNumber:"8755531363",email:"jayshri20@navgurukul.org",gender:"",joinedDate:"",stage:"offerLetterSent",jobKab:"N/A",daysPassed:"N/A",kitneAurDin:"",kitneDinLaenge:"",qualification:"Graduate",partnerName:"katha",campus:""},{id:4,name:"Dipesh Rangwani",number:"7385419562",altNumber:"7385419562",email:"Update Email",gender:"Male",joinedDate:"12 Sep 2022",stage:"offerLetterSent",jobKab:"N/A",daysPassed:"N/A",kitneAurDin:"",kitneDinLaenge:"",qualification:"Class 12th",partnerName:"United way of Hyderabad",campus:""}],Ow=[{id:1,name:"Accenture C1"},{id:2,name:"Accenture C2"},{id:3,name:"Accenture C3"},{id:4,name:"Microsoft C1"},{id:5,name:"KPMG C1"},{id:6,name:"LTI"},{id:7,name:"DxC ( EIT)"},{id:8,name:"ACL"},{id:9,name:"Macquarie"}],x0e=[{value:"offerLetterSent",label:"Offer Letter Sent"},{value:"joined",label:"Joined"},{value:"pending",label:"Pending"}],v0e=[{value:"",label:"Select..."},{value:"Bangalore",label:"Bangalore"},{value:"Pune",label:"Pune"},{value:"Delhi",label:"Delhi"}],b0e=[{value:"",label:"Select..."},{value:"Male",label:"Male"},{value:"Female",label:"Female"},{value:"Other",label:"Other"}],w0e=Array.from(new Set(MI.map(e=>e.partnerName).filter(Boolean))),HH=()=>{const[e,t]=N.useState(""),[n,r]=N.useState("Accenture C1 Donor"),[a,s]=N.useState(!1),i=MI.filter(o=>o.name.toLowerCase().includes(e.toLowerCase())||o.email.toLowerCase().includes(e.toLowerCase())||o.partnerName.toLowerCase().includes(e.toLowerCase()));return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsxs("main",{className:"md:ml-64 p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:[d.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Total Students"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:MI.length})]}),d.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:d.jsx(kd,{className:"w-6 h-6 text-primary"})})]}),d.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Total Donors"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:Ow.length})]}),d.jsx("div",{className:"w-12 h-12 bg-status-prospect/10 rounded-lg flex items-center justify-center",children:d.jsx(uU,{className:"w-6 h-6 text-status-prospect"})})]}),d.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Unique Partners"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:w0e.length})]}),d.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:d.jsx(kd,{className:"w-6 h-6 text-status-active"})})]})]}),d.jsx("h1",{className:"text-3xl font-bold text-center mb-6",children:n}),d.jsxs("div",{className:"flex items-center justify-between mb-6 gap-2",children:[d.jsxs("div",{className:"flex items-center gap-2 w-full max-w-md",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search by name, email, or partner...",value:e,onChange:o=>t(o.target.value),className:"pl-10 h-10"})]}),d.jsxs(fe,{variant:"outline",size:"sm",className:"h-10 flex items-center gap-2",children:[d.jsx($m,{className:"w-4 h-4"}),"Filter"]})]}),d.jsxs(ta,{open:a,onOpenChange:s,children:[d.jsx(f5,{asChild:!0,children:d.jsx(fe,{variant:"outline",className:"px-6 py-2 rounded font-semibold",children:"Donor List"})}),d.jsxs(na,{children:[d.jsx(ra,{children:"Donors Name"}),d.jsxs(zu,{children:[d.jsx(Bu,{children:d.jsxs(Gr,{children:[d.jsx(Ft,{className:"w-16",children:"S.No"}),d.jsx(Ft,{children:"Name"})]})}),d.jsx(Uu,{children:Ow.map((o,l)=>d.jsxs(Gr,{children:[d.jsx(Nt,{children:l+1}),d.jsx(Nt,{children:d.jsx("button",{className:"text-red-600 font-medium hover:underline focus:outline-none",onClick:()=>{r(o.name),s(!1)},children:o.name})})]},o.id))})]}),d.jsxs("div",{className:"text-xs text-muted-foreground mt-2 text-right",children:["Rows per page: 10   1-",Ow.length," of ",Ow.length]})]})]})]}),d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-x-auto",children:[d.jsxs(zu,{children:[d.jsx(Bu,{children:d.jsxs(Gr,{children:[d.jsx(Ft,{children:"Name"}),d.jsx(Ft,{children:"Number"}),d.jsx(Ft,{children:"Alternative Number"}),d.jsx(Ft,{children:"Email"}),d.jsx(Ft,{children:"Gender"}),d.jsx(Ft,{children:"Joined Date"}),d.jsx(Ft,{children:"Stage"}),d.jsx(Ft,{children:"Job Kab Lagegi.."}),d.jsx(Ft,{children:"Days Passed"}),d.jsx(Ft,{children:"kitne Aur Din"}),d.jsx(Ft,{children:"kitne Din Laenge"}),d.jsx(Ft,{children:"Qualification"}),d.jsx(Ft,{children:"Partner Name"}),d.jsx(Ft,{children:"Campus"})]})}),d.jsx(Uu,{children:i.map((o,l)=>d.jsxs(Gr,{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[d.jsx(Nt,{className:"p-4",children:o.name}),d.jsx(Nt,{className:"p-4",children:o.number}),d.jsx(Nt,{className:"p-4",children:o.altNumber}),d.jsx(Nt,{className:"p-4",children:o.email}),d.jsx(Nt,{className:"p-4",children:d.jsx("select",{className:"border rounded px-2 py-1 text-sm w-full",children:b0e.map(c=>d.jsx("option",{value:c.value,selected:o.gender===c.value,children:c.label},c.value))})}),d.jsx(Nt,{className:"p-4",children:o.joinedDate}),d.jsx(Nt,{className:"p-4",children:d.jsx("select",{className:"border rounded px-2 py-1 text-sm w-full",children:x0e.map(c=>d.jsx("option",{value:c.value,selected:o.stage===c.value,children:c.label},c.value))})}),d.jsx(Nt,{className:"p-4",children:o.jobKab}),d.jsx(Nt,{className:"p-4",children:o.daysPassed}),d.jsx(Nt,{className:"p-4",children:o.kitneAurDin}),d.jsx(Nt,{className:"p-4",children:o.kitneDinLaenge}),d.jsx(Nt,{className:"p-4",children:o.qualification}),d.jsx(Nt,{className:"p-4",children:o.partnerName}),d.jsx(Nt,{className:"p-4",children:d.jsx("select",{className:"border rounded px-2 py-1 text-sm w-full",children:v0e.map(c=>d.jsx("option",{value:c.value,selected:o.campus===c.value,children:c.label},c.value))})})]},o.id))})]}),d.jsxs("div",{className:"text-xs text-muted-foreground mt-2 text-right p-4",children:["Rows per page: 10   1-",i.length," of ",i.length]})]})]})]})},N0e=["Edit","Name","View Assessments","Create Assessment","Joined Students Progress","Online Test","Meraki Link","Send Report"],Fw=10,Ry={name:"",emails:[""],notes:"",slug:"",districts:[""]},GH=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(!1),[i,o]=N.useState(!1),[l,c]=N.useState(null),[u,h]=N.useState(1),[p,f]=N.useState({open:!1,idx:null,form:Ry}),[g,m]=N.useState(""),[y,x]=N.useState(!1),[v,b]=N.useState({district:"",slug:"",emailDomain:""}),[w,k]=N.useState({open:!1,form:Ry}),{toast:I}=Qt();N.useEffect(()=>{fetch("https://dev-join.navgurukul.org/api/partners").then(se=>se.json()).then(se=>{t(se.data||[]),r(!1)}).catch(()=>r(!1))},[]);const C=e.filter(se=>{var qe,Ue,it,yt,At;const ae=!g.trim()||((qe=se.name)==null?void 0:qe.toLowerCase().includes(g.toLowerCase()))||((Ue=se.email)==null?void 0:Ue.toLowerCase().includes(g.toLowerCase()))||((it=se.slug)==null?void 0:it.toLowerCase().includes(g.toLowerCase())),ue=v.district?(se.districts||[]).some(Bt=>Bt.toLowerCase().includes(v.district.toLowerCase())):!0,ke=v.slug?(yt=se.slug)==null?void 0:yt.toLowerCase().includes(v.slug.toLowerCase()):!0,_e=v.emailDomain?(At=se.email)==null?void 0:At.toLowerCase().endsWith(v.emailDomain.toLowerCase()):!0;return ae&&ue&&ke&&_e});$e.useEffect(()=>{h(1)},[g,v]);const S=C.slice((u-1)*Fw,u*Fw),E=Math.ceil(C.length/Fw),T=()=>{const se=N0e.map(Ue=>Ue==="Edit"?"Edit Partner Details":Ue),ae=S.map(Ue=>["Edit",Ue.name,"View Assessments","+Create","Get Information","Go for test",Ue.meraki_link||"-","Send Report"]),ue=[se,...ae].map(Ue=>Ue.map(it=>`"${it??""}"`).join(",")).join(`
`),ke=new Blob([ue],{type:"text/csv;charset=utf-8;"}),_e=URL.createObjectURL(ke),qe=document.createElement("a");qe.href=_e,qe.setAttribute("download","partners.csv"),document.body.appendChild(qe),qe.click(),document.body.removeChild(qe),URL.revokeObjectURL(_e),I({title:"Success",description:"CSV file downloaded successfully"})},$=se=>{const ae=e[se];f({open:!0,idx:se,form:{name:ae.name||"",emails:ae.email?[ae.email]:[""],notes:ae.notes||"",slug:ae.slug||"",districts:ae.districts&&ae.districts.length>0?[...ae.districts]:[""]}})},_=()=>{f({open:!1,idx:null,form:Ry})},M=(se,ae)=>{f(ue=>({...ue,form:{...ue.form,[se]:ae}}))},L=(se,ae)=>{f(ue=>({...ue,form:{...ue.form,emails:ue.form.emails.map((ke,_e)=>_e===se?ae:ke)}}))},U=(se,ae)=>{f(ue=>({...ue,form:{...ue.form,districts:ue.form.districts.map((ke,_e)=>_e===se?ae:ke)}}))},O=()=>{f(se=>({...se,form:{...se.form,emails:[...se.form.emails,""]}}))},F=se=>{f(ae=>({...ae,form:{...ae.form,emails:ae.form.emails.filter((ue,ke)=>ke!==se)}}))},D=()=>{f(se=>({...se,form:{...se.form,districts:[...se.form.districts,""]}}))},R=se=>{f(ae=>({...ae,form:{...ae.form,districts:ae.form.districts.filter((ue,ke)=>ke!==se)}}))},V=se=>{se.preventDefault(),t(ae=>{const ue=[...ae],ke=p.idx;return ue[ke]={...ue[ke],name:p.form.name,email:p.form.emails[0]||"",notes:p.form.notes,slug:p.form.slug,districts:p.form.districts},ue}),_()},G=()=>{k({open:!0,form:Ry})},W=()=>{k({open:!1,form:Ry})},B=(se,ae)=>{k(ue=>({...ue,form:{...ue.form,[se]:ae}}))},Q=(se,ae)=>{k(ue=>({...ue,form:{...ue.form,emails:ue.form.emails.map((ke,_e)=>_e===se?ae:ke)}}))},X=(se,ae)=>{k(ue=>({...ue,form:{...ue.form,districts:ue.form.districts.map((ke,_e)=>_e===se?ae:ke)}}))},pe=()=>{k(se=>({...se,form:{...se.form,emails:[...se.form.emails,""]}}))},ie=se=>{k(ae=>({...ae,form:{...ae.form,emails:ae.form.emails.filter((ue,ke)=>ke!==se)}}))},oe=()=>{k(se=>({...se,form:{...se.form,districts:[...se.form.districts,""]}}))},q=se=>{k(ae=>({...ae,form:{...ae.form,districts:ae.form.districts.filter((ue,ke)=>ke!==se)}}))},de=se=>{se.preventDefault(),!(!w.form.name.trim()||!w.form.emails[0].trim()||!w.form.districts[0].trim())&&(t(ae=>[...ae,{id:Date.now(),name:w.form.name,email:w.form.emails[0]||"",notes:w.form.notes,slug:w.form.slug,districts:w.form.districts,meraki_link:""}]),W(),I({title:"Success",description:"Partner added successfully!"}))},ye=se=>{c(se),s(!0)},be=se=>{c(se),o(!0)},Ce=()=>{s(!1),o(!1),c(null)};return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen flex flex-col items-center",children:d.jsxs("div",{className:"p-4 md:p-8 w-full pt-16 md:pt-8",children:[d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border",children:[d.jsxs("div",{className:"p-6 border-b border-border",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Partners"}),d.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Manage and track partner details"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs(fe,{variant:"outline",onClick:T,className:"h-9",children:[d.jsx($N,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),d.jsxs(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white h-9",onClick:G,children:[d.jsx(Qn,{className:"w-4 h-4 mr-2"}),"Add Partner"]})]})]}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsxs("div",{className:"relative flex-1 max-w-md",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search by name, email, or slug...",value:g,onChange:se=>m(se.target.value),className:"pl-10 h-9"})]}),d.jsxs(fe,{variant:"outline",size:"sm",className:"h-9",onClick:()=>x(!0),children:[d.jsx($m,{className:"w-4 h-4 mr-2"}),"Filter"]}),Object.values(v).some(Boolean)&&d.jsx(fe,{variant:"ghost",size:"sm",className:"h-9",onClick:()=>b({district:"",slug:"",emailDomain:""}),children:"Clear Filters"})]})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b border-border/50",children:[d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Partner"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Email"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Slug"}),d.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Districts"}),d.jsx("th",{className:"text-center py-4 px-6 font-medium text-muted-foreground text-sm w-20",children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Loading partners..."})]})})}):S.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx(wa,{className:"w-8 h-8 opacity-50"}),d.jsx("span",{children:"No partners found"})]})})}):S.map((se,ae)=>d.jsxs("tr",{className:"border-b border-border/30 hover:bg-muted/30 transition-colors group",children:[d.jsx("td",{className:"py-4 px-6",children:d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0",children:d.jsx("span",{className:"text-primary text-sm font-medium",children:se.name?se.name.split(" ").map(ue=>ue[0]).join(""):"?"})}),d.jsxs("div",{className:"min-w-0",children:[d.jsx("p",{className:"font-medium text-foreground truncate",children:se.name||"No Name"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:se.notes||"No notes"})]})]})}),d.jsx("td",{className:"py-4 px-6",children:d.jsx("span",{className:"text-sm text-foreground",children:se.email||"No email"})}),d.jsx("td",{className:"py-4 px-6",children:d.jsx("span",{className:"text-sm text-foreground",children:se.slug||"No slug"})}),d.jsx("td",{className:"py-4 px-6",children:d.jsx("span",{className:"text-sm text-foreground",children:se.districts&&se.districts.length>0?se.districts.join(", "):"No districts"})}),d.jsx("td",{className:"py-4 px-6 text-center",children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(fe,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-muted",onClick:()=>$((u-1)*Fw+ae),title:"Edit Partner",children:d.jsx(Fu,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-muted",onClick:()=>ye(se),title:"View Assessments",children:d.jsx(lU,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-muted",onClick:()=>be(se),title:"Create Assessment",children:d.jsx(Qn,{className:"w-4 h-4"})})]})})]},se.id))})]})}),d.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",S.length," of ",e.length," partners"]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>h(se=>Math.max(1,se-1)),disabled:u===1,children:"Previous"}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",u," of ",E]}),d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>h(se=>Math.min(E,se+1)),disabled:u===E,children:"Next"})]})]})})]}),p.open&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:d.jsxs("form",{className:"bg-white rounded-lg p-8 w-full max-w-lg shadow-lg overflow-y-auto max-h-[90vh]",onSubmit:V,children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Partner"}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Partner Name"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:p.form.name,onChange:se=>M("name",se.target.value),required:!0}),d.jsx("span",{className:"text-xs text-gray-500",children:"Partner ka Name Enter karein."})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),p.form.emails.map((se,ae)=>d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("input",{type:"email",className:"border px-3 py-2 rounded w-full",value:se,onChange:ue=>L(ae,ue.target.value),required:!0}),p.form.emails.length>1&&d.jsx("button",{type:"button",className:"text-red-500",onClick:()=>F(ae),children:d.jsx(us,{size:18})})]},ae)),d.jsxs("button",{type:"button",className:"flex items-center text-orange-600 mt-1",onClick:O,children:[d.jsx(Qn,{size:18,className:"mr-1"}),"ADD ANOTHER EMAIL"]}),d.jsx("span",{className:"text-xs text-gray-500 block",children:"Partner ka Email Enter karein."})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:p.form.notes,onChange:se=>M("notes",se.target.value)}),d.jsx("span",{className:"text-xs text-gray-500",children:"Partner ki thodi details add karein."})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slug"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:p.form.slug,onChange:se=>M("slug",se.target.value)}),d.jsx("span",{className:"text-xs text-gray-500",children:"Partner ke student ko online test dene ke liye Slug add karo."})]}),p.form.districts.map((se,ae)=>d.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("label",{className:"block text-sm font-medium mb-1",children:["District ",ae+1]}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:se,onChange:ue=>U(ae,ue.target.value),required:!0}),d.jsxs("span",{className:"text-xs text-gray-500",children:["Enter District ",ae+1]})]}),p.form.districts.length>1&&d.jsx("button",{type:"button",className:"text-red-500 mt-6",onClick:()=>R(ae),children:d.jsx(us,{size:18})})]},ae)),d.jsxs("button",{type:"button",className:"flex items-center text-orange-600 mt-1",onClick:D,children:[d.jsx(Qn,{size:18,className:"mr-1"}),"ADD ANOTHER DISTRICT"]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-8",children:[d.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",onClick:_,children:"CANCEL"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600",children:"UPDATE PARTNER"})]})]})}),w.open&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:d.jsxs("form",{className:"bg-white rounded-lg p-8 w-full max-w-lg shadow-lg overflow-y-auto max-h-[90vh]",onSubmit:de,children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Partner"}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Partner Name"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:w.form.name,onChange:se=>B("name",se.target.value),required:!0}),d.jsx("span",{className:"text-xs text-gray-500",children:"Partner ka Name Enter karein."})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),w.form.emails.map((se,ae)=>d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("input",{type:"email",className:"border px-3 py-2 rounded w-full",value:se,onChange:ue=>Q(ae,ue.target.value),required:!0}),w.form.emails.length>1&&d.jsx("button",{type:"button",className:"text-red-500",onClick:()=>ie(ae),children:d.jsx(us,{size:18})})]},ae)),d.jsxs("button",{type:"button",className:"flex items-center text-orange-600 mt-1",onClick:pe,children:[d.jsx(Qn,{size:18,className:"mr-1"}),"ADD ANOTHER EMAIL"]}),d.jsx("span",{className:"text-xs text-gray-500 block",children:"Partner ka Email Enter karein."})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:w.form.notes,onChange:se=>B("notes",se.target.value)}),d.jsx("span",{className:"text-xs text-gray-500",children:"Partner ki thodi details add karein."})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slug"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:w.form.slug,onChange:se=>B("slug",se.target.value)}),d.jsx("span",{className:"text-xs text-gray-500",children:"Partner ke student ko online test dene ke liye Slug add karo."})]}),w.form.districts.map((se,ae)=>d.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("label",{className:"block text-sm font-medium mb-1",children:["District ",ae+1]}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",value:se,onChange:ue=>X(ae,ue.target.value),required:!0}),d.jsxs("span",{className:"text-xs text-gray-500",children:["Enter District ",ae+1]})]}),w.form.districts.length>1&&d.jsx("button",{type:"button",className:"text-red-500 mt-6",onClick:()=>q(ae),children:d.jsx(us,{size:18})})]},ae)),d.jsxs("button",{type:"button",className:"flex items-center text-orange-600 mt-1",onClick:oe,children:[d.jsx(Qn,{size:18,className:"mr-1"}),"ADD ANOTHER DISTRICT"]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-8",children:[d.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",onClick:W,children:"CANCEL"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600",children:"ADD PARTNER"})]})]})}),a&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-8 w-full max-w-lg shadow-lg",children:[d.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Assessments for ",l==null?void 0:l.name]}),d.jsx("p",{className:"mb-4",children:"(Assessment details modal placeholder)"}),d.jsx("button",{className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:Ce,children:"Close"})]})}),i&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:d.jsxs("div",{className:"bg-white rounded-lg p-8 w-full max-w-md shadow-lg",children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create New Assessment"}),d.jsx("input",{type:"text",placeholder:"Paper set name",className:"border px-3 py-2 rounded w-full mb-4"}),d.jsx("button",{className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600",onClick:Ce,children:"Create"}),d.jsx("button",{className:"ml-2 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",onClick:Ce,children:"Cancel"})]})}),y&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:d.jsxs("form",{className:"bg-white rounded-lg p-8 w-full max-w-md shadow-lg overflow-y-auto max-h-[90vh]",onSubmit:se=>{se.preventDefault(),x(!1)},children:[d.jsx("h2",{className:"text-xl font-bold mb-4",children:"Filter Partners"}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"District"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",placeholder:"Enter district name",value:v.district,onChange:se=>b(ae=>({...ae,district:se.target.value}))})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slug"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",placeholder:"Enter slug",value:v.slug,onChange:se=>b(ae=>({...ae,slug:se.target.value}))})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email Domain"}),d.jsx("input",{type:"text",className:"border px-3 py-2 rounded w-full",placeholder:"e.g. gmail.com",value:v.emailDomain,onChange:se=>b(ae=>({...ae,emailDomain:se.target.value}))})]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-8",children:[d.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",onClick:()=>x(!1),children:"CANCEL"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600",children:"APPLY FILTERS"})]})]})})]})})]})},qH=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(!1),[i,o]=N.useState(null),[l,c]=N.useState(""),[u,h]=N.useState(1),p=10,[f,g]=N.useState(!1),[m,y]=N.useState(!1),[x,v]=N.useState(!1),[b,w]=N.useState(""),[k,I]=N.useState(""),[C,S]=N.useState(null),E=async(V=!1)=>{V&&r(!0);try{const G=await KN();t(G)}catch(G){o(G instanceof Error?G.message:"An unknown error occurred")}finally{V&&r(!1)}};N.useEffect(()=>{E(!0)},[]);const T=e.filter(V=>V.campus_name.toLowerCase().includes(l.toLowerCase())),$=Math.ceil(T.length/p),_=u*p,M=_-p,L=T.slice(M,_),U=()=>{u<$&&h(V=>V+1)},O=()=>{u>1&&h(V=>V-1)},F=async V=>{V.preventDefault(),s(!0);try{await dhe(b),g(!1),w(""),as({title:"Campus Added",description:"Campus has been successfully added."}),await E(!1),h(1)}catch(G){as({title:"Error",description:G instanceof Error?G.message:"Unknown error",variant:"destructive"})}finally{s(!1)}},D=async(V,G)=>{s(!0);try{await hhe(V,G),y(!1),S(null),as({title:"Campus Updated",description:`Campus "${G}" updated successfully.`}),await E(!1)}catch(W){as({title:"Error",description:W instanceof Error?W.message:"Unknown error",variant:"destructive"})}finally{s(!1)}},R=async(V,G)=>{s(!0);try{await phe(V),v(!1),S(null),as({title:"Campus Deleted",description:`Campus "${G}" has been deleted.`}),await E(!1),h(1)}catch(W){as({title:"Error",description:W instanceof Error?W.message:"Unknown error",variant:"destructive"})}finally{s(!1)}};return d.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[d.jsx(ar,{}),d.jsx("main",{className:"flex-1 p-4 md:p-8 pt-20 md:pt-8 md:ml-64",children:d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[d.jsxs("div",{children:[d.jsx(Yt,{className:"text-2xl",children:"Campuses Name"}),d.jsx(vs,{children:"A list of all the campuses."})]}),d.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full md:w-auto",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(wa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),d.jsx(Je,{type:"search",placeholder:"Search campus...",className:"pl-8 w-full",value:l,onChange:V=>{c(V.target.value),h(1)}})]}),d.jsxs(fe,{onClick:()=>g(!0),children:[d.jsx(Qn,{className:"mr-2 h-4 w-4"})," Add Campus"]})]})]})}),d.jsx(It,{children:n?d.jsx("p",{children:"Loading..."}):i?d.jsx("p",{className:"text-red-500",children:i}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs(zu,{children:[d.jsx(Bu,{children:d.jsxs(Gr,{children:[d.jsx(Ft,{children:"S.No"}),d.jsx(Ft,{children:"Campus Name"}),d.jsx(Ft,{className:"text-right",children:"Actions"})]})}),d.jsx(Uu,{children:L.length===0?d.jsx(Gr,{children:d.jsx(Nt,{colSpan:3,className:"text-center",children:"No campuses found."})}):L.map((V,G)=>d.jsxs(Gr,{children:[d.jsx(Nt,{children:M+G+1}),d.jsx(Nt,{className:"font-medium",children:d.jsx(jB,{to:`/campus/${V.id}`,className:"text-primary hover:underline",children:V.campus_name})}),d.jsxs(Nt,{className:"text-right space-x-2",children:[d.jsx(fe,{variant:"ghost",size:"icon",className:"text-blue-600",onClick:()=>{S(V),I(V.campus_name),y(!0)},children:d.jsx(Fu,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"ghost",size:"icon",className:"text-red-600",onClick:()=>{S(V),v(!0)},children:d.jsx(Na,{className:"w-4 h-4"})})]})]},V.id))})]})}),d.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4 gap-2",children:[d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",T.length===0?0:M+1," –"," ",Math.min(_,T.length)," of"," ",T.length]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{variant:"outline",size:"sm",onClick:O,disabled:u===1,children:"Previous"}),d.jsx(fe,{variant:"outline",size:"sm",onClick:U,disabled:u===$||$===0,children:"Next"})]})]})]})})]})}),f&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:d.jsxs("form",{onSubmit:F,className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Add Campus"}),d.jsx("input",{type:"text",placeholder:"Enter campus name",className:"border border-orange-300 px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:b,onChange:V=>w(V.target.value),required:!0}),d.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[d.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded",onClick:()=>g(!1),children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded",children:"Add"})]})]})}),m&&C&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Update Campus"}),d.jsx("input",{type:"text",placeholder:"Enter campus name",className:"border border-orange-300 px-3 py-2 rounded w-full",value:k,onChange:V=>I(V.target.value),required:!0}),d.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[d.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded",onClick:()=>{y(!1),S(null)},children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 bg-orange-500 text-white rounded",onClick:()=>{C&&(D(C.id,k),y(!1),S(null))},children:"Update"})]})]})}),x&&C&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-red-200",children:[d.jsx("h2",{className:"text-lg font-semibold text-red-600 mb-4",children:"Confirm Deletion"}),d.jsxs("p",{children:["Are you sure you want to delete ",d.jsx("strong",{children:C.campus_name}),"?"]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[d.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded",onClick:()=>{v(!1),S(null)},children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 bg-red-600 text-white rounded",onClick:()=>{R(C.id,C.campus_name),v(!1),S(null)},children:"Delete"})]})]})})]})},KH=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(null),[i,o]=N.useState(""),[l,c]=N.useState(1),u=10,[h,p]=N.useState(!1),[f,g]=N.useState(!1),[m,y]=N.useState(!1),[x,v]=N.useState(""),[b,w]=N.useState(""),[k,I]=N.useState(null),C=D=>{const R=D.message.toLowerCase();return R.includes("duplicate")||R.includes("already exists")?"This school name already exists. Please use a different name.":R.includes("500")||R.includes("internal server error")?"Server is temporarily unavailable. Please try again later.":R.includes("network")||R.includes("fetch")?"Network error. Please check your connection and try again.":"An error occurred. Please try again."};N.useEffect(()=>{(async()=>{r(!0),s(null);try{const R=await QN();t(R)}catch(R){s(R instanceof Error?R.message:"An unknown error occurred")}finally{r(!1)}})()},[]);const S=e.filter(D=>(D.school_name||"").toLowerCase().includes(i.toLowerCase())),E=Math.ceil(S.length/u),T=l*u,$=T-u,_=S.slice($,T),M=()=>{l<E&&c(D=>D+1)},L=()=>{l>1&&c(D=>D-1)},U=async D=>{var V;if(D.preventDefault(),e.some(G=>G.school_name.toLowerCase()===x.toLowerCase().trim())){as({title:"Duplicate School",description:"This school name already exists. Please use a different name.",variant:"destructive"});return}try{const G=await fhe(x),W={id:G.id||((V=G.data)==null?void 0:V.id)||Date.now(),school_name:x};t(B=>[...B,W]),v(""),p(!1),as({title:"School Added",description:"School has been successfully added."})}catch(G){const W=C(G);as({title:"Error creating school",description:W,variant:"destructive"})}},O=async(D,R)=>{try{await mhe(D,R),t(V=>V.map(G=>G.id===D?{...G,school_name:R}:G)),as({title:"School Updated",description:`School "${R}" updated successfully.`})}catch(V){const G=C(V);as({title:"Error updating school",description:G,variant:"destructive"})}},F=async(D,R)=>{try{await ghe(D),t(V=>V.filter(G=>G.id!==D)),as({title:"School Deleted",description:`School ${R} has been deleted.`})}catch(V){const G=C(V);as({title:"Error deleting school",description:G,variant:"destructive"})}};return d.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[d.jsx(ar,{}),d.jsx("main",{className:"flex-1 p-4 md:p-8 pt-20 md:pt-8 md:ml-64",children:d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[d.jsxs("div",{children:[d.jsx(Yt,{className:"text-2xl",children:"Schools"}),d.jsx(vs,{children:"A list of all the schools."})]}),d.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full md:w-auto",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(wa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),d.jsx(Je,{type:"search",placeholder:"Search school...",className:"pl-8 w-full",value:i,onChange:D=>{o(D.target.value),c(1)}})]}),d.jsxs(fe,{onClick:()=>p(!0),children:[d.jsx(Qn,{className:"mr-2 h-4 w-4"})," Add School"]})]})]})}),d.jsx(It,{children:n?d.jsx("p",{children:"Loading..."}):a?d.jsx("p",{className:"text-red-500",children:a}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs(zu,{children:[d.jsx(Bu,{children:d.jsxs(Gr,{children:[d.jsx(Ft,{children:"S.No"}),d.jsx(Ft,{children:"School Name"}),d.jsx(Ft,{className:"text-right",children:"Actions"})]})}),d.jsx(Uu,{children:_.length===0?d.jsx(Gr,{children:d.jsx(Nt,{colSpan:4,className:"text-center",children:"No schools found."})}):_.map((D,R)=>d.jsxs(Gr,{children:[d.jsx(Nt,{children:$+R+1}),d.jsx(Nt,{className:"font-medium text-orange-600",children:D.school_name||"N/A"}),d.jsxs(Nt,{className:"text-right space-x-2",children:[d.jsx(fe,{variant:"ghost",size:"icon",className:"text-blue-600",onClick:()=>{I(D),w(D.school_name),g(!0)},children:d.jsx(Fu,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"ghost",size:"icon",className:"text-red-600",onClick:()=>{I(D),y(!0)},children:d.jsx(Na,{className:"w-4 h-4"})})]})]},D.id))})]})}),d.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4 gap-2",children:[d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",S.length===0?0:$+1," –",Math.min(T,S.length)," of"," ",S.length]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{variant:"outline",size:"sm",onClick:L,disabled:l===1,children:"Previous"}),d.jsx(fe,{variant:"outline",size:"sm",onClick:M,disabled:l===E||E===0,children:"Next"})]})]})]})})]})}),h&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:d.jsxs("form",{onSubmit:U,className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Add School"}),d.jsx("input",{type:"text",placeholder:"Enter school name",className:"border border-orange-300 px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:x,onChange:D=>v(D.target.value),required:!0}),d.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[d.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",onClick:()=>p(!1),children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors",children:"Add"})]})]})}),f&&k&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Update School"}),d.jsx("input",{type:"text",placeholder:"Enter school name",className:"border border-orange-300 px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:b,onChange:D=>w(D.target.value),required:!0}),d.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[d.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",onClick:()=>{g(!1),I(null)},children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors",onClick:()=>{k&&(O(k.id,b),g(!1),I(null))},children:"Update"})]})]})}),m&&k&&d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-red-200",children:[d.jsx("h2",{className:"text-lg font-semibold text-red-600 mb-4",children:"Confirm Deletion"}),d.jsxs("p",{children:["Are you sure you want to delete"," ",d.jsx("strong",{children:k.school_name}),"?"]}),d.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[d.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",onClick:()=>{y(!1),I(null)},children:"Cancel"}),d.jsx("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",onClick:()=>{F(k.id,k.school_name),y(!1),I(null)},children:"Delete"})]})]})})]})};function QH({status:e}){const t=n=>n!=null&&n.includes("Pass")||n==="Offer Accepted"||n==="Onboarded"||n==="Created Student Without Exam"?"bg-green-500/10 text-green-700 border-green-500/20":n!=null&&n.includes("Fail")||n==="Offer Declined"||n==="Duplicate"||n==="Unreachable"||n==="Became Disinterested"||n==="No Show"||n==="Selected but not joined"?"bg-red-500/10 text-red-700 border-red-500/20":n!=null&&n.includes("Pending")||n==="Offer Sent"||n==="Reschedule"||n==="Waitlisted"||n==="Enrollment Key Generated"||n==="Basic Details Entered"||n==="Pending Booking"?"bg-yellow-500/10 text-yellow-700 border-yellow-500/20":"bg-gray-500/10 text-gray-700 border-gray-500/20";return d.jsx("span",{className:Fe("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border",t(e)),children:e||"No Status"})}const XH=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),{toast:a}=Qt(),{user:s}=Gs(),i=Pr();N.useEffect(()=>{l()},[]);const o=()=>{i("/schedule")},l=async()=>{try{if(r(!0),!s){t([]);return}const{data:h,error:p}=await Et.from("admission_dashboard").select("id, mobile_no, unique_number, name, lr_status, cfr_status, lr_comments, cfr_comments, date_of_testing").or("lr_status.not.is.null,cfr_status.not.is.null").order("date_of_testing",{ascending:!1});if(p)throw console.error("Supabase error:",p),p;console.log(`Successfully fetched ${(h==null?void 0:h.length)||0} interview records`),t(h||[])}catch(h){console.error("Error fetching interview data:",h),a({title:"Error",description:"Failed to load interview data",variant:"destructive"}),t([])}finally{r(!1)}},c=h=>h.cfr_status?"Cultural Fit":h.lr_status?"Learning Round":"Interview",u=h=>h.cfr_status?h.cfr_status:h.lr_status?h.lr_status:"scheduled";return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Interviews"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage interview schedules and feedback"})]}),d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border",children:[d.jsx("div",{className:"p-6 border-b border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Interview Records"}),d.jsx("div",{className:"flex flex-col gap-4 md:flex-row",children:d.jsxs(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white",onClick:o,children:[d.jsx(Eo,{className:"w-4 h-4 mr-2"}),"Schedule Interview"]})})]})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-muted/30",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Type"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Date"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Comments"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"p-4 text-center text-muted-foreground",children:"Loading interviews..."})}):e.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"p-4 text-center text-muted-foreground",children:"No interview records found"})}):e.map(h=>d.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[d.jsx("td",{className:"p-4",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-foreground",children:h.name||"N/A"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:h.unique_number||h.mobile_no})]})}),d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(Ux,{className:"w-4 h-4 text-muted-foreground"}),d.jsx("span",{className:"text-sm text-foreground",children:c(h)})]})}),d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(To,{className:"w-4 h-4 text-muted-foreground"}),d.jsx("span",{className:"text-sm text-foreground",children:h.date_of_testing?new Date(h.date_of_testing).toLocaleDateString():"Not scheduled"})]})}),d.jsx("td",{className:"p-4",children:d.jsx(QH,{status:u(h)})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-sm text-foreground",children:h.cfr_comments||h.lr_comments||"No comments"})}),d.jsx("td",{className:"p-4",children:d.jsx(fe,{variant:"outline",size:"sm",children:"View Details"})})]},h.id))})]})})]})]})})]})},k0e=({content:e,onChange:t})=>{const n=N.useRef(null),r=N.useRef(null),[a,s]=N.useState(null),{toast:i}=Qt();N.useEffect(()=>{n.current&&n.current.innerHTML!==e&&(n.current.innerHTML=e,setTimeout(()=>{o()},100))},[e]);const o=()=>{if(!n.current)return;n.current.querySelectorAll("img").forEach(v=>{var w;const b=v.cloneNode(!0);(w=v.parentNode)==null||w.replaceChild(b,v),b.style.cursor="pointer",b.style.maxWidth="100%",b.style.height="auto",b.style.display="block",b.style.border="2px solid transparent",b.style.transition="all 0.2s ease",b.style.userSelect="none",b.addEventListener("click",k=>{k.preventDefault(),k.stopPropagation(),l(b)}),b.addEventListener("mouseenter",()=>{a!==b&&(b.style.border="2px solid #3b82f6",b.style.transform="scale(1.02)")}),b.addEventListener("mouseleave",()=>{a!==b&&(b.style.border="2px solid transparent",b.style.transform="scale(1)")})})},l=x=>{a&&a!==x&&(a.style.border="2px solid transparent",a.style.boxShadow="none",a.style.transform="scale(1)"),s(x),x.style.border="2px solid #3b82f6",x.style.boxShadow="0 0 10px rgba(59, 130, 246, 0.4)",x.style.transform="scale(1.05)",console.log("Image selected:",x.src),i({title:"Image Selected",description:"Use the controls below to adjust the image."})},c=x=>{var w;if(!a){i({title:"No Image Selected",description:"Please click on an image first to align it.",variant:"destructive"});return}console.log("Aligning image to:",x);const v=document.createElement("div");v.style.width="100%",v.style.margin="10px 0",v.style.clear="both";const b=a.cloneNode(!0);switch(x){case"left":v.style.textAlign="left",b.style.float="left",b.style.marginRight="15px",b.style.marginBottom="10px";break;case"center":v.style.textAlign="center",b.style.float="none",b.style.margin="0 auto 10px auto",b.style.display="block";break;case"right":v.style.textAlign="right",b.style.float="right",b.style.marginLeft="15px",b.style.marginBottom="10px";break}v.appendChild(b),(w=a.parentNode)==null||w.replaceChild(v,a),s(b),p(),i({title:"Image Aligned",description:`Image aligned to ${x}`})},u=x=>{if(!a){i({title:"No Image Selected",description:"Please click on an image first to resize it.",variant:"destructive"});return}console.log("Resizing image to:",x);let v="",b="";switch(x){case"small":v="200px",b="200px";break;case"medium":v="400px",b="400px";break;case"large":v="600px",b="600px";break}a.style.width=v,a.style.maxWidth=b,a.style.height="auto",p(),i({title:"Image Resized",description:`Image resized to ${x}`})},h=(x,v)=>{try{document.execCommand(x,!1,v),p()}catch(b){console.error("Error executing command:",x,b)}},p=()=>{n.current&&(t(n.current.innerHTML),setTimeout(()=>{o()},100))},f=async x=>{var b;const v=(b=x.clipboardData)==null?void 0:b.items;if(v){for(let w=0;w<v.length;w++){const k=v[w];if(k.type.startsWith("image/")){x.preventDefault();const I=k.getAsFile();if(I){console.log("Pasting image from clipboard"),await g(I);return}}}setTimeout(()=>{p()},0)}},g=async x=>{var v,b,w,k;try{if(console.log("Starting image upload:",x.name||"clipboard-image"),!x.type.startsWith("image/")){i({title:"Invalid File",description:"Please select an image file",variant:"destructive"});return}i({title:"Uploading Image",description:"Please wait while your image is being uploaded..."});const I=((v=x.name)==null?void 0:v.split(".").pop())||x.type.split("/")[1]||"png",S=`template-images/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${I}`}`;console.log("Uploading to path:",S);const{error:E}=await Et.storage.from("offer-pdfs").upload(S,x);if(E)throw console.error("Image upload error:",E),E;const{data:T}=Et.storage.from("offer-pdfs").getPublicUrl(S);if(T!=null&&T.publicUrl){console.log("Image uploaded successfully:",T.publicUrl),n.current&&n.current.focus();const $=`
          <div style="text-align: center; margin: 15px 0; clear: both;">
            <img src="${T.publicUrl}" 
                 style="max-width: 100%; height: auto; display: block; margin: 0 auto; border: 2px solid transparent; cursor: pointer; transition: all 0.2s ease;" 
                 alt="Uploaded image" />
          </div>
        `;if((b=document.getSelection())!=null&&b.rangeCount){const _=(w=document.getSelection())==null?void 0:w.getRangeAt(0);if(_&&((k=n.current)!=null&&k.contains(_.commonAncestorContainer))){_.deleteContents();const M=document.createElement("div");M.innerHTML=$,_.insertNode(M)}else n.current&&(n.current.innerHTML+=$)}else n.current&&(n.current.innerHTML+=$);p(),i({title:"Image Uploaded Successfully",description:"Click on the image to select and modify its alignment or size."})}}catch(I){console.error("Error uploading image:",I),i({title:"Upload Error",description:"Failed to upload image. Please try again.",variant:"destructive"})}},m=x=>{var b;const v=(b=x.target.files)==null?void 0:b[0];v&&(console.log("File selected via input:",v.name),g(v)),r.current&&(r.current.value="")},y=x=>{x.target.tagName!=="IMG"&&a&&(a.style.border="2px solid transparent",a.style.boxShadow="none",a.style.transform="scale(1)",s(null))};return d.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[d.jsxs("div",{className:"border-b bg-muted/50 p-2 flex gap-1 flex-wrap",children:[d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("bold"),type:"button",children:d.jsx(Kae,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("italic"),type:"button",children:d.jsx(Tse,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("underline"),type:"button",children:d.jsx(pie,{className:"h-4 w-4"})}),d.jsx("div",{className:"w-px bg-border mx-1"}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("justifyLeft"),type:"button",children:d.jsx(Pae,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("justifyCenter"),type:"button",children:d.jsx(Oae,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("justifyRight"),type:"button",children:d.jsx(zae,{className:"h-4 w-4"})}),d.jsx("div",{className:"w-px bg-border mx-1"}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("insertUnorderedList"),type:"button",children:d.jsx(Lse,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h("insertOrderedList"),type:"button",children:d.jsx(Fse,{className:"h-4 w-4"})}),d.jsx("div",{className:"w-px bg-border mx-1"}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>{var x;return(x=r.current)==null?void 0:x.click()},type:"button",children:d.jsx(Dm,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>{const x=prompt("Enter link URL:");x&&h("createLink",x)},type:"button",children:d.jsx(Rse,{className:"h-4 w-4"})})]}),a&&d.jsxs("div",{className:"border-b bg-blue-50 p-3",children:[d.jsx("div",{className:"text-sm font-medium text-blue-900 mb-3",children:"Image Controls - Click to Apply"}),d.jsxs("div",{className:"flex gap-3 flex-wrap",children:[d.jsxs("div",{className:"flex gap-1",children:[d.jsx(fe,{size:"sm",variant:"outline",onClick:()=>c("left"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"← Left"}),d.jsx(fe,{size:"sm",variant:"outline",onClick:()=>c("center"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"⬄ Center"}),d.jsx(fe,{size:"sm",variant:"outline",onClick:()=>c("right"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Right →"})]}),d.jsx("div",{className:"w-px bg-border mx-1"}),d.jsxs("div",{className:"flex gap-1",children:[d.jsx(fe,{size:"sm",variant:"outline",onClick:()=>u("small"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Small"}),d.jsx(fe,{size:"sm",variant:"outline",onClick:()=>u("medium"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Medium"}),d.jsx(fe,{size:"sm",variant:"outline",onClick:()=>u("large"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Large"})]})]}),d.jsxs("div",{className:"text-xs text-blue-600 mt-2",children:["Selected image: ",a.alt||"Unnamed image"]})]}),d.jsx("div",{ref:n,contentEditable:!0,className:"min-h-[400px] p-4 focus:outline-none prose max-w-none",onInput:p,onPaste:f,onClick:y,suppressContentEditableWarning:!0,style:{lineHeight:"1.6"}}),d.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:m,className:"hidden"})]})};function S0e(e,t){return N.useReducer((n,r)=>t[n][r]??n,e)}var dA="ScrollArea",[YH,Qat]=ia(dA),[_0e,di]=YH(dA),JH=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:a,scrollHideDelay:s=600,...i}=e,[o,l]=N.useState(null),[c,u]=N.useState(null),[h,p]=N.useState(null),[f,g]=N.useState(null),[m,y]=N.useState(null),[x,v]=N.useState(0),[b,w]=N.useState(0),[k,I]=N.useState(!1),[C,S]=N.useState(!1),E=kt(t,$=>l($)),T=Bm(a);return d.jsx(_0e,{scope:n,type:r,dir:T,scrollHideDelay:s,scrollArea:o,viewport:c,onViewportChange:u,content:h,onContentChange:p,scrollbarX:f,onScrollbarXChange:g,scrollbarXEnabled:k,onScrollbarXEnabledChange:I,scrollbarY:m,onScrollbarYChange:y,scrollbarYEnabled:C,onScrollbarYEnabledChange:S,onCornerWidthChange:v,onCornerHeightChange:w,children:d.jsx(Qe.div,{dir:T,...i,ref:E,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});JH.displayName=dA;var ZH="ScrollAreaViewport",eG=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:a,...s}=e,i=di(ZH,n),o=N.useRef(null),l=kt(t,o,i.onViewportChange);return d.jsxs(d.Fragment,{children:[d.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),d.jsx(Qe.div,{"data-radix-scroll-area-viewport":"",...s,ref:l,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...e.style},children:d.jsx("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});eG.displayName=ZH;var Po="ScrollAreaScrollbar",hA=N.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=di(Po,e.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:i}=a,o=e.orientation==="horizontal";return N.useEffect(()=>(o?s(!0):i(!0),()=>{o?s(!1):i(!1)}),[o,s,i]),a.type==="hover"?d.jsx(C0e,{...r,ref:t,forceMount:n}):a.type==="scroll"?d.jsx(I0e,{...r,ref:t,forceMount:n}):a.type==="auto"?d.jsx(tG,{...r,ref:t,forceMount:n}):a.type==="always"?d.jsx(pA,{...r,ref:t}):null});hA.displayName=Po;var C0e=N.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=di(Po,e.__scopeScrollArea),[s,i]=N.useState(!1);return N.useEffect(()=>{const o=a.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),i(!0)},u=()=>{l=window.setTimeout(()=>i(!1),a.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),d.jsx(Lr,{present:n||s,children:d.jsx(tG,{"data-state":s?"visible":"hidden",...r,ref:t})})}),I0e=N.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=di(Po,e.__scopeScrollArea),s=e.orientation==="horizontal",i=Nk(()=>l("SCROLL_END"),100),[o,l]=S0e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return N.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,a.scrollHideDelay,l]),N.useEffect(()=>{const c=a.viewport,u=s?"scrollLeft":"scrollTop";if(c){let h=c[u];const p=()=>{const f=c[u];h!==f&&(l("SCROLL"),i()),h=f};return c.addEventListener("scroll",p),()=>c.removeEventListener("scroll",p)}},[a.viewport,s,l,i]),d.jsx(Lr,{present:n||o!=="hidden",children:d.jsx(pA,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Te(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Te(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),tG=N.forwardRef((e,t)=>{const n=di(Po,e.__scopeScrollArea),{forceMount:r,...a}=e,[s,i]=N.useState(!1),o=e.orientation==="horizontal",l=Nk(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;i(o?c:u)}},10);return om(n.viewport,l),om(n.content,l),d.jsx(Lr,{present:r||s,children:d.jsx(pA,{"data-state":s?"visible":"hidden",...a,ref:t})})}),pA=N.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,a=di(Po,e.__scopeScrollArea),s=N.useRef(null),i=N.useRef(0),[o,l]=N.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=iG(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:p=>s.current=p,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:p=>i.current=p};function h(p,f){return R0e(p,i.current,o,f)}return n==="horizontal"?d.jsx(E0e,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&s.current){const p=a.viewport.scrollLeft,f=XP(p,o,a.dir);s.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollLeft=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollLeft=h(p,a.dir))}}):n==="vertical"?d.jsx(T0e,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&s.current){const p=a.viewport.scrollTop,f=XP(p,o);s.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollTop=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollTop=h(p))}}):null}),E0e=N.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,s=di(Po,e.__scopeScrollArea),[i,o]=N.useState(),l=N.useRef(null),c=kt(t,l,s.onScrollbarXChange);return N.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),d.jsx(rG,{"data-orientation":"horizontal",...a,ref:c,sizes:n,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":wk(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(s.viewport){const p=s.viewport.scrollLeft+u.deltaX;e.onWheelScroll(p),lG(p,h)&&u.preventDefault()}},onResize:()=>{l.current&&s.viewport&&i&&r({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:j1(i.paddingLeft),paddingEnd:j1(i.paddingRight)}})}})}),T0e=N.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,s=di(Po,e.__scopeScrollArea),[i,o]=N.useState(),l=N.useRef(null),c=kt(t,l,s.onScrollbarYChange);return N.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),d.jsx(rG,{"data-orientation":"vertical",...a,ref:c,sizes:n,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":wk(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(s.viewport){const p=s.viewport.scrollTop+u.deltaY;e.onWheelScroll(p),lG(p,h)&&u.preventDefault()}},onResize:()=>{l.current&&s.viewport&&i&&r({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:j1(i.paddingTop),paddingEnd:j1(i.paddingBottom)}})}})}),[j0e,nG]=YH(Po),rG=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:a,onThumbChange:s,onThumbPointerUp:i,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:h,...p}=e,f=di(Po,n),[g,m]=N.useState(null),y=kt(t,E=>m(E)),x=N.useRef(null),v=N.useRef(""),b=f.viewport,w=r.content-r.viewport,k=rr(u),I=rr(l),C=Nk(h,10);function S(E){if(x.current){const T=E.clientX-x.current.left,$=E.clientY-x.current.top;c({x:T,y:$})}}return N.useEffect(()=>{const E=T=>{const $=T.target;(g==null?void 0:g.contains($))&&k(T,w)};return document.addEventListener("wheel",E,{passive:!1}),()=>document.removeEventListener("wheel",E,{passive:!1})},[b,g,w,k]),N.useEffect(I,[r,I]),om(g,C),om(f.content,C),d.jsx(j0e,{scope:n,scrollbar:g,hasThumb:a,onThumbChange:rr(s),onThumbPointerUp:rr(i),onThumbPositionChange:I,onThumbPointerDown:rr(o),children:d.jsx(Qe.div,{...p,ref:y,style:{position:"absolute",...p.style},onPointerDown:Te(e.onPointerDown,E=>{E.button===0&&(E.target.setPointerCapture(E.pointerId),x.current=g.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),S(E))}),onPointerMove:Te(e.onPointerMove,S),onPointerUp:Te(e.onPointerUp,E=>{const T=E.target;T.hasPointerCapture(E.pointerId)&&T.releasePointerCapture(E.pointerId),document.body.style.webkitUserSelect=v.current,f.viewport&&(f.viewport.style.scrollBehavior=""),x.current=null})})})}),T1="ScrollAreaThumb",aG=N.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=nG(T1,e.__scopeScrollArea);return d.jsx(Lr,{present:n||a.hasThumb,children:d.jsx(A0e,{ref:t,...r})})}),A0e=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...a}=e,s=di(T1,n),i=nG(T1,n),{onThumbPositionChange:o}=i,l=kt(t,h=>i.onThumbChange(h)),c=N.useRef(void 0),u=Nk(()=>{c.current&&(c.current(),c.current=void 0)},100);return N.useEffect(()=>{const h=s.viewport;if(h){const p=()=>{if(u(),!c.current){const f=D0e(h,o);c.current=f,o()}};return o(),h.addEventListener("scroll",p),()=>h.removeEventListener("scroll",p)}},[s.viewport,u,o]),d.jsx(Qe.div,{"data-state":i.hasThumb?"visible":"hidden",...a,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Te(e.onPointerDownCapture,h=>{const f=h.target.getBoundingClientRect(),g=h.clientX-f.left,m=h.clientY-f.top;i.onThumbPointerDown({x:g,y:m})}),onPointerUp:Te(e.onPointerUp,i.onThumbPointerUp)})});aG.displayName=T1;var fA="ScrollAreaCorner",sG=N.forwardRef((e,t)=>{const n=di(fA,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?d.jsx($0e,{...e,ref:t}):null});sG.displayName=fA;var $0e=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,a=di(fA,n),[s,i]=N.useState(0),[o,l]=N.useState(0),c=!!(s&&o);return om(a.scrollbarX,()=>{var h;const u=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(u),l(u)}),om(a.scrollbarY,()=>{var h;const u=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(u),i(u)}),c?d.jsx(Qe.div,{...r,ref:t,style:{width:s,height:o,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function j1(e){return e?parseInt(e,10):0}function iG(e,t){const n=e/t;return isNaN(n)?0:n}function wk(e){const t=iG(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function R0e(e,t,n,r="ltr"){const a=wk(n),s=a/2,i=t||s,o=a-i,l=n.scrollbar.paddingStart+i,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,h=r==="ltr"?[0,u]:[u*-1,0];return oG([l,c],h)(e)}function XP(e,t,n="ltr"){const r=wk(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=t.scrollbar.size-a,i=t.content-t.viewport,o=s-r,l=n==="ltr"?[0,i]:[i*-1,0],c=pI(e,l);return oG([0,i],[0,o])(c)}function oG(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function lG(e,t){return e>0&&e<t}var D0e=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function a(){const s={left:e.scrollLeft,top:e.scrollTop},i=n.left!==s.left,o=n.top!==s.top;(i||o)&&t(),n=s,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function Nk(e,t){const n=rr(e),r=N.useRef(0);return N.useEffect(()=>()=>window.clearTimeout(r.current),[]),N.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function om(e,t){const n=rr(t);fr(()=>{let r=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(r),a.unobserve(e)}}},[e,n])}var uG=JH,M0e=eG,O0e=sG;const cG=N.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(uG,{ref:r,className:Fe("relative overflow-hidden",e),...n,children:[d.jsx(M0e,{className:"h-full w-full rounded-[inherit]",children:t}),d.jsx(dG,{}),d.jsx(O0e,{})]}));cG.displayName=uG.displayName;const dG=N.forwardRef(({className:e,orientation:t="vertical",...n},r)=>d.jsx(hA,{ref:r,orientation:t,className:Fe("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:d.jsx(aG,{className:"relative flex-1 rounded-full bg-border"})}));dG.displayName=hA.displayName;const YP=e=>{switch(e){case"admission_dashboard":return d.jsx(F2,{className:"h-3 w-3"});case"user_input":return d.jsx(Ai,{className:"h-3 w-3"});case"system_generated":return d.jsx(Eo,{className:"h-3 w-3"});default:return d.jsx(hd,{className:"h-3 w-3"})}},F0e=e=>{switch(e){case"admission_dashboard":return"bg-blue-100 text-blue-800";case"user_input":return"bg-green-100 text-green-800";case"system_generated":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},P0e=[{id:"default-1",placeholder_key:"STUDENT_NAME",display_name:"Student Name",description:"Name of the student from admission dashboard",data_source:"admission_dashboard",is_active:!0},{id:"default-2",placeholder_key:"MOBILE_NUMBER",display_name:"Mobile Number",description:"Student mobile number",data_source:"admission_dashboard",is_active:!0},{id:"default-3",placeholder_key:"CAMPUS",display_name:"Campus",description:"Assigned campus",data_source:"admission_dashboard",is_active:!0},{id:"default-4",placeholder_key:"ALLOTTED_SCHOOL",display_name:"Allotted School",description:"School allotted to the student",data_source:"admission_dashboard",is_active:!0},{id:"default-5",placeholder_key:"FINAL_MARKS",display_name:"Final Marks",description:"Final examination marks",data_source:"admission_dashboard",is_active:!0},{id:"default-6",placeholder_key:"INTERVIEW_DATE",display_name:"Interview Date",description:"Scheduled interview date",data_source:"admission_dashboard",is_active:!0}],L0e=({onInsertPlaceholder:e})=>{const[t,n]=N.useState(""),{toast:r}=Qt(),{data:a,isLoading:s}=nh({queryKey:["offer-placeholders"],queryFn:async()=>{const{data:u,error:h}=await Et.from("offer_placeholders").select("*").eq("is_active",!0).order("display_name");if(h)throw h;return u||[]}}),o=[...P0e,...a||[]].filter(u=>{var h;return u.display_name.toLowerCase().includes(t.toLowerCase())||u.placeholder_key.toLowerCase().includes(t.toLowerCase())||((h=u.description)==null?void 0:h.toLowerCase().includes(t.toLowerCase()))}),l=(u,h)=>{e(u),r({title:"Placeholder Inserted",description:`Added {{${u}}} to the template`})},c=o.reduce((u,h)=>{const p=h.data_source;return u[p]||(u[p]=[]),u[p].push(h),u},{});return s?d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{className:"text-sm",children:"Placeholders"})}),d.jsx(It,{children:d.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading placeholders..."})})]}):d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs(Yt,{className:"text-sm flex items-center gap-2",children:[d.jsx(Qn,{className:"h-4 w-4"}),"Insert Placeholders"]})}),d.jsxs(It,{className:"space-y-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(wa,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),d.jsx(Je,{placeholder:"Search placeholders...",value:t,onChange:u=>n(u.target.value),className:"pl-8 text-sm"})]}),d.jsx("div",{className:"text-xs text-muted-foreground",children:"Click any placeholder below to insert it into your template. Placeholders will be replaced with actual data when sending offers."}),d.jsx(cG,{className:"h-[400px]",children:d.jsx("div",{className:"space-y-3",children:Object.entries(c).map(([u,h])=>d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[YP(u),d.jsx("span",{className:"text-xs font-medium capitalize",children:u.replace("_"," ")}),d.jsx(Fa,{variant:"secondary",className:"text-xs",children:h.length})]}),d.jsx("div",{className:"space-y-1 pl-4",children:h.map(p=>d.jsx("div",{className:"group",children:d.jsx(fe,{variant:"ghost",size:"sm",className:"w-full justify-start text-left h-auto p-2 hover:bg-muted/50",onClick:()=>l(p.placeholder_key,p.display_name),children:d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:"text-xs font-medium truncate",children:p.display_name}),d.jsx(Fa,{variant:"outline",className:`text-xs ${F0e(p.data_source)}`,children:YP(p.data_source)})]}),d.jsx("div",{className:"text-xs text-muted-foreground font-mono truncate",children:`{{${p.placeholder_key}}}`}),p.description&&d.jsx("div",{className:"text-xs text-muted-foreground mt-1 leading-tight",children:p.description})]})})},p.id))})]},u))})}),d.jsx("div",{className:"pt-2 border-t",children:d.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[d.jsx("div",{className:"font-medium",children:"Available Data Sources:"}),d.jsxs("div",{children:["• ",d.jsx("strong",{children:"Admission Dashboard:"})," Student data from All Applicants"]}),d.jsxs("div",{children:["• ",d.jsx("strong",{children:"User Input:"})," Custom values entered during send"]}),d.jsxs("div",{children:["• ",d.jsx("strong",{children:"System Generated:"})," Auto-generated values"]})]})})]})]})},z0e=({isOpen:e,onClose:t,onDocumentUploaded:n})=>{const[r,a]=N.useState(!1),s=N.useRef(null),{toast:i}=Qt(),o=async()=>window.mammoth?window.mammoth:new Promise((h,p)=>{const f=document.createElement("script");f.src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js",f.onload=()=>{window.mammoth?h(window.mammoth):p(new Error("Mammoth library not loaded properly"))},f.onerror=()=>p(new Error("Failed to load mammoth library")),document.head.appendChild(f)}),l=async h=>{try{const p=await o(),f=await h.arrayBuffer(),g={convertImage:async x=>{try{console.log("Processing embedded image...");const v=await x.read(),b=new Blob([v],{type:x.contentType||"image/png"}),w=x.contentType?x.contentType.split("/")[1]:"png",I=`template-images/${`template-image-${Date.now()}-${Math.random().toString(36).substr(2,9)}.${w}`}`,{error:C}=await Et.storage.from("offer-pdfs").upload(I,b);if(C)return console.error("Image upload error:",C),{src:""};const{data:S}=Et.storage.from("offer-pdfs").getPublicUrl(I);return console.log("Image uploaded successfully:",S.publicUrl),{src:S.publicUrl}}catch(v){return console.error("Error processing embedded image:",v),{src:""}}},styleMap:["p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Title'] => h1.title:fresh","p[style-name='Subtitle'] => h2.subtitle:fresh","r[style-name='Strong'] => strong","r[style-name='Emphasis'] => em"],ignoreEmptyParagraphs:!1,includeDefaultStyleMap:!0};console.log("Starting document conversion...");const m=await p.convertToHtml({arrayBuffer:f},g);if(m.messages&&m.messages.length>0){console.log("Conversion messages:",m.messages);const x=m.messages.filter(v=>v.type==="error");x.length>0&&console.error("Conversion errors:",x)}const y=`
        <div style="font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; max-width: 800px; margin: 0 auto;">
          ${m.value}
        </div>
      `;return console.log("Document converted successfully"),y}catch(p){console.error("Document conversion error:",p);try{console.log("Attempting simplified conversion...");const f=await o(),g=await h.arrayBuffer(),m={convertImage:()=>({src:""}),ignoreEmptyParagraphs:!0};return`
          <div style="font-family: Arial, sans-serif; line-height: 1.6; padding: 20px;">
            ${(await f.convertToHtml({arrayBuffer:g},m)).value}
            <p style="color: #666; font-style: italic; margin-top: 20px;">
              Note: Images from the original document were not included in this conversion. 
              You can add images manually using the editor tools.
            </p>
          </div>
        `}catch(f){throw console.error("Fallback conversion also failed:",f),new Error("Document conversion failed. This document may be too complex or corrupted. Please try with a simpler document.")}}},c=async h=>{if(!h.name.toLowerCase().endsWith(".docx")){i({title:"Invalid File Type",description:"Please upload a .docx file.",variant:"destructive"});return}a(!0);try{console.log("Starting file upload for:",h.name);const p=h.name.split(".").pop(),g=`template-docs/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${p}`}`,{error:m}=await Et.storage.from("offer-pdfs").upload(g,h);m&&console.error("File backup upload error:",m),console.log("Converting document to HTML...");const y=await l(h);console.log("Document converted successfully"),n(y),i({title:"Document Converted Successfully",description:"Your document has been converted and loaded into the editor."}),t()}catch(p){console.error("Conversion error:",p),i({title:"Conversion Error",description:p instanceof Error?p.message:"Failed to convert document. Please try again.",variant:"destructive"})}finally{a(!1)}},u=h=>{var f;const p=(f=h.target.files)==null?void 0:f[0];p&&c(p)};return d.jsx(ta,{open:e,onOpenChange:t,children:d.jsxs(na,{className:"max-w-md",children:[d.jsx(ka,{children:d.jsx(ra,{children:"Upload Document Template"})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"text-sm text-muted-foreground",children:"Upload a .docx file to convert it to an editable HTML template."}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{htmlFor:"document-upload",children:"Select Document"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Je,{id:"document-upload",type:"file",accept:".docx",ref:s,onChange:u,disabled:r}),d.jsxs(fe,{type:"button",variant:"outline",onClick:()=>{var h;return(h=s.current)==null?void 0:h.click()},disabled:r,children:[r?d.jsx(Use,{className:"h-4 w-4 animate-spin mr-2"}):d.jsx(Dm,{className:"h-4 w-4 mr-2"}),"Browse"]})]})]}),d.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg text-sm",children:[d.jsx(hd,{className:"h-4 w-4 text-blue-600"}),d.jsxs("div",{className:"text-blue-800",children:[d.jsx("div",{className:"font-medium",children:"Supported format:"}),d.jsx("div",{children:"• .docx files only"}),d.jsx("div",{className:"text-xs mt-1 text-blue-600",children:"Note: Complex documents with many images may take longer to process."})]})]})]})]})})},B0e=({templateId:e,isNew:t,onClose:n})=>{const{toast:r}=Qt(),a=Tv(),[s,i]=N.useState(!1),[o,l]=N.useState(!1),[c,u]=N.useState({name:"",template_type:"offer_letter",language:"en",program_type:"",html_content:""}),{data:h,isLoading:p}=nh({queryKey:["offer-template",e],queryFn:async()=>{if(!e)return null;const{data:v,error:b}=await Et.from("offer_templates").select("*").eq("id",e).single();if(b)throw b;return v},enabled:!!e&&!t});N.useEffect(()=>{h&&u({name:h.name,template_type:h.template_type,language:h.language,program_type:h.program_type||"",html_content:h.html_content})},[h]);const f=If({mutationFn:async v=>{const b={...v,program_type:v.template_type==="offer_letter"?v.program_type:null};if(t){const{error:w}=await Et.from("offer_templates").insert([b]);if(w)throw w}else{const{error:w}=await Et.from("offer_templates").update(b).eq("id",e);if(w)throw w}},onSuccess:()=>{r({title:"Template saved",description:"Template has been successfully saved"}),a.invalidateQueries({queryKey:["offer-templates"]}),n()},onError:v=>{if(console.error("Save error:",v),(v==null?void 0:v.code)==="23505"&&v.message.includes("offer_templates_name_unique")){r({title:"Duplicate Template Name",description:`A template with the name "${c.name}" already exists. Please choose a different name.`,variant:"destructive"});return}r({title:"Error",description:"Failed to save template. Please check all required fields.",variant:"destructive"})}}),g=()=>{if(!c.name.trim()){r({title:"Validation Error",description:"Template name is required",variant:"destructive"});return}if(!c.html_content.trim()){r({title:"Validation Error",description:"Template content is required",variant:"destructive"});return}if(c.template_type==="offer_letter"&&(!c.program_type||!c.program_type.trim())){r({title:"Validation Error",description:"Program type is required for offer letter templates",variant:"destructive"});return}f.mutate(c)},m=v=>{u(b=>({...b,template_type:v,program_type:v==="offer_letter"?b.program_type:""}))},y=v=>{u(b=>({...b,html_content:v}))},x=v=>{u(b=>({...b,html_content:b.html_content+`{{${v}}}`}))};return p&&!t?d.jsx("div",{children:"Loading template..."}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:"flex items-center gap-4",children:d.jsxs(fe,{variant:"ghost",onClick:n,children:[d.jsx(Uae,{className:"h-4 w-4 mr-2"}),"Back to Templates"]})}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs(fe,{variant:"outline",onClick:()=>l(!0),children:[d.jsx(Dm,{className:"h-4 w-4 mr-2"}),"Upload Doc"]}),d.jsxs(fe,{variant:"outline",onClick:()=>i(!0),children:[d.jsx(lU,{className:"h-4 w-4 mr-2"}),"Preview"]}),d.jsxs(fe,{onClick:g,disabled:f.isPending,children:[d.jsx(Rm,{className:"h-4 w-4 mr-2"}),f.isPending?"Saving...":"Save Template"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Template Details"})}),d.jsxs(It,{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"name",children:"Template Name *"}),d.jsx(Je,{id:"name",value:c.name,onChange:v=>u(b=>({...b,name:v.target.value})),placeholder:"Enter template name"})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"template_type",children:"Template Type *"}),d.jsxs(vt,{value:c.template_type,onValueChange:m,children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select type"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"offer_letter",children:"Offer Letter Only"}),d.jsx(Ee,{value:"consent_form",children:"Consent Form Only"}),d.jsx(Ee,{value:"checklist",children:"Checklist Only"}),d.jsx(Ee,{value:"complete_package",children:"Complete Package (Letter + Consent + Checklist)"})]})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"language",children:"Language *"}),d.jsxs(vt,{value:c.language,onValueChange:v=>u(b=>({...b,language:v})),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select language"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"en",children:"English"}),d.jsx(Ee,{value:"hi",children:"Hindi"})]})]})]}),c.template_type==="offer_letter"&&d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"program_type",children:"Program Type *"}),d.jsxs(vt,{value:c.program_type,onValueChange:v=>u(b=>({...b,program_type:v})),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select program"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"SOP",children:"School of Programming"}),d.jsx(Ee,{value:"SOB",children:"School of Business"})]})]})]})]}),c.template_type==="complete_package"&&d.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[d.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Complete Package Template"}),d.jsx("p",{className:"text-sm text-blue-700",children:"This template will send the offer letter, consent form, and checklist together in a single email. Structure your content with clear sections for each document type."}),d.jsxs("div",{className:"mt-3 p-3 bg-white rounded border text-sm",children:[d.jsx("strong",{children:"Suggested Structure:"}),d.jsxs("ul",{className:"mt-2 space-y-1 text-blue-600",children:[d.jsxs("li",{children:["• ",d.jsx("strong",{children:"Section 1:"})," Offer Letter with admission details"]}),d.jsxs("li",{children:["• ",d.jsx("strong",{children:"Section 2:"})," Consent Form for enrollment confirmation"]}),d.jsxs("li",{children:["• ",d.jsx("strong",{children:"Section 3:"})," Checklist of required documents and next steps"]})]})]})]})]})]}),d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(Yt,{children:"Template Content *"}),d.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[d.jsx(hd,{className:"h-4 w-4"}),d.jsx("span",{children:"Upload .docx files or edit directly"})]})]})}),d.jsxs(It,{children:[d.jsx("div",{className:"mb-4 p-3 bg-amber-50 rounded-lg border border-amber-200",children:d.jsxs("div",{className:"text-sm text-amber-800",children:[d.jsx("div",{className:"font-medium mb-1",children:"Data Integration:"}),d.jsxs("div",{children:["• Use placeholders like ",d.jsx("code",{children:"{{STUDENT_NAME}}"})," to insert data from All Applicants table"]}),d.jsx("div",{children:"• Placeholders will be automatically replaced with actual student data when sending offers"}),d.jsx("div",{children:"• You can copy/paste images directly into the editor"})]})}),d.jsx(k0e,{content:c.html_content,onChange:v=>u(b=>({...b,html_content:v}))})]})]})]}),d.jsx("div",{className:"lg:col-span-1",children:d.jsx(L0e,{onInsertPlaceholder:x})})]})]}),d.jsx(ta,{open:s,onOpenChange:i,children:d.jsxs(na,{className:"max-w-4xl max-h-[80vh] overflow-auto",children:[d.jsx(ka,{children:d.jsx(ra,{children:"Template Preview"})}),d.jsx("div",{className:"p-6 border rounded bg-white",dangerouslySetInnerHTML:{__html:c.html_content}})]})}),d.jsx(z0e,{isOpen:o,onClose:()=>l(!1),onDocumentUploaded:y})]})},U0e=({onEditTemplate:e})=>{const{toast:t}=Qt(),{data:n,isLoading:r,refetch:a}=nh({queryKey:["offer-templates"],queryFn:async()=>{const{data:o,error:l}=await Et.from("offer_templates").select("*").eq("is_active",!0).order("updated_at",{ascending:!1});if(l)throw l;return o}}),s=async o=>{try{const{error:l}=await Et.from("offer_templates").insert({name:`${o.name} (Copy)`,template_type:o.template_type,language:o.language,program_type:o.program_type,html_content:o.html_content,version_number:1});if(l)throw l;t({title:"Template duplicated",description:"Template has been successfully duplicated"}),a()}catch{t({title:"Error",description:"Failed to duplicate template",variant:"destructive"})}},i=async o=>{try{const{error:l}=await Et.from("offer_templates").update({is_active:!1}).eq("id",o);if(l)throw l;t({title:"Template deleted",description:"Template has been successfully deleted"}),a()}catch{t({title:"Error",description:"Failed to delete template",variant:"destructive"})}};return r?d.jsx("div",{children:"Loading templates..."}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n==null?void 0:n.map(o=>d.jsxs(Ct,{className:"hover:shadow-md transition-shadow",children:[d.jsx(Vt,{className:"pb-3",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx(Yt,{className:"text-lg",children:o.name}),d.jsxs("div",{className:"flex gap-1",children:[d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>e(o.id),children:d.jsx(oc,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>s(o),children:d.jsx(pse,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:d.jsx(Na,{className:"h-4 w-4"})})]})]})}),d.jsx(It,{children:d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex gap-2 flex-wrap",children:[d.jsx(Fa,{variant:"secondary",children:o.template_type}),d.jsx(Fa,{variant:"outline",children:o.language.toUpperCase()}),o.program_type&&d.jsx(Fa,{children:o.program_type})]}),d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Version ",o.version_number]}),d.jsxs("p",{className:"text-xs text-muted-foreground",children:["Updated ",new Date(o.updated_at).toLocaleDateString()]})]})})]},o.id))})},W0e=()=>{const[e,t]=N.useState(""),[n,r]=N.useState("all"),{data:a,isLoading:s,refetch:i}=nh({queryKey:["offer-history",e,n],queryFn:async()=>{let l=Et.from("offer_history").select(`
          *,
          admission_dashboard(name, mobile_no, campus)
        `).order("created_at",{ascending:!1});n!=="all"&&(l=l.eq("email_status",n));const{data:c,error:u}=await l;if(u)throw u;return c}}),o=l=>{switch(l){case"sent":return"default";case"delivered":return"secondary";case"opened":return"default";case"bounced":return"destructive";case"failed":return"destructive";default:return"outline"}};return s?d.jsx("div",{children:"Loading offer history..."}):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-2xl font-bold",children:"Offer History"}),d.jsxs(fe,{onClick:()=>i(),variant:"outline",children:[d.jsx(QT,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex gap-4 items-center",children:[d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"relative",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),d.jsx(Je,{placeholder:"Search by applicant name...",value:e,onChange:l=>t(l.target.value),className:"pl-10"})]})}),d.jsxs(vt,{value:n,onValueChange:r,children:[d.jsx(pt,{className:"w-[180px]",children:d.jsx(bt,{placeholder:"Filter by status"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"all",children:"All Statuses"}),d.jsx(Ee,{value:"pending",children:"Pending"}),d.jsx(Ee,{value:"sent",children:"Sent"}),d.jsx(Ee,{value:"delivered",children:"Delivered"}),d.jsx(Ee,{value:"opened",children:"Opened"}),d.jsx(Ee,{value:"bounced",children:"Bounced"}),d.jsx(Ee,{value:"failed",children:"Failed"})]})]})]})}),d.jsx(It,{children:d.jsxs(zu,{children:[d.jsx(Bu,{children:d.jsxs(Gr,{children:[d.jsx(Ft,{children:"Applicant"}),d.jsx(Ft,{children:"Campus"}),d.jsx(Ft,{children:"Status"}),d.jsx(Ft,{children:"Sent At"}),d.jsx(Ft,{children:"Actions"})]})}),d.jsx(Uu,{children:a==null?void 0:a.map(l=>{var c,u,h;return d.jsxs(Gr,{children:[d.jsx(Nt,{children:d.jsxs("div",{children:[d.jsx("p",{className:"font-medium",children:(c=l.admission_dashboard)==null?void 0:c.name}),d.jsx("p",{className:"text-sm text-muted-foreground",children:(u=l.admission_dashboard)==null?void 0:u.mobile_no})]})}),d.jsx(Nt,{children:(h=l.admission_dashboard)==null?void 0:h.campus}),d.jsx(Nt,{children:d.jsx(Fa,{variant:o(l.email_status),children:l.email_status})}),d.jsx(Nt,{children:l.sent_at?new Date(l.sent_at).toLocaleString():"Not sent"}),d.jsx(Nt,{children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{variant:"ghost",size:"sm",children:d.jsx($N,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",children:"Resend"})]})})]},l.id)})})]})})]})]})},V0e=()=>{const{toast:e}=Qt(),t=Tv(),[n,r]=N.useState(!1),[a,s]=N.useState(null),[i,o]=N.useState({placeholder_key:"",display_name:"",description:"",data_source:"admission_dashboard",field_mapping:"",conditional_logic:""}),{data:l,isLoading:c}=nh({queryKey:["all-placeholders"],queryFn:async()=>{const{data:x,error:v}=await Et.from("offer_placeholders").select("*").order("display_name");if(v)throw v;return x}}),u=If({mutationFn:async x=>{const v={...x,field_mapping:x.field_mapping?JSON.parse(x.field_mapping):null,conditional_logic:x.conditional_logic?JSON.parse(x.conditional_logic):null};if(a){const{error:b}=await Et.from("offer_placeholders").update(v).eq("id",a.id);if(b)throw b}else{const{error:b}=await Et.from("offer_placeholders").insert([v]);if(b)throw b}},onSuccess:()=>{e({title:"Success",description:`Placeholder ${a?"updated":"created"} successfully`}),t.invalidateQueries({queryKey:["all-placeholders"]}),t.invalidateQueries({queryKey:["offer-placeholders"]}),f()},onError:x=>{console.error("Save error:",x),e({title:"Error",description:"Failed to save placeholder",variant:"destructive"})}}),h=If({mutationFn:async x=>{const{error:v}=await Et.from("offer_placeholders").delete().eq("id",x);if(v)throw v},onSuccess:()=>{e({title:"Success",description:"Placeholder deleted successfully"}),t.invalidateQueries({queryKey:["all-placeholders"]}),t.invalidateQueries({queryKey:["offer-placeholders"]})},onError:x=>{console.error("Delete error:",x),e({title:"Error",description:"Failed to delete placeholder",variant:"destructive"})}}),p=If({mutationFn:async({id:x,is_active:v})=>{const{error:b}=await Et.from("offer_placeholders").update({is_active:v}).eq("id",x);if(b)throw b},onSuccess:()=>{t.invalidateQueries({queryKey:["all-placeholders"]}),t.invalidateQueries({queryKey:["offer-placeholders"]})}}),f=()=>{o({placeholder_key:"",display_name:"",description:"",data_source:"admission_dashboard",field_mapping:"",conditional_logic:""}),s(null),r(!1)},g=x=>{o({placeholder_key:x.placeholder_key,display_name:x.display_name,description:x.description||"",data_source:x.data_source,field_mapping:x.field_mapping?JSON.stringify(x.field_mapping,null,2):"",conditional_logic:x.conditional_logic?JSON.stringify(x.conditional_logic,null,2):""}),s(x),r(!0)},m=()=>{if(!i.placeholder_key.trim()||!i.display_name.trim()){e({title:"Validation Error",description:"Placeholder key and display name are required",variant:"destructive"});return}if(i.field_mapping)try{JSON.parse(i.field_mapping)}catch{e({title:"Validation Error",description:"Field mapping must be valid JSON",variant:"destructive"});return}if(i.conditional_logic)try{JSON.parse(i.conditional_logic)}catch{e({title:"Validation Error",description:"Conditional logic must be valid JSON",variant:"destructive"});return}u.mutate(i)},y=x=>{x==="allotted_school"?o(v=>({...v,placeholder_key:"ALLOTTED_SCHOOL",display_name:"Allotted School",description:"School assigned based on student performance and preferences",field_mapping:JSON.stringify({source_table:"admission_dashboard",source_field:"allotted_school",default_value:"Not Assigned"},null,2),conditional_logic:JSON.stringify({conditions:[{if:"final_marks >= 18",then:"SOP",description:"Assign School of Programming for high performers"},{if:"final_marks < 18 && final_marks >= 15",then:"SOB",description:"Assign School of Business for average performers"},{else:"General",description:"Default assignment"}]},null,2)})):x==="template_type"&&o(v=>({...v,placeholder_key:"TEMPLATE_TYPE",display_name:"Template Type",description:"Determines which template to use based on student data",field_mapping:JSON.stringify({source_table:"admission_dashboard",logic_based:!0},null,2),conditional_logic:JSON.stringify({template_selection:[{if:"allotted_school === 'SOP'",template:"sop_offer_letter",description:"Use SOP offer letter template"},{if:"allotted_school === 'SOB'",template:"sob_offer_letter",description:"Use SOB offer letter template"}]},null,2)}))};return c?d.jsx("div",{children:"Loading placeholders..."}):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-lg font-semibold",children:"Manage Placeholders"}),d.jsxs(fe,{onClick:()=>r(!0),children:[d.jsx(Qn,{className:"h-4 w-4 mr-2"}),"Add Placeholder"]})]}),d.jsx("div",{className:"grid gap-4",children:l==null?void 0:l.map(x=>d.jsxs(Ct,{children:[d.jsx(Vt,{className:"pb-3",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(Yt,{className:"text-base",children:x.display_name}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Fa,{variant:x.is_active?"default":"secondary",children:x.is_active?"Active":"Inactive"}),x.field_mapping&&d.jsxs(Fa,{variant:"outline",className:"text-xs",children:[d.jsx(F2,{className:"h-3 w-3 mr-1"}),"Mapped"]}),x.conditional_logic&&d.jsxs(Fa,{variant:"outline",className:"text-xs",children:[d.jsx(P2,{className:"h-3 w-3 mr-1"}),"Logic"]}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>g(x),children:d.jsx(oc,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>p.mutate({id:x.id,is_active:!x.is_active}),children:x.is_active?d.jsx(us,{className:"h-4 w-4"}):d.jsx(Qn,{className:"h-4 w-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h.mutate(x.id),children:d.jsx(Na,{className:"h-4 w-4"})})]})]})}),d.jsx(It,{children:d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Fa,{variant:"outline",children:x.placeholder_key}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:["from ",x.data_source]})]}),x.description&&d.jsx("p",{className:"text-sm text-muted-foreground",children:x.description}),x.field_mapping&&d.jsxs("div",{className:"text-xs bg-blue-50 p-2 rounded",children:[d.jsx("strong",{children:"Field Mapping:"})," ",JSON.stringify(x.field_mapping)]}),x.conditional_logic&&d.jsxs("div",{className:"text-xs bg-green-50 p-2 rounded",children:[d.jsx("strong",{children:"Conditional Logic:"})," ",JSON.stringify(x.conditional_logic)]})]})})]},x.id))}),d.jsx(ta,{open:n,onOpenChange:f,children:d.jsxs(na,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[d.jsx(ka,{children:d.jsx(ra,{children:a?"Edit Placeholder":"Add New Placeholder"})}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex gap-2 mb-4",children:[d.jsxs(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>y("allotted_school"),children:[d.jsx(F2,{className:"h-4 w-4 mr-1"}),"Allotted School Preset"]}),d.jsxs(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>y("template_type"),children:[d.jsx(P2,{className:"h-4 w-4 mr-1"}),"Template Type Preset"]})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"placeholder_key",children:"Placeholder Key"}),d.jsx(Je,{id:"placeholder_key",value:i.placeholder_key,onChange:x=>o(v=>({...v,placeholder_key:x.target.value.toUpperCase().replace(/\s+/g,"_")})),placeholder:"STUDENT_NAME"})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"display_name",children:"Display Name"}),d.jsx(Je,{id:"display_name",value:i.display_name,onChange:x=>o(v=>({...v,display_name:x.target.value})),placeholder:"Student Name"})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"data_source",children:"Data Source"}),d.jsxs(vt,{value:i.data_source,onValueChange:x=>o(v=>({...v,data_source:x})),children:[d.jsx(pt,{children:d.jsx(bt,{})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"admission_dashboard",children:"Admission Dashboard"}),d.jsx(Ee,{value:"profiles",children:"User Profiles"}),d.jsx(Ee,{value:"custom",children:"Custom Value"})]})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"description",children:"Description"}),d.jsx(As,{id:"description",value:i.description,onChange:x=>o(v=>({...v,description:x.target.value})),placeholder:"Description of what this placeholder represents"})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"field_mapping",children:"Field Mapping (JSON)"}),d.jsx(As,{id:"field_mapping",value:i.field_mapping,onChange:x=>o(v=>({...v,field_mapping:x.target.value})),placeholder:'{"source_table": "admission_dashboard", "source_field": "allotted_school"}',className:"font-mono text-sm",rows:4}),d.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Optional: Define how to map this placeholder to database fields"})]}),d.jsxs("div",{children:[d.jsx(Pe,{htmlFor:"conditional_logic",children:"Conditional Logic (JSON)"}),d.jsx(As,{id:"conditional_logic",value:i.conditional_logic,onChange:x=>o(v=>({...v,conditional_logic:x.target.value})),placeholder:'{"conditions": [{"if": "final_marks >= 18", "then": "SOP"}]}',className:"font-mono text-sm",rows:6}),d.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Optional: Define conditional logic for dynamic value assignment"})]}),d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsx(fe,{variant:"outline",onClick:f,children:"Cancel"}),d.jsxs(fe,{onClick:m,disabled:u.isPending,children:[d.jsx(Rm,{className:"h-4 w-4 mr-2"}),u.isPending?"Saving...":"Save"]})]})]})]})})]})},hG=()=>{const[e,t]=N.useState("templates"),[n,r]=N.useState(null),[a,s]=N.useState(!1);return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsxs("main",{className:"md:ml-64 p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Offer Letter Module"}),d.jsx("p",{className:"text-muted-foreground",children:"Create, manage, and send personalized admission offer emails with attachments"})]}),d.jsxs(Rj,{value:e,onValueChange:t,className:"w-full",children:[d.jsxs(lk,{className:"grid w-full grid-cols-3 mb-6",children:[d.jsxs(mo,{value:"templates",className:"flex items-center gap-2",children:[d.jsx(hd,{className:"h-4 w-4"}),"Templates"]}),d.jsxs(mo,{value:"history",className:"flex items-center gap-2",children:[d.jsx(Ise,{className:"h-4 w-4"}),"Offer History"]}),d.jsxs(mo,{value:"settings",className:"flex items-center gap-2",children:[d.jsx(P2,{className:"h-4 w-4"}),"Settings"]})]}),d.jsx(go,{value:"templates",className:"space-y-6",children:!n&&!a?d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-xl font-semibold",children:"Email Templates"}),d.jsxs(fe,{onClick:()=>s(!0),children:[d.jsx(Qn,{className:"h-4 w-4 mr-2"}),"New Template"]})]}),d.jsx(U0e,{onEditTemplate:r})]}):d.jsx(B0e,{templateId:n,isNew:a,onClose:()=>{r(null),s(!1)}})}),d.jsx(go,{value:"history",className:"space-y-6",children:d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Offer History"}),d.jsx(W0e,{})]})}),d.jsx(go,{value:"settings",className:"space-y-6",children:d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Template Settings"}),d.jsx("p",{className:"text-muted-foreground mb-6",children:"Manage placeholder fields and template configurations"}),d.jsx(V0e,{})]})})]})]})]})};var H0e="Separator",JP="horizontal",G0e=["horizontal","vertical"],pG=N.forwardRef((e,t)=>{const{decorative:n,orientation:r=JP,...a}=e,s=q0e(r)?r:JP,o=n?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return d.jsx(Qe.div,{"data-orientation":s,...o,...a,ref:t})});pG.displayName=H0e;function q0e(e){return G0e.includes(e)}var fG=pG;const mG=N.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>d.jsx(fG,{ref:a,decorative:n,orientation:t,className:Fe("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r}));mG.displayName=fG.displayName;var mA="Radio",[K0e,gG]=ia(mA),[Q0e,X0e]=K0e(mA),yG=N.forwardRef((e,t)=>{const{__scopeRadio:n,name:r,checked:a=!1,required:s,disabled:i,value:o="on",onCheck:l,form:c,...u}=e,[h,p]=N.useState(null),f=kt(t,y=>p(y)),g=N.useRef(!1),m=h?c||!!h.closest("form"):!0;return d.jsxs(Q0e,{scope:n,checked:a,disabled:i,children:[d.jsx(Qe.button,{type:"button",role:"radio","aria-checked":a,"data-state":wG(a),"data-disabled":i?"":void 0,disabled:i,value:o,...u,ref:f,onClick:Te(e.onClick,y=>{a||l==null||l(),m&&(g.current=y.isPropagationStopped(),g.current||y.stopPropagation())})}),m&&d.jsx(bG,{control:h,bubbles:!g.current,name:r,value:o,checked:a,required:s,disabled:i,form:c,style:{transform:"translateX(-100%)"}})]})});yG.displayName=mA;var xG="RadioIndicator",vG=N.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:r,...a}=e,s=X0e(xG,n);return d.jsx(Lr,{present:r||s.checked,children:d.jsx(Qe.span,{"data-state":wG(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t})})});vG.displayName=xG;var Y0e="RadioBubbleInput",bG=N.forwardRef(({__scopeRadio:e,control:t,checked:n,bubbles:r=!0,...a},s)=>{const i=N.useRef(null),o=kt(i,s),l=Cj(n),c=sj(t);return N.useEffect(()=>{const u=i.current;if(!u)return;const h=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==n&&f){const g=new Event("click",{bubbles:r});f.call(u,n),u.dispatchEvent(g)}},[l,n,r]),d.jsx(Qe.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:o,style:{...a.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});bG.displayName=Y0e;function wG(e){return e?"checked":"unchecked"}var J0e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],kk="RadioGroup",[Z0e,Xat]=ia(kk,[Wm,gG]),NG=Wm(),kG=gG(),[e1e,t1e]=Z0e(kk),SG=N.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:r,defaultValue:a,value:s,required:i=!1,disabled:o=!1,orientation:l,dir:c,loop:u=!0,onValueChange:h,...p}=e,f=NG(n),g=Bm(c),[m,y]=Io({prop:s,defaultProp:a??null,onChange:h,caller:kk});return d.jsx(e1e,{scope:n,name:r,required:i,disabled:o,value:m,onValueChange:y,children:d.jsx(jj,{asChild:!0,...f,orientation:l,dir:g,loop:u,children:d.jsx(Qe.div,{role:"radiogroup","aria-required":i,"aria-orientation":l,"data-disabled":o?"":void 0,dir:g,...p,ref:t})})})});SG.displayName=kk;var _G="RadioGroupItem",CG=N.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:r,...a}=e,s=t1e(_G,n),i=s.disabled||r,o=NG(n),l=kG(n),c=N.useRef(null),u=kt(t,c),h=s.value===a.value,p=N.useRef(!1);return N.useEffect(()=>{const f=m=>{J0e.includes(m.key)&&(p.current=!0)},g=()=>p.current=!1;return document.addEventListener("keydown",f),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",g)}},[]),d.jsx(Aj,{asChild:!0,...o,focusable:!i,active:h,children:d.jsx(yG,{disabled:i,required:s.required,checked:h,...l,...a,name:s.name,ref:u,onCheck:()=>s.onValueChange(a.value),onKeyDown:Te(f=>{f.key==="Enter"&&f.preventDefault()}),onFocus:Te(a.onFocus,()=>{var f;p.current&&((f=c.current)==null||f.click())})})})});CG.displayName=_G;var n1e="RadioGroupIndicator",IG=N.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...r}=e,a=kG(n);return d.jsx(vG,{...a,...r,ref:t})});IG.displayName=n1e;var EG=SG,TG=CG,r1e=IG;const OI=N.forwardRef(({className:e,...t},n)=>d.jsx(EG,{className:Fe("grid gap-2",e),...t,ref:n}));OI.displayName=EG.displayName;const _0=N.forwardRef(({className:e,...t},n)=>d.jsx(TG,{ref:n,className:Fe("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:d.jsx(r1e,{className:"flex items-center justify-center",children:d.jsx(KT,{className:"h-2.5 w-2.5 fill-current text-current"})})}));_0.displayName=TG.displayName;function a1e({questionType:e,options:t,correctAnswer:n,onOptionsChange:r,onCorrectAnswerChange:a}){const[s,i]=N.useState(t||{english:["","","",""],hindi:["","","",""],marathi:["","","",""]}),[o,l]=N.useState(n||0);N.useEffect(()=>{t&&i(t),typeof n=="number"&&l(n)},[t,n]);const c=(m,y,x)=>{const v={...s,[m]:[...s[m]]};v[m][y]=x,i(v),r(v)},u=()=>{const m={english:[...s.english,""],hindi:[...s.hindi,""],marathi:[...s.marathi,""]};i(m),r(m)},h=m=>{if(s.english.length<=2)return;const y={english:s.english.filter((x,v)=>v!==m),hindi:s.hindi.filter((x,v)=>v!==m),marathi:s.marathi.filter((x,v)=>v!==m)};i(y),r(y),o>=y.english.length&&(l(0),a(0))},p=m=>{l(m),a(m)},f=m=>{a(m==="true"?1:0)},g=m=>{a(m)};return e==="MCQ"?d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Multiple Choice Options"})}),d.jsxs(It,{className:"space-y-4",children:[d.jsx(OI,{value:o.toString(),onValueChange:m=>p(parseInt(m)),children:s.english.map((m,y)=>d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsx(_0,{value:y.toString()}),d.jsxs("div",{className:"grid grid-cols-3 gap-2 flex-1",children:[d.jsx(Je,{value:s.english[y],onChange:x=>c("english",y,x.target.value),placeholder:`EN Option ${y+1}`}),d.jsx(Je,{value:s.hindi[y],onChange:x=>c("hindi",y,x.target.value),placeholder:`HI Option ${y+1}`}),d.jsx(Je,{value:s.marathi[y],onChange:x=>c("marathi",y,x.target.value),placeholder:`MR Option ${y+1}`})]}),s.english.length>2&&d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>h(y),children:d.jsx(Na,{className:"w-4 h-4"})})]},y))}),d.jsxs(fe,{type:"button",variant:"outline",onClick:u,children:[d.jsx(Qn,{className:"w-4 h-4 mr-2"})," Add Option"]})]})]}):e==="true_false"?d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"True/False Answer"})}),d.jsx(It,{children:d.jsxs(OI,{value:n===1?"true":"false",onValueChange:f,children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(_0,{value:"true"}),d.jsx(Pe,{children:"True"})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(_0,{value:"false"}),d.jsx(Pe,{children:"False"})]})]})})]}):e==="short_answer"||e==="fill_in_blank"?d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Expected Answer"})}),d.jsx(It,{children:d.jsx(Je,{value:n||"",onChange:m=>g(m.target.value),placeholder:"Enter the expected answer"})})]}):e==="long_answer"?d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Sample Answer / Grading Criteria"})}),d.jsx(It,{children:d.jsx(As,{value:n||"",onChange:m=>g(m.target.value),placeholder:"Provide a sample answer or grading criteria",rows:4})})]}):e==="coding"?d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Expected Solution"})}),d.jsx(It,{children:d.jsx(As,{value:n||"",onChange:m=>g(m.target.value),placeholder:"Provide the expected code solution",rows:6,className:"font-mono"})})]}):null}function s1e({question:e,onSave:t,onCancel:n,difficultyLevels:r}){const{toast:a}=Qt(),[s,i]=N.useState({question_type:"MCQ",difficulty_level:"",points:0,question_text:{english:"",hindi:"",marathi:""},options:{english:["","","",""],hindi:["","","",""],marathi:["","","",""]},correct_answer:0,explanation:""});N.useEffect(()=>{var h,p;if(!e)return;const u=r.find(f=>f.id===e.difficulty_level);i({question_type:e.question_type??"MCQ",difficulty_level:((h=e.difficulty_level)==null?void 0:h.toString())??"",points:(u==null?void 0:u.points)??0,question_text:{english:e.english_text??"",hindi:e.hindi_text??"",marathi:e.marathi_text??""},options:{english:e.english_options??["","","",""],hindi:e.hindi_options??["","","",""],marathi:e.marathi_options??["","","",""]},correct_answer:((p=e.answer_key)==null?void 0:p[0])??0,explanation:e.explanation??""})},[e,r]);const o=(u,h)=>i(p=>({...p,[u]:h})),l=(u,h)=>i(p=>({...p,question_text:{...p.question_text,[u]:h}})),c=u=>{if(u.preventDefault(),!s.question_type){a({title:"Validation Error",description:"Select a question type",variant:"destructive"});return}if(!s.difficulty_level){a({title:"Validation Error",description:"Select difficulty level",variant:"destructive"});return}if(!s.question_text.english.trim()){a({title:"Validation Error",description:"Enter question text in English",variant:"destructive"});return}if(!s.question_text.hindi.trim()){a({title:"Validation Error",description:"Enter question text in Hindi",variant:"destructive"});return}if(!s.question_text.marathi.trim()){a({title:"Validation Error",description:"Enter question text in Marathi",variant:"destructive"});return}if(s.question_type==="MCQ"){const{english:p,hindi:f,marathi:g}=s.options;if(p.some(y=>!y.trim())||f.some(y=>!y.trim())||g.some(y=>!y.trim())){a({title:"Validation Error",description:"All MCQ options must be filled in all languages",variant:"destructive"});return}if(s.correct_answer===null||s.correct_answer===void 0){a({title:"Validation Error",description:"Select the correct answer",variant:"destructive"});return}}const h={difficulty_level:s.difficulty_level,question_type:s.question_type,english_text:s.question_text.english,hindi_text:s.question_text.hindi,marathi_text:s.question_text.marathi,english_options:s.options.english,hindi_options:s.options.hindi,marathi_options:s.options.marathi,answer_key:[s.correct_answer],explanation:s.explanation};t(h)};return d.jsxs("form",{onSubmit:c,className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx(Pe,{children:"Question Type"}),d.jsxs(vt,{value:s.question_type,onValueChange:u=>o("question_type",u),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select type"})}),d.jsx(ft,{children:d.jsx(Ee,{value:"MCQ",children:"Multiple Choice"})})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Difficulty"}),d.jsxs(vt,{value:s.difficulty_level,onValueChange:u=>{o("difficulty_level",u);const h=r.find(p=>p.id.toString()===u);h&&o("points",h.points)},children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"Select difficulty"})}),d.jsx(ft,{children:r.map(u=>d.jsx(Ee,{value:u.id.toString(),children:u.name},u.id))})]})]})]}),d.jsx("div",{className:"grid grid-cols-2 gap-4",children:d.jsxs("div",{children:[d.jsx(Pe,{children:"Points"}),d.jsx(Je,{type:"number",min:1,value:s.points,disabled:!0})]})}),d.jsx(mG,{}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx(Pe,{children:"Question Text (English)"}),d.jsx(As,{value:s.question_text.english,onChange:u=>l("english",u.target.value),placeholder:"Enter question text in English"})]}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Question Text (Hindi)"}),d.jsx(As,{value:s.question_text.hindi,onChange:u=>l("hindi",u.target.value),placeholder:"Enter question text in Hindi"})]}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Question Text (Marathi)"}),d.jsx(As,{value:s.question_text.marathi,onChange:u=>l("marathi",u.target.value),placeholder:"Enter question text in Marathi"})]})]}),s.question_type==="MCQ"&&d.jsx(a1e,{questionType:s.question_type,options:s.options,correctAnswer:s.correct_answer,onOptionsChange:u=>o("options",u),onCorrectAnswerChange:u=>o("correct_answer",u)}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Explanation (Optional)"}),d.jsx(As,{value:s.explanation,onChange:u=>o("explanation",u.target.value),placeholder:"Provide an explanation for the correct answer...",rows:3})]}),d.jsxs("div",{className:"flex items-center justify-end gap-4",children:[d.jsxs(fe,{type:"button",variant:"outline",onClick:n,children:[d.jsx(us,{className:"w-4 h-4 mr-2"})," Cancel"]}),d.jsxs(fe,{type:"submit",children:[d.jsx(Rm,{className:"w-4 h-4 mr-2"}),e?"Update Question":"Create Question"]})]})]})}function i1e({questions:e,loading:t,onEdit:n,onArchive:r,onDelete:a}){const s=o=>o<=1?{label:"Easy",color:"bg-green-100 text-green-800"}:o===2?{label:"Medium",color:"bg-yellow-100 text-yellow-800"}:{label:"Hard",color:"bg-red-100 text-red-800"},i=o=>({MCQ:"Multiple Choice",TrueFalse:"True/False",ShortAnswer:"Short Answer",LongAnswer:"Long Answer",Coding:"Coding",FillInBlank:"Fill in Blank"})[o]||o;return t?d.jsx("div",{className:"space-y-4",children:[...Array(5)].map((o,l)=>d.jsx(Ct,{children:d.jsx(It,{className:"p-4",children:d.jsxs("div",{className:"animate-pulse",children:[d.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),d.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})})},l))}):e.length===0?d.jsx("div",{className:"text-center py-8",children:d.jsx("p",{className:"text-muted-foreground",children:"No questions found"})}):d.jsx("div",{className:"space-y-4 h-[600px] overflow-y-auto ",children:e.map(o=>{const l=s(o.difficulty_level);return d.jsx(Ct,{children:d.jsx(It,{className:"p-4",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx(Fa,{className:l.color,children:l.label}),d.jsx(Fa,{variant:"outline",children:i(o.question_type)}),o.points&&d.jsxs(Fa,{variant:"outline",children:[o.points," pts"]})]}),d.jsx("h3",{className:"font-medium text-sm mb-2",children:d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"EN:"})," ",o.english_text]}),d.jsxs("div",{children:[d.jsx("strong",{children:"HI:"})," ",o.hindi_text]}),d.jsxs("div",{children:[d.jsx("strong",{children:"MR:"})," ",o.marathi_text]})]})}),d.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[d.jsxs("span",{children:["Created:"," ",li(new Date(o.created_at),"MMM dd, yyyy")]}),o.version_number&&d.jsxs("span",{children:["Version: ",o.version_number]})]})]}),d.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>n(o),title:"Edit",children:d.jsx(oc,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>a(o.id),title:"Delete Permanently",className:"text-red-600 hover:text-red-700",children:d.jsx(Na,{className:"w-4 h-4"})})]})]})})},o.id)})})}const o1e=Cv("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),jG=N.forwardRef(({className:e,variant:t,...n},r)=>d.jsx("div",{ref:r,role:"alert",className:Fe(o1e({variant:t}),e),...n}));jG.displayName="Alert";const l1e=N.forwardRef(({className:e,...t},n)=>d.jsx("h5",{ref:n,className:Fe("mb-1 font-medium leading-none tracking-tight",e),...t}));l1e.displayName="AlertTitle";const AG=N.forwardRef(({className:e,...t},n)=>d.jsx("div",{ref:n,className:Fe("text-sm [&_p]:leading-relaxed",e),...t}));AG.displayName="AlertDescription";function u1e({onImportComplete:e}){const[t,n]=N.useState(""),[r,a]=N.useState([]),[s,i]=N.useState("idle"),[o,l]=N.useState(0),[c,u]=N.useState({success:0,errors:0,duplicates:0}),[h,p]=N.useState([]),{toast:f}=Qt(),{user:g}=Gs(),m=()=>{const w=["difficulty_level,question_type,english_text,hindi_text,marathi_text,english_options,hindi_options,marathi_options,answer_key,topic",'1,MCQ,"What is 2+2?","2+2 क्या है?","2+2 काय आहे?","[""2"",""3"",""4"",""5""]","[""२"",""३"",""४"",""५""]","[""२"",""३"",""४"",""५""]","[2]",1','2,MCQ,"Capital of India?","भारत की राजधानी?","भारताची राजधानी?","[""Mumbai"",""Delhi"",""Kolkata"",""Chennai""]","[""मुंबई"",""दिल्ली"",""कोलकाता"",""चेन्नई""]","[""मुंबई"",""दिल्ली"",""कोलकाता"",""चेन्नई""]","[1]",1','3,MCQ,"How many sides in hexagon?","षट्भुज में कितनी भुजाएँ?","षट्कोणात किती बाजू?","[""5"",""6"",""7"",""8""]","[""५"",""६"",""७"",""८""]","[""५"",""६"",""७"",""८""]","[1]",1'].join(`
`),k=new Blob([w],{type:"text/csv"}),I=window.URL.createObjectURL(k),C=document.createElement("a");C.href=I,C.download="multi_language_question_template.csv",C.click(),window.URL.revokeObjectURL(I)},y=()=>{if(!t.trim()){f({title:"No Data",description:"Please paste CSV data or upload a file",variant:"destructive"});return}i("parsing"),WV.parse(t,{header:!0,skipEmptyLines:!0,complete:w=>{if(w.errors.length>0){p(w.errors.map(C=>C.message)),i("error");return}const k=[],I=[];w.data.forEach((C,S)=>{try{if(!C.english_text||!C.question_type||!C.answer_key){I.push(`Row ${S+1}: Missing required fields (english_text, question_type, answer_key)`);return}const E=["MCQ","TF","SA","multiple_choice","true_false","short_answer"];if(!E.includes(C.question_type)){I.push(`Row ${S+1}: Invalid question_type. Must be one of: ${E.join(", ")}`);return}let T=[],$=[],_=[],M=null;try{C.english_options&&C.english_options.trim()&&(T=JSON.parse(C.english_options)),C.hindi_options&&C.hindi_options.trim()&&($=JSON.parse(C.hindi_options)),C.marathi_options&&C.marathi_options.trim()&&(_=JSON.parse(C.marathi_options)),M=JSON.parse(C.answer_key)}catch{I.push(`Row ${S+1}: Invalid JSON format in options or answer_key`);return}const U={MCQ:"multiple_choice",TF:"true_false",SA:"short_answer"}[C.question_type]||C.question_type,O={1:"easy",2:"medium",3:"hard",easy:"easy",medium:"medium",hard:"hard"},F={english_text:C.english_text,hindi_text:C.hindi_text||"",marathi_text:C.marathi_text||"",question_text:C.english_text,question_type:U,english_options:T,hindi_options:$,marathi_options:_,options:T.map((D,R)=>({id:(R+1).toString(),text:D})),correct_answer:M,answer_key:M,explanation:"",difficulty_level:O[C.difficulty_level]||"medium",language:"multi",points:1,tags:[],time_limit_seconds:30,topic:C.topic||"1",status:!0};k.push(F)}catch(E){I.push(`Row ${S+1}: ${E.message}`)}}),I.length>0?(p(I),i("error")):(a(k),i("parsed"),f({title:"CSV Parsed Successfully",description:`Found ${k.length} valid questions`}))},error:w=>{p([w.message]),i("error")}})},x=async()=>{var w,k,I,C,S,E,T,$,_,M;if(!t.trim()){f({title:"No Data",description:"Please parse CSV data first",variant:"destructive"});return}if(i("importing"),l(0),!(g!=null&&g.id)){f({title:"Authentication Error",description:"You must be logged in to import questions",variant:"destructive"}),i("error");return}try{const L=setInterval(()=>{l(O=>O>=90?(clearInterval(L),90):O+10)},200),U=await uhe(t);clearInterval(L),l(100),u({success:((w=U.data)==null?void 0:w.success)||U.success||r.length,errors:((I=(k=U.data)==null?void 0:k.errors)==null?void 0:I.length)||((C=U.errors)==null?void 0:C.length)||0,duplicates:((S=U.data)==null?void 0:S.duplicates)||U.duplicates||0}),((T=(E=U.data)==null?void 0:E.errors)!=null&&T.length||($=U.errors)!=null&&$.length)&&p(((_=U.data)==null?void 0:_.errors)||U.errors||[]),i("complete"),f({title:"Import Complete",description:`Successfully imported ${((M=U.data)==null?void 0:M.success)||U.success||r.length} questions.`}),e()}catch(L){console.error("Import error:",L),p([L.message||"Failed to import questions"]),i("error"),f({title:"Import Failed",description:L.message||"Something went wrong",variant:"destructive"})}},v=w=>{var C;const k=(C=w.target.files)==null?void 0:C[0];if(!k)return;if(k.type!=="text/csv"&&!k.name.endsWith(".csv")){f({title:"Invalid File",description:"Please upload a CSV file",variant:"destructive"});return}const I=new FileReader;I.onload=S=>{var E;typeof((E=S.target)==null?void 0:E.result)=="string"&&n(S.target.result)},I.readAsText(k)},b=()=>{n(""),a([]),i("idle"),l(0),u({success:0,errors:0,duplicates:0}),p([])};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs(jG,{children:[d.jsx(yf,{className:"h-4 w-4"}),d.jsx(AG,{children:"Import questions in bulk using CSV. Supports English/Hindi/Marathi text and options. Follow the template format."})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs(fe,{variant:"outline",onClick:m,children:[d.jsx($N,{className:"w-4 h-4 mr-2"})," Download Template"]}),d.jsxs("div",{children:[d.jsx("input",{type:"file",accept:".csv",onChange:v,className:"hidden",id:"csv-upload"}),d.jsxs(fe,{variant:"outline",onClick:()=>{var w;return(w=document.getElementById("csv-upload"))==null?void 0:w.click()},children:[d.jsx(Dm,{className:"w-4 h-4 mr-2"})," Upload CSV File"]})]}),s!=="idle"&&d.jsx(fe,{variant:"outline",onClick:b,children:"Reset"})]}),d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"CSV Data"})}),d.jsxs(It,{children:[d.jsx(As,{value:t,onChange:w=>n(w.target.value),placeholder:"Paste CSV data or upload a file...",rows:10,className:"font-mono text-sm"}),d.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[d.jsx(fe,{onClick:y,disabled:!t.trim()||s==="parsing",children:s==="parsing"?"Parsing...":"Parse CSV Data"}),s==="parsed"&&d.jsxs(fe,{onClick:x,children:["Import ",r.length," Questions"]})]}),s==="parsed"&&d.jsx("div",{className:"mt-4",children:d.jsxs(Fa,{variant:"secondary",children:[r.length," questions ready for import"]})})]})]}),s==="importing"&&d.jsx(Ct,{children:d.jsx(It,{className:"p-6",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm font-medium",children:"Importing questions..."}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(o),"%"]})]}),d.jsx(rA,{value:o,className:"w-full"})]})})}),s==="complete"&&d.jsx(Ct,{children:d.jsxs(It,{className:"p-6",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[d.jsx(dd,{className:"w-5 h-5 text-green-600"}),d.jsx("h3",{className:"font-medium",children:"Import Complete"})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.success}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"Successful"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c.duplicates}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"Duplicates"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-2xl font-bold text-red-600",children:c.errors}),d.jsx("div",{className:"text-sm text-muted-foreground",children:"Errors"})]})]})]})}),h.length>0&&d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{className:"text-red-600",children:"Import Errors"})}),d.jsx(It,{children:d.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:h.map((w,k)=>d.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:w},k))})})]})]})}function c1e({filters:e,onFiltersChange:t,difficultyLevels:n}){const r=(s,i)=>{t({...e,[s]:i})},a=()=>{t({status:"All",difficulty_level:"All",question_type:"All",topic:""})};return d.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"font-medium",children:"Filters"}),d.jsx(fe,{variant:"ghost",size:"sm",onClick:a,children:"Clear All"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[d.jsxs("div",{children:[d.jsx(Pe,{children:"Difficulty"}),d.jsxs(vt,{value:e.difficulty_level||"All",onValueChange:s=>r("difficulty_level",s),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"All levels"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"All",children:"All"}),n.map(s=>d.jsx(Ee,{value:s.id.toString(),children:s.name},s.id))]})]})]}),d.jsxs("div",{children:[d.jsx(Pe,{children:"Question Type"}),d.jsxs(vt,{value:e.question_type||"All",onValueChange:s=>r("question_type",s),children:[d.jsx(pt,{children:d.jsx(bt,{placeholder:"All types"})}),d.jsxs(ft,{children:[d.jsx(Ee,{value:"All",children:"All"}),d.jsx(Ee,{value:"MCQ",children:"Multiple Choice"})]})]})]})]})]})}const d1e="https://dev-new-admissions.navgurukul.org/api/v1",h1e=()=>{try{return localStorage.getItem("authToken")}catch(e){return console.error("Error accessing localStorage:",e),null}},p1e=()=>{const e=h1e();return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},Dy=async(e,t={},n=8e3)=>{const r=new AbortController,a=setTimeout(()=>r.abort(),n),s=`${d1e}${e}`;try{const i=await fetch(s,{...t,signal:r.signal,headers:p1e()});if(clearTimeout(a),!i.ok){const o=await i.json().catch(()=>({}));throw new Error(o.message||`HTTP error! status: ${i.status}`)}return await i.json()}catch(i){throw clearTimeout(a),i.name==="AbortError"?new Error("Request timed out"):i}},f1e={async createDifficultyLevel(e){try{const t=ZP.validateDifficultyLevel(e);if(t.length>0)throw new Error(t.join(", "));return await Dy("/difficulty-levels/createDifficultyLevels",{method:"POST",body:JSON.stringify(e)})}catch(t){throw console.error("Create difficulty level error:",t),new Error(t.message||"Failed to create difficulty level")}},async getDifficultyLevels(){try{return await Dy("/difficulty-levels/getDifficultyLevels")}catch(e){throw console.error("Get difficulty levels error:",e),new Error(e.message||"Failed to fetch difficulty levels")}},async getDifficultyLevelById(e){try{return await Dy(`/difficulty-levels/getDifficultyLevelsById/${e}`)}catch(t){throw console.error("Get difficulty level by ID error:",t),new Error(t.message||"Failed to fetch difficulty level")}},async updateDifficultyLevel(e,t){try{if(t.name){const n=ZP.validateDifficultyLevel({name:t.name,description:t.description||""});if(n.length>0)throw new Error(n.join(", "))}return await Dy(`/difficulty-levels/updateDifficultyLevels/${e}`,{method:"PUT",body:JSON.stringify(t)})}catch(n){throw console.error("Update difficulty level error:",n),new Error(n.message||"Failed to update difficulty level")}},async deleteDifficultyLevel(e){try{await Dy(`/difficulty-levels/deleteDifficultyLevels/${e}`,{method:"DELETE"})}catch(t){throw console.error("Delete difficulty level error:",t),new Error(t.message||"Failed to delete difficulty level")}},async getActiveDifficultyLevels(){try{return(await this.getDifficultyLevels()).filter(t=>t.status)}catch(e){throw console.error("Get active difficulty levels error:",e),new Error(e.message||"Failed to fetch active difficulty levels")}},async toggleDifficultyLevelStatus(e,t){return this.updateDifficultyLevel(e,{status:!t})}},ZP={validateDifficultyLevelName:e=>e.length>=2&&e.length<=50,getDifficultyColor(e){return{easy:"bg-green-100 text-green-800 border-green-200",medium:"bg-yellow-100 text-yellow-800 border-yellow-200",hard:"bg-red-100 text-red-800 border-red-200",beginner:"bg-blue-100 text-blue-800 border-blue-200",intermediate:"bg-orange-100 text-orange-800 border-orange-200",advanced:"bg-purple-100 text-purple-800 border-purple-200",expert:"bg-gray-100 text-gray-800 border-gray-200"}[e.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-200"},getDifficultyLabel(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},validateDifficultyLevel(e){const t=[];return!e.name||e.name.trim().length===0?t.push("Name is required"):this.validateDifficultyLevelName(e.name)||t.push("Name must be between 2-50 characters"),e.description&&e.description.length>500&&t.push("Description must be less than 500 characters"),t}};function m1e(e={},t=""){const[n,r]=N.useState([]),[a,s]=N.useState(!0),[i,o]=N.useState([]),{toast:l}=Qt();N.useEffect(()=>{(async()=>{var x;try{const v=await f1e.getDifficultyLevels(),b=Array.isArray((x=v.data)==null?void 0:x.data)?v.data.data.map(w=>({id:w.id,name:w.name,points:w.marks??0})):[];o(b)}catch(v){console.error("Failed to fetch difficulty levels:",v),o([])}})()},[]);const c=y=>{const x=i.find(v=>v.id===Number(y)||v.name.toLowerCase()===String(y).toLowerCase());return x?x.name.toLowerCase():"unknown"},u=async()=>{try{s(!0);const x=(await rhe()).filter(v=>{var w;const b=c(v.difficulty_level);return!(e.difficulty_level&&e.difficulty_level!=="All"&&String(v.difficulty_level)!==String(e.difficulty_level)||e.question_type&&e.question_type!=="All"&&v.question_type!==e.question_type||t&&!((w=v.english_text)!=null&&w.toLowerCase().includes(t.toLowerCase())))});r(x)}catch(y){console.error("Error fetching questions:",y),l({title:"Error",description:"Failed to fetch questions",variant:"destructive"})}finally{s(!1)}},h=async y=>{try{await nhe(y),await u()}catch(x){throw l({title:"Error",description:x.message||"Failed to create question",variant:"destructive"}),x}},p=async(y,x)=>{try{await she(y,x),await u()}catch(v){throw l({title:"Error",description:v.message||"Failed to update question",variant:"destructive"}),v}},f=async y=>{try{await ahe(Number(y)),await u()}catch(x){throw l({title:"Error",description:x.message||"Failed to delete question",variant:"destructive"}),x}},g=async y=>{await u()},m=async y=>{await u()};return N.useEffect(()=>{u()},[e,t]),{questions:n,loading:a,createQuestion:h,updateQuestion:p,deleteQuestion:f,archiveQuestion:g,restoreQuestion:m,refetch:u,difficultyLevels:i,getDifficultyLabel:c}}function g1e({activeSet:e,onClose:t,onSave:n,difficultyLevel:r}){const[a,s]=N.useState([]),[i,o]=N.useState(e.questions||[]),[l,c]=N.useState(""),[u,h]=N.useState(null),[p,f]=N.useState(!1);N.useEffect(()=>{if(!(e!=null&&e.name))return;(async()=>{f(!0);try{const w=await cI(e.name),k=await cI("Remaining"),I=[...w.data||[],...k.data||[]];s(I),o(e.questions||[])}catch(w){console.error("Failed to fetch questions:",w)}finally{f(!1)}})()},[e]);const g=b=>{o(w=>w.find(I=>I.id===b.id)?w.filter(I=>I.id!==b.id):[...w,b])},m=Array.isArray(r)?r.reduce((b,w)=>(b[w.id]=w,b),{}):{},y=b=>{var k;switch((((k=m[b])==null?void 0:k.name)||"Unknown").toLowerCase()){case"easy":return"bg-green-100 text-green-700";case"medium":return"bg-yellow-100 text-yellow-700";case"hard":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-600"}},x=N.useMemo(()=>a.filter(b=>{const w=b.english_text.toLowerCase().includes(l.toLowerCase())||b.hindi_text.toLowerCase().includes(l.toLowerCase())||b.marathi_text.toLowerCase().includes(l.toLowerCase()),k=u===null||b.difficulty_level===u;return w&&k}),[a,l,u]),v=()=>{n(i),t()};return d.jsx(ta,{open:!0,onOpenChange:t,children:d.jsxs(na,{className:"max-w-2xl",children:[d.jsx(ka,{children:d.jsxs(ra,{children:["Choose Questions for"," ",d.jsx("span",{className:"font-semibold",children:e.name})]})}),d.jsxs("div",{className:"flex gap-2 mb-3",children:[d.jsx("input",{type:"text",placeholder:"Search questions...",value:l,onChange:b=>c(b.target.value),className:"flex-1 border rounded px-2 py-1"}),d.jsxs("select",{value:u??"",onChange:b=>h(b.target.value?Number(b.target.value):null),className:"border rounded px-2 py-1",children:[d.jsx("option",{value:"",children:"All Difficulties"}),Array.isArray(r)&&r.map(b=>d.jsx("option",{value:b.id,children:b.name},b.id))]})]}),d.jsx("div",{className:"max-h-[400px] overflow-y-auto space-y-2 mt-3",children:p?d.jsx("div",{className:"text-center py-4",children:"Loading questions..."}):x.length===0?d.jsx("div",{className:"text-center py-4",children:"No questions found."}):x.map(b=>{const w=m[b.difficulty_level];return d.jsxs("div",{className:"flex items-start gap-3 p-2 border rounded hover:bg-gray-50",children:[d.jsx(ik,{checked:i.some(k=>k.id===b.id),onCheckedChange:()=>g(b)}),d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${y(w==null?void 0:w.id)}`,children:(w==null?void 0:w.name)||"Unknown"}),d.jsx("div",{className:"text-sm flex-1",children:b.english_text}),d.jsx("div",{className:"text-sm flex-1",children:b.hindi_text}),d.jsx("div",{className:"text-sm flex-1",children:b.marathi_text})]},b.id)})}),d.jsxs(Sj,{className:"mt-4",children:[d.jsxs("div",{className:"text-sm text-gray-600 mr-auto",children:["Selected: ",i.length]}),d.jsx(fe,{onClick:v,children:"Save"}),d.jsx(fe,{variant:"outline",onClick:t,children:"Cancel"})]})]})})}function y1e({allQuestions:e,difficultyLevels:t}){const{toast:n}=Qt(),[r,a]=N.useState([]),[s,i]=N.useState(null),[o,l]=N.useState(null);N.useEffect(()=>{(async()=>{const p=await xj(),f=await Promise.all(p.map(async g=>{const m=await cI(g.name);return{id:g.id,name:g.name,limit:g.maximumMarks,questions:m.data||[],active:g.status,created_at:g.created_at,updated_at:g.updated_at}}));a(f)})()},[]);const c=async(h,p)=>{try{const f=p.questions||[],g=h.filter(y=>!f.some(x=>x.id===y.id)),m=f.filter(y=>!h.some(x=>x.id===y.id));if(g.length>0){const y=g.map(x=>({question_set_id:p.id,question_id:x.id,difficulty_level:x.difficulty_level}));await ihe(y)}if(m.length>0)for(const y of m)await lhe(y.id);a(y=>y.map(x=>x.id===p.id?{...x,questions:h}:x)),n({title:"Questions updated",description:`Added: ${g.length}, Removed: ${m.length}`})}catch(f){n({title:"Error",description:f.message,variant:"destructive"})}},u=async h=>{try{a(p=>p.filter(f=>f.id!==h)),n({title:"Set deleted",description:"The set has been removed successfully.",variant:"destructive"})}catch(p){n({title:"Error",description:p.message,variant:"destructive"})}};return d.jsxs("div",{className:"space-y-4",children:[r.map(h=>d.jsxs(Ct,{className:"relative",children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[d.jsx(Yt,{className:"text-base font-semibold",children:h.name}),d.jsx("div",{className:"flex items-center gap-2",children:d.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>u(h.id),title:"Delete set",children:d.jsx(Na,{className:"h-4 w-4 text-red-500"})})})]})}),d.jsxs(It,{className:"space-y-3",children:[d.jsxs("p",{className:"text-sm font-medium text-gray-600",children:["You’ve selected ",d.jsx("strong",{children:h.questions.length})," question",h.questions.length!==1&&"s","."]}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>i(h),children:[d.jsx(Mse,{className:"h-4 w-4 mr-2"}),"Pick Questions"]})]})]},h.id)),s&&d.jsx(g1e,{activeSet:s,onClose:()=>i(null),difficultyLevel:t,onSave:h=>c(h,s)})]})}function $G(){const[e,t]=N.useState("list"),[n,r]=N.useState(null),[a,s]=N.useState(""),[i,o]=N.useState({status:"All",difficulty_level:"All",question_type:"All",topic:""}),[l,c]=N.useState(!1),{toast:u}=Qt(),{questions:h,loading:p,createQuestion:f,updateQuestion:g,deleteQuestion:m,archiveQuestion:y,difficultyLevels:x,refetch:v}=m1e(i,a);N.useEffect(()=>{},[h]);const b=()=>{v(),u({title:"Import Successful",description:"Questions have been imported and list is refreshed."}),t("list")},w=()=>{r(null),t("editor")},k=E=>{r(E),t("editor")},I=async E=>{try{n?(await g(n.id,E),u({title:"Question Updated",description:"The question has been successfully updated."})):(await f(E),u({title:"Question Created",description:"The question has been successfully created."})),t("list"),r(null)}catch(T){u({title:"Error",description:T.message||"Failed to save question",variant:"destructive"})}},C=async E=>{try{await y(E),u({title:"Question Archived",description:"The question has been archived successfully."})}catch(T){u({title:"Error",description:T.message||"Failed to archive question",variant:"destructive"})}},S=async E=>{try{await m(E),u({title:"Question Deleted",description:"The question has been permanently deleted."})}catch(T){u({title:"Error",description:T.message||"Failed to delete question",variant:"destructive"})}};return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsxs("main",{className:"md:ml-64 p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 ",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Question Repository"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage and organize assessment questions for admissions screening"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs(fe,{variant:"outline",onClick:()=>t("import"),className:"flex items-center gap-2",children:[d.jsx(Dm,{className:"w-4 h-4"}),"Bulk Import"]}),d.jsxs(fe,{onClick:w,className:"flex items-center gap-2",children:[d.jsx(Qn,{className:"w-4 h-4"}),"New Question"]})]})]}),d.jsxs(Rj,{value:e,onValueChange:t,className:"space-y-6",children:[d.jsxs(lk,{className:"grid w-full grid-cols-4 my-6",children:[d.jsx(mo,{value:"list",children:"Questions"}),d.jsx(mo,{value:"editor",children:"Editor"}),d.jsx(mo,{value:"sets",children:"Sets"}),d.jsx(mo,{value:"import",children:"Import"})]}),d.jsx(go,{value:"list",className:"space-y-4",children:d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs(Yt,{className:"flex items-center justify-between",children:["Question Library",d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search questions...",value:a,onChange:E=>s(E.target.value),className:"pl-10 w-64"})]}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>c(!l),className:"flex items-center gap-2",children:[d.jsx($m,{className:"w-4 h-4"}),"Filters"]})]})]})}),d.jsxs(It,{className:"flex flex-col h-[620px]",children:[l&&d.jsx("div",{className:"mb-6",children:d.jsx(c1e,{difficultyLevels:x,filters:i,onFiltersChange:o})}),d.jsx("div",{className:"flex-1 overflow-auto",children:d.jsx(i1e,{questions:h,loading:p,onEdit:E=>{k(E),t("editor")},onArchive:C,onDelete:S})})]})]})}),d.jsx(go,{value:"editor",children:d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:n?"Edit Question":"Create New Question"})}),d.jsx(It,{children:d.jsx(s1e,{difficultyLevels:x,question:n,onSave:I,onCancel:()=>{t("list"),r(null)}})})]})}),d.jsx(go,{value:"sets",children:d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Question Sets"})}),d.jsx(It,{children:d.jsx(y1e,{allQuestions:h,difficultyLevels:x})})]})}),d.jsx(go,{value:"import",children:d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Bulk Import Questions"})}),d.jsx(It,{children:d.jsx(u1e,{onImportComplete:b})})]})})]})]})]})}const RG=[{name:"Admin",href:"/admin",icon:g0,component:PW,allowedRoles:[1]},{name:"Dashboard",href:"/",icon:Ase,component:VH,allowedRoles:[1,2]},{name:"Donor",href:"/donor",icon:uU,component:HH,allowedRoles:[1,2]},{name:"Partner",href:"/partners",icon:kd,component:GH,allowedRoles:[1,2]},{name:"Campus",href:"/campus",icon:gF,component:qH,allowedRoles:[1,2]},{name:"School",href:"/school",icon:gF,component:KH,allowedRoles:[1,2]},{name:"Owner",href:"/owner",icon:fx,component:t6,allowedRoles:[1]},{name:"Interviews",href:"/interviews",icon:Ux,component:XH,allowedRoles:[1,2]},{name:"Offer Letters",href:"/offer-letters",icon:Bx,component:hG,allowedRoles:[1,2]},{name:"Question Repository",href:"/questions",icon:bse,component:$G,allowedRoles:[1,2]}];function ar(){const{user:e,signOut:t}=vhe(),{user:n,signOut:r}=Gs(),[a,s]=N.useState(null),[i,o]=N.useState(!1);N.useEffect(()=>{const m=localStorage.getItem("userInfo");m&&s(JSON.parse(m))},[e,n]);const l=m=>m.split("@")[0].slice(0,2).toUpperCase(),c=()=>{var m;return(n==null?void 0:n.name)||(a==null?void 0:a.name)||((m=e==null?void 0:e.user_metadata)==null?void 0:m.display_name)||"User"},u=()=>(n==null?void 0:n.email)||(e==null?void 0:e.email)||(a==null?void 0:a.email)||"No email",h=()=>{var m;return(n==null?void 0:n.avatar)||(a==null?void 0:a.avatar)||((m=e==null?void 0:e.user_metadata)==null?void 0:m.avatar_url)},p=(n==null?void 0:n.role_id)||2,f=ci(),g=async()=>{n?r():await t(),window.location.href="/Admission-Dashboard/auth"};return d.jsxs(d.Fragment,{children:[i&&d.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>o(!1)}),d.jsx("div",{className:"md:hidden fixed top-4 left-4 z-50",children:d.jsx("button",{onClick:()=>o(!i),className:"p-2 bg-white rounded-lg shadow-lg hover:bg-gray-50 transition-colors",children:d.jsx(Kse,{className:"w-6 h-6 text-gray-700"})})}),d.jsxs("div",{className:Fe("fixed top-0 left-0 h-full w-64 bg-gradient-sidebar z-50 flex flex-col border-r border-sidebar-medium transition-transform duration-300 ease-in-out","md:translate-x-0 md:rounded-none md:shadow-none",i?"translate-x-0":"-translate-x-full"),children:[d.jsx("div",{className:"md:hidden absolute top-4 right-4",children:d.jsx("button",{onClick:()=>o(!1),className:"p-1 bg-white/20 rounded-full hover:bg-white/30 transition-colors",children:d.jsx(us,{className:"w-5 h-5 text-white"})})}),d.jsx("div",{className:"p-6 border-b border-sidebar-medium",children:d.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[h()?d.jsx("img",{src:h(),alt:"User avatar",className:"w-16 h-16 rounded-full object-cover border-2 border-white/20"}):d.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-white text-xl font-semibold",children:u()?l(u()):"U"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-sidebar-text",children:c()}),d.jsx("p",{className:"text-sm text-sidebar-text-muted",children:"View profile"})]})]})}),d.jsx("nav",{className:"px-4 py-6 space-y-1 flex-1",children:RG.filter(m=>m.allowedRoles.includes(p)).map(m=>d.jsxs(AB,{to:m.href,className:({isActive:y})=>Fe("block p-2 rounded",y?"bg-gray-600 text-white":"text-gray-300 hover:bg-gray-700"),onClick:y=>{if(f.pathname===m.href){y.preventDefault();return}o(!1)},children:[d.jsx(m.icon,{className:"inline mr-2"}),m.name]},m.href))}),d.jsx("div",{className:"p-4 border-t border-sidebar-medium space-y-2",children:d.jsxs("button",{onClick:g,className:"w-full flex items-center px-3 py-2.5 text-sm font-medium text-sidebar-text-muted hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-all duration-200",children:[d.jsx(cU,{className:"mr-3 h-5 w-5"}),"Sign Out"]})})]})]})}const x1e=()=>d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"All Applicants"}),d.jsx("p",{className:"text-muted-foreground",children:"Complete view of all applicants across all admission stages"})]}),d.jsx(WH,{})]})})]});function v1e({isOpen:e,onClose:t,onSuccess:n}){const[r,a]=N.useState(),[s,i]=N.useState([{startTime:"",endTime:"",interviewer:""}]),[o,l]=N.useState(!1),{toast:c}=Qt(),u=()=>{i([...s,{startTime:"",endTime:"",interviewer:""}])},h=m=>{if(s.length>1){const y=s.filter((x,v)=>v!==m);i(y)}},p=(m,y,x)=>{const v=[...s];v[m][y]=x,i(v)},f=async m=>{if(m.preventDefault(),!r){c({title:"Error",description:"Please select a date",variant:"destructive"});return}if(s.some(x=>!x.startTime||!x.endTime||!x.interviewer)){c({title:"Error",description:"Please fill in all time slot details",variant:"destructive"});return}try{l(!0);const x=s.map(b=>({date_of_testing:li(r,"yyyy-MM-dd"),lr_status:`Available Slot: ${b.startTime} - ${b.endTime}`,lr_comments:`Interviewer: ${b.interviewer}`,name:"Interview Slot",mobile_no:`slot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,created_at:new Date().toISOString()})),{error:v}=await Et.from("admission_dashboard").insert(x);if(v)throw v;c({title:"Success",description:`${s.length} interview slots added successfully`}),n(),g()}catch(x){console.error("Error adding slots:",x),c({title:"Error",description:"Failed to add interview slots",variant:"destructive"})}finally{l(!1)}},g=()=>{a(void 0),i([{startTime:"",endTime:"",interviewer:""}]),t()};return d.jsx(ta,{open:e,onOpenChange:g,children:d.jsxs(na,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[d.jsx(ka,{children:d.jsxs(ra,{className:"flex items-center gap-2",children:[d.jsx(Eo,{className:"w-5 h-5"}),"Add Interview Slots"]})}),d.jsxs("form",{onSubmit:f,className:"space-y-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(Pe,{children:"Select Date"}),d.jsxs(NI,{children:[d.jsx(kI,{asChild:!0,children:d.jsxs(fe,{variant:"outline",className:Fe("w-full justify-start text-left font-normal",!r&&"text-muted-foreground"),children:[d.jsx(Eo,{className:"mr-2 h-4 w-4"}),r?li(r,"PPP"):d.jsx("span",{children:"Pick a date"})]})}),d.jsx(k1,{className:"w-auto p-0",align:"start",children:d.jsx(N1,{mode:"single",selected:r,onSelect:a,initialFocus:!0,className:Fe("p-3 pointer-events-auto"),disabled:m=>m<new Date})})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(Pe,{children:"Time Slots"}),d.jsxs(fe,{type:"button",variant:"outline",size:"sm",onClick:u,className:"flex items-center gap-2",children:[d.jsx(Qn,{className:"w-4 h-4"}),"Add Slot"]})]}),s.map((m,y)=>d.jsxs("div",{className:"p-4 border border-border rounded-lg space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("span",{className:"text-sm font-medium",children:["Slot ",y+1]}),s.length>1&&d.jsx(fe,{type:"button",variant:"ghost",size:"sm",onClick:()=>h(y),className:"text-destructive hover:text-destructive",children:d.jsx(us,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs(Pe,{htmlFor:`start-${y}`,className:"flex items-center gap-2",children:[d.jsx(To,{className:"w-4 h-4"}),"Start Time"]}),d.jsx(Je,{id:`start-${y}`,type:"time",value:m.startTime,onChange:x=>p(y,"startTime",x.target.value),required:!0})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs(Pe,{htmlFor:`end-${y}`,className:"flex items-center gap-2",children:[d.jsx(To,{className:"w-4 h-4"}),"End Time"]}),d.jsx(Je,{id:`end-${y}`,type:"time",value:m.endTime,onChange:x=>p(y,"endTime",x.target.value),required:!0})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs(Pe,{htmlFor:`interviewer-${y}`,className:"flex items-center gap-2",children:[d.jsx(Ai,{className:"w-4 h-4"}),"Interviewer Name"]}),d.jsx(Je,{id:`interviewer-${y}`,type:"text",placeholder:"Enter interviewer name",value:m.interviewer,onChange:x=>p(y,"interviewer",x.target.value),required:!0})]})]},y))]}),d.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[d.jsx(fe,{type:"button",variant:"outline",onClick:g,disabled:o,children:"Cancel"}),d.jsx(fe,{type:"submit",disabled:o,className:"bg-gradient-primary hover:bg-primary/90 text-white",children:o?"Adding Slots...":`Add ${s.length} Slot${s.length>1?"s":""}`})]})]})]})})}const b1e=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(!1),{toast:i}=Qt(),{user:o}=Gs();N.useEffect(()=>{l()},[]);const l=async()=>{try{if(r(!0),!o){t([]);return}const{data:p,error:f}=await Et.from("admission_dashboard").select("id, name, unique_number, date_of_testing, lr_status, cfr_status, lr_comments").not("date_of_testing","is",null).order("date_of_testing",{ascending:!0});if(f)throw console.error("Supabase error:",f),f;console.log(`Successfully fetched ${(p==null?void 0:p.length)||0} scheduled interviews`),t(p||[])}catch(p){console.error("Error fetching schedule data:",p),i({title:"Error",description:"Failed to load schedule data",variant:"destructive"}),t([])}finally{r(!1)}},c=e.filter(p=>{if(!p.date_of_testing)return!1;const f=new Date(p.date_of_testing),g=new Date;return f.toDateString()===g.toDateString()});e.filter(p=>p.date_of_testing?new Date(p.date_of_testing)>new Date:!1);const u=c.filter(p=>{var f;return p.name==="Interview Slot"&&((f=p.lr_status)==null?void 0:f.includes("Available Slot"))}),h=c.filter(p=>{var f;return p.name!=="Interview Slot"||!((f=p.lr_status)!=null&&f.includes("Available Slot"))});return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Interview Schedule"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage interview slots and availability"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Today's Interviews"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:h.length})]}),d.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:d.jsx(Eo,{className:"w-6 h-6 text-primary"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Available Slots"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:u.length})]}),d.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:d.jsx(To,{className:"w-6 h-6 text-status-pending"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Total Scheduled"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:e.length})]}),d.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:d.jsx(kd,{className:"w-6 h-6 text-status-active"})})]})})]}),d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border",children:[d.jsx("div",{className:"p-6 border-b border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Today's Schedule"}),d.jsxs(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white",onClick:()=>s(!0),children:[d.jsx(Qn,{className:"w-4 h-4 mr-2"}),"Add Slots"]})]})}),d.jsx("div",{className:"p-6",children:n?d.jsx("div",{className:"text-center text-muted-foreground",children:"Loading schedule..."}):d.jsxs("div",{className:"space-y-6",children:[u.length>0&&d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-foreground mb-3",children:"Available Slots"}),d.jsx("div",{className:"space-y-3",children:u.map(p=>{var f;return d.jsx("div",{className:"border border-status-pending/20 bg-status-pending/5 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"w-8 h-8 bg-status-pending/10 rounded-full flex items-center justify-center",children:d.jsx(To,{className:"w-4 h-4 text-status-pending"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-foreground",children:(f=p.lr_status)==null?void 0:f.replace("Available Slot: ","")}),d.jsx("p",{className:"text-sm text-muted-foreground",children:p.lr_comments||"No interviewer assigned"})]})]}),d.jsx("div",{className:"text-right",children:d.jsx("p",{className:"text-sm text-status-pending font-medium",children:"Available"})})]})},p.id)})})]}),h.length>0&&d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-medium text-foreground mb-3",children:"Scheduled Interviews"}),d.jsx("div",{className:"space-y-3",children:h.map(p=>d.jsx("div",{className:"border border-border rounded-lg p-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-primary text-sm font-medium",children:p.name?p.name.split(" ").map(f=>f[0]).join(""):"N/A"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-foreground",children:p.name||"N/A"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:p.unique_number||"No ID"})]})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-sm text-foreground",children:p.date_of_testing?new Date(p.date_of_testing).toLocaleDateString():"No date"}),d.jsx("p",{className:"text-xs text-muted-foreground",children:p.lr_status||p.cfr_status||"Status pending"})]})]})},p.id))})]}),h.length===0&&u.length===0&&d.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[d.jsx(Eo,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),d.jsx("p",{className:"text-lg mb-2",children:"No interviews or slots scheduled for today"}),d.jsx("p",{className:"text-sm",children:'Click "Add Slots" to create available interview slots'})]})]})})]})]})}),d.jsx(v1e,{isOpen:a,onClose:()=>s(!1),onSuccess:l})]})},w1e=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(""),{toast:i}=Qt(),{user:o}=Gs(),l=m=>m.filter(y=>y.stage==="contact"||!y.stage),c=async()=>{try{if(r(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:m,error:y}=await Et.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(y)throw console.error("Supabase error:",y),y;const x=l(m||[]);t(x)}catch(m){console.error("Error fetching applicants:",m),i({title:"Error",description:"Failed to load applicants data",variant:"destructive"}),t([])}finally{r(!1)}};N.useEffect(()=>{c();const m=Et.channel("sourcing_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},y=>{console.log("Real-time update received:",y),c()}).subscribe();return()=>{console.log("Cleaning up sourcing page subscription"),Et.removeChannel(m)}},[]);const u=e.filter(m=>{var y,x,v;return(((y=m.name)==null?void 0:y.toLowerCase().includes(a.toLowerCase()))||m.mobile_no.toLowerCase().includes(a.toLowerCase())||((x=m.city)==null?void 0:x.toLowerCase().includes(a.toLowerCase()))||((v=m.unique_number)==null?void 0:v.toLowerCase().includes(a.toLowerCase())))??!1}),h=u.length,p=u.filter(m=>m.whatsapp_number).length,f=u.filter(m=>!m.date_of_testing).length,g=u.filter(m=>m.final_marks!==null).length;return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Sourcing & Outreach"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage initial contact and outreach activities"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Total Contacts"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:h})]}),d.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:d.jsx(yF,{className:"w-6 h-6 text-primary"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Reached Out"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:p})]}),d.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:d.jsx(O2,{className:"w-6 h-6 text-status-active"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Pending Follow-ups"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:f})]}),d.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:d.jsx(To,{className:"w-6 h-6 text-status-pending"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Converted to Screening"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:g})]}),d.jsx("div",{className:"w-12 h-12 bg-status-prospect/10 rounded-lg flex items-center justify-center",children:d.jsx(XT,{className:"w-6 h-6 text-status-prospect"})})]})})]}),d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[d.jsxs("div",{className:"p-6 border-b border-border",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Contact Pipeline"}),d.jsx(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Add New Contact"})]}),d.jsxs("div",{className:"relative max-w-md",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search by name, phone, or location...",value:a,onChange:m=>s(m.target.value),className:"pl-10 h-9"})]})]}),d.jsx("div",{className:"max-h-96 overflow-y-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-muted/30 sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Contact Info"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Location"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Loading applicants..."})]})})}):u.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx(yF,{className:"w-8 h-8 opacity-50"}),d.jsx("span",{children:a?"No applicants found matching your search":"No applicants in sourcing stage"})]})})}):u.map(m=>d.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-primary text-sm font-medium",children:m.name?m.name.split(" ").map(y=>y[0]).join(""):"?"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-foreground",children:m.name||"No Name"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:m.mobile_no})]})]})}),d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"text-sm text-muted-foreground",children:[d.jsx("p",{children:m.whatsapp_number?`WhatsApp: ${m.whatsapp_number}`:"No WhatsApp"}),d.jsx("p",{children:m.mobile_no?`Mobile: ${m.mobile_no}`:"No Mobile"})]})}),d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(Gse,{className:"w-4 h-4 text-muted-foreground"}),d.jsx("span",{className:"text-sm text-foreground",children:m.city?`${m.city}${m.block?`, ${m.block}`:""}`:"Not specified"})]})}),d.jsx("td",{className:"p-4",children:d.jsx(QH,{status:"pending"})}),d.jsx("td",{className:"p-4",children:d.jsx(fe,{variant:"outline",size:"sm",children:"View Details"})})]},m.id))})]})}),d.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",u.length," of ",e.length," applicants"]})})]})]})})]})},N1e=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(""),{toast:i}=Qt(),{user:o}=Gs(),l=y=>y.filter(x=>x.stage==="screening"),c=async()=>{try{if(r(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:y,error:x}=await Et.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(x)throw console.error("Supabase error:",x),x;const v=l(y||[]);t(v)}catch(y){console.error("Error fetching applicants:",y),i({title:"Error",description:"Failed to load applicants data",variant:"destructive"}),t([])}finally{r(!1)}};N.useEffect(()=>{c();const y=Et.channel("screening_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},x=>{console.log("Real-time update received:",x),c()}).subscribe();return()=>{console.log("Cleaning up screening page subscription"),Et.removeChannel(y)}},[]);const u=e.filter(y=>{var x,v,b;return(((x=y.name)==null?void 0:x.toLowerCase().includes(a.toLowerCase()))||y.mobile_no.toLowerCase().includes(a.toLowerCase())||((v=y.city)==null?void 0:v.toLowerCase().includes(a.toLowerCase()))||((b=y.unique_number)==null?void 0:b.toLowerCase().includes(a.toLowerCase())))??!1}),h=u.length,p=u.filter(y=>{var x;return(x=y.qualifying_school)==null?void 0:x.toLowerCase().includes("programming")}).length,f=u.filter(y=>{var x;return(x=y.qualifying_school)==null?void 0:x.toLowerCase().includes("business")}).length,g=u.length>0?(u.reduce((y,x)=>y+(x.final_marks||0),0)/u.length).toFixed(1):0,m=y=>{var x,v;return y.status==="pass"?(x=y.qualifying_school)!=null&&x.toLowerCase().includes("programming")?"Qualified for SOP":(v=y.qualifying_school)!=null&&v.toLowerCase().includes("business")?"Qualified for SOB":"Pass":y.status||"pending"};return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Screening Tests"}),d.jsx("p",{className:"text-muted-foreground",children:"Monitor online assessment results and qualifications"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Tests Taken"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:h})]}),d.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:d.jsx(O2,{className:"w-6 h-6 text-primary"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Programming Track"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:p})]}),d.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:d.jsx(uie,{className:"w-6 h-6 text-status-active"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Business Track"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:f})]}),d.jsx("div",{className:"w-12 h-12 bg-status-prospect/10 rounded-lg flex items-center justify-center",children:d.jsx(Gae,{className:"w-6 h-6 text-status-prospect"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Average Score"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:g})]}),d.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:d.jsx(XT,{className:"w-6 h-6 text-status-pending"})})]})})]}),d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[d.jsxs("div",{className:"p-6 border-b border-border",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Test Results"}),d.jsx(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Export Results"})]}),d.jsxs("div",{className:"relative max-w-md",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search by name, phone, or location...",value:a,onChange:y=>s(y.target.value),className:"pl-10 h-9"})]})]}),d.jsx("div",{className:"max-h-96 overflow-y-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-muted/30 sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Test Score"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Test Date"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Loading applicants..."})]})})}):u.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx(O2,{className:"w-8 h-8 opacity-50"}),d.jsx("span",{children:a?"No applicants found matching your search":"No applicants in screening stage"})]})})}):u.map(y=>d.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-primary text-sm font-medium",children:y.name?y.name.split(" ").map(x=>x[0]).join(""):"?"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-foreground",children:y.name||"No Name"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:y.mobile_no})]})]})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:`text-lg font-bold ${(y.final_marks||0)>=27?"text-status-active":(y.final_marks||0)>=18?"text-status-prospect":"text-status-fail"}`,children:y.final_marks||0})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-sm text-foreground font-medium",children:m(y)})}),d.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:y.date_of_testing?new Date(y.date_of_testing).toLocaleDateString():"N/A"}),d.jsx("td",{className:"p-4",children:d.jsx(fe,{variant:"outline",size:"sm",children:"View Details"})})]},y.id))})]})}),d.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",u.length," of ",e.length," applicants"]})})]})]})})]})},k1e=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(""),{toast:i}=Qt(),{user:o}=Gs(),l=y=>y.filter(x=>x.stage==="interviews"),c=async()=>{try{if(r(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:y,error:x}=await Et.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(x)throw console.error("Supabase error:",x),x;const v=l(y||[]);t(v)}catch(y){console.error("Error fetching applicants:",y),i({title:"Error",description:"Failed to load applicants data",variant:"destructive"}),t([])}finally{r(!1)}};N.useEffect(()=>{c();const y=Et.channel("interview_rounds_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},x=>{console.log("Real-time update received:",x),c()}).subscribe();return()=>{console.log("Cleaning up interview rounds page subscription"),Et.removeChannel(y)}},[]);const u=e.filter(y=>{var x,v,b;return(((x=y.name)==null?void 0:x.toLowerCase().includes(a.toLowerCase()))||y.mobile_no.toLowerCase().includes(a.toLowerCase())||((v=y.city)==null?void 0:v.toLowerCase().includes(a.toLowerCase()))||((b=y.unique_number)==null?void 0:b.toLowerCase().includes(a.toLowerCase())))??!1}),h=u.filter(y=>{var x;return(x=y.lr_status)==null?void 0:x.toLowerCase().includes("pass")}).length,p=u.filter(y=>{var x;return(x=y.cfr_status)==null?void 0:x.toLowerCase().includes("pass")}).length,f=u.filter(y=>y.lr_status&&!y.cfr_status).length,g=u.filter(y=>{var x,v;return((x=y.lr_status)==null?void 0:x.toLowerCase().includes("fail"))||((v=y.cfr_status)==null?void 0:v.toLowerCase().includes("fail"))}).length,m=y=>{switch(y){case"booked":return"Booked";case"pending":return"Pending";case"rescheduled":return"Rescheduled";case"lr_qualified":return"LR Qualified";case"lr_failed":return"LR Failed";case"cfr_qualified":return"CFR Qualified";case"cfr_failed":return"CFR Failed";default:return"Pending"}};return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Interview Rounds"}),d.jsx("p",{className:"text-muted-foreground",children:"Track Learning Round and Cultural Fit interview progress"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Learning Round Pass"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:h})]}),d.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:d.jsx(dd,{className:"w-6 h-6 text-status-active"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Cultural Fit Pass"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:p})]}),d.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:d.jsx(Ux,{className:"w-6 h-6 text-status-active"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Pending Interviews"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:f})]}),d.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:d.jsx(To,{className:"w-6 h-6 text-status-pending"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Interview Failures"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:g})]}),d.jsx("div",{className:"w-12 h-12 bg-status-fail/10 rounded-lg flex items-center justify-center",children:d.jsx(l1,{className:"w-6 h-6 text-status-fail"})})]})})]}),d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[d.jsxs("div",{className:"p-6 border-b border-border",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Interview Progress"}),d.jsx(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Schedule Next Round"})]}),d.jsxs("div",{className:"relative max-w-md",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search by name, phone, or location...",value:a,onChange:y=>s(y.target.value),className:"pl-10 h-9"})]})]}),d.jsx("div",{className:"max-h-96 overflow-y-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-muted/30 sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Learning Round"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Cultural Fit Round"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Loading applicants..."})]})})}):u.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx(Ux,{className:"w-8 h-8 opacity-50"}),d.jsx("span",{children:a?"No applicants found matching your search":"No applicants in interview rounds"})]})})}):u.map(y=>d.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-primary text-sm font-medium",children:y.name?y.name.split(" ").map(x=>x[0]).join(""):"?"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-foreground",children:y.name||"No Name"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:y.mobile_no})]})]})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-sm text-foreground font-medium",children:m(y.status)})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-sm text-foreground",children:y.lr_status||"Pending"})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-sm text-foreground",children:y.cfr_status||"Pending"})}),d.jsx("td",{className:"p-4",children:d.jsx(fe,{variant:"outline",size:"sm",children:"View Details"})})]},y.id))})]})}),d.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",u.length," of ",e.length," applicants"]})})]})]})})]})},S1e=()=>{const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(""),{toast:i}=Qt(),{user:o}=Gs(),l=p=>p.filter(f=>f.stage==="decision"),c=async()=>{try{if(r(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:p,error:f}=await Et.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(f)throw console.error("Supabase error:",f),f;const g=l(p||[]);t(g)}catch(p){console.error("Error fetching applicants:",p),i({title:"Error",description:"Failed to load applicants data",variant:"destructive"}),t([])}finally{r(!1)}};N.useEffect(()=>{c();const p=Et.channel("final_decisions_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},f=>{console.log("Real-time update received:",f),c()}).subscribe();return()=>{console.log("Cleaning up final decisions page subscription"),Et.removeChannel(p)}},[]);const u=e.filter(p=>{var f,g,m;return(((f=p.name)==null?void 0:f.toLowerCase().includes(a.toLowerCase()))||p.mobile_no.toLowerCase().includes(a.toLowerCase())||((g=p.city)==null?void 0:g.toLowerCase().includes(a.toLowerCase()))||((m=p.unique_number)==null?void 0:m.toLowerCase().includes(a.toLowerCase())))??!1}),h=p=>{switch(p){case"offer_pending":return"Offer Letter Pending";case"offer_sent":return"Offer Letter Sent";case"offer_rejected":return"Offer Rejected";case"offer_accepted":return"Offer Accepted";default:return"Pending"}};return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:d.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Final Decisions"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage offers, acceptances, and onboarding process"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Offers Sent"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:u.filter(p=>p.status==="offer_sent").length})]}),d.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:d.jsx(Bx,{className:"w-6 h-6 text-status-pending"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Offers Accepted"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:u.filter(p=>p.status==="offer_accepted").length})]}),d.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:d.jsx(fx,{className:"w-6 h-6 text-status-active"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Successfully Onboarded"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:u.filter(p=>p.joining_status==="Joined"||p.joining_status==="joined").length})]}),d.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:d.jsx(fx,{className:"w-6 h-6 text-primary"})})]})}),d.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Pending Responses"}),d.jsx("p",{className:"text-2xl font-bold text-foreground",children:u.filter(p=>p.status==="offer_sent"&&(!p.joining_status||p.joining_status==="pending")).length})]}),d.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:d.jsx(To,{className:"w-6 h-6 text-status-pending"})})]})})]}),d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[d.jsxs("div",{className:"p-6 border-b border-border",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Final Decision Pipeline"}),d.jsx(fe,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Send Offer Letters"})]}),d.jsxs("div",{className:"relative max-w-md",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search by name, phone, or location...",value:a,onChange:p=>s(p.target.value),className:"pl-10 h-9"})]})]}),d.jsx("div",{className:"max-h-96 overflow-y-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-muted/30 sticky top-0",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Allotted School"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Joining Status"}),d.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Loading applicants..."})]})})}):u.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx(fx,{className:"w-8 h-8 opacity-50"}),d.jsx("span",{children:a?"No applicants found matching your search":"No applicants in final decisions stage"})]})})}):u.map(p=>d.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[d.jsx("td",{className:"p-4",children:d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-primary text-sm font-medium",children:p.name?p.name.split(" ").map(f=>f[0]).join(""):"?"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-foreground",children:p.name||"No Name"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:p.mobile_no})]})]})}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-sm text-foreground font-medium",children:h(p.status)})}),d.jsx("td",{className:"p-4 text-sm text-foreground",children:p.allotted_school||"Not Assigned"}),d.jsx("td",{className:"p-4",children:d.jsx("span",{className:"text-sm text-foreground",children:p.joining_status||"Pending"})}),d.jsx("td",{className:"p-4",children:d.jsx(fe,{variant:"outline",size:"sm",children:p.status==="offer_sent"&&!p.joining_status?"Send Reminder":"View Details"})})]},p.id))})]})}),d.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:d.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",u.length," of ",e.length," applicants"]})})]})]})})]})};function _1e(){const e=Pr();Qt();const{user:t,isAuthenticated:n,loading:r,renderGoogleSignInButton:a}=Gs(),s=N.useRef(null);return console.log("AUTH.TSX"),N.useEffect(()=>{s.current&&!r&&setTimeout(()=>{a("google-signin-button")},100)},[r]),N.useEffect(()=>{if(n&&!(!t||t.role_id===void 0)&&(t.role_id===1||t.role_id===2)){console.log("FROM AUTH.TSX 17",t.role_id),e("/");return}},[t,n,e]),r?d.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:d.jsx(Ct,{className:"w-full max-w-md",children:d.jsx(It,{className:"flex items-center justify-center p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),d.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})})})}):d.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:d.jsxs(Ct,{className:"w-full max-w-md",children:[d.jsxs(Vt,{className:"space-y-1 text-center",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[d.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:d.jsx(Ai,{className:"w-6 h-6 text-primary-foreground"})}),d.jsx(Yt,{className:"text-2xl font-bold",children:"Admission Dashboard"})]}),d.jsx(vs,{children:"Sign in with your Google account to continue"})]}),d.jsx(It,{children:d.jsx("div",{id:"google-signin-button",ref:s,className:"w-full flex justify-center"})})]})})}function _r({children:e}){const{user:t,isAuthenticated:n,loading:r}=Gs();Pr();const a=ci(),[s,i]=N.useState(null),o=RG.find(c=>c.href===a.pathname),l=o==null?void 0:o.allowedRoles;return N.useEffect(()=>{if(!r){if(!t||!n){i(!1);return}if(l&&!l.includes(t.role_id)){i(!1);return}i(!0)}},[t,n,r,l]),r||s===null?d.jsx("div",{className:"min-h-screen flex items-center justify-center",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s?d.jsx(d.Fragment,{children:e}):d.jsx(sl,{to:"/students",replace:!0})}const C1e=[{key:"overview",label:"Overview"},{key:"student",label:"Student Data"}],eL=10,I1e=()=>{const{id:e}=UT(),[t,n]=N.useState("overview"),[r,a]=N.useState([]),[s,i]=N.useState([]),[o,l]=N.useState(!0),[c,u]=N.useState(null),[h,p]=N.useState("");Pr();const[f,g]=N.useState(1),[m,y]=N.useState(10),[x,v]=N.useState(""),[b,w]=N.useState(!1),[k,I]=N.useState({stage:"all",status:"all",examMode:"all",interviewMode:"all",partner:[],district:[],market:[],dateRange:{type:"application"}});N.useEffect(()=>{fetch("https://dev-join.navgurukul.org/api/campus").then(_=>_.json()).then(_=>{const M=_.data.find(L=>String(L.id)===String(e));p(M?M.campus:"Campus")})},[e]),N.useEffect(()=>{l(!0),u(null),t==="overview"?fetch(`https://dev-join.navgurukul.org/api/school/campus_school/${e}`).then(_=>_.json()).then(_=>{a(_)}).catch(()=>u("Failed to fetch data")).finally(()=>l(!1)):t==="student"&&fetch(`https://dev-join.navgurukul.org/api/campus/${e}/students`).then(_=>_.json()).then(_=>{i(_.data||[])}).catch(()=>u("Failed to fetch student data")).finally(()=>l(!1))},[e,t]);const C=s.slice((f-1)*m,f*m),S=Math.ceil(s.length/m),E=s.length===0?0:(f-1)*m+1,T=Math.min(f*m,s.length),$=C.filter(_=>{var O,F,D;const M=x.toLowerCase(),L=_.name&&_.name.toLowerCase().includes(M)||_.email&&_.email.toLowerCase().includes(M)||((F=(O=_.contacts)==null?void 0:O[0])==null?void 0:F.mobile)&&_.contacts[0].mobile.includes(M);let U=!0;return k.stage!=="all"&&((D=_.stage)==null?void 0:D.stage)!==k.stage&&(U=!1),L&&U});return d.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[d.jsx(ar,{}),d.jsxs("main",{className:"flex-1 p-4 md:p-8 pt-16 md:pt-8 md:ml-64",children:[d.jsxs("h2",{className:"text-3xl font-bold text-center mb-6",children:[h," Campus"]}),d.jsx("div",{className:"flex justify-center mb-6 gap-2",children:C1e.map(_=>d.jsx(fe,{variant:t===_.key?"default":"outline",className:t===_.key?"bg-orange-500 text-white":"",onClick:()=>n(_.key),children:_.label},_.key))}),d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:t==="overview"?"Programs offered":"Student Data"})}),d.jsxs(It,{children:[t==="overview"&&(o?d.jsx("p",{children:"Loading..."}):c?d.jsx("p",{className:"text-red-500",children:c}):d.jsxs(zu,{children:[d.jsx(Bu,{children:d.jsxs(Gr,{children:[d.jsx(Ft,{children:"S.No"}),d.jsx(Ft,{children:"School Name"}),d.jsx(Ft,{children:"Capacity of students"})]})}),d.jsx(Uu,{children:r.map((_,M)=>d.jsxs(Gr,{children:[d.jsx(Nt,{children:M+1}),d.jsx(Nt,{children:_.name}),d.jsx(Nt,{children:_.capacity})]},_.school_id))})]})),t==="student"&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 mb-4",children:[d.jsxs("div",{className:"relative flex-1 max-w-md",children:[d.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),d.jsx(Je,{placeholder:"Search by name, email, or mobile...",value:x,onChange:_=>v(_.target.value),className:"pl-10 h-9"})]}),d.jsxs(fe,{variant:"outline",size:"sm",className:"h-9",onClick:()=>w(!0),children:[d.jsx($m,{className:"w-4 h-4 mr-2"}),"Filter"]})]}),d.jsx(eV,{isOpen:b,onClose:()=>w(!1),onApplyFilters:_=>I(_),currentFilters:k}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map((_,M)=>{var L,U,O,F,D,R;return d.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-lg font-bold text-foreground mb-1",children:_.name||"No Name"}),d.jsx("p",{className:"text-xs text-muted-foreground",children:_.email})]}),d.jsx("button",{onClick:()=>{i(V=>V.map((G,W)=>W===(f-1)*eL+M?{...G,redflag:G.redflag==="flagged"?"":"flagged"}:G))},className:"focus:outline-none",title:_.redflag==="flagged"?"Unflag":"Flag",children:_.redflag==="flagged"?d.jsx("span",{role:"img","aria-label":"Flag",style:{color:"red",fontSize:"1.5em"},children:"🚩"}):d.jsx("span",{role:"img","aria-label":"No Flag",style:{color:"#ccc",fontSize:"1.5em"},children:"⚑"})})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Number:"})," ",((U=(L=_.contacts)==null?void 0:L[0])==null?void 0:U.mobile)||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Alt Number:"})," ",((F=(O=_.contacts)==null?void 0:O[0])==null?void 0:F.alt_mobile)||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Joined:"})," ",_.joinedDate||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Qualification:"})," ",_.qualification||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Partner:"})," ",((D=_.partner)==null?void 0:D.name)||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Job Kab Lagegi:"})," ",_.jobKabLagega||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Days Passed:"})," ",typeof _.daysPassed=="object"&&_.daysPassed!==null?_.daysPassed.daysPassedInCampus??"":""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"kitne Aur Din:"})," ",typeof _.daysPassed=="object"&&_.daysPassed!==null?_.daysPassed.kitneAurDin??"":""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"kitne Din Lagengе:"})," ",typeof _.daysPassed=="object"&&_.daysPassed!==null?_.daysPassed.kitneDinLagenge??"":""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Other Activities:"})," ",_.other_activities||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Evaluation:"})," ",_.evaluation||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Survey Form:"})," ",_.surveyForm||""]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Upload Documents:"})," ",_.studentDocuments?"UPLOAD":""]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-medium text-muted-foreground",children:"Stage:"}),d.jsxs("select",{className:"border rounded px-2 py-1 text-xs",value:((R=_.stage)==null?void 0:R.stage)||"",onChange:V=>{const G=V.target.value;i(W=>W.map((B,Q)=>Q===(f-1)*eL+M?{...B,stage:{...B.stage,stage:G}}:B))},children:[d.jsx("option",{value:"",children:"Select Stage"}),d.jsx("option",{value:"contact",children:"Contact"}),d.jsx("option",{value:"screening",children:"Screening"}),d.jsx("option",{value:"interviews",children:"Interviews"}),d.jsx("option",{value:"decision",children:"Decision"})]})]})]})]},_.id||M)})}),d.jsxs("div",{className:"flex justify-center items-center gap-6 mt-4 flex-wrap",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm",children:"Rows per page:"}),d.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:m,onChange:_=>{y(Number(_.target.value)),g(1)},children:[10,20,50,100].map(_=>d.jsx("option",{value:_,children:_},_))})]}),d.jsxs("span",{className:"text-sm",children:[E,"-",T," of ",s.length]}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{className:"px-2 py-1 rounded border border-gray-200 bg-white text-sm disabled:opacity-50",onClick:()=>g(_=>Math.max(1,_-1)),disabled:f===1,"aria-label":"Previous page",children:"<"}),d.jsx("button",{className:"px-2 py-1 rounded border border-gray-200 bg-white text-sm disabled:opacity-50",onClick:()=>g(_=>Math.min(S,_+1)),disabled:f===S,"aria-label":"Next page",children:">"})]})]})]})]})]})]})]})},tL={stageType:"Test",stageName:""},E1e=()=>{const{id:e}=UT(),[t,n]=N.useState([]),[r,a]=N.useState(""),[s,i]=N.useState(!0),[o,l]=N.useState({open:!1,idx:null,form:tL}),[c,u]=N.useState({open:!1,idx:null}),[h,p]=N.useState([]),[f,g]=N.useState("");N.useEffect(()=>{e&&fetch(`https://dev-join.navgurukul.org/api/stage/${e}`).then(S=>S.json()).then(S=>{n(S),S.length>0&&a(S[0].name||"School"),i(!1)}).catch(()=>i(!1))},[e]);const m=S=>{const E=t[S];l({open:!0,idx:S,form:{stageType:E.stageType||"Test",stageName:E.stageName||""}})},y=()=>l({open:!1,idx:null,form:tL}),x=(S,E)=>{l(T=>({...T,form:{...T.form,[S]:E}}))},v=S=>{S.preventDefault(),y()},b=S=>{var E;u({open:!0,idx:S}),p(t.map((T,$)=>$===S)),g(((E=t[S])==null?void 0:E.stageName)||"")},w=()=>u({open:!1,idx:null}),k=S=>{p(E=>E.map((T,$)=>$===S?!T:T))},I=S=>g(S.target.value),C=S=>{S.preventDefault(),w()};return d.jsxs("div",{className:"min-h-screen bg-background",children:[d.jsx(ar,{}),d.jsxs("main",{className:"md:ml-64 flex flex-col items-center justify-center min-h-screen pt-16 md:pt-0",children:[d.jsx("div",{className:"w-full max-w-4xl p-4 md:p-8",children:d.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-center mb-6",children:r}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b border-border/50",children:[d.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"S.No"}),d.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Type"}),d.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Stage Name"}),d.jsx("th",{className:"text-center py-3 px-4 font-medium text-muted-foreground text-sm",children:"Edit"}),d.jsx("th",{className:"text-center py-3 px-4 font-medium text-muted-foreground text-sm",children:"Manage Transitions"}),d.jsx("th",{className:"text-center py-3 px-4 font-medium text-muted-foreground text-sm",children:"Delete"})]})}),d.jsx("tbody",{children:s?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"py-12 text-center text-muted-foreground",children:d.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[d.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Loading stages..."})]})})}):t.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"py-12 text-center text-muted-foreground",children:"No stages found"})}):t.map((S,E)=>d.jsxs("tr",{className:E%2===1?"bg-muted/30":"",children:[d.jsx("td",{className:"py-3 px-4",children:E+1}),d.jsx("td",{className:"py-3 px-4",children:S.stageType}),d.jsx("td",{className:"py-3 px-4",children:S.stageName}),d.jsx("td",{className:"py-3 px-4 text-center",children:d.jsx("button",{className:"hover:text-orange-600",onClick:()=>m(E),children:d.jsx(Fu,{size:18})})}),d.jsx("td",{className:"py-3 px-4 text-center",children:d.jsx("button",{className:"text-orange-600 hover:underline",onClick:()=>b(E),children:"Manage Transitions"})}),d.jsx("td",{className:"py-3 px-4 text-center",children:d.jsx("button",{className:"hover:text-red-600",children:d.jsx(Na,{size:18})})})]},S.id))})]})}),d.jsxs("div",{className:"flex justify-between items-center mt-4",children:[d.jsx("span",{className:"text-sm text-muted-foreground",children:"Rows per page: 10"}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:["1-",t.length," of ",t.length]})]})]})}),d.jsx(ta,{open:o.open,onOpenChange:S=>!S&&y(),children:d.jsx(na,{children:d.jsxs("form",{onSubmit:v,className:"w-full max-w-md",children:[d.jsx(ka,{children:d.jsx(ra,{className:"text-2xl font-semibold mb-4",children:"Edit Admission Stage"})}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-base font-medium mb-2",children:"Stage Type"}),d.jsxs("div",{className:"flex gap-6 mb-2",children:[d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"radio",name:"stageType",value:"Test",checked:o.form.stageType==="Test",onChange:()=>x("stageType","Test")}),"Test"]}),d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"radio",name:"stageType",value:"Interview",checked:o.form.stageType==="Interview",onChange:()=>x("stageType","Interview")}),"Interview"]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{className:"block text-base font-medium mb-2",children:"Stage Name"}),d.jsx("input",{type:"text",className:"border-2 border-orange-400 rounded px-3 py-2 w-full text-lg",placeholder:"Enter Stage",value:o.form.stageName,onChange:S=>x("stageName",S.target.value),required:!0})]}),d.jsx("button",{type:"submit",className:"w-full bg-orange-500 text-white py-2 rounded font-semibold text-lg shadow mt-2",children:"ADD ADMISSION STAGE"})]})})}),d.jsx(ta,{open:c.open,onOpenChange:S=>!S&&w(),children:d.jsx(na,{children:d.jsxs("form",{onSubmit:C,className:"w-full max-w-lg",children:[d.jsx(ka,{children:d.jsx(ra,{className:"text-2xl font-semibold mb-4",children:"Manage Transitions"})}),d.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"font-semibold mb-2",children:"Available Transitions"}),d.jsx("div",{className:"flex flex-col gap-2",children:t.map((S,E)=>d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",checked:!!h[E],onChange:()=>k(E)}),S.stageName]},S.id))})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"font-semibold mb-2",children:"Preview"}),d.jsx("select",{className:"border rounded px-3 py-2 w-full",value:f,onChange:I,children:t.map((S,E)=>d.jsx("option",{value:S.stageName,children:S.stageName},S.id))})]})]}),d.jsx("button",{type:"submit",className:"mt-6 w-full bg-orange-500 text-white py-2 rounded font-semibold text-lg shadow",children:"SAVE TRANSITION & RETURN"})]})})})]})]})},T1e=[{name:"User Role",href:"/settings/user-role",icon:fx},{name:"Caste",href:"/settings/caste",icon:kd},{name:"Religion",href:"/settings/religion",icon:Xae},{name:"Qualification",href:"/settings/qualification",icon:Sse}];function j1e(){return d.jsx("div",{className:"min-h-screen bg-background",children:d.jsx("main",{className:"md:ml-56  md:px-8 py-3 ",children:d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[d.jsxs("div",{className:"mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),d.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your application settings and configurations"})]}),d.jsx("div",{className:"bg-white rounded-lg shadow",children:d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4",children:[d.jsx("div",{className:"lg:col-span-1 border-r border-gray-200",children:d.jsx("nav",{className:"p-6 space-y-2",children:T1e.map(e=>d.jsxs(AB,{to:e.href,className:({isActive:t})=>Fe("flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",t?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[d.jsx(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name))})}),d.jsx("div",{className:"lg:col-span-3 p-6",children:d.jsx(T2,{})})]})})]})})})}function nL(){const[e,t]=N.useState([]),[n,r]=N.useState(null),[a,s]=N.useState({name:"",description:""}),{toast:i}=Qt();N.useEffect(()=>{(async()=>{try{const p=(await DW()).map(f=>({id:f.id,name:f.name,description:f.description??"",permissions:f.permissions??[]}));t(p),console.log("Fetched roles:",p)}catch(h){console.error("Failed to fetch roles:",h),i({title:"Error",description:"Failed to fetch roles",variant:"destructive"})}})()},[i]);const o=async()=>{if(!a.name.trim())return;if(e.some(h=>h.name.toLowerCase()===a.name.trim().toLowerCase())){i({title:"Duplicate Role",description:`Role "${a.name}" already exists.`,variant:"destructive"});return}try{const h=await Lde({name:a.name.trim()}),p={id:h.id,name:h.name};t(f=>[...f,p]),s({name:"",description:""}),i({title:"Role Added",description:`Role "${h.name}" has been created.`})}catch(h){console.error("Failed to create role:",h),i({title:"Error",description:"Failed to create role",variant:"destructive"})}},l=async u=>{try{await Bde(String(u)),t(h=>h.filter(p=>p.id!==u)),i({title:"Role Deleted",description:"Role has been deleted successfully."})}catch(h){console.error("Failed to delete role:",h),i({title:"Error",description:"Failed to delete role",variant:"destructive"})}},c=async u=>{try{const h=await zde(Number(u.id),{name:u.name,status:!0});t(p=>p.map(f=>f.id===h.id?{...f,...h}:f)),r(null),i({title:"Role Updated",description:`Role "${h.name}" has been updated successfully.`})}catch(h){console.error("Failed to update role:",h),i({title:"Error",description:h.message||"Failed to update role",variant:"destructive"})}};return d.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[d.jsx(ar,{}),d.jsxs("div",{className:"space-y-6",style:{flex:1},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Roles"}),d.jsx("p",{className:"text-gray-600",children:"Manage user roles and their permissions"})]}),d.jsxs(Ct,{children:[d.jsxs(Vt,{children:[d.jsx(Yt,{children:"Add New Role"}),d.jsx(vs,{children:"Create a new user role with specific permissions"})]}),d.jsxs(It,{children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Name"}),d.jsx(Je,{value:a.name,onChange:u=>s({...a,name:u.target.value}),placeholder:"Enter role name"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),d.jsx(Je,{value:a.description,onChange:u=>s({...a,description:u.target.value}),placeholder:"Enter role description"})]})]}),d.jsxs(fe,{onClick:o,className:"mt-4",children:[d.jsx(Qn,{className:"w-4 h-4 mr-2"}),"Add Role"]})]})]}),d.jsxs(Ct,{children:[d.jsxs(Vt,{children:[d.jsx(Yt,{children:"Existing Roles"}),d.jsx(vs,{children:"Manage current user roles"})]}),d.jsx(It,{children:d.jsx("div",{className:"space-y-4",children:e.map(u=>{var h;return d.jsx("div",{className:"p-4 border rounded-lg space-y-2",children:(n==null?void 0:n.id)===u.id?d.jsxs("div",{className:"space-y-2",children:[d.jsx(Je,{value:n.name,onChange:p=>r({...n,name:p.target.value}),placeholder:"Role Name"}),d.jsx(Je,{value:n.description,onChange:p=>r({...n}),placeholder:"Role Description"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs(fe,{size:"sm",onClick:()=>c(n),children:[d.jsx(Rm,{className:"w-4 h-4 mr-2"}),"Save"]}),d.jsxs(fe,{size:"sm",variant:"outline",onClick:()=>r(null),children:[d.jsx(us,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]}):d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-gray-900",children:u.name}),d.jsx("p",{className:"text-sm text-gray-600",children:u.description}),d.jsx("div",{className:"flex gap-2 mt-2",children:(h=u.permissions)==null?void 0:h.map(p=>d.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:p},p))})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>r({...u}),children:d.jsx(oc,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>l(u.id),children:d.jsx(Na,{className:"w-4 h-4"})})]})]})},u.id)})})})]})]})]})}function A1e(){const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(!1),[i,o]=N.useState(null),[l,c]=N.useState({cast_name:""}),[u,h]=N.useState({cast_name:""}),{toast:p}=Qt();N.useEffect(()=>{f()},[]),N.useEffect(()=>{console.log("Castes state updated:",e),console.log("Castes length:",e.length)},[e]);const f=async()=>{try{r(!0);const v=await GN();Array.isArray(v)?t(v):v&&Array.isArray(v.data)?t(v.data):v&&Array.isArray(v.castes)?t(v.castes):(t([]),p({title:"Error",description:"Invalid data format received from server",variant:"destructive"}))}catch(v){t([]),p({title:"Error",description:v instanceof Error?v.message:"Failed to fetch castes",variant:"destructive"})}finally{r(!1)}},g=async()=>{if(!l.cast_name.trim()){p({title:"Error",description:"Cast name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.cast_name.toLowerCase()===l.cast_name.toLowerCase())){p({title:"Error",description:"A cast with this name already exists",variant:"destructive"});return}try{s(!0);const v=await Kde({cast_name:l.cast_name});t(Array.isArray(e)?[...e,v]:[v]),c({cast_name:""}),p({title:"Success",description:"Cast created successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to create cast",variant:"destructive"})}finally{s(!1)}},m=v=>{o(v),h({cast_name:v.cast_name})},y=async()=>{if(!i||!u.cast_name.trim()){p({title:"Error",description:"Cast name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.id!==i.id&&v.cast_name.toLowerCase()===u.cast_name.toLowerCase())){p({title:"Error",description:"A cast with this name already exists",variant:"destructive"});return}try{const v=await Qde(i.id,{cast_name:u.cast_name});t(Array.isArray(e)?e.map(b=>b.id===i.id?v:b):[v]),o(null),h({cast_name:""}),p({title:"Success",description:"Cast updated successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to update cast",variant:"destructive"})}},x=async v=>{if(confirm("Are you sure you want to delete this cast?"))try{await Xde(v),t(Array.isArray(e)?e.filter(b=>b.id!==v):[]),p({title:"Success",description:"Cast deleted successfully"})}catch(b){p({title:"Error",description:b instanceof Error?b.message:"Failed to delete cast",variant:"destructive"})}};return d.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[d.jsx(ar,{}),d.jsxs("div",{className:"space-y-6",style:{flex:1},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Caste Management"}),d.jsx("p",{className:"text-gray-600",children:"Manage caste categories and classifications"})]}),d.jsxs(Ct,{children:[d.jsxs(Vt,{children:[d.jsx(Yt,{children:"Add New Caste"}),d.jsx(vs,{children:"Create a new caste category"})]}),d.jsx(It,{children:d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caste Name"}),d.jsx(Je,{value:l.cast_name,onChange:v=>c({cast_name:v.target.value}),placeholder:"Enter caste name",disabled:a,onKeyDown:v=>{v.key==="Enter"&&l.cast_name.trim()&&!a&&g()}})]}),d.jsx("div",{className:"flex items-end",children:d.jsxs(fe,{onClick:g,disabled:a||!l.cast_name.trim(),children:[a?d.jsx(wo,{className:"w-4 h-4 mr-2 animate-spin"}):d.jsx(Qn,{className:"w-4 h-4 mr-2"}),a?"Creating...":"Add Caste"]})})]})})]}),d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx(Yt,{children:"Existing Castes"}),d.jsx(vs,{children:"Manage current caste categories"})]}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:f,disabled:n,children:[d.jsx(QT,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]})]})}),d.jsx(It,{children:n?d.jsxs("div",{className:"flex items-center justify-center py-8",children:[d.jsx(wo,{className:"w-6 h-6 animate-spin mr-2"}),d.jsx("span",{children:"Loading castes..."})]}):!Array.isArray(e)||e.length===0?d.jsx("div",{className:"text-center py-8 text-gray-500",children:"No castes found. Create your first caste above."}):d.jsx("div",{className:"space-y-4",children:e.map(v=>d.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:(i==null?void 0:i.id)===v.id?d.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[d.jsx("div",{className:"flex-1",children:d.jsx(Je,{value:u.cast_name,onChange:b=>h({cast_name:b.target.value}),placeholder:"Cast name",onKeyDown:b=>{b.key==="Enter"&&u.cast_name.trim()?y():b.key==="Escape"&&(o(null),h({cast_name:""}))}})}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{size:"sm",onClick:y,children:"Save"}),d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>{o(null),h({cast_name:""})},children:"Cancel"})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-gray-900",children:v.cast_name}),d.jsx("div",{className:"flex gap-2 mt-2",children:d.jsx("span",{className:`px-2 py-1 text-xs rounded ${v.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status?"Active":"Inactive"})}),v.created_at&&d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created: ",new Date(v.created_at).toLocaleDateString()]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>m(v),children:d.jsx(oc,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>x(v.id),children:d.jsx(Na,{className:"w-4 h-4"})})]})]})},v.id))})})]})]})]})}function $1e(){const[e,t]=N.useState([]),[n,r]=N.useState(!0),[a,s]=N.useState(!1),[i,o]=N.useState(null),[l,c]=N.useState({religion_name:""}),[u,h]=N.useState({religion_name:""}),{toast:p}=Qt();N.useEffect(()=>{f()},[]),N.useEffect(()=>{console.log("Religions state updated:",e),console.log("Religions length:",e.length)},[e]);const f=async()=>{try{r(!0);const v=await qN();console.log("Fetched religions in component:",v),console.log("Fetched religions type:",typeof v),console.log("Is array?",Array.isArray(v)),Array.isArray(v)?(console.log("Setting religions to array:",v),t(v)):v&&Array.isArray(v.data)?(console.log("Setting religions to fetchedReligions.data:",v.data),t(v.data)):v&&Array.isArray(v.religions)?(console.log("Setting religions to fetchedReligions.religions:",v.religions),t(v.religions)):(console.error("Unexpected API response format:",v),t([]),p({title:"Error",description:"Invalid data format received from server",variant:"destructive"}))}catch(v){console.error("Error fetching religions:",v),t([]),p({title:"Error",description:v instanceof Error?v.message:"Failed to fetch religions",variant:"destructive"})}finally{r(!1)}},g=async()=>{if(!l.religion_name.trim()){p({title:"Error",description:"Religion name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.religion_name.toLowerCase()===l.religion_name.toLowerCase())){p({title:"Error",description:"A religion with this name already exists",variant:"destructive"});return}try{s(!0);const v=await Yde({religion_name:l.religion_name});t(Array.isArray(e)?[...e,v]:[v]),c({religion_name:""}),p({title:"Success",description:"Religion created successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to create religion",variant:"destructive"})}finally{s(!1)}},m=v=>{o(v),h({religion_name:v.religion_name})},y=async()=>{if(!i||!u.religion_name.trim()){p({title:"Error",description:"Religion name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.id!==i.id&&v.religion_name.toLowerCase()===u.religion_name.toLowerCase())){p({title:"Error",description:"A religion with this name already exists",variant:"destructive"});return}try{const v=await Jde(i.id.toString(),{religion_name:u.religion_name});t(Array.isArray(e)?e.map(b=>b.id===i.id?v:b):[v]),o(null),h({religion_name:""}),p({title:"Success",description:"Religion updated successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to update religion",variant:"destructive"})}},x=async v=>{if(confirm("Are you sure you want to delete this religion?"))try{await Zde(v.toString()),t(Array.isArray(e)?e.filter(b=>b.id!==v):[]),p({title:"Success",description:"Religion deleted successfully"})}catch(b){p({title:"Error",description:b instanceof Error?b.message:"Failed to delete religion",variant:"destructive"})}};return d.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[d.jsx(ar,{}),d.jsxs("div",{className:"space-y-6",style:{flex:1},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Religion Management"}),d.jsx("p",{className:"text-gray-600",children:"Manage religious categories and classifications"})]}),d.jsxs(Ct,{children:[d.jsxs(Vt,{children:[d.jsx(Yt,{children:"Add New Religion"}),d.jsx(vs,{children:"Create a new religious category"})]}),d.jsx(It,{children:d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Religion Name"}),d.jsx(Je,{value:l.religion_name,onChange:v=>c({religion_name:v.target.value}),placeholder:"Enter religion name",disabled:a,onKeyDown:v=>{v.key==="Enter"&&l.religion_name.trim()&&!a&&g()}})]}),d.jsx("div",{className:"flex items-end",children:d.jsxs(fe,{onClick:g,disabled:a||!l.religion_name.trim(),children:[a?d.jsx(wo,{className:"w-4 h-4 mr-2 animate-spin"}):d.jsx(Qn,{className:"w-4 h-4 mr-2"}),a?"Creating...":"Add Religion"]})})]})})]}),d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx(Yt,{children:"Existing Religions"}),d.jsx(vs,{children:"Manage current religious categories"})]}),d.jsxs(fe,{variant:"outline",size:"sm",onClick:f,disabled:n,children:[d.jsx(QT,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),"Refresh"]})]})}),d.jsx(It,{children:n?d.jsxs("div",{className:"flex items-center justify-center py-8",children:[d.jsx(wo,{className:"w-6 h-6 animate-spin mr-2"}),d.jsx("span",{children:"Loading religions..."})]}):!Array.isArray(e)||e.length===0?d.jsx("div",{className:"text-center py-8 text-gray-500",children:"No religions found. Create your first religion above."}):d.jsx("div",{className:"space-y-4",children:e.map(v=>d.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:(i==null?void 0:i.id)===v.id?d.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[d.jsx("div",{className:"flex-1",children:d.jsx(Je,{value:u.religion_name,onChange:b=>h({religion_name:b.target.value}),placeholder:"Religion name",onKeyDown:b=>{b.key==="Enter"&&u.religion_name.trim()?y():b.key==="Escape"&&(o(null),h({religion_name:""}))}})}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{size:"sm",onClick:y,children:"Save"}),d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>{o(null),h({religion_name:""})},children:"Cancel"})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-gray-900",children:v.religion_name}),d.jsx("div",{className:"flex gap-2 mt-2",children:d.jsx("span",{className:`px-2 py-1 text-xs rounded ${v.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status?"Active":"Inactive"})}),v.created_at&&d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created: ",new Date(v.created_at).toLocaleDateString()]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>m(v),children:d.jsx(oc,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>x(v.id),children:d.jsx(Na,{className:"w-4 h-4"})})]})]})},v.id))})})]})]})]})}function R1e(){const[e,t]=N.useState([{id:"1",name:"High School",level:"Secondary",description:"10th standard completion",duration:"2 years"},{id:"2",name:"Higher Secondary",level:"Higher Secondary",description:"12th standard completion",duration:"2 years"},{id:"3",name:"Bachelor's Degree",level:"Undergraduate",description:"Bachelor's degree program",duration:"3-4 years"},{id:"4",name:"Master's Degree",level:"Postgraduate",description:"Master's degree program",duration:"2 years"},{id:"5",name:"PhD",level:"Doctorate",description:"Doctoral program",duration:"3-5 years"}]),[n,r]=N.useState({name:"",level:"",description:"",duration:""}),a=()=>{if(n.name.trim()){const o={id:Date.now().toString(),name:n.name,level:n.level,description:n.description,duration:n.duration};t([...e,o]),r({name:"",level:"",description:"",duration:""})}},s=o=>{t(e.filter(l=>l.id!==o))},i=o=>{switch(o){case"Secondary":return"bg-green-100 text-green-800";case"Higher Secondary":return"bg-blue-100 text-blue-800";case"Undergraduate":return"bg-purple-100 text-purple-800";case"Postgraduate":return"bg-orange-100 text-orange-800";case"Doctorate":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return d.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[d.jsx(ar,{}),d.jsxs("div",{className:"space-y-6",style:{flex:1},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Qualification Management"}),d.jsx("p",{className:"text-gray-600",children:"Manage educational qualifications and levels"})]}),d.jsxs(Ct,{children:[d.jsxs(Vt,{children:[d.jsx(Yt,{children:"Add New Qualification"}),d.jsx(vs,{children:"Create a new educational qualification"})]}),d.jsxs(It,{children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Qualification Name"}),d.jsx(Je,{value:n.name,onChange:o=>r({...n,name:o.target.value}),placeholder:"Enter qualification name"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level"}),d.jsx(Je,{value:n.level,onChange:o=>r({...n,level:o.target.value}),placeholder:"Secondary/Higher Secondary/etc"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration"}),d.jsx(Je,{value:n.duration,onChange:o=>r({...n,duration:o.target.value}),placeholder:"e.g., 2 years"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),d.jsx(Je,{value:n.description,onChange:o=>r({...n,description:o.target.value}),placeholder:"Enter description"})]})]}),d.jsxs(fe,{onClick:a,className:"mt-4",children:[d.jsx(Qn,{className:"w-4 h-4 mr-2"}),"Add Qualification"]})]})]}),d.jsxs(Ct,{children:[d.jsxs(Vt,{children:[d.jsx(Yt,{children:"Existing Qualifications"}),d.jsx(vs,{children:"Manage current educational qualifications"})]}),d.jsx(It,{children:d.jsx("div",{className:"space-y-4",children:e.map(o=>d.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold text-gray-900",children:o.name}),d.jsx("p",{className:"text-sm text-gray-600",children:o.description}),d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("span",{className:`px-2 py-1 text-xs rounded ${i(o.level)}`,children:o.level}),d.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-800 rounded",children:o.duration})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(fe,{variant:"outline",size:"sm",children:d.jsx(oc,{className:"w-4 h-4"})}),d.jsx(fe,{variant:"outline",size:"sm",onClick:()=>s(o.id),children:d.jsx(Na,{className:"w-4 h-4"})})]})]},o.id))})})]})]})]})}const D1e=()=>{const e=Pr(),[t,n]=N.useState("English"),r=()=>{localStorage.setItem("selectedLanguage",t),e("/students/instructions")},a=()=>{localStorage.removeItem("googleUser"),localStorage.removeItem("userInfo"),localStorage.removeItem("roleAccess"),localStorage.removeItem("privileges"),e("/auth")};return d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"NavGurukul Entrance Test"}),d.jsx("p",{className:"text-gray-600 mb-8",children:"Select Your Language"}),d.jsxs("div",{className:"mb-8",children:[d.jsx("label",{className:"block text-left text-gray-700 font-medium mb-2",children:"Choose your language"}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{value:t,onChange:s=>n(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[d.jsx("option",{value:"English",children:"English"}),d.jsx("option",{value:"Hindi",children:"हिंदी"}),d.jsx("option",{value:"Marathi",children:"मराठी"}),d.jsx("option",{value:"Gujarati",children:"ગુજરાતી"})]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),d.jsx("button",{onClick:r,className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-lg transition duration-200",children:"LET'S GO AHEAD"}),d.jsxs("div",{className:"flex justify-center space-x-2 mt-8",children:[d.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),d.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),d.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"})]}),d.jsxs("div",{className:"flex justify-between mt-6",children:[d.jsxs("button",{onClick:a,className:"text-gray-600 hover:text-gray-800 flex items-center",children:[d.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"BACK"]}),d.jsxs("button",{onClick:r,className:"text-orange-500 hover:text-orange-600 flex items-center",children:["NEXT",d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})})},Gm=({className:e})=>{const t=Pr(),[n,r]=N.useState(!1),a=()=>{localStorage.removeItem("studentId"),t("/students",{replace:!0})};return d.jsx("div",{className:"fixed top-5 right-5 z-50",children:n?d.jsxs("div",{className:"bg-white shadow-xl rounded-2xl p-4 border border-gray-100 flex flex-col items-center space-y-3 animate-fade-in",children:[d.jsx("p",{className:"text-gray-700 text-sm font-medium",children:"Are you sure you want to log out?"}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:a,className:"bg-green-500 text-white px-4 py-1.5 rounded-full text-sm font-medium hover:bg-green-600 transition-all",children:"Yes, Logout"}),d.jsx("button",{onClick:()=>r(!1),className:"bg-gray-200 text-gray-800 px-4 py-1.5 rounded-full text-sm font-medium hover:bg-gray-300 transition-all",children:"Cancel"})]})]}):d.jsxs("button",{onClick:()=>r(!0),className:`flex items-center gap-2 bg-gradient-to-r ${e||"from-green-500 to-green-500"} text-white px-5 py-2 rounded-full shadow-md hover:opacity-90 hover:scale-105 transition-all duration-200`,children:[d.jsx(cU,{className:"w-5 h-5"}),d.jsx("span",{className:"font-medium",children:"Logout"})]})})},M1e=()=>{const e=Pr(),t=localStorage.getItem("selectedLanguage")||"english",r=(()=>{switch(t){case"hindi":return{title:"NavGurukul Entrance Test",instructionsIntro:"परीक्षा शुरू करने से पहले कृपया निम्नलिखित महत्वपूर्ण निर्देश पढ़ें। परीक्षा देते समय ये निर्देश काम आएंगे",instructions:["पूरी परीक्षा 1 घंटे की होगी। कृपया किसी शांत स्थान पर परीक्षा दें, जहां आप बिना किसी व्यवधान के प्रश्नों का उत्तर दे सकें।","परीक्षा देते समय एक नोटबुक और एक पेन अपने पास रखें। आप किसी भी रफ नोटबुक का उपयोग कर सकते हैं।","परीक्षा देते समय प्रत्येक प्रश्न का उत्तर अपने फोन पर ही दें।","आपको परीक्षा में नकल करने का मौका मिल सकता है, लेकिन हमें विश्वास है कि आप नकल नहीं करेंगे।"],imReady:"मैं तैयार हूँ",back:"वापस",next:"आगे"};case"marathi":return{title:"NavGurukul Entrance Test",instructionsIntro:"परीक्षा सुरू करण्यापूर्वी कृपया खालील महत्वाचे निर्देश वाचा. परीक्षा देताना हे निर्देश उपयोगी पडतील",instructions:["संपूर्ण चाचणी 1 तासाची असेल. कृपया शांत ठिकाणी चाचणी द्या, जिथे तुम्ही कोणत्याही व्यत्ययाशिवाय प्रश्नांची उत्तरे देऊ शकता.","परीक्षा देताना एक वही आणि पेन सोबत ठेवा. तुम्ही कोणतीही रफ नोटबुक वापरू शकता.","परीक्षा देताना प्रत्येक प्रश्नाचे उत्तर तुमच्या फोनवरच द्या.","तुम्हाला परीक्षेत फसवणूक करण्याची संधी मिळू शकते, परंतु आम्हाला विश्वास आहे की तुम्ही असे कोणतेही काम करणार नाही."],imReady:"मी तयार आहे",back:"मागे",next:"पुढे"};default:return{title:"NavGurukul Entrance Test",instructionsIntro:"Please read the following important instructions before starting the test. These instruction will come in handy while giving the test.",instructions:["The complete test will be of 1 hour. Please give the test in a quiet place, where you can answer the questions without any disruptions.","While giving the test, keep a notebook and a pen with you. You can use any rough notebook.","While giving the test, answer each question on your phone itself.","You may get the chance of cheating exam, but we believe that you will not cheat."],imReady:"I'M READY",back:"BACK",next:"NEXT"}}})(),a=()=>{localStorage.setItem("instructionsAccepted","true"),e("/students/details/registration")},s=()=>{e("/students")};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:[d.jsx(Gm,{className:"from-orange-400 to-red-500"}),d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-800 text-center mb-4",children:r.title}),d.jsx("p",{className:"text-gray-600 text-center mb-8",children:r.instructionsIntro}),d.jsx("div",{className:"space-y-4 mb-8",children:r.instructions.map((i,o)=>d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("span",{className:"bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:o+1}),d.jsx("p",{className:"text-gray-700",children:i})]},o))}),d.jsx("div",{className:"text-center",children:d.jsx("button",{onClick:a,className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200",children:r.imReady})}),d.jsxs("div",{className:"flex justify-center space-x-2 mt-8",children:[d.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),d.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"})]}),d.jsxs("div",{className:"flex justify-between mt-6",children:[d.jsxs("button",{onClick:s,className:"text-gray-600 hover:text-gray-800 flex items-center",children:[d.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),r.back]}),d.jsxs("button",{onClick:a,className:"text-orange-500 hover:text-orange-600 flex items-center",children:[r.next,d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})},DG=N.createContext(void 0),gA=()=>{const e=N.useContext(DG);if(!e)throw new Error("useLanguage must be used within a LanguageProvider");return e},O1e=({children:e})=>{const[t,n]=N.useState("english");return d.jsx(DG.Provider,{value:{selectedLanguage:t,setSelectedLanguage:n},children:e})};var F1e=Object.defineProperty,P1e=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),yA=(e,t)=>{for(var n in t)F1e(e,n,{get:t[n],enumerable:!0})},L1e={};yA(L1e,{Abs:()=>Km,Acos:()=>oh,Acosh:()=>lh,AdadeltaOptimizer:()=>F$,AdagradOptimizer:()=>P$,AdamOptimizer:()=>L$,AdamaxOptimizer:()=>z$,Add:()=>mc,AddN:()=>uh,All:()=>Qm,Any:()=>Xm,ArgMax:()=>Ym,ArgMin:()=>Jm,Asin:()=>ch,Asinh:()=>dh,Atan:()=>hh,Atan2:()=>fh,Atanh:()=>ph,AvgPool:()=>mh,AvgPool3D:()=>Zm,AvgPool3DGrad:()=>Qv,AvgPoolGrad:()=>Kv,BackendWasm:()=>WJ,BatchMatMul:()=>gh,BatchToSpaceND:()=>eg,Bincount:()=>tg,BitwiseAnd:()=>ng,BroadcastArgs:()=>Xv,BroadcastTo:()=>QG,Callback:()=>UK,CallbackList:()=>M7,Cast:()=>yh,Ceil:()=>xh,ClipByValue:()=>gc,Complex:()=>Ek,ComplexAbs:()=>Yv,Concat:()=>rg,Conv2D:()=>vh,Conv2DBackpropFilter:()=>Tk,Conv2DBackpropInput:()=>bh,Conv3D:()=>wh,Conv3DBackpropFilterV2:()=>ag,Conv3DBackpropInputV2:()=>sg,Cos:()=>Nh,Cosh:()=>kh,CropAndResize:()=>og,Cumprod:()=>ig,Cumsum:()=>Sh,CustomCallback:()=>F7,DataStorage:()=>_k,DenseBincount:()=>Jv,DepthToSpace:()=>lg,DepthwiseConv2dNative:()=>_h,DepthwiseConv2dNativeBackpropFilter:()=>jk,DepthwiseConv2dNativeBackpropInput:()=>Ak,Diag:()=>Zv,Dilation2D:()=>Ch,Dilation2DBackpropFilter:()=>cm,Dilation2DBackpropInput:()=>um,Draw:()=>$k,ENV:()=>NA,EarlyStopping:()=>WK,Einsum:()=>Rk,Elu:()=>Eh,EluGrad:()=>ug,Environment:()=>qG,Equal:()=>cg,Erf:()=>Th,Exp:()=>jh,ExpandDims:()=>dg,Expm1:()=>Ah,FFT:()=>Dk,Fill:()=>eb,FlipLeftRight:()=>hg,Floor:()=>$h,FloorDiv:()=>Rh,FromPixels:()=>D1,FusedBatchNorm:()=>Dh,FusedConv2D:()=>Rd,FusedDepthwiseConv2D:()=>Dd,GPGPUContext:()=>R0,GatherNd:()=>fg,GatherV2:()=>pg,GraphModel:()=>CD,Greater:()=>mg,GreaterEqual:()=>Mh,History:()=>O7,IFFT:()=>Mk,Identity:()=>Oh,Imag:()=>Ok,InputSpec:()=>dr,IsFinite:()=>Fh,IsInf:()=>Ph,IsNan:()=>Lh,KernelBackend:()=>Gv,LRN:()=>Wh,LRNGrad:()=>Ng,LayerVariable:()=>I7,LayersModel:()=>hl,LeakyRelu:()=>zh,Less:()=>gg,LessEqual:()=>yg,LinSpace:()=>xg,Log:()=>Bh,Log1p:()=>Uh,LogSoftmax:()=>YG,LogicalAnd:()=>vg,LogicalNot:()=>bg,LogicalOr:()=>wg,LogicalXor:()=>XG,LowerBound:()=>jNe,MathBackendCPU:()=>TD,MathBackendWebGL:()=>rM,MatrixBandPart:()=>ANe,Max:()=>Vh,MaxPool:()=>Gh,MaxPool3D:()=>kg,MaxPool3DGrad:()=>nb,MaxPoolGrad:()=>tb,MaxPoolWithArgmax:()=>rb,Maximum:()=>Hh,Mean:()=>qh,Min:()=>Kh,Minimum:()=>Qh,MirrorPad:()=>Xh,Mod:()=>Yh,MomentumOptimizer:()=>B$,Multinomial:()=>Sg,Multiply:()=>Jh,Neg:()=>_g,NonMaxSuppressionV3:()=>Ig,NonMaxSuppressionV4:()=>Eg,NonMaxSuppressionV5:()=>Tg,NotEqual:()=>Cg,OP_SCOPE_SUFFIX:()=>IA,OneHot:()=>Zh,OnesLike:()=>jg,Optimizer:()=>Al,OptimizerConstructors:()=>i7,Pack:()=>Ag,PadV2:()=>ep,Pool:()=>$Ne,Pow:()=>tp,Prelu:()=>np,Prod:()=>rp,RMSPropOptimizer:()=>U$,RNN:()=>$l,RaggedGather:()=>Fk,RaggedRange:()=>Pk,RaggedTensorToTensor:()=>Lk,Range:()=>ab,Rank:()=>LI,Real:()=>zk,RealDiv:()=>Ih,Reciprocal:()=>ap,Reduction:()=>ya,Relu:()=>sp,Relu6:()=>lp,Reshape:()=>$g,ResizeBilinear:()=>op,ResizeBilinearGrad:()=>Dg,ResizeNearestNeighbor:()=>ip,ResizeNearestNeighborGrad:()=>Rg,Reverse:()=>up,RotateWithOffset:()=>Qg,Round:()=>cp,Rsqrt:()=>dp,SGDOptimizer:()=>NS,ScatterNd:()=>Mg,SearchSorted:()=>Fg,Select:()=>Pg,Selu:()=>hp,Sequential:()=>MS,Sigmoid:()=>gp,Sign:()=>mp,Sin:()=>pp,Sinh:()=>fp,Slice:()=>Lg,Softmax:()=>bp,Softplus:()=>yp,SpaceToBatchND:()=>zg,SparseFillEmptyRows:()=>sb,SparseReshape:()=>Ug,SparseSegmentMean:()=>ib,SparseSegmentSum:()=>ob,SparseToDense:()=>Wg,SplitV:()=>Bg,Sqrt:()=>xp,Square:()=>lb,SquaredDifference:()=>wp,StaticRegexReplace:()=>ub,Step:()=>xc,StridedSlice:()=>Vg,StringNGrams:()=>cb,StringSplit:()=>db,StringToHashBucketFast:()=>hb,Sub:()=>Np,Sum:()=>vp,SymbolicTensor:()=>Wi,Tan:()=>kp,Tanh:()=>Sp,Tensor:()=>Dt,TensorBuffer:()=>hr,TensorScatterUpdate:()=>Og,Tile:()=>yc,TopK:()=>Hg,Transform:()=>Gg,Transpose:()=>dl,Unique:()=>pb,Unpack:()=>qg,UnsortedSegmentSum:()=>fb,UpperBound:()=>RNe,Variable:()=>Md,ZerosLike:()=>Kg,_FusedMatMul:()=>$d,abs:()=>ur,acos:()=>$A,acosh:()=>RA,add:()=>me,addN:()=>_8,all:()=>Hk,any:()=>rv,argMax:()=>Ld,argMin:()=>DA,asin:()=>MA,asinh:()=>OA,atan:()=>FA,atan2:()=>PA,atanh:()=>LA,avgPool:()=>El,avgPool3d:()=>BA,backend:()=>EA,backend_util:()=>P,basicLSTMCell:()=>T8,batchNorm:()=>_p,batchNorm2d:()=>UA,batchNorm3d:()=>WA,batchNorm4d:()=>VA,batchToSpaceND:()=>wb,bincount:()=>HA,bitwiseAnd:()=>j8,booleanMaskAsync:()=>vq,broadcastArgs:()=>A8,broadcastTo:()=>fd,broadcast_util:()=>Xg,browser:()=>Db,buffer:()=>jt,callbacks:()=>EOe,cast:()=>Se,ceil:()=>GA,clipByValue:()=>aa,clone:()=>ko,complex:()=>Nl,concat:()=>wn,concat1d:()=>qA,concat2d:()=>KA,concat3d:()=>QA,concat4d:()=>XA,constraints:()=>A7,conv1d:()=>Gk,conv2d:()=>Sa,conv2dTranspose:()=>qk,conv3d:()=>JA,conv3dTranspose:()=>ZA,copyRegisteredKernels:()=>FNe,cos:()=>Nb,cosh:()=>Kk,cosineWindow:()=>yS,cumprod:()=>iv,cumsum:()=>Qk,customGrad:()=>Do,data:()=>p9,denseBincount:()=>F1,deprecationWarn:()=>d8,depthToSpace:()=>e$,depthwiseConv2d:()=>Cp,deregisterOp:()=>AOe,device_util:()=>xb,diag:()=>R8,dilation2d:()=>t$,disableDeprecationWarnings:()=>pke,dispose:()=>mt,disposeVariables:()=>fke,div:()=>ze,divNoNan:()=>n$,dot:()=>r$,dropout:()=>$$,einsum:()=>Vc,elu:()=>Yg,enableDebugMode:()=>hke,enableProdMode:()=>dke,enclosingPowerOfTwo:()=>R$,engine:()=>Ys,ensureShape:()=>M8,env:()=>le,equal:()=>bs,erf:()=>Xk,euclideanNorm:()=>i$,exp:()=>sa,expandDims:()=>$r,expm1:()=>o$,eye:()=>Yk,fft:()=>$b,fill:()=>xs,findBackend:()=>bke,findBackendFactory:()=>wke,floor:()=>Zg,floorDiv:()=>Vk,forceHalfFloat:()=>FX,fused:()=>xm,gather:()=>ey,gatherND:()=>kq,gather_util:()=>H$,getBackend:()=>h8,getGradient:()=>FI,getKernel:()=>ev,getKernelsForBackend:()=>M1,getThreadsCount:()=>Ftt,gpgpu_util:()=>fX,grad:()=>Z_e,grads:()=>eCe,greater:()=>Ta,greaterEqual:()=>Tl,ifft:()=>ym,imag:()=>kb,image:()=>$s,inTopKAsync:()=>Sq,initializers:()=>$7,input:()=>Y7,io:()=>qr,irfft:()=>cS,isFinite:()=>l$,isInf:()=>u$,isNaN:()=>c$,keep:()=>vr,kernel_impls:()=>Bo,layers:()=>R7,leakyRelu:()=>Sb,less:()=>pm,lessEqual:()=>bc,linalg:()=>O$,linspace:()=>z8,loadGraphModel:()=>FFe,loadGraphModelSync:()=>PFe,loadLayersModel:()=>kDe,localResponseNormalization:()=>d$,log:()=>ws,log1p:()=>_b,logSigmoid:()=>h$,logSoftmax:()=>Zk,logSumExp:()=>Cb,logicalAnd:()=>ui,logicalNot:()=>Ib,logicalOr:()=>eS,logicalXor:()=>p$,losses:()=>Oq,lowerBound:()=>U8,matMul:()=>_t,math:()=>qq,max:()=>Ps,maxPool:()=>Ir,maxPool3d:()=>f$,maxPoolWithArgmax:()=>W8,maximum:()=>zo,mean:()=>Wn,memory:()=>GI,meshgrid:()=>V8,metrics:()=>LK,min:()=>hm,minimum:()=>Qu,mirrorPad:()=>m$,mod:()=>g$,model:()=>CDe,models:()=>zK,moments:()=>Eb,movingAverage:()=>bq,mul:()=>Z,multiRNNCell:()=>H8,multinomial:()=>G8,neg:()=>In,nextFrame:()=>G$,norm:()=>Jg,notEqual:()=>Ud,oneHot:()=>fm,ones:()=>Pa,onesLike:()=>Ns,op:()=>J,outerProduct:()=>q8,pad:()=>Ki,pad1d:()=>K8,pad2d:()=>Q8,pad3d:()=>X8,pad4d:()=>Y8,pool:()=>y$,pow:()=>Ro,prelu:()=>jb,print:()=>AA,prod:()=>x$,profile:()=>mke,raggedGather:()=>J8,raggedRange:()=>Z8,raggedTensorToTensor:()=>eq,rand:()=>tq,randomGamma:()=>sq,randomNormal:()=>nS,randomStandardNormal:()=>iq,randomUniform:()=>wc,randomUniformInt:()=>oq,range:()=>Wd,ready:()=>xke,real:()=>mm,reciprocal:()=>k$,registerBackend:()=>Wk,registerCallbackConstructor:()=>EDe,registerGradient:()=>JG,registerKernel:()=>mb,registerOp:()=>jOe,regularizers:()=>BK,relu:()=>hn,relu6:()=>rS,removeBackend:()=>vke,reshape:()=>ee,reverse:()=>Ws,reverse1d:()=>lq,reverse2d:()=>uq,reverse3d:()=>cq,reverse4d:()=>dq,rfft:()=>Rb,round:()=>aS,rsqrt:()=>sS,scalar:()=>Ze,scatterND:()=>wq,scatter_util:()=>pS,searchSorted:()=>tS,selu:()=>iS,separableConv2d:()=>ty,sequential:()=>IDe,serialization:()=>we,setBackend:()=>yke,setPlatform:()=>Nke,setThreadsCount:()=>Ott,setWasmPath:()=>Dtt,setWasmPaths:()=>Mtt,setWebGLContext:()=>PQ,setdiff1dAsync:()=>hq,shared:()=>jD,sigmoid:()=>si,sign:()=>S$,signal:()=>Mq,sin:()=>oS,sinh:()=>lS,slice:()=>Ut,slice1d:()=>Ab,slice2d:()=>uS,slice3d:()=>ny,slice4d:()=>gm,slice_util:()=>wr,softmax:()=>Nc,softplus:()=>Ip,spaceToBatchND:()=>Tb,sparse:()=>Fq,sparseToDense:()=>Nq,spectral:()=>Dq,split:()=>za,sqrt:()=>Or,square:()=>vn,squaredDifference:()=>dS,squeeze:()=>kc,stack:()=>pr,step:()=>Ep,stridedSlice:()=>_$,string:()=>Pq,sub:()=>Oe,sum:()=>Ge,sumOutType:()=>Uk,tan:()=>C$,tanh:()=>Ku,tensor:()=>va,tensor1d:()=>cn,tensor2d:()=>So,tensor3d:()=>hS,tensor4d:()=>Xu,tensor5d:()=>pq,tensor6d:()=>fq,tensorScatterUpdate:()=>gq,tensor_util:()=>Ri,test_util:()=>nq,tidy:()=>te,tile:()=>ds,time:()=>gke,topk:()=>E$,train:()=>zc,transpose:()=>Tt,truncatedNormal:()=>mS,unique:()=>T$,unregisterGradient:()=>ONe,unregisterKernel:()=>MNe,unsortedSegmentSum:()=>gS,unstack:()=>Zn,upcastType:()=>Bs,upperBound:()=>yq,util:()=>j,valueAndGrad:()=>tCe,valueAndGrads:()=>nCe,variable:()=>j$,variableGrads:()=>B8,version:()=>Vtt,version_converter:()=>zFe,version_core:()=>CTe,version_cpu:()=>BLe,version_layers:()=>mR,version_wasm:()=>Ptt,version_webgl:()=>j6e,webgl:()=>A6e,webgl_util:()=>FQ,where:()=>Mr,whereAsync:()=>A$,zeros:()=>Vn,zerosLike:()=>qt});var z1e=Object.create,xA=Object.defineProperty,B1e=Object.getOwnPropertyDescriptor,U1e=Object.getOwnPropertyNames,W1e=Object.getPrototypeOf,V1e=Object.prototype.hasOwnProperty,gr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),gt=(e,t)=>{for(var n in t)xA(e,n,{get:t[n],enumerable:!0})},H1e=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of U1e(t))!V1e.call(e,a)&&a!==n&&xA(e,a,{get:()=>t[a],enumerable:!(r=B1e(t,a))||r.enumerable});return e},fc=(e,t,n)=>(n=e!=null?z1e(W1e(e)):{},H1e(!e||!e.__esModule?xA(n,"default",{value:e,enumerable:!0}):n,e)),G1e=gr((e,t)=>{t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(_,M,L){this.low=_|0,this.high=M|0,this.unsigned=!!L}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function a(_){return(_&&_.__isLong__)===!0}r.isLong=a;var s={},i={};function o(_,M){var L,U,O;return M?(_>>>=0,(O=0<=_&&_<256)&&(U=i[_],U)?U:(L=c(_,(_|0)<0?-1:0,!0),O&&(i[_]=L),L)):(_|=0,(O=-128<=_&&_<128)&&(U=s[_],U)?U:(L=c(_,_<0?-1:0,!1),O&&(s[_]=L),L))}r.fromInt=o;function l(_,M){if(isNaN(_))return M?w:b;if(M){if(_<0)return w;if(_>=y)return E}else{if(_<=-x)return T;if(_+1>=x)return S}return _<0?l(-_,M).neg():c(_%m|0,_/m|0,M)}r.fromNumber=l;function c(_,M,L){return new r(_,M,L)}r.fromBits=c;var u=Math.pow;function h(_,M,L){if(_.length===0)throw Error("empty string");if(_==="NaN"||_==="Infinity"||_==="+Infinity"||_==="-Infinity")return b;if(typeof M=="number"?(L=M,M=!1):M=!!M,L=L||10,L<2||36<L)throw RangeError("radix");var U;if((U=_.indexOf("-"))>0)throw Error("interior hyphen");if(U===0)return h(_.substring(1),M,L).neg();for(var O=l(u(L,8)),F=b,D=0;D<_.length;D+=8){var R=Math.min(8,_.length-D),V=parseInt(_.substring(D,D+R),L);if(R<8){var G=l(u(L,R));F=F.mul(G).add(l(V))}else F=F.mul(O),F=F.add(l(V))}return F.unsigned=M,F}r.fromString=h;function p(_,M){return typeof _=="number"?l(_,M):typeof _=="string"?h(_,M):c(_.low,_.high,typeof M=="boolean"?M:_.unsigned)}r.fromValue=p;var f=65536,g=1<<24,m=f*f,y=m*m,x=y/2,v=o(g),b=o(0);r.ZERO=b;var w=o(0,!0);r.UZERO=w;var k=o(1);r.ONE=k;var I=o(1,!0);r.UONE=I;var C=o(-1);r.NEG_ONE=C;var S=c(-1,2147483647,!1);r.MAX_VALUE=S;var E=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=E;var T=c(0,-2147483648,!1);r.MIN_VALUE=T;var $=r.prototype;$.toInt=function(){return this.unsigned?this.low>>>0:this.low},$.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},$.toString=function(_){if(_=_||10,_<2||36<_)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(T)){var M=l(_),L=this.div(M),U=L.mul(M).sub(this);return L.toString(_)+U.toInt().toString(_)}else return"-"+this.neg().toString(_);for(var O=l(u(_,6),this.unsigned),F=this,D="";;){var R=F.div(O),V=F.sub(R.mul(O)).toInt()>>>0,G=V.toString(_);if(F=R,F.isZero())return G+D;for(;G.length<6;)G="0"+G;D=""+G+D}},$.getHighBits=function(){return this.high},$.getHighBitsUnsigned=function(){return this.high>>>0},$.getLowBits=function(){return this.low},$.getLowBitsUnsigned=function(){return this.low>>>0},$.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var _=this.high!=0?this.high:this.low,M=31;M>0&&!(_&1<<M);M--);return this.high!=0?M+33:M+1},$.isZero=function(){return this.high===0&&this.low===0},$.eqz=$.isZero,$.isNegative=function(){return!this.unsigned&&this.high<0},$.isPositive=function(){return this.unsigned||this.high>=0},$.isOdd=function(){return(this.low&1)===1},$.isEven=function(){return(this.low&1)===0},$.equals=function(_){return a(_)||(_=p(_)),this.unsigned!==_.unsigned&&this.high>>>31===1&&_.high>>>31===1?!1:this.high===_.high&&this.low===_.low},$.eq=$.equals,$.notEquals=function(_){return!this.eq(_)},$.neq=$.notEquals,$.ne=$.notEquals,$.lessThan=function(_){return this.comp(_)<0},$.lt=$.lessThan,$.lessThanOrEqual=function(_){return this.comp(_)<=0},$.lte=$.lessThanOrEqual,$.le=$.lessThanOrEqual,$.greaterThan=function(_){return this.comp(_)>0},$.gt=$.greaterThan,$.greaterThanOrEqual=function(_){return this.comp(_)>=0},$.gte=$.greaterThanOrEqual,$.ge=$.greaterThanOrEqual,$.compare=function(_){if(a(_)||(_=p(_)),this.eq(_))return 0;var M=this.isNegative(),L=_.isNegative();return M&&!L?-1:!M&&L?1:this.unsigned?_.high>>>0>this.high>>>0||_.high===this.high&&_.low>>>0>this.low>>>0?-1:1:this.sub(_).isNegative()?-1:1},$.comp=$.compare,$.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(k)},$.neg=$.negate,$.add=function(_){a(_)||(_=p(_));var M=this.high>>>16,L=this.high&65535,U=this.low>>>16,O=this.low&65535,F=_.high>>>16,D=_.high&65535,R=_.low>>>16,V=_.low&65535,G=0,W=0,B=0,Q=0;return Q+=O+V,B+=Q>>>16,Q&=65535,B+=U+R,W+=B>>>16,B&=65535,W+=L+D,G+=W>>>16,W&=65535,G+=M+F,G&=65535,c(B<<16|Q,G<<16|W,this.unsigned)},$.subtract=function(_){return a(_)||(_=p(_)),this.add(_.neg())},$.sub=$.subtract,$.multiply=function(_){if(this.isZero())return b;if(a(_)||(_=p(_)),n){var M=n.mul(this.low,this.high,_.low,_.high);return c(M,n.get_high(),this.unsigned)}if(_.isZero())return b;if(this.eq(T))return _.isOdd()?T:b;if(_.eq(T))return this.isOdd()?T:b;if(this.isNegative())return _.isNegative()?this.neg().mul(_.neg()):this.neg().mul(_).neg();if(_.isNegative())return this.mul(_.neg()).neg();if(this.lt(v)&&_.lt(v))return l(this.toNumber()*_.toNumber(),this.unsigned);var L=this.high>>>16,U=this.high&65535,O=this.low>>>16,F=this.low&65535,D=_.high>>>16,R=_.high&65535,V=_.low>>>16,G=_.low&65535,W=0,B=0,Q=0,X=0;return X+=F*G,Q+=X>>>16,X&=65535,Q+=O*G,B+=Q>>>16,Q&=65535,Q+=F*V,B+=Q>>>16,Q&=65535,B+=U*G,W+=B>>>16,B&=65535,B+=O*V,W+=B>>>16,B&=65535,B+=F*R,W+=B>>>16,B&=65535,W+=L*G+U*V+O*R+F*D,W&=65535,c(Q<<16|X,W<<16|B,this.unsigned)},$.mul=$.multiply,$.divide=function(_){if(a(_)||(_=p(_)),_.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&_.low===-1&&_.high===-1)return this;var M=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,_.low,_.high);return c(M,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?w:b;var L,U,O;if(this.unsigned){if(_.unsigned||(_=_.toUnsigned()),_.gt(this))return w;if(_.gt(this.shru(1)))return I;O=w}else{if(this.eq(T)){if(_.eq(k)||_.eq(C))return T;if(_.eq(T))return k;var F=this.shr(1);return L=F.div(_).shl(1),L.eq(b)?_.isNegative()?k:C:(U=this.sub(_.mul(L)),O=L.add(U.div(_)),O)}else if(_.eq(T))return this.unsigned?w:b;if(this.isNegative())return _.isNegative()?this.neg().div(_.neg()):this.neg().div(_).neg();if(_.isNegative())return this.div(_.neg()).neg();O=b}for(U=this;U.gte(_);){L=Math.max(1,Math.floor(U.toNumber()/_.toNumber()));for(var D=Math.ceil(Math.log(L)/Math.LN2),R=D<=48?1:u(2,D-48),V=l(L),G=V.mul(_);G.isNegative()||G.gt(U);)L-=R,V=l(L,this.unsigned),G=V.mul(_);V.isZero()&&(V=k),O=O.add(V),U=U.sub(G)}return O},$.div=$.divide,$.modulo=function(_){if(a(_)||(_=p(_)),n){var M=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,_.low,_.high);return c(M,n.get_high(),this.unsigned)}return this.sub(this.div(_).mul(_))},$.mod=$.modulo,$.rem=$.modulo,$.not=function(){return c(~this.low,~this.high,this.unsigned)},$.and=function(_){return a(_)||(_=p(_)),c(this.low&_.low,this.high&_.high,this.unsigned)},$.or=function(_){return a(_)||(_=p(_)),c(this.low|_.low,this.high|_.high,this.unsigned)},$.xor=function(_){return a(_)||(_=p(_)),c(this.low^_.low,this.high^_.high,this.unsigned)},$.shiftLeft=function(_){return a(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?c(this.low<<_,this.high<<_|this.low>>>32-_,this.unsigned):c(0,this.low<<_-32,this.unsigned)},$.shl=$.shiftLeft,$.shiftRight=function(_){return a(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?c(this.low>>>_|this.high<<32-_,this.high>>_,this.unsigned):c(this.high>>_-32,this.high>=0?0:-1,this.unsigned)},$.shr=$.shiftRight,$.shiftRightUnsigned=function(_){if(a(_)&&(_=_.toInt()),_&=63,_===0)return this;var M=this.high;if(_<32){var L=this.low;return c(L>>>_|M<<32-_,M>>>_,this.unsigned)}else return _===32?c(M,0,this.unsigned):c(M>>>_-32,0,this.unsigned)},$.shru=$.shiftRightUnsigned,$.shr_u=$.shiftRightUnsigned,$.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},$.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},$.toBytes=function(_){return _?this.toBytesLE():this.toBytesBE()},$.toBytesLE=function(){var _=this.high,M=this.low;return[M&255,M>>>8&255,M>>>16&255,M>>>24,_&255,_>>>8&255,_>>>16&255,_>>>24]},$.toBytesBE=function(){var _=this.high,M=this.low;return[_>>>24,_>>>16&255,_>>>8&255,_&255,M>>>24,M>>>16&255,M>>>8&255,M&255]},r.fromBytes=function(_,M,L){return L?r.fromBytesLE(_,M):r.fromBytesBE(_,M)},r.fromBytesLE=function(_,M){return new r(_[0]|_[1]<<8|_[2]<<16|_[3]<<24,_[4]|_[5]<<8|_[6]<<16|_[7]<<24,M)},r.fromBytesBE=function(_,M){return new r(_[4]<<24|_[5]<<16|_[6]<<8|_[7],_[0]<<24|_[1]<<16|_[2]<<8|_[3],M)}}),q1e=gr(()=>{}),K1e=gr(()=>{}),Q1e=gr((e,t)=>{(function(n,r,a){function s(c){var u=this,h=l();u.next=function(){var p=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=p-(u.c=p|0)},u.c=1,u.s0=h(" "),u.s1=h(" "),u.s2=h(" "),u.s0-=h(c),u.s0<0&&(u.s0+=1),u.s1-=h(c),u.s1<0&&(u.s1+=1),u.s2-=h(c),u.s2<0&&(u.s2+=1),h=null}function i(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function o(c,u){var h=new s(c),p=u&&u.state,f=h.next;return f.int32=function(){return h.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&i(p,h),f.state=function(){return i(h,{})}),f}function l(){var c=4022871197,u=function(h){h=String(h);for(var p=0;p<h.length;p++){c+=h.charCodeAt(p);var f=.02519603282416938*c;c=f>>>0,f-=c,f*=c,c=f>>>0,f-=c,c+=f*4294967296}return(c>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.alea=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),X1e=gr((e,t)=>{(function(n,r,a){function s(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var p=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^p^p>>>8},l===(l|0)?c.x=l:u+=l;for(var h=0;h<u.length+64;h++)c.x^=u.charCodeAt(h)|0,c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function o(l,c){var u=new s(l),h=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,h&&(typeof h=="object"&&i(h,u),p.state=function(){return i(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xor128=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),Y1e=gr((e,t)=>{(function(n,r,a){function s(l){var c=this,u="";c.next=function(){var p=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(p^p<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(l|0)?c.x=l:u+=l;for(var h=0;h<u.length+64;h++)c.x^=u.charCodeAt(h)|0,h==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function o(l,c){var u=new s(l),h=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,h&&(typeof h=="object"&&i(h,u),p.state=function(){return i(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xorwow=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),J1e=gr((e,t)=>{(function(n,r,a){function s(l){var c=this;c.next=function(){var h=c.x,p=c.i,f,g;return f=h[p],f^=f>>>7,g=f^f<<24,f=h[p+1&7],g^=f^f>>>10,f=h[p+3&7],g^=f^f>>>3,f=h[p+4&7],g^=f^f<<7,f=h[p+7&7],f=f^f<<13,g^=f^f<<9,h[p]=g,c.i=p+1&7,g};function u(h,p){var f,g=[];if(p===(p|0))g[0]=p;else for(p=""+p,f=0;f<p.length;++f)g[f&7]=g[f&7]<<15^p.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],h.x=g,h.i=0,f=256;f>0;--f)h.next()}u(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function o(l,c){l==null&&(l=+new Date);var u=new s(l),h=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,h&&(h.x&&i(h,u),p.state=function(){return i(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xorshift7=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),Z1e=gr((e,t)=>{(function(n,r,a){function s(l){var c=this;c.next=function(){var h=c.w,p=c.X,f=c.i,g,m;return c.w=h=h+1640531527|0,m=p[f+34&127],g=p[f=f+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,m=p[f]=m^g,c.i=f,m+(h^h>>>16)|0};function u(h,p){var f,g,m,y,x,v=[],b=128;for(p===(p|0)?(g=p,p=null):(p=p+"\0",g=0,b=Math.max(b,p.length)),m=0,y=-32;y<b;++y)p&&(g^=p.charCodeAt((y+32)%p.length)),y===0&&(x=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,y>=0&&(x=x+1640531527|0,f=v[y&127]^=g+x,m=f==0?m+1:0);for(m>=128&&(v[(p&&p.length||0)&127]=-1),m=127,y=4*128;y>0;--y)g=v[m+34&127],f=v[m=m+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,v[m]=g^f;h.w=x,h.X=v,h.i=m}u(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function o(l,c){l==null&&(l=+new Date);var u=new s(l),h=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,h&&(h.X&&i(h,u),p.state=function(){return i(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xor4096=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),eNe=gr((e,t)=>{(function(n,r,a){function s(l){var c=this,u="";c.next=function(){var p=c.b,f=c.c,g=c.d,m=c.a;return p=p<<25^p>>>7^f,f=f-g|0,g=g<<24^g>>>8^m,m=m-p|0,c.b=p=p<<20^p>>>12^f,c.c=f=f-g|0,c.d=g<<16^f>>>16^m,c.a=m-p|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=l|0):u+=l;for(var h=0;h<u.length+20;h++)c.b^=u.charCodeAt(h)|0,c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function o(l,c){var u=new s(l),h=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,h&&(typeof h=="object"&&i(h,u),p.state=function(){return i(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.tychei=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),tNe=gr(()=>{}),nNe=gr((e,t)=>{(function(n,r,a){var s=256,i=6,o=52,l="random",c=a.pow(s,i),u=a.pow(2,o),h=u*2,p=s-1,f;function g(k,I,C){var S=[];I=I==!0?{entropy:!0}:I||{};var E=v(x(I.entropy?[k,w(r)]:k??b(),3),S),T=new m(S),$=function(){for(var _=T.g(i),M=c,L=0;_<u;)_=(_+L)*s,M*=s,L=T.g(1);for(;_>=h;)_/=2,M/=2,L>>>=1;return(_+L)/M};return $.int32=function(){return T.g(4)|0},$.quick=function(){return T.g(4)/4294967296},$.double=$,v(w(T.S),r),(I.pass||C||function(_,M,L,U){return U&&(U.S&&y(U,T),_.state=function(){return y(T,{})}),L?(a[l]=_,M):_})($,E,"global"in I?I.global:this==a,I.state)}function m(k){var I,C=k.length,S=this,E=0,T=S.i=S.j=0,$=S.S=[];for(C||(k=[C++]);E<s;)$[E]=E++;for(E=0;E<s;E++)$[E]=$[T=p&T+k[E%C]+(I=$[E])],$[T]=I;(S.g=function(_){for(var M,L=0,U=S.i,O=S.j,F=S.S;_--;)M=F[U=p&U+1],L=L*s+F[p&(F[U]=F[O=p&O+M])+(F[O]=M)];return S.i=U,S.j=O,L})(s)}function y(k,I){return I.i=k.i,I.j=k.j,I.S=k.S.slice(),I}function x(k,I){var C=[],S=typeof k,E;if(I&&S=="object")for(E in k)try{C.push(x(k[E],I-1))}catch{}return C.length?C:S=="string"?k:k+"\0"}function v(k,I){for(var C=k+"",S,E=0;E<C.length;)I[p&E]=p&(S^=I[p&E]*19)+C.charCodeAt(E++);return w(I)}function b(){try{var k;return f&&(k=f.randomBytes)?k=k(s):(k=new Uint8Array(s),(n.crypto||n.msCrypto).getRandomValues(k)),w(k)}catch{var I=n.navigator,C=I&&I.plugins;return[+new Date,n,C,n.screen,w(r)]}}function w(k){return String.fromCharCode.apply(0,k)}if(v(a.random(),r),typeof t=="object"&&t.exports){t.exports=g;try{f=tNe()}catch{}}else typeof define=="function"&&define.amd?define(function(){return g}):a["seed"+l]=g})(typeof self<"u"?self:e,[],Math)}),Sk=gr((e,t)=>{var n=Q1e(),r=X1e(),a=Y1e(),s=J1e(),i=Z1e(),o=eNe(),l=nNe();l.alea=n,l.xor128=r,l.xorwow=a,l.xorshift7=s,l.xor4096=i,l.tychei=o,t.exports=l}),MG=gr(()=>{}),vA=gr(()=>{}),OG=gr(()=>{}),rNe=gr(()=>{}),aNe=gr(()=>{}),sNe=gr(()=>{}),iNe=gr((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};function s(){return D.buffer!=oe&&se(D.buffer),q}function i(){return D.buffer!=oe&&se(D.buffer),de}function o(){return D.buffer!=oe&&se(D.buffer),ye}function l(){return D.buffer!=oe&&se(D.buffer),be}function c(){return D.buffer!=oe&&se(D.buffer),Ce}var u=typeof a<"u"?a:{},h,p;u.ready=new Promise(function(K,ce){h=K,p=ce});var f;typeof process<"u"&&process.listeners&&(f={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var g=Object.assign({},u),m=(K,ce)=>{throw ce},y=typeof window=="object",x=typeof importScripts=="function",v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",b=u.ENVIRONMENT_IS_PTHREAD||!1,w="";function k(K){return u.locateFile?u.locateFile(K,w):w+K}var I,C,S;function E(K){K instanceof gn||U("exiting due to exception: "+K)}if(v){var T=vA(),$=OG();x?w=$.dirname(w)+"/":w=__dirname+"/",I=(ce,je)=>(ce=tn(ce)?new URL(ce):$.normalize(ce),T.readFileSync(ce,je?void 0:"utf8")),S=ce=>{var je=I(ce,!0);return je.buffer||(je=new Uint8Array(je)),je},C=(ce,je,ot)=>{ce=tn(ce)?new URL(ce):$.normalize(ce),T.readFile(ce,function(wt,St){wt?ot(wt):je(St.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(ce){if(!(ce instanceof gn))throw ce}),process.on("unhandledRejection",function(ce){throw ce}),m=(ce,je)=>{if(Ue())throw process.exitCode=ce,je;E(je),process.exit(ce)},u.inspect=function(){return"[Emscripten Module object]"};let K;try{K=rNe()}catch(ce){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),ce}global.Worker=K.Worker}else(y||x)&&(x?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),typeof r<"u"&&r&&(w=r),w.indexOf("blob:")!==0?w=w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):w="",v||(I=K=>{var ce=new XMLHttpRequest;return ce.open("GET",K,!1),ce.send(null),ce.responseText},x&&(S=K=>{var ce=new XMLHttpRequest;return ce.open("GET",K,!1),ce.responseType="arraybuffer",ce.send(null),new Uint8Array(ce.response)}),C=(K,ce,je)=>{var ot=new XMLHttpRequest;ot.open("GET",K,!0),ot.responseType="arraybuffer",ot.onload=()=>{if(ot.status==200||ot.status==0&&ot.response){ce(ot.response);return}je()},ot.onerror=je,ot.send(null)}));v&&typeof performance>"u"&&(global.performance=aNe().performance);var _=console.log.bind(console),M=console.warn.bind(console);v&&(_=K=>T.writeSync(1,K+`
`),M=K=>T.writeSync(2,K+`
`));var L=u.print||_,U=u.printErr||M;Object.assign(u,g),g=null,u.arguments&&u.arguments,u.thisProgram&&u.thisProgram,u.quit&&(m=u.quit);var O;u.wasmBinary&&(O=u.wasmBinary);var F=u.noExitRuntime||!0;typeof WebAssembly!="object"&&$n("no native wasm support detected");var D,R,V=!1,G;function W(K,ce){K||$n(ce)}var B=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Q(K,ce,je){ce>>>=0;for(var ot=ce+je,wt=ce;K[wt]&&!(wt>=ot);)++wt;if(wt-ce>16&&K.buffer&&B)return B.decode(K.buffer instanceof SharedArrayBuffer?K.slice(ce,wt):K.subarray(ce,wt));for(var St="";ce<wt;){var Be=K[ce++];if(!(Be&128)){St+=String.fromCharCode(Be);continue}var et=K[ce++]&63;if((Be&224)==192){St+=String.fromCharCode((Be&31)<<6|et);continue}var zn=K[ce++]&63;if((Be&240)==224?Be=(Be&15)<<12|et<<6|zn:Be=(Be&7)<<18|et<<12|zn<<6|K[ce++]&63,Be<65536)St+=String.fromCharCode(Be);else{var Cs=Be-65536;St+=String.fromCharCode(55296|Cs>>10,56320|Cs&1023)}}return St}function X(K,ce){return K>>>=0,K?Q(i(),K,ce):""}function pe(K,ce,je,ot){if(je>>>=0,!(ot>0))return 0;for(var wt=je,St=je+ot-1,Be=0;Be<K.length;++Be){var et=K.charCodeAt(Be);if(et>=55296&&et<=57343){var zn=K.charCodeAt(++Be);et=65536+((et&1023)<<10)|zn&1023}if(et<=127){if(je>=St)break;ce[je++>>>0]=et}else if(et<=2047){if(je+1>=St)break;ce[je++>>>0]=192|et>>6,ce[je++>>>0]=128|et&63}else if(et<=65535){if(je+2>=St)break;ce[je++>>>0]=224|et>>12,ce[je++>>>0]=128|et>>6&63,ce[je++>>>0]=128|et&63}else{if(je+3>=St)break;ce[je++>>>0]=240|et>>18,ce[je++>>>0]=128|et>>12&63,ce[je++>>>0]=128|et>>6&63,ce[je++>>>0]=128|et&63}}return ce[je>>>0]=0,je-wt}function ie(K,ce,je){return pe(K,i(),ce,je)}var oe,q,de,ye,be,Ce;b&&(oe=u.buffer);function se(K){oe=K,u.HEAP8=q=new Int8Array(K),u.HEAP16=new Int16Array(K),u.HEAP32=ye=new Int32Array(K),u.HEAPU8=de=new Uint8Array(K),u.HEAPU16=new Uint16Array(K),u.HEAPU32=be=new Uint32Array(K),u.HEAPF32=new Float32Array(K),u.HEAPF64=Ce=new Float64Array(K)}var ae=u.INITIAL_MEMORY||16777216;if(b)D=u.wasmMemory,oe=u.buffer;else if(u.wasmMemory)D=u.wasmMemory;else if(D=new WebAssembly.Memory({initial:ae/65536,maximum:65536,shared:!0}),!(D.buffer instanceof SharedArrayBuffer))throw U("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&U("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");D&&(oe=D.buffer),ae=oe.byteLength,se(oe);var ue,ke=[],_e=[],qe=[];function Ue(){return F}function it(){if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)Bt(u.preRun.shift());Xt(ke)}function yt(){!b&&Xt(_e)}function At(){if(!b){if(u.postRun)for(typeof u.postRun=="function"&&(u.postRun=[u.postRun]);u.postRun.length;)nt(u.postRun.shift());Xt(qe)}}function Bt(K){ke.unshift(K)}function an(K){_e.unshift(K)}function nt(K){qe.unshift(K)}var ht=0,un=null;function er(K){ht++,u.monitorRunDependencies&&u.monitorRunDependencies(ht)}function xe(K){if(ht--,u.monitorRunDependencies&&u.monitorRunDependencies(ht),ht==0&&un){var ce=un;un=null,ce()}}function $n(K){u.onAbort&&u.onAbort(K),K="Aborted("+K+")",U(K),V=!0,G=1,K+=". Build with -sASSERTIONS for more info.";var ce=new WebAssembly.RuntimeError(K);throw p(ce),ce}var Pn="data:application/octet-stream;base64,";function sn(K){return K.startsWith(Pn)}function tn(K){return K.startsWith("file://")}var Ln;Ln="tfjs-backend-wasm-threaded-simd.wasm",sn(Ln)||(Ln=k(Ln));function Qa(K){try{if(K==Ln&&O)return new Uint8Array(O);if(S)return S(K);throw"both async and sync fetching of the wasm failed"}catch(ce){$n(ce)}}function De(){if(!O&&(y||x)){if(typeof fetch=="function"&&!tn(Ln))return fetch(Ln,{credentials:"same-origin"}).then(function(K){if(!K.ok)throw"failed to load wasm binary file at '"+Ln+"'";return K.arrayBuffer()}).catch(function(){return Qa(Ln)});if(C)return new Promise(function(K,ce){C(Ln,function(je){K(new Uint8Array(je))},ce)})}return Promise.resolve().then(function(){return Qa(Ln)})}function Le(){var K={env:MM,wasi_snapshot_preview1:MM};function ce(Be,et){var zn=Be.exports;if(u.asm=zn,Wo(u.asm._emscripten_tls_init),ue=u.asm.__indirect_function_table,an(u.asm.__wasm_call_ctors),R=et,!b){var Cs=Ae.unusedWorkers.length;Ae.unusedWorkers.forEach(function(Vo){Ae.loadWasmModuleToWorker(Vo,function(){--Cs||xe()})})}}b||er();function je(Be){ce(Be.instance,Be.module)}function ot(Be){return De().then(function(et){return WebAssembly.instantiate(et,K)}).then(function(et){return et}).then(Be,function(et){U("failed to asynchronously prepare wasm: "+et),$n(et)})}function wt(){return!O&&typeof WebAssembly.instantiateStreaming=="function"&&!sn(Ln)&&!tn(Ln)&&!v&&typeof fetch=="function"?fetch(Ln,{credentials:"same-origin"}).then(function(Be){var et=WebAssembly.instantiateStreaming(Be,K);return et.then(je,function(zn){return U("wasm streaming compile failed: "+zn),U("falling back to ArrayBuffer instantiation"),ot(je)})}):ot(je)}if(u.instantiateWasm)try{var St=u.instantiateWasm(K,ce);return St}catch(Be){U("Module.instantiateWasm callback failed with error: "+Be),p(Be)}return wt().catch(p),{}}var Mt={};function gn(K){this.name="ExitStatus",this.message="Program terminated with exit("+K+")",this.status=K}function or(K){var ce=Ae.pthreads[K];delete Ae.pthreads[K],ce.terminate(),r_(K),Ae.runningWorkers.splice(Ae.runningWorkers.indexOf(ce),1),ce.pthread_ptr=0}function Xi(K){var ce=Ae.pthreads[K];ce.postMessage({cmd:"cancel"})}function Br(K){var ce=Ae.pthreads[K];W(ce),Ae.returnWorkerToPool(ce)}function _n(K){var ce=Ae.getNewWorker();if(!ce)return 6;Ae.runningWorkers.push(ce),Ae.pthreads[K.pthread_ptr]=ce,ce.pthread_ptr=K.pthread_ptr;var je={cmd:"run",start_routine:K.startRoutine,arg:K.arg,pthread_ptr:K.pthread_ptr};return ce.runPthread=()=>{v&&ce.ref(),ce.postMessage(je,K.transferList),delete ce.runPthread},ce.loaded&&ce.runPthread(),0}function ct(K){if(b)return Fp(1,1,K);G=K,Ue()||(Ae.terminateAllThreads(),u.onExit&&u.onExit(K),V=!0),m(K,new gn(K))}function he(K,ce){if(G=K,!ce&&b)throw at(K),"unwind";ct(K)}var Ne=he;function He(K){if(K instanceof gn||K=="unwind")return G;m(1,K)}var Ae={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){b?Ae.initWorker():Ae.initMainThread()},initMainThread:function(){for(var K=8;K--;)Ae.allocateUnusedWorker()},initWorker:function(){F=!1},setExitStatus:function(K){G=K},terminateAllThreads:function(){for(var K of Object.values(Ae.pthreads))Ae.returnWorkerToPool(K);for(var K of Ae.unusedWorkers)K.terminate();Ae.unusedWorkers=[]},returnWorkerToPool:function(K){var ce=K.pthread_ptr;delete Ae.pthreads[ce],Ae.unusedWorkers.push(K),Ae.runningWorkers.splice(Ae.runningWorkers.indexOf(K),1),K.pthread_ptr=0,v&&K.unref(),r_(ce)},receiveObjectTransfer:function(K){},threadInitTLS:function(){Ae.tlsInitFunctions.forEach(K=>K())},loadWasmModuleToWorker:function(K,ce){K.onmessage=St=>{var Be=St.data,et=Be.cmd;if(K.pthread_ptr&&(Ae.currentProxiedOperationCallerThread=K.pthread_ptr),Be.targetThread&&Be.targetThread!=ew()){var zn=Ae.pthreads[Be.targetThread];zn?zn.postMessage(Be,Be.transferList):U('Internal error! Worker sent a message "'+et+'" to target pthread '+Be.targetThread+", but that thread no longer exists!"),Ae.currentProxiedOperationCallerThread=void 0;return}et==="processProxyingQueue"?e_(Be.queue):et==="spawnThread"?_n(Be):et==="cleanupThread"?Br(Be.thread):et==="killThread"?or(Be.thread):et==="cancelThread"?Xi(Be.thread):et==="loaded"?(K.loaded=!0,v&&K.unref(),ce&&ce(K),K.runPthread&&K.runPthread()):et==="print"?L("Thread "+Be.threadId+": "+Be.text):et==="printErr"?U("Thread "+Be.threadId+": "+Be.text):et==="alert"?alert("Thread "+Be.threadId+": "+Be.text):Be.target==="setimmediate"?K.postMessage(Be):et==="callHandler"?u[Be.handler](...Be.args):et&&U("worker sent an unknown command "+et),Ae.currentProxiedOperationCallerThread=void 0},K.onerror=St=>{var Be="worker sent an error!";throw U(Be+" "+St.filename+":"+St.lineno+": "+St.message),St},v&&(K.on("message",function(St){K.onmessage({data:St})}),K.on("error",function(St){K.onerror(St)}),K.on("detachedExit",function(){}));var je=[],ot=["onExit","onAbort","print","printErr"];for(var wt of ot)u.hasOwnProperty(wt)&&je.push(wt);K.postMessage({cmd:"load",handlers:je,urlOrBlob:u.mainScriptUrlOrBlob||r,wasmMemory:D,wasmModule:R})},allocateUnusedWorker:function(){var K,ce=k("tfjs-backend-wasm-threaded-simd.worker.js");K=new Worker(ce),Ae.unusedWorkers.push(K)},getNewWorker:function(){return Ae.unusedWorkers.length==0&&(Ae.allocateUnusedWorker(),Ae.loadWasmModuleToWorker(Ae.unusedWorkers[0])),Ae.unusedWorkers.pop()}};u.PThread=Ae;function Xt(K){for(;K.length>0;)K.shift()(u)}function on(){var K=ew(),ce=o()[K+52>>>2],je=o()[K+56>>>2],ot=ce-je;zM(ce,ot),tw(ce)}u.establishStackSpace=on;function at(K){if(b)return Fp(2,0,K);try{Ne(K)}catch(ce){He(ce)}}var st=[];function lr(K){var ce=st[K];return ce||(K>=st.length&&(st.length=K+1),st[K]=ce=ue.get(K)),ce}function _s(K,ce){var je=lr(K)(ce);Ue()?Ae.setExitStatus(je):LM(je)}u.invokeEntryPoint=_s;function Wo(K){Ae.tlsInitFunctions.push(K)}function Yb(K){OM(K,!x,1,!y),Ae.threadInitTLS()}function yy(K){b?postMessage({cmd:"cleanupThread",thread:K}):Br(K)}function Jb(K,ce,je,ot){return b?Fp(3,1,K,ce,je,ot):ua(K,ce,je,ot)}function ua(K,ce,je,ot){if(typeof SharedArrayBuffer>"u")return U("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var wt=[],St=0;if(b&&(wt.length===0||St))return Jb(K,ce,je,ot);var Be={startRoutine:je,pthread_ptr:K,arg:ot,transferList:wt};return b?(Be.cmd="spawnThread",postMessage(Be,wt),0):_n(Be)}function Dl(){return 65536}var Zb=!0;function FZ(){return Zb}function e_(K){Atomics.store(o(),K>>2,1),ew()&&PM(K),Atomics.compareExchange(o(),K>>2,1,0)}u.executeNotifiedProxyingQueue=e_;function PZ(K,ce,je,ot){if(K==ce)setTimeout(()=>e_(ot));else if(b)postMessage({targetThread:K,cmd:"processProxyingQueue",queue:ot});else{var wt=Ae.pthreads[K];if(!wt)return;wt.postMessage({cmd:"processProxyingQueue",queue:ot})}return 1}function LZ(K,ce,je){return-1}function zZ(){$n("")}function xy(K){xy.shown||(xy.shown={}),xy.shown[K]||(xy.shown[K]=1,v&&(K="warning: "+K),U(K))}function BZ(){v||x||xy("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function UZ(){return Date.now()}function jM(){return 4294901760}function WZ(){return jM()}var t_;v?t_=()=>{var K=process.hrtime();return K[0]*1e3+K[1]/1e6}:t_=()=>performance.timeOrigin+performance.now();function VZ(K,ce,je){i().copyWithin(K>>>0,ce>>>0,ce+je>>>0)}function HZ(){return v?sNe().cpus().length:navigator.hardwareConcurrency}function GZ(K){var ce=a_(),je=K();return tw(ce),je}function Fp(K,ce){var je=arguments.length-2,ot=arguments;return GZ(()=>{for(var wt=je,St=nw(wt*8),Be=St>>3,et=0;et<je;et++){var zn=ot[2+et];c()[Be+et>>>0]=zn}return FM(K,wt,St,ce)})}var n_=[];function qZ(K,ce,je){n_.length=ce;for(var ot=je>>3,wt=0;wt<ce;wt++)n_[wt]=c()[ot+wt>>>0];var St=K<0,Be=St?Mt[-K-1]:nee[K];return Be.apply(null,n_)}function KZ(K){try{return D.grow(K-oe.byteLength+65535>>>16),se(D.buffer),1}catch{}}function QZ(K){var ce=i().length;if(K=K>>>0,K<=ce)return!1;var je=jM();if(K>je)return!1;let ot=(zn,Cs)=>zn+(Cs-zn%Cs)%Cs;for(var wt=1;wt<=4;wt*=2){var St=ce*(1+.2/wt);St=Math.min(St,K+100663296);var Be=Math.min(je,ot(Math.max(K,St),65536)),et=KZ(Be);if(et)return!0}return!1}function XZ(){throw"unwind"}function AM(K){return b?Fp(4,1,K):52}function $M(K,ce,je,ot,wt){return b?Fp(5,1,K,ce,je,ot,wt):70}var YZ=[null,[],[]];function JZ(K,ce){var je=YZ[K];ce===0||ce===10?((K===1?L:U)(Q(je,0)),je.length=0):je.push(ce)}function RM(K,ce,je,ot){if(b)return Fp(6,1,K,ce,je,ot);for(var wt=0,St=0;St<je;St++){var Be=l()[ce>>>2],et=l()[ce+4>>>2];ce+=8;for(var zn=0;zn<et;zn++)JZ(K,i()[Be+zn>>>0]);wt+=et}return l()[ot>>>2]=wt,0}function DM(K){var ce=u["_"+K];return ce}function ZZ(K,ce){s().set(K,ce>>>0)}function eee(K,ce,je,ot,wt){var St={string:Is=>{var Pp=0;if(Is!=null&&Is!==0){var WM=(Is.length<<2)+1;Pp=nw(WM),ie(Is,Pp,WM)}return Pp},array:Is=>{var Pp=nw(Is.length);return ZZ(Is,Pp),Pp}};function Be(Is){return ce==="string"?X(Is):ce==="boolean"?!!Is:Is}var et=DM(K),zn=[],Cs=0;if(ot)for(var Vo=0;Vo<ot.length;Vo++){var UM=St[je[Vo]];UM?(Cs===0&&(Cs=a_()),zn[Vo]=UM(ot[Vo])):zn[Vo]=ot[Vo]}var s_=et.apply(null,zn);function aee(Is){return Cs!==0&&tw(Cs),Be(Is)}return s_=aee(s_),s_}function tee(K,ce,je,ot){je=je||[];var wt=je.every(Be=>Be==="number"||Be==="boolean"),St=ce!=="string";return St&&wt&&!ot?DM(K):function(){return eee(K,ce,je,arguments)}}Ae.init();var nee=[null,ct,at,Jb,AM,$M,RM],MM={__emscripten_init_main_thread_js:Yb,__emscripten_thread_cleanup:yy,__pthread_create_js:ua,_emscripten_default_pthread_stack_size:Dl,_emscripten_get_now_is_monotonic:FZ,_emscripten_notify_task_queue:PZ,_emscripten_set_offscreencanvas_size:LZ,abort:zZ,emscripten_check_blocking_allowed:BZ,emscripten_date_now:UZ,emscripten_get_heap_max:WZ,emscripten_get_now:t_,emscripten_memcpy_big:VZ,emscripten_num_logical_cores:HZ,emscripten_receive_on_main_thread_js:qZ,emscripten_resize_heap:QZ,emscripten_unwind_to_js_event_loop:XZ,exit:Ne,fd_close:AM,fd_seek:$M,fd_write:RM,memory:D||u.wasmMemory};Le(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.__wasm_call_ctors).apply(null,arguments)},u._init=function(){return(u._init=u.asm.init).apply(null,arguments)},u._init_with_threads_count=function(){return(u._init_with_threads_count=u.asm.init_with_threads_count).apply(null,arguments)},u._get_threads_count=function(){return(u._get_threads_count=u.asm.get_threads_count).apply(null,arguments)},u._register_tensor=function(){return(u._register_tensor=u.asm.register_tensor).apply(null,arguments)},u._dispose_data=function(){return(u._dispose_data=u.asm.dispose_data).apply(null,arguments)},u._dispose=function(){return(u._dispose=u.asm.dispose).apply(null,arguments)},u._Abs=function(){return(u._Abs=u.asm.Abs).apply(null,arguments)},u._Acos=function(){return(u._Acos=u.asm.Acos).apply(null,arguments)},u._Acosh=function(){return(u._Acosh=u.asm.Acosh).apply(null,arguments)},u._Add=function(){return(u._Add=u.asm.Add).apply(null,arguments)},u._AddN=function(){return(u._AddN=u.asm.AddN).apply(null,arguments)},u._All=function(){return(u._All=u.asm.All).apply(null,arguments)},u._Any=function(){return(u._Any=u.asm.Any).apply(null,arguments)},u._ArgMax=function(){return(u._ArgMax=u.asm.ArgMax).apply(null,arguments)},u._ArgMin=function(){return(u._ArgMin=u.asm.ArgMin).apply(null,arguments)},u._Asin=function(){return(u._Asin=u.asm.Asin).apply(null,arguments)},u._Asinh=function(){return(u._Asinh=u.asm.Asinh).apply(null,arguments)},u._Atan=function(){return(u._Atan=u.asm.Atan).apply(null,arguments)},u._Atan2=function(){return(u._Atan2=u.asm.Atan2).apply(null,arguments)},u._Atanh=function(){return(u._Atanh=u.asm.Atanh).apply(null,arguments)},u._AvgPool=function(){return(u._AvgPool=u.asm.AvgPool).apply(null,arguments)},u._AvgPool3D=function(){return(u._AvgPool3D=u.asm.AvgPool3D).apply(null,arguments)},u._AvgPool3DGrad=function(){return(u._AvgPool3DGrad=u.asm.AvgPool3DGrad).apply(null,arguments)},u._AvgPoolGrad=function(){return(u._AvgPoolGrad=u.asm.AvgPoolGrad).apply(null,arguments)},u._BatchMatMul=function(){return(u._BatchMatMul=u.asm.BatchMatMul).apply(null,arguments)},u._Bincount=function(){return(u._Bincount=u.asm.Bincount).apply(null,arguments)},u._BitwiseAnd=function(){return(u._BitwiseAnd=u.asm.BitwiseAnd).apply(null,arguments)},u._Ceil=function(){return(u._Ceil=u.asm.Ceil).apply(null,arguments)},u._ClipByValue=function(){return(u._ClipByValue=u.asm.ClipByValue).apply(null,arguments)},u._Conv2D=function(){return(u._Conv2D=u.asm.Conv2D).apply(null,arguments)},u._Conv2DBackpropInput=function(){return(u._Conv2DBackpropInput=u.asm.Conv2DBackpropInput).apply(null,arguments)},u._Conv3D=function(){return(u._Conv3D=u.asm.Conv3D).apply(null,arguments)},u._Conv3DBackpropFilterV2=function(){return(u._Conv3DBackpropFilterV2=u.asm.Conv3DBackpropFilterV2).apply(null,arguments)},u._Conv3DBackpropInputV2=function(){return(u._Conv3DBackpropInputV2=u.asm.Conv3DBackpropInputV2).apply(null,arguments)},u._Cos=function(){return(u._Cos=u.asm.Cos).apply(null,arguments)},u._Cosh=function(){return(u._Cosh=u.asm.Cosh).apply(null,arguments)},u._CropAndResize=function(){return(u._CropAndResize=u.asm.CropAndResize).apply(null,arguments)},u._Cumprod=function(){return(u._Cumprod=u.asm.Cumprod).apply(null,arguments)},u._Cumsum=function(){return(u._Cumsum=u.asm.Cumsum).apply(null,arguments)},u._DenseBincount=function(){return(u._DenseBincount=u.asm.DenseBincount).apply(null,arguments)},u._DepthToSpace=function(){return(u._DepthToSpace=u.asm.DepthToSpace).apply(null,arguments)},u._DepthwiseConv2dNative=function(){return(u._DepthwiseConv2dNative=u.asm.DepthwiseConv2dNative).apply(null,arguments)},u._Diag=function(){return(u._Diag=u.asm.Diag).apply(null,arguments)},u._Dilation2D=function(){return(u._Dilation2D=u.asm.Dilation2D).apply(null,arguments)},u._Dilation2DBackpropFilter=function(){return(u._Dilation2DBackpropFilter=u.asm.Dilation2DBackpropFilter).apply(null,arguments)},u._Dilation2DBackpropInput=function(){return(u._Dilation2DBackpropInput=u.asm.Dilation2DBackpropInput).apply(null,arguments)},u._Elu=function(){return(u._Elu=u.asm.Elu).apply(null,arguments)},u._EluGrad=function(){return(u._EluGrad=u.asm.EluGrad).apply(null,arguments)},u._Equal=function(){return(u._Equal=u.asm.Equal).apply(null,arguments)},u._Erf=function(){return(u._Erf=u.asm.Erf).apply(null,arguments)},u._Exp=function(){return(u._Exp=u.asm.Exp).apply(null,arguments)},u._Expm1=function(){return(u._Expm1=u.asm.Expm1).apply(null,arguments)},u._FlipLeftRight=function(){return(u._FlipLeftRight=u.asm.FlipLeftRight).apply(null,arguments)},u._Floor=function(){return(u._Floor=u.asm.Floor).apply(null,arguments)},u._FloorDiv=function(){return(u._FloorDiv=u.asm.FloorDiv).apply(null,arguments)},u._FusedBatchNorm=function(){return(u._FusedBatchNorm=u.asm.FusedBatchNorm).apply(null,arguments)},u._FusedConv2D=function(){return(u._FusedConv2D=u.asm.FusedConv2D).apply(null,arguments)},u._FusedDepthwiseConv2D=function(){return(u._FusedDepthwiseConv2D=u.asm.FusedDepthwiseConv2D).apply(null,arguments)},u._Gather=function(){return(u._Gather=u.asm.Gather).apply(null,arguments)},u._GatherNd=function(){return(u._GatherNd=u.asm.GatherNd).apply(null,arguments)},u._Greater=function(){return(u._Greater=u.asm.Greater).apply(null,arguments)},u._GreaterEqual=function(){return(u._GreaterEqual=u.asm.GreaterEqual).apply(null,arguments)},u._IsFinite=function(){return(u._IsFinite=u.asm.IsFinite).apply(null,arguments)},u._IsInf=function(){return(u._IsInf=u.asm.IsInf).apply(null,arguments)},u._IsNan=function(){return(u._IsNan=u.asm.IsNan).apply(null,arguments)},u._LRN=function(){return(u._LRN=u.asm.LRN).apply(null,arguments)},u._LRNGrad=function(){return(u._LRNGrad=u.asm.LRNGrad).apply(null,arguments)},u._LeakyRelu=function(){return(u._LeakyRelu=u.asm.LeakyRelu).apply(null,arguments)},u._Less=function(){return(u._Less=u.asm.Less).apply(null,arguments)},u._LessEqual=function(){return(u._LessEqual=u.asm.LessEqual).apply(null,arguments)},u._LinSpace=function(){return(u._LinSpace=u.asm.LinSpace).apply(null,arguments)},u._Log=function(){return(u._Log=u.asm.Log).apply(null,arguments)},u._Log1p=function(){return(u._Log1p=u.asm.Log1p).apply(null,arguments)},u._LogicalAnd=function(){return(u._LogicalAnd=u.asm.LogicalAnd).apply(null,arguments)},u._LogicalNot=function(){return(u._LogicalNot=u.asm.LogicalNot).apply(null,arguments)},u._LogicalOr=function(){return(u._LogicalOr=u.asm.LogicalOr).apply(null,arguments)},u._LogicalXor=function(){return(u._LogicalXor=u.asm.LogicalXor).apply(null,arguments)},u._Max=function(){return(u._Max=u.asm.Max).apply(null,arguments)},u._MaxPool=function(){return(u._MaxPool=u.asm.MaxPool).apply(null,arguments)},u._MaxPool3D=function(){return(u._MaxPool3D=u.asm.MaxPool3D).apply(null,arguments)},u._MaxPool3DGrad=function(){return(u._MaxPool3DGrad=u.asm.MaxPool3DGrad).apply(null,arguments)},u._MaxPoolGrad=function(){return(u._MaxPoolGrad=u.asm.MaxPoolGrad).apply(null,arguments)},u._MaxPoolWithArgmax=function(){return(u._MaxPoolWithArgmax=u.asm.MaxPoolWithArgmax).apply(null,arguments)},u._Maximum=function(){return(u._Maximum=u.asm.Maximum).apply(null,arguments)},u._Mean=function(){return(u._Mean=u.asm.Mean).apply(null,arguments)},u._Min=function(){return(u._Min=u.asm.Min).apply(null,arguments)},u._Minimum=function(){return(u._Minimum=u.asm.Minimum).apply(null,arguments)},u._MirrorPad=function(){return(u._MirrorPad=u.asm.MirrorPad).apply(null,arguments)},u._Mod=function(){return(u._Mod=u.asm.Mod).apply(null,arguments)},u._Multinomial=function(){return(u._Multinomial=u.asm.Multinomial).apply(null,arguments)},u._Multiply=function(){return(u._Multiply=u.asm.Multiply).apply(null,arguments)},u._Neg=function(){return(u._Neg=u.asm.Neg).apply(null,arguments)},u._NonMaxSuppressionV3=function(){return(u._NonMaxSuppressionV3=u.asm.NonMaxSuppressionV3).apply(null,arguments)},u._NonMaxSuppressionV4=function(){return(u._NonMaxSuppressionV4=u.asm.NonMaxSuppressionV4).apply(null,arguments)},u._NonMaxSuppressionV5=function(){return(u._NonMaxSuppressionV5=u.asm.NonMaxSuppressionV5).apply(null,arguments)},u._NotEqual=function(){return(u._NotEqual=u.asm.NotEqual).apply(null,arguments)},u._OneHot=function(){return(u._OneHot=u.asm.OneHot).apply(null,arguments)},u._PadV2=function(){return(u._PadV2=u.asm.PadV2).apply(null,arguments)},u._Pow=function(){return(u._Pow=u.asm.Pow).apply(null,arguments)},u._Prelu=function(){return(u._Prelu=u.asm.Prelu).apply(null,arguments)},u._Prod=function(){return(u._Prod=u.asm.Prod).apply(null,arguments)},u._RealDiv=function(){return(u._RealDiv=u.asm.RealDiv).apply(null,arguments)},u._Reciprocal=function(){return(u._Reciprocal=u.asm.Reciprocal).apply(null,arguments)},u._Relu=function(){return(u._Relu=u.asm.Relu).apply(null,arguments)},u._Relu6=function(){return(u._Relu6=u.asm.Relu6).apply(null,arguments)},u._ResizeBilinear=function(){return(u._ResizeBilinear=u.asm.ResizeBilinear).apply(null,arguments)},u._ResizeBilinearGrad=function(){return(u._ResizeBilinearGrad=u.asm.ResizeBilinearGrad).apply(null,arguments)},u._ResizeNearestNeighbor=function(){return(u._ResizeNearestNeighbor=u.asm.ResizeNearestNeighbor).apply(null,arguments)},u._ResizeNearestNeighborGrad=function(){return(u._ResizeNearestNeighborGrad=u.asm.ResizeNearestNeighborGrad).apply(null,arguments)},u._Reverse=function(){return(u._Reverse=u.asm.Reverse).apply(null,arguments)},u._RotateWithOffset=function(){return(u._RotateWithOffset=u.asm.RotateWithOffset).apply(null,arguments)},u._Round=function(){return(u._Round=u.asm.Round).apply(null,arguments)},u._Rsqrt=function(){return(u._Rsqrt=u.asm.Rsqrt).apply(null,arguments)},u._ScatterNd=function(){return(u._ScatterNd=u.asm.ScatterNd).apply(null,arguments)},u._SearchSorted=function(){return(u._SearchSorted=u.asm.SearchSorted).apply(null,arguments)},u._SelectV2=function(){return(u._SelectV2=u.asm.SelectV2).apply(null,arguments)},u._Selu=function(){return(u._Selu=u.asm.Selu).apply(null,arguments)},u._Sigmoid=function(){return(u._Sigmoid=u.asm.Sigmoid).apply(null,arguments)},u._Sign=function(){return(u._Sign=u.asm.Sign).apply(null,arguments)},u._Sin=function(){return(u._Sin=u.asm.Sin).apply(null,arguments)},u._Sinh=function(){return(u._Sinh=u.asm.Sinh).apply(null,arguments)},u._Softmax=function(){return(u._Softmax=u.asm.Softmax).apply(null,arguments)},u._Softplus=function(){return(u._Softplus=u.asm.Softplus).apply(null,arguments)},u._SparseFillEmptyRows=function(){return(u._SparseFillEmptyRows=u.asm.SparseFillEmptyRows).apply(null,arguments)},u._SparseReshape=function(){return(u._SparseReshape=u.asm.SparseReshape).apply(null,arguments)},u._SparseSegmentReduction=function(){return(u._SparseSegmentReduction=u.asm.SparseSegmentReduction).apply(null,arguments)},u._SparseToDense=function(){return(u._SparseToDense=u.asm.SparseToDense).apply(null,arguments)},u._Sqrt=function(){return(u._Sqrt=u.asm.Sqrt).apply(null,arguments)},u._Square=function(){return(u._Square=u.asm.Square).apply(null,arguments)},u._SquaredDifference=function(){return(u._SquaredDifference=u.asm.SquaredDifference).apply(null,arguments)},u._Step=function(){return(u._Step=u.asm.Step).apply(null,arguments)},u._StridedSlice=function(){return(u._StridedSlice=u.asm.StridedSlice).apply(null,arguments)},u._Sub=function(){return(u._Sub=u.asm.Sub).apply(null,arguments)},u._Sum=function(){return(u._Sum=u.asm.Sum).apply(null,arguments)},u._Tan=function(){return(u._Tan=u.asm.Tan).apply(null,arguments)},u._Tanh=function(){return(u._Tanh=u.asm.Tanh).apply(null,arguments)},u._TensorScatterUpdate=function(){return(u._TensorScatterUpdate=u.asm.TensorScatterUpdate).apply(null,arguments)},u._Tile=function(){return(u._Tile=u.asm.Tile).apply(null,arguments)},u._TopK=function(){return(u._TopK=u.asm.TopK).apply(null,arguments)},u._Transform=function(){return(u._Transform=u.asm.Transform).apply(null,arguments)},u._Transpose=function(){return(u._Transpose=u.asm.Transpose).apply(null,arguments)},u.__FusedMatMul=function(){return(u.__FusedMatMul=u.asm._FusedMatMul).apply(null,arguments)},u._malloc=function(){return(u._malloc=u.asm.malloc).apply(null,arguments)},u._free=function(){return(u._free=u.asm.free).apply(null,arguments)},u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm._emscripten_tls_init).apply(null,arguments)};var ew=u._pthread_self=function(){return(ew=u._pthread_self=u.asm.pthread_self).apply(null,arguments)};u.___errno_location=function(){return(u.___errno_location=u.asm.__errno_location).apply(null,arguments)};var OM=u.__emscripten_thread_init=function(){return(OM=u.__emscripten_thread_init=u.asm._emscripten_thread_init).apply(null,arguments)};u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm._emscripten_thread_crashed).apply(null,arguments)},u._emscripten_main_thread_process_queued_calls=function(){return(u._emscripten_main_thread_process_queued_calls=u.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},u._emscripten_main_browser_thread_id=function(){return(u._emscripten_main_browser_thread_id=u.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var FM=u._emscripten_run_in_main_runtime_thread_js=function(){return(FM=u._emscripten_run_in_main_runtime_thread_js=u.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};u._emscripten_dispatch_to_thread_=function(){return(u._emscripten_dispatch_to_thread_=u.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var PM=u.__emscripten_proxy_execute_task_queue=function(){return(PM=u.__emscripten_proxy_execute_task_queue=u.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},r_=u.__emscripten_thread_free_data=function(){return(r_=u.__emscripten_thread_free_data=u.asm._emscripten_thread_free_data).apply(null,arguments)},LM=u.__emscripten_thread_exit=function(){return(LM=u.__emscripten_thread_exit=u.asm._emscripten_thread_exit).apply(null,arguments)},zM=u._emscripten_stack_set_limits=function(){return(zM=u._emscripten_stack_set_limits=u.asm.emscripten_stack_set_limits).apply(null,arguments)},a_=u.stackSave=function(){return(a_=u.stackSave=u.asm.stackSave).apply(null,arguments)},tw=u.stackRestore=function(){return(tw=u.stackRestore=u.asm.stackRestore).apply(null,arguments)},nw=u.stackAlloc=function(){return(nw=u.stackAlloc=u.asm.stackAlloc).apply(null,arguments)};u.dynCall_iijjiiii=function(){return(u.dynCall_iijjiiii=u.asm.dynCall_iijjiiii).apply(null,arguments)},u.dynCall_jiji=function(){return(u.dynCall_jiji=u.asm.dynCall_jiji).apply(null,arguments)},u.keepRuntimeAlive=Ue,u.wasmMemory=D,u.cwrap=tee,u.ExitStatus=gn,u.PThread=Ae;var rw;un=function K(){rw||BM(),rw||(un=K)};function BM(K){if(ht>0)return;if(b){h(u),yt(),startWorker(u);return}if(it(),ht>0)return;function ce(){rw||(rw=!0,u.calledRun=!0,!V&&(yt(),h(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),At()))}u.setStatus?(u.setStatus("Running..."),setTimeout(function(){setTimeout(function(){u.setStatus("")},1),ce()},1)):ce()}if(u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();BM();var aw;f&&(aw={uncaughtException:process.listeners("uncaughtException").filter(function(K){return!f.uncaughtException.indexOf(K)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(K){return!f.unhandledRejection.indexOf(K)>-1})});var sw;if(typeof WasmBackendModule<"u")sw=WasmBackendModule;else if(typeof a<"u")sw=a;else throw new Error("Could not find wasm module in post.js");if(aw){var ree=sw._dispose;sw._dispose=function(){ree(),aw.uncaughtException.forEach(function(K){process.removeListener("uncaughtException",K)}),aw.unhandledRejection.forEach(function(K){process.removeListener("unhandledRejection",K)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModuleThreadedSimd=n)}),oNe=gr((e,t)=>{t.exports.wasmWorkerContents=`"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"
");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};`}),lNe=gr((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};var s=typeof a<"u"?a:{},i,o;s.ready=new Promise(function(he,Ne){i=he,o=Ne});var l;typeof process<"u"&&process.listeners&&(l={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var c=Object.assign({},s),u=typeof window=="object",h=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",f="";function g(he){return s.locateFile?s.locateFile(he,f):f+he}var m,y,x;if(p){var v=vA(),b=OG();h?f=b.dirname(f)+"/":f=__dirname+"/",m=(he,Ne)=>(he=ae(he)?new URL(he):b.normalize(he),v.readFileSync(he,Ne?void 0:"utf8")),x=he=>{var Ne=m(he,!0);return Ne.buffer||(Ne=new Uint8Array(Ne)),Ne},y=(he,Ne,He)=>{he=ae(he)?new URL(he):b.normalize(he),v.readFile(he,function(Ae,Xt){Ae?He(Ae):Ne(Xt.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(he){if(!(he instanceof Ue))throw he}),process.on("unhandledRejection",function(he){throw he}),s.inspect=function(){return"[Emscripten Module object]"}}else(u||h)&&(h?f=self.location.href:typeof document<"u"&&document.currentScript&&(f=document.currentScript.src),r&&(f=r),f.indexOf("blob:")!==0?f=f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):f="",m=he=>{var Ne=new XMLHttpRequest;return Ne.open("GET",he,!1),Ne.send(null),Ne.responseText},h&&(x=he=>{var Ne=new XMLHttpRequest;return Ne.open("GET",he,!1),Ne.responseType="arraybuffer",Ne.send(null),new Uint8Array(Ne.response)}),y=(he,Ne,He)=>{var Ae=new XMLHttpRequest;Ae.open("GET",he,!0),Ae.responseType="arraybuffer",Ae.onload=()=>{if(Ae.status==200||Ae.status==0&&Ae.response){Ne(Ae.response);return}He()},Ae.onerror=He,Ae.send(null)});var w=s.print||console.log.bind(console),k=s.printErr||console.warn.bind(console);Object.assign(s,c),c=null,s.arguments&&s.arguments,s.thisProgram&&s.thisProgram,s.quit&&s.quit;var I;s.wasmBinary&&(I=s.wasmBinary),s.noExitRuntime,typeof WebAssembly!="object"&&be("no native wasm support detected");var C,S=!1,E=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function T(he,Ne,He){Ne>>>=0;for(var Ae=Ne+He,Xt=Ne;he[Xt]&&!(Xt>=Ae);)++Xt;if(Xt-Ne>16&&he.buffer&&E)return E.decode(he.subarray(Ne,Xt));for(var on="";Ne<Xt;){var at=he[Ne++];if(!(at&128)){on+=String.fromCharCode(at);continue}var st=he[Ne++]&63;if((at&224)==192){on+=String.fromCharCode((at&31)<<6|st);continue}var lr=he[Ne++]&63;if((at&240)==224?at=(at&15)<<12|st<<6|lr:at=(at&7)<<18|st<<12|lr<<6|he[Ne++]&63,at<65536)on+=String.fromCharCode(at);else{var _s=at-65536;on+=String.fromCharCode(55296|_s>>10,56320|_s&1023)}}return on}function $(he,Ne){return he>>>=0,he?T(O,he,Ne):""}function _(he,Ne,He,Ae){if(He>>>=0,!(Ae>0))return 0;for(var Xt=He,on=He+Ae-1,at=0;at<he.length;++at){var st=he.charCodeAt(at);if(st>=55296&&st<=57343){var lr=he.charCodeAt(++at);st=65536+((st&1023)<<10)|lr&1023}if(st<=127){if(He>=on)break;Ne[He++>>>0]=st}else if(st<=2047){if(He+1>=on)break;Ne[He++>>>0]=192|st>>6,Ne[He++>>>0]=128|st&63}else if(st<=65535){if(He+2>=on)break;Ne[He++>>>0]=224|st>>12,Ne[He++>>>0]=128|st>>6&63,Ne[He++>>>0]=128|st&63}else{if(He+3>=on)break;Ne[He++>>>0]=240|st>>18,Ne[He++>>>0]=128|st>>12&63,Ne[He++>>>0]=128|st>>6&63,Ne[He++>>>0]=128|st&63}}return Ne[He>>>0]=0,He-Xt}function M(he,Ne,He){return _(he,O,Ne,He)}var L,U,O,F;function D(he){L=he,s.HEAP8=U=new Int8Array(he),s.HEAP16=new Int16Array(he),s.HEAP32=new Int32Array(he),s.HEAPU8=O=new Uint8Array(he),s.HEAPU16=new Uint16Array(he),s.HEAPU32=F=new Uint32Array(he),s.HEAPF32=new Float32Array(he),s.HEAPF64=new Float64Array(he)}s.INITIAL_MEMORY;var R=[],V=[],G=[];function W(){if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)X(s.preRun.shift());it(R)}function B(){it(V)}function Q(){if(s.postRun)for(typeof s.postRun=="function"&&(s.postRun=[s.postRun]);s.postRun.length;)ie(s.postRun.shift());it(G)}function X(he){R.unshift(he)}function pe(he){V.unshift(he)}function ie(he){G.unshift(he)}var oe=0,q=null;function de(he){oe++,s.monitorRunDependencies&&s.monitorRunDependencies(oe)}function ye(he){if(oe--,s.monitorRunDependencies&&s.monitorRunDependencies(oe),oe==0&&q){var Ne=q;q=null,Ne()}}function be(he){s.onAbort&&s.onAbort(he),he="Aborted("+he+")",k(he),S=!0,he+=". Build with -sASSERTIONS for more info.";var Ne=new WebAssembly.RuntimeError(he);throw o(Ne),Ne}var Ce="data:application/octet-stream;base64,";function se(he){return he.startsWith(Ce)}function ae(he){return he.startsWith("file://")}var ue;ue="tfjs-backend-wasm.wasm",se(ue)||(ue=g(ue));function ke(he){try{if(he==ue&&I)return new Uint8Array(I);if(x)return x(he);throw"both async and sync fetching of the wasm failed"}catch(Ne){be(Ne)}}function _e(){if(!I&&(u||h)){if(typeof fetch=="function"&&!ae(ue))return fetch(ue,{credentials:"same-origin"}).then(function(he){if(!he.ok)throw"failed to load wasm binary file at '"+ue+"'";return he.arrayBuffer()}).catch(function(){return ke(ue)});if(y)return new Promise(function(he,Ne){y(ue,function(He){he(new Uint8Array(He))},Ne)})}return Promise.resolve().then(function(){return ke(ue)})}function qe(){var he={env:De,wasi_snapshot_preview1:De};function Ne(at,st){var lr=at.exports;s.asm=lr,C=s.asm.memory,D(C.buffer),s.asm.__indirect_function_table,pe(s.asm.__wasm_call_ctors),ye()}de();function He(at){Ne(at.instance)}function Ae(at){return _e().then(function(st){return WebAssembly.instantiate(st,he)}).then(function(st){return st}).then(at,function(st){k("failed to asynchronously prepare wasm: "+st),be(st)})}function Xt(){return!I&&typeof WebAssembly.instantiateStreaming=="function"&&!se(ue)&&!ae(ue)&&!p&&typeof fetch=="function"?fetch(ue,{credentials:"same-origin"}).then(function(at){var st=WebAssembly.instantiateStreaming(at,he);return st.then(He,function(lr){return k("wasm streaming compile failed: "+lr),k("falling back to ArrayBuffer instantiation"),Ae(He)})}):Ae(He)}if(s.instantiateWasm)try{var on=s.instantiateWasm(he,Ne);return on}catch(at){k("Module.instantiateWasm callback failed with error: "+at),o(at)}return Xt().catch(o),{}}function Ue(he){this.name="ExitStatus",this.message="Program terminated with exit("+he+")",this.status=he}function it(he){for(;he.length>0;)he.shift()(s)}function yt(){be("")}function At(){return 4294901760}function Bt(){return At()}function an(he,Ne,He){O.copyWithin(he>>>0,Ne>>>0,Ne+He>>>0)}function nt(he){try{return C.grow(he-L.byteLength+65535>>>16),D(C.buffer),1}catch{}}function ht(he){var Ne=O.length;he=he>>>0;var He=At();if(he>He)return!1;let Ae=(lr,_s)=>lr+(_s-lr%_s)%_s;for(var Xt=1;Xt<=4;Xt*=2){var on=Ne*(1+.2/Xt);on=Math.min(on,he+100663296);var at=Math.min(He,Ae(Math.max(he,on),65536)),st=nt(at);if(st)return!0}return!1}function un(he){return 52}function er(he,Ne,He,Ae,Xt){return 70}var xe=[null,[],[]];function $n(he,Ne){var He=xe[he];Ne===0||Ne===10?((he===1?w:k)(T(He,0)),He.length=0):He.push(Ne)}function Pn(he,Ne,He,Ae){for(var Xt=0,on=0;on<He;on++){var at=F[Ne>>>2],st=F[Ne+4>>>2];Ne+=8;for(var lr=0;lr<st;lr++)$n(he,O[at+lr>>>0]);Xt+=st}return F[Ae>>>2]=Xt,0}function sn(he){var Ne=s["_"+he];return Ne}function tn(he,Ne){U.set(he,Ne>>>0)}function Ln(he,Ne,He,Ae,Xt){var on={string:ua=>{var Dl=0;if(ua!=null&&ua!==0){var Zb=(ua.length<<2)+1;Dl=gn(Zb),M(ua,Dl,Zb)}return Dl},array:ua=>{var Dl=gn(ua.length);return tn(ua,Dl),Dl}};function at(ua){return Ne==="string"?$(ua):Ne==="boolean"?!!ua:ua}var st=sn(he),lr=[],_s=0;if(Ae)for(var Wo=0;Wo<Ae.length;Wo++){var Yb=on[He[Wo]];Yb?(_s===0&&(_s=Le()),lr[Wo]=Yb(Ae[Wo])):lr[Wo]=Ae[Wo]}var yy=st.apply(null,lr);function Jb(ua){return _s!==0&&Mt(_s),at(ua)}return yy=Jb(yy),yy}function Qa(he,Ne,He,Ae){He=He||[];var Xt=He.every(at=>at==="number"||at==="boolean"),on=Ne!=="string";return on&&Xt&&!Ae?sn(he):function(){return Ln(he,Ne,He,arguments)}}var De={abort:yt,emscripten_get_heap_max:Bt,emscripten_memcpy_big:an,emscripten_resize_heap:ht,fd_close:un,fd_seek:er,fd_write:Pn};qe(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},s._init=function(){return(s._init=s.asm.init).apply(null,arguments)},s._init_with_threads_count=function(){return(s._init_with_threads_count=s.asm.init_with_threads_count).apply(null,arguments)},s._get_threads_count=function(){return(s._get_threads_count=s.asm.get_threads_count).apply(null,arguments)},s._register_tensor=function(){return(s._register_tensor=s.asm.register_tensor).apply(null,arguments)},s._dispose_data=function(){return(s._dispose_data=s.asm.dispose_data).apply(null,arguments)},s._dispose=function(){return(s._dispose=s.asm.dispose).apply(null,arguments)},s._Abs=function(){return(s._Abs=s.asm.Abs).apply(null,arguments)},s._Acos=function(){return(s._Acos=s.asm.Acos).apply(null,arguments)},s._Acosh=function(){return(s._Acosh=s.asm.Acosh).apply(null,arguments)},s._Add=function(){return(s._Add=s.asm.Add).apply(null,arguments)},s._AddN=function(){return(s._AddN=s.asm.AddN).apply(null,arguments)},s._All=function(){return(s._All=s.asm.All).apply(null,arguments)},s._Any=function(){return(s._Any=s.asm.Any).apply(null,arguments)},s._ArgMax=function(){return(s._ArgMax=s.asm.ArgMax).apply(null,arguments)},s._ArgMin=function(){return(s._ArgMin=s.asm.ArgMin).apply(null,arguments)},s._Asin=function(){return(s._Asin=s.asm.Asin).apply(null,arguments)},s._Asinh=function(){return(s._Asinh=s.asm.Asinh).apply(null,arguments)},s._Atan=function(){return(s._Atan=s.asm.Atan).apply(null,arguments)},s._Atan2=function(){return(s._Atan2=s.asm.Atan2).apply(null,arguments)},s._Atanh=function(){return(s._Atanh=s.asm.Atanh).apply(null,arguments)},s._AvgPool=function(){return(s._AvgPool=s.asm.AvgPool).apply(null,arguments)},s._AvgPool3D=function(){return(s._AvgPool3D=s.asm.AvgPool3D).apply(null,arguments)},s._AvgPool3DGrad=function(){return(s._AvgPool3DGrad=s.asm.AvgPool3DGrad).apply(null,arguments)},s._AvgPoolGrad=function(){return(s._AvgPoolGrad=s.asm.AvgPoolGrad).apply(null,arguments)},s._BatchMatMul=function(){return(s._BatchMatMul=s.asm.BatchMatMul).apply(null,arguments)},s._Bincount=function(){return(s._Bincount=s.asm.Bincount).apply(null,arguments)},s._BitwiseAnd=function(){return(s._BitwiseAnd=s.asm.BitwiseAnd).apply(null,arguments)},s._Ceil=function(){return(s._Ceil=s.asm.Ceil).apply(null,arguments)},s._ClipByValue=function(){return(s._ClipByValue=s.asm.ClipByValue).apply(null,arguments)},s._Conv2D=function(){return(s._Conv2D=s.asm.Conv2D).apply(null,arguments)},s._Conv2DBackpropInput=function(){return(s._Conv2DBackpropInput=s.asm.Conv2DBackpropInput).apply(null,arguments)},s._Conv3D=function(){return(s._Conv3D=s.asm.Conv3D).apply(null,arguments)},s._Conv3DBackpropFilterV2=function(){return(s._Conv3DBackpropFilterV2=s.asm.Conv3DBackpropFilterV2).apply(null,arguments)},s._Conv3DBackpropInputV2=function(){return(s._Conv3DBackpropInputV2=s.asm.Conv3DBackpropInputV2).apply(null,arguments)},s._Cos=function(){return(s._Cos=s.asm.Cos).apply(null,arguments)},s._Cosh=function(){return(s._Cosh=s.asm.Cosh).apply(null,arguments)},s._CropAndResize=function(){return(s._CropAndResize=s.asm.CropAndResize).apply(null,arguments)},s._Cumprod=function(){return(s._Cumprod=s.asm.Cumprod).apply(null,arguments)},s._Cumsum=function(){return(s._Cumsum=s.asm.Cumsum).apply(null,arguments)},s._DenseBincount=function(){return(s._DenseBincount=s.asm.DenseBincount).apply(null,arguments)},s._DepthToSpace=function(){return(s._DepthToSpace=s.asm.DepthToSpace).apply(null,arguments)},s._DepthwiseConv2dNative=function(){return(s._DepthwiseConv2dNative=s.asm.DepthwiseConv2dNative).apply(null,arguments)},s._Diag=function(){return(s._Diag=s.asm.Diag).apply(null,arguments)},s._Dilation2D=function(){return(s._Dilation2D=s.asm.Dilation2D).apply(null,arguments)},s._Dilation2DBackpropFilter=function(){return(s._Dilation2DBackpropFilter=s.asm.Dilation2DBackpropFilter).apply(null,arguments)},s._Dilation2DBackpropInput=function(){return(s._Dilation2DBackpropInput=s.asm.Dilation2DBackpropInput).apply(null,arguments)},s._Elu=function(){return(s._Elu=s.asm.Elu).apply(null,arguments)},s._EluGrad=function(){return(s._EluGrad=s.asm.EluGrad).apply(null,arguments)},s._Equal=function(){return(s._Equal=s.asm.Equal).apply(null,arguments)},s._Erf=function(){return(s._Erf=s.asm.Erf).apply(null,arguments)},s._Exp=function(){return(s._Exp=s.asm.Exp).apply(null,arguments)},s._Expm1=function(){return(s._Expm1=s.asm.Expm1).apply(null,arguments)},s._FlipLeftRight=function(){return(s._FlipLeftRight=s.asm.FlipLeftRight).apply(null,arguments)},s._Floor=function(){return(s._Floor=s.asm.Floor).apply(null,arguments)},s._FloorDiv=function(){return(s._FloorDiv=s.asm.FloorDiv).apply(null,arguments)},s._FusedBatchNorm=function(){return(s._FusedBatchNorm=s.asm.FusedBatchNorm).apply(null,arguments)},s._FusedConv2D=function(){return(s._FusedConv2D=s.asm.FusedConv2D).apply(null,arguments)},s._FusedDepthwiseConv2D=function(){return(s._FusedDepthwiseConv2D=s.asm.FusedDepthwiseConv2D).apply(null,arguments)},s._Gather=function(){return(s._Gather=s.asm.Gather).apply(null,arguments)},s._GatherNd=function(){return(s._GatherNd=s.asm.GatherNd).apply(null,arguments)},s._Greater=function(){return(s._Greater=s.asm.Greater).apply(null,arguments)},s._GreaterEqual=function(){return(s._GreaterEqual=s.asm.GreaterEqual).apply(null,arguments)},s._IsFinite=function(){return(s._IsFinite=s.asm.IsFinite).apply(null,arguments)},s._IsInf=function(){return(s._IsInf=s.asm.IsInf).apply(null,arguments)},s._IsNan=function(){return(s._IsNan=s.asm.IsNan).apply(null,arguments)},s._LRN=function(){return(s._LRN=s.asm.LRN).apply(null,arguments)},s._LRNGrad=function(){return(s._LRNGrad=s.asm.LRNGrad).apply(null,arguments)},s._LeakyRelu=function(){return(s._LeakyRelu=s.asm.LeakyRelu).apply(null,arguments)},s._Less=function(){return(s._Less=s.asm.Less).apply(null,arguments)},s._LessEqual=function(){return(s._LessEqual=s.asm.LessEqual).apply(null,arguments)},s._LinSpace=function(){return(s._LinSpace=s.asm.LinSpace).apply(null,arguments)},s._Log=function(){return(s._Log=s.asm.Log).apply(null,arguments)},s._Log1p=function(){return(s._Log1p=s.asm.Log1p).apply(null,arguments)},s._LogicalAnd=function(){return(s._LogicalAnd=s.asm.LogicalAnd).apply(null,arguments)},s._LogicalNot=function(){return(s._LogicalNot=s.asm.LogicalNot).apply(null,arguments)},s._LogicalOr=function(){return(s._LogicalOr=s.asm.LogicalOr).apply(null,arguments)},s._LogicalXor=function(){return(s._LogicalXor=s.asm.LogicalXor).apply(null,arguments)},s._Max=function(){return(s._Max=s.asm.Max).apply(null,arguments)},s._MaxPool=function(){return(s._MaxPool=s.asm.MaxPool).apply(null,arguments)},s._MaxPool3D=function(){return(s._MaxPool3D=s.asm.MaxPool3D).apply(null,arguments)},s._MaxPool3DGrad=function(){return(s._MaxPool3DGrad=s.asm.MaxPool3DGrad).apply(null,arguments)},s._MaxPoolGrad=function(){return(s._MaxPoolGrad=s.asm.MaxPoolGrad).apply(null,arguments)},s._MaxPoolWithArgmax=function(){return(s._MaxPoolWithArgmax=s.asm.MaxPoolWithArgmax).apply(null,arguments)},s._Maximum=function(){return(s._Maximum=s.asm.Maximum).apply(null,arguments)},s._Mean=function(){return(s._Mean=s.asm.Mean).apply(null,arguments)},s._Min=function(){return(s._Min=s.asm.Min).apply(null,arguments)},s._Minimum=function(){return(s._Minimum=s.asm.Minimum).apply(null,arguments)},s._MirrorPad=function(){return(s._MirrorPad=s.asm.MirrorPad).apply(null,arguments)},s._Mod=function(){return(s._Mod=s.asm.Mod).apply(null,arguments)},s._Multinomial=function(){return(s._Multinomial=s.asm.Multinomial).apply(null,arguments)},s._Multiply=function(){return(s._Multiply=s.asm.Multiply).apply(null,arguments)},s._Neg=function(){return(s._Neg=s.asm.Neg).apply(null,arguments)},s._NonMaxSuppressionV3=function(){return(s._NonMaxSuppressionV3=s.asm.NonMaxSuppressionV3).apply(null,arguments)},s._NonMaxSuppressionV4=function(){return(s._NonMaxSuppressionV4=s.asm.NonMaxSuppressionV4).apply(null,arguments)},s._NonMaxSuppressionV5=function(){return(s._NonMaxSuppressionV5=s.asm.NonMaxSuppressionV5).apply(null,arguments)},s._NotEqual=function(){return(s._NotEqual=s.asm.NotEqual).apply(null,arguments)},s._OneHot=function(){return(s._OneHot=s.asm.OneHot).apply(null,arguments)},s._PadV2=function(){return(s._PadV2=s.asm.PadV2).apply(null,arguments)},s._Pow=function(){return(s._Pow=s.asm.Pow).apply(null,arguments)},s._Prelu=function(){return(s._Prelu=s.asm.Prelu).apply(null,arguments)},s._Prod=function(){return(s._Prod=s.asm.Prod).apply(null,arguments)},s._RealDiv=function(){return(s._RealDiv=s.asm.RealDiv).apply(null,arguments)},s._Reciprocal=function(){return(s._Reciprocal=s.asm.Reciprocal).apply(null,arguments)},s._Relu=function(){return(s._Relu=s.asm.Relu).apply(null,arguments)},s._Relu6=function(){return(s._Relu6=s.asm.Relu6).apply(null,arguments)},s._ResizeBilinear=function(){return(s._ResizeBilinear=s.asm.ResizeBilinear).apply(null,arguments)},s._ResizeBilinearGrad=function(){return(s._ResizeBilinearGrad=s.asm.ResizeBilinearGrad).apply(null,arguments)},s._ResizeNearestNeighbor=function(){return(s._ResizeNearestNeighbor=s.asm.ResizeNearestNeighbor).apply(null,arguments)},s._ResizeNearestNeighborGrad=function(){return(s._ResizeNearestNeighborGrad=s.asm.ResizeNearestNeighborGrad).apply(null,arguments)},s._Reverse=function(){return(s._Reverse=s.asm.Reverse).apply(null,arguments)},s._RotateWithOffset=function(){return(s._RotateWithOffset=s.asm.RotateWithOffset).apply(null,arguments)},s._Round=function(){return(s._Round=s.asm.Round).apply(null,arguments)},s._Rsqrt=function(){return(s._Rsqrt=s.asm.Rsqrt).apply(null,arguments)},s._ScatterNd=function(){return(s._ScatterNd=s.asm.ScatterNd).apply(null,arguments)},s._SearchSorted=function(){return(s._SearchSorted=s.asm.SearchSorted).apply(null,arguments)},s._SelectV2=function(){return(s._SelectV2=s.asm.SelectV2).apply(null,arguments)},s._Selu=function(){return(s._Selu=s.asm.Selu).apply(null,arguments)},s._Sigmoid=function(){return(s._Sigmoid=s.asm.Sigmoid).apply(null,arguments)},s._Sign=function(){return(s._Sign=s.asm.Sign).apply(null,arguments)},s._Sin=function(){return(s._Sin=s.asm.Sin).apply(null,arguments)},s._Sinh=function(){return(s._Sinh=s.asm.Sinh).apply(null,arguments)},s._Softmax=function(){return(s._Softmax=s.asm.Softmax).apply(null,arguments)},s._Softplus=function(){return(s._Softplus=s.asm.Softplus).apply(null,arguments)},s._SparseFillEmptyRows=function(){return(s._SparseFillEmptyRows=s.asm.SparseFillEmptyRows).apply(null,arguments)},s._SparseReshape=function(){return(s._SparseReshape=s.asm.SparseReshape).apply(null,arguments)},s._SparseSegmentReduction=function(){return(s._SparseSegmentReduction=s.asm.SparseSegmentReduction).apply(null,arguments)},s._SparseToDense=function(){return(s._SparseToDense=s.asm.SparseToDense).apply(null,arguments)},s._Sqrt=function(){return(s._Sqrt=s.asm.Sqrt).apply(null,arguments)},s._Square=function(){return(s._Square=s.asm.Square).apply(null,arguments)},s._SquaredDifference=function(){return(s._SquaredDifference=s.asm.SquaredDifference).apply(null,arguments)},s._Step=function(){return(s._Step=s.asm.Step).apply(null,arguments)},s._StridedSlice=function(){return(s._StridedSlice=s.asm.StridedSlice).apply(null,arguments)},s._Sub=function(){return(s._Sub=s.asm.Sub).apply(null,arguments)},s._Sum=function(){return(s._Sum=s.asm.Sum).apply(null,arguments)},s._Tan=function(){return(s._Tan=s.asm.Tan).apply(null,arguments)},s._Tanh=function(){return(s._Tanh=s.asm.Tanh).apply(null,arguments)},s._TensorScatterUpdate=function(){return(s._TensorScatterUpdate=s.asm.TensorScatterUpdate).apply(null,arguments)},s._Tile=function(){return(s._Tile=s.asm.Tile).apply(null,arguments)},s._TopK=function(){return(s._TopK=s.asm.TopK).apply(null,arguments)},s._Transform=function(){return(s._Transform=s.asm.Transform).apply(null,arguments)},s._Transpose=function(){return(s._Transpose=s.asm.Transpose).apply(null,arguments)},s.__FusedMatMul=function(){return(s.__FusedMatMul=s.asm._FusedMatMul).apply(null,arguments)},s._malloc=function(){return(s._malloc=s.asm.malloc).apply(null,arguments)},s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)};var Le=s.stackSave=function(){return(Le=s.stackSave=s.asm.stackSave).apply(null,arguments)},Mt=s.stackRestore=function(){return(Mt=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},gn=s.stackAlloc=function(){return(gn=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)};s.dynCall_iijjiiii=function(){return(s.dynCall_iijjiiii=s.asm.dynCall_iijjiiii).apply(null,arguments)},s.dynCall_jiji=function(){return(s.dynCall_jiji=s.asm.dynCall_jiji).apply(null,arguments)},s.cwrap=Qa;var or;q=function he(){or||Xi(),or||(q=he)};function Xi(he){if(oe>0||(W(),oe>0))return;function Ne(){or||(or=!0,s.calledRun=!0,!S&&(B(),i(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),Q()))}s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),Ne()},1)):Ne()}if(s.preInit)for(typeof s.preInit=="function"&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();Xi();var Br;l&&(Br={uncaughtException:process.listeners("uncaughtException").filter(function(he){return!l.uncaughtException.indexOf(he)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(he){return!l.unhandledRejection.indexOf(he)>-1})});var _n;if(typeof a<"u")_n=a;else if(typeof WasmBackendModuleThreadedSimd<"u")_n=WasmBackendModuleThreadedSimd;else throw new Error("Could not find wasm module in post.js");if(Br){var ct=_n._dispose;_n._dispose=function(){ct(),Br.uncaughtException.forEach(function(he){process.removeListener("uncaughtException",he)}),Br.unhandledRejection.forEach(function(he){process.removeListener("unhandledRejection",he)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModule=n)}),_k=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},Gv=class{refCount(e){return Ya("refCount")}incRef(e){return Ya("incRef")}timerAvailable(){return!0}time(e){return Ya("time")}read(e){return Ya("read")}readSync(e){return Ya("readSync")}readToGPU(e,t){return Ya("readToGPU")}numDataIds(){return Ya("numDataIds")}disposeData(e,t){return Ya("disposeData")}write(e,t,n){return Ya("write")}move(e,t,n,r,a){return Ya("move")}createTensorFromGPUData(e,t,n){return Ya("createTensorFromGPUData")}memory(){return Ya("memory")}floatPrecision(){return Ya("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return Ya("dispose")}};function Ya(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function FG(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,A1(e,t,n)}function uNe(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,A1(e,n,r),A1(t,n,r)}function Jx(e,t,n){return Math.max(e,Math.min(t,n))}function cNe(e){return e%2===0?e:e+1}function A1(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function dNe(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function hNe(e,t){let n=Math.random();return t*n+(1-n)*e}function pNe(e,t){let n=0;for(let r=0;r<e.length;r++){let a=Number(e[r])-Number(t[r]);n+=a*a}return n}function H(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ia(e,t,n=""){H(Cl(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function ih(e){H(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function fn(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function fNe(e){return e.length===0}function PG(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Cl(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function lm(e){return e%1===0}function mNe(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function gNe(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function yNe(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return FG(t),t}function yx(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function xNe(e,t=a=>0,n,r){return new Promise((a,s)=>{let i=0,o=()=>{if(e()){a();return}i++;let l=t(i);if(n!=null&&i>=n){s();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function vNe(e,t){let n=1,r=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(e[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(e[s]<0)throw Error(`Shapes can not be < 0. Found ${e[s]} at dim ${s}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let a=e.slice();return a[r]=t/n,a}function hi(e,t){let n=t.length;return e=e==null?t.map((r,a)=>a):[].concat(e),H(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),H(e.every(r=>lm(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function LG(e,t){let n=[],r=[],a=t!=null&&Array.isArray(t)&&t.length===0,s=t==null||a?null:hi(t,e).sort(),i=0;for(let o=0;o<e.length;++o){if(s!=null){if(s[i]===o&&e[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(s[i]==null||s[i]>o)&&e[o]===1&&(n.push(e[o]),r.push(o)),s[i]<=o&&i++}e[o]!==1&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function zG(e,t){return bA(e,t)}function bA(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function BG(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function UG(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function bNe(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function $1(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function WG(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function gu(e){return typeof e=="string"||e instanceof String}function VG(e){return typeof e=="boolean"}function HG(e){return typeof e=="number"}function qv(e){return Array.isArray(e)?qv(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":HG(e)?"float32":gu(e)?"string":VG(e)?"bool":"float32"}function Wu(e){return!!(e&&e.constructor&&e.call&&e.apply)}function R1(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function qm(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function GG(e,t,n,r=!1){let a=new Array;if(t.length===1){let s=t[0]*(r?2:1);for(let i=0;i<s;i++)a[i]=n[e+i]}else{let s=t[0],i=t.slice(1),o=i.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<s;l++)a[l]=GG(e+l*o,i,n,r)}return a}function Tf(e,t,n=!1){if(e.length===0)return t[0];let r=e.reduce((a,s)=>a*s)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return GG(0,e,t,n)}function wNe(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function wA(e,t){let n=Ck(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function Ck(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function NNe(e,t){let n=e.reduce((r,a)=>r*a,1);if(t==null||t==="float32")return Tf(e,new Float32Array(n));if(t==="int32")return Tf(e,new Int32Array(n));if(t==="bool")return Tf(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function Ss(e){e.forEach(t=>{H(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function kNe(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function SNe(e,t,n){if(t===0)return[];if(t===1)return[e];let r=new Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Ik(e){return e&&e.then&&typeof e.then=="function"}var rL="tfjsflags",qG=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=_Ne,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){let r=this.urlFlags[e];le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(Ik(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let e=this.getQueryParams(this.global.location.search);rL in e&&e[rL].split(",").forEach(t=>{let[n,r]=t.split(":");this.urlFlags[n]=INe(n,r)})}};function _Ne(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(CNe(t,r[0],r[1]),r.join("="))),t}function CNe(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function INe(e,t){let n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function le(){return NA}var NA=null;function ENe(e){NA=e}var mC;function KG(){if(mC==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");mC=e}return mC}function TNe(){let e=KG();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function kA(e,t){let n=TNe();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}var Km="Abs",oh="Acos",lh="Acosh",mc="Add",uh="AddN",Qm="All",Xm="Any",Ym="ArgMax",Jm="ArgMin",ch="Asin",dh="Asinh",hh="Atan",ph="Atanh",fh="Atan2",mh="AvgPool",Kv="AvgPoolGrad",Zm="AvgPool3D",Qv="AvgPool3DGrad",gh="BatchMatMul",eg="BatchToSpaceND",tg="Bincount",ng="BitwiseAnd",QG="BroadcastTo",Xv="BroadcastArgs",yh="Cast",xh="Ceil",gc="ClipByValue",Ek="Complex",Yv="ComplexAbs",rg="Concat",vh="Conv2D",Tk="Conv2DBackpropFilter",bh="Conv2DBackpropInput",wh="Conv3D",ag="Conv3DBackpropFilterV2",sg="Conv3DBackpropInputV2",Nh="Cos",kh="Cosh",ig="Cumprod",Sh="Cumsum",og="CropAndResize",Jv="DenseBincount",lg="DepthToSpace",_h="DepthwiseConv2dNative",jk="DepthwiseConv2dNativeBackpropFilter",Ak="DepthwiseConv2dNativeBackpropInput",Zv="Diag",Ch="Dilation2D",um="Dilation2DBackpropInput",cm="Dilation2DBackpropFilter",$k="Draw",Ih="RealDiv",Rk="Einsum",Eh="Elu",ug="EluGrad",Th="Erf",cg="Equal",jh="Exp",dg="ExpandDims",Ah="Expm1",Dk="FFT",eb="Fill",hg="FlipLeftRight",$h="Floor",Rh="FloorDiv",Dh="FusedBatchNorm",pg="GatherV2",fg="GatherNd",mg="Greater",Mh="GreaterEqual",Oh="Identity",Mk="IFFT",Ok="Imag",Fh="IsFinite",Ph="IsInf",Lh="IsNan",zh="LeakyRelu",gg="Less",yg="LessEqual",xg="LinSpace",Bh="Log",Uh="Log1p",vg="LogicalAnd",bg="LogicalNot",wg="LogicalOr",XG="LogicalXor",YG="LogSoftmax",jNe="LowerBound",Wh="LRN",Ng="LRNGrad",ANe="MatrixBandPart",Vh="Max",Hh="Maximum",Gh="MaxPool",tb="MaxPoolGrad",kg="MaxPool3D",nb="MaxPool3DGrad",rb="MaxPoolWithArgmax",qh="Mean",Kh="Min",Qh="Minimum",Xh="MirrorPad",Yh="Mod",Sg="Multinomial",Jh="Multiply",_g="Neg",Cg="NotEqual",Ig="NonMaxSuppressionV3",Eg="NonMaxSuppressionV4",Tg="NonMaxSuppressionV5",jg="OnesLike",Zh="OneHot",Ag="Pack",ep="PadV2",$Ne="Pool",tp="Pow",np="Prelu",rp="Prod",Fk="RaggedGather",Pk="RaggedRange",Lk="RaggedTensorToTensor",ab="Range",zk="Real",ap="Reciprocal",sp="Relu",$g="Reshape",ip="ResizeNearestNeighbor",Rg="ResizeNearestNeighborGrad",op="ResizeBilinear",Dg="ResizeBilinearGrad",lp="Relu6",up="Reverse",cp="Round",dp="Rsqrt",Mg="ScatterNd",Og="TensorScatterUpdate",Fg="SearchSorted",Pg="Select",hp="Selu",Lg="Slice",pp="Sin",fp="Sinh",mp="Sign",gp="Sigmoid",yp="Softplus",xp="Sqrt",vp="Sum",zg="SpaceToBatchND",Bg="SplitV",bp="Softmax",sb="SparseFillEmptyRows",Ug="SparseReshape",ib="SparseSegmentMean",ob="SparseSegmentSum",Wg="SparseToDense",wp="SquaredDifference",lb="Square",ub="StaticRegexReplace",Vg="StridedSlice",cb="StringNGrams",db="StringSplit",hb="StringToHashBucketFast",Np="Sub",kp="Tan",Sp="Tanh",yc="Tile",Hg="TopK",Gg="Transform",dl="Transpose",pb="Unique",qg="Unpack",fb="UnsortedSegmentSum",RNe="UpperBound",Kg="ZerosLike",xc="Step",D1="FromPixels",Qg="RotateWithOffset",$d="_FusedMatMul",Rd="FusedConv2D",Dd="FusedDepthwiseConv2D";function nu(...e){le().getBool("IS_TEST")||le().getBool("PROD")||console.warn(...e)}function DNe(...e){le().getBool("IS_TEST")||le().getBool("PROD")||console.log(...e)}var dm=kA("kernelRegistry",()=>new Map),Zx=kA("gradRegistry",()=>new Map);function ev(e,t){let n=SA(e,t);return dm.get(n)}function FI(e){return Zx.get(e)}function M1(e){let t=dm.entries(),n=[];for(;;){let{done:r,value:a}=t.next();if(r)break;let[s,i]=a,[o]=s.split("_");o===e&&n.push(i)}return n}function mb(e){let{kernelName:t,backendName:n}=e,r=SA(t,n);dm.has(r)&&nu(`The kernel '${t}' for backend '${n}' is already registered`),dm.set(r,e)}function JG(e){let{kernelName:t}=e;Zx.has(t)&&le().getBool("DEBUG")&&nu(`Overriding the gradient for '${t}'`),Zx.set(t,e)}function MNe(e,t){let n=SA(e,t);if(!dm.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);dm.delete(n)}function ONe(e){if(!Zx.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);Zx.delete(e)}function FNe(e,t){M1(e).forEach(n=>{let r=Object.assign({},n,{backendName:t});mb(r)})}function SA(e,t){return`${t}_${e}`}var j={};gt(j,{arraysEqual:()=>Cl,arraysEqualWithNull:()=>PG,assert:()=>H,assertNonNegativeIntegerDimensions:()=>Ss,assertNonNull:()=>ih,assertShapesMatch:()=>Ia,bytesFromStringArray:()=>WG,bytesPerElement:()=>$1,checkConversionForErrors:()=>BG,clamp:()=>Jx,computeStrides:()=>qm,convertBackendValuesAndArrayBuffer:()=>wNe,createScalarValue:()=>WNe,createShuffledIndices:()=>yNe,decodeString:()=>O1,distSquared:()=>pNe,encodeString:()=>yb,fetch:()=>HNe,fingerPrint64:()=>UNe,flatten:()=>Vu,getArrayFromDType:()=>bA,getTypedArrayFromDType:()=>zG,hasEncodingLoss:()=>bNe,hexToLong:()=>gb,indexToLoc:()=>SNe,inferDtype:()=>qv,inferFromImplicitShape:()=>vNe,isBoolean:()=>VG,isFunction:()=>Wu,isInt:()=>lm,isNumber:()=>HG,isPromise:()=>Ik,isScalarShape:()=>fNe,isString:()=>gu,isTypedArray:()=>Ar,isValidDtype:()=>UG,locToIndex:()=>kNe,makeOnesTypedArray:()=>wA,makeZerosNestedTypedArray:()=>NNe,makeZerosTypedArray:()=>Ck,nearestDivisor:()=>R1,nearestLargerEven:()=>cNe,now:()=>tv,parseAxisParam:()=>hi,randUniform:()=>hNe,repeatedTry:()=>xNe,rightPad:()=>yx,shuffle:()=>FG,shuffleCombo:()=>uNe,sizeFromShape:()=>fn,sizeToSquarishShape:()=>gNe,squeezeShape:()=>LG,sum:()=>dNe,swap:()=>A1,tanh:()=>mNe,toNestedArray:()=>Tf,toTypedArray:()=>Bk});function ZG(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var aL=fc(G1e()),Wc=aL.default||aL;function gb(e){return Wc.fromString(e,!0,16)}var e8=gb("c3a5c85c97cb3127"),Lc=gb("b492b66fbe98f273"),ma=gb("9ae16a3b2f90404f");function PI(e){return e.xor(e.shru(47))}function t8(e,t,n){let r=e.slice(t,t+n);return Wc.fromBytes(Array.from(r),!0,!0)}function Cn(e,t){return t8(e,t,8)}function sL(e,t){return t8(e,t,4)}function jr(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function Au(e,t,n=gb("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function PNe(e,t,n,r,a,s){a=a.add(e),s=jr(s.add(a).add(r),21);let i=a;return a=a.add(t),a=a.add(n),s=s.add(jr(a,44)),[a.add(r),s.add(i)]}function Pw(e,t,n,r){return PNe(Cn(e,t),Cn(e,t+8),Cn(e,t+16),Cn(e,t+24),n,r)}function LNe(e,t=e.length){if(t>=8){let n=ma.add(t*2),r=Cn(e,0).add(ma),a=Cn(e,t-8),s=jr(a,37).mul(n).add(r),i=jr(r,25).add(a).mul(n);return Au(s,i,n)}if(t>=4){let n=ma.add(t*2),r=sL(e,0);return Au(r.shl(3).add(t),sL(e,t-4),n)}if(t>0){let n=e[0],r=e[t>>1],a=e[t-1],s=n+(r<<8),i=t+(a<<2);return PI(ma.mul(s).xor(e8.mul(i))).mul(ma)}return ma}function zNe(e,t=e.length){let n=ma.add(t*2),r=Cn(e,0).mul(Lc),a=Cn(e,8),s=Cn(e,t-8).mul(n),i=Cn(e,t-16).mul(ma);return Au(jr(r.add(a),43).add(jr(s,30)).add(i),r.add(jr(a.add(ma),18)).add(s),n)}function BNe(e,t=e.length){let n=ma.add(t*2),r=Cn(e,0).mul(ma),a=Cn(e,8),s=Cn(e,t-8).mul(n),i=Cn(e,t-16).mul(ma),o=jr(r.add(a),43).add(jr(s,30)).add(i),l=Au(o,r.add(jr(a.add(ma),18)).add(s),n),c=Cn(e,16).mul(n),u=Cn(e,24),h=o.add(Cn(e,t-32)).mul(n),p=l.add(Cn(e,t-24)).mul(n);return Au(jr(c.add(u),43).add(jr(h,30)).add(p),c.add(jr(u.add(r),18)).add(h),n)}function UNe(e,t=e.length){let n=Wc.fromNumber(81,!0);if(t<=32)return t<=16?LNe(e,t):zNe(e,t);if(t<=64)return BNe(e,t);let r=n,a=n.mul(Lc).add(113),s=PI(a.mul(ma).add(113)).mul(ma),i=[Wc.UZERO,Wc.UZERO],o=[Wc.UZERO,Wc.UZERO];r=r.mul(ma).add(Cn(e,0));let l=0,c=(t-1>>6)*64,u=c+(t-1&63)-63;do r=jr(r.add(a).add(i[0]).add(Cn(e,l+8)),37).mul(Lc),a=jr(a.add(i[1]).add(Cn(e,l+48)),42).mul(Lc),r=r.xor(o[1]),a=a.add(i[0]).add(Cn(e,l+40)),s=jr(s.add(o[0]),33).mul(Lc),i=Pw(e,l,i[1].mul(Lc),r.add(o[0])),o=Pw(e,l+32,s.add(o[1]),a.add(Cn(e,l+16))),[s,r]=[r,s],l+=64;while(l!==c);let h=Lc.add(s.and(255).shl(1));return l=u,o[0]=o[0].add(t-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),r=jr(r.add(a).add(i[0]).add(Cn(e,l+8)),37).mul(h),a=jr(a.add(i[1]).add(Cn(e,l+48)),42).mul(h),r=r.xor(o[1].mul(9)),a=a.add(i[0].mul(9).add(Cn(e,l+40))),s=jr(s.add(o[0]),33).mul(h),i=Pw(e,l,i[1].mul(h),r.add(o[0])),o=Pw(e,l+32,s.add(o[1]),a.add(Cn(e,l+16))),[s,r]=[r,s],Au(Au(i[0],o[0],h).add(PI(a).mul(e8)).add(s),Au(i[1],o[1],h).add(r),h)}function WNe(e,t){return t==="string"?yb(e):Bk([e],t)}function VNe(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Bk(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Vu(e)),le().getBool("DEBUG")&&BG(e,t),VNe(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){let n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function tv(){return le().platform.now()}function HNe(e,t){return le().platform.fetch(e,t)}function yb(e,t="utf-8"){return t=t||"utf-8",le().platform.encode(e,t)}function O1(e,t="utf-8"){return t=t||"utf-8",le().platform.decode(e,t)}function Ar(e){return le().platform.isTypedArray!=null?le().platform.isTypedArray(e):ZG(e)}function Vu(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||Ik(e)||e==null||Ar(e)&&n)t.push(e);else if(Array.isArray(e)||Ar(e))for(let r=0;r<e.length;++r)Vu(e[r],t,n);else{let r=-1;for(let a of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(a)&&(r=Math.max(r,Number(a)));for(let a=0;a<=r;a++)Vu(e[a],t,n)}return t}var GNe=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new KNe)}profileKernel(e,t,n){let r,a=()=>{r=n()},s,i=tv();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(a);else{a();for(let o of r)o.dataSync();s=Promise.resolve({kernelMs:tv()-i})}if(le().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<r.length;o++){let l=r[o];l.data().then(c=>{qNe(c,l.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:s.then(o=>o.kernelMs),extraInfo:s.then(o=>o.getExtraProfileInfo!=null?o.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:s}=e;n.forEach(i=>{Promise.all([i.data(),r,s]).then(o=>{this.logger.logKernelProfile(t,i,o[0],o[1],a,o[2])})})}};function qNe(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){let a=e[r];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}return!1}var KNe=class{logKernelProfile(e,t,n,r,a,s){let i=typeof r=="number"?yx(`${r}ms`,9):r.error,o=yx(e,25),l=t.rank,c=t.size,u=yx(t.shape.toString(),14),h="";for(let p in a){let f=a[p];if(f!=null){let g=f.shape||t.shape,m=g.length;h+=`${p}: ${m}D ${m>0?g:""} `}}console.log(`%c${o}	%c${i}	%c${l}D ${u}	%c${c}	%c${h}	%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function QNe(e,t,n){let r={},a={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){let c=e[l],u=c.inputs;for(let h in u){let p=u[h],f=!1;for(let g=0;g<t.length;g++)if(r[p.id]){c.outputs.forEach(m=>r[m.id]=!0),f=!0,a[c.id]=!0;break}if(f)break}}let s={};s[n.id]=!0;let i={};for(let l=e.length-1;l>=0;l--){let c=e[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(s[c.outputs[h].id]){for(let p in u)s[u[p].id]=!0,i[c.id]=!0;break}}let o=[];for(let l=0;l<e.length;l++){let c=e[l];if(a[c.id]&&i[c.id]){let u={};for(let p in c.inputs){let f=c.inputs[p];r[f.id]&&(u[p]=f)}let h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,o.push(h)}}return o}function XNe(e,t,n,r){for(let a=t.length-1;a>=0;a--){let s=t[a],i=[];if(s.outputs.forEach(l=>{let c=e[l.id];c!=null?i.push(c):i.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);let o=s.gradient(i);for(let l in s.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);let c=n(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);let u=s.inputs[l];if(!Cl(c.shape,u.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(e[u.id]==null)e[u.id]=c;else{let h=e[u.id];e[u.id]=r(h,c),h.dispose()}}}}var iL=20,My=3,gC=7;function YNe(e,t,n,r){let a=qm(t),s=JNe(e,t,n,a),i=t.length,o=C0(e,t,n,a,s),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function JNe(e,t,n,r){let a=fn(t),s=r[r.length-1],i=new Array(s).fill(0),o=t.length,l=n==="complex64"?Qy(e):e;if(o>1)for(let c=0;c<a/s;c++){let u=c*s;for(let h=0;h<s;h++)i[h]=Math.max(i[h],Ky(l[u+h],0,n).length)}return i}function Ky(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(gC))} + ${parseFloat(e[1].toFixed(gC))}j`:gu(e)?r=`'${e}'`:n==="bool"?r=n8(e):r=parseFloat(e.toFixed(gC)).toString(),yx(r,t)}function n8(e){return e===0?"false":"true"}function C0(e,t,n,r,a,s=!0){let i=n==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(n==="complex64"){let m=Qy(e);return[Ky(m[0],0,n)]}return n==="bool"?[n8(e[0])]:[e[0].toString()]}if(l===1){if(o>iL){let m=My*i,y=Array.from(e.slice(0,m)),x=Array.from(e.slice((o-My)*i,o*i));return n==="complex64"&&(y=Qy(y),x=Qy(x)),["["+y.map((v,b)=>Ky(v,a[b],n)).join(", ")+", ..., "+x.map((v,b)=>Ky(v,a[o-My+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?Qy(e):Array.from(e)).map((m,y)=>Ky(m,a[y],n)).join(", ")+"]"]}let c=t.slice(1),u=r.slice(1),h=r[0]*i,p=[];if(o>iL){for(let m=0;m<My;m++){let y=m*h,x=y+h;p.push(...C0(e.slice(y,x),c,n,u,a,!1))}p.push("...");for(let m=o-My;m<o;m++){let y=m*h,x=y+h;p.push(...C0(e.slice(y,x),c,n,u,a,m===o-1))}}else for(let m=0;m<o;m++){let y=m*h,x=y+h;p.push(...C0(e.slice(y,x),c,n,u,a,m===o-1))}let f=l===2?",":"";p[0]="["+(o>0?p[0]+f:"");for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+f;let g=`,
`;for(let m=2;m<l;m++)g+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(s?"":g),p}function Qy(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var hr=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=fn(e),n!=null){let r=n.length;H(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||bA(t,this.size),this.strides=qm(e)}set(e,...t){t.length===0&&(t=[0]),H(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(let r of e){if(r<0||r>=this.shape[t]){let a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}t++}let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Ei().makeTensor(this.values,this.shape,this.dtype)}},Ei=null,tf=null;function ZNe(e){Ei=e}function eke(e){tf=e}var Dt=class{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=fn(e),this.strides=qm(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return tf.buffer(this.shape,this.dtype,e)}bufferSync(){return tf.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return Tf(this.shape,e,this.dtype==="complex64")}arraySync(){return Tf(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();let e=Ei().read(this.dataId);if(this.dtype==="string"){let t=await e;try{return t.map(n=>O1(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ei().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=Ei().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>O1(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await Ei().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ei().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return tf.print(this,e)}clone(){return this.throwIfDisposed(),tf.clone(this)}toString(e=!1){let t=this.dataSync();return YNe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),tf.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),Ei().makeVariable(this,e,t,n)}};Object.defineProperty(Dt,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function ge(){return kA("Tensor",()=>Dt)}ge();var Md=class extends Dt{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Cl(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ei().disposeTensor(this),this.dataId=e.dataId,Ei().incRef(this,null)}dispose(){Ei().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Md,Symbol.hasInstance,{value:e=>e instanceof Dt&&e.assign!=null&&e.assign instanceof Function});var Ri={};gt(Ri,{assertTypesMatch:()=>s8,getTensorsInContainer:()=>_A,isTensorInList:()=>nke,makeTypesMatch:()=>qn});var LI;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(LI||(LI={}));var zI;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(zI||(zI={}));var BI;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(BI||(BI={}));var UI;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(UI||(UI={}));var WI;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(WI||(WI={}));var tke={float32:UI,int32:zI,bool:BI,complex64:WI};function Bs(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return tke[e][t]}function Uk(e){return Bs(e,"int32")}function r8(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function a8(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}function qn(e,t){if(e.dtype===t.dtype)return[e,t];let n=Bs(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function s8(e,t){H(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function nke(e,t){return t.some(n=>n.id===e.id)}function _A(e){let t=[];return i8(e,t,new Set),t}function i8(e,t,n){if(e==null)return;if(e instanceof Dt){t.push(e);return}if(!rke(e))return;let r=e;for(let a in r){let s=r[a];n.has(s)||(n.add(s),i8(s,t,n))}}function rke(e){return Array.isArray(e)||typeof e=="object"}function yC(e){return e.kernelName!=null}var oL=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},CA=class VI{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new oL}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let t=this.getSortedBackends();for(let n=0;n<t.length;n++){let r=t[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){let{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,r=1){return t in this.registryFactory?(nu(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:r},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;let{success:n,asyncInit:r}=this.initializeBackend(t);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new GNe(this.backendInstance),!0}setupRegisteredKernels(){M1(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){M1(t).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[t])})}initializeBackend(t){let n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{let r=n.factory();if(r&&!(r instanceof Gv)&&typeof r.then=="function"){let a=++this.pendingBackendInitId,s=r.then(i=>a<this.pendingBackendInitId?!1:(this.registry[t]=i,this.pendingBackendInit=null,!0)).catch(i=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,nu(`Initialization of backend ${t} failed`),nu(i.stack||i.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(r){return nu(`Initialization of backend ${t} failed`),nu(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){let t=this.getSortedBackends();for(let n=0;n<t.length;n++){let r=t[n],{success:a,asyncInit:s}=this.initializeBackend(r);if(s||a)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){let r=this.state.tensorInfo.get(n),a=r.backend,s=this.readSync(n),i=a.refCount(n);a.disposeData(n,!0),r.backend=t,t.move(n,s,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let r=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}let a;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(a),()=>(a=n(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(t,n,r){t();try{let a=r();return n(),a}catch(a){throw n(),a}}nextTensorId(){return VI.nextTensorId++}nextVariableId(){return VI.nextVariableId++}clone(t){let n=Y.runKernel(Oh,{x:t}),r={x:t},a=i=>({x:()=>{let o="float32",l={x:i},c={dtype:o};return Y.runKernel(yh,l,c)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],a,s,{}),n}runKernel(t,n,r){if(this.backendName==null&&this.backend,ev(t,this.backendName)==null)throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,r){let a=this.backend.numDataIds(),s=0;r.forEach(l=>{s+=l.dtype==="complex64"?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=a-n-s-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let n,r=[],a=this.isTapeOn(),s=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l,c=yC(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(yC(t)){let{kernelName:g,inputs:m,attrs:y}=t;this.backendName==null&&this.backend;let x=ev(g,this.backendName);H(x!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),o=()=>{let v=this.backend.numDataIds();l=x.kernelFunc({inputs:m,attrs:y,backend:this.backend});let b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,v,b);let w=b.map(k=>k.rank!=null?k:this.makeTensorFromTensorInfo(k));if(a){let k=this.getTensorsForGradient(g,m,w);r=this.saveTensorsForBackwardMode(k)}return w}}else{let{forwardFunc:g}=t,m=y=>{a&&(r=y.map(x=>this.keep(this.clone(x))))};o=()=>{let y=this.backend.numDataIds();l=this.tidy(()=>g(this.backend,m));let x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,y,x),x}}let{inputs:u,attrs:h}=t,p=yC(t)?null:t.backwardsFunc,f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(f=this.profiler.profileKernel(c,u,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),a&&this.addTapeNode(c,u,n,p,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(g=>u[g]!=null?u[g].shape:null),outputShapes:n.map(g=>g.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(t,n,r){let a=FI(t);if(a!=null){let s=a.inputsToSave||[],i=a.outputsToSave||[],o;a.saveAllInputs?(H(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(c=>n[c])):o=s.map(c=>n[c]);let l=r.filter((c,u)=>i[u]);return o.concat(l)}return[]}makeTensor(t,n,r,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;let s=t;r==="string"&&gu(t[0])&&(s=t.map(l=>yb(l)));let i=a.write(s,n,r),o=new Dt(n,r,i,this.nextTensorId());if(this.trackTensor(o,a),r==="string"){let l=this.state.tensorInfo.get(i),c=WG(s);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(t,n,r,a){r=r||"float32";let s={dataId:t,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,a)}makeTensorFromTensorInfo(t,n){let{dataId:r,shape:a,dtype:s}=t,i=new Dt(a,s,r,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(t,n=!0,r,a){r=r||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.cast(a));let s=new Md(t,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*$1(t.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r})),t instanceof Md||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;let n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){let r=t.size*$1(t.dtype);this.state.numBytes-=r}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(let t in this.state.registeredVariables){let n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){let t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;let n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(let a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,r,a,s,i){let o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:s},l=FI(t);l!=null&&(a=l.gradFunc),a!=null&&(o.gradient=c=>(c=c.map((u,h)=>{if(u==null){let p=r[h],f=Ck(p.size,p.dtype);return this.makeTensor(f,p.shape,p.dtype)}return u}),a(c.length>1?c:c[0],s,i))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){let n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){let n=_A(t),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){let i=this.state.activeScope.track[s];!i.kept&&!r.has(i.id)&&i.dispose()}let a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===a.id&&this.track(s)})}gradients(t,n,r,a=!1){if(H(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);let s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));H(s instanceof Dt,()=>"The result y returned by f() must be a tensor.");let i=QNe(this.state.activeTape,n,s);if(!a&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let o={};o[s.id]=r??ake(s.shape),XNe(o,i,c=>this.tidy(c),ske);let l=n.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(let u of c.saved)u.dispose()}),this.state.activeTape=null),{value:s,grads:l}})}customGrad(t){return H(Wu(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{H(n.every(o=>o instanceof Dt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r,a={};n.forEach((o,l)=>{a[l]=o});let s=(o,l)=>(r=t(...n,l),H(r.value instanceof Dt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),H(Wu(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(o,l)=>{let c=r.gradFunc(o,l),u=Array.isArray(c)?c:[c];H(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),H(u.every(p=>p instanceof Dt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let h={};return u.forEach((p,f)=>{h[f]=()=>p}),h};return this.runKernelFunc({forwardFunc:s,backwardsFunc:i,inputs:a})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){let n=tv(),r=await this.backend.time(t);return r.wallMs=tv()-n,r}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new oL;for(let t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};CA.nextTensorId=0;CA.nextVariableId=0;function ake(e){let t=wA(fn(e),"float32");return Y.makeTensor(t,e,"float32")}function o8(){let e=KG();if(e._tfengine==null){let t=new qG(e);e._tfengine=new CA(t)}return ENe(e._tfengine.ENV),ZNe(()=>e._tfengine),e._tfengine}var Y=o8();function ske(e,t){let n={a:e,b:t};return Y.runKernel(mc,n)}var xb={};gt(xb,{isBrowser:()=>l8,isMobile:()=>lke,mockIsMobile:()=>oke});function ike(){return typeof navigator<"u"&&navigator!=null}var HI;function oke(e){HI=e}function lke(e){if(HI!==void 0)return HI;if(e||ike()){if(e||(e=navigator),e.product==="ReactNative")return!0;let t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){let n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function l8(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Ua=le();Ua.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Ua.registerFlag("IS_BROWSER",()=>l8());Ua.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Ua.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Ua.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Ua.registerFlag("PROD",()=>!1);Ua.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ua.getBool("DEBUG"));Ua.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Ua.registerFlag("IS_TEST",()=>!1);Ua.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Ua.getBool("DEBUG"));Ua.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Ua.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Ua.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function $o(e,t){let n=e;if(Ar(e))return t==="string"?[]:[e.length];if(r8(e)){let a=e.channels||"RGBA";return[e.height,e.width*a.length]}else if(a8(e))return[e.buffer.size/(t==null?4:$1(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||Ar(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&le().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&u8(e,r,[]),r}function u8(e,t,n){if(n=n||[],!Array.isArray(e)&&!Ar(e)){H(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}H(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),H(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);let r=t.slice(1);for(let a=0;a<e.length;++a)u8(e[a],r,n.concat(a))}function lL(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function z(e,t,n,r="numeric"){if(e instanceof ge())return lL(r,e.dtype,t,n),e;let a=qv(e);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),lL(r,a,t,n),e==null||!Ar(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){let o=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${o}'`)}let s=$o(e,a);!Ar(e)&&!Array.isArray(e)&&(e=[e]);let i=a!=="string"?Bk(e,a):Vu(e,[],!0);return Y.makeTensor(i,s,a)}function nv(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((a,s)=>z(a,`${t}[${s}]`,n,r))}var IA="__op";function J(e){let t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+IA;let a=(...s)=>{Y.startScope(n);try{let i=r(...s);return Ik(i)&&console.error("Cannot return a Promise inside of tidy."),Y.endScope(i),i}catch(i){throw Y.endScope(null),i}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}function uke(e,t){let n=z(e,"real","complex"),r=z(t,"imag","complex");Ia(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);let a={real:n,imag:r};return Y.runKernel(Ek,a)}var Nl=J({complex_:uke});function vc(e,t,n,r){if(r==null)r=qv(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(a8(e)||r8(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return Y.backend.createTensorFromGPUData(e,t||n,r)}if(!Ar(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Ss(t);let a=fn(t),s=fn(n);H(a===s,()=>`Based on the provided shape, [${t}], the tensor should have ${a} values but has ${s}`);for(let i=0;i<n.length;++i){let o=n[i],l=i===n.length-1?o!==fn(t.slice(i)):!0;H(n[i]===t[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Ar(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?Bk(e,r):Vu(e,[],!0),Y.makeTensor(e,t,r)}function va(e,t,n){let r=$o(e,n);return vc(e,t,r,n)}var Od={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Il=class c8{static join(t){return new c8(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>Ar(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){let a=t[r];r!==t.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let s=n+a.byteLength;this.shards.push({buffer:a,start:n,end:s}),n=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);let r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);let a=n-t,s=new ArrayBuffer(a),i=new Uint8Array(s),o=0;for(let l=r;l<this.shards.length;l++){let c=this.shards[l],u=t+o-c.start,h=o,p=Math.min(n,c.end)-c.start,f=new Uint8Array(c.buffer,u,p-u);if(i.set(f,h),o+=f.length,n<c.end)break}return s}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(a){return t<a.start?-1:t>=a.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let r=cke(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}};function cke(e,t){let n=0,r=e.length;for(;n<=r;){let a=Math.floor((r-n)/2)+n,s=t(e[a]);if(s===0)return a;s<0?r=a:n=a+1}return-1}function dke(){le().set("PROD",!0)}function hke(){le().set("DEBUG",!0)}function pke(){le().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function d8(e){le().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function fke(){Y.disposeVariables()}function Ys(){return Y}function GI(){return Y.memory()}function mke(e){return Y.profile(e)}function te(e,t){return Y.tidy(e,t)}function mt(e){_A(e).forEach(t=>t.dispose())}function vr(e){return Y.keep(e)}function gke(e){return Y.time(e)}function yke(e){return Y.setBackend(e)}function xke(){return Y.ready()}function h8(){return Y.backendName}function vke(e){Y.removeBackend(e)}function bke(e){return Y.findBackend(e)}function wke(e){return Y.findBackendFactory(e)}function Wk(e,t,n=1){return Y.registerBackend(e,t,n)}function EA(){return Y.backend}function Nke(e,t){le().setPlatform(e,t)}var Hu=4;async function kke(e,t){let n=[],r=[],a=Array.isArray(e)?e.map(i=>i.name):Object.keys(e);for(let i=0;i<a.length;++i){let o=a[i],l=Array.isArray(e)?e[i].tensor:e[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);let c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){let u=new Promise(async h=>{let p=await l.bytes(),f=p.reduce((y,x)=>y+x.length,0)+Hu*p.length,g=new Uint8Array(f),m=0;for(let y=0;y<p.length;y++){let x=p[y],v=new Uint8Array(new Uint32Array([x.length]).buffer);g.set(v,m),m+=Hu,g.set(x,m),m+=x.length}h(g)});r.push(u)}else r.push(l.data());t!=null&&(c.group=t),n.push(c)}let s=await Promise.all(r);return{data:Cke(s),specs:n}}function p8(e,t){let n=new Il(e),r={},a=0;for(let s of t){let i=Ske(s,(o,l)=>n.slice(a+o,a+l));r[s.name]=f8(s,n.slice(a,a+i)),a+=i}return r}function Ske(e,t){let n=fn(e.shape),r;if("quantization"in e){let a=e.quantization;r=Od[a.dtype]}else if(e.dtype==="string"){let a=0;for(let s=0;s<n;s++)a+=Hu+new Uint32Array(t(a,a+Hu))[0];return a}else r=Od[e.dtype];return n*r}async function _ke(e,t){let n=fn(e.shape),r;if("quantization"in e){let a=e.quantization;r=Od[a.dtype]}else if(e.dtype==="string"){let a=0;for(let s=0;s<n;s++)a+=Hu+new Uint32Array(await t(a,a+Hu))[0];return a}else r=Od[e.dtype];return n*r}function f8(e,t){let n=e.name,r=e.dtype,a=e.shape,s=fn(a),i,o=0;if("quantization"in e){let l=e.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${e.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${e.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let c=Od[l.dtype],u=l.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(u.length);for(let h=0;h<u.length;h++){let p=u[h];i[h]=p*l.scale+l.min}}else if(l.dtype==="float16")i=Rke()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(u.length);for(let h=0;h<u.length;h++){let p=u[h];i[h]=Math.round(p*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);o+=s*c}else if(r==="string"){let l=fn(e.shape);i=[];for(let c=0;c<l;c++){let u=new Uint32Array(t.slice(o,o+Hu))[0];o+=Hu;let h=new Uint8Array(t.slice(o,o+u));i.push(h),o+=u}}else{let l=Od[r];if(r==="float32")i=new Float32Array(t);else if(r==="int32")i=new Int32Array(t);else if(r==="bool")i=new Uint8Array(t);else if(r==="complex64"){i=new Float32Array(t);let c=new Float32Array(i.length/2),u=new Float32Array(i.length/2);for(let g=0;g<c.length;g++)c[g]=i[g*2],u[g]=i[g*2+1];let h=va(c,a,"float32"),p=va(u,a,"float32"),f=Nl(h,p);return h.dispose(),p.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);o+=s*l}return va(i,a,r)}async function uL(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){let{done:a,value:s}=await e.read();if(a&&s==null){let o=n-r.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}let i=new Uint8Array(r.length+s.byteLength);i.set(r,0),i.set(new Uint8Array(s),r.length),r=i}return r.buffer}async function m8(e,t){let n={},r=e.getReader(),a=new ArrayBuffer(0);for(let s of t){let i=await _ke(s,async(c,u)=>(a=await uL(r,a,u),a.slice(c,u)));a=await uL(r,a,i);let o=a.slice(0,i);a=a.slice(i);let l=f8(s,o);if(n[s.name]=l,h8()==="webgpu"){let c=EA();"uploadToGPU"in c&&fn(l.shape)>=le().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return n}function Cke(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach(s=>{if(t+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});let r=new Uint8Array(t),a=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),a),a+=s.byteLength}),r.buffer}var TA=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function cL(e){return TA?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function Ike(e){if(TA)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function Eke(e){if(TA){let r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function Tke(e){return Il.join(e)}function dL(e){let t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);let n=e.split(t);return n[n.length-1]}function g8(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function y8(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function jA(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),y8(e,n,r)}function vb(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:cL(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:cL(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new Il(e.weightData).byteLength}}function qI(e){let t=[];for(let n of e)t.push(...n.weights);return t}function jke(){let e=n=>{let r=n<<13,a=0;for(;!(r&8388608);)a-=8388608,r<<=1;return r&=-8388609,a+=947912704,r|a},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function Ake(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function $ke(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function Rke(){let e=jke(),t=Ake(),n=$ke();return r=>{let a=new ArrayBuffer(4*r.length),s=new Uint32Array(a);for(let i=0;i<r.length;i++){let o=r[i],l=e[n[o>>10]+(o&1023)]+t[o>>10];s[i]=l}return new Float32Array(a)}}var Us=class vi{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return vi.instance==null&&(vi.instance=new vi),vi.instance}static registerSaveRouter(t){vi.getInstance().saveRouters.push(t)}static registerLoadRouter(t){vi.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return vi.getHandlers(t,"save")}static getLoadHandlers(t,n){return vi.getHandlers(t,"load",n)}static getHandlers(t,n,r){let a=[];return(n==="load"?vi.getInstance().loadRouters:vi.getInstance().saveRouters).forEach(s=>{let i=s(t,r);i!==null&&a.push(i)}),a}},Dke=e=>Us.registerSaveRouter(e),Mke=e=>Us.registerLoadRouter(e),Oke=e=>Us.getSaveHandlers(e),Fke=(e,t)=>Us.getLoadHandlers(e,t),KI="tensorflowjs",QI=1,Jc="models_store",yu="model_info_store";function x8(){if(!le().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function XI(e){let t=e.result;t.createObjectStore(Jc,{keyPath:"modelPath"}),t.createObjectStore(yu,{keyPath:"modelPath"})}var Fd=class{constructor(e){if(this.indexedDB=x8(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,r)=>{let a=this.indexedDB.open(KI,QI);a.onupgradeneeded=()=>XI(a),a.onsuccess=()=>{let s=a.result;if(t==null){let i=s.transaction(Jc,"readonly"),o=i.objectStore(Jc).get(this.modelPath);o.onsuccess=()=>{if(o.result==null)return s.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));n(o.result.modelArtifacts)},o.onerror=l=>(s.close(),r(o.error)),i.oncomplete=()=>s.close()}else{t.weightData=Il.join(t.weightData);let i=vb(t),o=s.transaction(yu,"readwrite"),l=o.objectStore(yu),c;try{c=l.put({modelPath:this.modelPath,modelArtifactsInfo:i})}catch(h){return r(h)}let u;c.onsuccess=()=>{u=s.transaction(Jc,"readwrite");let h=u.objectStore(Jc),p;try{p=h.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:i})}catch(f){return r(f)}p.onsuccess=()=>n({modelArtifactsInfo:i}),p.onerror=f=>{l=o.objectStore(yu);let g=l.delete(this.modelPath);g.onsuccess=()=>(s.close(),r(p.error)),g.onerror=m=>(s.close(),r(p.error))}},c.onerror=h=>(s.close(),r(c.error)),o.oncomplete=()=>{u==null?s.close():u.oncomplete=()=>s.close()}}},a.onerror=s=>r(a.error)})}};Fd.URL_SCHEME="indexeddb://";var v8=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fd.URL_SCHEME)?Pke(e.slice(Fd.URL_SCHEME.length)):null;Us.registerSaveRouter(v8);Us.registerLoadRouter(v8);function Pke(e){return new Fd(e)}function Lke(e){return e.startsWith(Fd.URL_SCHEME)?e.slice(Fd.URL_SCHEME.length):e}var zke=class{constructor(){this.indexedDB=x8()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(KI,QI);n.onupgradeneeded=()=>XI(n),n.onsuccess=()=>{let r=n.result,a=r.transaction(yu,"readonly"),s=a.objectStore(yu).getAll();s.onsuccess=()=>{let i={};for(let o of s.result)i[o.modelPath]=o.modelArtifactsInfo;e(i)},s.onerror=i=>(r.close(),t(s.error)),a.oncomplete=()=>r.close()},n.onerror=r=>t(n.error)})}async removeModel(e){return e=Lke(e),new Promise((t,n)=>{let r=this.indexedDB.open(KI,QI);r.onupgradeneeded=()=>XI(r),r.onsuccess=()=>{let a=r.result,s=a.transaction(yu,"readwrite"),i=s.objectStore(yu),o=i.get(e),l;o.onsuccess=()=>{if(o.result==null)return a.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{let c=i.delete(e),u=()=>{l=a.transaction(Jc,"readwrite");let h=l.objectStore(Jc).delete(e);h.onsuccess=()=>t(o.result.modelArtifactsInfo),h.onerror=p=>n(o.error)};c.onsuccess=u,c.onerror=h=>(u(),a.close(),n(o.error))}},o.onerror=c=>(a.close(),n(o.error)),s.oncomplete=()=>{l==null?a.close():l.oncomplete=()=>a.close()}},r.onerror=a=>n(r.error)})}},il="/",nf="tensorflowjs_models",b8="info",Bke="model_topology",Uke="weight_specs",Wke="weight_data",Vke="model_metadata";function w8(e){return{info:[nf,e,b8].join(il),topology:[nf,e,Bke].join(il),weightSpecs:[nf,e,Uke].join(il),weightData:[nf,e,Wke].join(il),modelMetadata:[nf,e,Vke].join(il)}}function N8(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function Hke(e){let t=e.split(il);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(il)}function Gke(e){return e.startsWith(Pd.URL_SCHEME)?e.slice(Pd.URL_SCHEME.length):e}var Pd=class{constructor(e){if(!le().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=w8(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=vb(e),a=Il.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,Ike(a));let s={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(s)),{modelArtifactsInfo:r}}catch{throw N8(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;let a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){let i=JSON.parse(a);t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,i.signature!=null&&(t.signature=i.signature),i.userDefinedMetadata!=null&&(t.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(t.modelInitializer=i.modelInitializer),i.initializerSignature!=null&&(t.initializerSignature=i.initializerSignature),i.trainingConfig!=null&&(t.trainingConfig=i.trainingConfig)}let s=this.LS.getItem(this.keys.weightData);if(s==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=Eke(s),t}};Pd.URL_SCHEME="localstorage://";var k8=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Pd.URL_SCHEME)?qke(e.slice(Pd.URL_SCHEME.length)):null;Us.registerSaveRouter(k8);Us.registerLoadRouter(k8);function qke(e){return new Pd(e)}var Kke=class{constructor(){H(le().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),H(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=nf+il,n=il+b8;for(let r=0;r<this.LS.length;++r){let a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(n)){let s=Hke(a);e[s]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=Gke(e);let t=w8(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);let n=JSON.parse(this.LS.getItem(t.info));return N8(t),n}},jf="://",Gu=class Hl{constructor(){this.managers={}}static getInstance(){return Hl.instance==null&&(Hl.instance=new Hl),Hl.instance}static registerManager(t,n){H(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(jf)&&(t=t.slice(0,t.indexOf(jf))),H(t.length>0,()=>"scheme must not be an empty string.");let r=Hl.getInstance();H(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){let n=Hl.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(Hl.getInstance().managers)}};function I0(e){if(e.indexOf(jf)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Gu.getSchemes().join(",")}`);return{scheme:e.split(jf)[0],path:e.split(jf)[1]}}async function S8(e,t,n=!1){H(e!==t,()=>`Old path and new path are the same: '${e}'`);let r=Us.getLoadHandlers(e);H(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),H(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);let a=r[0],s=Us.getSaveHandlers(t);H(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),H(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);let i=s[0],o=I0(e).scheme,l=I0(e).path,c=o===I0(e).scheme,u=await a.load();n&&c&&await Gu.getManager(o).removeModel(l);let h=await i.save(u);return n&&!c&&await Gu.getManager(o).removeModel(l),h.modelArtifactsInfo}async function Qke(){let e=Gu.getSchemes(),t={};for(let n of e){let r=await Gu.getManager(n).listModels();for(let a in r){let s=n+jf+a;t[s]=r[a]}}return t}async function Xke(e){let t=I0(e);return Gu.getManager(t.scheme).removeModel(t.path)}async function Yke(e,t){return S8(e,t,!1)}async function Jke(e,t){return S8(e,t,!0)}var Zke=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!le().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",n=>{if(n.source===window&&n.data.name===this.messageName){n.stopPropagation();let r=this.functionRefs[n.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return ZG(e)}};if(le().get("IS_BROWSER")){le().setPlatform("browser",new Zke);try{Gu.registerManager(Pd.URL_SCHEME,new Kke)}catch{}try{Gu.registerManager(Fd.URL_SCHEME,new zke)}catch{}}var eSe={importFetch:()=>q1e()},xC,tSe=class{constructor(){this.util=K1e(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return le().global.fetch!=null?le().global.fetch(e,t):(xC==null&&(xC=eSe.importFetch()),xC(e,t))}now(){let e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}};le().get("IS_NODE")&&!le().get("IS_BROWSER")&&le().setPlatform("node",new tSe);function jt(e,t="float32",n){return t=t||"float32",Ss(e),new hr(e,t,n)}function nSe(e,t){let n=z(e,"x","cast");if(!UG(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:n},a={dtype:t};return Y.runKernel(yh,r,a)}var Se=J({cast_:nSe});function rSe(e){let t={x:z(e,"x","clone","string_or_numeric")};return Y.runKernel(Oh,t)}var ko=J({clone_:rSe});function AA(e,t=!1){console.log(e.toString(t))}o8();var aSe={buffer:jt,cast:Se,clone:ko,print:AA};eke(aSe);function sSe(e,t){let n=z(e,"a","add"),r=z(t,"b","add");[n,r]=qn(n,r);let a={a:n,b:r};return Y.runKernel(mc,a)}var me=J({add_:sSe});function iSe(e,t){let n=z(e,"a","floorDiv"),r=z(t,"b","floorDiv");[n,r]=qn(n,r);let a={a:n,b:r};return Y.runKernel(Rh,a)}var Vk=J({floorDiv_:iSe});function oSe(e,t){let n=z(e,"a","div"),r=z(t,"b","div");if([n,r]=qn(n,r),n.dtype==="int32"&&r.dtype==="int32")return Vk(n,r);let a={a:n,b:r},s={};return Y.runKernel(Ih,a,s)}var ze=J({div_:oSe});function lSe(e,t){let n=z(e,"a","mul"),r=z(t,"b","mul");[n,r]=qn(n,r);let a={a:n,b:r};return Y.runKernel(Jh,a)}var Z=J({mul_:lSe});function uSe(e){let t=z(e,"x","abs");if(t.dtype==="complex64"){let n={x:t};return Y.runKernel(Yv,n)}else{let n={x:t};return Y.runKernel(Km,n)}}var ur=J({abs_:uSe});function cSe(e){let t={x:z(e,"x","acos")};return Y.runKernel(oh,t)}var $A=J({acos_:cSe});function dSe(e){let t={x:z(e,"x","acosh")};return Y.runKernel(lh,t)}var RA=J({acosh_:dSe});function hSe(e){H(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),H(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);let t=e.map((a,s)=>z(a,`tensors${s}`,"addN")),n=t[0];t.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(a=>{if(!Cl(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let r=t;return Y.runKernel(uh,r)}var _8=J({addN_:hSe});function pSe(e,t=null,n=!1){let r={x:z(e,"x","all","bool")},a={axis:t,keepDims:n};return Y.runKernel(Qm,r,a)}var Hk=J({all_:pSe});function fSe(e,t=null,n=!1){let r={x:z(e,"x","any","bool")},a={axis:t,keepDims:n};return Y.runKernel(Xm,r,a)}var rv=J({any_:fSe});function mSe(e,t=0){let n={x:z(e,"x","argMax")},r={axis:t};return Y.runKernel(Ym,n,r)}var Ld=J({argMax_:mSe});function gSe(e,t=0){let n={x:z(e,"x","argMin")},r={axis:t};return Y.runKernel(Jm,n,r)}var DA=J({argMin_:gSe});function ySe(e){let t={x:z(e,"x","asin")};return Y.runKernel(ch,t)}var MA=J({asin_:ySe});function xSe(e){let t={x:z(e,"x","asinh")};return Y.runKernel(dh,t)}var OA=J({asinh_:xSe});function vSe(e){let t={x:z(e,"x","atan")};return Y.runKernel(hh,t)}var FA=J({atan_:vSe});function bSe(e,t){let n=z(e,"a","atan2"),r=z(t,"b","atan2");[n,r]=qn(n,r);let a={a:n,b:r};return Y.runKernel(fh,a)}var PA=J({atan2_:bSe});function wSe(e){let t={x:z(e,"x","atanh")};return Y.runKernel(ph,t)}var LA=J({atanh_:wSe});function NSe(e,t,n,r,a="NHWC",s){let i=e[3],o=[...t,i],l=E8(a);return bb(e,o,n,s,r,null,null,l)}function C8(e,t,n,r,a,s,i="channelsLast"){let[o,l]=av(t),c;if(i==="channelsLast")c=[o,l,e[3],e[3]];else if(i==="channelsFirst")c=[o,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${i}`);return bb(e,c,n,r,a,s,!1,i)}function kSe(e,t,n,r,a,s,i="NDHWC"){let[o,l,c]=YI(t),u,h;if(i==="NDHWC")h="channelsLast",u=[o,l,c,e[4],e[4]];else if(i==="NCDHW")h="channelsFirst",u=[o,l,c,e[1],e[1]];else throw new Error(`Unknown dataFormat ${i}`);return I8(e,u,n,r,a,!1,h,s)}function bb(e,t,n,r,a,s,i=!1,o="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,h]=e;else if(o==="channelsFirst")[l,h,c,u]=e;else throw new Error(`Unknown dataFormat ${o}`);let[p,f,,g]=t,[m,y]=av(n),[x,v]=av(r),b=Af(p,x),w=Af(f,v),{padInfo:k,outHeight:I,outWidth:C}=CSe(a,c,u,m,y,b,w,s,o),S=i?g*h:g,E;return o==="channelsFirst"?E=[l,S,I,C]:o==="channelsLast"&&(E=[l,I,C,S]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:h,outHeight:I,outWidth:C,outChannels:S,padInfo:k,strideHeight:m,strideWidth:y,filterHeight:p,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:x,dilationWidth:v,inShape:e,outShape:E,filterShape:t}}function I8(e,t,n,r,a,s=!1,i="channelsLast",o){let[l,c,u,h,p]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,h,p]=e;else if(i==="channelsFirst")[l,p,c,u,h]=e;else throw new Error(`Unknown dataFormat ${i}`);let[f,g,m,,y]=t,[x,v,b]=YI(n),[w,k,I]=YI(r),C=Af(f,w),S=Af(g,k),E=Af(m,I),{padInfo:T,outDepth:$,outHeight:_,outWidth:M}=ISe(a,c,u,h,x,v,b,C,S,E,o),L=s?y*p:y,U;return i==="channelsFirst"?U=[l,L,$,_,M]:i==="channelsLast"&&(U=[l,$,_,M,L]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:h,inChannels:p,outDepth:$,outHeight:_,outWidth:M,outChannels:L,padInfo:T,strideDepth:x,strideHeight:v,strideWidth:b,filterDepth:f,filterHeight:g,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:S,effectiveFilterWidth:E,dilationDepth:w,dilationHeight:k,dilationWidth:I,inShape:e,outShape:U,filterShape:t}}function SSe(e,t,n,r,a){r==null&&(r=zA(e,t,n));let s=e[0],i=e[1],o=sv((s-t+2*r)/n+1,a),l=sv((i-t+2*r)/n+1,a);return[o,l]}function _Se(e,t,n,r,a,s){a==null&&(a=zA(e,t[0],r[0]));let i=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*a>=t[o]&&(i[o]=sv((e[o]-t[o]+2*a)/r[o]+1,s));return i}function zA(e,t,n,r=1){let a=Af(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function av(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function YI(e){return typeof e=="number"?[e,e,e]:e}function Af(e,t){return t<=1?e:e+(e-1)*(t-1)}function CSe(e,t,n,r,a,s,i,o,l){let c,u,h;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};let p=SSe([t,n],s,r,e,o);u=p[0],h=p[1]}else if(e==="same"){u=Math.ceil(t/r),h=Math.ceil(n/a);let p=Math.max(0,(u-1)*r+s-t),f=Math.max(0,(h-1)*a+i-n),g=Math.floor(p/2),m=p-g,y=Math.floor(f/2),x=f-y;c={top:g,bottom:m,left:y,right:x,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-s+1)/r),h=Math.ceil((n-i+1)/a);else if(typeof e=="object"){let p=l==="channelsLast"?e[1][0]:e[2][0],f=l==="channelsLast"?e[1][1]:e[2][1],g=l==="channelsLast"?e[2][0]:e[3][0],m=l==="channelsLast"?e[2][1]:e[3][1];c={top:p,bottom:f,left:g,right:m,type:p===0&&f===0&&g===0&&m===0?"VALID":"EXPLICIT"},u=sv((t-s+p+f)/r+1,o),h=sv((n-i+g+m)/a+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:u,outWidth:h}}function ISe(e,t,n,r,a,s,i,o,l,c,u){let h,p,f,g;if(e==="valid"&&(e=0),typeof e=="number"){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};let m=_Se([t,n,r,1],[o,l,c],1,[a,s,i],e,u);p=m[0],f=m[1],g=m[2]}else if(e==="same"){p=Math.ceil(t/a),f=Math.ceil(n/s),g=Math.ceil(r/i);let m=(p-1)*a+o-t,y=(f-1)*s+l-n,x=(g-1)*i+c-r,v=Math.floor(m/2),b=m-v,w=Math.floor(y/2),k=y-w,I=Math.floor(x/2),C=x-I;h={top:w,bottom:k,left:I,right:C,front:v,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:h,outDepth:p,outHeight:f,outWidth:g}}function sv(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function qu(e){let[t,n,r]=av(e);return t===1&&n===1&&r===1}function Lo(e,t){return qu(e)||qu(t)}function zd(e){return av(e).every(t=>t>0)}function E8(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Ea(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")H(lm(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(a=>{H(lm(a),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${a}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}function ESe(e,t){let n={x:z(e,"x","reshape","string_or_numeric")},r={shape:t};return Y.runKernel($g,n,r)}var ee=J({reshape_:ESe});function TSe(e,t,n,r,a){let s=z(e,"x","avgPool","float32"),i=1;H(Lo(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let o=s,l=!1;s.rank===3&&(l=!0,o=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]])),H(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Ea("avgPool",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},h=Y.runKernel(mh,c,u);return h=Se(h,s.dtype),l?ee(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var El=J({avgPool_:TSe});function jSe(e,t,n,r,a,s="NDHWC"){let i=z(e,"x","avgPool3d","float32"),o=i,l=!1;i.rank===4&&(l=!0,o=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),H(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),H(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),H(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Ea("avgPool3d",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:s},h=Y.runKernel(Zm,c,u);return h=Se(h,o.dtype),l?ee(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var BA=J({avgPool3d_:jSe});function ASe(e,t=0){H(e.length>=1,()=>"Pass at least one tensor to concat");let n=nv(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return ko(n[0]);let r=n,a={axis:t};return Y.runKernel(rg,r,a)}var wn=J({concat_:ASe});function $Se(e,t,n=!1,r=!1){let a=z(e,"a","matMul"),s=z(t,"b","matMul");[a,s]=qn(a,s);let i={a,b:s},o={transposeA:n,transposeB:r};return Y.runKernel(gh,i,o)}var _t=J({matMul_:$Se});function RSe(e){let t={x:z(e,"x","sigmoid","float32")};return Y.runKernel(gp,t)}var si=J({sigmoid_:RSe});function DSe(e,t,n){let r=z(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let a={x:r},s={begin:t,size:n};return Y.runKernel(Lg,a,s)}var Ut=J({slice_:DSe});function MSe(e){let t={x:z(e,"x","tanh","float32")};return Y.runKernel(Sp,t)}var Ku=J({tanh_:MSe});function OSe(e,t,n,r,a,s){let i=z(e,"forgetBias","basicLSTMCell"),o=z(t,"lstmKernel","basicLSTMCell"),l=z(n,"lstmBias","basicLSTMCell"),c=z(r,"data","basicLSTMCell"),u=z(a,"c","basicLSTMCell"),h=z(s,"h","basicLSTMCell"),p=wn([c,h],1),f=_t(p,o),g=me(f,l),m=g.shape[0],y=g.shape[1]/4,x=[m,y],v=Ut(g,[0,0],x),b=Ut(g,[0,y],x),w=Ut(g,[0,y*2],x),k=Ut(g,[0,y*3],x),I=me(Z(si(v),Ku(b)),Z(u,si(me(i,w)))),C=Z(Ku(I),si(k));return[I,C]}var T8=J({basicLSTMCell_:OSe});function FSe(e,t,n){let r=z(e,"x","batchToSpaceND"),a=t.reduce((o,l)=>o*l);H(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),H(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),H(r.shape[0]%a===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${a}`);let s={x:r},i={blockShape:t,crops:n};return Y.runKernel(eg,s,i)}var wb=J({batchToSpaceND_:FSe});function PSe(e){let t;return e.rank===0||e.rank===1?t=ee(e,[1,1,1,e.size]):e.rank===2?t=ee(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=ee(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}function LSe(e,t,n,r,a,s){s==null&&(s=.001);let i=z(e,"x","batchNorm"),o=z(t,"mean","batchNorm"),l=z(n,"variance","batchNorm"),c;a!=null&&(c=z(a,"scale","batchNorm"));let u;r!=null&&(u=z(r,"offset","batchNorm")),H(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),H(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),H(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let h={x:PSe(i),scale:c,offset:u,mean:o,variance:l},p={varianceEpsilon:s},f=Y.runKernel(Dh,h,p);return ee(f,i.shape)}var _p=J({batchNorm_:LSe});function zSe(e,t,n,r,a,s){let i=z(e,"x","batchNorm"),o=z(t,"mean","batchNorm"),l=z(n,"variance","batchNorm"),c;a!=null&&(c=z(a,"scale","batchNorm"));let u;return r!=null&&(u=z(r,"offset","batchNorm")),H(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),H(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),H(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&H(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&H(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),_p(i,o,l,u,c,s)}var UA=J({batchNorm2d_:zSe});function BSe(e,t,n,r,a,s){let i=z(e,"x","batchNorm"),o=z(t,"mean","batchNorm"),l=z(n,"variance","batchNorm"),c;a!=null&&(c=z(a,"scale","batchNorm"));let u;return r!=null&&(u=z(r,"offset","batchNorm")),H(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),H(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),H(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&H(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&H(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),_p(i,o,l,u,c,s)}var WA=J({batchNorm3d_:BSe});function USe(e,t,n,r,a,s){let i=z(e,"x","batchNorm"),o=z(t,"mean","batchNorm"),l=z(n,"variance","batchNorm"),c;a!=null&&(c=z(a,"scale","batchNorm"));let u;return r!=null&&(u=z(r,"offset","batchNorm")),H(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),H(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),H(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&H(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&H(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),_p(i,o,l,u,c,s)}var VA=J({batchNorm4d_:USe});function WSe(e,t,n){let r=z(e,"x","bincount"),a=z(t,"weights","bincount");H(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),H(n>=0,()=>`size must be non-negative, but got ${n}.`),H(a.size===r.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`);let s={x:r,weights:a},i={size:n};return Y.runKernel(tg,s,i)}var HA=J({bincount_:WSe});function VSe(e,t){let n=z(e,"x","bitwiseAnd"),r=z(t,"y","bitwiseAnd");if(!Cl(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);let a={a:n,b:r};return Y.runKernel(ng,a)}var j8=J({bitwiseAnd_:VSe});function HSe(e,t){let n=z(e,"s0","broadcastArgs","int32"),r=z(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);let a={s0:n,s1:r};return Y.runKernel(Xv,a)}var A8=J({broadcastArgs_:HSe});function GSe(e,t){let n=z(e,"broadcastTo","x"),r=n.shape;if(Ss(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let l=n.shape.slice();for(;l.length<t.length;)l.unshift(1);n=ee(n,l)}let a=n.shape,s=Array.from(t);for(let l=t.length-1;l>=0;l--)if(a[l]===t[l])s[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(s.map((l,c)=>l>1?c:-1).filter(l=>l>=0).length===0)return ko(n);let i={x:n},o={reps:s};return Y.runKernel(yc,i,o)}var fd=J({broadcastTo_:GSe});function qSe(e){let t={x:z(e,"x","ceil","float32")};return Y.runKernel(xh,t)}var GA=J({ceil_:qSe});function xs(e,t,n){Ss(e),n=n||qv(t);let r={shape:e,value:t,dtype:n};return Y.runKernel(eb,{},r)}function KSe(e,t,n){let r=z(e,"x","clipByValue");if(H(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return xs(r.shape,t,r.dtype);let a={x:r},s={clipValueMin:t,clipValueMax:n};return Y.runKernel(gc,a,s)}var aa=J({clipByValue_:KSe});function QSe(e){return wn(e,0)}var qA=J({concat1d_:QSe});function XSe(e,t){return wn(e,t)}var KA=J({concat2d_:XSe});function YSe(e,t){return wn(e,t)}var QA=J({concat3d_:YSe});function JSe(e,t){return wn(e,t)}var XA=J({concat4d_:JSe});function ZSe(e,t,n,r,a="NHWC",s=[1,1],i){let o=z(e,"x","conv2d","float32"),l=z(t,"filter","conv2d","float32"),c=o,u=!1;o.rank===3&&(u=!0,c=ee(o,[1,o.shape[0],o.shape[1],o.shape[2]])),H(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),H(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Ea("conv2d",r,i);let h=a==="NHWC"?c.shape[3]:c.shape[1];H(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),H(Lo(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),H(zd(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),H(zd(n),()=>"Error in conv2D: Strides should be larger than 0.");let p={x:c,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:i},g=Y.runKernel(vh,p,f);return u?ee(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var Sa=J({conv2d_:ZSe});function e_e(e,t,n,r,a="NWC",s=1,i){let o=z(e,"x","conv1d"),l=z(t,"filter","conv1d"),c=o,u=!1;o.rank===2&&(u=!0,c=ee(o,[1,o.shape[0],o.shape[1]])),H(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),H(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Ea("conv1d",r,i),H(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),H(Lo(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),H(zd(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),H(zd(n),()=>"Error in conv1D: Stride should be larger than 0."),H(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);let h=ee(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=ee(c,[c.shape[0],1,c.shape[1],c.shape[2]]),f=Sa(p,h,[1,n],r,"NHWC",[1,s],i);return u?ee(f,[f.shape[2],f.shape[3]]):ee(f,[f.shape[0],f.shape[2],f.shape[3]])}var Gk=J({conv1d_:e_e});function t_e(e,t,n,r,a,s="NHWC",i){H(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,l=t,c=!1;t.rank===3&&(c=!0,l=ee(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),H(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),H(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),H(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);let u=s==="NHWC"?o[3]:o[1],h=s==="NHWC"?l.shape[3]:l.shape[1];H(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),H(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),Ea("conv2dDerInput",a,i);let p={dy:l,filter:n},f={strides:r,pad:a,dataFormat:s,dimRoundingMode:i,inputShape:o},g=Y.runKernel(bh,p,f);return c?ee(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var YA=J({conv2DBackpropInput_:t_e});function n_e(e,t,n,r,a,s){let i=z(e,"x","conv2dTranspose"),o=z(t,"filter","conv2dTranspose");return YA(n,i,o,r,a,"NHWC",s)}var qk=J({conv2dTranspose_:n_e});function r_e(e,t,n,r,a="NDHWC",s=[1,1,1]){let i=z(e,"x","conv3d"),o=z(t,"filter","conv3d"),l=i,c=!1;i.rank===4&&(c=!0,l=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),H(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),H(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),H(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),H(Lo(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),H(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`),H(zd(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),H(zd(n),()=>"Error in conv3D: Strides should be larger than 0.");let u={x:l,filter:o},h={strides:n,pad:r,dataFormat:a,dilations:s},p=Y.runKernel(wh,u,h);return c?ee(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var JA=J({conv3d_:r_e});function a_e(e,t,n,r,a){H(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let s=e,i=t,o=!1;t.rank===4&&(o=!0,i=ee(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);let l=s[4],c=i.shape[4];H(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),H(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),H(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),H(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),H(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);let u={dy:i,filter:n},h={pad:a,strides:r,inputShape:s},p=Y.runKernel(sg,u,h);return o?ee(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var $8=J({conv3DBackpropInput_:a_e});function s_e(e,t,n,r,a){let s=z(e,"x","conv3dTranspose"),i=z(t,"filter","conv3dTranspose");return $8(n,s,i,r,a)}var ZA=J({conv3dTranspose_:s_e});function i_e(e){let t={x:z(e,"x","cos","float32")};return Y.runKernel(Nh,t)}var Nb=J({cos_:i_e});function o_e(e){let t={x:z(e,"x","cosh","float32")};return Y.runKernel(kh,t)}var Kk=J({cosh_:o_e});function l_e(e,t=0,n=!1,r=!1){let a={x:z(e,"x","cumprod")},s={axis:t,exclusive:n,reverse:r};return Y.runKernel(ig,a,s)}var iv=J({cumprod_:l_e});function u_e(e,t=0,n=!1,r=!1){let a={x:z(e,"x","cumsum")},s={axis:t,exclusive:n,reverse:r};return Y.runKernel(Sh,a,s)}var Qk=J({cumsum_:u_e});function c_e(e,t,n,r=!1){let a=z(e,"x","denseBincount"),s=z(t,"weights","denseBincount");H(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),H(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),H(n>=0,()=>`size must be non-negative, but got ${n}.`),H(s.size===a.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${s.shape}.`);let i={x:a,weights:s},o={size:n,binaryOutput:r};return Y.runKernel(Jv,i,o)}var F1=J({denseBincount_:c_e});function d_e(e,t,n="NHWC"){let r=z(e,"x","depthToSpace","float32"),a=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];H(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),H(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t}  for depthToSpace with input shape
    ${r.shape}`),H(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${t} for depthToSpace with input shape
        ${r.shape}`),H(i%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${i} for depthToSpace with input shape ${r.shape}`);let o={x:r},l={blockSize:t,dataFormat:n};return Y.runKernel(lg,o,l)}var e$=J({depthToSpace_:d_e});function h_e(e,t,n,r,a="NHWC",s=[1,1],i){let o=z(e,"x","depthwiseConv2d","float32"),l=z(t,"filter","depthwiseConv2d","float32"),c=o,u=!1;o.rank===3&&(u=!0,c=ee(o,[1,o.shape[0],o.shape[1],o.shape[2]])),H(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),H(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);let h=a==="NHWC"?c.shape[3]:c.shape[1];H(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),Ea("depthwiseConv2d",r,i);let p={x:c,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:i},g=Y.runKernel(_h,p,f);return u?ee(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var Cp=J({depthwiseConv2d_:h_e});function p_e(e){let t={x:z(e,"x","diag")};return Y.runKernel(Zv,t)}var R8=J({diag_:p_e});function f_e(e,t,n,r,a=[1,1],s="NHWC"){let i=z(e,"x","dilation2d"),o=z(t,"filter","dilation2d");H(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),H(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),H(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=i,c=!1;i.rank===3&&(l=ee(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),H(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);let u={x:l,filter:o},h={strides:n,pad:r,dilations:a},p=Y.runKernel(Ch,u,h);return c?ee(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var t$=J({dilation2d_:f_e}),Xg={};gt(Xg,{assertAndGetBroadcastShape:()=>Nn,getBroadcastDims:()=>D8,getReductionAxes:()=>mr});function D8(e,t){let n=e.length,r=[];for(let a=0;a<n;a++){let s=n-1-a,i=e[s]||1;(t[t.length-1-a]||1)>1&&i===1&&r.unshift(s)}return r}function mr(e,t){let n=[];for(let r=0;r<t.length;r++){let a=e[e.length-r-1],s=t.length-r-1,i=t[s];(a==null||a===1&&i>1)&&n.unshift(s)}return n}function Nn(e,t){let n=Math.max(e.length,t.length),r=new Array(n);for(let a=0;a<n;a++){let s=e[e.length-a-1];s==null&&(s=1);let i=t[t.length-a-1];if(i==null&&(i=1),s===1)r[n-a-1]=i;else if(i===1)r[n-a-1]=s;else if(s!==i){let o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else r[n-a-1]=s}return r}function m_e(e,t){let n=z(e,"a","equal","string_or_numeric"),r=z(t,"b","equal","string_or_numeric");[n,r]=qn(n,r),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(cg,a)}var bs=J({equal_:m_e});function g_e(e,t,n){let r=z(t,"a","where"),a=z(n,"b","where"),s=z(e,"condition","where","bool"),i=Nn(Nn(s.shape,r.shape),a.shape),o=fd(s,i),l=fd(r,i),c=fd(a,i),u={condition:o,t:l,e:c};return Y.runKernel(Pg,u)}var Mr=J({where_:g_e});function y_e(e){let t={x:z(e,"x","zerosLike")};return Y.runKernel(Kg,t)}var qt=J({zerosLike_:y_e});function x_e(e,t){let n=z(e,"a","div"),r=z(t,"b","div");[n,r]=qn(n,r);let a=ze(n,r),s=qt(a),i=bs(r,s);return Mr(i,s,a)}var n$=J({divNoNan_:x_e});function v_e(e,t){let n=z(e,"t1","dot"),r=z(t,"t2","dot");H((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);let a=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(H(a===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${s}.`),n.rank===1&&r.rank===1){let i=ee(n,[1,-1]),o=ee(r,[-1,1]),l=_t(i,o);return ee(l,[])}else if(n.rank===1&&r.rank===2){let i=ee(n,[1,-1]),o=ee(r,[r.shape[0],r.shape[1]]),l=_t(i,o);return ee(l,[l.size])}else if(n.rank===2&&r.rank===1){let i=ee(r,[-1,1]),o=_t(n,i);return ee(o,[o.size])}else{let i=ee(r,[r.shape[0],r.shape[1]]);return _t(n,i)}}var r$=J({dot_:v_e});function b_e(e,...t){let n=t.map((a,s)=>z(a,`tensors${s}`,"einsum")),r={equation:e};return Y.runKernel(Rk,n,r)}var Vc=J({einsum_:b_e});function w_e(e){let t={x:z(e,"x","elu","float32")};return Y.runKernel(Eh,t)}var Yg=J({elu_:w_e});function N_e(e,t){let n=z(e,"x","ensureShape","string_or_numeric");if(!PG(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}var M8=J({ensureShape_:N_e});function k_e(e){let t=z(e,"x","erf");H(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Se(t,"float32"));let n={x:t};return Y.runKernel(Th,n)}var Xk=J({erf_:k_e});function a$(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function O8(e,t,n){let r=e.length+t.length,a=[],s=0,i=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?a.push(e[s++]):a.push(t[i++]);return a}function F8(e,t){let n=[],r=e.length;for(let s=0;s<r;s++)t.indexOf(s)===-1&&n.push(e[s]);let a=t.map(s=>e[s]);return[n,a]}function Bd(e,t){let n=t.map(r=>1);return O8(e,n,t)}function S_e(e,t,n){H(a$(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function P8(e,t){if(a$(e,t))return null;let n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function s$(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function __e(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}function C_e(e,t=null,n=!1){let r={x:z(e,"x","max")},a={reductionIndices:t,keepDims:n};return Y.runKernel(Vh,r,a)}var Ps=J({max_:C_e});function I_e(e,t=null,n=!1){let r={x:z(e,"x","min")},a={axis:t,keepDims:n};return Y.runKernel(Kh,r,a)}var hm=J({min_:I_e});function E_e(e,t){let n=z(e,"base","pow"),r=z(t,"exp","pow");[n,r]=qn(n,r);let a={a:n,b:r};return Y.runKernel(tp,a)}var Ro=J({pow_:E_e});function Ze(e,t){if((Ar(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ar(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return vc(e,[],[],t)}function T_e(e){let t={x:z(e,"x","sqrt","float32")};return Y.runKernel(xp,t)}var Or=J({sqrt_:T_e});function j_e(e){let t=z(e,"x","square"),n={};return Y.runKernel("Square",{x:t},n)}var vn=J({square_:j_e});function A_e(e,t=null,n=!1){let r=z(e,"x","sum");r.dtype==="bool"&&(r=Se(r,"int32"));let a={x:r},s={axis:t,keepDims:n};return Y.runKernel(vp,a,s)}var Ge=J({sum_:A_e});function $_e(e,t="euclidean",n=null,r=!1){e=z(e,"x","norm");let a=L8(e,t,n),s=a.shape;if(r){let i=hi(n,e.shape);s=Bd(a.shape,i)}return ee(a,s)}function L8(e,t,n=null){if(e.rank===0)return ur(e);if(e.rank!==1&&n===null)return L8(ee(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Ge(ur(e),n);if(t===1/0)return Ps(ur(e),n);if(t===-1/0)return hm(ur(e),n);if(t==="euclidean"||t===2)return Or(Ge(Ro(ur(e),Ze(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Ps(Ge(ur(e),n[0]),n[1]-1);if(t===1/0)return Ps(Ge(ur(e),n[1]),n[0]);if(t===-1/0)return hm(Ge(ur(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Or(Ge(vn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}var Jg=J({norm_:$_e});function R_e(e,t=null,n=!1){return Jg(e,"euclidean",t,n)}var i$=J({euclideanNorm_:R_e});function D_e(e){let t={x:z(e,"x","exp")};return Y.runKernel(jh,t)}var sa=J({exp_:D_e});function M_e(e,t=0){let n=z(e,"x","expandDims","string_or_numeric");H(t<=n.rank,()=>"Axis must be <= rank of the tensor");let r={input:n},a={dim:t};return Y.runKernel(dg,r,a)}var $r=J({expandDims_:M_e});function O_e(e){let t={x:z(e,"x","expm1")};return Y.runKernel(Ah,t)}var o$=J({expm1_:O_e});function F_e(e,t){let n=z(e,"x","tile","string_or_numeric");H(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);let r={x:n},a={reps:t};return Y.runKernel(yc,r,a)}var ds=J({tile_:F_e});function P_e(e,t,n,r="float32"){t==null&&(t=e);let a=jt([e,t],r),s=e<=t?e:t;for(let o=0;o<s;++o)a.set(1,o,o);let i=ee(a.toTensor(),[e,t]);if(n==null)return i;if(n.length===1)return ds($r(i,0),[n[0],1,1]);if(n.length===2)return ds($r($r(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return ds($r($r($r(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}var Yk=J({eye_:P_e});function L_e(e){let t={x:z(e,"x","floor","float32")};return Y.runKernel($h,t)}var Zg=J({floor_:L_e});function z_e(e,t,n=0,r=0){let a=z(e,"x","gather"),s=z(t,"indices","gather","int32"),i={x:a,indices:s},o={axis:n,batchDims:r};return Y.runKernel(pg,i,o)}var ey=J({gather_:z_e});function B_e(e,t){let n=z(e,"a","greater","string_or_numeric"),r=z(t,"b","greater","string_or_numeric");[n,r]=qn(n,r),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(mg,a)}var Ta=J({greater_:B_e});function U_e(e,t){let n=z(e,"a","greaterEqual","string_or_numeric"),r=z(t,"b","greaterEqual","string_or_numeric");[n,r]=qn(n,r),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(Mh,a)}var Tl=J({greaterEqual_:U_e});function W_e(e){let t={input:z(e,"input","imag")};return Y.runKernel(Ok,t)}var kb=J({imag_:W_e});function V_e(e){let t={x:z(e,"x","isFinite")};return Y.runKernel(Fh,t)}var l$=J({isFinite_:V_e});function H_e(e){let t={x:z(e,"x","isInf")};return Y.runKernel(Ph,t)}var u$=J({isInf_:H_e});function G_e(e){let t={x:z(e,"x","isNaN")};return Y.runKernel(Lh,t)}var c$=J({isNaN_:G_e});function q_e(e,t=.2){let n={x:z(e,"x","leakyRelu")},r={alpha:t};return Y.runKernel(zh,n,r)}var Sb=J({leakyRelu_:q_e});function K_e(e,t){let n=z(e,"a","less","string_or_numeric"),r=z(t,"b","less","string_or_numeric");[n,r]=qn(n,r),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(gg,a)}var pm=J({less_:K_e});function Q_e(e,t){let n=z(e,"a","lessEqual","string_or_numeric"),r=z(t,"b","lessEqual","string_or_numeric");[n,r]=qn(n,r),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(yg,a)}var bc=J({lessEqual_:Q_e});function z8(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let r={start:e,stop:t,num:n};return Y.runKernel(xg,{},r)}function X_e(e,t=5,n=1,r=1,a=.5){let s=z(e,"x","localResponseNormalization");H(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),H(lm(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let i=s,o=!1;s.rank===3&&(o=!0,i=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let l={x:i},c={depthRadius:t,bias:n,alpha:r,beta:a},u=Y.runKernel(Wh,l,c);return o?ee(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var d$=J({localResponseNormalization_:X_e});function Y_e(e){let t={x:z(e,"x","log","float32")};return Y.runKernel(Bh,t)}var ws=J({log_:Y_e});function J_e(e){let t={x:z(e,"x","log1p")};return Y.runKernel(Uh,t)}var _b=J({log1p_:J_e});function Z_e(e){return H(Wu(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let r=z(t,"x","tf.grad","string_or_numeric"),a=n!=null?z(n,"dy","tf.grad"):null;return Y.tidy(()=>{let{value:s,grads:i}=Y.gradients(()=>e(r),[r],a);return a!=null&&Ia(s.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Jk(i),i[0]})}}function eCe(e){return H(Wu(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{H(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let r=nv(t,"args","tf.grads","string_or_numeric"),a=n!=null?z(n,"dy","tf.grads"):null;return Y.tidy(()=>{let{value:s,grads:i}=Y.gradients(()=>e(...r),r,a);return a!=null&&Ia(s.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Jk(i),i})}}function tCe(e){return H(Wu(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{H(t instanceof Dt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),H(n==null||n instanceof Dt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:r,value:a}=Y.gradients(()=>e(t),[t],n);return Jk(r),{grad:r[0],value:a}}}function nCe(e){return H(Wu(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{H(Array.isArray(t)&&t.every(a=>a instanceof Dt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),H(n==null||n instanceof Dt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let r=Y.gradients(()=>e(...t),t,n);return n!=null&&Ia(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Jk(r.grads),r}}function B8(e,t){H(Wu(e),()=>"The f passed in variableGrads(f) must be a function"),H(t==null||Array.isArray(t)&&t.every(c=>c instanceof Md),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=t!=null;if(!n){t=[];for(let c in Y.registeredVariables)t.push(Y.registeredVariables[c])}let r=n?t.filter(c=>!c.trainable):null,a=t.length;t=t.filter(c=>c.trainable),H(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);let s=!0,{value:i,grads:o}=Y.gradients(e,t,null,s);H(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),H(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);let l={};return t.forEach((c,u)=>{o[u]!=null&&(l[c.name]=o[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:i,grads:l}}function Do(e){return Y.customGrad(e)}function Jk(e){if(e.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}function rCe(e){let t={x:z(e,"x","neg")};return Y.runKernel(_g,t)}var In=J({neg_:rCe});function aCe(e){let t={x:z(e,"x","softplus")};return Y.runKernel(yp,t)}var Ip=J({softplus_:aCe});function sCe(e){let t=z(e,"x","logSigmoid");return Do(n=>({value:In(Ip(In(n))),gradFunc:r=>Z(r,si(In(n)))}))(t)}var h$=J({logSigmoid_:sCe});function iCe(e,t){let n=z(e,"a","sub"),r=z(t,"b","sub");[n,r]=qn(n,r);let a={a:n,b:r};return Y.runKernel(Np,a)}var Oe=J({sub_:iCe});function oCe(e,t=-1){let n=z(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Do((r,a)=>{let s=Ps(r,t,!0),i=Oe(r,s),o=Oe(Se(i,"float32"),ws(Ge(sa(i),t,!0)));return a([o]),{value:o,gradFunc:(l,c)=>{let[u]=c,h=!0,p=sa(u);return Oe(l,Z(Ge(l,t,h),p))}}})(n)}var Zk=J({logSoftmax_:oCe});function lCe(e,t=null,n=!1){let r=z(e,"x","logSumExp"),a=hi(t,r.shape),s=Ps(r,a,!0),i=Oe(r,s),o=sa(i),l=Ge(o,a),c=ws(l),u=me(ee(s,c.shape),c);if(n){let h=Bd(u.shape,a);return ee(u,h)}return u}var Cb=J({logSumExp_:lCe});function uCe(e,t){let n=z(e,"a","logicalAnd","bool"),r=z(t,"b","logicalAnd","bool");Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(vg,a)}var ui=J({logicalAnd_:uCe});function cCe(e){let t={x:z(e,"x","logicalNot","bool")};return Y.runKernel(bg,t)}var Ib=J({logicalNot_:cCe});function dCe(e,t){let n=z(e,"a","logicalOr","bool"),r=z(t,"b","logicalOr","bool");Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(wg,a)}var eS=J({logicalOr_:dCe});function hCe(e,t){let n=z(e,"a","logicalXor","bool"),r=z(t,"b","logicalXor","bool");return Nn(n.shape,r.shape),ui(eS(e,t),Ib(ui(e,t)))}var p$=J({logicalXor_:hCe}),Lw=2147483648;function pCe(e,t,n="left"){let r=z(e,"sortedSequence","searchSorted"),a=z(t,"values","searchSorted"),s=r.shape[r.shape.length-1],i=a.shape[a.shape.length-1],o=ee(r,[-1,s]),l=ee(a,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(fn(l.shape)>=Lw)throw new Error(`values tensor size must less than ${Lw}`);if(o.shape[1]>=Lw)throw new Error(`trailing dim_size must less than ${Lw} for int32 output type, was ${o.shape[1]}`);let c={sortedSequence:o,values:l},u={side:n};return Y.runKernel(Fg,c,u)}var tS=J({searchSorted_:pCe});function U8(e,t){return tS(e,t,"left")}function fCe(e,t,n,r,a){let s=z(e,"x","maxPool"),i=1,o=s,l=!1;s.rank===3&&(l=!0,o=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]])),H(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),H(Lo(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Ea("maxPool",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},h=Y.runKernel(Gh,c,u);return l?ee(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var Ir=J({maxPool_:fCe});function mCe(e,t=[1,1,1],n,r,a,s="NDHWC"){let i=z(e,"x","maxPool3d"),o=i,l=!1;i.rank===4&&(l=!0,o=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),H(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),H(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Ea("maxPool3d",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:s},h=Y.runKernel(kg,c,u);return l?ee(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var f$=J({maxPool3d_:mCe});function gCe(e,t,n,r,a=!1){let s={x:z(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},o=Y.runKernel(rb,s,i);return{result:o[0],indexes:o[1]}}var W8=J({maxPoolWithArgmax_:gCe});function yCe(e,t){let n=z(e,"a","maximum"),r=z(t,"b","maximum");[n,r]=qn(n,r),n.dtype==="bool"&&(n=Se(n,"int32"),r=Se(r,"int32")),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(Hh,a)}var zo=J({maximum_:yCe});function xCe(e,t=null,n=!1){let r={x:z(e,"x","mean")},a={axis:t,keepDims:n};return Y.runKernel(qh,r,a)}var Wn=J({mean_:xCe});function Vn(e,t="float32"){if(Ss(e),t==="complex64"){let r=Vn(e,"float32"),a=Vn(e,"float32");return Nl(r,a)}let n=Ck(fn(e),t);return Y.makeTensor(n,e,t)}function Pa(e,t="float32"){if(Ss(e),t==="complex64"){let r=Pa(e,"float32"),a=Vn(e,"float32");return Nl(r,a)}let n=wA(fn(e),t);return Y.makeTensor(n,e,t)}function V8(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=z(e,"x","meshgrid",e instanceof Dt?e.dtype:"float32");if(t===void 0)return[r];let a=z(t,"y","meshgrid",t instanceof Dt?t.dtype:"float32"),s=fn(r.shape),i=fn(a.shape);return n==="xy"?(r=ee(r,[1,-1]),a=ee(a,[-1,1]),[_t(Pa([i,1],r.dtype),r),_t(a,Pa([1,s],a.dtype))]):(r=ee(r,[-1,1]),a=ee(a,[1,-1]),[_t(r,Pa([1,i],r.dtype)),_t(Pa([s,1],a.dtype),a)])}function vCe(e,t){let n=z(e,"a","minimum"),r=z(t,"b","minimum");[n,r]=qn(n,r),n.dtype==="bool"&&(n=Se(n,"int32"),r=Se(r,"int32")),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(Qh,a)}var Qu=J({minimum_:vCe});function bCe(e,t,n){H(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);let r=z(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");H(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);let a=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)H(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),H(t[o][0]>=0&&t[o][0]<=r.shape[o]-a&&t[o][1]>=0&&t[o][1]<=r.shape[o]-a,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-a} or less than 0 for input of shape ${r.shape}`);let s={paddings:t,mode:n},i={x:r};return Y.runKernel(Xh,i,s)}var m$=J({mirrorPad_:bCe});function wCe(e,t){let n=z(e,"a","mod"),r=z(t,"b","mod");[n,r]=qn(n,r);let a={a:n,b:r};return Y.runKernel(Yh,a)}var g$=J({mod_:wCe});function NCe(e,t=null,n=!1){e=z(e,"x","moments");let r=hi(t,e.shape),a=Wn(e,r,n),s=a.shape;n||(s=Bd(a.shape,r));let i=vn(Oe(Se(e,"float32"),ee(a,s))),o=Wn(i,r,n);return{mean:a,variance:o}}var Eb=J({moments_:NCe});function kCe(e,t,n,r){let a=z(t,"data","multiRNNCell"),s=nv(n,"c","multiRNNCell"),i=nv(r,"h","multiRNNCell"),o=a,l=[];for(let h=0;h<e.length;h++){let p=e[h](o,s[h],i[h]);l.push(p[0]),l.push(p[1]),o=p[1]}let c=[],u=[];for(let h=0;h<l.length;h+=2)c.push(l[h]),u.push(l[h+1]);return[c,u]}var H8=J({multiRNNCell_:kCe});function SCe(e,t,n,r=!1){let a=z(e,"logits","multinomial"),s=a.size,i=a.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();let o={logits:i===1?ee(a,[1,-1]):a},l={numSamples:t,seed:n,normalized:r},c=Y.runKernel(Sg,o,l);return i===1?ee(c,[c.size]):c}var G8=J({multinomial_:SCe});function _Ce(e,t){let n=z(e,"a","notEqual","string_or_numeric"),r=z(t,"b","notEqual","string_or_numeric");[n,r]=qn(n,r),Nn(n.shape,r.shape);let a={a:n,b:r};return Y.runKernel(Cg,a)}var Ud=J({notEqual_:_Ce});function CCe(e,t,n=1,r=0,a="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let s={indices:z(e,"indices","oneHot","int32")},i={dtype:a,depth:t,onValue:n,offValue:r};return Y.runKernel(Zh,s,i)}var fm=J({oneHot_:CCe});function ICe(e){let t={x:z(e,"x","onesLike")};return Y.runKernel(jg,t)}var Ns=J({onesLike_:ICe});function ECe(e,t){let n=z(e,"v1","outerProduct"),r=z(t,"v2","outerProduct");H(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);let a=ee(n,[-1,1]),s=ee(r,[1,-1]);return _t(a,s)}var q8=J({outerProduct_:ECe});function TCe(e,t,n=0){let r=z(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let a={paddings:t,constantValue:n},s={x:r};return Y.runKernel(ep,s,a)}var Ki=J({pad_:TCe});function jCe(e,t,n=0){return H(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),Ki(e,[t],n)}var K8=J({pad1d_:jCe});function ACe(e,t,n=0){return H(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ki(e,t,n)}var Q8=J({pad2d_:ACe});function $Ce(e,t,n=0){return H(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ki(e,t,n)}var X8=J({pad3d_:$Ce});function RCe(e,t,n=0){return H(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ki(e,t,n)}var Y8=J({pad4d_:RCe});function DCe(e,t,n){let r=z(e,"x","spaceToBatchND");H(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),H(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),H(r.shape.reduce((i,o,l)=>l>0&&l<=t.length?i&&(o+n[l-1][0]+n[l-1][1])%t[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);let a={x:r},s={blockShape:t,paddings:n};return Y.runKernel(zg,a,s)}var Tb=J({spaceToBatchND_:DCe});function MCe(e,t,n,r,a,s,i){a==null&&(a=[1,1]),s==null&&(s=1),r===0&&(r="valid");let o=z(e,"x","maxPool"),l=o,c=!1;o.rank===3&&(c=!0,l=ee(o,[1,o.shape[0],o.shape[1],o.shape[2]])),H(Lo(s,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${a}'`);let u=C8(l.shape,t,s,a,r),h=[u.dilationHeight,u.dilationWidth],p;r==="same"?p=FCe([u.filterHeight,u.filterWidth],h):p=[[0,0],[0,0]];let f=h[0]===1&&h[1]===1,[g,m]=OCe([u.inHeight,u.inWidth],h,p),y=f?r:"valid",x=f?l:Tb(l,h,g),v=(n==="avg"?()=>El(x,t,s,y,i):()=>Ir(x,t,s,y,i))(),b=f?v:wb(v,h,m);return c?ee(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function OCe(e,t,n){let r=n.map(u=>u[0]),a=n.map(u=>u[1]),s=e.concat(r,a),i=t.map((u,h)=>(u-s[h]%u)%u),o=a.map((u,h)=>u+i[h]),l=t.map((u,h)=>[r[h],o[h]]),c=t.map((u,h)=>[0,i[h]]);return[l,c]}function FCe(e,t){let n=e.map((s,i)=>s+(s-1)*(t[i]-1)).map(s=>s-1),r=n.map(s=>Math.floor(s/2)),a=n.map((s,i)=>s-r[i]);return n.map((s,i)=>[r[i],a[i]])}var y$=J({pool_:MCe});function PCe(e,t){let n=z(e,"x","prelu"),r=z(t,"alpha","prelu"),a={x:n,alpha:r};return Y.runKernel(np,a)}var jb=J({prelu_:PCe});function LCe(e,t=null,n=!1){let r=z(e,"x","prod");r.dtype==="bool"&&(r=Se(r,"int32"));let a={x:r},s={axis:t,keepDims:n};return Y.runKernel(rp,a,s)}var x$=J({prod_:LCe});function zCe(e,t,n,r){let a=e.map((u,h)=>z(u,`tensors${h}`,"raggedGather","int32")),s=z(t,"paramsDenseValues","raggedGather"),i=z(n,"indices","raggedGather","int32"),o={paramsNestedSplits:a,paramsDenseValues:s,indices:i},l={outputRaggedRank:r},c=Y.runKernel(Fk,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}var J8=J({raggedGather_:zCe});function BCe(e,t,n){let r=z(e,"starts","raggedRange"),a=z(t,"limits","raggedRange",r.dtype),s=z(n,"deltas","raggedRange",r.dtype),i={starts:r,limits:a,deltas:s},o=Y.runKernel(Pk,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}var Z8=J({raggedRange_:BCe});function UCe(e,t,n,r,a){let s=z(e,"shape","raggedTensorToTensor","int32"),i=z(t,"values","raggedTensorToTensor"),o=z(n,"defaultValue","raggedTensorToTensor",i.dtype),l=r.map((h,p)=>z(h,`tensors${p}`,"raggedTensorToTensor","int32")),c={shape:s,values:i,defaultValue:o,rowPartitionTensors:l},u={rowPartitionTypes:a};return Y.runKernel(Lk,c,u)}var eq=J({raggedTensorToTensor_:UCe});function WCe(e,t,n){Ss(e);let r=fn(e),a=null;if(n==null||n==="float32")a=new Float32Array(r);else if(n==="int32")a=new Int32Array(r);else if(n==="bool")a=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let s=0;s<r;s++)a[s]=t();return Y.makeTensor(a,e,n)}var tq=J({rand_:WCe}),v$=fc(Sk()),nq={};gt(nq,{TEST_EPSILON_FLOAT16:()=>rq,createVideoElement:()=>YCe,encodeStrings:()=>aq,expectArrayBuffersEqual:()=>XCe,expectArraysClose:()=>HCe,expectArraysEqual:()=>qCe,expectNumbersClose:()=>KCe,expectPromiseToFail:()=>GCe,expectValuesInRange:()=>QCe,play:()=>JCe,testEpsilon:()=>b$});var VCe=.001,rq=.1;function HCe(e,t,n){return n==null&&(n=b$()),JI(e,t,(r,a)=>w$(r,a,n))}function b$(){return Y.backend.floatPrecision()===32?VCe:rq}function JI(e,t,n){let r=!0;if((Ar(e)||Ar(t))&&(r=!1),Ar(e)&&Ar(t)&&(r=!0),r){let i=e.constructor.name,o=t.constructor.name;if(i!==o)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${o}`)}if(Array.isArray(e)&&Array.isArray(t)){let i=$o(e),o=$o(t);if(!Cl(i,o))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${o}]`)}let a=Ar(e)?e:Vu(e),s=Ar(t)?t:Vu(t);if(a.length!==s.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${s.length}.
Actual:   ${a}.
Expected: ${s}.`);for(let i=0;i<s.length;++i){let o=a[i],l=s[i];if(!n(o,l))throw new Error(`Arrays differ: actual[${i}] = ${o}, expected[${i}] = ${l}.
Actual:   ${a}.
Expected: ${s}.`)}typeof expect<"u"&&expect().nothing()}function GCe(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function qCe(e,t){let n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return gu(e)||gu(e[0])||gu(t)||gu(t[0])?JI(e,n,(r,a)=>r==a):JI(e,t,(r,a)=>w$(r,a,0))}function KCe(e,t,n){if(n==null&&(n=b$()),!w$(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function w$(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function QCe(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function XCe(e,t){let n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${r[a]} but got ${n[a]} instead`)}function aq(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?aq(n):e[t]=yb(n)}return e}function YCe(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function JCe(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}var N$=class{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let s=a||Math.random();this.random=v$.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){let r=this.nextVal;return this.nextVal=NaN,r}let e,t,n=!1;for(;!n;){let r,a,s;do r=2*this.random()-1,a=2*this.random()-1,s=r*r+a*a;while(s>=1||s===0);let i=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*r*i,t=this.mean+this.stdDev*a*i,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},ZCe=class{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;let a=r||Math.random();this.randu=v$.alea(a.toString()),this.randn=new N$(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,a,s;for(;;){do r=this.randn.nextValue(),s=1+this.c*r;while(s<=0);if(s*=s*s,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-s+Math.log(s)),a=this.randu(),a<t||Math.log(a)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}},e2e=class{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=v$.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function t2e(e,t,n=1,r="float32",a){if(Ss(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);let s=new ZCe(t,n,r,a),i=jt(e,r);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var sq=J({randomGamma_:t2e});function n2e(e,t=0,n=1,r,a){if(Ss(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);let s=new N$(t,n,r,!1,a),i=jt(e,r);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var nS=J({randomNormal_:n2e});function r2e(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return nS(e,0,1,t,n)}var iq=J({randomStandardNormal_:r2e});function a2e(e,t=0,n=1,r="float32",a){Ss(e);let s=jt(e,r),i=new e2e(t,n,null,a);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var wc=J({randomUniform_:a2e});function s2e(e,t,n,r){return wc(e,t,n,"int32",r)}var oq=J({randomUniformInt_:s2e});function Wd(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");let a={start:e,stop:t,step:n,dtype:r};return Y.runKernel(ab,{},a)}function i2e(e){let t={input:z(e,"input","real")};return Y.runKernel(zk,t)}var mm=J({real_:i2e});function o2e(e){let t={x:z(e,"x","reciprocal")};return Y.runKernel(ap,t)}var k$=J({reciprocal_:o2e});function l2e(e){let t={x:z(e,"x","relu")};return Y.runKernel(sp,t)}var hn=J({relu_:l2e});function u2e(e){let t={x:z(e,"x","relu6")};return Y.runKernel(lp,t)}var rS=J({relu6_:u2e});function c2e(e,t){let n={x:z(e,"x","reverse")},r={dims:t};return Y.runKernel(up,n,r)}var Ws=J({reverse_:c2e});function d2e(e){let t=z(e,"x","reverse");return H(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Ws(t,0)}var lq=J({reverse1d_:d2e});function h2e(e,t){let n=z(e,"x","reverse");return H(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ws(n,t)}var uq=J({reverse2d_:h2e});function p2e(e,t){let n=z(e,"x","reverse");return H(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ws(n,t)}var cq=J({reverse3d_:p2e});function f2e(e,t){let n=z(e,"x","reverse");return H(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ws(n,t)}var dq=J({reverse4d_:f2e});function m2e(e){let t={x:z(e,"x","round")};return Y.runKernel(cp,t)}var aS=J({round_:m2e});function g2e(e){let t={x:z(e,"x","rsqrt","float32")};return Y.runKernel(dp,t)}var sS=J({rsqrt_:g2e});function y2e(e){let t={x:z(e,"x","selu")};return Y.runKernel(hp,t)}var iS=J({selu_:y2e});function x2e(e,t,n,r,a,s=[1,1],i="NHWC"){let o=z(e,"x","separableConv2d"),l=z(t,"depthwiseFilter","separableConv2d"),c=z(n,"pointwiseFilter","separableConv2d"),u=o,h=!1;if(o.rank===3&&(h=!0,u=ee(o,[1,o.shape[0],o.shape[1],o.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");H(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),H(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),H(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),H(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),H(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);let p=l.shape[2],f=l.shape[3];H(c.shape[2]===p*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*f}, but got ${c.shape[2]}.`);let g=Cp(u,l,r,a,i,s),m=Sa(g,c,1,"valid",i);return h?ee(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var ty=J({separableConv2d_:x2e});async function v2e(e,t){let n=z(e,"x","setdiff1d"),r=z(t,"y","setdiff1d");H(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),H(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),H(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);let a=await n.data(),s=await r.data(),i=new Set(s),o=0;for(let u=0;u<a.length;u++)i.has(a[u])||o++;let l=new hr([o],n.dtype),c=new hr([o],"int32");for(let u=0,h=0;u<a.length;u++)i.has(a[u])||(l.values[h]=a[u],c.values[h]=u,h++);return[l.toTensor(),c.toTensor()]}var hq=v2e;function b2e(e){let t={x:z(e,"x","sign")};return Y.runKernel(mp,t)}var S$=J({sign_:b2e});function w2e(e){let t={x:z(e,"x","sin","float32")};return Y.runKernel(pp,t)}var oS=J({sin_:w2e});function N2e(e){let t={x:z(e,"x","sinh")};return Y.runKernel(fp,t)}var lS=J({sinh_:N2e});function k2e(e,t,n){let r=z(e,"x","slice1d");return H(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Ut(r,[t],[n])}var Ab=J({slice1d_:k2e});function S2e(e,t,n){let r=z(e,"x","slice2d");return H(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Ut(r,t,n)}var uS=J({slice2d_:S2e});function _2e(e,t,n){let r=z(e,"x","slice3d");return H(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Ut(r,t,n)}var ny=J({slice3d_:_2e});function C2e(e,t,n){let r=z(e,"x","slice4d");return H(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Ut(r,t,n)}var gm=J({slice4d_:C2e});function I2e(e,t=-1){let n=z(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let r={logits:n},a={dim:t};return Y.runKernel(bp,r,a)}var Nc=J({softmax_:I2e});function E2e(e){H(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);let t={input:e};return Y.runKernel(Dk,t)}var $b=J({fft_:E2e});function T2e(e){H(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);let t={input:e};return Y.runKernel(Mk,t)}var ym=J({ifft_:T2e});function j2e(e){let t=e.shape[e.shape.length-1],n=e.size/t,r;if(t<=2){let a=ee(e,[n,t]);r=ym(a)}else{let a=[n,2*(t-1)],s=ee(mm(e),[n,t]),i=ee(kb(e),[n,t]),o=Ws(Ut(s,[0,1],[n,t-2]),1),l=Z(Ws(Ut(i,[0,1],[n,t-2]),1),Ze(-1)),c=wn([s,o],1),u=wn([i,l],1),h=ee(Nl(c,u),[a[0],a[1]]);r=ym(h)}if(r=mm(r),e.rank===3&&e.shape[0]!==0){let a=r,s=e.shape[0];r=ee(r,[s,r.shape[0]/s,r.shape[1]]),a.dispose()}return r}var cS=J({irfft_:j2e});function A2e(e,t,n=0){let r={x:z(e,"x","split")},a={numOrSizeSplits:t,axis:n};return Y.runKernel(Bg,r,a)}var za=J({split_:A2e});function $2e(e,t){H(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1],r=e.size/n,a;if(t!=null&&t<n){let g=e.shape.map(y=>0),m=e.shape.map(y=>y);m[e.shape.length-1]=t,a=Ut(e,g,m),n=t}else if(t!=null&&t>n){let g=e.shape.map(m=>m);g[e.shape.length-1]=t-n,a=wn([e,Vn(g)],e.shape.length-1),n=t}else a=e;let s=qt(a),i=ee(Nl(a,s),[r,n]),o=$b(i),l=Math.floor(n/2)+1,c=mm(o),u=kb(o),h=za(c,[l,n-l],c.shape.length-1),p=za(u,[l,n-l],u.shape.length-1),f=a.shape.slice();return f[a.shape.length-1]=l,ee(Nl(h[0],p[0]),f)}var Rb=J({rfft_:$2e});function R2e(e,t){let n=z(e,"a","squaredDifference"),r=z(t,"b","squaredDifference");[n,r]=qn(n,r),Nn(n.shape,r.shape);let a={a:n,b:r},s={};return Y.runKernel(wp,a,s)}var dS=J({squaredDifference_:R2e});function D2e(e,t){let n=z(e,"x","squeeze","string_or_numeric");return ee(n,LG(n.shape,t).newShape)}var kc=J({squeeze_:D2e});function M2e(e,t=0){let n=nv(e,"tensors","stack","string_or_numeric");H(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&H(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");let r=n,a={axis:t};return Y.runKernel(Ag,r,a)}var pr=J({stack_:M2e});function O2e(e,t=0){let n={x:z(e,"x","step")},r={alpha:t};return Y.runKernel(xc,n,r)}var Ep=J({step_:O2e});function F2e(e,t,n,r,a=0,s=0,i=0,o=0,l=0){let c={x:z(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:r,beginMask:a,endMask:s,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return Y.runKernel(Vg,c,u)}var _$=J({stridedSlice_:F2e});function P2e(e){let t={x:z(e,"x","tan","float32")};return Y.runKernel(kp,t)}var C$=J({tan_:P2e});function cn(e,t){ih(e);let n=$o(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return vc(e,null,n,t)}function So(e,t,n){if(ih(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=$o(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return vc(e,t,r,n)}function hS(e,t,n){if(ih(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let r=$o(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return vc(e,t,r,n)}function Xu(e,t,n){if(ih(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let r=$o(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return vc(e,t,r,n)}function pq(e,t,n){if(ih(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let r=$o(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return vc(e,t,r,n)}function fq(e,t,n){if(ih(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let r=$o(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,vc(e,t,r,n)}var pS={};gt(pS,{calculateShapes:()=>mq,validateInput:()=>fS,validateUpdateShape:()=>I$});function I$(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(s+` update.rank < ${a}. `);if(e.length<r+(n.rank-a))throw new Error(s+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+e.length-r)throw new Error(s+` update.rank != ${a+e.length-r}`);for(let i=0;i<a;++i)if(n.shape[i]!==t.shape[i])throw new Error(s+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${t.shape[i]}).`);for(let i=0;i<n.rank-a;++i)if(n.shape[i+a]!==e[i+r])throw new Error(s+` updates.shape[${i+a}] (${n.shape[i+a]}) != shape[${i+a}] (${e[i+a]})`)}function fS(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}I$(n,t,e)}function mq(e,t,n){let r=t.shape.length,a=r>1?t.shape[r-1]:1,s=n.length,i=1;for(let h=a;h<s;++h)i*=n[h];let o=a<1?1:a,l=fn(t.shape)/o,c=[...qm(n.slice(0,a)),1],u=fn(n);return{sliceRank:a,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}function L2e(e,t,n){let r=z(e,"tensor","tensorScatterupdate"),a=z(t,"indices","tensorScatterupdate","int32"),s=z(n,"updates","tensorScatterupdate");if(fS(s,a,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);let i={tensor:r,indices:a,updates:s},o={};return Y.runKernel(Og,i,o)}var gq=J({tensorScatterUpdate_:L2e});function z2e(e,t=1,n=!0){let r=z(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let a=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${t}`);let s={x:r},i={k:t,sorted:n},[o,l]=Y.runKernel(Hg,s,i);return{values:o,indices:l}}var E$=J({topk_:z2e});function B2e(e,t=0,n=1,r,a){if(Ss(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let s=new N$(t,n,r,!0,a),i=jt(e,r);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var mS=J({truncatedNormal_:B2e});function U2e(e,t=0){let n=z(e,"x","unique","string_or_numeric");H(n.rank>0,()=>"The input tensor must be at least 1D");let r={x:n},a={axis:t},[s,i]=Y.runKernel(pb,r,a);return{values:s,indices:i}}var T$=J({unique_:U2e});function W2e(e,t,n){let r=z(e,"x","unsortedSegmentSum"),a=z(t,"segmentIds","unsortedSegmentSum","int32");H(lm(n),()=>"numSegments must be of dtype int");let s={x:r,segmentIds:a},i={numSegments:n};return Y.runKernel(fb,s,i)}var gS=J({unsortedSegmentSum_:W2e});function V2e(e,t=0){let n=z(e,"x","unstack","string_or_numeric");H(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);let r={value:n},a={axis:t};return Y.runKernel(qg,r,a)}var Zn=J({unstack_:V2e});function yq(e,t){return tS(e,t,"right")}function j$(e,t=!0,n,r){return Y.makeVariable(e,t,n,r)}function xq(e,t){let n=[];for(let s=0;s<t.length;s++)t[s]&&n.push(s);let r=jt(e,"int32"),a=jt([n.length,e.length],"int32");for(let s=0;s<n.length;s++){let i=r.indexToLoc(n[s]),o=s*e.length;a.values.set(i,o)}return a.toTensor()}async function H2e(e){let t=z(e,"condition","whereAsync","bool"),n=await t.data(),r=xq(t.shape,n);return e!==t&&t.dispose(),r}var A$=H2e;async function G2e(e,t,n){let r=z(e,"tensor","boolMask"),a=z(t,"mask","boolMask","bool"),s=n??0,i=a.rank,o=r.shape;H(i>0,()=>"mask cannot be scalar"),Ia(o.slice(s,s+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=s;m<s+i;m++)l*=o[m];let c=o.slice(0,s).concat([l],o.slice(s+i)),u=ee(r,c),h=ee(a,[-1]),p=await A$(h),f=kc(p,[1]),g=ey(u,f,s);return e!==r&&r.dispose(),t!==a&&a.dispose(),f.dispose(),u.dispose(),h.dispose(),p.dispose(),g}var vq=G2e;function q2e(e,t,n){let r=z(e,"x","transpose");if(t==null&&(t=r.shape.map((i,o)=>o).reverse()),H(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(i=>{H(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();let a={x:r},s={perm:t};return r.dtype==="complex64"?te(()=>{let i=mm(r),o=kb(r);return i=Y.runKernel(dl,{x:i},s),o=Y.runKernel(dl,{x:o},s),n&&(o=In(o)),Nl(i,o)}):Y.runKernel(dl,a,s)}var Tt=J({transpose_:q2e});function K2e(e,t,n,r,a=!0){let s=z(e,"v","movingAverage"),i=z(t,"x","movingAverage"),o=z(n,"decay","movingAverage");s8(s,i),H(Cl(s.shape,i.shape),()=>"Shape mismatch in v and x");let l=Ze(1),c=Oe(l,o),u=Z(Oe(i,s),c);if(a){H(r!=null,()=>"When using zeroDebias: true, step is required.");let h=z(r,"step","movingAverage");u=ze(u,Oe(l,Ro(o,h)))}return me(s,u)}var bq=J({movingAverage_:K2e});function Q2e(e,t,n){Ss(n);let r=z(e,"indices","scatterND","int32"),a=z(t,"updates","scatterND");fS(a,r,n);let s={indices:r,updates:a},i={shape:n};return Y.runKernel(Mg,s,i)}var wq=J({scatterND_:Q2e});function X2e(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);let a=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);let i=t.size;if(!(t.rank===0||t.rank===1&&i===a))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${a}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function Y2e(e,t,n,r=0){Ss(n);let a=z(e,"sparseIndices","sparseToDense","int32"),s=z(t,"sparseValues","sparseToDense","string_or_numeric"),i=z(r,"defaultValue","sparseToDense",s.dtype);X2e(a,s,n,i);let o={sparseIndices:a,sparseValues:s,defaultValue:i},l={outputShape:n};return Y.runKernel(Wg,o,l)}var Nq=J({sparseToDense_:Y2e});function J2e(e,t){let n=z(t,"indices","gatherND","int32"),r={params:z(e,"x","gatherND","string_or_numeric"),indices:n};return Y.runKernel(fg,r)}var kq=J({gatherND_:J2e});function Z2e(e,t){if(t==null)return e.shape.slice();if(Cl(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}function eIe(e,t,n,r){let a=z(e,"x","dropout");if(H(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),H(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Dt?a.clone():a;let s=Z2e(a,n),i=1-t,o=ze(Zg(me(wc(s,0,1,"float32",r),i)),i);return Z(a,o)}var $$=J({dropout_:eIe});function R$(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function yS(e,t,n){let r=1-e%2,a=new Float32Array(e);for(let s=0;s<e;++s){let i=2*Math.PI*s/(e+r-1);a[s]=t-n*Math.cos(i)}return cn(a,"float32")}async function tIe(e,t,n=1){let r=z(e,"predictions","inTopK"),a=z(t,"targets","inTopK");H(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),H(r.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`),Ia(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let s=r.shape[r.shape.length-1];H(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);let i=await r.data(),o=await a.data(),[l,c]=[i.length/s,s],u=zG("bool",l);for(let h=0;h<l;h++){let p=h*c,f=i.subarray(p,p+c),g=[];for(let m=0;m<f.length;m++)g.push({value:f[m],index:m});g.sort((m,y)=>y.value-m.value),u[h]=0;for(let m=0;m<n;m++)if(g[m].index===o[h]){u[h]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),va(u,a.shape,"bool")}var Sq=tIe,xm={};gt(xm,{conv2d:()=>aIe,depthwiseConv2d:()=>lIe,matMul:()=>cIe});function nIe(e,t,n,r,a,s="NHWC",i){let o=e;e.rank===3&&(o=ee(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=ee(t,[1,t.shape[0],t.shape[1],t.shape[2]])),H(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),H(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),H(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);let c=s==="NHWC"?o.shape[3]:o.shape[1],u=s==="NHWC"?l.shape[3]:l.shape[1];H(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),H(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),Ea("conv2dDerFilter",a,i);let h={x:o,dy:l},p={strides:r,pad:a,dataFormat:s,dimRoundingMode:i,filterShape:n};return Y.runKernel(Tk,h,p)}var D$=J({conv2DBackpropFilter_:nIe});function xS(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return Z(e,Ep(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function vS(e,t){let n=t,r=mr(e.shape,t.shape);return r.length>0&&(n=Ge(n,r)),ee(n,e.shape)}function bS(e,t,n,r){if(t==="linear")return e;if(t==="relu")return hn(e);if(t==="elu")return Yg(e);if(t==="relu6")return rS(e);if(t==="prelu")return jb(e,n);if(t==="leakyrelu")return Sb(e,r);if(t==="sigmoid")return si(e);throw new Error(`Unknown fused activation ${t}.`)}var wS=(e,t)=>!(e>0)||t==="linear";function rIe({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",wS(Y.state.gradientDepth,l)===!1){H(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let I=Sa(e,t,n,r,a,s,i);return o!=null&&(I=me(I,o)),bS(I,l,c,u)}let h=z(e,"x","conv2d","float32"),p=z(t,"filter","conv2d","float32"),f=h,g=!1;h.rank===3&&(g=!0,f=ee(h,[1,h.shape[0],h.shape[1],h.shape[2]])),H(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),H(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Ea("fused conv2d",r,i);let m=a==="NHWC"?f.shape[3]:f.shape[1];H(p.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${p.shape[2]}.`),H(Lo(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);let y=bb(f.shape,p.shape,n,s,r,i),x;o!=null&&(x=z(o,"bias","fused conv2d"),[x]=qn(x,h),a==="NHWC"?Nn(y.outShape,x.shape):(H(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),H(x.shape.length===0||x.shape[0]===y.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let v;if(c!=null){let I=c.shape;if(H(I.length<=1||I.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${I.length}.`),I.length===1)H(I[0]===1||I[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the number of output channels (${y.outChannels}).`);else if(I.length===3)try{Nn(I,y.outShape)}catch{let S=`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(S)}v=z(c,"prelu weights","fused conv2d")}let b=(I,C)=>{H(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);let[S,E,T,$]=C,_=xS(I,T,l);H(qu(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);let M=YA(E.shape,_,S,n,r),L=D$(E,_,S.shape,n,r),U=[M,L];if($!=null){let O=vS($,_);U.push(O)}return U},w={x:f,filter:p,bias:x,preluActivationWeights:v},k={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return o==null?Do((I,C,S)=>{let E=Y.runKernel(Rd,w,k);return S([C,I,E]),g&&(E=ee(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(f,p):Do((I,C,S,E)=>{let T=Y.runKernel(Rd,w,k);return E([C,I,T,S]),g&&(T=ee(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:b}})(f,p,x)}var aIe=J({fusedConv2d_:rIe});function sIe(e,t,n,r,a,s=[1,1],i){let o=e;e.rank===3&&(o=ee(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=ee(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={x:o,dy:l},u={strides:r,pad:a,dimRoundingMode:i,dilations:s,filterShape:n};return Y.runKernel(jk,c,u)}var _q=J({depthwiseConv2dNativeBackpropFilter_:sIe});function iIe(e,t,n,r,a,s=[1,1],i){let o=t,l=!1;t.rank===3&&(l=!0,o=ee(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={dy:o,filter:n},u={strides:r,pad:a,dimRoundingMode:i,dilations:s,inputShape:e},h=Y.runKernel(Ak,c,u);return l?ee(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var Cq=J({depthwiseConv2dNativeBackpropInput_:iIe});function oIe({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(wS(Y.state.gradientDepth,l)===!1){let k=Cp(e,t,n,r,a,s,i);return o!=null&&(k=me(k,o)),bS(k,l,c,u)}let h=z(e,"x","depthwiseConv2d","float32"),p=z(t,"filter","depthwiseConv2d","float32"),f=h,g=!1;h.rank===3&&(g=!0,f=ee(h,[1,h.shape[0],h.shape[1],h.shape[2]])),H(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),H(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),H(f.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),s==null&&(s=[1,1]),H(Lo(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),Ea("fused depthwiseConv2d",r,i);let m=bb(f.shape,p.shape,n,s,r,i,!0),y;o!=null&&(y=z(o,"bias","fused conv2d"),[y]=qn(y,h),Nn(m.outShape,y.shape));let x;c!=null&&(x=z(c,"prelu weights","fused depthwiseConv2d"));let v=(k,I)=>{H(qu(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);let[C,S,E,T]=I,$=xS(k,E,l),_=Cq(S.shape,$,C,n,r,s,i),M=_q(S,$,C.shape,n,r,s,i);if(T!=null){let L=vS(y,$);return[_,M,L]}return[_,M]},b={x:f,filter:p,bias:y,preluActivationWeights:x},w={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return o==null?Do((k,I,C)=>{let S=Y.runKernel(Dd,b,w);return C([I,k,S]),g&&(S=ee(S,[S.shape[1],S.shape[2],S.shape[3]])),{value:S,gradFunc:v}})(f,p):Do((k,I,C,S)=>{let E=Y.runKernel(Dd,b,w);return S([I,k,E,C]),g&&(E=ee(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(f,p,y)}var lIe=J({fusedDepthwiseConv2d_:oIe});function uIe({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:a,activation:s="linear",preluActivationWeights:i,leakyreluAlpha:o=.2}){if(wS(Y.state.gradientDepth,s)===!1){let T=_t(e,t,n,r);return a!=null&&(T=me(T,a)),bS(T,s,i,o)}let l=z(e,"a","fused matMul"),c=z(t,"b","fused matMul");[l,c]=qn(l,c);let u=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],g=l.shape.slice(0,-2),m=c.shape.slice(0,-2),y=fn(g),x=fn(m);H(u===h,()=>`Error in fused matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);let v=Nn(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,f]),b=n?ee(l,[y,u,p]):ee(l,[y,p,u]),w=r?ee(c,[x,f,h]):ee(c,[x,h,f]),k;a!=null&&(k=z(a,"bias","fused matMul"),[k]=qn(k,l),Nn(v,k.shape));let I;i!=null&&(I=z(i,"prelu weights","fused matMul"));let C=(T,$)=>{let[_,M,L,U]=$,O=xS(ee(T,L.shape),L,s),F,D;if(!n&&!r?(F=_t(O,M,!1,!0),D=_t(_,O,!0,!1)):!n&&r?(F=_t(O,M,!1,!1),D=_t(O,_,!0,!1)):n&&!r?(F=_t(M,O,!1,!0),D=_t(_,O,!1,!1)):(F=_t(M,O,!0,!0),D=_t(O,_,!0,!0)),a!=null){let R=vS(U,O);return[F,D,R]}else return[F,D]},S={a:b,b:w,bias:k,preluActivationWeights:I},E={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:o};return a==null?Do((T,$,_)=>{let M=Y.runKernel($d,S,E);return _([T,$,M]),{value:ee(M,v),gradFunc:C}})(b,w):Do((T,$,_,M)=>{let L=Y.runKernel($d,S,E);return M([T,$,L,_]),{value:ee(L,v),gradFunc:C}})(b,w,k)}var cIe=J({fusedMatMul_:uIe});function dIe(e){return yS(e,.54,.46)}var hIe=J({hammingWindow_:dIe});function pIe(e){return yS(e,.5,.5)}var Iq=J({hannWindow_:pIe});function fIe(e,t,n,r=!1,a=0){let s=0,i=[];for(;s+t<=e.size;)i.push(Ut(e,s,t)),s+=n;if(r)for(;s<e.size;){let o=s+t-e.size,l=wn([Ut(e,s,t-o),xs([o],a)]);i.push(l),s+=n}return i.length===0?So([],[0,t]):ee(wn(i),[i.length,t])}var Eq=J({frame_:fIe});function mIe(e,t,n,r,a=Iq){r==null&&(r=R$(t));let s=Eq(e,t,n),i=Z(s,a(t));return Rb(i,r)}var gIe=J({stft_:mIe});function yIe(e,t,n,r,a="bilinear",s=0){let i=z(e,"image","cropAndResize"),o=z(t,"boxes","cropAndResize","float32"),l=z(n,"boxInd","cropAndResize","int32"),c=o.shape[0];H(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),H(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),H(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),H(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),H(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),H(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);let u={image:i,boxes:o,boxInd:l},h={method:a,extrapolationValue:s,cropSize:r};return Y.runKernel(og,u,h)}var xIe=J({cropAndResize_:yIe});function vIe(e){let t=z(e,"image","flipLeftRight","float32");H(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let n={image:t};return Y.runKernel(hg,n,{})}var bIe=J({flipLeftRight_:vIe});function wIe(e){let t=z(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];H(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),H(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,ds(t,a)}var NIe=J({grayscaleToRGB_:wIe});function kIe(e){let t=z(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];H(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),H(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);let a=t.dtype,s=Se(t,"float32"),i=cn([.2989,.587,.114]),o;switch(t.rank){case 2:o=Vc("ij,j->i",s,i);break;case 3:o=Vc("ijk,k->ij",s,i);break;case 4:o=Vc("ijkl,l->ijk",s,i);break;case 5:o=Vc("ijklm,m->ijkl",s,i);break;case 6:o=Vc("ijklmn,n->ijklm",s,i);break;default:throw new Error("Not a valid tensor rank.")}return o=$r(o,-1),Se(o,a)}var SIe=J({rgbToGrayscale_:kIe});function _Ie(e,t,n=0,r=.5){let a=z(e,"image","rotateWithOffset","float32");H(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);let s={image:a},i={radians:t,fillValue:n,center:r};return Y.runKernel(Qg,s,i)}var CIe=J({rotateWithOffset_:_Ie});function ry(e,t,n,r,a,s){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),s==null&&(s=0);let i=e.shape[0];return n=Math.min(n,i),H(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),H(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),H(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),H(t.rank===1,()=>"scores must be a 1D tensor"),H(t.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${t.shape[0]}`),H(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:s}}function IIe(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let s=z(e,"boxes","nonMaxSuppression","float32"),i=z(t,"scores","nonMaxSuppression","float32"),o=ry(s,i,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return Y.runKernel(Ig,{boxes:s,scores:i},l)}var EIe=J({nonMaxSuppression_:IIe});function TIe(e,t,n){let r=jIe(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function jIe(e,t,n){return $Ie(e,t,n||AIe)}function AIe(e,t){return e>t?1:e<t?-1:0}function $Ie(e,t,n){let r=0,a=e.length,s=0,i=!1;for(;r<a;){s=r+(a-r>>>1);let o=n(t,e[s]);o>0?r=s+1:(a=s,i=!o)}return i?r:-r-1}function Tq(e,t,n,r,a){return M$(e,t,n,r,a,0)}function jq(e,t,n,r,a,s){return M$(e,t,n,r,a,0,!1,s,!0)}function Aq(e,t,n,r,a,s){return M$(e,t,n,r,a,s,!0)}function M$(e,t,n,r,a,s,i=!1,o=!1,l=!1){let c=[];for(let y=0;y<t.length;y++)t[y]>a&&c.push({score:t[y],boxIndex:y,suppressBeginIndex:0});c.sort(hL);let u=s>0?-.5/s:0,h=[],p=[];for(;h.length<n&&c.length>0;){let y=c.pop(),{score:x,boxIndex:v,suppressBeginIndex:b}=y;if(x<a)break;let w=!1;for(let k=h.length-1;k>=b;--k){let I=RIe(e,v,h[k]);if(I>=r){w=!0;break}if(y.score=y.score*DIe(r,u,I),y.score<=a)break}y.suppressBeginIndex=h.length,w||(y.score===x?(h.push(v),p.push(y.score)):y.score>a&&TIe(c,y,hL))}let f=h.length,g=n-f;o&&g>0&&(h.push(...new Array(g).fill(0)),p.push(...new Array(g).fill(0)));let m={selectedIndices:h};return i&&(m.selectedScores=p),l&&(m.validOutputs=f),m}function RIe(e,t,n){let r=e.subarray(t*4,t*4+4),a=e.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),f=(o-s)*(l-i),g=(h-c)*(p-u);if(f<=0||g<=0)return 0;let m=Math.max(s,c),y=Math.max(i,u),x=Math.min(o,h),v=Math.min(l,p),b=Math.max(x-m,0)*Math.max(v-y,0);return b/(f+g-b)}function DIe(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}function hL(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}async function MIe(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let s=z(e,"boxes","nonMaxSuppressionAsync"),i=z(t,"scores","nonMaxSuppressionAsync"),o=ry(s,i,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l=await Promise.all([s.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:h}=Tq(c,u,n,r,a);return s!==e&&s.dispose(),i!==t&&i.dispose(),cn(h,"int32")}var OIe=MIe;function FIe(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=0){let i=z(e,"boxes","nonMaxSuppression"),o=z(t,"scores","nonMaxSuppression"),l=ry(i,o,n,r,a,s);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,s=l.softNmsSigma;let c={boxes:i,scores:o},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:s},h=Y.runKernel(Tg,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}var PIe=J({nonMaxSuppressionWithScore_:FIe});async function LIe(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=0){let i=z(e,"boxes","nonMaxSuppressionAsync"),o=z(t,"scores","nonMaxSuppressionAsync"),l=ry(i,o,n,r,a,s);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,s=l.softNmsSigma;let c=await Promise.all([i.data(),o.data()]),u=c[0],h=c[1],{selectedIndices:p,selectedScores:f}=Aq(u,h,n,r,a,s);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:cn(p,"int32"),selectedScores:cn(f)}}var zIe=LIe;function BIe(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=!1){let i=z(e,"boxes","nonMaxSuppression"),o=z(t,"scores","nonMaxSuppression"),l=ry(i,o,n,r,a,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,p={boxes:i,scores:o},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:s},g=Y.runKernel(Eg,p,f);return{selectedIndices:g[0],validOutputs:g[1]}}var UIe=J({nonMaxSuppressionPadded_:BIe});async function WIe(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=!1){let i=z(e,"boxes","nonMaxSuppressionAsync"),o=z(t,"scores","nonMaxSuppressionAsync"),l=ry(i,o,n,r,a,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[p,f]=await Promise.all([i.data(),o.data()]),{selectedIndices:g,validOutputs:m}=jq(p,f,c,u,h,s);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:cn(g,"int32"),validOutputs:Ze(m,"int32")}}var VIe=WIe;function HIe(e,t,n=!1,r=!1){let a=z(e,"images","resizeBilinear");H(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),H(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),H(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=a,i=!1;a.rank===3&&(i=!0,s=ee(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},c=Y.runKernel(op,o,l);return i?ee(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var $q=J({resizeBilinear_:HIe});function GIe(e,t,n=!1,r=!1){let a=z(e,"images","resizeNearestNeighbor");H(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),H(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),H(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),H(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=a,i=!1;a.rank===3&&(i=!0,s=ee(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:s},l={alignCorners:n,halfPixelCenters:r,size:t},c=Y.runKernel(ip,o,l);return i?ee(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var Rq=J({resizeNearestNeighbor_:GIe});function qIe(e,t="binary",n=!1,r=.5){let a=z(e,"image","threshold"),s=.2989,i=.587,o=.114,l=a.shape[0]*a.shape[1],c=Z(cn([r]),255),u,h,p,f;if(H(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),H(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),H(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),H(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),a.shape[2]===3){[u,h,p]=za(a,[1,1,1],-1);let m=Z(u,s),y=Z(h,i),x=Z(p,o);f=me(me(m,y),x)}else f=e;if(t==="otsu"){let m=HA(Se(aS(f),"int32"),va([]),256);c=KIe(m,l)}let g=n?bc(f,c):Ta(f,c);return Se(Z(g,255),"int32")}function KIe(e,t){let n=cn([-1]),r=cn([0]),a=cn([0]),s,i,o,l,c,u;for(let h=0;h<e.size-1;h++){s=Ut(e,0,h+1),i=Ut(e,h+1),c=ze(Ge(s),t),u=ze(Ge(i),t);let p=Ge(Z(s,Wd(0,s.size)));o=ze(p,Ge(s));let f=xs(i.shape,s.size),g=me(Wd(0,i.size),f),m=Z(i,g);l=ze(Ge(m),Ge(i));let y=Oe(o,l),x=Oe(o,l),v=Z(c,u);a=Z(Z(v,y),x);let b=Ta(a,r);r=Mr(b,a,r),n=Mr(b,cn([h]),n)}return n}var QIe=J({threshold_:qIe});function XIe(e,t,n="nearest",r="constant",a=0,s){let i=z(e,"image","transform","float32"),o=z(t,"transforms","transform","float32");H(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),H(o.rank===2&&(o.shape[0]===i.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),H(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);let l={image:i,transforms:o},c={interpolation:n,fillMode:r,fillValue:a,outputShape:s};return Y.runKernel(Gg,l,c)}var YIe=J({transform_:XIe});function JIe(e,t,n){let r=z(e,"a","bandPart");H(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let a=r.shape,[s,i]=r.shape.slice(-2),o,l;typeof t=="number"?(H(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),H(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),o=z(t<0?s:t,"numLower","bandPart")):(H(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Mr(pm(t,0),s,Qu(t,s))),typeof n=="number"?(H(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),H(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=z(n<0?i:n,"numUpper","bandPart")):(H(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Mr(pm(n,0),i,Qu(n,i)));let c=ee(Wd(0,s,1,"int32"),[-1,1]),u=Wd(0,i,1,"int32"),h=Oe(c,u),p=ui(bc(h,o),Tl(h,In(l))),f=Vn([s,i],r.dtype);return ee(pr(Zn(ee(r,[-1,s,i])).map(g=>Mr(p,g,f))),a)}var ZIe=J({bandPart_:JIe});function eEe(e){let t;if(Array.isArray(e)){t=!1,H(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let a=e[0].shape[0];for(let s=1;s<e.length;++s)H(e[s].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[s].shape[0]} vs. ${a})`)}else t=!0,e=za(e,e.shape[0],0).map(a=>kc(a,[0]));H(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let n=[],r=e;for(let a=0;a<e.length;++a)n.push(Y.tidy(()=>{let s=r[a];if(a>0)for(let i=0;i<a;++i){let o=Z(Ge(Z(n[i],s)),n[i]);s=Oe(s,o)}return ze(s,Jg(s,"euclidean"))}));return t?pr(n,0):n}var tEe=J({gramSchmidt_:eEe});function nEe(e,t=!1){if(H(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return pL(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((l,c)=>l*c),r=Zn(ee(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],s=[];r.forEach(l=>{let[c,u]=pL(l,t);a.push(c),s.push(u)});let i=ee(pr(a,0),e.shape),o=ee(pr(s,0),e.shape);return[i,o]}}function pL(e,t=!1){return Y.tidy(()=>{H(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let n=e.shape[0],r=e.shape[1],a=Yk(n),s=ko(e),i=So([[1]],[1,1]),o=ko(i),l=n>=r?r:n;for(let c=0;c<l;++c){let u=s,h=o,p=a;[o,s,a]=Y.tidy(()=>{let f=Ut(s,[c,c],[n-c,1]),g=Jg(f),m=Ut(s,[c,c],[1,1]),y=Mr(Ta(m,0),So([[-1]]),So([[1]])),x=Oe(m,Z(y,g)),v=ze(f,x);v.shape[0]===1?o=ko(i):o=wn([i,Ut(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);let b=In(ze(_t(y,x),g)),w=Ut(s,[c,0],[n-c,r]),k=Z(b,o),I=Tt(o);if(c===0)s=Oe(w,_t(k,_t(I,w)));else{let E=Oe(w,_t(k,_t(I,w)));s=wn([Ut(s,[0,0],[c,r]),E],0)}let C=Tt(k),S=Ut(a,[0,c],[n,a.shape[1]-c]);if(c===0)a=Oe(S,_t(_t(S,o),C));else{let E=Oe(S,_t(_t(S,o),C));a=wn([Ut(a,[0,0],[n,c]),E],1)}return[o,s,a]}),mt([u,h,p])}return!t&&n>r&&(a=Ut(a,[0,0],[n,r]),s=Ut(s,[0,0],[r,r])),[a,s]})}var rEe=J({qr_:nEe}),ya;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ya||(ya={}));function aEe(e,t,n=ya.SUM_BY_NONZERO_WEIGHTS){let r=z(e,"losses","computeWeightedLoss"),a=null;t!=null&&(a=z(t,"weights","computeWeightedLoss"));let s=a==null?r:Z(r,a);if(n===ya.NONE)return s;if(n===ya.SUM)return Ge(s);if(n===ya.MEAN){if(a==null)return Wn(s);{let i=r.size/a.size,o=ze(Ge(s),Ge(a));return i>1?ze(o,Ze(i)):o}}if(n===ya.SUM_BY_NONZERO_WEIGHTS){if(a==null)return ze(Ge(s),Ze(r.size));{let i=Z(a,Pa(r.shape)),o=Se(Ge(Ud(i,Ze(0))),"float32");return ze(Ge(s),o)}}throw Error(`Unknown reduction: ${n}`)}var jl=J({computeWeightedLoss_:aEe});function sEe(e,t,n,r=ya.SUM_BY_NONZERO_WEIGHTS){let a=z(e,"labels","absoluteDifference"),s=z(t,"predictions","absoluteDifference"),i=null;n!=null&&(i=z(n,"weights","absoluteDifference")),Ia(a.shape,s.shape,"Error in absoluteDifference: ");let o=ur(Oe(a,s));return jl(o,i,r)}var iEe=J({absoluteDifference_:sEe});function oEe(e,t,n,r,a=ya.SUM_BY_NONZERO_WEIGHTS){let s=z(e,"labels","cosineDistance"),i=z(t,"predictions","cosineDistance"),o=null;r!=null&&(o=z(r,"weights","cosineDistance")),Ia(s.shape,i.shape,"Error in cosineDistance: ");let l=Ze(1),c=Oe(l,Ge(Z(s,i),n,!0));return jl(c,o,a)}var lEe=J({cosineDistance_:oEe});function uEe(e,t,n,r=ya.SUM_BY_NONZERO_WEIGHTS){let a=z(e,"labels","hingeLoss"),s=z(t,"predictions","hingeLoss"),i=null;n!=null&&(i=z(n,"weights","hingeLoss")),Ia(a.shape,s.shape,"Error in hingeLoss: ");let o=Ze(1);a=Oe(Z(Ze(2),a),o);let l=hn(Oe(o,Z(a,s)));return jl(l,i,r)}var cEe=J({hingeLoss_:uEe});function dEe(e,t,n,r=1,a=ya.SUM_BY_NONZERO_WEIGHTS){let s=z(e,"labels","huberLoss"),i=z(t,"predictions","huberLoss"),o=null;n!=null&&(o=z(n,"weights","huberLoss")),Ia(s.shape,i.shape,"Error in huberLoss: ");let l=Ze(r),c=ur(Oe(i,s)),u=Qu(c,l),h=Oe(c,u),p=me(Z(Ze(.5),vn(u)),Z(l,h));return jl(p,o,a)}var hEe=J({huberLoss_:dEe});function pEe(e,t,n,r=1e-7,a=ya.SUM_BY_NONZERO_WEIGHTS){let s=z(e,"labels","logLoss"),i=z(t,"predictions","logLoss"),o=null;n!=null&&(o=z(n,"weights","logLoss")),Ia(s.shape,i.shape,"Error in logLoss: ");let l=Ze(1),c=Ze(r),u=In(Z(s,ws(me(i,c)))),h=Z(Oe(l,s),ws(me(Oe(l,i),c))),p=Oe(u,h);return jl(p,o,a)}var fEe=J({logLoss_:pEe});function mEe(e,t,n,r=ya.SUM_BY_NONZERO_WEIGHTS){let a=z(e,"labels","meanSquaredError"),s=z(t,"predictions","meanSquaredError"),i=null;n!=null&&(i=z(n,"weights","meanSquaredError")),Ia(a.shape,s.shape,"Error in meanSquaredError: ");let o=dS(a,s);return jl(o,i,r)}var gEe=J({meanSquaredError_:mEe});function yEe(e,t){let n=z(e,"labels","sigmoidCrossEntropyWithLogits"),r=z(t,"logits","sigmoidCrossEntropyWithLogits");Ia(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let a=hn(r),s=Z(r,n),i=_b(sa(In(ur(r))));return me(Oe(a,s),i)}function xEe(e,t,n,r=0,a=ya.SUM_BY_NONZERO_WEIGHTS){let s=z(e,"multiClassLabels","sigmoidCrossEntropy"),i=z(t,"logits","sigmoidCrossEntropy"),o=null;if(n!=null&&(o=z(n,"weights","sigmoidCrossEntropy")),Ia(s.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){let c=Ze(r),u=Ze(1),h=Ze(.5);s=me(Z(s,Oe(u,c)),Z(h,c))}let l=yEe(s,i);return jl(l,o,a)}var vEe=J({sigmoidCrossEntropy_:xEe});function bEe(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Do((r,a,s)=>{let i=Cb(a,[n],!0),o=Oe(Se(a,"float32"),i);s([r,o]);let l=In(Z(o,r));return{value:Ge(l,[n]),gradFunc:(c,u)=>{let[h,p]=u,f=Bd(c.shape,[n]);return[Z(ee(c,f),Oe(Se(h,"float32"),sa(p))),Z(ee(c,f),Oe(sa(p),Se(h,"float32")))]}}})(e,t)}function wEe(e,t,n,r=0,a=ya.SUM_BY_NONZERO_WEIGHTS){let s=z(e,"onehotLabels","softmaxCrossEntropy"),i=z(t,"logits","softmaxCrossEntropy"),o=null;if(n!=null&&(o=z(n,"weights","softmaxCrossEntropy")),Ia(s.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){let c=Ze(r),u=Ze(1),h=Ze(s.shape[1]);s=me(Z(s,Oe(u,c)),ze(c,h))}let l=bEe(s,i);return jl(l,o,a)}var NEe=J({softmaxCrossEntropy_:wEe});function kEe(e,t,n,r){let a=z(e,"indices","sparseFillEmptyRows","int32"),s=z(t,"values","sparseFillEmptyRows"),i=z(n,"denseShape","sparseFillEmptyRows","int32"),o=z(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);let l={indices:a,values:s,denseShape:i,defaultValue:o},c=Y.runKernel(sb,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}var SEe=J({sparseFillEmptyRows_:kEe});function _Ee(e,t,n){let r=z(e,"inputIndices","sparseReshape","int32"),a=z(t,"inputShape","sparseReshape","int32"),s=z(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);let i={inputIndices:r,inputShape:a,newShape:s},o=Y.runKernel(Ug,i);return{outputIndices:o[0],outputShape:o[1]}}var CEe=J({sparseReshape_:_Ee});function IEe(e,t,n){let r=z(e,"data","sparseSegmentMean"),a=z(t,"indices","sparseSegmentMean","int32"),s=z(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);let i={data:r,indices:a,segmentIds:s};return Y.runKernel(ib,i)}var EEe=J({sparseSegmentMean_:IEe});function TEe(e,t,n){let r=z(e,"data","sparseSegmentSum"),a=z(t,"indices","sparseSegmentSum","int32"),s=z(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);let i={data:r,indices:a,segmentIds:s};return Y.runKernel(ob,i)}var jEe=J({sparseSegmentSum_:TEe});function AEe(e,t,n,r,a,s,i,o){let l=z(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);let c=z(t,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");let u={separator:n,nGramWidths:r,leftPad:a,rightPad:s,padWidth:i,preserveShortSequences:o},h={data:l,dataSplits:c},p=Y.runKernel(cb,h,u);return{nGrams:p[0],nGramsSplits:p[1]}}var $Ee=J({stringNGrams_:AEe});function REe(e,t,n=!0){let r=z(e,"input","stringSplit","string"),a=z(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);let s={skipEmpty:n},i={input:r,delimiter:a},o=Y.runKernel(db,i,s);return{indices:o[0],values:o[1],shape:o[2]}}var DEe=J({stringSplit_:REe});function MEe(e,t){let n=z(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let a={input:n};return Y.runKernel(hb,a,r)}var OEe=J({stringToHashBucketFast_:MEe});function FEe(e,t,n,r=!0){let a=z(e,"input","staticRegexReplace","string"),s={pattern:t,rewrite:n,replaceGlobal:r};return Y.runKernel(ub,{x:a},s)}var PEe=J({staticRegexReplace_:FEe}),Dq={fft:$b,ifft:ym,rfft:Rb,irfft:cS},Mq={hammingWindow:hIe,hannWindow:Iq,frame:Eq,stft:gIe},$s={flipLeftRight:bIe,grayscaleToRGB:NIe,resizeNearestNeighbor:Rq,resizeBilinear:$q,rgbToGrayscale:SIe,rotateWithOffset:CIe,cropAndResize:xIe,nonMaxSuppression:EIe,nonMaxSuppressionAsync:OIe,nonMaxSuppressionWithScore:PIe,nonMaxSuppressionWithScoreAsync:zIe,nonMaxSuppressionPadded:UIe,nonMaxSuppressionPaddedAsync:VIe,threshold:QIe,transform:YIe},O$={bandPart:ZIe,gramSchmidt:tEe,qr:rEe},Oq={absoluteDifference:iEe,computeWeightedLoss:jl,cosineDistance:lEe,hingeLoss:cEe,huberLoss:hEe,logLoss:fEe,meanSquaredError:gEe,sigmoidCrossEntropy:vEe,softmaxCrossEntropy:NEe},Fq={sparseFillEmptyRows:SEe,sparseReshape:CEe,sparseSegmentMean:EEe,sparseSegmentSum:jEe},Pq={stringNGrams:$Ee,stringSplit:DEe,stringToHashBucketFast:OEe,staticRegexReplace:PEe},we={};gt(we,{Serializable:()=>Lq,SerializationMap:()=>zq,getRegisteredName:()=>zEe,registerClass:()=>Bq});var LEe=new Map,ZI=new Map,Lq=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},zq=class rf{constructor(){this.classNameMap={}}static getMap(){return rf.instance==null&&(rf.instance=new rf),rf.instance}static register(t){rf.getMap().classNameMap[t.className]=[t,t.fromConfig]}};function Bq(e,t,n){H(e.className!=null,()=>"Class being registered does not have the static className property defined."),H(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),H(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);let r=n,a=t+">"+r;return zq.register(e),LEe.set(a,e),ZI.set(e,a),e}function zEe(e){return ZI.has(e)?ZI.get(e):e.className}var Al=class extends Lq{minimize(e,t=!1,n){let{value:r,grads:a}=this.computeGradients(e,n);if(n!=null){let s=n.map(i=>({name:i.name,tensor:a[i.name]}));this.applyGradients(s)}else this.applyGradients(a);return mt(a),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return B8(e,t)}dispose(){this.iterations_!=null&&mt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ze(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(Al,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});var F$=class extends Al{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Y.registeredVariables[t],a=!1;this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:te(()=>qt(r).variable(a))}),this.accumulatedUpdates[n]==null&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:te(()=>qt(r).variable(a))});let s=Array.isArray(e)?e[n].tensor:e[t];if(s==null)return;let i=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;te(()=>{let l=me(Z(i,this.rho),Z(vn(s),1-this.rho)),c=Z(ze(Or(me(o,this.epsilon)),Or(me(i,this.epsilon))),s),u=me(Z(o,this.rho),Z(vn(c),1-this.rho));i.assign(l),o.assign(u);let h=me(Z(c,-this.learningRate),r);r.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(mt(this.accumulatedGrads.map(e=>e.variable)),mt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},P$=class extends Al{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Y.registeredVariables[t];this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:te(()=>xs(r.shape,this.initialAccumulatorValue).variable(!1))});let a=Array.isArray(e)?e[n].tensor:e[t];if(a==null)return;let s=this.accumulatedGrads[n].variable;te(()=>{let i=me(s,vn(a));s.assign(i);let o=me(Z(ze(a,Or(me(i,Y.backend.epsilon()))),-this.learningRate),r);r.assign(o)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&mt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},L$=class extends Al{static get className(){return"Adam"}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],te(()=>{this.accBeta1=Ze(t).variable(),this.accBeta2=Ze(n).variable()}),r==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);te(()=>{let n=Oe(1,this.accBeta1),r=Oe(1,this.accBeta2);t.forEach((a,s)=>{let i=Y.registeredVariables[a],o=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:te(()=>qt(i).variable(o))}),this.accumulatedSecondMoment[s]==null&&(this.accumulatedSecondMoment[s]={originalName:`${a}/v`,variable:te(()=>qt(i).variable(o))});let l=Array.isArray(e)?e[s].tensor:e[a];if(l==null)return;let c=this.accumulatedFirstMoment[s].variable,u=this.accumulatedSecondMoment[s].variable,h=me(Z(c,this.beta1),Z(l,1-this.beta1)),p=me(Z(u,this.beta2),Z(vn(l),1-this.beta2)),f=ze(h,n),g=ze(p,r);c.assign(h),u.assign(p);let m=me(Z(ze(f,me(Or(g),this.epsilon)),-this.learningRate),i);i.assign(m)}),this.accBeta1.assign(Z(this.accBeta1,this.beta1)),this.accBeta2.assign(Z(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&mt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),te(()=>{this.accBeta1.assign(Ro(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ro(this.beta2,this.iterations_+1))});let t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},z$=class extends Al{static get className(){return"Adamax"}constructor(e,t,n,r=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],te(()=>{this.iteration=Ze(0).variable(),this.accBeta1=Ze(t).variable()}),r==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);te(()=>{let n=Oe(1,this.accBeta1),r=ze(-this.learningRate,me(Z(this.iteration,this.decay),1));t.forEach((a,s)=>{let i=Y.registeredVariables[a],o=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:qt(i).variable(o)}),this.accumulatedWeightedInfNorm[s]==null&&(this.accumulatedWeightedInfNorm[s]={originalName:`${a}/v`,variable:qt(i).variable(o)});let l=Array.isArray(e)?e[s].tensor:e[a];if(l==null)return;let c=this.accumulatedFirstMoment[s].variable,u=this.accumulatedWeightedInfNorm[s].variable,h=me(Z(c,this.beta1),Z(l,1-this.beta1)),p=Z(u,this.beta2),f=ur(l),g=zo(p,f);c.assign(h),u.assign(g);let m=me(Z(ze(r,n),ze(h,me(g,this.epsilon))),i);i.assign(m)}),this.iteration.assign(me(this.iteration,1)),this.accBeta1.assign(Z(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&mt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},NS=class extends Al{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(r==null)return;let a=Y.registeredVariables[t];te(()=>{let s=me(Z(this.c,r),a);a.assign(s)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=vr(Ze(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},B$=class extends NS{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=Ze(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Y.registeredVariables[t];this.accumulations[n]==null&&(this.accumulations[n]={originalName:`${t}/momentum`,variable:te(()=>qt(r).variable(!1))});let a=this.accumulations[n].variable,s=Array.isArray(e)?e[n].tensor:e[t];s!=null&&te(()=>{let i,o=me(Z(this.m,a),s);this.useNesterov?i=me(Z(this.c,me(s,Z(o,this.m))),r):i=me(Z(this.c,o),r),a.assign(o),r.assign(i)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&mt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},U$=class extends Al{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=Y.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Y.registeredVariables[t],a=!1;this.accumulatedMeanSquares[n]==null&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:te(()=>qt(r).variable(a))}),this.accumulatedMoments[n]==null&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:te(()=>qt(r).variable(a))}),this.accumulatedMeanGrads[n]==null&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:te(()=>qt(r).variable(a))});let s=Array.isArray(e)?e[n].tensor:e[t];if(s==null)return;let i=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;te(()=>{let l=me(Z(i,this.decay),Z(vn(s),1-this.decay));if(this.centered){let c=this.accumulatedMeanGrads[n].variable,u=me(Z(c,this.decay),Z(s,1-this.decay)),h=ze(Z(s,this.learningRate),Or(Oe(l,me(vn(u),this.epsilon)))),p=me(Z(o,this.momentum),h);i.assign(l),c.assign(u),o.assign(p);let f=Oe(r,p);r.assign(f)}else{let c=me(Z(i,this.decay),Z(vn(s),1-this.decay)),u=me(Z(o,this.momentum),ze(Z(s,this.learningRate),Or(me(c,this.epsilon))));i.assign(c),o.assign(u);let h=Oe(r,u);r.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&mt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&mt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&mt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},BEe=[F$,P$,L$,z$,B$,U$,NS];function UEe(){for(let e of BEe)Bq(e)}var qr={};gt(qr,{CompositeArrayBuffer:()=>Il,browserFiles:()=>QEe,browserHTTPRequest:()=>tTe,concatenateArrayBuffers:()=>Tke,copyModel:()=>Yke,decodeWeights:()=>p8,decodeWeightsStream:()=>m8,encodeWeights:()=>kke,fromMemory:()=>rTe,fromMemorySync:()=>Gq,getLoadHandlers:()=>Fke,getModelArtifactsForJSON:()=>jA,getModelArtifactsForJSONSync:()=>y8,getModelArtifactsInfoForJSON:()=>vb,getSaveHandlers:()=>Oke,getWeightSpecs:()=>qI,http:()=>V$,isHTTPScheme:()=>tE,listModels:()=>Qke,loadWeights:()=>YEe,moveModel:()=>Jke,registerLoadRouter:()=>Mke,registerSaveRouter:()=>Dke,removeModel:()=>Xke,weightsLoaderFactory:()=>Wq,withSaveHandler:()=>aTe,withSaveHandlerSync:()=>sTe});var WEe="model",VEe=".json",HEe=".weights.bin";function fL(e){return new Promise(t=>setTimeout(t)).then(e)}var P1=class eE{constructor(t){if(!le().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(eE.URL_SCHEME)&&(t=t.slice(eE.URL_SCHEME.length)),(t==null||t.length===0)&&(t=WEe),this.modelJsonFileName=t+VEe,this.weightDataFileName=t+HEe}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let n=Il.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let a=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],s=g8(t,a),i=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await fL(()=>o.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){let l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await fL(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:vb(t)}}}};P1.URL_SCHEME="downloads://";var GEe=class{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=r=>{let a=JSON.parse(r.target.result),s=a.modelTopology;if(s==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:s});return}let i=jA(a,o=>this.loadWeights(o));e(i)},n.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let s of e)t.push(...s.weights),n.push(...s.paths);let r=this.checkManifestAndWeightFiles(e),a=n.map(s=>this.loadWeightsFile(s,r[s]));return Promise.all(a).then(s=>[t,s])}loadWeightsFile(e,t){return new Promise((n,r)=>{let a=new FileReader;a.onload=s=>{let i=s.target.result;n(i)},a.onerror=s=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(a=>dL(a.name)),r={};for(let a of e)a.paths.forEach(s=>{let i=dL(s);if(t.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(t.push(i),n.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);r[s]=this.weightsFiles[n.indexOf(i)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}},qEe=e=>le().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(P1.URL_SCHEME)?KEe(e.slice(P1.URL_SCHEME.length)):null;Us.registerSaveRouter(qEe);function KEe(e="model"){return new P1(e)}function QEe(e){return new GEe(e)}function mL(e,t,n,r){i(e),n=n??0,r=r??1,o(n,r);let a=0,s=l=>(l.then(c=>{let u=n+ ++a/e.length*(r-n);return t(u),c}),l);function i(l){H(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){H(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),H(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),H(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(e.map(s))}async function Uq(e,t){t==null&&(t={});let n=t.fetchFunc==null?le().platform.fetch:t.fetchFunc,r=e.map(s=>n(s,t.requestInit,{isBinary:!0})),a=(t.onProgress==null?await Promise.all(r):await mL(r,t.onProgress,0,.5)).map(s=>s.arrayBuffer());return t.onProgress==null?await Promise.all(a):await mL(a,t.onProgress,.5,1)}function XEe(e,t){var n;let r=t.fetchFunc==null?le().platform.fetch:t.fetchFunc,a=0,s;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:async i=>{for(var o;a<e.length;){s||(s=(await r(e[a],t.requestInit,{isBinary:!0})).body.getReader());let{done:l,value:c}=await s.read();if(l){a++,s=void 0,(o=t.onProgress)===null||o===void 0||o.call(t,a/e.length);continue}i.enqueue(c);return}i.close()}})}async function YEe(e,t="",n,r){return Wq(a=>Uq(a,{requestInit:r}))(e,t,n)}function Wq(e){return async(t,n="",r)=>{let a=t.map(()=>!1),s={},i=r!=null?r.map(()=>!1):[],o=[];if(t.forEach((f,g)=>{let m=0;f.weights.forEach(y=>{let x="quantization"in y?y.quantization.dtype:y.dtype,v=Od[x]*fn(y.shape),b=()=>{a[g]=!0,s[g]==null&&(s[g]=[]),s[g].push({manifestEntry:y,groupOffset:m,sizeBytes:v})};r!=null?r.forEach((w,k)=>{w===y.name&&(b(),i[k]=!0)}):b(),o.push(y.name),m+=v})}),!i.every(f=>f)){let f=r.filter((g,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}let l=a.reduce((f,g,m)=>(g&&f.push(m),f),[]),c=[];l.forEach(f=>{t[f].paths.forEach(g=>{let m=n+(n.endsWith("/")?"":"/")+g;c.push(m)})});let u=await e(c),h={},p=0;return l.forEach(f=>{let g=t[f].paths.length,m=new Il(u.slice(p,p+g));s[f].forEach(y=>{let x=m.slice(y.groupOffset,y.groupOffset+y.sizeBytes),v=p8(x,[y.manifestEntry]);for(let b in v)h[b]=v[b]}),p+=g}),h}}var JEe="application/octet-stream",ZEe="application/json",W$=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(H(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=le().platform.fetch,H(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&H(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=g8(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:ZEe}),"model.json"),e.weightData!=null){let s=Il.join(e.weightData);t.body.append("model.weights.bin",new Blob([s],{type:JEe}),"model.weights.bin")}let a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:vb(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){let e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let s=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?s+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":s+=" Please make sure the server is serving valid JSON for this request.",new Error(s)}let n=t.modelTopology,r=t.weightsManifest;if(n==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();let e=await this.loadModelJSON();return jA(e,t=>this.loadWeights(t))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=qI(e.weightsManifest),r=()=>XEe(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:r})}async getWeightUrls(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=eTe(t),a=this.weightPathPrefix||n,s=[],i=[];for(let o of e)for(let l of o.paths)this.weightUrlConverter!=null?i.push(this.weightUrlConverter(l)):s.push(a+l+r);return this.weightUrlConverter&&s.push(...await Promise.all(i)),s}async loadWeights(e){let t=await this.getWeightUrls(e),n=qI(e),r=await Uq(t,this.loadOptions);return[n,r]}};W$.URL_SCHEME_REGEX=/^https?:\/\//;function eTe(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}function tE(e){return e.match(W$.URL_SCHEME_REGEX)!=null}var Vq=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>tE(r)):n=tE(e),n)return V$(e,t)}return null};Us.registerSaveRouter(Vq);Us.registerLoadRouter(Vq);function V$(e,t){return new W$(e,t)}function tTe(e,t){return V$(e,t)}var vC=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},Hq=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},nTe=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function rTe(e,t,n,r){let a=arguments;return new nTe(Gq(...a))}function Gq(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new vC(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vC({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new vC({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function aTe(e){return new Hq(e)}function sTe(e){return new Hq(e)}var qq={};gt(qq,{confusionMatrix:()=>oTe});function iTe(e,t,n){let r=z(e,"labels","confusionMatrix"),a=z(t,"predictions","confusionMatrix");H(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),H(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),H(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),H(r.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),H(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);let s=fm(Se(r,"int32"),n),i=fm(Se(a,"int32"),n),o=Tt(s),l=_t(o,i);return Se(l,"int32")}var oTe=J({confusionMatrix_:iTe}),Db={};gt(Db,{draw:()=>mTe,fromPixels:()=>gTe,fromPixelsAsync:()=>hTe,toPixels:()=>fTe});var Rc,gL=!1;function Kq(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,s=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)s=!0;else if(e.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(ev(D1,Y.backendName)!=null){let p={pixels:e},f={numChannels:t};return Y.runKernel(D1,p,f)}let[l,c]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],u;if(i)u=e.getContext("2d").getImageData(0,0,l,c).data;else if(r||n)u=e.data;else if(s||a||o){if(Rc==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Rc=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Rc=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Rc.canvas.width=l,Rc.canvas.height=c,Rc.drawImage(e,0,0,l,c),u=Rc.getImageData(0,0,l,c).data}let h;if(t===4)h=new Int32Array(u);else{let p=l*c;h=new Int32Array(p*t);for(let f=0;f<p;f++)for(let g=0;g<t;++g)h[f*t+g]=u[f*4+g]}return hS(h,[c,l,t],"int32")}function lTe(e){return e!=null&&e.data instanceof Uint8Array}function uTe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function cTe(e){return e!=null&&e.width!==0&&e.height!==0}function dTe(e){return uTe()&&!(e instanceof ImageBitmap)&&cTe(e)&&!lTe(e)}async function hTe(e,t=3){let n=null;if(le().getBool("WRAP_TO_IMAGEBITMAP")&&dTe(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return Kq(n,t)}function Qq(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function pTe(e){let t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function fTe(e,t){let n=z(e,"img","toPixels");if(!(e instanceof Dt)){let c=n;n=Se(c,"int32"),c.dispose()}Qq(n);let[r,a]=n.shape.slice(0,2),s=n.rank===2?1:n.shape[2],i=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*r*4);for(let c=0;c<r*a;++c){let u=[0,0,0,255];for(let p=0;p<s;p++){let f=i[c*s+p];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);s===1?(u[0]=f*o,u[1]=f*o,u[2]=f*o):u[p]=f*o}let h=c*4;l[h+0]=Math.round(u[0]),l[h+1]=Math.round(u[1]),l[h+2]=Math.round(u[2]),l[h+3]=Math.round(u[3])}if(t!=null){gL||ev($k,Y.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),gL=!0),t.width=a,t.height=r;let c=t.getContext("2d"),u=new ImageData(l,a,r);c.putImageData(u,0,0)}return n!==e&&n.dispose(),l}function mTe(e,t,n){let r=z(e,"img","draw");if(!(e instanceof Dt)){let i=r;r=Se(i,"int32"),i.dispose()}Qq(r),pTe(n==null?void 0:n.imageOptions);let a={image:r},s={canvas:t,options:n};Y.runKernel($k,a,s)}var gTe=J({fromPixels_:Kq}),H$={};gt(H$,{prepareAndValidate:()=>Xq});function Xq(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(fn(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let a=t.shape,s=a[a.length-1],i=1;for(let h=0;h<a.length-1;++h)i*=a[h];let o=e.shape,l=a.slice();l.pop();let c=1;for(let h=s;h<n;++h)c*=o[h],l.push(o[h]);let u=[...qm(e.shape).map(h=>h/c),1].slice(0,s);return[l,i,c,u]}var wr={};gt(wr,{assertParamsValid:()=>xTe,computeFlatOffset:()=>kTe,computeOutShape:()=>bTe,getNormalizedAxes:()=>wTe,isSliceContinous:()=>NTe,maskToAxes:()=>vTe,parseSliceParams:()=>s7,sliceInfo:()=>STe,startForAxis:()=>r7,startIndicesWithElidedDims:()=>e7,stopForAxis:()=>a7,stopIndicesWithElidedDims:()=>t7,stridesForAxis:()=>n7,stridesWithElidedDims:()=>Yq});var nE=-2,yTe=-1;function xTe(e,t,n){let r=e.shape.length;H(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),H(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let a=0;a<r;++a)H(t[a]+n[a]<=e.shape[a],()=>`Error in slice${r}D: begin[${a}] + size[${a}] (${t[a]+n[a]}) would overflow input.shape[${a}] (${e.shape[a]})`)}function vTe(e){let t=[],n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function bTe(e,t,n){let r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function Yq(e,t,n,r){let a=[...e];for(let s=a.length;s<r.length;s++)a.push(1);for(let s=0;s<n;s++)s===0?a[t]=1:(a.splice(t,0,1),a.pop());return a}function Jq(e,t,n){return n<=e?n:n-(t-1)}function Zq(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function wTe(e,t,n,r,a,s,i,o,l){let c=e.length,u=new Array(c),h=new Array(c),p=new Array(c);if(t.length&&n>0){let f=t[0],g=n+1;u=e7(i,f,g,r,e),h=t7(o,f,g,a,e),p=Yq(s,f,g,e)}else for(let f=0;f<c;f++)u[f]=r7(i,r,s,e,f,l),h[f]=a7(o,a,s,e,f,l),p[f]=n7(s,f,l);return{begin:u,end:h,strides:p}}function e7(e,t,n,r,a){let s=[...a],i=Zq(n,t);for(let o=0;o<s.length;o++)if(i.indexOf(o)>-1)s[o]=0;else{let l=Jq(t,n,o),c=r[l];e&1<<l&&(c=0),s[o]=c}return s}function t7(e,t,n,r,a){let s=[...a],i=Zq(n,t);for(let o=0;o<s.length;o++)if(i.indexOf(o)>-1)s[o]=Number.MAX_SAFE_INTEGER;else{let l=Jq(t,n,o),c=r[l];e&1<<l&&(c=Number.MAX_SAFE_INTEGER),s[o]=c}for(let o=0;o<s.length;o++){let l=a[o];s[o]<0&&(s[o]+=l),s[o]=Jx(0,s[o],a[o])}return s}function n7(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function r7(e,t,n,r,a,s){let i=t[a],o=n[a]||1;(e&1<<a||s&1<<a||i==null)&&(o>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);let l=r[a];return i<0&&(i+=l),i=Jx(0,i,l-1),i}function a7(e,t,n,r,a,s){let i=t[a],o=n[a]||1;(e&1<<a||s&1<<a||i==null)&&(o>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);let l=r[a];return i<0&&(i+=l),o>0?i=Jx(0,i,l):i=Jx(-1,i,l-1),i}function NTe(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function kTe(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function s7(e,t,n){let r,a=e.shape.length;typeof t=="number"?r=[t,...new Array(a-1).fill(0)]:t.length<a?r=t.concat(new Array(a-t.length).fill(0)):r=t.slice(),r.forEach(i=>{H(i!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(a).fill(-1):typeof n=="number"?s=[n,...new Array(a-1).fill(-1)]:n.length<a?s=n.concat(new Array(a-n.length).fill(-1)):s=n,s=s.map((i,o)=>i>=0?i:(H(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${o}.`),e.shape[o]-r[o])),[r,s]}function STe(e,t,n,r,a,s,i,o,l){let c;if(r==null?(c=new Array(t.length),c.fill(1)):c=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1,h={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:s,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let v=0;v<h.dims;v++)u&&1<<v&o&&h.numAddAxisAfterEllipsis++,1<<v&i&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};_Te(h,p);let f=!0,g=!0,m=!0,y=[],x=[];for(let v=0;v<e.length;++v){if(p.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);let b=!!(p.shrinkAxisMask&1<<v),w=e[v];if(w===-1){y.push(b?1:-1);continue}let k=[p.beginMask&1<<v,p.endMask&1<<v],I=[p.strides[v]>0?0:-1,p.strides[v]>0?w:w-1];if(b&&p.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&p.strides[v]===1;let C=!!(p.beginMask&1<<v&&p.endMask&1<<v);if(p.beginValid&&p.endValid){if(b){let $=p.begin[v]<0?w+p.begin[v]:p.begin[v];if(p.begin[v]=$,p.end[v]=p.begin[v]+1,$<0||$>=w)throw Error(`slice index ${p.begin[v]} of dimension ${v} out of bounds.`)}else p.begin[v]=yL(p.begin[v],0,p.strides[v],w,k,I),p.end[v]=yL(p.end[v],1,p.strides[v],w,k,I);let T=p.strides[v]===1&&p.begin[v]===0&&p.end[v]===w;f=f&&T,g=g&&(v===0&&p.strides[v]===1||T)}else f=f&&p.strides[v]===1&&C,g=g&&(v===0&&p.strides[v]===1||C);let S,E=!1;if(p.beginValid&&p.endValid?(S=p.end[v]-p.begin[v],E=!0):b?(S=1,E=!0):C&&w>=0&&(p.strides[v]<0?S=-w:S=w,E=!0),E){let T;S===0||S<0!=p.strides[v]<0?T=0:T=Math.trunc(S/p.strides[v])+(S%p.strides[v]!==0?1:0),y.push(T)}else y.push(-1)}for(let v=0;v<p.finalShapeGatherIndices.length;++v){let b=p.finalShapeGatherIndices[v];b>=0?x.push(y[b]):b===nE&&x.push(1)}return{finalShapeSparse:x.filter((v,b)=>p.finalShapeGatherIndices[b]!==nE),finalShape:x,isIdentity:f,sliceDim0:g,isSimpleSlice:m,begin:p.begin,end:p.end,strides:p.strides}}function _Te(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(nE),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(yTe),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function yL(e,t,n,r,a,s){if(a[t])return n>0?s[t]:s[t+1&1];{let i=e<0?r+e:e;return i<s[0]?s[0]:i>s[1]?s[1]:i}}var CTe="4.22.0",i7=class{static sgd(e){return new NS(e)}static momentum(e,t,n=!1){return new B$(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,a=!1){return new U$(e,t,n,r,a)}static adam(e=.001,t=.9,n=.999,r=null){return new L$(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new F$(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,a=0){return new z$(e,t,n,r,a)}static adagrad(e,t=.1){return new P$(e,t)}},zc=i7,ITe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function G$(){return new Promise(e=>ITe(()=>e()))}var P={};gt(P,{ERF_A1:()=>UTe,ERF_A2:()=>WTe,ERF_A3:()=>VTe,ERF_A4:()=>HTe,ERF_A5:()=>GTe,ERF_P:()=>BTe,PARALLELIZE_THRESHOLD:()=>q$,RowPartitionType:()=>lo,SELU_SCALE:()=>l7,SELU_SCALEALPHA:()=>o7,applyActivation:()=>bS,assertAndGetBroadcastShape:()=>Nn,assertAxesAreInnerMostDims:()=>S_e,assertParamsConsistent:()=>ETe,assignToTypedArray:()=>JTe,axesAreInnerMostDims:()=>a$,calculateShapes:()=>mq,checkEinsumDimSizes:()=>aje,checkPadOnDimRoundingMode:()=>Ea,combineLocations:()=>O8,combineRaggedTensorToTensorShapes:()=>jTe,complexWithEvenIndex:()=>QTe,complexWithOddIndex:()=>XTe,computeConv2DInfo:()=>bb,computeConv3DInfo:()=>I8,computeDefaultPad:()=>zA,computeDilation2DInfo:()=>NSe,computeOptimalWindowSize:()=>DTe,computeOutAndReduceShapes:()=>F8,computeOutShape:()=>TTe,computePool2DInfo:()=>C8,computePool3DInfo:()=>kSe,convertConv2DDataFormat:()=>E8,decodeEinsumEquation:()=>nje,eitherStridesOrDilationsAreOne:()=>Lo,expandShapeToKeepDim:()=>Bd,exponent:()=>eje,exponents:()=>ZTe,fromStringArrayToUint8:()=>_je,fromUint8ToStringArray:()=>Sje,getAxesPermutation:()=>P8,getBroadcastDims:()=>D8,getComplexWithIndex:()=>YTe,getEinsumComputePath:()=>sje,getEinsumPermutation:()=>rje,getFusedBiasGradient:()=>vS,getFusedDyActivation:()=>xS,getImageCenter:()=>MTe,getInnerMostAxes:()=>__e,getPermuted:()=>FTe,getRaggedRank:()=>$Te,getReductionAxes:()=>mr,getReshaped:()=>OTe,getReshapedPermuted:()=>PTe,getRowPartitionTypesHelper:()=>ATe,getSliceBeginCoords:()=>LTe,getSliceSize:()=>zTe,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>uje,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>cje,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>dje,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>fje,getSparseReshapeInputOutputMismatchErrorMessage:()=>gje,getSparseReshapeInputOutputMultipleErrorMessage:()=>mje,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>hje,getSparseReshapeNegativeOutputDimErrorMessage:()=>pje,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>bje,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>yje,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>xje,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>vje,getUndoAxesPermutation:()=>s$,isIdentityPermutation:()=>ije,log:()=>DNe,mergeRealAndImagArrays:()=>qTe,prepareAndValidate:()=>Xq,prepareSplitSize:()=>lje,segment_util:()=>u7,shouldFuse:()=>wS,slice_util:()=>wr,splitRealAndImagArrays:()=>KTe,stridesOrDilationsArePositive:()=>zd,tupleValuesAreOne:()=>qu,upcastType:()=>Bs,validateDefaultValueShape:()=>RTe,validateInput:()=>fS,validateUpdateShape:()=>I$,warn:()=>nu});function ETe(e,t){let n=e[0].length;e.forEach((a,s)=>{H(a.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),H(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);let r=e[0];e.forEach((a,s)=>{for(let i=0;i<n;i++)H(i===t||a[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${s}] (${a}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function TTe(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var lo;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(lo||(lo={}));function jTe(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){let s=n[a],i=r[r.length-n.length+a],o=r[i];if(s>=0)if(o>=0){if(o!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${a+e}] = ${s} but shape[${a+e}] = ${o}`)}else r[i]=s}return r}function ATe(e){let t={FIRST_DIM_SIZE:lo.FIRST_DIM_SIZE,VALUE_ROWIDS:lo.VALUE_ROWIDS,ROW_LENGTHS:lo.ROW_LENGTHS,ROW_SPLITS:lo.ROW_SPLITS,ROW_LIMITS:lo.ROW_LIMITS,ROW_STARTS:lo.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function $Te(e){return e.length===0?0:e[0]===lo.FIRST_DIM_SIZE?e.length-1:e.length}function RTe(e,t){if(e==null||t==null)return;let n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){let s=e[a],i=t[a+1];if(s>=0&&i>=0&&s!==1&&s!==i)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${a-e.length}] = ${s} but ragged tensor input.flatValues.shape[${a-e.length}] = ${i}`)}}var q$=30;function DTe(e){return e<=q$?e:R1(e,Math.floor(Math.sqrt(e)))}function MTe(e,t,n){let r=n*(typeof e=="number"?e:e[0]),a=t*(typeof e=="number"?e:e[1]);return[r,a]}function OTe(e,t,n,r=!0){let a=[];if(r)a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let s=t.length;for(let i=0;i<s;++i)a=a.concat([e[i+1]/t[i],t[i]]);a=a.concat(e.slice(s+1))}return a}function FTe(e,t,n=!0){let r=[];if(n){r.push(t);for(let a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{let a=[],s=[];for(let i=1;i<e;++i)i>=t*2+1||i%2===1?s.push(i):a.push(i);r.push(...a),r.push(0),r.push(...s)}return r}function PTe(e,t,n,r=!0){let a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let s=1;s<e.length;++s)s<=t.length?r?a.push(t[s-1]*e[s]):a.push(e[s]/t[s-1]):a.push(e[s]);return a}function LTe(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function zTe(e,t,n){let r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var o7=1.7580993408473768,l7=1.0507009873554805,BTe=.3275911,UTe=.254829592,WTe=-.284496736,VTe=1.421413741,HTe=-1.453152027,GTe=1.061405429;function qTe(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function KTe(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function QTe(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function XTe(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function YTe(e,t){let n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function JTe(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function ZTe(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){let s=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(s),r[a]=Math.sin(s)}return{real:n,imag:r}}function eje(e,t,n){let r=(n?2:-2)*Math.PI*(e/t),a=Math.cos(r),s=Math.sin(r);return{real:a,imag:s}}var bC="->",tje=/->/g,xL=",",vL="...";function nje(e,t){e=e.replace(/\s/g,"");let n=(e.length-e.replace(tje,"").length)/bC.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${bC}").`);let[r,a]=e.split(bC);H(r.indexOf(vL)===-1,()=>`The ellipsis notation ("${vL}") is not supported yet.`);let s=r.split(xL),i=s.length;if(t!==i)throw new Error(`Expected ${i} input tensors, received ${t}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let p=0;p<a.length;++p){let f=a[p];if(!s.some(g=>g.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);o.indexOf(f)===-1&&o.push(f)}for(let p=0;p<r.length;++p){let f=r[p];o.indexOf(f)===-1&&f!==xL&&o.push(f)}let l=new Array(s.length);for(let p=0;p<i;++p){if(new Set(s[p].split("")).size!==s[p].length)throw new Error(`Found duplicate axes in input component ${s[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let f=0;f<s[p].length;++f)l[p].push(o.indexOf(s[p][f]))}let c=o.length,u=a.length,h=[];for(let p=u;p<c;++p)h.push(p);return{allDims:o,summedDims:h,idDims:l}}function rje(e,t){let n=new Array(e);n.fill(-1);for(let a=0;a<t.length;++a)n[t[a]]=a;let r=[];for(let a=0;a<e;++a)n[a]===-1&&r.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:r}}function aje(e,t,n){let r=new Array(e);for(let a=0;a<n.length;++a){let s=n[a].shape;for(let i=0;i<t[a].length;++i)r[t[a][i]]===void 0?r[t[a][i]]=s[i]:H(r[t[a][i]]===s[i],()=>`Expected dimension ${r[t[a][i]]} at axis ${i} of input shaped ${JSON.stringify(s)}, but got dimension ${s[i]}`)}}function sje(e,t){let n=e,r=[],a=0;e.length===0&&n.push(-1),a=e.length+1;for(let i=0;i<a;++i)r.push([]);let s=[];for(let i=0;i<n.length;++i){let o=n[i],l=oje(t,o);for(let c of l)s.indexOf(c)===-1&&(r[i].push(c),s.push(c))}return{path:n,steps:r}}function ije(e){return e.every((t,n)=>t===n)}function oje(e,t){let n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function lje(e,t,n=0){let r=[];if(typeof t=="number")H(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{let a=t.reduce((i,o)=>(o===-1&&(i+=1),i),0);H(a<=1,()=>"There should be only one negative value in split array.");let s=t.indexOf(-1);if(s!==-1){let i=t.reduce((o,l)=>l>0?o+l:o);t[s]=e.shape[n]-i}H(e.shape[n]===t.reduce((i,o)=>i+o),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function uje(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function cje(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function dje(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function hje(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function pje(e,t){return`size ${e} must be non-negative, not ${t}`}function fje(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function mje(e,t){let n=fn(e),r=fn(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function gje(e,t){let n=fn(e),r=fn(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}function yje(){return"segment ids must be >= 0"}function xje(){return"segment ids are not increasing"}function vje(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function bje(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}var u7={};gt(u7,{collectGatherOpShapeInfo:()=>kje,computeOutShape:()=>Nje,segOpComputeOptimalWindowSize:()=>wje});function wje(e,t){let n=!1,r;for(e<=q$?(r=e,n=!0):r=R1(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=R1(e,r+1);return r}function Nje(e,t,n){let r=[],a=e.length;for(let s=0;s<a;s++)s!==t?r.push(e[s]):r.push(n);return r}function kje(e,t,n,r){let a=t.shape.length,s=e.shape.length;if(r!==0&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let h=0;h<r;++h)if(e.shape[h]!==t.shape[h])throw new Error(`x.shape[${h}]: ${e.shape[h]} should be equal to indices.shape[${h}]: ${t.shape[h]}.`);let i=e.shape[n],o=[],l=1,c=1,u=1;for(let h=0;h<r;++h)o.push(e.shape[h]),l*=e.shape[h];for(let h=r;h<n;h++)o.push(e.shape[h]),c*=e.shape[h];for(let h=r;h<a;h++)o.push(t.shape[h]);for(let h=n+1;h<s;h++)o.push(e.shape[h]),u*=e.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:o}}function Sje(e){try{return e.map(t=>O1(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function _je(e){return e.map(t=>yb(t))}var Bo={};gt(Bo,{nonMaxSuppressionV3Impl:()=>Tq,nonMaxSuppressionV4Impl:()=>jq,nonMaxSuppressionV5Impl:()=>Aq,whereImpl:()=>xq});UEe();var c7={kernelName:Km,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(e,Ep(Se(n,"float32"),-1))}}},Cje={kernelName:oh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=vn(Se(n,"float32")),a=Or(Oe(Ze(1),r));return In(ze(e,a))}}}},Ije={kernelName:lh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Or(Oe(vn(Se(n,"float32")),1));return ze(e,r)}}}},Eje={kernelName:mc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Nn(n.shape,r.shape);return{a:()=>{let s=e,i=mr(n.shape,a);return i.length>0&&(s=Ge(s,i)),ee(s,n.shape)},b:()=>{let s=e,i=mr(r.shape,a);return i.length>0&&(s=Ge(s,i)),ee(s,r.shape)}}}},Tje={kernelName:uh,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((r,a)=>{n[a]=()=>e.clone()}),n}},jje={kernelName:Ym,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>qt(n)}}},Aje={kernelName:Jm,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>qt(n)}}},$je={kernelName:ch,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,Or(Oe(Ze(1),vn(Se(n,"float32")))))}}},Rje={kernelName:dh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Or(me(Ze(1),vn(Se(n,"float32"))));return ze(e,r)}}}},Dje={kernelName:fh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Nn(n.shape,r.shape);return{a:()=>{let s=me(vn(n),vn(r)),i=Z(e,ze(r,s)),o=mr(n.shape,a);return o.length>0&&(i=Ge(i,o)),ee(i,n.shape)},b:()=>{let s=me(vn(n),vn(r)),i=In(Z(e,ze(n,s))),o=mr(r.shape,a);return o.length>0&&(i=Ge(i,o)),ee(i,r.shape)}}}},Mje={kernelName:hh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,me(vn(Se(n,"float32")),1))}}},Oje={kernelName:ph,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,Oe(Ze(1),vn(Se(n,"float32"))))}}};function Fje(e,t,n,r,a,s){let i=z(e,"dy","avgPool3dGrad"),o=z(t,"input","avgPool3dGrad"),l=i,c=o,u=!1;o.rank===4&&(u=!0,l=ee(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=ee(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),H(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),H(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Ea("avgPool3dGrad",a,s);let h={dy:l,input:c},p={filterSize:n,strides:r,pad:a,dimRoundingMode:s},f=Y.runKernel(Qv,h,p);return u?ee(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var Pje=J({avgPool3dGrad_:Fje}),Lje={kernelName:Zm,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:s,pad:i,dimRoundingMode:o}=n;return{x:()=>Pje(e,r,a,s,i,o)}}};function zje(e,t,n,r,a){let s=z(e,"dy","avgPoolGrad"),i=z(t,"input","avgPoolGrad");H(i.rank===s.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${s.rank})`);let o=i,l=s,c=!1;i.rank===3&&(c=!0,o=ee(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=ee(s,[1,s.shape[0],s.shape[1],s.shape[2]])),H(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),H(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);let u={dy:l,input:o},h={filterSize:n,strides:r,pad:a},p=Y.runKernel(Kv,u,h);return c?ee(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Bje=J({avgPoolGrad_:zje}),Uje={kernelName:mh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:s,pad:i}=n;return{x:()=>Bje(e,r,a,s,i)}}},Wje={kernelName:gh,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[r,a]=t,{transposeA:s,transposeB:i}=n;return!s&&!i?{a:()=>_t(e,a,!1,!0),b:()=>_t(r,e,!0,!1)}:!s&&i?{a:()=>_t(e,a,!1,!1),b:()=>_t(e,r,!0,!1)}:s&&!i?{a:()=>_t(a,e,!1,!0),b:()=>_t(r,e,!1,!1)}:{a:()=>_t(a,e,!0,!0),b:()=>_t(e,r,!0,!0)}}},Vje={kernelName:eg,gradFunc:(e,t,n)=>{let{blockShape:r,crops:a}=n;return{x:()=>Tb(e,r,a)}}},Hje={kernelName:QG,gradFunc:(e,t,n)=>{let r=n,a=r.inputShape,s=r.shape,i=Array.from(s);for(let l=a.length-1;l>=0;l--)if(a[l]===s[l])i[l]=1;else if(a[l]!==1)throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${s}].`);let o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>Ge(e,o,!0)}}},Gje={kernelName:yh,gradFunc:e=>({x:()=>e.clone()})},qje={kernelName:xh,gradFunc:e=>({x:()=>qt(e)})},Kje={kernelName:gc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{clipValueMin:a,clipValueMax:s}=n;return{x:()=>Mr(ui(Tl(r,a),bc(r,s)),e,qt(e))}}},Qje={kernelName:Yv,inputsToSave:["x"],gradFunc:c7.gradFunc},Xje={kernelName:rg,saveAllInputs:!0,gradFunc:(e,t,n)=>{let r=t.map(o=>o.shape),{axis:a}=n,s=hi(a,t[0].shape)[0],i=r.map(o=>o[s]);return za(e,i,s).map(o=>()=>o)}},Yje={kernelName:vh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{dilations:s,strides:i,pad:o,dataFormat:l}=n;return H(qu(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>YA(r.shape,e,a,i,o,l),filter:()=>D$(r,e,a.shape,i,o,l)}}},Jje={kernelName:bh,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{strides:s,pad:i,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>Sa(e,a,s,i,o,1,l),filter:()=>D$(e,r,a.shape,s,i,o,l)}}};function Zje(e,t,n,r,a){let s=e;e.rank===4&&(s=ee(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let i=t;i.rank===4&&(i=ee(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),H(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),H(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),H(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),H(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),H(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);let o={x:s,dy:i},l={strides:r,pad:a,filterShape:n};return Y.runKernel(ag,o,l)}var eAe=J({conv3DBackpropFilter_:Zje}),tAe={kernelName:wh,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:s}=n;H(qu(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[i,o]=t;return{x:()=>$8(i.shape,e,o,a,s),filter:()=>eAe(i,e,o.shape,a,s)}}},nAe={kernelName:Nh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(In(oS(Se(n,"float32"))),e)}}},rAe={kernelName:kh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(lS(Se(n,"float32")),e)}}},aAe={kernelName:Sh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a,exclusive:s,reverse:i}=n;return{x:()=>{let o=P8([a],r.rank),l=Qk(e,a,s,!i);return o!=null&&(l=Tt(l,o)),l}}}},sAe={kernelName:_h,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:s,dimRoundingMode:i}=n,o=r??[1,1];H(qu(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);let[l,c]=t;return H(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),H(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),H(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),H(Lo(a,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${o}'.`),Ea("depthwiseConv2d",s,i),{x:()=>Cq(l.shape,e,c,a,s,o,i),filter:()=>_q(l,e,c.shape,a,s,o,i)}}},iAe={kernelName:Ch,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,s={x:r,filter:a,dy:e},i={x:r,filter:a,dy:e};return{x:()=>Y.runKernel(um,s,n),filter:()=>Y.runKernel(cm,i,n)}}},oAe={kernelName:Eh,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,r={dy:e,y:n};return{x:()=>Y.runKernel(ug,r)}}},lAe={kernelName:Th,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=Z(sa(In(vn(n))),2/Math.sqrt(Math.PI));return{x:()=>Z(e,r)}}},uAe={kernelName:jh,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(e,n)}}},cAe={kernelName:dg,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>ee(e,n.shape)}}},dAe={kernelName:Ah,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(e,sa(n))}}},hAe={kernelName:$h,gradFunc:e=>({x:()=>qt(e)})},pAe={kernelName:Rh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Nn(n.shape,r.shape);return{a:()=>{let s=ze(e,Se(r,"float32")),i=mr(n.shape,a);return i.length>0?ee(Ge(s,i),n.shape):s},b:()=>{let s=Z(e,Se(n,"float32")),i=mr(r.shape,a);i.length>0&&(s=ee(Ge(s,i),r.shape));let o=vn(r);return In(ze(s,Se(o,"float32")))}}}},fAe={kernelName:Dh,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:r}=n,[a,s,i,o]=t,l=o??Ze(1),c=mr(s.shape,a.shape),u=[];if(s.rank===1){for(let m=0;m<a.shape.length-1;++m)u.push(a.shape[m]);u.push(1)}let h=Oe(a,s),p=Z(e,l),f=sS(me(i,Ze(r))),g=Z(Z(Z(f,f),f),Ze(-.5));return{x:()=>s.rank===1?ee(Z(Z(e,ds(ee(f,[1,1,1,s.shape[0]]),u)),l),a.shape):ee(Z(Z(e,f),l),a.shape),mean:()=>{let m=Z(Z(f,Ze(-1)),p);return s.rank===1&&(m=Ge(m,c)),ee(m,s.shape)},variance:()=>{let m=Z(Z(g,h),p);return s.rank===1&&(m=Ge(m,c)),ee(m,s.shape)},scale:()=>{let m=Z(h,f),y=Z(e,m);return s.rank===1&&(y=Ge(y,c)),ee(y,s.shape)},offset:()=>{let m=e;return s.rank===1&&(m=Ge(m,c)),ee(m,s.shape)}}}},mAe={kernelName:pg,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[r,a]=t,{axis:s,batchDims:i}=n,o=hi(s,r.shape)[0],l=(c,u,h)=>()=>{let p=c.shape,f=u.size,g=p.slice(0,o),m=g.length,y=p.slice(s,p.length).slice(1),x=y.length,v=bL(0,m),b=bL(m+1,m+1+x),w=wL([g,[f],y]),k=ee(h,w),I=ee(u,[f]),C=wL([[m],v,b]),S=Tt(k,C),E=gS(S,I,c.shape[o]),T=s$(C);return E=Tt(E,T),E};if(i===1){let c=r.shape[0],u=r.split(c,0);return{x:()=>pr(u.map((h,p)=>l(h,a.slice(p,1),e.slice(p,1))())).reshape(r.shape),indices:()=>a}}else return{x:l(r,a,e),indices:()=>a}}};function bL(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function wL(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var gAe={kernelName:Mh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>qt(n),b:()=>qt(r)}}},yAe={kernelName:Oh,gradFunc:e=>({x:()=>Se(e,"float32")})},xAe={kernelName:Fh,gradFunc:e=>({x:()=>qt(e)})},vAe={kernelName:Ph,gradFunc:e=>({x:()=>qt(e)})},bAe={kernelName:Lh,gradFunc:e=>({x:()=>qt(e)})},wAe={kernelName:zh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{alpha:a}=n,s=Ta(r,0);return{x:()=>Mr(s,e,Z(e,a))}}},NAe={kernelName:Uh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,me(n,1))}}},kAe={kernelName:Bh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,Se(n,"float32"))}}},SAe={kernelName:YG,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n;return{logits:()=>{let s=sa(r);return Oe(e,Z(Ge(e,a,!0),s))}}}};function _Ae(e,t,n,r=5,a=1,s=1,i=.5){let o={x:e,y:t,dy:n},l={depthRadius:r,bias:a,alpha:s,beta:i};return Y.runKernel(Ng,o,l)}var CAe=J({localResponseNormalizationBackprop_:_Ae}),IAe={kernelName:Wh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{depthRadius:s,bias:i,alpha:o,beta:l}=n;return{x:()=>CAe(r,a,e,s,i,o,l)}}};function d7(e,t,n,r){return t.rank<n.rank&&(t=ee(t,Bd(t.shape,r))),e.rank<n.rank&&(e=ee(e,Bd(e.shape,r))),{x:()=>Z(e,Se(bs(n,t),e.dtype))}}var NL={kernelName:Vh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{reductionIndices:a}=r,s=t[0],i=t[1],o=hi(a,s.shape),l=d7(e,i,s,o);return{x:()=>l.x()}}},EAe={kernelName:Hh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>Z(e,Se(Tl(n,r),"float32")),b:()=>Z(e,Se(pm(n,r),"float32"))}}};function TAe(e,t,n,r,a,s,i){let o=z(e,"dy","maxPool3dGrad"),l=z(t,"input","maxPool3dGrad"),c=z(n,"output","maxPool3dGrad"),u=o,h=l,p=c,f=!1;l.rank===4&&(f=!0,u=ee(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),h=ee(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=ee(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),H(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),H(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),H(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),Ea("maxPool3dGrad",s,i);let g={dy:u,input:h,output:p},m={filterSize:r,strides:a,pad:s,dimRoundingMode:i},y=Y.runKernel(nb,g,m);return f?ee(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}var jAe=J({maxPool3dGrad_:TAe}),AAe={kernelName:kg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=n;return{x:()=>jAe(e,r,a,s,i,o,l)}}};function $Ae(e,t,n,r,a,s,i){let o=z(e,"dy","maxPoolGrad"),l=z(t,"input","maxPoolGrad"),c=z(n,"output","maxPoolGrad");H(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),H(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),H(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Ea("maxPoolGrad",s,i);let u={dy:o,input:l,output:c},h={filterSize:r,strides:a,pad:s,dimRoundingMode:i};return Y.runKernel(tb,u,h)}var RAe=J({maxPoolGrad_:$Ae}),DAe={kernelName:Gh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:s,strides:i,pad:o}=n;return{x:()=>RAe(e,r,a,s,i,o)}}},MAe={kernelName:qh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,s=hi(a,r.shape),i=F8(r.shape,s)[1],o=fn(i);return{x:()=>{let l=r.shape.slice();s.forEach(u=>{l[u]=1});let c=ee(e,l);return ze(Z(c,Pa(r.shape,"float32")),o)}}}},OAe={kernelName:Kh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{axis:a}=r,[s,i]=t,o=hi(a,s.shape),l=d7(e,i,s,o);return{x:()=>l.x()}}},FAe={kernelName:Qh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>Z(e,Se(bc(n,r),"float32")),b:()=>Z(e,Se(Ta(n,r),"float32"))}}},PAe={kernelName:Xh,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,s=a.map(i=>i[0]);return{x:()=>Ut(e,s,r.shape)}}},LAe={kernelName:Yh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Nn(n.shape,r.shape);return{a:()=>{let s=mr(n.shape,a);return s.length>0?ee(Ge(e,s),n.shape):e},b:()=>{let s=Z(e,In(Zg(ze(n,r)))),i=mr(r.shape,a);return i.length>0?ee(Ge(s,i),r.shape):s}}}},zAe={kernelName:Jh,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Nn(n.shape,r.shape);return{a:()=>{let s=Z(e,Se(r,"float32")),i=mr(n.shape,a);return i.length>0?ee(Ge(s,i),n.shape):s},b:()=>{let s=Z(e,Se(n,"float32")),i=mr(r.shape,a);return i.length>0?ee(Ge(s,i),r.shape):s}}}},BAe={kernelName:_g,gradFunc:e=>({x:()=>In(e)})},UAe={kernelName:Zh,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>Vn(n.shape,"float32")}}},WAe={kernelName:jg,gradFunc:e=>({x:()=>qt(e)})},VAe={kernelName:Ag,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:r}=n;return Zn(e,r).map(a=>()=>a)}},kL={kernelName:ep,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,s=a.map(i=>i[0]);return{x:()=>Ut(e,s,r.shape)}}},HAe={kernelName:tp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,r,a]=t,s=n,i=r,o=Nn(s.shape,i.shape);return{a:()=>{let l=Se(i,"float32"),c=Z(e,Z(l,Ro(s,Oe(l,Ze(1))))),u=mr(s.shape,o);return u.length>0&&(c=Ge(c,u)),ee(c,s.shape)},b:()=>{let l=Ta(s,0),c=Mr(l,ws(s),qt(s)),u=Z(e,Z(a,c)),h=mr(i.shape,o);return h.length>0&&(u=Ge(u,h)),ee(u,i.shape)}}}},GAe={kernelName:np,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,r]=t,a=Ta(n,0);return{x:()=>Mr(a,e,Z(e,r)),alpha:()=>{let s=Mr(a,qt(e),Z(e,n)),i=mr(r.shape,e.shape);return i.length>0&&(s=Ge(s,i)),ee(s,r.shape)}}}};function qAe(e,t,n){let r=e.shape.slice();r[n]=1;let a=ee(t,r),s=iv(e,n,!0,!1),i=iv(e,n,!0,!0),o=Z(s,i);return Z(a,o)}function KAe(e,t,n){let r=e.shape.length,a=r-n.length,s=P.getAxesPermutation(n,r),i=e;s!=null&&(i=Tt(e,s));let o=i.shape.slice(),l=o.splice(r-n.length,n.length).reduce((h,p)=>h*p,1);o.push(l);let c=i.reshape(o),u=qAe(c,t,a);if(u=u.reshape(i.shape),s!=null){let h=P.getUndoAxesPermutation(s);u=Tt(u,h)}return u}var QAe={kernelName:rp,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,s=[];return a==null?s=r.shape.map((i,o)=>o):typeof a=="number"?s=[a]:s=a,{x:()=>KAe(r,e,s)}}},XAe={kernelName:Ih,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Nn(n.shape,r.shape);return{a:()=>{let s=ze(e,Se(r,"float32")),i=mr(n.shape,a);return i.length>0?ee(Ge(s,i),n.shape):s},b:()=>{let s=Z(e,Se(n,"float32")),i=mr(r.shape,a);i.length>0&&(s=ee(Ge(s,i),r.shape));let o=vn(r);return In(ze(s,Se(o,"float32")))}}}},YAe={kernelName:ap,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,In(vn(n)))}}},JAe={kernelName:lp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=Z(bc(n,6),Ep(n));return{x:()=>Z(e,Se(r,"float32"))}}},ZAe={kernelName:sp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(e,Se(Ep(n),"float32"))}}},e$e={kernelName:$g,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ee(e,n.shape)}}},t$e={kernelName:op,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>Y.runKernel(Dg,a,n)}}},n$e={kernelName:ip,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>Y.runKernel(Rg,a,n)}}},r$e={kernelName:up,gradFunc:(e,t,n)=>{let{dims:r}=n,a=hi(r,e.shape);return{x:()=>Ws(e,a)}}},a$e={kernelName:cp,gradFunc:e=>({x:()=>qt(e)})},s$e={kernelName:dp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>In(ze(e,Z(Ro(n,1.5),2)))}}},i$e={kernelName:Pg,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>Se(qt(n),"float32"),t:()=>Z(e,Se(n,e.dtype)),e:()=>Z(e,Se(Ib(n),e.dtype))}}},o$e={kernelName:hp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Ta(n,Ze(0)),a=Ze(o7),s=Ze(l7),i=Z(e,s),o=Z(Z(e,a),sa(Se(n,"float32")));return Mr(r,i,o)}}}},l$e={kernelName:gp,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(e,Z(n,Oe(Ze(1),n)))}}},u$e={kernelName:mp,gradFunc:e=>({x:()=>qt(e)})},c$e={kernelName:pp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(Nb(Se(n,"float32")),e)}}},d$e={kernelName:fp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(Kk(Se(n,"float32")),e)}}},h$e={kernelName:Lg,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{begin:a,size:s}=n,i=r.shape,[o,l]=s7(r,a,s),c=[];for(let u=0;u<e.rank;u++)c.push([o[u],i[u]-o[u]-l[u]]);return{x:()=>Ki(e,c)}}},p$e={kernelName:bp,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{dim:a}=n,s=!0,i=Z(e,r);return{logits:()=>Oe(i,Z(Ge(i,[a],s),r))}}},f$e={kernelName:yp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(e,si(n))}}},SL={kernelName:zg,gradFunc:(e,t,n)=>{let{blockShape:r,paddings:a}=n;return{x:()=>wb(e,r,a)}}},_L={kernelName:Bg,gradFunc:(e,t,n)=>{let{axis:r}=n;return{x:()=>wn(e,r)}}},m$e={kernelName:xp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,Z(Or(Se(n,"float32")),2))}}},g$e={kernelName:lb,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(e,Z(Se(n,"float32"),2))}}},y$e={kernelName:wp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Ze(2);return{a:()=>Z(e,Z(a,Oe(n,r))),b:()=>Z(e,Z(a,Oe(r,n)))}}},x$e={kernelName:xc,gradFunc:e=>({x:()=>qt(e)})},v$e={kernelName:Np,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Nn(n.shape,r.shape);return{a:()=>{let s=e,i=mr(n.shape,a);return i.length>0&&(s=Ge(s,i)),ee(s,n.shape)},b:()=>{let s=e,i=mr(r.shape,a);return i.length>0&&(s=Ge(s,i)),ee(In(s),r.shape)}}}},b$e={kernelName:vp,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,a=r.shape.slice(),{axis:s}=n;hi(s,r.shape).forEach(l=>{a[l]=1});let i=ee(e,a),o=Z(i,Pa(r.shape,"float32"));return{x:()=>o}}},w$e={kernelName:kp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ze(e,vn(Nb(n)))}}},N$e={kernelName:Sp,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Z(Oe(Ze(1),vn(n)),e)}}},k$e={kernelName:yc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{reps:a}=n;return{x:()=>{let s=qt(r);if(r.rank===1)for(let i=0;i<a[0];++i)s=me(s,Ut(e,[i*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let i=0;i<a[0];++i)for(let o=0;o<a[1];++o)s=me(s,Ut(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let i=0;i<a[0];++i)for(let o=0;o<a[1];++o)for(let l=0;l<a[2];++l)s=me(s,Ut(e,[i*r.shape[0],o*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let i=0;i<a[0];++i)for(let o=0;o<a[1];++o)for(let l=0;l<a[2];++l)for(let c=0;c<a[3];++c)s=me(s,Ut(e,[i*r.shape[0],o*r.shape[1],l*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return s}}}},S$e={kernelName:dl,gradFunc:(e,t,n)=>{let r=n,{perm:a}=r,s=s$(a);return{x:()=>Tt(e,s)}}},_$e={kernelName:qg,gradFunc:(e,t,n)=>{let r=n,{axis:a}=r;return{value:()=>pr(e,a)}}},C$e={kernelName:fb,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>I$e(e,n)}}};function I$e(e,t){let n=zo(t,qt(t)),r=ey(e,n),a=Tl(t,Ze(0,"int32")),s=r.rank-a.rank;for(let o=0;o<s;++o)a=$r(a,o+1);a=ui(a,Pa(r.shape,"bool"));let i=qt(r);return Mr(a,r,i)}var E$e={kernelName:Kg,gradFunc:e=>({x:()=>qt(e)})},T$e=[c7,Cje,Ije,Eje,Tje,jje,Aje,$je,Rje,Dje,Mje,Oje,Lje,Uje,Wje,Vje,Hje,Gje,qje,Kje,Qje,Xje,Jje,Yje,tAe,nAe,rAe,aAe,sAe,iAe,XAe,oAe,lAe,uAe,cAe,dAe,pAe,hAe,fAe,mAe,gAe,yAe,xAe,vAe,bAe,wAe,NAe,kAe,SAe,IAe,NL,NL,EAe,AAe,DAe,MAe,OAe,FAe,PAe,LAe,zAe,BAe,UAe,WAe,VAe,kL,kL,HAe,GAe,QAe,YAe,JAe,ZAe,e$e,t$e,n$e,r$e,a$e,s$e,i$e,o$e,l$e,u$e,c$e,d$e,h$e,p$e,f$e,SL,SL,_L,_L,m$e,y$e,g$e,x$e,v$e,b$e,w$e,N$e,k$e,S$e,_$e,C$e,E$e];for(let e of T$e)JG(e);ge().prototype.abs=function(){return this.throwIfDisposed(),ur(this)};ge().prototype.acos=function(){return this.throwIfDisposed(),$A(this)};ge().prototype.acosh=function(){return this.throwIfDisposed(),RA(this)};ge().prototype.add=function(e){return this.throwIfDisposed(),me(this,e)};ge().prototype.all=function(e,t){return this.throwIfDisposed(),Hk(this,e,t)};ge().prototype.any=function(e,t){return this.throwIfDisposed(),rv(this,e,t)};ge().prototype.argMax=function(e){return this.throwIfDisposed(),Ld(this,e)};ge().prototype.argMin=function(e){return this.throwIfDisposed(),DA(this,e)};ge().prototype.asScalar=function(){return this.throwIfDisposed(),H(this.size===1,()=>"The array must have only 1 element."),ee(this,[])};ge().prototype.asType=function(e){return this.throwIfDisposed(),Se(this,e)};ge().prototype.as1D=function(){return this.throwIfDisposed(),ee(this,[this.size])};ge().prototype.as2D=function(e,t){return this.throwIfDisposed(),ee(this,[e,t])};ge().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),ee(this,[e,t,n])};ge().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),ee(this,[e,t,n,r])};ge().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),ee(this,[e,t,n,r,a])};ge().prototype.asin=function(){return this.throwIfDisposed(),MA(this)};ge().prototype.asinh=function(){return this.throwIfDisposed(),OA(this)};ge().prototype.atan=function(){return this.throwIfDisposed(),FA(this)};ge().prototype.atan2=function(e){return this.throwIfDisposed(),PA(this,e)};ge().prototype.atanh=function(){return this.throwIfDisposed(),LA(this)};ge().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),El(this,e,t,n,r)};ge().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),wb(this,e,t)};ge().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),_p(this,e,t,n,r,a)};ge().prototype.broadcastTo=function(e){return this.throwIfDisposed(),fd(this,e)};ge().prototype.cast=function(e){return this.throwIfDisposed(),Se(this,e)};ge().prototype.ceil=function(){return this.throwIfDisposed(),GA(this)};ge().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),aa(this,e,t)};ge().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Dt&&(e=[e]),wn([this,...e],t)};ge().prototype.conv1d=function(e,t,n,r,a,s){return this.throwIfDisposed(),Gk(this,e,t,n,r,a,s)};ge().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),qk(this,e,t,n,r,a)};ge().prototype.conv2d=function(e,t,n,r,a,s){return this.throwIfDisposed(),Sa(this,e,t,n,r,a,s)};ge().prototype.cos=function(){return this.throwIfDisposed(),Nb(this)};ge().prototype.cosh=function(){return this.throwIfDisposed(),Kk(this)};ge().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),iv(this,e,t,n)};ge().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Qk(this,e,t,n)};ge().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),e$(this,e,t)};ge().prototype.depthwiseConv2d=function(e,t,n,r,a,s){return this.throwIfDisposed(),Cp(this,e,t,n,r,a,s)};ge().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),t$(this,e,t,n,r,a)};ge().prototype.divNoNan=function(e){return this.throwIfDisposed(),n$(this,e)};ge().prototype.div=function(e){return this.throwIfDisposed(),ze(this,e)};ge().prototype.dot=function(e){return this.throwIfDisposed(),r$(this,e)};ge().prototype.elu=function(){return this.throwIfDisposed(),Yg(this)};ge().prototype.equal=function(e){return this.throwIfDisposed(),bs(this,e)};ge().prototype.erf=function(){return this.throwIfDisposed(),Xk(this)};ge().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),i$(this,e,t)};ge().prototype.exp=function(){return this.throwIfDisposed(),sa(this)};ge().prototype.expandDims=function(e){return this.throwIfDisposed(),$r(this,e)};ge().prototype.expm1=function(){return this.throwIfDisposed(),o$(this)};ge().prototype.fft=function(){return this.throwIfDisposed(),$b(this)};ge().prototype.flatten=function(){return this.throwIfDisposed(),ee(this,[this.size])};ge().prototype.floor=function(){return this.throwIfDisposed(),Zg(this)};ge().prototype.floorDiv=function(e){return this.throwIfDisposed(),Vk(this,e)};ge().prototype.gather=function(e,t,n){return this.throwIfDisposed(),ey(this,e,t,n)};ge().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Tl(this,e)};ge().prototype.greater=function(e){return this.throwIfDisposed(),Ta(this,e)};ge().prototype.ifft=function(){return this.throwIfDisposed(),ym(this)};ge().prototype.irfft=function(){return this.throwIfDisposed(),cS(this)};ge().prototype.isFinite=function(){return this.throwIfDisposed(),l$(this)};ge().prototype.isInf=function(){return this.throwIfDisposed(),u$(this)};ge().prototype.isNaN=function(){return this.throwIfDisposed(),c$(this)};ge().prototype.leakyRelu=function(e){return this.throwIfDisposed(),Sb(this,e)};ge().prototype.lessEqual=function(e){return this.throwIfDisposed(),bc(this,e)};ge().prototype.less=function(e){return this.throwIfDisposed(),pm(this,e)};ge().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),d$(this,e,t,n,r)};ge().prototype.logSigmoid=function(){return this.throwIfDisposed(),h$(this)};ge().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Zk(this,e)};ge().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Cb(this,e,t)};ge().prototype.log=function(){return this.throwIfDisposed(),ws(this)};ge().prototype.log1p=function(){return this.throwIfDisposed(),_b(this)};ge().prototype.logicalAnd=function(e){return this.throwIfDisposed(),ui(this,e)};ge().prototype.logicalNot=function(){return this.throwIfDisposed(),Ib(this)};ge().prototype.logicalOr=function(e){return this.throwIfDisposed(),eS(this,e)};ge().prototype.logicalXor=function(e){return this.throwIfDisposed(),p$(this,e)};ge().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),_t(this,e,t,n)};ge().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Ir(this,e,t,n,r)};ge().prototype.max=function(e,t){return this.throwIfDisposed(),Ps(this,e,t)};ge().prototype.maximum=function(e){return this.throwIfDisposed(),zo(this,e)};ge().prototype.mean=function(e,t){return this.throwIfDisposed(),Wn(this,e,t)};ge().prototype.min=function(e,t){return this.throwIfDisposed(),hm(this,e,t)};ge().prototype.minimum=function(e){return this.throwIfDisposed(),Qu(this,e)};ge().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),m$(this,e,t)};ge().prototype.mod=function(e){return this.throwIfDisposed(),g$(this,e)};ge().prototype.mul=function(e){return this.throwIfDisposed(),Z(this,e)};ge().prototype.neg=function(){return this.throwIfDisposed(),In(this)};ge().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Jg(this,e,t,n)};ge().prototype.notEqual=function(e){return this.throwIfDisposed(),Ud(this,e)};ge().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),fm(this,e,t,n)};ge().prototype.onesLike=function(){return this.throwIfDisposed(),Ns(this)};ge().prototype.pad=function(e,t){return this.throwIfDisposed(),Ki(this,e,t)};ge().prototype.pool=function(e,t,n,r,a,s){return this.throwIfDisposed(),y$(this,e,t,n,r,a,s)};ge().prototype.pow=function(e){return this.throwIfDisposed(),Ro(this,e)};ge().prototype.prelu=function(e){return this.throwIfDisposed(),jb(this,e)};ge().prototype.prod=function(e,t){return this.throwIfDisposed(),x$(this,e,t)};ge().prototype.reciprocal=function(){return this.throwIfDisposed(),k$(this)};ge().prototype.relu=function(){return this.throwIfDisposed(),hn(this)};ge().prototype.relu6=function(){return this.throwIfDisposed(),rS(this)};ge().prototype.reshapeAs=function(e){return this.throwIfDisposed(),ee(this,e.shape)};ge().prototype.reshape=function(e){return this.throwIfDisposed(),ee(this,e)};ge().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),$q(this,e,t,n)};ge().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Rq(this,e,t,n)};ge().prototype.reverse=function(e){return this.throwIfDisposed(),Ws(this,e)};ge().prototype.rfft=function(){return this.throwIfDisposed(),Rb(this)};ge().prototype.round=function(){return this.throwIfDisposed(),aS(this)};ge().prototype.rsqrt=function(){return this.throwIfDisposed(),sS(this)};ge().prototype.selu=function(){return this.throwIfDisposed(),iS(this)};ge().prototype.separableConv2d=function(e,t,n,r,a,s){return this.throwIfDisposed(),ty(this,e,t,n,r,a,s)};ge().prototype.sigmoid=function(){return this.throwIfDisposed(),si(this)};ge().prototype.sign=function(){return this.throwIfDisposed(),S$(this)};ge().prototype.sin=function(){return this.throwIfDisposed(),oS(this)};ge().prototype.sinh=function(){return this.throwIfDisposed(),lS(this)};ge().prototype.slice=function(e,t){return this.throwIfDisposed(),Ut(this,e,t)};ge().prototype.softmax=function(e){return this.throwIfDisposed(),Nc(this,e)};ge().prototype.softplus=function(){return this.throwIfDisposed(),Ip(this)};ge().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Tb(this,e,t)};ge().prototype.split=function(e,t){return this.throwIfDisposed(),za(this,e,t)};ge().prototype.sqrt=function(){return this.throwIfDisposed(),Or(this)};ge().prototype.square=function(){return this.throwIfDisposed(),vn(this)};ge().prototype.squaredDifference=function(e){return this.throwIfDisposed(),dS(this,e)};ge().prototype.squeeze=function(e){return this.throwIfDisposed(),kc(this,e)};ge().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof Dt?[this,e]:[this,...e];return pr(n,t)};ge().prototype.step=function(e){return this.throwIfDisposed(),Ep(this,e)};ge().prototype.stridedSlice=function(e,t,n,r,a,s,i,o){return this.throwIfDisposed(),_$(this,e,t,n,r,a,s,i,o)};ge().prototype.sub=function(e){return this.throwIfDisposed(),Oe(this,e)};ge().prototype.sum=function(e,t){return this.throwIfDisposed(),Ge(this,e,t)};ge().prototype.tan=function(){return this.throwIfDisposed(),C$(this)};ge().prototype.tanh=function(){return this.throwIfDisposed(),Ku(this)};ge().prototype.tile=function(e){return this.throwIfDisposed(),ds(this,e)};ge().prototype.toBool=function(){return this.throwIfDisposed(),Se(this,"bool")};ge().prototype.toFloat=function(){return this.throwIfDisposed(),Se(this,"float32")};ge().prototype.toInt=function(){return this.throwIfDisposed(),Se(this,"int32")};ge().prototype.topk=function(e,t){return this.throwIfDisposed(),E$(this,e,t)};ge().prototype.transpose=function(e){return this.throwIfDisposed(),Tt(this,e)};ge().prototype.unique=function(e){return this.throwIfDisposed(),T$(this,e)};ge().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),gS(this,e,t)};ge().prototype.unstack=function(e){return this.throwIfDisposed(),Zn(this,e)};ge().prototype.where=function(e,t){return this.throwIfDisposed(),Mr(e,this,t)};ge().prototype.zerosLike=function(){return this.throwIfDisposed(),qt(this)};var Yl=class h7 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,h7.prototype)}},yo=class p7 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,p7.prototype)}},re=class f7 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,f7.prototype)}},Pt=class m7 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,m7.prototype)}},j$e=class g7 extends Error{constructor(t){super(t),Object.setPrototypeOf(this,g7.prototype)}},y7=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}};function Vd(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{let n=new Array(t);return n.fill(e),n}}function uo(e,t){if(!e)throw new j$e(t)}function CL(e,t){let n=0;for(let r of e)r===t&&n++;return n}function Oa(e){return e.length===1?e[0]:e}function dn(e){return Array.isArray(e)?e:[e]}function el(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Hc(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}var Ks={};function K$(e){if(e==null)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function rE(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>rE(t));else{let t=Object.keys(e);for(let n of t){let r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:rE(r))}}}function Mb(e,t={},n={},r="object",a=!1){if(typeof e=="string"){let s=e,i;if(s in n)i=n[s];else if(s in Ks)i=Ks[s];else if(i=t[s],i==null)throw new re(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{let s=e;if(s.className==null||s.config==null)throw new re(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);let i=s.className,o,l;if(i in n?[o,l]=n[i]:i in Ks?[o,l]=Ks.className:i in t&&([o,l]=t[i]),o==null)throw new re(`Unknown ${r}: ${i}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){let c={};for(let f of Object.keys(Ks))c[f]=Ks[f];for(let f of Object.keys(n))c[f]=n[f];let u=s.config;u.customObjects=c;let h=Object.assign({},Ks);for(let f of Object.keys(n))Ks[f]=n[f];rE(s.config);let p=l(o,s.config,n,a);return Ks=Object.assign({},h),p}else{let c=Object.assign({},Ks);for(let h of Object.keys(n))Ks[h]=n[h];let u=new o(s.config);return Ks=Object.assign({},c),u}}}function A$e(e,t){return e<t?-1:e>t?1:0}function zw(e,t){return-1*A$e(e,t)}function $u(e){if(e==null)return e;let t=[];for(let n of e)t.indexOf(n)===-1&&t.push(n);return t}function $$e(e){if(e==null)throw new re(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function Tp(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new re(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function Q$(e,t,n=0,r=1/0){return uo(n>=0),uo(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(a=>typeof a===t)}function Dr(e,t){Array.isArray(e)?(j.assert(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>Dr(n,`element ${r+1} of ${t}`))):j.assert(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${x7(e)}.`)}function x7(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>x7(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function R$e(e,t,n){let r=n!=null?n():j.now(),a;return(...s)=>{let i=n!=null?n():j.now();return i-r<t||(r=i,a=e(...s)),a}}function v7(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}var D$e=0;function b7(){return D$e++}var Bw={};function kS(e=""){return e in Bw||(Bw[e]=0),Bw[e]+=1,e+Bw[e].toString()}var M$e=["channelsFirst","channelsLast"],O$e=["nearest","bilinear"],F$e=["valid","same","causal"],P$e=["max","avg"],L$e=["sum","mul","concat","ave"],Qp=new Map;function sr(e){Tp(M$e,"DataFormat",e)}function z$e(e){Tp(O$e,"InterpolationFormat",e)}function qs(e){Tp(F$e,"PaddingMode",e)}function w7(e){Tp(P$e,"PoolMode",e)}var xx=[],IL="/";function md(e,t){xx.push(e);try{let n=t();return xx.pop(),n}catch(n){throw xx.pop(),n}}function B$e(){return xx.length===0?"":xx.join(IL)+IL}function N7(e){if(!S7(e))throw new Error("Not a valid tensor name: '"+e+"'");return B$e()+e}function k7(e){if(!S7(e))throw new Error("Not a valid tensor name: '"+e+"'");Qp.has(e)||Qp.set(e,0);let t=Qp.get(e);if(Qp.set(e,Qp.get(e)+1),t>0){let n=`${e}_${t}`;return Qp.set(n,1),n}else return e}var U$e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function S7(e){return!!e.match(U$e)}function W$e(e){return e===parseInt(e.toString(),10)}function Ru(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let a=t;a<n;++a)r*=e[a];return r}function vm(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function Yu(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function Bi(e,t){if(t<e)throw new re(`end (${t}) < begin (${e}) is forbidden.`);let n=[];for(let r=e;r<t;++r)n.push(r);return n}var wC;function br(){return wC==null&&(wC=EA().epsilon()),wC}function Ui(){return"channelsLast"}function kl(e,t){return Se(e,t)}function Ob(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),ee(e,n)}function V$e(e,t){return te(()=>{if(e.shape.length!==2)throw new re(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);let n=Ob(e,1);return aE(n,[1,t,1])})}function H$e(e){let t=[Ru(e.shape)];return ee(e,t)}function G$e(e){if(e.rank<=1)throw new re(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],Ru(e.shape,1)];return ee(e,t)}function gd(e,t,n){return te(()=>{switch(e.rank){case 1:return Ab(e,t,n);case 2:return uS(e,[t,0],[n,e.shape[1]]);case 3:return ny(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return gm(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Ut(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Ut(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new re(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function NC(e,t,n){return te(()=>{switch(e.rank){case 1:return Ab(e,t,n);case 2:return uS(e,[0,t],[e.shape[0],n]);case 3:return ny(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return gm(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new re(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function Uw(e,t,n,r){return te(()=>{switch(e.rank){case 1:return Ab(e,t,n);case 2:switch(r){case 1:return gd(e,t,n);case 2:return NC(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return gd(e,t,n);case 2:return ny(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return NC(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return gd(e,t,n);case 2:return gm(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return gm(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return NC(e,t,n);default:throw new re(`The axis is not within the rank of the tensor ${r}`)}default:throw new re(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function X$(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),wn(e,t)}function EL(e,t){switch(e.rank){case 1:return qA([e,t]);case 2:return KA([e,t],0);case 3:return QA([e,t],0);case 4:return XA([e,t],0);default:throw new re(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function aE(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new re(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return ds(e,t)}function SS(e,t=0,n=1,r,a){return nS(e,t,n,r,a)}function _o(e,t,n,r){if(e.rank<2||t.rank<2)throw new Pt(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){let a=e.shape.slice(-1)[0],s=t.shape.slice(-2)[0];if(a!==s)throw new Pt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return xm.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?sE(e.rank,r,Ui()):null,activation:n});{let a=e.shape.slice(),s=a.pop();e=ee(e,[-1,s]);let i=t.shape.slice(),o=i.pop(),l=i.pop(),c=[...i,o],u=Array.from({length:t.rank},(p,f)=>f===0?t.rank-2:f<=t.rank-2?f-1:f);t=ee(Tt(t,u),[l,-1]);let h=[...a,...c];return ee(xm.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?sE(e.rank,r,Ui()):null,activation:n}),h)}}function _7(e,t,n){return te(()=>(Array.isArray(t)?t=cn(t,"int32"):t=Se(t,"int32"),ey(e,t,n)))}function Fb(e){return Z(e,e)}function sE(e,t,n){let r=t.shape;if(t.rank!==1&&t.rank!==e)throw new re(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?ee(t,[1,r[0],1,1,1]):ee(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?ee(t,[1,1,1,1,r[0]]):ee(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?ee(t,[1,r[0],1,1]):ee(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?ee(t,[1,1,1,r[0]]):ee(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?ee(t,[1,r[0],1]):ee(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?ee(t,[1,1,r[0]]):ee(t,[1].concat(r))}else if(e<3)return t;throw new re(`Unsupported input rank by biasAdd: ${t.rank}`)}function Qi(e,t,n){return te(()=>(n==null&&(n=Ui()),sr(n),me(e,sE(e.rank,t,n))))}function q$e(e,t=1){if(t!==1)throw new Pt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return Yg(e)}function K$e(e){return te(()=>ze(e,me(ur(e),1)))}function C7(e,t,n,r){return te(()=>$$(e,t,n,r))}function Q$e(e){return te(()=>{let t=me(.5,Z(.2,e));return aa(t,0,1)})}function Pb(e,t,n=!1){return n?e():t()}var X$e=["fanIn","fanOut","fanAvg"],Y$e=["normal","uniform","truncatedNormal"];function J$e(e){Tp(X$e,"FanMode",e)}function Z$e(e){Tp(Y$e,"Distribution",e)}var pi=class extends we.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},Y$=class extends pi{apply(e,t){return Vn(e,t)}};Y$.className="Zeros";we.registerClass(Y$);var _S=class extends pi{apply(e,t){return Pa(e,t)}};_S.className="Ones";we.registerClass(_S);var J$=class extends pi{constructor(e){if(super(),typeof e!="object")throw new re(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new re(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return te(()=>Z(Ze(this.value),Pa(e,t)))}getConfig(){return{value:this.value}}};J$.className="Constant";we.registerClass(J$);var Z$=class extends pi{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return wc(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};Z$.className="RandomUniform";we.registerClass(Z$);var eR=class extends pi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Pt(`randomNormal does not support dType ${t}.`);return SS(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};eR.className="RandomNormal";we.registerClass(eR);var tR=class extends pi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Pt(`truncatedNormal does not support dType ${t}.`);return mS(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};tR.className="TruncatedNormal";we.registerClass(tR);var nR=class extends pi{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return te(()=>{if(e.length!==2||e[0]!==e[1])throw new re("Identity matrix initializer can only be used for 2D square matrices.");return Z(this.gain,Yk(e[0]))})}getConfig(){return{gain:this.gain}}};nR.className="Identity";we.registerClass(nR);function eRe(e,t="channelsLast"){let n,r;if(sr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){let a=Ru(e,2);n=e[1]*a,r=e[0]*a}else if(t==="channelsLast"){let a=Ru(e,0,e.length-2);n=e[e.length-2]*a,r=e[e.length-1]*a}}else{let a=Ru(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}var Wa=class extends pi{constructor(e){if(super(),e.scale<0)throw new re(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,J$e(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Z$e(this.distribution),this.seed=e.seed}apply(e,t){let n=eRe(e),r=n[0],a=n[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,r):this.mode==="fanOut"?s/=Math.max(1,a):s/=Math.max(1,(r+a)/2),this.distribution==="normal"){let i=Math.sqrt(s);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Pt(`${this.getClassName()} does not support dType ${t}.`);return mS(e,0,i,t,this.seed)}else{let i=Math.sqrt(3*s);return wc(e,-i,i,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};Wa.className="VarianceScaling";we.registerClass(Wa);var CS=class extends Wa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Wa.className}};CS.className="GlorotUniform";we.registerClass(CS);var IS=class extends Wa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Wa.className}};IS.className="GlorotNormal";we.registerClass(IS);var ES=class extends Wa{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Wa.className}};ES.className="HeNormal";we.registerClass(ES);var TS=class extends Wa{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Wa.className}};TS.className="HeUniform";we.registerClass(TS);var jS=class extends Wa{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Wa.className}};jS.className="LeCunNormal";we.registerClass(jS);var AS=class extends Wa{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Wa.className}};AS.className="LeCunUniform";we.registerClass(AS);var rR=class extends pi{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return te(()=>{if(e.length<2)throw new Pt("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;let n=j.sizeFromShape(e.slice(0,-1)),r=e[e.length-1],a=n*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);let s=[Math.max(r,n),Math.min(r,n)],i=SS(s,0,1,t,this.seed),o=O$.qr(i,!1),l=o[0],c=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return l=Z(l,c.sign()),n<r&&(l=l.transpose()),Z(Ze(this.gain),l.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};rR.className="Orthogonal";we.registerClass(rR);var TL={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function jL(e,t={}){return Mb(e,we.SerializationMap.getMap().classNameMap,t,"initializer")}function Hn(e){return K$(e)}function On(e){if(typeof e=="string"){let t=e in TL?TL[e]:e;if(t==="GlorotNormal")return new IS;if(t==="GlorotUniform")return new CS;if(t==="HeNormal")return new ES;if(t==="HeUniform")return new TS;if(t==="LeCunNormal")return new jS;if(t==="LeCunUniform")return new AS;{let n={};return n.className=t,n.config={},jL(n)}}else return e instanceof pi?e:jL(e)}function iE(e){return Array.isArray(e)&&Array.isArray(e[0])}function L1(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function ut(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new re(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function nn(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new re(`Expected exactly 1 Shape; got ${e.length}`)}else return e}function z1(e){let t=0;for(let n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,a)=>r*a);return t}var AL="Variable",I7=class{constructor(e,t="float32",n=AL,r=!0,a=null){this.dtype=t??"float32",this.shape=e.shape,this.id=b7(),n=n??AL,this.originalName=N7(n),this.name=k7(this.originalName),this.trainable_=r,this.constraint=a,this.val=j$(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),tRe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function tRe(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function oE(e){return e.map(t=>t.read())}function aR(e){e.forEach(t=>{t[0].write(t[1])})}var dr=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},Wi=class{constructor(e,t,n,r,a,s,i){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=i,this.id=b7(),s!=null&&(this.originalName=N7(s),this.name=k7(this.originalName)),this.rank=t.length}},nRe=0,$S=class{constructor(e,t){this.callArgs=t,this.id=nRe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let n of e.inboundLayers)n!=null&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},rRe=0,Lt=class extends we.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=rRe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let n=this.getClassName();t=el(n)+"_"+kS(n)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let n;if(e.batchInputShape!=null)n=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),n=[a].concat(e.inputShape)}this.batchInputShape=n;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new yo(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new re(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Oa(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Oa(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Yl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Yl(`Layer ${this.name} is not connected, no input to return.`);return Oa(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Yl(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Yl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Oa(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){let t=dn(e);if(this.inputSpec==null||this.inputSpec.length===0)return;let n=dn(this.inputSpec);if(t.length!==n.length)throw new re(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){let a=t[r],s=n[r];if(s==null)continue;let i=a.rank;if(s.ndim!=null&&i!==s.ndim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${i}`);if(s.maxNDim!=null&&i>s.maxNDim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${i}`);if(s.minNDim!=null&&i<s.minNDim)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${i}.`);if(s.dtype!=null&&a.dtype!==s.dtype)throw new re(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${a.dtype}.`);if(s.axes){let o=a.shape;for(let l in s.axes){let c=Number(l),u=s.axes[l],h=c>=0?o[c]:o[o.length+c];if(u!=null&&[u,null].indexOf(h)===-1)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${u} but got shape ${o}.`)}}if(s.shape!=null)for(let o=0;o<s.shape.length;++o){let l=s.shape[o],c=a.shape[o];if(l!=null&&c!=null&&l!==c)throw new re(`Input ${r} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${a.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=dn(e),r=iRe(e),a=oRe(e);if(r===a)throw new re("Arguments to apply() must be all SymbolicTensors or all Tensors");return md(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let s=[];for(let i of dn(e))s.push(i.shape);this.build(Oa(s)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let s=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,s);let i=dn(s),o=[];for(let l of i)n.indexOf(l)!==-1&&(l=l.clone()),o.push(l);if(s=Oa(o),this.activityRegularizer!=null)throw new Pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}else{let s=aRe(e),i=this.computeOutputShape(s),o,l=sRe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?s[0]:s),i!=null&&i.length>0&&Array.isArray(i[0])?o=i.map((c,u)=>new Wi(l,c,this,dn(e),t,this.name,u)):o=new Wi(l,i,this,dn(e),t,this.name),this.addInboundNode(e,o,null,null,s,i,t),this._refCount++,this.activityRegularizer!=null)throw new Pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((n,r)=>{n!=null&&e[r]!=null&&e[r]!==n&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Yl(`The layer ${this.name} has never been called and thus has no defined output shape.`);let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){let t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Yl(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new yo(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return z1(this.weights)}build(e){this.built=!0}getWeights(e=!1){return oE(e?this.trainableWeights:this.weights)}setWeights(e){te(()=>{let t=this.weights;if(t.length!==e.length)throw new re(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;let n=[],r=oE(t);for(let a=0;a<r.length;++a){let s=r[a],i=t[a],o=e[a];if(!j.arraysEqual(s.shape,o.shape))throw new re(`Layer weight shape ${s.shape} not compatible with provided weight shape ${o.shape}`);n.push([i,o])}aR(n)})}addWeight(e,t,n,r,a,s,i,o){if(this._addedWeightNames.indexOf(e)!==-1)throw new re(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),n==null&&(n="float32"),this.fastWeightInitDuringBuild&&(r=o!=null?o():On("zeros"));let l=r.apply(t,n),c=new I7(l,n,e,s,i);return l.dispose(),a!=null&&this.addLoss(()=>a.apply(c.read())),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=dn(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(n=>{if(n!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;let r=this.computeMask(e,n),a=dn(t),s=dn(r);if(a.length!==s.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let i=0;i<a.length;i++)a[i].kerasMask=s[i]}addInboundNode(e,t,n,r,a,s,i=null){let o=dn(e);t=dn(t),n=dn(n),r=dn(r),a=L1(a),s=L1(s);let l=[],c=[],u=[];for(let h of o)l.push(h.sourceLayer),c.push(h.nodeIndex),u.push(h.tensorIndex);new $S({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:u,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:s},i);for(let h=0;h<t.length;h++)t[h].sourceLayer=this,t[h].nodeIndex=this.inboundNodes.length-1,t[h].tensorIndex=h}getConfig(){let e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function aRe(e){e=dn(e);let t=[];for(let n of e)t.push(n.shape);return Oa(t)}function sRe(e){return"float32"}function E7(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{let r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{let a=[];for(let s=0;s<r.inboundLayers.length;s++){let i=r.inputTensors[s],o=r.inboundLayers[s],l=r.nodeIndices[s],c=E7(i,o,l);for(let u of c)a.indexOf(u)===-1&&a.push(u)}return a}}}function iRe(e){let t=!0;for(let n of dn(e))if(!(n instanceof Wi)){t=!1;break}return t}function oRe(e){let t=!0;for(let n of dn(e))if(n instanceof Wi){t=!1;break}return t}var ay=class extends Lt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:kS("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new re("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new re("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new re("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let r=new Wi(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new $S({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new re(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};ay.className="InputLayer";we.registerClass(ay);function T7(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new re("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new ay({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function lRe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return Se(t,e.dtype)}catch{throw new re(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}var xf=class j7{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof j7)for(let n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(let n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=lRe(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new re(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Wi){if(this.id2Value[t.id]==null)throw new re(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{let n=this.name2Id[t];if(n==null)throw new re(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof Wi){if(this.id2Value[t.id]==null)throw new re(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{let n=this.name2Id[t];if(n==null)throw new re(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&mt(this.id2Mask)}},B1=new y7,U1=new y7;function uRe(e){B1!=null&&B1.setMaxEntries(e),U1!=null&&U1.setMaxEntries(e)}function Xy(e,t,n,r){let a=n==null?!1:n.training,s=Array.isArray(e),i=s?e:[e],o=i.map(g=>g.name),l=[],c=t.names();for(let g of o)c.indexOf(g)!==-1?l.push(t.getValue(g)):l.push(null);let u=o.join(",")+"|"+t.names().sort().join(","),h=B1.get(u),p;if(h==null){let g=cRe(i,t);h=g.sorted,p=g.recipientCounts,B1.put(u,h),U1.put(u,p)}p={},a||Object.assign(p,U1.get(u));let f=new xf(t);for(let g=0;g<h.length;++g){let m=h[g],y=m.sourceLayer;if(y instanceof ay)continue;let x=[],v=[],b=[],w=!1;for(let E of m.inputs){let T=f.getValue(E),$=f.getMask(E);x.push(T),v.push($),$!=null&&(w=!0),a||(p[E.name]--,p[E.name]===0&&!t.hasKey(E)&&o.indexOf(E.name)===-1&&!T.isDisposed&&E.sourceLayer.stateful!==!0&&b.push(T))}w&&(n=n||{},n.mask=v[0]);let k=dn(y.apply(x,n)),I=null;y.supportsMasking&&(I=y.computeMask(x,v));let C=hRe(m),S=Array.isArray(C)?C:[C];for(let E=0;E<S.length;++E){f.hasKey(S[E])||f.add(S[E],k[E],Array.isArray(I)?I[0]:I);let T=o.indexOf(S[E].name);T!==-1&&(l[T]=k[E])}a||mt(b)}return f.disposeMasks(),s?l:l[0]}function cRe(e,t){j.assert(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){let a=$L(e[0],t);n=a.sorted,r=a.recipientMap}else{let a=new Set;for(let s of e){let{sorted:i,recipientMap:o}=$L(s,t);for(let l of i)a.has(l.name)||(n.push(l),a.add(l.name));for(let l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:dRe(r)}}function dRe(e){let t={};for(let n in e)t[n]=e[n].size;return t}function $L(e,t){let n=new Set,r=[],a={};for(let o of t.names())n.add(o);let s=[],i=[];for(s.push(e);s.length>0;){let o=s[s.length-1];if(n.has(o.name)){s.pop();continue}let l=i[i.length-1]===s.length-1;if(o.inputs.length===0||l)s.pop(),r.push(o),n.add(o.name),l&&i.pop();else{i.push(s.length-1);for(let c of o.inputs)a[c.name]==null&&(a[c.name]=new Set),a[c.name].add(o.name),!n.has(c.name)&&s.push(c)}}return{sorted:r,recipientMap:a}}function hRe(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(let a of e.sourceLayer.inboundNodes[r].outputTensors)if(a.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var pRe=le();pRe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,uRe);var A7={};gt(A7,{maxNorm:()=>fRe,minMaxNorm:()=>yRe,nonNeg:()=>gRe,unitNorm:()=>mRe});function sR(e,t){return te(()=>Or(Ge(Z(e,e),t,!0)))}var Lb=class extends we.Serializable{getConfig(){return{}}},iR=class extends Lb{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return te(()=>{let t=sR(e,this.axis),n=aa(t,0,this.maxValue);return Z(e,ze(n,me(br(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};iR.className="MaxNorm";we.registerClass(iR);var oR=class extends Lb{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return te(()=>ze(e,me(br(),sR(e,this.axis))))}getConfig(){return{axis:this.axis}}};oR.className="UnitNorm";we.registerClass(oR);var lR=class extends Lb{apply(e){return hn(e)}};lR.className="NonNeg";we.registerClass(lR);var uR=class extends Lb{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return te(()=>{let t=sR(e,this.axis),n=me(Z(this.rate,aa(t,this.minValue,this.maxValue)),Z(1-this.rate,t));return Z(e,ze(n,me(br(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};uR.className="MinMaxNorm";we.registerClass(uR);var RL={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Nr(e){return K$(e)}function DL(e,t={}){return Mb(e,we.SerializationMap.getMap().classNameMap,t,"constraint")}function kr(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in RL?RL[e]:e,config:{}};return DL(t)}else return e instanceof Lb?e:DL(e)}function fRe(e){return new iR(e)}function mRe(e){return new oR(e)}function gRe(){return new lR}function yRe(e){return new uR(e)}var $7={};gt($7,{constant:()=>bRe,glorotNormal:()=>IRe,glorotUniform:()=>CRe,heNormal:()=>ERe,heUniform:()=>TRe,identity:()=>SRe,leCunNormal:()=>jRe,leCunUniform:()=>ARe,ones:()=>vRe,orthogonal:()=>$Re,randomNormal:()=>NRe,randomUniform:()=>wRe,truncatedNormal:()=>kRe,varianceScaling:()=>_Re,zeros:()=>xRe});function xRe(){return new Y$}function vRe(){return new _S}function bRe(e){return new J$(e)}function wRe(e){return new Z$(e)}function NRe(e){return new eR(e)}function kRe(e){return new tR(e)}function SRe(e){return new nR(e)}function _Re(e){return new Wa(e)}function CRe(e){return new CS(e)}function IRe(e){return new IS(e)}function ERe(e){return new ES(e)}function TRe(e){return new TS(e)}function jRe(e){return new jS(e)}function ARe(e){return new AS(e)}function $Re(e){return new rR(e)}var R7={};gt(R7,{Layer:()=>Lt,RNN:()=>$l,RNNCell:()=>Bb,activation:()=>uMe,add:()=>xMe,alphaDropout:()=>tOe,average:()=>vMe,averagePooling1d:()=>wD,averagePooling2d:()=>ND,averagePooling3d:()=>kD,avgPool1d:()=>EMe,avgPool2d:()=>jMe,avgPool3d:()=>$Me,avgPooling1d:()=>TMe,avgPooling2d:()=>AMe,avgPooling3d:()=>RMe,batchNormalization:()=>_Me,bidirectional:()=>qMe,categoryEncoding:()=>iOe,centerCrop:()=>aOe,concatenate:()=>bMe,conv1d:()=>eMe,conv2d:()=>tMe,conv2dTranspose:()=>nMe,conv3d:()=>rMe,conv3dTranspose:()=>aMe,convLstm2d:()=>WMe,convLstm2dCell:()=>VMe,cropping2D:()=>iMe,dense:()=>cMe,depthwiseConv2d:()=>lMe,dot:()=>SMe,dropout:()=>dMe,elu:()=>KDe,embedding:()=>yMe,flatten:()=>pMe,gaussianDropout:()=>eOe,gaussianNoise:()=>ZMe,globalAveragePooling1d:()=>DMe,globalAveragePooling2d:()=>MMe,globalMaxPool1d:()=>QMe,globalMaxPool2d:()=>XMe,globalMaxPooling1d:()=>MK,globalMaxPooling2d:()=>OK,gru:()=>FMe,gruCell:()=>PMe,input:()=>Y7,inputLayer:()=>qDe,layerNormalization:()=>CMe,leakyReLU:()=>XDe,lstm:()=>LMe,lstmCell:()=>zMe,masking:()=>nOe,maxPool1d:()=>YMe,maxPool2d:()=>JMe,maxPooling1d:()=>FK,maxPooling2d:()=>PK,maxPooling3d:()=>OMe,maximum:()=>wMe,minimum:()=>NMe,multiply:()=>kMe,permute:()=>gMe,prelu:()=>YDe,randomWidth:()=>oOe,reLU:()=>QDe,repeatVector:()=>fMe,rescaling:()=>rOe,reshape:()=>mMe,resizing:()=>sOe,rnn:()=>HMe,separableConv2d:()=>sMe,simpleRNN:()=>BMe,simpleRNNCell:()=>UMe,softmax:()=>JDe,spatialDropout1d:()=>hMe,stackedRNNCells:()=>GMe,thresholdedReLU:()=>ZDe,timeDistributed:()=>KMe,upSampling2d:()=>oMe,zeroPadding2d:()=>IMe});async function Gl(e){if(e==null)return;let t=[],n=[],r=[];for(let a in e){let s=e[a];if(typeof s!="number"){let i=s;t.push(i.data()),n.push(a),r.push(i)}}if(t.length>0){let a=await Promise.all(t);for(let s=0;s<a.length;++s)e[n[s]]=a[s][0];mt(r)}}function D7(e){if(e!=null)for(let t in e){let n=e[t];typeof n!="number"&&n.dispose()}}var ML;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(ML||(ML={}));var RRe=125,bm=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},M7=class{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},DRe=class extends bm{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});let n=t.size==null?0:t.size;this.seen+=n;for(let r in t){let a=t[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*n;else{let s;r in this.totals?s=this.totals[r]:this.totals[r]=0;let i=te(()=>me(this.totals[r],Z(a,n)));this.totals[r]=i,s!=null&&s.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(let n of this.params.metrics)this.totals[n]!=null&&(typeof this.totals[n]=="number"?t[n]=this.totals[n]/this.seen:te(()=>{let r=Z(ze(1,this.seen),this.totals[n]);t[n]=r,this.totals[n].dispose(),vr(t[n])}))}},O7=class extends bm{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(let n in t)this.history[n]==null&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let a in this.history){let s=this.history[a];for(let i=0;i<s.length;++i)if(typeof s[i]!="number"){let o=s[i];e.push(o.data()),t.push(a),n.push(i)}}let r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[t[a]][n[a]].dispose(),this.history[t[a]][n[a]]=r[a][0]}},F7=class extends bm{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||G$,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=RRe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");j.isNumber(this.yieldEvery)&&(this.maybeWait=R$e(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let r=[];this.yield!=null&&(await Gl(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Gl(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];this.epochEnd!=null&&(await Gl(t),n.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Gl(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];this.batchEnd!=null&&(await Gl(t),n.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?n.push(this.nextFrameFunc()):j.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await Gl(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Gl(e),await this.trainEnd(e))}};function P7(e,t){return e==null&&(e={}),e instanceof bm?[e]:Array.isArray(e)&&e[0]instanceof bm?e:dn(e).map(n=>new F7(n,t))}var cR=class to{constructor(){}static registerCallbackConstructor(t,n){j.assert(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),to.checkForDuplicate(n),to.constructors[t]==null&&(to.constructors[t]=[]),to.constructors[t].push(n)}static checkForDuplicate(t){for(let n in to.constructors)to.constructors[+n].forEach(r=>{if(r===t)throw new re("Duplicate callback constructor.")})}static clear(){to.constructors={}}static createCallbacks(t){let n=[];for(let r in to.constructors){let a=+r;t>=a&&n.push(...to.constructors[a])}return n.map(r=>new r)}};cR.constructors={};function L7(e,t,n,r,a,s,i,o,l){let c=new O7,u=[new DRe,...cR.createCallbacks(t)];e!=null&&u.push(...e),u.push(c);let h=new M7(u);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:s,batchSize:i,verbose:t,doValidation:o,metrics:l}),{callbackList:h,history:c}}function Di(e,t={},n=!1){return Mb(e,we.SerializationMap.getMap().classNameMap,t,"layer",n)}function W1(e,t){return te(()=>{e.dtype!=="float32"&&(e=Se(e,"float32"));let n=Ge(Fb(e),t,!0),r=xs(n.shape,br()),a=Or(zo(n,r));return ze(e,a)})}function jp(e,t){return te(()=>Wn(Fb(Oe(t,e)),-1))}function RS(e,t){return te(()=>Wn(ur(Oe(t,e)),-1))}function sy(e,t){return te(()=>{let n=Oe(e,t),r=aa(ur(e),br(),Number.MAX_VALUE),a=ur(ze(n,r));return Z(100,Wn(a,-1))})}function MRe(e,t){return te(()=>{let n=aa(t,br(),Number.MAX_VALUE),r=ws(me(1,n)),a=aa(e,br(),Number.MAX_VALUE),s=ws(me(1,a));return Wn(Fb(Oe(r,s)),-1)})}function ORe(e,t){return te(()=>{let n=zo(0,Oe(1,Z(e,t)));return Wn(Fb(n),-1)})}function FRe(e,t){return te(()=>{let n=zo(0,Oe(1,Z(e,t)));return Wn(n,-1)})}function PRe(e,t){return te(()=>{let n=Ge(Z(e,t),-1),r=Ps(Z(Oe(1,e),t),-1);return zo(0,me(1,Oe(r,n)))})}function LRe(e,t){return te(()=>{let n=Math.log(2),r=Oe(t,e),a=Oe(me(r,Ip(Z(-2,r))),n);return Wn(a,-1)})}function ov(e,t,n=!1){return te(()=>{if(n)t=Nc(t);else{let r=Ge(t,t.shape.length-1,!0);t=ze(t,r)}return t=aa(t,br(),1-br()),In(Ge(Z(Se(e,"float32"),ws(t)),t.shape.length-1))})}function V1(e,t,n=!1){return te(()=>{let r=Se(Zg(H$e(e)),"int32");t=aa(t,br(),1-br());let a=t.shape,s=ee(fm(r,a[a.length-1]),a);return ov(s,t,n)})}function zRe(e,t){if(!j.arraysEqual(e.shape,t.shape))throw new re(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return te(()=>{let n=hn(t),r=In(ur(t));return me(Oe(n,Z(t,e)),_b(sa(r)))})}function DS(e,t){return te(()=>{let n;return n=aa(t,br(),1-br()),n=ws(ze(n,Oe(1,n))),Wn(zRe(e,n),-1)})}function BRe(e,t){return te(()=>{let n=aa(e,br(),1),r=aa(t,br(),1);return Ge(Z(e,ws(ze(n,r))),-1)})}function URe(e,t){return te(()=>{let n=ws(me(br(),t));return Wn(Oe(t,Z(e,n)),-1)})}function dR(e,t){return te(()=>{let n=W1(e,-1),r=W1(t,-1),a=Z(n,r);return In(Ge(a,-1))})}var H1={meanSquaredError:jp,meanAbsoluteError:RS,meanAbsolutePercentageError:sy,meanSquaredLogarithmicError:MRe,squaredHinge:ORe,hinge:FRe,categoricalHinge:PRe,logcosh:LRe,categoricalCrossentropy:ov,sparseCategoricalCrossentropy:V1,binaryCrossentropy:DS,kullbackLeiblerDivergence:BRe,poisson:URe,cosineProximity:dR};function kC(e){if(typeof e=="string"){if(e in H1)return H1[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new re(t)}else return e}function hR(e,t){return te(()=>{let n=Z(.5,Ns(t)),r=kl(Ta(t,n),e.dtype);return Wn(bs(e,r),-1)})}function pR(e,t){return te(()=>kl(bs(Ld(e,-1),Ld(t,-1)),"float32"))}function z7(e,t){return te(()=>Se(Ge(ui(bs(e,1),bs(t,1))),"float32"))}function WRe(e,t){return te(()=>Se(Ge(ui(bs(e,1),bs(t,0))),"float32"))}function VRe(e,t){return te(()=>Se(Ge(ui(bs(e,0),bs(t,1))),"float32"))}function B7(e,t){return te(()=>{let n=z7(e,t),r=VRe(e,t),a=me(n,r);return Se(Mr(Ta(a,0),ze(n,a),0),"float32")})}function HRe(e,t){return te(()=>{let n=z7(e,t),r=WRe(e,t),a=me(n,r);return Se(Mr(Ta(a,0),ze(n,a),0),"float32")})}function U7(e,t){return DS(e,t)}function W7(e,t){return e.rank===t.rank&&(e=kc(e,[e.rank-1])),t=Ld(t,-1),t.dtype!==e.dtype&&(t=Se(t,e.dtype)),Se(bs(e,t),"float32")}function GRe(e,t){return te(()=>{let n=e.sub(t).square().sum(),r=e.sub(e.mean()).square().sum();return Ze(1).sub(n.div(r))})}var qRe=jp,KRe=jp,QRe=RS,XRe=RS,YRe=sy,JRe=sy,fR=ov,ZRe=dR,V7=V1,G1={binaryAccuracy:hR,categoricalAccuracy:pR,precision:B7,categoricalCrossentropy:fR,sparseCategoricalCrossentropy:V7,mse:qRe,MSE:KRe,mae:QRe,MAE:XRe,mape:YRe,MAPE:JRe,cosine:ZRe};function eDe(e){if(typeof e=="string"&&e in G1)return G1[e];if(typeof e!="string"&&e!=null)return e;throw new re(`Unknown metric ${e}`)}function Ww(e){if(uo(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(let n of Object.keys(H1))if(H1[n]===e){t=n;break}if(t!==void 0)return t;for(let n of Object.keys(G1))if(G1[n]===e){t=n;break}return t!==void 0?t:e.name}}function tDe(e){let t={Adagrad:()=>zc.adagrad(.01),Adadelta:()=>zc.adadelta(1,.95,br()),Adam:()=>zc.adam(.001,.9,.999,br()),Adamax:()=>zc.adamax(.002,.9,.999,br(),0),RMSProp:()=>zc.rmsprop(.001,.9,0,br()),SGD:()=>zc.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new re(`Unknown Optimizer ${e}`)}function OL(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!lE(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let r=JSON.stringify(e);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function lE(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if(typeof n!="string"||!lE(e[n]))return!1;return!0}else if(Array.isArray(e)){for(let t of e)if(!lE(t))return!1;return!0}else return!1;else{let t=typeof e;return t==="string"||t==="number"||t==="boolean"}}function nDe(e,t,n,r=console.log){let a=aDe(e),s=["Layer (type)","Input Shape","Output shape","Param #"];a?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(t*u)));let i;if(!a){s.push("Receives inputs"),i=[];for(let u in e.nodesByDepth)i.push(...e.nodesByDepth[u])}r("_".repeat(t)),q1(s,n,r),r("=".repeat(t));let o=e.layers;for(let u=0;u<o.length;++u)a?sDe(o[u],n,r):iDe(o[u],n,i,r),r((u===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=rDe(e),c=z1(e.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(t))}function rDe(e){let t;return e.collectedTrainableWeights!=null?t=z1(e.collectedTrainableWeights):t=z1(e.trainableWeights),t}function aDe(e){let t=!0,n=[],r=[];for(let a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(let a of n){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){t=!1;break}r.push(...a)}if(t)for(let a of e.layers){let s=!1;for(let i of a.inboundNodes)if(r.indexOf(i)!==-1)if(s){t=!1;break}else s=!0;if(!t)break}return t}function q1(e,t,n=console.log){let r="";for(let a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=e[a],r=r.slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function sDe(e,t,n){let r,a;try{a=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}let s=e.name,i=e.getClassName(),o=[`${s} (${i})`,a,r,e.countParams().toString()];q1(o,t,n)}function iDe(e,t,n,r){let a,s;try{s=e.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{s="multiple"}try{a=JSON.stringify(e.outputShape)}catch{a="multiple"}let i=[];for(let h of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let p=0;p<h.inboundLayers.length;++p){let f=h.inboundLayers[p].name,g=h.nodeIndices[p],m=h.tensorIndices[p];i.push(`${f}[${g}][${m}]`)}let o=e.name,l=e.getClassName(),c=i.length===0?"":i[0],u=[`${o} (${l})`,s,a,e.countParams().toString(),c];q1(u,t,r);for(let h=1;h<i.length;++h)q1(["","","","",i[h]],t,r)}function H7(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function lv(e,t){if(e===null)return null;if(typeof e=="string")return Hc(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let s=e[a];H7(t,a,s)?n.push(s):n.push(lv(s,t))}return n}else{let n={};for(let r of Object.keys(e)){let a=e[r];if(r==="name"&&typeof a=="string")n[r]=a;else{let s=Hc(r);n[s]=lv(a,s)}}return n}}function uE(e,t){if(e==null)return null;if(typeof e=="string")return el(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let s=e[a];H7(t,a,s)?n.push(s):n.push(uE(s,t))}return n}else{let n={};for(let r of Object.keys(e)){let a=e[r],s=el(r);(r==="name"||r==="className")&&typeof a=="string"?n[s]=a:n[s]=uE(a,r)}return n}}var mR="4.22.0",oDe=e=>{let t=Object.keys(e);if(t.length===0)return!1;let n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))},lDe=class no extends Lt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){let v=this.getClassName().toLowerCase();this.name=kS(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],$u(this.inputs).length!==this.inputs.length)throw new re(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);$u(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let v of this.outputs){let b=v.sourceLayer,w=v.nodeIndex,k=v.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(k)}for(let v of this.inputs){let b=v.sourceLayer,w=v.nodeIndex,k=v.tensorIndex;uo(w===0,"input layer has >1 nodes"),uo(k===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(k)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){let b=this.inputLayers[v];if(!(b instanceof ay))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${v} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(let v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);let n={},r={},a={},s={},i={},o=[],l=(v,b,w,k,I,C)=>{(k==null||I==null||C==null)&&(k=v.sourceLayer,I=v.nodeIndex,C=v.tensorIndex);let S=k.inboundNodes[I];if(w.indexOf(S)!==-1)throw new yo(`The tensor ${v.name} at layer "${k.name}" is part of a cycle.`);if(b.indexOf(S)!==-1)return;this.containerNodes.add(no.nodeKey(k,I)),k.id in i||(i[k.id]=Object.keys(i).length),w.indexOf(S)===-1&&w.push(S);let E=S.inboundLayers.length;for(let T=0;T<E;T++){let $=S.inputTensors[T],_=S.inboundLayers[T],M=S.nodeIndices[T],L=S.tensorIndices[T];l($,b,w,_,M,L)}for(b.push(S);w.indexOf(S)>=0;)w.splice(w.indexOf(S),1);o.push(S)},c=[],u=[];for(let v of this.outputs)l(v,c,u);let h=o.slice().reverse();for(let v of h){r[v.id]=v,v.id in n||(n[v.id]=0);let b=n[v.id],w=a[v.outboundLayer.id]==null?0:a[v.outboundLayer.id];b=Math.max(b,w),a[v.outboundLayer.id]=b,s[v.outboundLayer.id]=v.outboundLayer,n[v.id]=b;for(let k=0;k<v.inboundLayers.length;k++){let I=v.inboundLayers[k],C=v.nodeIndices[k],S=I.inboundNodes[C],E=n[S.id]==null?0:n[S.id];n[S.id]=Math.max(b+1,E),r[S.id]=S}}let p={};for(let v in n){let b=n[v];b in p||(p[b]=[]),p[b].push(r[v])}let f={};for(let v in a){let b=a[v];b in f||(f[b]=[]),f[b].push(s[v])}let g=Object.keys(f).map(v=>parseInt(v,10)).sort(zw);this.layers=[];for(let v of g){let b=f[v];b.sort((w,k)=>{let I=i[w.id],C=i[k.id];return I<C?-1:I>C?1:0});for(let w of b)w instanceof no&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,g=Object.keys(p).map(v=>parseInt(v,10)).sort(zw);let m=this.inputs.slice(),y=[];for(let v of g)for(let b of p[v]){let w=b.outboundLayer;if(w!=null){for(let k of b.inputTensors)if(m.indexOf(k)===-1)throw new yo(`Graph disconnected: cannot obtain value for tensor ${k} at layer "${w.name}". The following previous layers were accessed without issue: ${y}`);for(let k of b.outputTensors)m.push(k);y.push(w.name)}}this.nodesByDepth=p;let x=this.layers.map(v=>v.name);for(let v of x){let b=x.filter(w=>w===v).length;if(b!==1)throw new yo(`The name "${v}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new $S({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(let n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new re("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(let n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){let t=[];for(let n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){let n=[];for(let r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){let r={},a=0,s=oDe(t);s&&this.parseWeights(t);for(let o of this.layers)for(let[l,c]of o.weights.entries()){let u=s?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(r[u]!=null)throw new re(`Duplicate weight name: ${u}`);r[u]=c,a++}let i=[];for(let o in t){let l=o;if(r[o]==null){let c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[l]!=null)i.push([r[l],t[o]]);else if(n)throw new re(`Provided weight data has no target variable: ${o}`);delete r[l]}if(n){let o=[];for(let l in r)o.push(l);if(o.length>0)throw new re(`${o.length} of ${a} weights are not set: ${o}`)}aR(i)}parseWeights(t){for(let n in Object.keys(t)){let r=n.split("/"),a=["vars","layer_checkpoint_dependencies"],s=r.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!a.includes(i)).join("/");s!==n&&(t[s]=t[n],delete t[n])}}updatedConfig(){let t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${mR}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){let r=uE(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return te(()=>{t=dn(t);let r=new xf;for(let a=0;a<this.inputs.length;++a)r.add(this.inputs[a],t[a]);return Xy(this.outputs,r,n)})}computeMask(t,n){return te(()=>{t=dn(t);let r;return n==null?r=Vd(null,t.length):r=dn(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){let n=L1(t);if(n.length!==this.inputLayers.length)throw new re(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);let r={};for(let o=0;o<n.length;o++){let l=this.inputLayers[o],c=n[o],u=l.name+"_0_0";r[u]=c}let a=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(zw);if(a.length>1)for(let o of a){let l=this.nodesByDepth[o];for(let c of l){let u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;let h=[];for(let m=0;m<c.inboundLayers.length;m++){let y=c.inboundLayers[m],x=c.nodeIndices[m],v=c.tensorIndices[m],b=`${y.name}_${x}_${v}`,w=r[b];h.push(w)}let p=u.computeOutputShape(Oa(h)),f=L1(p),g=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){let y=`${u.name}_${g}_${m}`;r[y]=f[m]}}}let s=[],i=[];for(let o=0;o<this.outputLayers.length;o++){let l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],u=this.outputLayersTensorIndices[o],h=`${l.name}_${c}_${u}`;i.push(h)}for(let o=0;o<i.length;o++){let l=i[o];uo(l in r),s.push(r[l])}return Oa(s)}runInternalGraph(t,n){n==null&&(n=Vd(null,t.length));let r={};for(let l=0;l<this.inputs.length;++l){let c=this.inputs[l],u=t[l],h=n[l];r[c.id]=[u,h]}let a=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(zw);for(let l of a){let c=this.nodesByDepth[l];for(let u of c){let h=u.outboundLayer,p=u.inputTensors,f=u.outputTensors,g=new Array;for(let m of p)m.id in r&&g.push(r[m.id]);if(g.length===p.length){let m={},y,x,v,b;if(u.callArgs!=null&&(m=u.callArgs),g.length===1){let[w,k]=g[0];m.mask==null&&(m.mask=k),v=dn(h.call(w,m)),b=dn(h.computeMask(w,k)),y=[w],x=[k]}else y=g.map(w=>w[0]),x=g.map(w=>w[1]),m.mask==null&&(m.mask=x),v=dn(h.call(y,m)),b=dn(h.computeMask(y,x));if(h.activityRegularizer)throw new Pt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){let k=f[w],I=v[w],C=b[w];r[k.id]=[I,C]}}}}let s=[],i=[],o=[];for(let l of this.outputs){uo(l.id in r,`Could not compute output ${l.name} : ${l.id}`);let[c,u]=r[l.id];o.push(c.shape),s.push(c),i.push(u)}return[s,i,o]}buildNodeConversionMap(t){let n={},r;for(let a of this.layers){r=a instanceof no?1:0;for(let s=0;s<a.inboundNodes.length;s++){let i=no.nodeKey(a,s);this.containerNodes.has(i)&&(n[i]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new re("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(let r of this.layers)if(r.name===t)return r;throw new re(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new re(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return te(()=>{let t=[];for(let n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){let a=no.nodeKey(n,r);this.containerNodes.has(a)&&t.push(...n.calculateLosses())}return t})}getConfig(){let t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(let i of this.layers){let o=i.getClassName(),l=i.getConfig(),c=[];for(let h=0;h<i.inboundNodes.length;h++){let p=i.inboundNodes[h],f=no.nodeKey(i,h),g={};if(this.containerNodes.has(f)){if(p.callArgs)try{JSON.stringify(p.callArgs),g=p.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),g={}}if(p.inboundLayers.length>0){let m=[];for(let y=0;y<p.inboundLayers.length;y++){let x=p.inboundLayers[y],v=p.nodeIndices[y],b=p.tensorIndices[y],w=no.nodeKey(x,v),k=n[w];k==null&&(k=0),m.push([x.name,k,b,g])}c.push(m)}}}let u={};u.name=i.name,u.className=o,u.config=l,u.inboundNodes=c,r.push(u)}t.layers=r;let a=[];for(let i=0;i<this.inputLayers.length;i++){let o=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=no.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);let h=this.inputLayersTensorIndices[i];a.push([o.name,u,h])}t.inputLayers=a;let s=[];for(let i=0;i<this.outputLayers.length;i++){let o=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=no.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);let h=this.outputLayersTensorIndices[i];s.push([o.name,u,h])}return t.outputLayers=s,t}static fromConfig(t,n,r={},a=!1){let s={},i={};function o(y,x){y.name in i?i[y.name].push(x):i[y.name]=[x]}function l(y,x){let v=[],b;for(let w of x){let k=w[0],I=w[1],C=w[2];if(b=w[3]==null?{}:w[3],!(k in s)){o(y,x);return}let S=s[k];if(S.inboundNodes.length<=I){o(y,x);return}let E=S.inboundNodes[I];v.push(E.outputTensors[C])}v.length>0&&y.apply(Oa(v),b)}function c(y){let x=y.name,v=Di(y,n.customObjects!=null?n.customObjects:{});v.setFastWeightInitDuringBuild(a),s[x]=v,y.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new re(`Corrupted configuration, expected array for nodeData: ${b}`);o(v,b)})}let u=n.name,h=n.layers;for(let y of h)c(y);for(;!$$e(i);)for(let y of h){let x=s[y.name];if(x.name in i){let v=i[x.name];delete i[x.name];for(let b of v)l(x,b)}}let p=[],f=[],g=n.inputLayers;for(let y of g){let x=y[0],v=y[1],b=y[2];uo(x in s);let w=s[x].inboundNodes[v].outputTensors;p.push(w[b])}let m=n.outputLayers;for(let y of m){let x=y[0],v=y[1],b=y[2];uo(x in s);let w=s[x].inboundNodes[v].outputTensors;f.push(w[b])}return new t({inputs:p,outputs:f,name:u})}get stateful(){if(this._stateful)throw new re("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let t of this.layers)if(t.stateful)return!0;return!1}resetStates(){te(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}};function uDe(e,t,n){let r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(a=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){let a=[];return t.forEach(s=>{s in e?a.push(e[s]):a.push(null)}),a}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function G7(e,t){return uDe(e,t,"classWeight")}async function q7(e,t,n,r){if(n!=null){let a=te(()=>{if(e.shape.length===1)return ko(e);if(e.shape.length===2){if(e.shape[1]>1)return Ld(e,1);if(e.shape[1]===1)return ee(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await a.data());mt(a);let i=[];return s.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);i.push(n[o])}),cn(i,"float32")}else return null}function cDe(e,t){return Z(e,t)}var dDe=32;function K7(e,t){let n,r,a=t;n=a.xs,r=a.ys,j.assert(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let s=FL("input",e.inputNames,n),i=FL("output",e.outputNames,r),o=s[0].shape[0];j.assert(s.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),j.assert(i.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<s.length;l++)j.assert(s[l].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let l=0;l<i.length;l++)j.assert(i[l].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:s,ys:i}}function FL(e,t,n){if(n instanceof Dt)return[n];if(Array.isArray(n))return j.assert(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{let r=[];for(let a of t){if(n[a]==null)throw new re(`The feature data generated by the dataset lacks the required ${e} key '${a}'.`);r.push(n[a])}return r}}function hDe(e){if(e.length===3)throw new Pt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function pDe(e,t,n){let r=n.batchesPerEpoch!=null;if(j.assert(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),j.assert(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),j.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),j.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),j.assert(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let a=n.validationData!=null,s,i;if(a)if(PL(n.validationData))j.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{let y=hDe(n.validationData);s=y.xs,i=y.ys}let o=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c;a?c=l.slice().concat(l.map(y=>"val_"+y)):c=l.slice();let u=P7(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:p,history:f}=L7(u,h,n.epochs,null,null,fDe(t,n),null,a,c);p.setModel(e),e.history=f,await p.onTrainBegin(),e.stopTraining_=!1;let g=n.initialEpoch==null?0:n.initialEpoch,m=await t.iterator();for(;g<n.epochs;){let y={};await p.onEpochBegin(g);let x=0,v=0;for(r||(m=await t.iterator());!r||x<n.batchesPerEpoch;){let b=await m.next();if(r&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){let{xs:w,ys:k}=K7(e,b.value),I={};I.batch=v,I.size=w[0].shape[0],await p.onBatchBegin(v,I);let C=[];if(n.classWeight!=null){let T=G7(n.classWeight,e.outputNames);for(let $=0;$<T.length;++$)C.push(await q7(k[$],null,T[$]))}let S=w.concat(k).concat(C),E=o(S);mt(S);for(let T=0;T<l.length;++T){let $=l[T],_=E[T];I[$]=_,vr(_)}await p.onBatchEnd(v,I),D7(I),v++,x++}if(r?x>=n.batchesPerEpoch:b.done){if(a){let w;PL(n.validationData)?w=dn(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):w=dn(e.evaluate(s,i,{batchSize:n.validationBatchSize==null?dDe:n.validationBatchSize,verbose:0}));for(let k=0;k<e.metricsNames.length;++k)y[`val_${e.metricsNames[k]}`]=w[k]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(g,y),g++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function fDe(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function PL(e){return typeof e.iterator=="function"}function mDe(e){return typeof e.next=="function"}async function gDe(e,t,n){n=n||{};let r=n.batches!=null,a=e.testFunction,s=[];if(n.verbose>0)throw new Pt("Verbose mode is not implemented yet.");j.assert(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);let i=mDe(t)?t:await t.iterator(),o=0,l=0;for(;!r||l<n.batches;){let c=await i.next();if(s=te(()=>{if(c.value){let{xs:u,ys:h}=K7(e,c.value),p=u.concat(h),f=te(()=>a(p));if(mt(p),l===0)for(let m=0;m<f.length;++m)s.push(Ze(0));let g=p[0].shape[0];for(let m=0;m<f.length;++m){let y=f[m],x=s[m];s[m]=te(()=>me(s[m],Z(g,y))),l>0&&mt(x)}mt(f),o+=g,++l}return s}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<s.length;++c){let u=s[c];s[c]=ze(s[c],o),mt(u)}return Oa(s)}function SC(e){j.assert(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function Oy(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>gd(r,t,n-t)):gd(e,t,n-t)}function cE(e,t){return te(()=>e==null?null:Array.isArray(e)?e.map(n=>cE(n,t)):_7(e,t.dtype==="int32"?t:Se(t,"int32")))}function _C(e,t){let n=[],r=0,a=null;for(;r<e;)a=r+t,a>=e&&(a=e),n.push([r,a]),r=a;return n}function Q7(e){let t=[];e instanceof Dt&&(e=[e]);for(let n=0;n<e.length;++n){let r=e[n];if(r.rank===1)t.push(Ob(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function yi(e,t){if(e==null)return;let n=[];if(t instanceof Dt)n.push(t.id);else if(Array.isArray(t))t.forEach(a=>n.push(a.id));else if(t!=null)for(let a in t){let s=t[a];n.push(s.id)}let r=[];if(e instanceof Dt)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(a=>{n.indexOf(a.id)===-1&&r.push(a)});else if(e!=null)for(let a in e){let s=e[a];n.indexOf(s.id)===-1&&r.push(s)}r.forEach(a=>{a.isDisposed||a.dispose()})}function yDe(e){return e instanceof Dt}function dE(e){return Array.isArray(e)}function LL(e){return!yDe(e)&&!dE(e)}function zL(e,t,n,r=!0,a=""){if(t==null||t.length===0){if(e!=null){let i=!1;if(dE(e)&&e.length>0)i=!0;else if(LL(e)){for(let o in e)if(e.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new re(`Error when checking model ${a} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(i=>null);let s;if(LL(e)){e=e,s=[];for(let i of t){if(e[i]==null)throw new re(`No data provided for "${i}". Need data for each key in: ${t}`);s.push(e[i])}}else if(dE(e)){if(e=e,e.length!==t.length)throw new re(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);s=e}else{if(e=e,t.length>1)throw new re(`The model ${a} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);s=[e]}if(s=Q7(s),n!=null)for(let i=0;i<t.length;++i){if(n[i]==null)continue;let o=s[i];if(o.shape.length!==n[i].length)throw new re(`Error when checking ${a}: expected ${t[i]} to have ${n[i].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;let c=o.shape[l],u=n[i][l];if(u!=null&&u>=0&&c!==u)throw new re(`${a} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${a} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return s}function xDe(e,t,n){let r=$u(e.map(s=>s.shape[0]));r.sort();let a=$u(t.map(s=>s.shape[0]));if(a.sort(),r.length>1)throw new re(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(a.length>1)throw new re(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&a.length>0&&!j.arraysEqual(r,a))throw new re(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${a[0]} target sample(s).`)}function vDe(e,t,n){let r=[jp,DS,ov];for(let a=0;a<e.length;++a){let s=e[a],i=t[a],o=n[a];if(i!=null){if(i===ov&&s.shape[s.shape.length-1]===1)throw new re(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(i)!==-1){let l=s.shape.slice(1),c=o.slice(1);for(let u=0;u<l.length;++u){let h=l[u],p=c[u];if(p!=null&&h!==p)throw new re(`A target Tensor with shape ${s.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function BL(e,t,n,r=!0,a=""){let s;if(Array.isArray(e)){if(e.length!==t.length)throw new re(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);s=e}else{if(t.length>1)throw new re(`The model expects ${t.length} ${a} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);s=[e]}if(n!=null)for(let i=0;i<t.length;++i){if(n[i]==null)continue;let o=s[i];if(o.shape.length!==n[i].length)throw new re(`Error when checking ${a}: expected ${t[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;let c=o.shape[l],u=n[i][l];if(u!=null&&u!==c)throw new re(`Error when checking ${a}: expected ${t[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function bDe(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{let r=[];for(let a of t){let s=n.hasOwnProperty(a)?n[a]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}var wDe="layers-model",hl=class extends lDe{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new re("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");nDe(this,e,t,n)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=tDe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Al))throw new re("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let s in e.loss)if(this.outputNames.indexOf(s)===-1)throw new re(`Unknown entry in loss dictionary: "${s}". Only expected the following keys: ${this.outputNames}`);for(let s of this.outputNames)e.loss[s]==null&&console.warn(`Output "${s}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${s} during training`),t.push(kC(e.loss[s]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new re(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(s=>kC(s))}else{let s=kC(e.loss);this.outputs.forEach(i=>{t.push(s)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){let i=this.internalOutputShapes[s],o=this.outputNames[s];this.feedOutputNames.push(o),this.feedOutputShapes.push(i),this.feedLossFns.push(this.lossFunctions[s])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],md("loss",()=>{for(let s=0;s<this.outputs.length;++s){if(n.indexOf(s)!==-1)continue;let i=this.lossFunctions[s];this.outputs.length>1&&(this.metricsTensors.push([i,s]),this.metricsNames.push(this.outputNames[s]+"_loss"))}});let r=bDe(e.metrics,this.outputNames),a=(s,i,o)=>{this.outputNames.length>1&&(i=this.outputNames[s]+"_"+i),this.metricsNames.push(i),this.metricsTensors.push([o,s])};md("metric",()=>{for(let s=0;s<this.outputs.length;++s){if(n.indexOf(s)!==-1)continue;let i=r[s];(o=>{let l="",c,u,h;for(let p of o){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){let g=this.internalOutputShapes[s];g[g.length-1]===1||this.lossFunctions[s]===DS?["accuracy","acc"].indexOf(p)!==-1?u=hR:["crossentropy","ce"].indexOf(p)!==-1&&(u=U7):this.lossFunctions[s]===V1?["accuracy","acc"].indexOf(p)!==-1?u=W7:["crossentropy","ce"].indexOf(p)!==-1&&(u=V7):["accuracy","acc"].indexOf(p)!==-1?u=pR:["crossentropy","ce"].indexOf(p)!==-1&&(u=fR);let m;["accuracy","acc"].indexOf(p)!==-1?m="acc":["crossentropy","ce"].indexOf(p)!==-1&&(m="ce"),h=u,c=l+m}else h=eDe(p),c=l+Ww(p);let f;md(c,()=>{f=h}),a(s,c,f)}})(i)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){let r=n.batchSize==null?32:n.batchSize;SC(r);let a=this.standardizeUserDataXY(e,t,!0,r);try{let s=a[0].concat(a[1]);this.makeTestFunction();let i=this.testFunction,o=this.testLoop(i,s,r,n.verbose,n.steps);return Oa(o)}finally{yi(a[0],e),yi(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),gDe(this,e,t)}checkNumSamples(e,t,n,r="steps"){let a;if(n!=null){if(a=null,t!=null)throw new re(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new re(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new re("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),s=new xf;if(e instanceof Dt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new re(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let o=0;o<this.inputs.length;++o)s.add(this.inputs[o],e[o])}else for(let o of this.inputs){let l=e[o.name];if(l==null)throw new re(`No value is provided for the model's input ${o.name}`);s.add(o,l)}let i=Xy(a,s);return n?i:i[0]}retrieveSymbolicTensors(e){let t=Vd(null,e.length),n=e.length;for(let r of this.layers){let a=Array.isArray(r.output)?r.output:[r.output],s=a.map(i=>i.name);for(let i=0;i<e.length;++i){let o=s.indexOf(e[i]);if(o!==-1&&(t[i]=a[o],n--),n===0)break}if(n===0)break}if(n>0){let r=[];throw t.forEach((a,s)=>{a==null&&r.push(e[s])}),new re(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,n=!1){return te(()=>{let r=this.checkNumSamples(e);if(n)throw new Pt("Verbose predictLoop() is not implemented yet.");let a=_C(r,t),s=this.outputs.map(i=>[]);for(let i=0;i<a.length;++i)te(()=>{let o=a[i][0],l=a[i][1],c=Oy(e,o,l),u=[];if(Array.isArray(c))for(let p=0;p<c.length;++p)u.push({key:this.inputs[p],value:c[p]});else u.push({key:this.inputs[0],value:c});let h=new xf(u);return Xy(this.outputs,h)}).forEach((o,l)=>s[l].push(o));return Oa(s.map(i=>wn(i,0)))})}predict(e,t={}){let n=Q7(e);BL(n,this.inputNames,this.feedInputShapes,!1);try{let r=t.batchSize==null?32:t.batchSize;return SC(r),this.predictLoop(n,r)}finally{yi(n,e)}}predictOnBatch(e){BL(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,r){if(this.optimizer_==null)throw new yo("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let s=0;s<this.feedOutputShapes.length;++s){let i=this.feedOutputShapes[s];this.feedLossFns[s]===V1?a.push(i.slice(0,i.length-1).concat([1])):a.push(i)}if(e=zL(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=zL(t,this.feedOutputNames,a,!1,"target"),xDe(e,t),vDe(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new re(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r,a=!0,s){let[i,o]=this.standardizeUserDataXY(e,t,a,s);if(n!=null)throw new Error("sample weight is not supported yet.");let l=null;if(r!=null){let c=G7(r,this.outputNames);l=[];for(let u=0;u<c.length;++u)l.push(await q7(o[u],null,c[u]))}return[i,o,l]}testLoop(e,t,n,r=0,a){return te(()=>{let s=this.checkNumSamples(t,n,a,"steps"),i=[];if(r>0)throw new Pt("Verbose mode is not implemented yet.");if(a!=null)throw new Pt("steps mode in testLoop() is not implemented yet");{let o=_C(s,n),l=cn(Bi(0,s));for(let c=0;c<o.length;++c){let u=o[c][0],h=o[c][1],p=gd(l,u,h-u),f=cE(t,p),g=e(f);if(c===0)for(let m=0;m<g.length;++m)i.push(Ze(0));for(let m=0;m<g.length;++m){let y=g[m];i[m]=me(i[m],Z(h-u,y))}}for(let c=0;c<i.length;++c)i[c]=ze(i[c],s)}return i})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let r=e[n],a=r;if(CL(e,r)>1){let s=CL(e.slice(0,n),r);a+=`_${s}`}t.push(a)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),s=[],i=()=>{let l=[];for(let p=0;p<this.inputs.length;++p)l.push({key:this.inputs[p],value:n[p]});let c=new xf(l),u=Xy(this.outputs,c,{training:!0}),h;for(let p=0;p<this.lossFunctions.length;++p){let f=this.lossFunctions[p],g=f(r[p],u[p]);a[p]!=null&&(g=cDe(g,a[p]));let m=Wn(g);t.push(m),p===0?h=g:h=me(h,g)}for(let p=0;p<this.metricsTensors.length;++p){let f;if(this.outputs.length>1&&p<this.outputs.length)f=t[p];else{let g=this.metricsTensors[p][0],m=this.metricsTensors[p][1];f=Wn(g(r[m],u[m]))}vr(f),s.push(f)}return h=Wn(h),this.calculateLosses().forEach(p=>{h=me(h,p)}),h},o=this.collectedTrainableWeights.map(l=>l.read());return[this.optimizer_.minimize(i,!0,o)].concat(s)}}makeTestFunction(){this.testFunction=e=>te(()=>{let t=[],n,r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let l=0;l<this.inputs.length;++l)s.push({key:this.inputs[l],value:r[l]});let i=new xf(s),o=Xy(this.outputs,i);for(let l=0;l<this.lossFunctions.length;++l){let c=this.lossFunctions[l],u=Wn(c(a[l],o[l]));l===0?n=u:n=me(n,u),t.push(n)}for(let l=0;l<this.metricsTensors.length;++l){let c=this.metricsTensors[l][0],u=this.metricsTensors[l][1],h=Wn(c(a[u],o[u]));t.push(h)}return t})}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,s,i,o,l,c,u,h;try{let p=n.batchSize==null?32:n.batchSize;SC(p);let f=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,!1,p);r=f[0],a=f[1],h=f[2];let g=!1,m;if(n.validationData!=null&&n.validationData.length>0){if(g=!0,n.validationData.length===2)o=n.validationData[0],l=n.validationData[1];else throw n.validationData.length===3?new Pt("validationData including sample weights is not supported yet."):new re(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);let I=await this.standardizeUserData(o,l,null,null,!0,p);c=I[0],u=I[1],m=c.concat(u)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){g=!0;let I=Math.floor(r[0].shape[0]*(1-n.validationSplit)),C=r[0].shape[0];c=Oy(r,I,C),s=r,r=Oy(r,0,I),u=Oy(a,I,C),i=a,a=Oy(a,0,I),m=c.concat(u)}else n.validationSteps!=null&&(g=!0);let y=r.concat(a).concat(h);this.checkTrainableWeightsConsistency();let x=this.makeTrainFunction(),v=this.getDedupedMetricsNames(),b,w;g?(this.makeTestFunction(),b=this.testFunction,w=v.slice().concat(v.map(I=>"val_"+I))):(b=null,m=[],w=v.slice());let k=P7(n.callbacks,n.yieldEvery);return await this.fitLoop(x,y,v,p,n.epochs,n.verbose,k,b,m,n.shuffle,w,n.initialEpoch,null,null)}finally{this.isTraining=!1,yi(r,e),yi(a,t),yi(s,e),yi(i,t),yi(c,o),yi(u,l),h!=null&&mt(h)}}async fitLoop(e,t,n,r,a,s,i,o,l,c,u,h,p,f){r==null&&(r=32),a==null&&(a=1),c==null&&(c=!0),h==null&&(h=0);let g=!1;if(o!=null&&l!=null&&(g=!0),f!=null&&(g=!0,p==null))throw new re("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let m=this.checkNumSamples(t,r,p,"steps_per_epoch"),y;m!=null&&(y=Bi(0,m)),s==null&&(s=1);let{callbackList:x,history:v}=L7(i,s,a,h,m,p,r,g,u);x.setModel(this),this.history=v,await x.onTrainBegin(),this.stopTraining_=!1;for(let b=h;b<a;++b){await x.onEpochBegin(b);let w={};if(p!=null)throw new Pt("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Pt("batch shuffling is not implemneted yet");c&&j.shuffle(y);let k=cn(y),I=_C(m,r);for(let C=0;C<I.length;++C){let S={};if(await x.onBatchBegin(C,S),te(()=>{let E=I[C][0],T=I[C][1],$=gd(k,E,T-E);S.batch=C,S.size=T-E;let _=cE(t,$),M=e(_);for(let L=0;L<n.length;++L){let U=n[L],O=M[L];S[U]=O,vr(O)}if(C===I.length-1&&g){let L=this.testLoop(o,l,r);for(let U=0;U<n.length;++U){let O=n[U],F=L[U];vr(F),w["val_"+O]=F}}}),await x.onBatchEnd(C,S),D7(S),this.stopTraining_)break}k.dispose()}if(await x.onEpochEnd(b,w),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return pDe(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),r=n[0],a=n[1],s=this.makeTrainFunction()(r.concat(a)),i=[];for(let o of s){let l=await o.data();i.push(l[0])}return mt(s),yi(n[0],e),yi(n[1],t),Oa(i)}getNamedWeights(e){let t=[],n=e!=null&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let s=0;s<r.length;++s)n&&!r[s].trainable||t.push({name:r[s].originalName,tensor:a[s]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let t=GI().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-GI().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=el(this.loss);else if(Array.isArray(this.loss)){for(let t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>el(t))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let r of t)if(typeof n[r]=="string")e[r]=el(n[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[el(Ww(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>el(Ww(e)));{let e={};for(let t in this.metrics)e[t]=el(Ww(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let t=lv(e.optimizer_config),n=Di(t),r;if(typeof e.loss=="string")r=Hc(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(s=>Hc(s));else if(e.loss!=null){r={};for(let s in e.loss)r[s]=Hc(e.loss[s])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(s=>Hc(s));else if(e.metrics!=null){a={};for(let s in e.metrics)a[s]=Hc(e.metrics[s])}this.compile({loss:r,metrics:a,optimizer:n})}async save(e,t){if(typeof e=="string"){let a=qr.getSaveHandlers(e);if(a.length===0)throw new re(`Cannot find any save handlers for URL '${e}'`);if(a.length>1)throw new re(`Found more than one (${a.length}) save handlers for URL '${e}'`);e=a[0]}if(e.save==null)throw new re("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await qr.encodeWeights(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:wDe,generatedBy:`TensorFlow.js tfjs-layers v${mR}`,convertedBy:null};if(t!=null&&t.includeOptimizer&&this.optimizer!=null){r.trainingConfig=this.getTrainingConfig();let a="optimizer",{data:s,specs:i}=await qr.encodeWeights(await this.optimizer.getWeights(),a);n.specs.push(...i),n.data=qr.concatenateArrayBuffers([n.data,s])}return this.userDefinedMetadata!=null&&(OL(this.userDefinedMetadata,this.name,!0),r.userDefinedMetadata=this.userDefinedMetadata),r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){OL(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};hl.className="Model";we.registerClass(hl);var X7=class extends hl{};X7.className="Functional";we.registerClass(X7);async function NDe(e,t){"modelTopology"in e||(e={modelTopology:e}),e=e;let n=e.modelTopology;n.model_config!=null&&(n=n.model_config);let r=lv(n),a=Di(r,t);if(e.weightsManifest!=null){let s=await qr.loadWeights(e.weightsManifest,e.pathPrefix,a.weights.map(o=>o.originalName)),i={};for(let o of a.weights)i[o.originalName]=s[o.originalName];a.loadWeights(i),mt(s)}return a}async function kDe(e,t){if(t==null&&(t={}),typeof e=="string"){let n=qr.getLoadHandlers(e,t);if(n.length===0)n.push(qr.browserHTTPRequest(e,t));else if(n.length>1)throw new re(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return SDe(e,void 0,t)}async function SDe(e,t,n){if(n==null&&(n={}),e.load==null)throw new re("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=await e.load(),a=r.modelTopology;a.model_config!=null&&(a=a.model_config);let s=n.strict==null?!0:n.strict,i=r.weightData!=null&&r.weightSpecs!=null&&s,o=Di(lv(a),t,i),l=r.trainingConfig;if(l!=null&&o.loadTrainingConfig(l),r.userDefinedMetadata!=null&&o.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new re("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:c,optimizerWeights:u}=_De(r.weightData,r.weightSpecs);o.loadWeights(c,s),o.optimizer!=null&&u.length>0&&await o.optimizer.setWeights(u),mt(c),mt(u.map(h=>h.tensor))}return o}function _De(e,t){let n=qr.decodeWeights(e,t),r={},a=[];return t.forEach(s=>{s.group==="optimizer"?a.push({name:s.name,tensor:n[s.name]}):r[s.name]=n[s.name]}),{modelWeights:r,optimizerWeights:a}}var MS=class hE extends hl{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:kS("sequential_"),t.layers!=null)for(let n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(n=>n<0))throw new re(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){let n=t instanceof hE||t instanceof hl,r;if(n){if(r=t,r.outputs.length!==1)throw new re("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new re("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new re("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let a=T7({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(a)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new re(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new re("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=E7(this.outputs[0])}this.inboundNodes=[],new $S({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Vd(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(a=>a.shape),outputShapes:this.outputs[0].shape})}else{let a=t.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(nn(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new hl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,r=console.log){this.built||this.build(),super.summary(t,n,r)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,r={}){if(!this.built)throw new yo("The model needs to be compiled before being used.");return this.model.evaluate(t,n,r)}async evaluateDataset(t,n){if(!this.built)throw new yo("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,r={}){if(!this.built)throw new yo("The model needs to be compiled before being used.");return this.model.fit(t,n,r)}async fitDataset(t,n){if(!this.built)throw new yo("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,r={},a=!1){let s,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new re("Legacy serialization format not supported yet.");s=n}else j.assert(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=n.layers,delete n.layers,i=n;let o=new t(i);if(!(o instanceof hE))throw new Pt(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(let l of s){let c=Di(l,void 0,a);a&&c.setFastWeightInitDuringBuild(!0),o.add(c)}return o}set stopTraining(t){if(this.model==null)throw new re("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new re("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let t=[];for(let n of this.layers){let r={};r.className=n.getClassName(),r.config=n.getConfig(),t.push(r)}return{name:this.name,layers:t}}};MS.className="Sequential";we.registerClass(MS);function CDe(e){return new hl(e)}function IDe(e){return new MS(e)}function Y7(e){return T7(e)}function EDe(e,t){cR.registerCallbackConstructor(e,t)}var oa=class extends we.Serializable{getConfig(){return{}}},J7=class extends oa{apply(e,t=1){return q$e(e,t)}};J7.className="elu";we.registerClass(J7);var Z7=class extends oa{apply(e){return iS(e)}};Z7.className="selu";we.registerClass(Z7);var eK=class extends oa{apply(e){return hn(e)}};eK.className="relu";we.registerClass(eK);var tK=class extends oa{apply(e){return te(()=>Qu(6,hn(e)))}};tK.className="relu6";we.registerClass(tK);var nK=class extends oa{apply(e){return e}};nK.className="linear";we.registerClass(nK);var rK=class extends oa{apply(e){return si(e)}};rK.className="sigmoid";we.registerClass(rK);var aK=class extends oa{apply(e){return Q$e(e)}};aK.className="hardSigmoid";we.registerClass(aK);var sK=class extends oa{apply(e){return Ip(e)}};sK.className="softplus";we.registerClass(sK);var iK=class extends oa{apply(e){return K$e(e)}};iK.className="softsign";we.registerClass(iK);var oK=class extends oa{apply(e){return Ku(e)}};oK.className="tanh";we.registerClass(oK);var gR=class extends oa{apply(e,t=-1){return Nc(e,t)}};gR.className="softmax";we.registerClass(gR);var lK=class extends oa{apply(e,t=-1){return Zk(e,t)}};lK.className="logSoftmax";we.registerClass(lK);var uK=class extends oa{apply(e){return te(()=>te(()=>{let t=Math.sqrt(2),n=Z(.5,me(1,Xk(ze(e,t))));return Z(e,n)}))}};uK.className="gelu";we.registerClass(uK);var cK=class extends oa{apply(e){return te(()=>Z(.5,Z(e,me(1,Ku(Z(Or(ze(2,Math.PI)),me(e,Z(.044715,Ro(e,3)))))))))}};cK.className="gelu_new";we.registerClass(cK);var dK=class extends oa{apply(e){return te(()=>Z(e,Ku(Ip(e))))}};dK.className="mish";we.registerClass(dK);var hK=class extends oa{apply(e,t=1){return te(()=>Z(si(Z(e,t)),e))}};hK.className="swish";we.registerClass(hK);function Ju(e){return e.getClassName()}function CC(e,t={}){return Mb(e,we.SerializationMap.getMap().classNameMap,t,"activation")}function Zu(e){if(e==null){let t={};return t.className="linear",t.config={},CC(t)}if(typeof e=="string"){let t={};return t.className=e,t.config={},CC(t)}else return e instanceof oa?e:CC(e)}function yR(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}var pK=class extends we.Serializable{},zb=class extends pK{constructor(e){super(),yR(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return te(()=>{let t=Vn([1]);return this.hasL1&&(t=me(t,Ge(Z(this.l1,ur(e))))),this.hasL2&&(t=me(t,Ge(Z(this.l2,Fb(e))))),ee(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};zb.className="L1L2";we.registerClass(zb);function TDe(e){return yR(e),new zb({l1:e!=null?e.l1:null,l2:0})}function jDe(e){return yR(e),new zb({l2:e!=null?e.l2:null,l1:0})}var UL={l1l2:"L1L2"};function Sn(e){return K$(e)}function WL(e,t={}){return Mb(e,we.SerializationMap.getMap().classNameMap,t,"regularizer")}function Fn(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in UL?UL[e]:e,config:{}};return WL(t)}else return e instanceof pK?e:WL(e)}var xR=class extends Lt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=ut(e);let n=hn(e);return this.maxValue!=null&&(n=aa(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};xR.className="ReLU";we.registerClass(xR);var vR=class extends Lt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=ut(e);return Sb(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};vR.className="LeakyReLU";we.registerClass(vR);var bR=class extends Lt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=On(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Fn(e.alphaRegularizer),this.alphaConstraint=kr(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new re(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=nn(e);let t=e.slice(1);if(this.sharedAxes!=null)for(let r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new dr({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=ut(e),jb(e,this.alpha.read())}getConfig(){let e={alphaInitializer:Hn(this.alphaInitializer),alphaRegularizer:Sn(this.alphaRegularizer),alphaConstraint:Nr(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};bR.className="PReLU";we.registerClass(bR);var wR=class extends Lt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Pt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=ut(e);return Yg(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};wR.className="ELU";we.registerClass(wR);var NR=class extends Lt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){let n=ut(e);return Z(n,Se(Ta(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};NR.className="ThresholdedReLU";we.registerClass(NR);var kR=class extends Lt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new gR().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return te(()=>{let n=ut(e),r=t.mask;if(r!=null){let a=Z(Oe(Pa(n.shape),Se(r,n.dtype)),Ze(-1e9));n=me(n,a)}return this.axis instanceof Array?this.axis.length>1?sa(Oe(n,Cb(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};kR.className="Softmax";we.registerClass(kR);function $f(e,t,n){if(typeof e=="number")return Vd(e,t);if(e.length!==t)throw new re(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){let a=e[r];if(!W$e(a))throw new re(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${a}`)}return e}function Mi(e,t,n,r,a=1){if(e==null)return e;let s=t+(t-1)*(a-1),i;return n==="same"?i=e:i=e-s+1,Math.floor((i+r-1)/r)}function co(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+Yu([n-t,0]);else if(r==="same")e=e*t;else throw new re(`Unsupport padding mode: ${r}.`);return e}function SR(e,t){return te(()=>(sr(t),t==="channelsFirst"?Tt(e,[0,2,3,1]):e))}function fK(e,t){return te(()=>(sr(t),t==="channelsFirst"?Tt(e,[0,2,3,4,1]):e))}function ADe(e,t,n,r=1,a="valid",s,i=1){return te(()=>{if(s==null&&(s=Ui()),sr(s),e.shape.length!==3)throw new re(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new re(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new re(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(s==="channelsFirst"&&(e=Tt(e,[0,2,1])),a==="causal")throw new Pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=Gk(e,t,r,a==="same"?"same":"valid","NWC",i);return n!=null&&(o=Qi(o,n)),o})}function VL(e,t,n,r=[1,1],a="valid",s,i,o=null){return te(()=>{if(s==null&&(s=Ui()),sr(s),e.rank!==3&&e.rank!==4)throw new re(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new re(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=SR(e,s);if(a==="causal")throw new Pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=xm.conv2d({x:l,filter:t,strides:r,pad:a==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:o}),s==="channelsFirst"&&(l=Tt(l,[0,3,1,2])),l})}function $De(e,t,n,r=[1,1,1],a="valid",s,i){return te(()=>{if(s==null&&(s=Ui()),sr(s),e.rank!==4&&e.rank!==5)throw new re(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new re(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=fK(e,s);if(a==="causal")throw new Pt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=JA(o,t,r,a==="same"?"same":"valid","NDHWC",i),n!=null&&(o=Qi(o,n)),s==="channelsFirst"&&(o=Tt(o,[0,4,1,2,3])),o})}var mK=class gK extends Lt{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",gK.verifyArgs(n),this.rank=t,Dr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Pt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=$f(n.kernelSize,t,"kernelSize"),this.strides=$f(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,qs(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,sr(this.dataFormat),this.activation=Zu(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=On(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=kr(n.biasConstraint),this.biasRegularizer=Fn(n.biasRegularizer),this.activityRegularizer=Fn(n.activityRegularizer),this.dilationRate=$f(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new re(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new re(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new re(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(uo("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!Q$(t.kernelSize,"number",1,3))throw new re(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){let t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ju(this.activation),useBias:this.useBias,biasInitializer:Hn(this.biasInitializer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),biasConstraint:Nr(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}},OS=class yK extends mK{constructor(t,n){super(t,n),this.kernel=null,yK.verifyArgs(n),this.filters=n.filters,Dr(this.filters,"filters"),this.kernelInitializer=On(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=kr(n.kernelConstraint),this.kernelRegularizer=Fn(n.kernelRegularizer)}build(t){t=nn(t);let n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new re(`The channel dimension of the input should be defined. Found ${t[n]}`);let r=t[n],a=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return te(()=>{t=ut(t);let r,a=this.bias==null?null:this.bias.read(),s=v7(this.activation.getClassName());if(s!=null&&this.rank===2)r=VL(t,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=ADe(t,this.kernel.read(),a,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=VL(t,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=$De(t,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Pt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=nn(t);let n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){let i=Mi(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);n.push(i)}let a=[t[0]];return this.dataFormat==="channelsLast"?(a=a.concat(n),a.push(this.filters)):(a.push(this.filters),a=a.concat(n)),a}getConfig(){let t={filters:this.filters,kernelInitializer:Hn(this.kernelInitializer),kernelRegularizer:Sn(this.kernelRegularizer),kernelConstraint:Nr(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new re(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}},FS=class xK extends OS{constructor(t){super(2,t),xK.verifyArgs(t)}getConfig(){let t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Q$(t.kernelSize,"number",1,2))throw new re(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}};FS.className="Conv2D";we.registerClass(FS);var PS=class vK extends OS{constructor(t){super(3,t),vK.verifyArgs(t)}getConfig(){let t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new re(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}};PS.className="Conv3D";we.registerClass(PS);var _R=class extends FS{constructor(e){if(super(e),this.inputSpec=[new dr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new re(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=nn(e),e.length!==4)throw new re("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new re("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dr({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return te(()=>{let n=ut(e);if(n.shape.length!==4)throw new re(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);let r=n.shape,a=r[0],s,i;this.dataFormat==="channelsFirst"?(s=2,i=3):(s=1,i=2);let o=r[s],l=r[i],c=this.kernelSize[0],u=this.kernelSize[1],h=this.strides[0],p=this.strides[1],f=co(o,h,c,this.padding),g=co(l,p,u,this.padding),m=[a,f,g,this.filters];this.dataFormat!=="channelsLast"&&(n=Tt(n,[0,2,3,1]));let y=qk(n,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=Tt(y,[0,3,1,2])),this.bias!=null&&(y=Qi(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=nn(e);let t=e.slice(),n,r,a;this.dataFormat==="channelsFirst"?(n=1,r=2,a=3):(n=3,r=1,a=2);let s=this.kernelSize[0],i=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[r]=co(t[r],o,s,this.padding),t[a]=co(t[a],l,i,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};_R.className="Conv2DTranspose";we.registerClass(_R);var CR=class extends PS{constructor(e){if(super(e),this.inputSpec=[new dr({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new re(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=nn(e),e.length!==5)throw new re("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new re("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dr({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return te(()=>{let n=ut(e);if(n.shape.length!==5)throw new re(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);let r=n.shape,a=r[0],s,i,o;this.dataFormat==="channelsFirst"?(o=2,s=3,i=4):(o=1,s=2,i=3);let l=r[o],c=r[s],u=r[i],h=this.kernelSize[0],p=this.kernelSize[1],f=this.kernelSize[2],g=this.strides[0],m=this.strides[1],y=this.strides[2],x=co(l,g,h,this.padding),v=co(c,m,p,this.padding),b=co(u,y,f,this.padding),w=[a,x,v,b,this.filters];this.dataFormat!=="channelsLast"&&(n=Tt(n,[0,2,3,4,1]));let k=ZA(n,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(k=Tt(k,[0,4,1,2,3])),this.bias!==null&&(k=Qi(k,this.bias.read(),this.dataFormat)),this.activation!==null&&(k=this.activation.apply(k)),k})}computeOutputShape(e){e=nn(e);let t=e.slice(),n,r,a,s;this.dataFormat==="channelsFirst"?(n=1,r=2,a=3,s=4):(n=4,r=1,a=2,s=3);let i=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],u=this.strides[1],h=this.strides[2];return t[n]=this.filters,t[r]=co(t[r],c,i,this.padding),t[a]=co(t[a],u,o,this.padding),t[s]=co(t[s],h,l,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};CR.className="Conv3DTranspose";we.registerClass(CR);var bK=class extends OS{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new re("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new re("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new re(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=On(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Fn(t.depthwiseRegularizer),this.depthwiseConstraint=kr(t.depthwiseConstraint),this.pointwiseInitializer=On(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Fn(t.pointwiseRegularizer),this.pointwiseConstraint=kr(t.pointwiseConstraint)}build(e){if(e=nn(e),e.length<this.rank+2)throw new re(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new re(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);let n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);let s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new dr({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return te(()=>{e=ut(e);let n;if(this.rank===1)throw new Pt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Tt(e,[0,2,3,1])),n=ty(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(n=Qi(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),this.dataFormat==="channelsFirst"&&(n=Tt(n,[0,3,1,2])),n})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Hn(this.depthwiseInitializer),e.pointwiseInitializer=Hn(this.pointwiseInitializer),e.depthwiseRegularizer=Sn(this.depthwiseRegularizer),e.pointwiseRegularizer=Sn(this.pointwiseRegularizer),e.depthwiseConstraint=Nr(this.depthwiseConstraint),e.pointwiseConstraint=Nr(this.pointwiseConstraint),e}};bK.className="SeparableConv";var IR=class extends bK{constructor(e){super(2,e)}};IR.className="SeparableConv2D";we.registerClass(IR);var ER=class wK extends OS{constructor(t){super(1,t),wK.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){let t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Q$(t.kernelSize,"number",1,1))throw new re(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}};ER.className="Conv1D";we.registerClass(ER);var TR=class extends Lt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return te(()=>{if(e=ut(e),this.dataFormat==="channelsLast"){let n=Uw(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Uw(n,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let n=Uw(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Uw(n,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};TR.className="Cropping2D";we.registerClass(TR);var jR=class extends Lt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,sr(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,z$e(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{let t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return te(()=>{let n=ut(e),r=n.shape;if(this.dataFormat==="channelsFirst"){n=Tt(n,[0,2,3,1]);let a=this.size[0]*r[2],s=this.size[1]*r[3],i=this.interpolation==="nearest"?$s.resizeNearestNeighbor(n,[a,s]):$s.resizeBilinear(n,[a,s]);return Tt(i,[0,3,1,2])}else{let a=this.size[0]*r[1],s=this.size[1]*r[2];return this.interpolation==="nearest"?$s.resizeNearestNeighbor(n,[a,s]):$s.resizeBilinear(n,[a,s])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};jR.className="UpSampling2D";we.registerClass(jR);function RDe(e,t,n=[1,1],r="valid",a,s){return te(()=>{a==null&&(a=Ui()),sr(a);let i=SR(e,a);if(e.rank!==4)throw new re(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new re(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return i=Cp(i,t,n,r==="same"?"same":"valid","NHWC",s),a==="channelsFirst"&&(i=Tt(i,[0,3,1,2])),i})}var AR=class extends mK{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=On(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=kr(e.depthwiseConstraint),this.depthwiseRegularizer=Fn(e.depthwiseRegularizer)}build(e){if(e=nn(e),e.length<4)throw new re(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new re(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);let n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return te(()=>{e=ut(e);let n=RDe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=Qi(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),n})}computeOutputShape(e){e=nn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Mi(t,this.kernelSize[0],this.padding,this.strides[0]),s=Mi(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,s]:[e[0],a,s,r]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Hn(this.depthwiseInitializer),e.depthwiseRegularizer=Sn(this.depthwiseRegularizer),e.depthwiseConstraint=Nr(this.depthwiseRegularizer),e}};AR.className="DepthwiseConv2D";we.registerClass(AR);function NK(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new re("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(s){return s==null||Array.isArray(s)?s:[s]}return t=a(t),n=a(n),{inputs:e,initialState:t,constants:n}}function kK(e,t,n,r=!1,a,s,i=!1,o=!1){return te(()=>{let l=t.shape.length;if(l<3)throw new re(`Input should be at least 3D, but is ${l}D.`);let c=[1,0].concat(Bi(2,l));t=Tt(t,c),s!=null,i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=Se(Se(a,"bool"),"float32"),a.rank===l-1&&(a=$r(a,-1)),a=Tt(a,c)),r&&(t=Ws(t,0),a!=null&&(a=Ws(a,0)));let u=[],h,p=n,f=t.shape[0],g=Zn(t),m;a!=null&&(m=Zn(a));for(let x=0;x<f;++x){let v=g[x],b=te(()=>e(v,p));if(a==null)h=b[0],p=b[1];else{let w=te(()=>{let k=m[x],I=Oe(Ns(k),k),C=me(Z(b[0],k),Z(p[0],I)),S=p.map((E,T)=>me(Z(b[1][T],k),Z(E,I)));return{output:C,newStates:S}});h=w.output,p=w.newStates}o&&u.push(h)}let y;return o&&(y=pr(u,1)),[h,y,p]})}var $l=class SK extends Lt{constructor(t){super(t);let n;if(t.cell==null)throw new re("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new BS({cells:t.cell}):n=t.cell,n.stateSize==null)throw new re("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new dr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Bi(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){iE(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);let r=n[0],a;if(this.returnSequences?a=[t[0],t[1],r]:a=[t[0],r],this.returnState){let s=[];for(let i of n)s.push([t[0],i]);return[a].concat(s)}else return a}computeMask(t,n){return te(()=>{Array.isArray(n)&&(n=n[0]);let r=this.returnSequences?n:null;if(this.returnState){let a=this.states.map(s=>null);return[r].concat(a)}else return r})}get states(){if(this.states_==null){let t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<t;++r)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new Pt("Constants support is not implemented in RNN yet.");iE(t)&&(t=t[0]),t=t;let n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new dr({shape:[n,null,...r]});let a=[t[0]].concat(t.slice(2));this.cell.build(a);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!j.arraysEqual(this.stateSpec.map(i=>i.shape[i.shape.length-1]),s))throw new re(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(i=>new dr({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){te(()=>{if(!this.stateful)throw new Yl("Cannot call resetStates() on an RNN Layer that is not stateful.");let r=this.inputSpec[0].shape[0];if(r==null)throw new re("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Vn([r,a])):this.states_=[Vn([r,this.cell.stateSize])];else if(t==null)mt(this.states_),this.keptStates!=null&&(mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Vn([r,a])):this.states_[0]=Vn([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new re(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):mt(this.states_);for(let a=0;a<this.states_.length;++a){let s=t[a],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[a]:this.cell.stateSize,o=[r,i];if(!j.arraysEqual(s.shape,o))throw new re(`State ${a} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${s.shape}`);this.states_[a]=s}}this.states_=this.states_.map(a=>vr(a.clone()))})}apply(t,n){let r=n==null?null:n.initialState,a=n==null?null:n.constants;n==null&&(n={});let s=NK(t,r,a,this.numConstants);t=s.inputs,r=s.initialState,a=s.constants;let i=[],o=[];if(r!=null){n.initialState=r,i=i.concat(r),this.stateSpec=[];for(let l of r)this.stateSpec.push(new dr({shape:l.shape}));o=o.concat(this.stateSpec)}if(a!=null&&(n.constants=a,i=i.concat(a),this.numConstants=a.length),i[0]instanceof Wi){let l=[t].concat(i),c=this.inputSpec.concat(o),u=this.inputSpec;this.inputSpec=c;let h=super.apply(l,n);return this.inputSpec=u,h}else return super.apply(t,n)}call(t,n){return te(()=>{let r=n==null?null:n.mask,a=n==null?null:n.training,s=n==null?null:n.initialState;t=ut(t),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(t));let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==i)throw new re(`RNN Layer has ${i} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let o={training:a},l=kK((f,g)=>{let m=this.cell.call([f].concat(g),o);return[m[0],m.slice(1)]},t,s,this.goBackwards,r,null,this.unroll,this.returnSequences),c=l[0],u=l[1],h=l[2];this.stateful&&this.resetStates(h,a);let p=this.returnSequences?u:c;return this.returnState?[p].concat(h):p})}getInitialState(t){return te(()=>{let n=Vn(t.shape);return n=Ge(n,[1,2]),n=Ob(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?aE(n,[1,r]):n):this.cell.stateSize>1?[aE(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){let t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);let r=this.cell.getConfig();return this.getClassName()===SK.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(t,n,r={}){let a=n.cell,s=Di(a,r);return new t(Object.assign(n,{cell:s}))}};$l.className="RNN";we.registerClass($l);var Bb=class extends Lt{},LS=class extends Bb{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Dr(this.units,"units"),this.activation=Zu(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=On(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=On(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=On(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Fn(e.kernelRegularizer),this.recurrentRegularizer=Fn(e.recurrentRegularizer),this.biasRegularizer=Fn(e.biasRegularizer),this.kernelConstraint=kr(e.kernelConstraint),this.recurrentConstraint=kr(e.recurrentConstraint),this.biasConstraint=kr(e.biasConstraint),this.dropout=vm([1,Yu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=vm([1,Yu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=nn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return te(()=>{if(e=e,e.length!==2)throw new re(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];let r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>Ns(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>Ns(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a,s=this.dropoutMask,i=this.recurrentDropoutMask;s!=null?a=_o(Z(e,s),this.kernel.read()):a=_o(e,this.kernel.read()),this.bias!=null&&(a=Qi(a,this.bias.read())),i!=null&&(n=Z(n,i));let o=me(a,_o(n,this.recurrentKernel.read()));return this.activation!=null&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Ju(this.activation),useBias:this.useBias,kernelInitializer:Hn(this.kernelInitializer),recurrentInitializer:Hn(this.recurrentInitializer),biasInitializer:Hn(this.biasInitializer),kernelRegularizer:Sn(this.kernelRegularizer),recurrentRegularizer:Sn(this.recurrentRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:Nr(this.kernelConstraint),recurrentConstraint:Nr(this.recurrentConstraint),biasConstraint:Nr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};LS.className="SimpleRNNCell";we.registerClass(LS);var $R=class extends $l{constructor(e){e.cell=new LS(e),super(e)}call(e,t){return te(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return new e(t)}};$R.className="SimpleRNN";we.registerClass($R);var zS=class extends Bb{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new re("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Dr(this.units,"units"),this.activation=Zu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Zu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=On(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=On(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=On(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Fn(e.kernelRegularizer),this.recurrentRegularizer=Fn(e.recurrentRegularizer),this.biasRegularizer=Fn(e.biasRegularizer),this.kernelConstraint=kr(e.kernelConstraint),this.recurrentConstraint=kr(e.recurrentConstraint),this.biasConstraint=kr(e.biasConstraint),this.dropout=vm([1,Yu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=vm([1,Yu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=nn(e);let t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return te(()=>{if(e=e,e.length!==2)throw new re(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training==null?!1:t.training,r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>Ns(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>Ns(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,s=this.recurrentDropoutMask,i,o,l;0<this.dropout&&this.dropout<1&&(e=Z(e,a[0]));let c=_o(e,this.kernel.read());this.useBias&&(c=Qi(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Z(r,s[0]));let u=this.recurrentKernel.read(),[h,p]=za(u,[2*this.units,this.units],u.rank-1),f=_o(r,h),[g,m,y]=za(c,3,c.rank-1),[x,v]=za(f,2,f.rank-1);i=this.recurrentActivation.apply(me(g,x)),o=this.recurrentActivation.apply(me(m,v));let b=_o(Z(o,r),p);l=this.activation.apply(me(y,b));let w=me(Z(i,r),Z(me(1,In(i)),l));return[w,w]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Ju(this.activation),recurrentActivation:Ju(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Hn(this.kernelInitializer),recurrentInitializer:Hn(this.recurrentInitializer),biasInitializer:Hn(this.biasInitializer),kernelRegularizer:Sn(this.kernelRegularizer),recurrentRegularizer:Sn(this.recurrentRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:Nr(this.kernelConstraint),recurrentConstraint:Nr(this.recurrentConstraint),biasConstraint:Nr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};zS.className="GRUCell";we.registerClass(zS);var RR=class extends $l{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new zS(e),super(e)}call(e,t){return te(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};RR.className="GRU";we.registerClass(RR);var Ub=class extends Bb{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Dr(this.units,"units"),this.activation=Zu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Zu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=On(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=On(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=On(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Fn(e.kernelRegularizer),this.recurrentRegularizer=Fn(e.recurrentRegularizer),this.biasRegularizer=Fn(e.biasRegularizer),this.kernelConstraint=kr(e.kernelConstraint),this.recurrentConstraint=kr(e.recurrentConstraint),this.biasConstraint=kr(e.biasConstraint),this.dropout=vm([1,Yu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=vm([1,Yu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=nn(e);let n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){let a=this.biasInitializer,s=this.units;r=new(t=class extends pi{apply(i,o){let l=a.apply([s]),c=new _S().apply([s]),u=a.apply([s*2]);return EL(EL(l,c),u)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return te(()=>{let n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new re(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1],a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>Ns(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>Ns(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let s=this.dropoutMask,i=this.recurrentDropoutMask,o,l,c,u;0<this.dropout&&this.dropout<1&&(e=Z(e,s[0]));let h=_o(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Z(r,i[0])),h=me(h,_o(r,this.recurrentKernel.read())),this.useBias&&(h=Qi(h,this.bias.read()));let[p,f,g,m]=za(h,4,h.rank-1);o=this.recurrentActivation.apply(p),l=this.recurrentActivation.apply(f),c=me(Z(l,a),Z(o,this.activation.apply(g))),u=this.recurrentActivation.apply(m);let y=Z(u,this.activation.apply(c));return[y,y,c]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Ju(this.activation),recurrentActivation:Ju(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Hn(this.kernelInitializer),recurrentInitializer:Hn(this.recurrentInitializer),biasInitializer:Hn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Sn(this.kernelRegularizer),recurrentRegularizer:Sn(this.recurrentRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:Nr(this.kernelConstraint),recurrentConstraint:Nr(this.recurrentConstraint),biasConstraint:Nr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};Ub.className="LSTMCell";we.registerClass(Ub);var DR=class extends $l{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ub(e),super(e)}call(e,t){return te(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};DR.className="LSTM";we.registerClass(DR);var BS=class extends Bb{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return te(()=>{e=e;let n=e.slice(1),r=[];for(let i of this.cells.slice().reverse())Array.isArray(i.stateSize)?r.push(n.splice(0,i.stateSize.length)):r.push(n.splice(0,1));r.reverse();let a=[],s;for(let i=0;i<this.cells.length;++i){let o=this.cells[i];n=r[i],i===0?s=[e[0]].concat(n):s=[s[0]].concat(n),s=o.call(s,t),a.push(s.slice(1))}n=[];for(let i of a.slice().reverse())n.push(...i);return[s[0]].concat(n)})}build(e){iE(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,r)=>{md(`RNNCell_${r}`,()=>{n.build(e),Array.isArray(n.stateSize)?t=n.stateSize[0]:t=n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t=r=>({className:r.getClassName(),config:r.getConfig()}),n={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),n)}static fromConfig(e,t,n={}){let r=[];for(let a of t.cells)r.push(Di(a,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let n of this.cells)t.push(...n.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return oE(e)}setWeights(e){let t=[];for(let n of this.cells){let r=n.weights.length,a=e.splice(r);for(let s=0;s<n.weights.length;++s)t.push([n.weights[s],a[s]])}aR(t)}};BS.className="StackedRNNCells";we.registerClass(BS);function ec(e){let{ones:t,rate:n,training:r=!1,count:a=1,dropoutFunc:s}=e,i=()=>s!=null?s(t(),n):C7(t(),n),o=()=>Pb(i,t,r);return!a||a<=1?vr(o().clone()):Array(a).fill(void 0).map(o).map(l=>vr(l.clone()))}var DDe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},_K=class extends $l{constructor(e){if(e.unroll)throw new Pt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Pt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new dr({ndim:5})]}call(e,t){return te(()=>{if(this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new re("ConvRNN2D cell does not support constants");let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return te(()=>{let{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)],s=Vn(a);return Array.isArray(t)?Array(t.length).fill(s):[s]})}resetStates(e,t=!1){te(()=>{if(!this.stateful)throw new Yl("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)];if(n[0]==null)throw new re("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Vn(a)):this.states_=[Vn(a)];else if(e==null)mt(this.states_),this.keptStates!=null&&(mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Vn(a)):this.states_[0]=Vn(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new re(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):mt(this.states_);for(let s=0;s<this.states_.length;++s){let i=e[s],o=a;if(!j.arraysEqual(i.shape,o))throw new re(`State ${s} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>vr(s.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:r,padding:a,strides:s,dilationRate:i}=this.cell,o=t==="channelsFirst",l=e[o?3:2],c=e[o?4:3],u=Mi(l,r[0],a,s[0],i[0]),h=Mi(c,r[1],a,s[1],i[1]);return[...e.slice(0,2),...o?[n,u,h]:[u,h,n]]}};_K.className="ConvRNN2D";var US=class extends Ub{constructor(e){let{filters:t,kernelSize:n,strides:r,padding:a,dataFormat:s,dilationRate:i}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Dr(this.filters,"filters"),this.kernelSize=$f(n,2,"kernelSize"),this.kernelSize.forEach(o=>Dr(o,"kernelSize")),this.strides=$f(r||1,2,"strides"),this.strides.forEach(o=>Dr(o,"strides")),this.padding=a||"valid",qs(this.padding),this.dataFormat=s||"channelsLast",sr(this.dataFormat),this.dilationRate=$f(i||1,2,"dilationRate"),this.dilationRate.forEach(o=>Dr(o,"dilationRate"))}build(e){var t;e=nn(e);let n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new re(`The channel dimension of the input should be defined. Found ${e[n]}`);let r=e[n],a=4,s=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let i=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let o;if(this.unitForgetBias){let l=this.biasInitializer,c=this.filters;o=new(t=class extends pi{apply(u,h){let p=l.apply([c]),f=Pa([c]),g=l.apply([c*2]);return X$([p,f,g])}},t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return te(()=>{if(e.length!==3)throw new re(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training||!1,r=e[0],a=e[1],s=e[2],i=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ec({ones:()=>Ns(r),rate:this.dropout,training:n,count:i,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,l=(R,V,G)=>!V||!V[G]?R:Z(V[G],R),c=l(r,o,0),u=l(r,o,1),h=l(r,o,2),p=l(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ec({ones:()=>Ns(a),rate:this.recurrentDropout,training:n,count:i,dropoutFunc:this.dropoutFunc}));let f=this.recurrentDropoutMask,g=l(a,f,0),m=l(a,f,1),y=l(a,f,2),x=l(a,f,3),v=3,[b,w,k,I]=za(this.kernel.read(),i,v),[C,S,E,T]=this.useBias?za(this.bias.read(),i):[null,null,null,null];c=this.inputConv(c,b,C,this.padding),u=this.inputConv(u,w,S,this.padding),h=this.inputConv(h,k,E,this.padding),p=this.inputConv(p,I,T,this.padding);let[$,_,M,L]=za(this.recurrentKernel.read(),i,v);g=this.recurrentConv(g,$),m=this.recurrentConv(m,_),y=this.recurrentConv(y,M),x=this.recurrentConv(x,L);let U=this.recurrentActivation.apply(me(c,g)),O=this.recurrentActivation.apply(me(u,m)),F=me(Z(O,s),Z(U,this.activation.apply(me(h,y)))),D=Z(this.recurrentActivation.apply(me(p,x)),this.activation.apply(F));return[D,D,F]})}getConfig(){let e=super.getConfig(),{units:t}=e,n=DDe(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){let a=Sa(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return n?Qi(a,n,this.dataFormat):a}recurrentConv(e,t){return Sa(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}};US.className="ConvLSTM2DCell";we.registerClass(US);var MR=class extends _K{constructor(e){let t=new US(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};MR.className="ConvLSTM2D";we.registerClass(MR);var WS=class extends Lt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return n}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e);if(0<this.rate&&this.rate<1){let r=t.training==null?!1:t.training,a=this.getNoiseShape(n);return Pb(()=>C7(n,this.rate,a,this.seed),()=>n,r)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};WS.className="Dropout";we.registerClass(WS);var OR=class extends WS{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};OR.className="SpatialDropout1D";we.registerClass(OR);var FR=class extends Lt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Dr(this.units,"units"),this.activation=Zu(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=On(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=On(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=kr(e.kernelConstraint),this.biasConstraint=kr(e.biasConstraint),this.kernelRegularizer=Fn(e.kernelRegularizer),this.biasRegularizer=Fn(e.biasRegularizer),this.activityRegularizer=Fn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=nn(e);let t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=nn(e);let t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e),r=v7(this.activation.getClassName()),a;return r!=null?a=_o(n,this.kernel.read(),r,this.bias?this.bias.read():null):(a=_o(n,this.kernel.read()),this.bias!=null&&(a=Qi(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){let e={units:this.units,activation:Ju(this.activation),useBias:this.useBias,kernelInitializer:Hn(this.kernelInitializer),biasInitializer:Hn(this.biasInitializer),kernelRegularizer:Sn(this.kernelRegularizer),biasRegularizer:Sn(this.biasRegularizer),activityRegularizer:Sn(this.activityRegularizer),kernelConstraint:Nr(this.kernelConstraint),biasConstraint:Nr(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};FR.className="Dense";we.registerClass(FR);var PR=class extends Lt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=nn(e);for(let t of e.slice(1))if(t==null)throw new re(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Ru(e,1)]}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e);if(this.dataFormat==="channelsFirst"&&n.rank>1){let r=[0];for(let a=2;a<n.rank;++a)r.push(a);r.push(1),n=Tt(n,r)}return G$e(n)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};PR.className="Flatten";we.registerClass(PR);var LR=class extends Lt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Zu(e.activation)}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e);return this.activation.apply(n)})}getConfig(){let e={activation:Ju(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};LR.className="Activation";we.registerClass(LR);var zR=class extends Lt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return te(()=>(e=ut(e),V$e(e,this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};zR.className="RepeatVector";we.registerClass(zR);var BR=class extends Lt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",r=t.slice(),a=1,s=null;for(let o=0;o<r.length;++o){let l=r[o];if(this.isUnknown(l))if(s===null)s=o;else throw new re("Can only specifiy one unknown dimension.");else a*=l}let i=Ru(e);if(s!==null){if(a===0||i%a!==0)throw new re(n);r[s]=i/a}else if(i!==a)throw new re(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return ee(n,a)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};BR.className="Reshape";we.registerClass(BR);var UR=class extends Lt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let t=Bi(1,e.dims.length+1);if(!j.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new dr({ndim:this.dims.length+1})]}computeOutputShape(e){e=nn(e);let t=e.slice();return this.dims.forEach((n,r)=>{t[r+1]=e[n]}),t}call(e,t){return Tt(ut(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};UR.className="Permute";we.registerClass(UR);var WR=class extends Lt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=ut(e);return rv(Ud(n,this.maskValue),-1)}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e),r=rv(Ud(n,this.maskValue),-1,!0);return Z(n,Se(r,n.dtype))})}};WR.className="Masking";we.registerClass(WR);var VR=class extends Lt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(dn(e.inputLength))}this.inputDim=e.inputDim,Dr(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Dr(this.outputDim,"outputDim"),this.embeddingsInitializer=On(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Fn(e.embeddingsRegularizer),this.activityRegularizer=Fn(e.activityRegularizer),this.embeddingsConstraint=kr(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return te(()=>this.maskZero?(e=ut(e),Ud(e,qt(e))):null)}computeOutputShape(e){if(e=nn(e),this.inputLength==null)return[...e,this.outputDim];let t=dn(this.inputLength);if(t.length!==e.length-1)throw new re(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){let a=t[r],s=e[r+1];if(a!=null&&s!=null&&a!==s)throw new re(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(t[n]=s),n++}}return[e[0],...t,this.outputDim]}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e);n.dtype!=="int32"&&(n=kl(n,"int32"));let r=_7(this.embeddings.read(),ee(n,[n.size]));return ee(r,nn(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Hn(this.embeddingsInitializer),embeddingsRegularizer:Sn(this.embeddingsRegularizer),activityRegularizer:Sn(this.activityRegularizer),embeddingsConstraint:Nr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};VR.className="Embedding";we.registerClass(VR);var Ap=class extends Lt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Pt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;let n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){let a=e[e.length-t.length+r],s=t[r];if(a==null||s==null||a<0||s<0)n.push(null);else if(a===1)n.push(s);else if(s===1)n.push(a);else{if(a!==s)throw new re("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[nn(e)]),e=e,e.length<2)throw new re(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(let a of e)a!=null&&a[0]!==null&&t.push(a[0]);if(t=$u(t),t.length>1)throw new re(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){let s=e[a]==null?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,s)}let r=e.map(a=>a.length);e.indexOf(null)===-1&&$u(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return te(()=>{if(e=e,this.reshapeRequired){let n=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){let a=Yu(r);for(let s of e){let i=s.rank;for(let o=0;o<a-i;++o)s=Ob(s,1);n.push(s)}return this.mergeFunction(n)}else{let a=!1;for(let o of e){let l=o.rank;if(l==null){let c=o.shape,u=c[0],h=c.slice(1).concat([u]),p=ee(o,[u].concat(Ru(c.slice(1))));p=Tt(p,[1,0]),p=ee(p,h),n.push(p),a=!0}else if(l>1){let c=Bi(1,l).concat([0]);n.push(Tt(o,c)),a=!0}else n.push(o)}let s=this.mergeFunction(n),i=s.rank;if(a){if(i==null){let o=s.shape,l=o.length,c=o[l-1],u=[c].concat(o.slice(0,o.length-1));s=ee(Tt(ee(s,[-1,c]),[1,0]),u)}else if(i>1){let o=[i-1].concat(Bi(0,i-1));s=Tt(s,o)}}return s}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){let a=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,a)}let n=[];for(let r of e)r!=null&&r[0]!==null&&n.push(r[0]);return n=$u(n),n.length===1?t=n.concat(t):t=[null].concat(t),t}computeMask(e,t){return te(()=>{if(t==null)return null;if(!Array.isArray(t))throw new re("`mask` should be an Array");if(!Array.isArray(e))throw new re("`inputs` should be an Array");if(t.length!==e.length)throw new re(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:$r(r,0));let n=t[0];for(let r=1;r<t.length-1;++r)n=ui(n,t[r]);return n})}},HR=class extends Ap{constructor(e){super(e)}mergeFunction(e){return te(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=me(t,e[n]);return t})}};HR.className="Add";we.registerClass(HR);var GR=class extends Ap{constructor(e){super(e)}mergeFunction(e){return te(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Z(t,e[n]);return t})}};GR.className="Multiply";we.registerClass(GR);var qR=class extends Ap{constructor(e){super(e)}mergeFunction(e){return te(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=me(t,e[n]);return Z(1/e.length,t)})}};qR.className="Average";we.registerClass(qR);var KR=class extends Ap{constructor(e){super(e)}mergeFunction(e){return te(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=zo(t,e[n]);return t})}};KR.className="Maximum";we.registerClass(KR);var QR=class extends Ap{constructor(e){super(e)}mergeFunction(e){return te(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Qu(t,e[n]);return t})}};QR.className="Minimum";we.registerClass(QR);var XR=class extends Ap{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new re("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(let r of e)if(r!=null){t=!1;break}if(t)return;let n=[];for(let r=0;r<e.length;++r){let a=e[r].slice();a.splice(this.axis,1);let s=!1;for(let i of n)if(j.arraysEqual(i,a)){s=!0;break}s||n.push(a)}if(n.length>1)throw new re("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return te(()=>X$(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new re("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(let a of t.slice(1)){if(n[r]==null||a[r]==null){n[r]=null;break}n[r]+=a[r]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new re("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new re("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new re(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return te(()=>{let n=!0;if(t.forEach(s=>{if(s!=null){n=!1;return}}),n)return null;let r=[];for(let s=0;s<e.length;++s)t[s]==null?r.push(Se(Ns(e[s]),"bool")):t[s].rank<e[s].rank?r.push($r(t[s],-1)):r.push(t[s]);let a=wn(r,this.axis);return Hk(a,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};XR.className="Concatenate";we.registerClass(XR);function Fy(e,t){for(;e<0;)e+=t;return e}function MDe(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Pt("batchDot is not implemented for tensors of 4D or higher rank yet");if(j.assert(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),j.assert(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Pt("batchDot is not implemented for complex64-type Tensors yet.");let r=e.shape.length,a=t.shape.length;n==null&&(n=[r-1,a-2]);let s=n;return te(()=>{let i;if(r>a){i=r-a;let l=[];for(let c=0;c<i;++c)l.push(1);t=ee(t,t.shape.concat(l))}else if(a>r){i=a-r;let l=[];for(let c=0;c<i;++c)l.push(1);e=ee(e,e.shape.concat(l))}else i=0;let o;if(e.shape.length===2&&t.shape.length===2)s[0]===s[1]?o=Ge(Z(e,t),s[0]):o=Ge(Z(Tt(e,[1,0]),t),s[1]);else{let l=s[0]!==e.shape.length-1,c=s[1]===t.shape.length-1;o=_t(e,t,l,c)}if(i>0){let l;r>a?l=r+a-3:l=r-1;let c=[];for(let u=l;u<l+i;++u)c.push(u);o=kc(o,c)}return o.shape.length===1&&(o=$r(o,1)),o})}var YR=class extends Ap{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){j.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Pt("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new re(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new re(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],n=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,s)=>Fy(a,e[s].shape.length)):r=[Fy(this.axes,t.shape.length),Fy(this.axes,n.shape.length)],this.normalize&&(t=W1(t,r[0]),n=W1(n,r[1])),MDe(t,n,r)}interpretAxes(e,t){let n;return Array.isArray(this.axes)?n=this.axes:n=[Fy(this.axes,e.length),Fy(this.axes,t.length)],n}computeOutputShape(e){j.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Pt("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);let a=t.concat(n);return a.length===1&&a.push(1),a}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};YR.className="Dot";we.registerClass(YR);var JR=class extends Lt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e);return Pb(()=>me(SS(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}};JR.className="GaussianNoise";we.registerClass(JR);var ZR=class extends Lt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return te(()=>{this.invokeCallHook(e,t);let n=ut(e);return this.rate>0&&this.rate<1?Pb(()=>{let r=Math.sqrt(this.rate/(1-this.rate));return Z(n,SS(n.shape,1,r))},()=>n,t.training||!1):n})}};ZR.className="GaussianDropout";we.registerClass(ZR);var eD=class extends Lt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ut(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return te(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return Pb(()=>{let r=ut(e),a=-1.6732632423543772*1.0507009873554805,s=Tl(wc(n),this.rate);s=kl(s,"float32");let i=((1-this.rate)*(1+this.rate*a**2))**-.5,o=-i*a*this.rate,l=me(Z(r,s),Z(me(s,-1),a));return me(Z(l,i),o)},()=>ut(e),t.training||!1)}return e})}};eD.className="AlphaDropout";we.registerClass(eD);function uv(e,t,n,r,a,s=.001){let i;if(e.rank===2)i=UA(e,t,n,r,a,s);else if(e.rank===3)i=WA(e,t,n,r,a,s);else if(e.rank===4)i=VA(e,t,n,r,a,s);else throw new Pt(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return i}function ODe(e,t,n,r,a=.001){return te(()=>{let s=Eb(e,r),i=s.mean,o=s.variance;return[uv(e,i,o,n,t,a),i,o]})}function FDe(e,t,n,r,a=.001){return te(()=>{let s=Eb(e,r),i=s.mean,o=s.variance,l=[];for(let f of Bi(0,e.rank))r.indexOf(f)!==-1?l.push(1):l.push(e.shape[f]);let c=ee(i,l),u=ee(o,l),h=t==null?null:ee(t,l),p=n==null?null:ee(n,l);return[uv(e,c,u,p,h,a),i,o]})}function PDe(e,t,n,r,a=.001){return j.arraysEqual(r.slice().sort(),Bi(0,e.rank-1))?ODe(e,t,n,r,a):FDe(e,t,n,r,a)}var tD=class extends Lt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=On(e.betaInitializer||"zeros"),this.gammaInitializer=On(e.gammaInitializer||"ones"),this.movingMeanInitializer=On(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=On(e.movingVarianceInitializer||"ones"),this.betaConstraint=kr(e.betaConstraint),this.gammaConstraint=kr(e.gammaConstraint),this.betaRegularizer=Fn(e.betaRegularizer),this.gammaRegularizer=Fn(e.gammaRegularizer)}build(e){e=nn(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new re(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new dr({ndim:e.length,axes:{[t]:n}})];let r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return te(()=>{let n=t.training==null?!1:t.training,r=ut(e),a=r.shape,s=a.length,i=Bi(0,s),o=this.axis>=0?this.axis:this.axis+s;i.splice(o,1);let l=Vd(1,s);l[o]=a[o];let c=i.slice();c.sort();let u=!j.arraysEqual(c,Bi(0,s).slice(0,s-1)),h=()=>{if(u){let y=ee(this.movingMean.read(),l),x=ee(this.movingVariance.read(),l),v=this.center?ee(this.beta.read(),l):null,b=this.scale?ee(this.gamma.read(),l):null;return uv(r,y,x,v,b,this.epsilon)}else return uv(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return h();let[p,f,g]=PDe(r,this.gamma.read(),this.beta.read(),i,this.epsilon),m=(y,x,v)=>{te(()=>{let b=1-v,w=y.read(),k=Z(Oe(w,x),b);y.write(Oe(w,k))})};return m(this.movingMean,f,this.momentum),m(this.movingVariance,g,this.momentum),p})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Hn(this.betaInitializer),gammaInitializer:Hn(this.gammaInitializer),movingMeanInitializer:Hn(this.movingMeanInitializer),movingVarianceInitializer:Hn(this.movingVarianceInitializer),betaRegularizer:Sn(this.betaRegularizer),gammaRegularizer:Sn(this.gammaRegularizer),betaConstraint:Nr(this.betaConstraint),gammaConstraint:Nr(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};tD.className="BatchNormalization";we.registerClass(tD);var nD=class extends Lt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=On(e.betaInitializer||"zeros"),this.gammaInitializer=On(e.gammaInitializer||"ones"),this.betaRegularizer=Fn(e.betaRegularizer),this.gammaRegularizer=Fn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=nn(e);let t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(let a of this.axis)if(a<0||a>=t)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==$u(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let n=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){let n=ut(e),r=n.shape,a=r.length;return te(()=>{let{mean:s,variance:i}=Eb(n,this.axis,!0),o=Vd(1,a);for(let f of this.axis)o[f]=r[f];let l=f=>f!=null&&f.shape.length!==a?ee(f,o):f,c=this.scale?l(this.gamma.read()):null,u=this.center?l(this.beta.read()):null,h=[],p=[];for(let f=0;f<a;++f)this.axis.indexOf(f)!==-1?(h.push(r[f]),p.push(1)):(h.push(1),p.push(r[f]));return s=ds(s,h),i=ds(i,h),c!=null&&(c=ds(c,p)),u!=null&&(u=ds(u,p)),uv(n,s,i,u,c,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Hn(this.betaInitializer),gammaInitializer:Hn(this.gammaInitializer),betaRegularizer:Sn(this.betaRegularizer),gammaRegularizer:Sn(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};nD.className="LayerNormalization";we.registerClass(nD);function LDe(e,t,n){return te(()=>{if(e.rank!==4)throw new re(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new re("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ui()),n!=="channelsLast"&&n!=="channelsFirst")throw new re(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],Ki(e,r)})}var rD=class extends Lt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ui():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new re(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new re(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new re(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new dr({ndim:4})]}computeOutputShape(e){e=nn(e);let t,n;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?n=e[3]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],e[1],t,n]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?n=e[2]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],t,n,e[3]])}call(e,t){return te(()=>LDe(ut(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};rD.className="ZeroPadding2D";we.registerClass(rD);function VS(e,t,n,r,a,s){return te(()=>{sr(a),w7(s),qs(r),n==null&&(n=[1,1]),r==null&&(r="valid"),a==null&&(a=Ui()),s==null&&(s="max"),e=SR(e,a);let i,o=r==="same"?"same":"valid";return s==="max"?i=Ir(e,t,n,o):i=El(e,t,n,o),a==="channelsFirst"&&(i=Tt(i,[0,3,1,2])),i})}function CK(e,t,n,r,a,s){return te(()=>{sr(a),w7(s),qs(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),a==null&&(a=Ui()),s==null&&(s="max"),e=fK(e,a);let i,o=r==="same"?"same":"valid";return s==="max"?i=f$(e,t,n,o):i=BA(e,t,n,o),a==="channelsFirst"&&(i=Tt(i,[0,4,1,2,3])),i})}var IK=class extends Lt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new re(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Dr(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new re(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Dr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,qs(this.padding),this.inputSpec=[new dr({ndim:3})]}computeOutputShape(e){e=nn(e);let t=Mi(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return te(()=>{this.invokeCallHook(e,t),e=Ob(ut(e),2);let n=this.poolingFunction(ut(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return kc(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},aD=class extends IK{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return sr(a),qs(r),VS(e,t,n,r,a,"max")}};aD.className="MaxPooling1D";we.registerClass(aD);var sD=class extends IK{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return sr(a),qs(r),VS(e,t,n,r,a,"avg")}};sD.className="AveragePooling1D";we.registerClass(sD);var EK=class extends Lt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new re(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Dr(this.poolSize,"poolSize"),Dr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,sr(this.dataFormat),qs(this.padding),this.inputSpec=[new dr({ndim:4})]}computeOutputShape(e){e=nn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Mi(t,this.poolSize[0],this.padding,this.strides[0]),n=Mi(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return te(()=>(this.invokeCallHook(e,t),this.poolingFunction(ut(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},iD=class extends EK{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return sr(a),qs(r),VS(e,t,n,r,a,"max")}};iD.className="MaxPooling2D";we.registerClass(iD);var oD=class extends EK{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return sr(a),qs(r),VS(e,t,n,r,a,"avg")}};oD.className="AveragePooling2D";we.registerClass(oD);var TK=class extends Lt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new re(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Dr(this.poolSize,"poolSize"),Dr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,sr(this.dataFormat),qs(this.padding),this.inputSpec=[new dr({ndim:5})]}computeOutputShape(e){e=nn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Mi(t,this.poolSize[0],this.padding,this.strides[0]),n=Mi(n,this.poolSize[1],this.padding,this.strides[1]),r=Mi(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return te(()=>(this.invokeCallHook(e,t),this.poolingFunction(ut(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},lD=class extends TK{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return sr(a),qs(r),CK(e,t,n,r,a,"max")}};lD.className="MaxPooling3D";we.registerClass(lD);var uD=class extends TK{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return sr(a),qs(r),CK(e,t,n,r,a,"avg")}};uD.className="AveragePooling3D";we.registerClass(uD);var jK=class extends Lt{constructor(e){super(e),this.inputSpec=[new dr({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Pt}},cD=class extends jK{constructor(e){super(e||{})}call(e,t){return te(()=>{let n=ut(e);return Wn(n,1)})}};cD.className="GlobalAveragePooling1D";we.registerClass(cD);var dD=class extends jK{constructor(e){super(e||{})}call(e,t){return te(()=>{let n=ut(e);return Ps(n,1)})}};dD.className="GlobalMaxPooling1D";we.registerClass(dD);var AK=class extends Lt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,sr(this.dataFormat),this.inputSpec=[new dr({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Pt}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},hD=class extends AK{call(e,t){return te(()=>{let n=ut(e);return this.dataFormat==="channelsLast"?Wn(n,[1,2]):Wn(n,[2,3])})}};hD.className="GlobalAveragePooling2D";we.registerClass(hD);var pD=class extends AK{call(e,t){return te(()=>{let n=ut(e);return this.dataFormat==="channelsLast"?Ps(n,[1,2]):Ps(n,[2,3])})}};pD.className="GlobalMaxPooling2D";we.registerClass(pD);var $K=class extends Lt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){let r=t.layer,a=Di(r,n);delete t.layer;let s={layer:a};return Object.assign(s,t),new e(s)}},fD=class extends $K{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=nn(e),e.length<3)throw new re(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=nn(e);let t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return te(()=>(e=ut(e),kK((n,r)=>[ut(this.layer.call(n,t)),[]],e,[],!1,null,null,!1,!0)[1]))}};fD.className="TimeDistributed";we.registerClass(fD);function zDe(e){Tp(L$e,"BidirectionalMergeMode",e)}var BDe="concat",mD=class extends $K{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=Di(n),t.goBackwards=t.goBackwards!==!0;let r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=Di(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?BDe:e.mergeMode,zDe(this.mergeMode),e.weights)throw new Pt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,r,a;return this.returnState&&(a=t.slice(1)),n=t[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,r=[n]):this.mergeMode==null?r=[n,n.slice()]:r=[n],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[n].concat(a).concat(a.slice()):Oa(r)}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});let a=NK(e,n,r,this.numConstants);if(e=a.inputs,n=a.initialState,r=a.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&r==null)return super.apply(e,t);let s=[],i=[];if(n!=null){let l=n.length;if(l%2>0)throw new re("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,s.push(...n);let c=n.map(u=>new dr({shape:u.shape}));this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),i.push(...c)}if(r!=null)throw new Pt("Support for constants in Bidirectional layers is not implemented yet.");let o=s[0]instanceof Wi;for(let l of s)if(l instanceof Wi!==o)throw new re("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let l=[e].concat(s),c=this.inputSpec.concat(i),u=this.inputSpec;this.inputSpec=c;let h=super.apply(l,t);return this.inputSpec=u,h}else return super.apply(e,t)}call(e,t){return te(()=>{let n=t.initialState,r,a;if(n==null)r=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{let o=n.slice(0,n.length/2),l=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:o})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:l}))}let s;this.returnState&&(Array.isArray(r)&&(s=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Ws(a,1));let i;return this.mergeMode==="concat"?i=X$([r,a]):this.mergeMode==="sum"?i=me(r,a):this.mergeMode==="ave"?i=Z(.5,me(r,a)):this.mergeMode==="mul"?i=Z(r,a):this.mergeMode==null&&(i=[r,a]),this.returnState?this.mergeMode==null?i.concat(s):[i].concat(s):i})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){md(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),md(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(this.returnSequences?this.mergeMode==null?n=[t,t]:n=t:this.mergeMode==null?n=[null,null]:n=null,this.returnState){let r=this.forwardLayer.states.map(a=>null);return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=Di(t.layer);if(delete t.layer,t.numConstants!=null)throw new Pt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let r=t;return r.layer=n,new e(r)}};mD.className="Bidirectional";we.registerClass(mD);var gD=class extends Lt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return te(()=>(e=ut(e),e.dtype!=="float32"&&(e=kl(e,"float32")),me(Z(e,this.scale),this.offset)))}};gD.className="Rescaling";we.registerClass(gD);var{resizeBilinear:UDe,cropAndResize:WDe}=$s,yD=class extends Lt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,a,s,i,o){return te(()=>{let l,c=!1,u=t/s,h=n/i,p=(r+t)/s,f=(a+n)/i,g=[u,h,p,f],m=[];e.rank===3?(c=!0,l=pr([e])):l=e;for(let b=0;b<l.shape[0];b++)m.push(g);let y=va(m,[m.length,4]),x=Wd(0,m.length,1,"int32"),v=WDe(l,y,x,[r,a],"nearest");return kl(c?ut(Zn(v)):v,o)})}upsize(e,t,n,r){return te(()=>{let a=UDe(e,[t,n]);return kl(a,r)})}call(e,t){return te(()=>{let n=ut(e),r=n.dtype,a=n.shape,s=a[a.length-3],i=a[a.length-2],o=0;s!==this.height&&(o=Math.floor((s-this.height)/2));let l=0;return i!==this.width&&(l=Math.floor((i-this.width)/2),l===0&&(l=1)),o>=0&&l>=0?this.centerCrop(n,o,l,this.height,this.width,s,i,r):this.upsize(e,this.height,this.width,r)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=nn(e);let t=e.length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};yD.className="CenterCrop";we.registerClass(yD);function VDe(e,t,n,r){let a=ut(e);if(a.dtype!=="int32"&&(a=kl(a,"int32")),t==="int")return a;let s=a.shape;if(a.rank===0&&(a=$r(a,-1)),t==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=$r(a,-1)),a.rank>2)throw new re(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${a.rank}.`);let i=["multiHot","oneHot"].includes(t),o=a,l;if(typeof r<"u"&&t==="count"?l=F1(o,r,n,i):l=F1(o,[],n,i),t!=="tfIdf")return l;if(r)return Z(l,r);throw new re("When outputMode is 'tfIdf', weights must be provided.")}var xD=class extends Lt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=nn(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return te(()=>{e=ut(e),e.dtype!=="int32"&&(e=kl(e,"int32"));let n;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new re(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);n=ut(t.countWeights)}let r=Ps(e),a=hm(e),s=Ta(this.numTokens,r).bufferSync().get(0),i=Tl(a,0).bufferSync().get(0);if(!(s&&i))throw new re(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return VDe(e,this.outputMode,this.numTokens,n)})}};xD.className="CategoryEncoding";we.registerClass(xD);var HDe=["bilinear","nearest"],HL=new Set(HDe),vD=class extends Lt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(HL.has(e.interpolation))this.interpolation=e.interpolation;else throw new re(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=nn(e);let t=e[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return te(()=>{let n=[this.height,this.width];if(this.interpolation==="bilinear")return $s.resizeBilinear(e,n,!this.cropToAspectRatio);if(this.interpolation==="nearest")return $s.resizeNearestNeighbor(e,n,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...HL]} are supported`)})}};vD.className="Resizing";we.registerClass(vD);var RK=class{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}};RK.className="RandomSeed";var DK=class extends Lt{constructor(e){super(e),this.randomGenerator=new RK(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};DK.className="BaseRandomLayer";var GDe=["bilinear","nearest"],GL=new Set(GDe),bD=class extends DK{constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new re(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new re(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new re(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(n)if(GL.has(n))this.interpolation=n;else throw new re(`Invalid interpolation parameter: ${n} is not implemented`)}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=nn(e);let t=e[2];return[this.imgHeight,-1,t]}call(e,t){return te(()=>{let n=ut(e);this.imgHeight=n.shape[n.shape.length-3];let r=n.shape[n.shape.length-2];this.widthFactor=wc([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);let s=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return $s.resizeBilinear(e,s);case"nearest":return $s.resizeNearestNeighbor(e,s);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...GL]} are supported`)}})}};bD.className="RandomWidth";we.registerClass(bD);function qDe(e){return new ay(e)}function KDe(e){return new wR(e)}function QDe(e){return new xR(e)}function XDe(e){return new vR(e)}function YDe(e){return new bR(e)}function JDe(e){return new kR(e)}function ZDe(e){return new NR(e)}function eMe(e){return new ER(e)}function tMe(e){return new FS(e)}function nMe(e){return new _R(e)}function rMe(e){return new PS(e)}function aMe(e){return new CR(e)}function sMe(e){return new IR(e)}function iMe(e){return new TR(e)}function oMe(e){return new jR(e)}function lMe(e){return new AR(e)}function uMe(e){return new LR(e)}function cMe(e){return new FR(e)}function dMe(e){return new WS(e)}function hMe(e){return new OR(e)}function pMe(e){return new PR(e)}function fMe(e){return new zR(e)}function mMe(e){return new BR(e)}function gMe(e){return new UR(e)}function yMe(e){return new VR(e)}function xMe(e){return new HR(e)}function vMe(e){return new qR(e)}function bMe(e){return new XR(e)}function wMe(e){return new KR(e)}function NMe(e){return new QR(e)}function kMe(e){return new GR(e)}function SMe(e){return new YR(e)}function _Me(e){return new tD(e)}function CMe(e){return new nD(e)}function IMe(e){return new rD(e)}function wD(e){return new sD(e)}function EMe(e){return wD(e)}function TMe(e){return wD(e)}function ND(e){return new oD(e)}function jMe(e){return ND(e)}function AMe(e){return ND(e)}function kD(e){return new uD(e)}function $Me(e){return kD(e)}function RMe(e){return kD(e)}function DMe(e){return new cD(e)}function MMe(e){return new hD(e)}function MK(e){return new dD(e)}function OK(e){return new pD(e)}function FK(e){return new aD(e)}function PK(e){return new iD(e)}function OMe(e){return new lD(e)}function FMe(e){return new RR(e)}function PMe(e){return new zS(e)}function LMe(e){return new DR(e)}function zMe(e){return new Ub(e)}function BMe(e){return new $R(e)}function UMe(e){return new LS(e)}function WMe(e){return new MR(e)}function VMe(e){return new US(e)}function HMe(e){return new $l(e)}function GMe(e){return new BS(e)}function qMe(e){return new mD(e)}function KMe(e){return new fD(e)}var QMe=MK,XMe=OK,YMe=FK,JMe=PK;function ZMe(e){return new JR(e)}function eOe(e){return new ZR(e)}function tOe(e){return new eD(e)}function nOe(e){return new WR(e)}function rOe(e){return new gD(e)}function aOe(e){return new yD(e)}function sOe(e){return new vD(e)}function iOe(e){return new xD(e)}function oOe(e){return new bD(e)}var LK={};gt(LK,{MAPE:()=>xOe,MSE:()=>wOe,binaryAccuracy:()=>lOe,binaryCrossentropy:()=>uOe,categoricalAccuracy:()=>dOe,categoricalCrossentropy:()=>hOe,cosineProximity:()=>mOe,mape:()=>vOe,meanAbsoluteError:()=>gOe,meanAbsolutePercentageError:()=>yOe,meanSquaredError:()=>bOe,mse:()=>NOe,precision:()=>pOe,r2Score:()=>kOe,recall:()=>fOe,sparseCategoricalAccuracy:()=>cOe});function lOe(e,t){return hR(e,t)}function uOe(e,t){return U7(e,t)}function cOe(e,t){return W7(e,t)}function dOe(e,t){return pR(e,t)}function hOe(e,t){return fR(e,t)}function pOe(e,t){return B7(e,t)}function fOe(e,t){return HRe(e,t)}function mOe(e,t){return dR(e,t)}function gOe(e,t){return RS(e,t)}function yOe(e,t){return sy(e,t)}function xOe(e,t){return sy(e,t)}function vOe(e,t){return sy(e,t)}function bOe(e,t){return jp(e,t)}function wOe(e,t){return jp(e,t)}function NOe(e,t){return jp(e,t)}function kOe(e,t){return GRe(e,t)}var zK={};gt(zK,{modelFromJSON:()=>NDe});var BK={};gt(BK,{l1:()=>_Oe,l1l2:()=>SOe,l2:()=>COe});function SOe(e){return new zb(e)}function _Oe(e){return TDe(e)}function COe(e){return jDe(e)}var UK=class extends bm{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof hl))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function Vw(e,t){return e<t}function qL(e,t){return e>t}var WK=class extends UK{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new Pt("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=Vw:this.mode==="max"?this.monitorFunc=qL:this.monitor.indexOf("acc")!==-1?this.monitorFunc=qL:this.monitorFunc=Vw,this.monitorFunc===Vw&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===Vw?1/0:-1/0}async onEpochEnd(e,t){await Gl(t);let n=this.getMonitorValue(t);n!=null&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});let t=e[this.monitor];return t==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),t}};function IOe(e){return new WK(e)}var EOe={earlyStopping:IOe},TOe=le();TOe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var Ja;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ja||(Ja={}));var KL;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(KL||(KL={}));var SD={};function jOe(e,t){let n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};SD[e]=n}function VK(e){return SD[e]}function AOe(e){delete SD[e]}function A(e,t,n,r,a){let s=t.inputParams[e];if(s&&s.inputIndexStart!==void 0){let o=s.inputIndexStart,l=s.inputIndexEnd===0?void 0:s.inputIndexEnd===void 0?o+1:s.inputIndexEnd,c=o<0?t.inputNames.length+o:o;if(s.type==="tensor")return Vr(t.inputNames[c],n,r,a);if(s.type==="tensors"){let p=t.inputs.slice(o,l);return t.inputNames.slice(o,l).filter((f,g)=>{var m;return((m=p[g])===null||m===void 0?void 0:m.op)!=="NoOp"}).map(f=>Vr(f,n,r,a))}let u=Vr(t.inputNames[c],n,r,a),h=u.dataSync();return s.type==="number"?h[0]:j.toNestedArray(u.shape,h)}let i=t.attrParams[e];return i&&i.value}function Vr(e,t,n,r){let[a,s]=rs(e,n);if(r!=null){let o=r.getHashTableHandleByName(a);if(o!=null)return o}let i=n.currentContextIds.find(o=>!!t[K1(a,o)]);return i!==void 0?t[K1(a,i)][s]:void 0}function QL(e,t,n){return t[K1(e,n.currentContextId)]}function tl(e,t){let[n,r,a]=rs(e,t);return[K1(n,t&&t.currentContextId),r,a]}function K1(e,t){return t?`${e}-${t}`:e}function rs(e,t){if(e==="")return["",0,void 0];let n=t!=null&&t.parseNodeNameCache!=null;if(n){let s=t.parseNodeNameCache.get(e);if(s!=null)return s}let r=e.split(":"),a;if(r.length===1)a=[e,0,void 0];else{let s=r[0],i=r.length===3?r[1]:void 0,o=Number(r[r.length-1]);a=[s,o,i]}return n&&t.parseNodeNameCache.set(e,a),a}function E0(e,t,n){let r=A("pad",e,t,n);if(r==="explicit"){r=A("explicitPaddings",e,t,n);let a=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)a[s][0]=r[s*2],a[s][1]=r[s*2+1];return a}return r}function nl(e){return e.kept?e:ko(e)}var HK={};gt(HK,{json:()=>$Oe});var $Oe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],GK={};gt(GK,{json:()=>ROe});var ROe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],qK={};gt(qK,{json:()=>DOe});var DOe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],KK={};gt(KK,{json:()=>MOe});var MOe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],QK={};gt(QK,{json:()=>OOe});var OOe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],XK={};gt(XK,{json:()=>FOe});var FOe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],YK={};gt(YK,{json:()=>POe});var POe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],JK={};gt(JK,{json:()=>LOe});var LOe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],ZK={};gt(ZK,{json:()=>zOe});var zOe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],e9={};gt(e9,{json:()=>BOe});var BOe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],t9={};gt(t9,{json:()=>UOe});var UOe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],n9={};gt(n9,{json:()=>WOe});var WOe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],r9={};gt(r9,{json:()=>VOe});var VOe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],a9={};gt(a9,{json:()=>HOe});var HOe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],s9={};gt(s9,{json:()=>GOe});var GOe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],i9={};gt(i9,{json:()=>qOe});var qOe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],o9={};gt(o9,{json:()=>KOe});var KOe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],l9={};gt(l9,{json:()=>QOe});var QOe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],u9={};gt(u9,{json:()=>XOe});var XOe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],XL=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[HK,GK,qK,KK,QK,XK,YK,JK,ZK,e9,t9,n9,r9,a9,s9,i9,o9,l9,u9],t=[].concat(...e.map(n=>n.json));this.opMappers=t.reduce((n,r)=>(n[r.tfOpName]=r,n),{})}transformGraph(e,t={}){let n=e.node,r=[],a=[],s=[],i=n.reduce((g,m)=>(g[m.name]=this.mapNode(m),m.op.startsWith("Placeholder")?r.push(g[m.name]):m.op==="Const"?a.push(g[m.name]):(m.input==null||m.input.length===0)&&s.push(g[m.name]),g),{}),o=[],l=[],c={},u={};t!=null&&(c=this.mapSignatureEntries(t.inputs),u=this.mapSignatureEntries(t.outputs));let h=Object.keys(i);h.forEach(g=>{let m=i[g];m.inputNames.forEach((y,x)=>{let[v,,b]=tl(y),w=i[v];if(w.outputs!=null){let k=w.outputs.indexOf(b);if(k!==-1){let I=`${v}:${k}`;m.inputNames[x]=I}}m.inputs.push(w),w.children.push(m)})}),Object.keys(u).length===0?h.forEach(g=>{let m=i[g];m.children.length===0&&l.push(m)}):Object.keys(u).forEach(g=>{let[m]=tl(g),y=i[m];y!=null&&(y.signatureKey=u[g],l.push(y))}),Object.keys(c).length>0?Object.keys(c).forEach(g=>{let[m]=tl(g),y=i[m];y&&(y.signatureKey=c[g],o.push(y))}):o=r;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((g,m)=>(g[m.signature.name]=this.mapFunction(m),g),{}));let f={nodes:i,inputs:o,outputs:l,weights:a,placeholders:r,signature:t,functions:p};return s.length>0&&(f.initNodes=s),f}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){let t=VK(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});let n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce((r,a)=>{let s=a.type,i;switch(a.type){case"string":i=pE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=pE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":i=bE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=bE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":i=mE(e.attr,a.tfName,a.defaultValue||0),i===void 0&&a.tfDeprecatedName&&(i=mE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":i=vE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=vE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":i=fE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=fE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":i=NE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=NE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":i=xE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=xE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":i=wE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=wE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":i=gE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=gE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":i=yE(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=yE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":i=YL(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=YL(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return r[a.name]={value:i,type:s},r},{})),n}mapFunction(e){let t=e.nodeDef,n=[],r=[],a={};t!=null&&(a=t.reduce((c,u)=>(c[u.name]=this.mapNode(u),u.op==="Const"&&r.push(c[u.name]),c),{}));let s=[],i=[];e.signature.inputArg.forEach(c=>{let[u]=tl(c.name),h={name:u,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:_D(c.type),type:"dtype"}},children:[]};h.signatureKey=c.name,s.push(h),a[u]=h}),Object.keys(a).forEach(c=>{let u=a[c];u.inputNames.forEach((h,p)=>{let[f,,g]=tl(h),m=a[f];if(m.outputs!=null){let y=m.outputs.indexOf(g);if(y!==-1){let x=`${f}:${y}`;u.inputNames[p]=x}}u.inputs.push(m),m.children.push(u)})});let o=e.ret;e.signature.outputArg.forEach(c=>{let[u,h]=tl(o[c.name]),p=a[u];p!=null&&(p.defaultOutput=h,i.push(p))});let l=this.mapArgsToSignature(e);return{nodes:a,inputs:s,outputs:i,weights:r,placeholders:n,signature:l}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n),t),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}}};function YOe(e){let t=le().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function c9(e,t){let n=Array.isArray(e)?String.fromCharCode.apply(null,e):YOe(e);return t?n:n.toLowerCase()}function pE(e,t,n,r=!1){let a=e[t];return a!=null?c9(a.s,r):n}function fE(e,t,n){let r=e[t];return r?r.b:n}function mE(e,t,n){let r=e[t]||{},a=r.i!=null?r.i:r.f!=null?r.f:n;return typeof a=="number"?a:parseInt(a,10)}function _D(e){switch(typeof e=="string"&&(e=Ja[e]),e){case Ja.DT_FLOAT:case Ja.DT_HALF:return"float32";case Ja.DT_INT32:case Ja.DT_INT64:case Ja.DT_INT8:case Ja.DT_UINT8:return"int32";case Ja.DT_BOOL:return"bool";case Ja.DT_DOUBLE:return"float32";case Ja.DT_STRING:return"string";case Ja.DT_COMPLEX64:case Ja.DT_COMPLEX128:return"complex64";default:return null}}function YL(e,t,n){let r=e[t];return r&&r.func?r.func.name:n}function gE(e,t,n){let r=e[t];return r&&r.type?_D(r.type):n}function yE(e,t,n){let r=e[t];return r&&r.list&&r.list.type?r.list.type.map(a=>_D(a)):n}function d9(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function xE(e,t,n){let r=e[t];return r&&r.shape?d9(r.shape):n}function vE(e,t,n){let r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function bE(e,t,n,r=!1){let a=e[t];return a&&a.list&&a.list.s?a.list.s.map(s=>c9(s,r)):n}function wE(e,t,n){let r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(a=>d9(a)):n}function NE(e,t,n){let r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var JOe=class{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(e){return Vr(e,this.tensorMap,this.context)}getAttr(e,t){let n=this.node.rawAttrs[e];if(n.tensor!=null)return Vr(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return mE(this.node.rawAttrs,e,t);if(n.s!=null)return pE(this.node.rawAttrs,e,t);if(n.b!=null)return fE(this.node.rawAttrs,e,t);if(n.shape!=null)return xE(this.node.rawAttrs,e,t);if(n.type!=null)return gE(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return vE(this.node.rawAttrs,e,t);if(n.list.s!=null)return bE(this.node.rawAttrs,e,t);if(n.list.shape!=null)return wE(this.node.rawAttrs,e,t);if(n.list.b!=null)return NE(this.node.rawAttrs,e,t);if(n.list.type!=null)return yE(this.node.rawAttrs,e,t)}return t}},zr={};gt(zr,{OP_SCOPE_SUFFIX:()=>IA,abs:()=>ur,acos:()=>$A,acosh:()=>RA,add:()=>me,addN:()=>_8,all:()=>Hk,any:()=>rv,argMax:()=>Ld,argMin:()=>DA,asin:()=>MA,asinh:()=>OA,atan:()=>FA,atan2:()=>PA,atanh:()=>LA,avgPool:()=>El,avgPool3d:()=>BA,basicLSTMCell:()=>T8,batchNorm:()=>_p,batchNorm2d:()=>UA,batchNorm3d:()=>WA,batchNorm4d:()=>VA,batchToSpaceND:()=>wb,bincount:()=>HA,bitwiseAnd:()=>j8,booleanMaskAsync:()=>vq,broadcastArgs:()=>A8,broadcastTo:()=>fd,buffer:()=>jt,cast:()=>Se,ceil:()=>GA,clipByValue:()=>aa,clone:()=>ko,complex:()=>Nl,concat:()=>wn,concat1d:()=>qA,concat2d:()=>KA,concat3d:()=>QA,concat4d:()=>XA,conv1d:()=>Gk,conv2d:()=>Sa,conv2dTranspose:()=>qk,conv3d:()=>JA,conv3dTranspose:()=>ZA,cos:()=>Nb,cosh:()=>Kk,cosineWindow:()=>yS,cumprod:()=>iv,cumsum:()=>Qk,denseBincount:()=>F1,depthToSpace:()=>e$,depthwiseConv2d:()=>Cp,diag:()=>R8,dilation2d:()=>t$,div:()=>ze,divNoNan:()=>n$,dot:()=>r$,dropout:()=>$$,einsum:()=>Vc,elu:()=>Yg,enclosingPowerOfTwo:()=>R$,ensureShape:()=>M8,equal:()=>bs,erf:()=>Xk,euclideanNorm:()=>i$,exp:()=>sa,expandDims:()=>$r,expm1:()=>o$,eye:()=>Yk,fft:()=>$b,fill:()=>xs,floor:()=>Zg,floorDiv:()=>Vk,fused:()=>xm,gather:()=>ey,gatherND:()=>kq,greater:()=>Ta,greaterEqual:()=>Tl,ifft:()=>ym,imag:()=>kb,image:()=>$s,inTopKAsync:()=>Sq,irfft:()=>cS,isFinite:()=>l$,isInf:()=>u$,isNaN:()=>c$,leakyRelu:()=>Sb,less:()=>pm,lessEqual:()=>bc,linalg:()=>O$,linspace:()=>z8,localResponseNormalization:()=>d$,log:()=>ws,log1p:()=>_b,logSigmoid:()=>h$,logSoftmax:()=>Zk,logSumExp:()=>Cb,logicalAnd:()=>ui,logicalNot:()=>Ib,logicalOr:()=>eS,logicalXor:()=>p$,losses:()=>Oq,lowerBound:()=>U8,matMul:()=>_t,max:()=>Ps,maxPool:()=>Ir,maxPool3d:()=>f$,maxPoolWithArgmax:()=>W8,maximum:()=>zo,mean:()=>Wn,meshgrid:()=>V8,min:()=>hm,minimum:()=>Qu,mirrorPad:()=>m$,mod:()=>g$,moments:()=>Eb,movingAverage:()=>bq,mul:()=>Z,multiRNNCell:()=>H8,multinomial:()=>G8,neg:()=>In,norm:()=>Jg,notEqual:()=>Ud,oneHot:()=>fm,ones:()=>Pa,onesLike:()=>Ns,op:()=>J,outerProduct:()=>q8,pad:()=>Ki,pad1d:()=>K8,pad2d:()=>Q8,pad3d:()=>X8,pad4d:()=>Y8,pool:()=>y$,pow:()=>Ro,prelu:()=>jb,print:()=>AA,prod:()=>x$,raggedGather:()=>J8,raggedRange:()=>Z8,raggedTensorToTensor:()=>eq,rand:()=>tq,randomGamma:()=>sq,randomNormal:()=>nS,randomStandardNormal:()=>iq,randomUniform:()=>wc,randomUniformInt:()=>oq,range:()=>Wd,real:()=>mm,reciprocal:()=>k$,relu:()=>hn,relu6:()=>rS,reshape:()=>ee,reverse:()=>Ws,reverse1d:()=>lq,reverse2d:()=>uq,reverse3d:()=>cq,reverse4d:()=>dq,rfft:()=>Rb,round:()=>aS,rsqrt:()=>sS,scalar:()=>Ze,scatterND:()=>wq,searchSorted:()=>tS,selu:()=>iS,separableConv2d:()=>ty,setdiff1dAsync:()=>hq,sigmoid:()=>si,sign:()=>S$,signal:()=>Mq,sin:()=>oS,sinh:()=>lS,slice:()=>Ut,slice1d:()=>Ab,slice2d:()=>uS,slice3d:()=>ny,slice4d:()=>gm,softmax:()=>Nc,softplus:()=>Ip,spaceToBatchND:()=>Tb,sparse:()=>Fq,sparseToDense:()=>Nq,spectral:()=>Dq,split:()=>za,sqrt:()=>Or,square:()=>vn,squaredDifference:()=>dS,squeeze:()=>kc,stack:()=>pr,step:()=>Ep,stridedSlice:()=>_$,string:()=>Pq,sub:()=>Oe,sum:()=>Ge,tan:()=>C$,tanh:()=>Ku,tensor:()=>va,tensor1d:()=>cn,tensor2d:()=>So,tensor3d:()=>hS,tensor4d:()=>Xu,tensor5d:()=>pq,tensor6d:()=>fq,tensorScatterUpdate:()=>gq,tile:()=>ds,topk:()=>E$,transpose:()=>Tt,truncatedNormal:()=>mS,unique:()=>T$,unsortedSegmentSum:()=>gS,unstack:()=>Zn,upperBound:()=>yq,variable:()=>j$,where:()=>Mr,whereAsync:()=>A$,zeros:()=>Vn,zerosLike:()=>qt});var ZOe=(e,t,n,r=zr)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(A("a",e,t,n),A("b",e,t,n))];case"AddN":return[r.addN(A("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(A("a",e,t,n),A("b",e,t,n))];case"Mul":return[r.mul(A("a",e,t,n),A("b",e,t,n))];case"RealDiv":case"Div":return[r.div(A("a",e,t,n),A("b",e,t,n))];case"DivNoNan":return[r.divNoNan(A("a",e,t,n),A("b",e,t,n))];case"FloorDiv":return[r.floorDiv(A("a",e,t,n),A("b",e,t,n))];case"Sub":return[r.sub(A("a",e,t,n),A("b",e,t,n))];case"Minimum":return[r.minimum(A("a",e,t,n),A("b",e,t,n))];case"Maximum":return[r.maximum(A("a",e,t,n),A("b",e,t,n))];case"Pow":return[r.pow(A("a",e,t,n),A("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(A("a",e,t,n),A("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},eFe=(e,t,n,r=zr)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(A("x",e,t,n))];case"Acos":return[r.acos(A("x",e,t,n))];case"Acosh":return[r.acosh(A("x",e,t,n))];case"Asin":return[r.asin(A("x",e,t,n))];case"Asinh":return[r.asinh(A("x",e,t,n))];case"Atan":return[r.atan(A("x",e,t,n))];case"Atan2":return[r.atan2(A("x",e,t,n),A("y",e,t,n))];case"Atanh":return[r.atanh(A("x",e,t,n))];case"Ceil":return[r.ceil(A("x",e,t,n))];case"Complex":return[r.complex(A("real",e,t,n),A("imag",e,t,n))];case"Cos":return[r.cos(A("x",e,t,n))];case"Cosh":return[r.cosh(A("x",e,t,n))];case"Elu":return[r.elu(A("x",e,t,n))];case"Erf":return[r.erf(A("x",e,t,n))];case"Exp":return[r.exp(A("x",e,t,n))];case"Expm1":return[r.expm1(A("x",e,t,n))];case"Floor":return[r.floor(A("x",e,t,n))];case"Log":return[r.log(A("x",e,t,n))];case"Log1p":return[r.log1p(A("x",e,t,n))];case"Imag":return[r.imag(A("x",e,t,n))];case"Neg":return[r.neg(A("x",e,t,n))];case"Reciprocal":return[r.reciprocal(A("x",e,t,n))];case"Real":return[r.real(A("x",e,t,n))];case"Relu":return[r.relu(A("x",e,t,n))];case"Round":return[r.round(A("x",e,t,n))];case"Selu":return[r.selu(A("x",e,t,n))];case"Sigmoid":return[r.sigmoid(A("x",e,t,n))];case"Sin":return[r.sin(A("x",e,t,n))];case"Sign":return[r.sign(A("x",e,t,n))];case"Sinh":return[r.sinh(A("x",e,t,n))];case"Softplus":return[r.softplus(A("x",e,t,n))];case"Sqrt":return[r.sqrt(A("x",e,t,n))];case"Square":return[r.square(A("x",e,t,n))];case"Tanh":return[r.tanh(A("x",e,t,n))];case"Tan":return[r.tan(A("x",e,t,n))];case"ClipByValue":return[r.clipByValue(A("x",e,t,n),A("clipValueMin",e,t,n),A("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(A("x",e,t,n))];case"Rsqrt":return[r.rsqrt(Vr(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(A("x",e,t,n),A("alpha",e,t,n))];case"Prelu":return[r.prelu(A("x",e,t,n),A("alpha",e,t,n))];case"IsNan":return[r.isNaN(Vr(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(Vr(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(Vr(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function Js(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){j.assert(e.length===t.length,()=>n+` Shapes ${e} and ${t} must match`);for(let r=0;r<e.length;r++){let a=e[r],s=t[r];j.assert(a<0||s<0||a===s,()=>n+` Shapes ${e} and ${t} must match`)}}}function JL(e){return!(typeof e=="number"||e.some(t=>t<0))}function Py(e,t,n){let r=kE(e,n),a=!JL(r);if(a&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&t.forEach(s=>{r=kE(s.shape,r)}),!JL(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function kE(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);let n=[];for(let r=0;r<e.length;++r){let a=e[r],s=t[r];if(a>=0&&s>=0&&a!==s)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=a>=0?a:s}return n}var tFe=class{constructor(e,t,n,r,a,s,i){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=s,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=Ze(0),vr(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);let t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);let n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Js(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,vr(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((n,r)=>this.write(n,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return va([],[0].concat(this.elementShape));let n=this.readMany(e);return Js(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),pr(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return va([],[0].concat(this.elementShape));let t=[];for(let r=0;r<this.size();r++)t.push(r);let n=this.readMany(t);return Js(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),wn(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);let n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,Zn(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0,r=e.map(o=>(n+=o,n));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);let a=n===0?0:t.size/n,s=[];te(()=>{t=ee(t,[1,n,a]);for(let o=0;o<e.length;++o){let l=[0,o===0?0:r[o-1],0],c=[1,e[o],a];s[o]=ee(Ut(t,l,c),this.elementShape)}return s});let i=[];for(let o=0;o<e.length;o++)i[o]=o;this.writeMany(i,s)}},HS=class SE{get id(){return this.idTensor.id}constructor(t,n,r,a=-1){this.tensors=t,this.elementShape=n,this.elementDtype=r,t!=null&&t.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);Js(n,s.shape,"TensorList shape mismatch: "),vr(s)}),this.idTensor=Ze(0),this.maxNumElements=a,vr(this.idTensor)}copy(){return new SE([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Js(t,this.elementShape,"TensorList shape mismatch: ");let a=Py(this.elementShape,this.tensors,t);return te(()=>{let s=this.tensors.map(i=>ee(i,a));return pr(s,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");let r=Py(this.elementShape,this.tensors,t),a=this.tensors.pop();return a.kept=!1,Js(a.shape,t,"TensorList shape mismatch: "),ee(a,r)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(Js(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");vr(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);let n=new SE([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let r=0;r<Math.min(this.tensors.length,t);++r)n.tensors[r]=this.tensors[r];return n}getItem(t,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);Js(this.tensors[t].shape,n,"TensorList shape mismatch: ");let a=Py(this.elementShape,this.tensors,n);return ee(this.tensors[t],a)}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);Js(this.elementShape,n.shape,"TensorList shape mismatch: "),vr(n),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=n}gather(t,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Js(this.elementShape,r,"TensorList shape mismatch: "),t=t.slice(0,this.size());let a=Py(this.elementShape,this.tensors,r);return t.length===0?va([],[0].concat(a)):te(()=>{let s=t.map(i=>ee(this.tensors[i],a));return pr(s,0)})}concat(t,n){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);Js(this.elementShape,n,"TensorList shape mismatch: ");let r=Py(this.elementShape,this.tensors,n);return this.size()===0?va([],[0].concat(r)):te(()=>{let a=this.tensors.map(s=>ee(s,r));return wn(a,0)})}};function nFe(e,t,n){let r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);let a=e.shape.slice(1);Js(a,t,"TensorList shape mismatch: ");let s=Zn(e);return new HS(s,t,r)}function rFe(e,t,n,r){return new HS([],e,t,r)}function aFe(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);let a=Math.max(...t);if(r!=null&&r!==-1&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);let s=new HS([],n,e.dtype,r),i=Zn(e,0);return t.forEach((o,l)=>{s.setItem(o,i[l])}),s}function sFe(e,t,n){let r=0,a=t.map(u=>(r+=u,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${e.shape}`);let s=e.shape.slice(1),i=kE(s,n),o=r===0?0:e.size/r,l=te(()=>{let u=[];e=ee(e,[1,r,o]);for(let h=0;h<t.length;++h){let p=[0,h===0?0:a[h-1],0],f=[1,t[h],o];u[h]=ee(Ut(e,p,f),i)}return e.dispose(),u}),c=new HS([],n,e.dtype,t.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}var iFe=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{let r=A("thenBranch",e,t,n),a=A("elseBranch",e,t,n),s=A("cond",e,t,n),i=A("args",e,t,n);return(await s.data())[0]?n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{let r=A("body",e,t,n),a=A("cond",e,t,n),s=A("args",e,t,n),i=await n.functionMap[a].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap),o=s.map(u=>u.id),l=await i[0].data();i.forEach(u=>{!u.kept&&o.indexOf(u.id)===-1&&u.dispose()});let c=s;for(;l[0];){let u=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);let h=c.map(f=>f.id);u.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()});let p=await n.functionMap[a].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{let r=A("pred",e,t,n);return[nl(r)]}case"Switch":{let r=A("pred",e,t,n),a=A("data",e,t,n);return a.kept||(a=nl(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{let r=e.inputNames.find(a=>Vr(a,t,n)!==void 0);if(r){let a=Vr(r,t,n);return[nl(a)]}return}case"Enter":{let r=A("frameName",e,t,n),a=A("tensor",e,t,n);return n.enterFrame(r),[nl(a)]}case"Exit":{let r=A("tensor",e,t,n);return n.exitFrame(),[nl(r)]}case"NextIteration":{let r=A("tensor",e,t,n);return n.nextIteration(),[nl(r)]}case"TensorArrayV3":{let r=A("size",e,t,n),a=A("dtype",e,t,n),s=A("elementShape",e,t,n),i=A("dynamicSize",e,t,n),o=A("clearAfterRead",e,t,n),l=A("identicalElementShapes",e,t,n),c=A("name",e,t,n),u=new tFe(c,a,r,s,l,i,o);return n.addTensorArray(u),[u.idTensor,Ze(1)]}case"TensorArrayWriteV3":{let r=A("tensorArrayId",e,t,n),a=A("index",e,t,n),s=A("tensor",e,t,n),i=n.getTensorArray(r.id);return i.write(a,s),[i.idTensor]}case"TensorArrayReadV3":{let r=A("tensorArrayId",e,t,n),a=A("index",e,t,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{let r=A("tensorArrayId",e,t,n),a=A("indices",e,t,n),s=A("dtype",e,t,n);return[n.getTensorArray(r.id).gather(a,s)]}case"TensorArrayScatterV3":{let r=A("tensorArrayId",e,t,n),a=A("indices",e,t,n),s=A("tensor",e,t,n),i=n.getTensorArray(r.id);return i.scatter(a,s),[i.idTensor]}case"TensorArrayConcatV3":{let r=A("tensorArrayId",e,t,n),a=n.getTensorArray(r.id),s=A("dtype",e,t,n);return[a.concat(s)]}case"TensorArraySplitV3":{let r=A("tensorArrayId",e,t,n),a=A("tensor",e,t,n),s=A("lengths",e,t,n),i=n.getTensorArray(r.id);return i.split(s,a),[i.idTensor]}case"TensorArraySizeV3":{let r=A("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return[Ze(a.size(),"int32")]}case"TensorArrayCloseV3":{let r=A("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{let r=A("tensorListId",e,t,n),a=A("index",e,t,n),s=A("tensor",e,t,n),i=n.getTensorList(r.id);return i.setItem(a,s),[i.idTensor]}case"TensorListGetItem":{let r=A("tensorListId",e,t,n),a=A("index",e,t,n),s=A("elementShape",e,t,n),i=A("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(a,s,i)]}case"TensorListScatterV2":case"TensorListScatter":{let r=A("indices",e,t,n),a=A("tensor",e,t,n),s=A("elementShape",e,t,n),i=A("numElements",e,t,n),o=aFe(a,r,s,i);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let r=A("elementShape",e,t,n),a=A("elementDType",e,t,n),s;e.op==="TensorListReserve"?s="numElements":s="maxNumElements";let i=A(s,e,t,n),o=e.op==="TensorListReserve"?-1:i,l=rFe(r,a,i,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{let r=A("tensorListId",e,t,n),a=A("indices",e,t,n),s=A("elementShape",e,t,n),i=A("elementDType",e,t,n);return[n.getTensorList(r.id).gather(a,i,s)]}case"TensorListStack":{let r=A("tensorListId",e,t,n),a=A("elementShape",e,t,n),s=A("elementDType",e,t,n),i=A("numElements",e,t,n);return[n.getTensorList(r.id).stack(a,s,i)]}case"TensorListFromTensor":{let r=A("tensor",e,t,n),a=A("elementShape",e,t,n),s=A("elementDType",e,t,n),i=nFe(r,a,s);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let r=A("tensorListId",e,t,n),a=n.getTensorList(r.id),s=A("dtype",e,t,n),i=A("elementShape",e,t,n);return[a.concat(s,i)]}case"TensorListPushBack":{let r=A("tensorListId",e,t,n),a=A("tensor",e,t,n),s=n.getTensorList(r.id);return s.pushBack(a),[s.idTensor]}case"TensorListPopBack":{let r=A("tensorListId",e,t,n),a=A("elementShape",e,t,n),s=A("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(a,s)]}case"TensorListSplit":{let r=A("tensor",e,t,n),a=A("elementShape",e,t,n),s=A("lengths",e,t,n),i=sFe(r,s,a);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{let r=A("tensorListId",e,t,n),a=n.getTensorList(r.id);return[Ze(a.size(),"int32")]}case"TensorListResize":{let r=A("tensorListId",e,t,n),a=A("size",e,t,n),s=n.getTensorList(r.id).resize(a);return n.addTensorList(s),[s.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};function ZL(e,t,n){let[r,a]=A("fusedOps",e,t,n),s=r==="biasadd",i=!s,o=a==="prelu",l=r==="fusedbatchnorm",c=A("numArgs",e,t,n);if(s){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&s&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let u=A("strides",e,t,n),h=E0(e,t,n),p=A("dataFormat",e,t,n).toUpperCase(),f=A("dilations",e,t,n),[g,m]=A("args",e,t,n);i&&(m=g,g=void 0);let y=A("leakyreluAlpha",e,t,n);return{stride:u,pad:h,dataFormat:p,dilations:f,biasArg:g,preluArg:m,activationFunc:a,leakyreluAlpha:y}}var oFe=(e,t,n,r=zr)=>{switch(e.op){case"Conv1D":{let a=A("stride",e,t,n),s=A("pad",e,t,n),i=A("dataFormat",e,t,n).toUpperCase(),o=A("dilation",e,t,n);return[r.conv1d(A("x",e,t,n),A("filter",e,t,n),a,s,i,o)]}case"Conv2D":{let a=A("strides",e,t,n),s=E0(e,t,n),i=A("dataFormat",e,t,n).toUpperCase(),o=A("dilations",e,t,n);return[r.conv2d(A("x",e,t,n),A("filter",e,t,n),[a[1],a[2]],s,i,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:a,pad:s,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=ZL(e,t,n);return[r.fused.conv2d({x:A("x",e,t,n),filter:A("filter",e,t,n),strides:[a[1],a[2]],pad:s,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{let{stride:a,pad:s,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=ZL(e,t,n);return[r.fused.depthwiseConv2d({x:A("x",e,t,n),filter:A("filter",e,t,n),strides:[a[1],a[2]],pad:s,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let a=A("outputShape",e,t,n),s=A("strides",e,t,n),i=E0(e,t,n);return[r.conv2dTranspose(A("x",e,t,n),A("filter",e,t,n),a,[s[1],s[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let a=A("strides",e,t,n),s=E0(e,t,n),i=A("dilations",e,t,n),o=A("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(A("input",e,t,n),A("filter",e,t,n),[a[1],a[2]],s,o,[i[1],i[2]])]}case"Conv3D":{let a=A("strides",e,t,n),s=A("pad",e,t,n),i=A("dataFormat",e,t,n).toUpperCase(),o=A("dilations",e,t,n);return[r.conv3d(A("x",e,t,n),A("filter",e,t,n),[a[1],a[2],a[3]],s,i,[o[1],o[2],o[3]])]}case"AvgPool":{let a=A("strides",e,t,n),s=A("pad",e,t,n),i=A("kernelSize",e,t,n);return[r.avgPool(A("x",e,t,n),[i[1],i[2]],[a[1],a[2]],s)]}case"MaxPool":{let a=A("strides",e,t,n),s=A("pad",e,t,n),i=A("kernelSize",e,t,n);return[r.maxPool(A("x",e,t,n),[i[1],i[2]],[a[1],a[2]],s)]}case"MaxPoolWithArgmax":{let a=A("strides",e,t,n),s=A("pad",e,t,n),i=A("kernelSize",e,t,n),o=A("includeBatchInIndex",e,t,n),{result:l,indexes:c}=r.maxPoolWithArgmax(A("x",e,t,n),[i[1],i[2]],[a[1],a[2]],s,o);return[l,c]}case"AvgPool3D":{let a=A("strides",e,t,n),s=A("pad",e,t,n),i=A("kernelSize",e,t,n);return[r.avgPool3d(A("x",e,t,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],s)]}case"MaxPool3D":{let a=A("strides",e,t,n),s=A("pad",e,t,n),i=A("kernelSize",e,t,n);return[r.maxPool3d(A("x",e,t,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],s)]}case"Dilation2D":{let a=A("strides",e,t,n),s=A("pad",e,t,n),i=A("dilations",e,t,n),o=a[1],l=a[2],c=i[1],u=i[2];return[r.dilation2d(A("x",e,t,n),A("filter",e,t,n),[o,l],s,[c,u],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},lFe=(e,t,n,r=zr)=>{switch(e.op){case"Fill":{let a=A("shape",e,t,n),s=A("dtype",e,t,n),i=A("value",e,t,n);return[r.fill(a,i,s)]}case"LinSpace":{let a=A("start",e,t,n),s=A("stop",e,t,n),i=A("num",e,t,n);return[r.linspace(a,s,i)]}case"Multinomial":{let a=A("logits",e,t,n),s=A("numSamples",e,t,n),i=A("seed",e,t,n);return[r.multinomial(a,s,i)]}case"OneHot":{let a=A("indices",e,t,n),s=A("depth",e,t,n),i=A("onValue",e,t,n),o=A("offValue",e,t,n),l=A("dtype",e,t,n);return[r.oneHot(a,s,i,o,l)]}case"Ones":return[r.ones(A("shape",e,t,n),A("dtype",e,t,n))];case"OnesLike":return[r.onesLike(A("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(A("shape",e,t,n),A("dtype",e,t,n),A("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(A("shape",e,t,n),A("minval",e,t,n),A("maxval",e,t,n),A("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(A("shape",e,t,n),A("minval",e,t,n),A("maxval",e,t,n),A("seed",e,t,n))];case"Range":{let a=A("start",e,t,n),s=A("stop",e,t,n),i=A("step",e,t,n);return[r.range(a,s,i,A("dtype",e,t,n))]}case"TruncatedNormal":{let a=A("shape",e,t,n),s=A("mean",e,t,n),i=A("stdDev",e,t,n),o=A("seed",e,t,n);return[r.truncatedNormal(a,s,i,A("dtype",e,t,n),o)]}case"Zeros":return[r.zeros(A("shape",e,t,n),A("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(A("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function IC(e,t,n){let r=A("boxes",e,t,n),a=A("scores",e,t,n),s=A("maxOutputSize",e,t,n),i=A("iouThreshold",e,t,n),o=A("scoreThreshold",e,t,n),l=A("softNmsSigma",e,t,n);return{boxes:r,scores:a,maxOutputSize:s,iouThreshold:i,scoreThreshold:o,softNmsSigma:l}}var uFe=async(e,t,n,r,a=zr)=>{switch(e.op){case"NonMaxSuppressionV5":{let{boxes:s,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=IC(e,t,n),h=await a.image.nonMaxSuppressionWithScoreAsync(s,i,o,l,c,u);return[h.selectedIndices,h.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:s,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=IC(e,t,n),u=A("padToMaxOutputSize",e,t,n),h=await a.image.nonMaxSuppressionPaddedAsync(s,i,o,l,c,u);return[h.selectedIndices,h.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:s,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=IC(e,t,n);return[await a.image.nonMaxSuppressionAsync(s,i,o,l,c)]}case"Where":{let s=a.cast(A("condition",e,t,n),"bool"),i=[await a.whereAsync(s)];return s.dispose(),i}case"ListDiff":return a.setdiff1dAsync(A("x",e,t,n),A("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}},cFe=(e,t,n,r=zr)=>{switch(e.op){case"LowerBound":{let a=A("sortedSequence",e,t,n),s=A("values",e,t,n);return[r.lowerBound(a,s)]}case"TopKV2":{let a=A("x",e,t,n),s=A("k",e,t,n),i=A("sorted",e,t,n),o=r.topk(a,s,i);return[o.values,o.indices]}case"UpperBound":{let a=A("sortedSequence",e,t,n),s=A("values",e,t,n);return[r.upperBound(a,s)]}case"Unique":{let a=A("x",e,t,n),s=r.unique(a);return[s.values,s.indices]}case"UniqueV2":{let a=A("x",e,t,n),s=A("axis",e,t,n),i=r.unique(a,s);return[i.values,i.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},dFe=(e,t,n,r=zr)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let a=A("default",e,t,n);return[Vr(e.name,t,n)||a];case"Placeholder":return[Vr(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{let u=A("x",e,t,n);return[nl(u)]}case"IdentityN":return A("x",e,t,n).map(u=>nl(u));case"Snapshot":let s=A("x",e,t,n);return[nl(s)];case"Shape":return[r.tensor1d(A("x",e,t,n).shape,"int32")];case"ShapeN":return A("x",e,t,n).map(u=>r.tensor1d(u.shape));case"Size":return[r.scalar(A("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(A("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":let i=A("x",e,t,n),o=A("data",e,t,n),l=A("message",e,t,n),c=A("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,c));return[i];default:throw TypeError(`Node type ${e.op} is not implemented`)}},hFe=class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Ze(0),this.tensorMap=new Map,vr(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ze(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),te(()=>{let r=Zn(t),a=n.length,s=r.length;j.assert(a===s,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${s} elements.`);for(let i=0;i<a;i++){let o=n[i],l=r[i];vr(l),this.tensorMap.set(o,l)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return te(()=>{let r=[];for(let a=0;a<n.length;a++){let s=n[a],i=this.findWithDefault(s,t);r.push(i)}return pr(r)})}findWithDefault(e,t){let n=this.tensorMap.get(e);return n??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}},pFe=async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{let a=r.getHashTableHandleByName(e.name);if(a!=null)return[a];{let s=A("keyDType",e,t,n),i=A("valueDType",e,t,n),o=new hFe(s,i);return r.addHashTable(e.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let a=A("tableHandle",e,t,n,r),s=A("keys",e,t,n),i=A("values",e,t,n);return[await r.getHashTableById(a.id).import(s,i)]}case"LookupTableFind":case"LookupTableFindV2":{let a=A("tableHandle",e,t,n,r),s=A("keys",e,t,n),i=A("defaultValue",e,t,n);return[await r.getHashTableById(a.id).find(s,i)]}case"LookupTableSize":case"LookupTableSizeV2":{let a=A("tableHandle",e,t,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},fFe=(e,t,n,r=zr)=>{switch(e.op){case"ResizeBilinear":{let a=A("images",e,t,n),s=A("size",e,t,n),i=A("alignCorners",e,t,n),o=A("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[s[0],s[1]],i,o)]}case"ResizeNearestNeighbor":{let a=A("images",e,t,n),s=A("size",e,t,n),i=A("alignCorners",e,t,n),o=A("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(a,[s[0],s[1]],i,o)]}case"CropAndResize":{let a=A("image",e,t,n),s=A("boxes",e,t,n),i=A("boxInd",e,t,n),o=A("cropSize",e,t,n),l=A("method",e,t,n),c=A("extrapolationValue",e,t,n);return[r.image.cropAndResize(a,s,i,o,l,c)]}case"ImageProjectiveTransformV3":{let a=A("images",e,t,n),s=A("transforms",e,t,n),i=A("outputShape",e,t,n),o=A("fillValue",e,t,n),l=A("interpolation",e,t,n),c=A("fillMode",e,t,n);return[r.image.transform(a,s,l.toLowerCase(),c.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},mFe=(e,t,n,r=zr)=>{switch(e.op){case"Equal":return[r.equal(A("a",e,t,n),A("b",e,t,n))];case"NotEqual":return[r.notEqual(A("a",e,t,n),A("b",e,t,n))];case"Greater":return[r.greater(A("a",e,t,n),A("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(A("a",e,t,n),A("b",e,t,n))];case"Less":return[r.less(A("a",e,t,n),A("b",e,t,n))];case"LessEqual":return[r.lessEqual(A("a",e,t,n),A("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(A("a",e,t,n),A("b",e,t,n))];case"LogicalNot":return[r.logicalNot(A("a",e,t,n))];case"LogicalOr":return[r.logicalOr(A("a",e,t,n),A("b",e,t,n))];case"Select":case"SelectV2":return[r.where(A("condition",e,t,n),A("a",e,t,n),A("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(A("a",e,t,n),A("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},gFe=(e,t,n,r=zr)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(A("a",e,t,n),A("b",e,t,n),A("transposeA",e,t,n),A("transposeB",e,t,n))];case"Einsum":return[r.einsum(A("equation",e,t,n),...A("tensors",e,t,n))];case"Transpose":return[r.transpose(A("x",e,t,n),A("perm",e,t,n))];case"_FusedMatMul":let[a,s]=A("fusedOps",e,t,n),i=a==="biasadd",o=s==="prelu",l=A("numArgs",e,t,n),c=A("leakyreluAlpha",e,t,n);if(i){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[u,h]=A("args",e,t,n);return[r.fused.matMul({a:A("a",e,t,n),b:A("b",e,t,n),transposeA:A("transposeA",e,t,n),transposeB:A("transposeB",e,t,n),bias:u,activation:s,preluActivationWeights:h,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(A("a",e,t,n),A("numLower",e,t,n),A("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},yFe=(e,t,n,r=zr)=>{switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(A("x",e,t,n),A("axis",e,t,n),A("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(A("x",e,t,n),A("mean",e,t,n),A("variance",e,t,n),A("offset",e,t,n),A("scale",e,t,n),A("epsilon",e,t,n))];case"FusedBatchNormV3":return[r.batchNorm(A("x",e,t,n),A("mean",e,t,n),A("variance",e,t,n),A("offset",e,t,n),A("scale",e,t,n),A("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(A("x",e,t,n),A("radius",e,t,n),A("bias",e,t,n),A("alpha",e,t,n),A("beta",e,t,n))];case"Softmax":return[r.softmax(A("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(A("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},xFe=(e,t,n,r=zr)=>{switch(e.op){case"RaggedGather":{let{outputNestedSplits:a,outputDenseValues:s}=r.raggedGather(A("paramsNestedSplits",e,t,n),A("paramsDenseValues",e,t,n),A("indices",e,t,n),A("outputRaggedRank",e,t,n));return a.concat(s)}case"RaggedRange":{let{rtNestedSplits:a,rtDenseValues:s}=r.raggedRange(A("starts",e,t,n),A("limits",e,t,n),A("splits",e,t,n));return[a,s]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(A("shape",e,t,n),A("values",e,t,n),A("defaultValue",e,t,n),A("rowPartitionTensors",e,t,n),A("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},vFe=(e,t,n,r=zr)=>{switch(e.op){case"Max":{let o=A("axis",e,t,n),l=A("keepDims",e,t,n);return[r.max(A("x",e,t,n),o,l)]}case"Mean":{let o=A("axis",e,t,n),l=A("keepDims",e,t,n);return[r.mean(A("x",e,t,n),o,l)]}case"Min":{let o=A("axis",e,t,n),l=A("keepDims",e,t,n);return[r.min(A("x",e,t,n),o,l)]}case"Sum":{let o=A("axis",e,t,n),l=A("keepDims",e,t,n);return[r.sum(A("x",e,t,n),o,l)]}case"All":{let o=A("axis",e,t,n),l=A("keepDims",e,t,n);return[r.all(A("x",e,t,n),o,l)]}case"Any":{let o=A("axis",e,t,n),l=A("keepDims",e,t,n);return[r.any(A("x",e,t,n),o,l)]}case"ArgMax":{let o=A("axis",e,t,n);return[r.argMax(A("x",e,t,n),o)]}case"ArgMin":{let o=A("axis",e,t,n);return[r.argMin(A("x",e,t,n),o)]}case"Prod":{let o=A("axis",e,t,n),l=A("keepDims",e,t,n);return[r.prod(A("x",e,t,n),o,l)]}case"Cumprod":{let o=A("axis",e,t,n),l=A("exclusive",e,t,n),c=A("reverse",e,t,n);return[r.cumprod(A("x",e,t,n),o,l,c)]}case"Cumsum":{let o=A("axis",e,t,n),l=A("exclusive",e,t,n),c=A("reverse",e,t,n);return[r.cumsum(A("x",e,t,n),o,l,c)]}case"Bincount":let a=A("x",e,t,n),s=A("weights",e,t,n),i=A("size",e,t,n);return[r.bincount(a,s,i)];case"DenseBincount":{let o=A("x",e,t,n),l=A("weights",e,t,n),c=A("size",e,t,n),u=A("binaryOutput",e,t,n);return[r.denseBincount(o,l,c,u)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},bFe=(e,t,n,r=zr)=>{switch(e.op){case"ConcatV2":case"Concat":{let a=A("n",e,t,n),s=A("axis",e,t,n),i=A("tensors",e,t,n);return i=i.slice(0,a),[r.concat(i,s)]}case"Gather":{let a=A("x",e,t,n),s=A("indices",e,t,n);return[r.gather(a,r.cast(s,"int32"),0)]}case"GatherV2":{let a=A("axis",e,t,n),s=A("batchDims",e,t,n),i=A("x",e,t,n),o=A("indices",e,t,n);return[r.gather(i,r.cast(o,"int32"),a,s)]}case"Reverse":{let a=A("dims",e,t,n),s=[];for(let o=0;o<a.length;o++)a[o]&&s.push(o);let i=A("x",e,t,n);return[r.reverse(i,s)]}case"ReverseV2":{let a=A("axis",e,t,n),s=A("x",e,t,n);return[r.reverse(s,a)]}case"Slice":{let a=A("begin",e,t,n),s=A("size",e,t,n);return[r.slice(A("x",e,t,n),a,s)]}case"StridedSlice":{let a=A("begin",e,t,n),s=A("end",e,t,n),i=A("strides",e,t,n),o=A("beginMask",e,t,n),l=A("endMask",e,t,n),c=A("ellipsisMask",e,t,n),u=A("newAxisMask",e,t,n),h=A("shrinkAxisMask",e,t,n),p=A("x",e,t,n);return[r.stridedSlice(p,a,s,i,o,l,c,u,h)]}case"Pack":return te(()=>{let a=A("axis",e,t,n),s=A("tensors",e,t,n),i=s[0].shape,o=r.squeeze(s[0]).shape,l=s.map(c=>{let u=j.arraysEqual(c.shape,i);if(!u&&!j.arraysEqual(r.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return u?c:r.reshape(c,i)});return[r.stack(l,a)]});case"Unpack":{let a=A("axis",e,t,n),s=A("tensor",e,t,n);return r.unstack(s,a)}case"Tile":{let a=A("reps",e,t,n);return[r.tile(A("x",e,t,n),a)]}case"Split":case"SplitV":{let a=A("axis",e,t,n),s=A("numOrSizeSplits",e,t,n),i=A("x",e,t,n);return r.split(i,s,a)}case"ScatterNd":{let a=A("indices",e,t,n),s=A("values",e,t,n),i=A("shape",e,t,n);return[r.scatterND(a,s,i)]}case"GatherNd":{let a=A("x",e,t,n),s=A("indices",e,t,n);return[r.gatherND(a,s)]}case"SparseToDense":{let a=A("sparseIndices",e,t,n),s=A("outputShape",e,t,n),i=A("sparseValues",e,t,n),o=A("defaultValue",e,t,n);return[r.sparseToDense(a,i,s,i.dtype===o.dtype?o:r.cast(o,i.dtype))]}case"TensorScatterUpdate":{let a=A("indices",e,t,n),s=A("values",e,t,n),i=A("tensor",e,t,n);return[r.tensorScatterUpdate(i,a,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},wFe=(e,t,n,r=zr)=>{switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:a,outputValues:s,emptyRowIndicator:i,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(A("indices",e,t,n),A("values",e,t,n),A("denseShape",e,t,n),A("defaultValue",e,t,n));return[a,s,i,o]}case"SparseReshape":{let{outputIndices:a,outputShape:s}=r.sparse.sparseReshape(A("inputIndices",e,t,n),A("inputShape",e,t,n),A("newShape",e,t,n));return[a,s]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(A("data",e,t,n),A("indices",e,t,n),A("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(A("data",e,t,n),A("indices",e,t,n),A("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},NFe=(e,t,n,r=zr)=>{switch(e.op){case"FFT":return[r.fft(A("x",e,t,n))];case"IFFT":return[r.ifft(A("x",e,t,n))];case"RFFT":return[r.rfft(A("x",e,t,n))];case"IRFFT":return[r.irfft(A("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},kFe=(e,t,n,r=zr)=>{switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(A("input",e,t,n),A("pattern",e,t,n),A("rewrite",e,t,n),A("replaceGlobal",e,t,n))];case"StringNGrams":{let{nGrams:a,nGramsSplits:s}=r.string.stringNGrams(A("data",e,t,n),A("dataSplits",e,t,n),A("separator",e,t,n),A("nGramWidths",e,t,n),A("leftPad",e,t,n),A("rightPad",e,t,n),A("padWidth",e,t,n),A("preserveShortSequences",e,t,n));return[a,s]}case"StringSplit":{let{indices:a,values:s,shape:i}=r.string.stringSplit(A("input",e,t,n),A("delimiter",e,t,n),A("skipEmpty",e,t,n));return[a,s,i]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(A("input",e,t,n),A("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},SFe=(e,t,n,r=zr)=>{switch(e.op){case"Cast":return[r.cast(A("x",e,t,n),A("dtype",e,t,n))];case"ExpandDims":{let a=A("axis",e,t,n);return[r.expandDims(A("x",e,t,n),a)]}case"Squeeze":{let a=A("axis",e,t,n);return[r.squeeze(A("x",e,t,n),a)]}case"Reshape":return[r.reshape(A("x",e,t,n),A("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(A("x",e,t,n),A("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(A("x",e,t,n),A("padding",e,t,n),A("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(A("x",e,t,n),A("padding",e,t,n),A("constantValue",e,t,n))];case"SpaceToBatchND":{let a=A("blockShape",e,t,n),s=A("paddings",e,t,n);return[r.spaceToBatchND(A("x",e,t,n),a,s)]}case"BatchToSpaceND":{let a=A("blockShape",e,t,n),s=A("crops",e,t,n);return[r.batchToSpaceND(A("x",e,t,n),a,s)]}case"DepthToSpace":{let a=A("blockSize",e,t,n),s=A("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(A("x",e,t,n),a,s)]}case"BroadcastTo":return[r.broadcastTo(A("x",e,t,n),A("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(A("s0",e,t,n),A("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function e3(e,t,n,r,a=te){let s=((i,o,l)=>{switch(i.category){case"arithmetic":return a(()=>ZOe(i,o,l));case"basic_math":return a(()=>eFe(i,o,l));case"control":return iFe(i,o,l);case"convolution":return a(()=>oFe(i,o,l));case"creation":return a(()=>lFe(i,o,l));case"dynamic":return uFe(i,o,l);case"evaluation":return a(()=>cFe(i,o,l));case"image":return a(()=>fFe(i,o,l));case"graph":return a(()=>dFe(i,o,l));case"logical":return a(()=>mFe(i,o,l));case"matrices":return a(()=>gFe(i,o,l));case"normalization":return a(()=>yFe(i,o,l));case"ragged":return a(()=>xFe(i,o,l));case"reduction":return a(()=>vFe(i,o,l));case"slice_join":return a(()=>bFe(i,o,l));case"sparse":return a(()=>wFe(i,o,l));case"spectral":return a(()=>NFe(i,o,l));case"string":return a(()=>kFe(i,o,l));case"transformation":return a(()=>SFe(i,o,l));case"hash_table":return pFe(i,o,l,r);case"custom":let c=VK(i.op);if(c&&c.customExecutor)return c.customExecutor(new JOe(i,o,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return j.isPromise(s)?s.then(i=>[].concat(i)):[].concat(s)}var t3=class{constructor(e={},t={},n={},r={},a){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function n3(e,t,n,r){let a=new Set,s=[],i=null,o=null,l=new Set,c=new Set(Object.keys(e).map(p=>rs(p)[0]));r=r||[];let u=new Set(r.map(p=>rs(p.name)[0])),h=[...t];for(;h.length>0;){let p=h.pop();if((Gc(p)||$Fe(p)||RFe(p))&&i==null&&(i=p,o=i.children.map(f=>f.name).filter(f=>a.has(f))),a.add(p.name),n[p.name]==null&&!c.has(p.name)&&!u.has(p.name)){if(p.inputs.length===0){s.push(p.name);continue}p.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),h.push(f))})}}return{inputs:e,outputs:t,usedNodes:a,missingInputs:s,dynamicNode:i,syncInputs:o}}function _Fe(e,t){let{usedNodes:n,inputs:r}=t,a=Object.keys(r).map(y=>rs(y)[0]).map(y=>e.nodes[y]),s=e.initNodes||[],i=y=>n.has(typeof y=="string"?y:y.name);function o(y){return[...new Map(y.map(x=>[x.name,x])).values()]}let l=o([...a,...e.weights,...s]).filter(i),c=o([...l,...Object.values(e.nodes)]).filter(i),u=new Map(c.map(y=>[y.name,y])),h={};for(let y of c){h[y.name]=h[y.name]||0;for(let x of y.children)i(x)||(h[x.name]=Number.POSITIVE_INFINITY),h[x.name]=(h[x.name]||0)+1}let p=Object.entries(h).filter(([,y])=>y===0).map(([y])=>y),f=[...p];for(;p.length>0;){let y=p.pop(),x=u.get(y);for(let v of x.children.filter(i))--h[v.name]===0&&(f.push(v.name),p.push(v.name))}let g=f.map(y=>u.get(y)),m=CFe(g,l);return IFe(m,l),m}function CFe(e,t){let n=new Map(e.map(s=>[s.name,s])),r=t.map(s=>s.name),a=new Set(r);for(;r.length>0;){let s=r.pop(),i=n.get(s);for(let o of i.children)!n.has(o.name)||a.has(o.name)||(a.add(o.name),r.push(o.name))}return e.filter(s=>a.has(s.name))}var Hw=class extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}};function IFe(e,t){let n=new Map(e.map((o,l)=>[o.name,l])),r=new Set(t.map(o=>o.name)),a=o=>r.has(typeof o=="string"?o:o.name),s=new Set(e.map(o=>o.name)),i=o=>s.has(typeof o=="string"?o:o.name);for(let o of e){for(let l of o.children.filter(i)){if(!n.has(l.name))throw new Hw(`Child ${l.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(l.name))throw new Hw(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!a(o))for(let l of o.inputs){if(!n.has(l.name))throw new Hw(`Input ${l.name} of node ${o.name} is unreachable.`);if(n.get(l.name)>n.get(o.name))throw new Hw(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function EFe(e){let t=new Map(e.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,r=e.map((o,l)=>Gc(o)?n:l),a=o=>{let l=r[t.get(o.name)];return l??-1},s=e.map((o,l)=>o.children.map(a).reduce((c,u)=>Math.max(c,u),r[l])),i=new Map;for(let o=0;o<e.length;++o){let l=s[o];if(l===n)continue;let c=e[o],u=e[l];i.has(u.name)||i.set(u.name,[]),i.get(u.name).push(c)}return i}var TFe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),jFe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),AFe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Gc(e){return TFe.has(e.op)}function $Fe(e){return jFe.has(e.op)}function RFe(e){return AFe.has(e.op)}var r3=class h9{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){let n=Object.keys(t).map(r=>t[r].map(a=>a.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{let n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(r=>{this._functionExecutorMap[r]=new h9(t.functions[r],this)})}getCompilationKey(t,n){let r=t.map(s=>s.name).sort(),a=n.map(s=>s.name).sort();return r.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(t,n){let r=n3(t,n,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:s,syncInputs:i}=r;if(s!=null)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(a.length>0){let c=n.map(h=>h.name),u=Object.keys(t);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${u}]. Missing the following inputs: [${a}]`)}let o=_Fe(this.graph,r),l=EFe(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(t){if(t==null)return null;let n=t.clone();return vr(n),n}cloneTensorList(t){return t?t.map(n=>this.cloneAndKeepTensor(n)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(t,n){this.disposeIntermediateTensors(),t=this.mapInputs(t);let r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);let a=r.map(p=>this.graph.nodes[rs(p)[0]]),s=n.map(p=>rs(p)[0]),i=new Set(s),o=s.map(p=>this.graph.nodes[p]);o.length===0&&(o=this._outputs);let l=this.getCompilationKey(a,o),c=this.compiledMap.get(l);c==null&&(c=this.compile(t,o),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=le().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}let u={},h={};return te(()=>{let p=new t3(this.weightMap,u,h,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(x=>{let[v,b]=rs(x,p),w=[];w[b]=t[x],f[v]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[v]=this.cloneTensorList(w))});let g=this.getFrozenTensorIds(f),{orderedNodes:m,nodeLiveUntilMap:y}=c;for(let x of m){if(f[x.name])continue;let v=e3(x,f,p,this._resourceManager);if(j.isPromise(v))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);f[x.name]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[x.name]=this.cloneTensorList(v)),this.checkTensorForDisposalWithNodeLiveUntilInfo(x,f,p,g,i,y.get(x.name))}return this.parent==null&&p.dispose(g),n.map(x=>Vr(x,f,p))})}getFrozenTensorIds(t){let n=[].concat.apply([],Object.keys(t).map(r=>t[r]).map(r=>r.map(a=>a.id)));return new Set(n)}checkTensorForDisposal(t,n,r,a,s,i,o){if(!(Gc(n)||i.has(t))){for(let l of r[t])l!=null&&(o[l.id]=(o[l.id]||0)+n.children.length);for(let l of n.inputs){if(Gc(l))continue;let c=QL(l.name,r,a);if(c!=null)for(let u of c){if(!u||u.kept||s.has(u.id))continue;let h=o[u.id];h===1?(u.dispose(),delete o[u.id]):h!=null&&o[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,n,r,a,s,i){function o(l){return Gc(l)||s.has(l.name)}if(!(Gc(t)||i==null))for(let l of i){if(o(l))continue;let c=QL(l.name,n,r);for(let u of c)!u||u.kept||a.has(u.id)||u.dispose()}}async executeAsync(t,n){return this._executeAsync(t,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(let n of t)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,n,r=!1,a={},s={}){this.disposeIntermediateTensors(),r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=le().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}let i=new t3(this.weightMap,a,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let o=await this.executeWithControlFlow(t,i,n,r),l=n.map(p=>Vr(p,o,i)),c=l.map(p=>p.id),u=Object.keys(t).map(p=>t[p].id),h=new Set([...c,...u,...this.weightIds]);return Object.values(o).forEach(p=>{p.forEach(f=>{f&&!f.isDisposed&&!h.has(f.id)&&f.dispose()})}),this.parent==null&&i.dispose(h),l}async executeFunctionAsync(t,n,r){let a=t.reduce((s,i,o)=>(s[this.inputs[o].name]=i,s),{});return this._executeAsync(a,this.outputNodes,!0,n,r)}async executeWithControlFlow(t,n,r,a){let s=Object.keys(t),i=s.map(w=>this.graph.nodes[rs(w)[0]]),o=r.map(w=>rs(w)[0]),l=new Set(o),c=o.map(w=>this.graph.nodes[w]);c.length===0&&(c=this._outputs);let{usedNodes:u,missingInputs:h,dynamicNode:p,syncInputs:f}=n3(t,c,this.weightMap,this._initNodes),g=[...i,...this.graph.weights,...this._initNodes||[]].map(w=>({node:w,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(t).forEach(w=>{let[k,I]=rs(w),C=[];C[I]=t[w],m[k]=C});let y={},x=this.getFrozenTensorIds(m),v={};for(;g.length>0;){let w=this.processStack(i,g,n,m,v,x,l,y,u);await Promise.all(w)}p==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let b=c.filter(w=>!Gc(w)&&!Vr(w.name,m,n)).map(w=>w.name);if(b.length>0){let w="";throw p!=null&&(w=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${s}]. Consider providing the following inputs: [${h}]. ${w}`)}return m}processStack(t,n,r,a,s,i,o,l,c){let u=[];for(;n.length>0;){let h=n.pop();r.currentContext=h.contexts;let p="";if(h.node.op==="Enter"&&A("isConstant",h.node,a,r)&&([p]=tl(h.node.name,r)),a[h.node.name]==null){let f=e3(h.node,a,r,this._resourceManager);p||([p]=tl(h.node.name,r));let g=r.currentContext;j.isPromise(f)?u.push(f.then(m=>(a[p]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(m)),r.currentContext=g,this.checkTensorForDisposal(p,h.node,a,r,i,o,l),this.processChildNodes(h.node,n,r,a,s,c),m))):(a[p]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(f)),this.checkTensorForDisposal(p,h.node,a,r,i,o,l),this.processChildNodes(h.node,n,r,a,s,c))}else this.processChildNodes(h.node,n,r,a,s,c)}return u}processChildNodes(t,n,r,a,s,i){t.children.forEach(o=>{let[l]=tl(o.name,r);s[l]||!i.has(o.name)||(o.op==="Merge"?o.inputNames.some(c=>!!Vr(c,a,r))&&(s[l]=!0,n.push({contexts:r.currentContext,node:o})):o.inputNames.every(c=>!!Vr(c,a,r))&&(s[l]=!0,n.push({contexts:r.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{let r=t[n],[a]=rs(n),s=this.graph.nodes[a];if(s.attrParams.shape&&s.attrParams.shape.value){let i=s.attrParams.shape.value,o=i.length===r.shape.length&&r.shape.every((l,c)=>i[c]===-1||i[c]===l);j.assert(o,()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${i}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&j.assert(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(t){var n,r;let a={};for(let s in t){let i=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[s];i!=null?a[i.name]=t[s]:a[s]=t[s]}return a}checkInputs(t){let n=Object.keys(t).filter(r=>{let[a]=rs(r);return this.graph.nodes[a]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>{var r,a;let s=(a=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||a===void 0?void 0:a[n];return s!=null?s.name:n},{})}checkOutputs(t){t.forEach(n=>{let[r]=rs(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}},DFe=class{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}},MFe="?tfjs-format=file",OFe="model.json",CD=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=qr){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,t==null&&(this.loadOptions={}),this.resourceManager=new DFe}findIOHandler(){let e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return j.isPromise(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){let t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");let t=await m8(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;let n=this.artifacts.modelTopology,r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){let a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version=`${n.versions.producer}.${n.versions.minConsumer}`,this.executor=new r3(XL.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){let a=XL.Instance.transformGraph(e.modelInitializer);this.initializer=new r3(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){let n=this.io.getSaveHandlers(e);if(n.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(n.length>1)throw new Error(`Found more than one (${n.length}) save handlers for URL '${e}'`);e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t=e instanceof Dt?[e]:e,n={};return t.forEach((r,a)=>n[this.structuredOutputKeys[a]]=r),n}return e}predict(e,t){let n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){let n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof Dt)&&!Array.isArray(e)){let a=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(a!=null)for(let s in a){let i=a[s];i.resourceId!=null&&(e[s]=this.resourceIdToCapturedInput[i.resourceId])}return e}e=Array.isArray(e)?e:[e];let n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-n} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,s)=>{var i,o,l;let c=(l=(o=(i=this.signature)===null||i===void 0?void 0:i.inputs)===null||o===void 0?void 0:o[s])===null||l===void 0?void 0:l.resourceId;return c!=null?a[s]=this.resourceIdToCapturedInput[c]:a[s]=e[r++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){let a=n[r],s=t[a];this.resourceIdToCapturedInput[s.resourceId]=e[r]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&mt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function FFe(e,t={},n=qr){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=LFe(e));let r=new CD(e,t,n);return await r.load(),r}function PFe(e){if(e==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[r,a]=e;if(!r)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");let s=qr.getWeightSpecs(r.weightsManifest),i=qr.getModelArtifactsForJSONSync(r,s,a);t=qr.fromMemorySync(i)}else if("load"in e)t=e;else if("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e)t=qr.fromMemorySync(e);else throw new Error("Unknown model format");let n=new CD(t);return n.load(),n}function LFe(e){return e.endsWith("/")||(e=e+"/"),`${e}${OFe}${MFe}`}var zFe="4.22.0",p9={};gt(p9,{CSVDataset:()=>S9,Dataset:()=>iy,FileDataSource:()=>A9,TextLineDataset:()=>k9,URLDataSource:()=>$9,array:()=>uPe,csv:()=>NPe,func:()=>kPe,generator:()=>SPe,microphone:()=>CPe,version_data:()=>IPe,webcam:()=>_Pe,zip:()=>cPe});var BFe=fc(Sk()),UFe=fc(Sk());function WFe(e,t){return Q1(e,t)}function Q1(e,t,n=new Map,r=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse)if(wm(e)){let s=Array.isArray(e)?[]:{};r.add(e);for(let i in e){let o=e[i],l=Q1(o,t,n,r);s[i]=l}return r.delete(e),e.__proto__&&(s.__proto__=e.__proto__),s}else throw new Error(`Can't recurse into non-iterable type: ${e}`);else return n.set(e,a.value),a.value}function VFe(e,t=m9){return f9(e,t)}function f9(e,t,n=new Set){let r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse)if(wm(r)){let s=Array.isArray(r)?[]:{};n.add(r);for(let i in r){let o=e.map(c=>c[i]),l=f9(o,t,n);s[i]=l}return n.delete(r),s}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return a.value}function m9(e){return e===null?null:wm(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function g9(e,t){let n=new Map;Q1(e,t,n);for(let r of Array.from(n.keys())){let a=n.get(r);if(j.isPromise(a)){let s=await a;n.set(r,s)}}return Q1(e,t,n)}function wm(e){let t=!1;if(le().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}=MG();t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Dt)&&!(e instanceof Promise)&&!t)}function HFe(e){return e==null||GFe(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Dt||j.isTypedArray(e)}function GFe(e){return e===null||typeof e!="object"&&typeof e!="function"}function qFe(e){return WFe(e,KFe)}function KFe(e){return e instanceof Dt?{value:e.clone(),recurse:!1}:wm(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var y9=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},x9=class v9 extends y9{constructor(){super(v9.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){let t=this.capacity*2,n=new Array(t),r=this.length();for(let a=0;a<r;a++)n[a]=this.get(this.wrap(this.begin+a));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r}};x9.INITIAL_CAPACITY=32;function b9(e){return new YFe(e)}function ID(e){return new JFe(e)}function QFe(e,t){return new w9(e,t)}function XFe(e,t=xu.FAIL){return new oPe(e,t)}var Fr=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new sPe(this,e)}filter(e){return new rPe(this,e)}map(e){return new aPe(this,e)}mapAsync(e){return new a3(this,e)}serialMapAsync(e){return new a3(this,e).serial()}flatmap(e){return new iPe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(t=>t===!0)}rowMajorBatch(e,t=!0){return new nPe(this,e,t)}columnMajorBatch(e,t=!0,n=m9){return this.rowMajorBatch(e,t).map(r=>VFe(r,n))}concatenate(e,t){return new w9(b9([this,e]),t)}take(e){return e<0||e==null?this:new tPe(this,e)}skip(e){return e<0||e==null?this:new ePe(this,e)}prefetch(e){return new N9(this,e)}shuffle(e,t){return new lPe(this,e,t)}serial(){return new ZFe(this)}},YFe=class extends Fr{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:qFe(e),done:!1}}},JFe=class extends Fr{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}},ZFe=class extends Fr{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},ePe=class extends Fr{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;mt(e.value)}return this.upstream.next()}},tPe=class extends Fr{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},nPe=class extends Fr{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},rPe=class extends Fr{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;mt(e.value)}}},aPe=class extends Fr{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=Ri.getTensorsInContainer(e.value),n=this.transform(e.value),r=Ri.getTensorsInContainer(n);for(let a of t)Ri.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},sPe=class extends Fr{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}},a3=class extends Fr{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=Ri.getTensorsInContainer(e.value),n=await this.transform(e.value),r=Ri.getTensorsInContainer(n);for(let a of t)Ri.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},ED=class extends Fr{constructor(){super(),this.outputQueue=new x9,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},iPe=class extends ED{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=Ri.getTensorsInContainer(e.value),n=this.transform(e.value),r=Ri.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(let a of t)Ri.isTensorInList(a,r)||a.dispose();return!0}},w9=class extends Fr{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){let n=await this.moreIterators.next();if(n.done)return{value:null,done:!0};this.iterator=n.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}},xu;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(xu||(xu={}));var oPe=class extends Fr{constructor(e,t=xu.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0;function r(s){return s instanceof Fr?{value:s.next().then(i=>(t++,i.done&&n++,i.value)),recurse:!1}:{value:null,recurse:!0}}let a=await g9(this.iterators,r);if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case xu.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case xu.SHORTEST:return{value:null,done:!0};case xu.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},N9=class extends Fr{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new y9(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},lPe=class extends N9{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=UFe.alea(n||j.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(t.done)this.upstreamExhausted=!0;else return this.refill(),t}return{value:null,done:!0}}},iy=class{constructor(){this.size=null}batch(e,t=!0){let n=this;j.assert(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:t?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),ts(async()=>(await n.iterator()).columnMajorBatch(e,t,dPe),r)}concatenate(e){let t=this,n;return this.size===1/0||e.size===1/0?n=1/0:this.size!=null&&e.size!=null?n=this.size+e.size:n=null,ts(async()=>(await t.iterator()).concatenate(await e.iterator()),n)}filter(e){let t=this,n;return this.size===1/0?n=1/0:n=null,ts(async()=>(await t.iterator()).filter(r=>te(()=>e(r))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return ts(async()=>(await t.iterator()).map(n=>te(()=>e(n))),this.size)}mapAsync(e){let t=this;return ts(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return ts(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this,n;return this.size!=null&&e>0?n=this.size*e:e===0?n=0:this.size!=null&&(e===void 0||e<0)?n=1/0:n=null,ts(async()=>{let r=ID(async()=>({value:await t.iterator(),done:!1}));return QFe(r.take(e))},n)}skip(e){let t=this,n;return this.size!=null&&e>=0&&this.size>=e?n=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?n=0:n=null,ts(async()=>(await t.iterator()).skip(e),n)}shuffle(e,t,n=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let r=this,a=BFe.alea(t||j.now().toString());return ts(async()=>{let s=a.int32();return n&&(s+=a.int32()),(await r.iterator()).shuffle(e,s.toString())},this.size)}take(e){let t=this,n;return this.size!=null&&this.size>e?n=e:this.size!=null&&this.size<=e?n=this.size:n=null,ts(async()=>(await t.iterator()).take(e),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};iy.MAX_BUFFER_SIZE=1e4;function ts(e,t=null){return new class extends iy{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function uPe(e){return ts(async()=>b9(e),e.length)}function cPe(e){if(!wm(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=t==null?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=t==null?e[n].size:Math.min(t,e[n].size);return ts(async()=>{let n=await g9(e,r=>{if(r instanceof iy)return{value:r.iterator(),recurse:!1};if(wm(r))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return XFe(n,xu.SHORTEST)},t)}function dPe(e){if(e===null)return null;let t=e[0];return HFe(t)?{value:hPe(e),recurse:!1}:{value:null,recurse:!0}}function hPe(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Dt?pr(e):va(e)}var k9=class extends iy{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}},Gw='"',Ly=Symbol("out"),s3=Symbol("field"),qw=Symbol("quote"),EC=Symbol("quoteafterquote"),i3=Symbol("quoteinquote"),S9=class extends iy{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&j.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((r,a)=>(r[a]=r[a]+1||1,r),{}),n=Object.keys(t).filter(r=>t[r]>1);if(j.assert(n.length===0,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs){for(let r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}else return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new k9(e),t||(t={}),this.hasHeader=t.hasHeader!==!1,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(j.assert(t.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(t=>this.makeDataElement(t))}makeDataElement(e){let t=this.parseRow(e),n={},r={};for(let a=0;a<this.fullColumnNames.length;a++){let s=this.fullColumnNames[a],i=this.columnConfigs?this.columnConfigs[s]:null;if(!(this.configuredColumnsOnly&&!i)){let o=t[a],l=null;if(o==="")if(i&&i.default!==void 0)l=i.default;else{if(i&&(i.required||i.isLabel))throw new Error(`Required column ${s} is empty in this line: ${e}`);l=void 0}else{let c=Number(o);if(isNaN(c))i&&i.dtype==="bool"?l=this.getBoolean(o):l=o;else if(!i||!i.dtype)l=c;else switch(i.dtype){case"float32":l=c;break;case"int32":l=Math.floor(c);break;case"bool":l=this.getBoolean(o);break;default:l=c}}i&&i.isLabel?r[s]=l:n[s]=l}}return Object.keys(r).length===0?n:{xs:n,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,t=!0){let n=[],r=0,a=e.length,s=Ly;for(let i=0;i<a;i++)switch(s){case Ly:switch(e.charAt(i)){case Gw:r=i+1,s=qw;break;case this.delimiter:if(r=i+1,this.delimiter===" "&&this.delimWhitespace)break;n.push(""),s=Ly;break;default:s=s3,r=i;break}break;case s3:switch(e.charAt(i)){case this.delimiter:n.push(e.substring(r,i)),s=Ly,r=i+1;break}break;case qw:switch(e.charAt(i)){case Gw:s=EC;break}break;case EC:switch(e.charAt(i)){case this.delimiter:n.push(e.substring(r,i-1)),s=Ly,r=i+1;break;case Gw:s=qw;break;default:s=i3;break}break;case i3:switch(e.charAt(i)){case Gw:s=qw;break}break}if(s===EC?n.push(e.substring(r,a-1)):n.push(e.substring(r)),t&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}},pPe=class _9 extends Fr{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;let n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(!le().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let n=new _9(t);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(r){throw new Error(`Error thrown while initializing video stream: ${r.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);let n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,n,r=await this.getAudioData();if(this.includeSpectrogram){let a=this.flattenQueue(r.freqDataQueue);t=this.getTensorFromAudioDataArray(a,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let a=this.flattenQueue(r.timeDataQueue);n=this.getTensorFromAudioDataArray(a,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let t=[],n=[],r=0;return new Promise(a=>{let s=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&a({freqDataQueue:t,timeDataQueue:n}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++r===this.numFrames&&(clearInterval(s),a({freqDataQueue:t,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){let n=t[0].length,r=new Float32Array(t.length*n);return t.forEach((a,s)=>r.set(a,s*n)),r}getTensorFromAudioDataArray(t,n){let r=new Float32Array(j.sizeFromShape(n));return r.set(t,r.length-t.length),va(r,n)}},fPe=class C9 extends Fr{constructor(t,n){if(super(),this.webcamVideoElement=t,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=cn([0],"int32"),this.webcamConfig.centerCrop){let r=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,a=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,s=(1-r)/2,i=(1-a)/2,o=s+r,l=a+i;this.cropBox=So([i,s,l,o],[1,4])}else this.cropBox=So([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,n={}){if(!le().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}let r=new C9(t,n);return await r.start(),r}async start(){this.webcamConfig.facingMode&&j.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=Db.fromPixels(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{t.dispose()}else return{value:t,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return te(()=>{let n=$r(Se(t,"float32"),0),r;r=$s.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let a=r.shape;return ee(r,a.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},I9=class{},E9=class extends Fr{split(e){return new mPe(this,e)}},mPe=class extends E9{constructor(e,t){super(),this.upstream=e,this.impl=new gPe(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},gPe=class extends ED{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){let e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let n of t.slice(0,-1))this.outputQueue.push(n);return this.carryover=t[t.length-1],!0}},yPe=class extends Fr{decodeUTF8(){return new xPe(this)}},xPe=class extends E9{constructor(e){super(),this.upstream=e,this.impl=new vPe(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},vPe=class extends ED{constructor(e){if(super(),this.upstream=e,le().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:t}=MG();this.decoder=new t("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){let e=await this.upstream.next(),t;if(e.done)return!1;t=e.value;let n;return le().get("IS_BROWSER")?n=this.decoder.decode(t,{stream:!0}):n=this.decoder.write(Buffer.from(t.buffer)),this.outputQueue.push(n),!0}},T9=class extends yPe{constructor(e,t={}){super(),this.file=e,this.options=t,j.assert(e instanceof Uint8Array||(le().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let r=new FileReader;r.onload=s=>{let i=r.result;if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),!(i instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(i)},r.onabort=s=>t(new Error("Aborted")),r.onerror=s=>t(new Error(s.type));let a=this.file.slice(this.offset,n);r.readAsArrayBuffer(a)}this.offset=n}),done:!1}}};async function bPe(e,t={},n){let r,a;typeof e=="string"?r=e:(r=e.url,a=wPe(e));let s=await(0,j.fetch)(r,a);if(s.ok){let i=new Uint8Array(await s.arrayBuffer());return new T9(i,t)}else throw new Error(s.statusText)}var wPe=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function j9(e){return typeof e=="string"&&e.slice(0,7)==="file://"}var A9=class extends I9{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(j9(this.input)&&le().get("IS_NODE")){let e=vA();this.input=e.readFileSync(this.input.slice(7))}return new T9(this.input,this.options)}},$9=class extends I9{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return j9(this.url)?new A9(this.url,this.fileOptions).iterator():bPe(this.url,this.fileOptions)}};function NPe(e,t={}){return new S9(new $9(e),t)}function kPe(e){let t=ID(e);return ts(async()=>t)}function SPe(e){return ts(async()=>{let t=await e();return ID(()=>t.next())})}async function _Pe(e,t){return fPe.create(e,t)}async function CPe(e){return pPe.create(e)}var IPe="4.22.0";function Xe(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&j.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var EPe=Bo.whereImpl,TD=class R9 extends Gv{nextDataId(){return R9.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new _k(this,Ys())}write(t,n,r){this.firstUse&&(this.firstUse=!1,le().get("IS_NODE")&&P.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let a={id:this.nextDataId()};return this.data.set(a,{values:t,dtype:r,refCount:1}),a}makeTensorInfo(t,n,r){let a;if(n==="string"&&r!=null&&r.length>0&&j.isString(r[0])){let s=r.map(i=>j.encodeString(i));a=this.write(s,t,n)}else a=this.write(r,t,n);return{dataId:a,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){let n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){let n=this.data.get(t);n.refCount--}}move(t,n,r,a,s){this.data.set(t,{values:n,dtype:a,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){let{dtype:n,complexTensorInfos:r}=this.data.get(t);if(n==="complex64"){let a=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return P.mergeRealAndImagArrays(a,s)}return j.convertBackendValuesAndArrayBuffer(this.data.get(t).values,n)}bufferSync(t){let n=this.readSync(t.dataId);if(t.dtype==="string")try{let r=n.map(a=>j.decodeString(a));return jt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return jt(t.shape,t.dtype,n)}makeOutput(t,n,r){return Ys().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;let{complexTensorInfos:r}=this.data.get(t);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){let n=j.now();return t(),{kernelMs:j.now()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Xe([t],"where");let n=this.readSync(t.dataId);return EPe(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};TD.nextDataId=0;var jD={};gt(jD,{addImpl:()=>O9,bincountImpl:()=>$D,bincountReduceImpl:()=>F9,bitwiseAndImpl:()=>P9,castImpl:()=>M9,ceilImpl:()=>L9,concatImpl:()=>RD,equalImpl:()=>z9,expImpl:()=>U9,expm1Impl:()=>V9,floorDivImpl:()=>G9,floorImpl:()=>H9,gatherNdImpl:()=>q9,gatherV2Impl:()=>K9,greaterEqualImpl:()=>X9,greaterImpl:()=>Q9,lessEqualImpl:()=>J9,lessImpl:()=>Y9,linSpaceImpl:()=>Z9,logImpl:()=>eQ,maxImpl:()=>tQ,maximumImpl:()=>nQ,minimumImpl:()=>rQ,multiplyImpl:()=>DD,negImpl:()=>aQ,notEqualImpl:()=>sQ,prodImpl:()=>iQ,raggedGatherImpl:()=>oQ,raggedRangeImpl:()=>lQ,raggedTensorToTensorImpl:()=>uQ,rangeImpl:()=>OD,rsqrtImpl:()=>cQ,scatterImpl:()=>Zc,sigmoidImpl:()=>ILe,simpleAbsImpl:()=>D9,sliceImpl:()=>Y1,sparseFillEmptyRowsImpl:()=>hQ,sparseReshapeImpl:()=>pQ,sparseSegmentReductionImpl:()=>FD,sqrtImpl:()=>jLe,squaredDifferenceImpl:()=>fQ,staticRegexReplaceImpl:()=>mQ,stridedSliceImpl:()=>gQ,stringNGramsImpl:()=>PD,stringSplitImpl:()=>LD,stringToHashBucketFastImpl:()=>zD,subImpl:()=>yQ,tileImpl:()=>xQ,topKImpl:()=>bQ,transposeImpl:()=>MD,uniqueImpl:()=>UD});function D9(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var TPe=e=>{let{x:t}=e.inputs,n=e.backend;Xe(t,"abs");let r=new Float32Array(j.sizeFromShape(t.shape)),a=n.data.get(t.dataId).values;return r=D9(a),n.makeOutput(r,t.shape,t.dtype)},jPe={kernelName:Km,backendName:"cpu",kernelFunc:TPe};function ir(e){return(t,n,r,a,s)=>{let i=P.assertAndGetBroadcastShape(t,n),o=i.length,l=j.computeStrides(i),c=j.sizeFromShape(i),u=j.getTypedArrayFromDType(s,c),h=t.length,p=n.length,f=j.computeStrides(t),g=j.computeStrides(n),m=P.getBroadcastDims(t,i),y=P.getBroadcastDims(n,i);if(m.length+y.length===0)for(let x=0;x<u.length;++x)u[x]=e(r[x%r.length],a[x%a.length]);else for(let x=0;x<u.length;++x){let v=j.indexToLoc(x,o,l),b=v.slice(-h);m.forEach(C=>b[C]=0);let w=j.locToIndex(b,h,f),k=v.slice(-p);y.forEach(C=>k[C]=0);let I=j.locToIndex(k,p,g);u[x]=e(r[w],a[I])}return[u,i]}}function os(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,s=n.data.get(r.dataId).values,i=n.data.get(a.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(a.shape,"float32",i)},o}var APe={kernelName:Ek,backendName:"cpu",kernelFunc:os};function X1(e,t,n="float32"){if(n==="complex64"){let a=X1(e,t,"float32"),s=X1(e,t,"float32");return os({inputs:{real:a,imag:s},backend:e})}let r=j.makeZerosTypedArray(j.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}function Mo(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var $Pe={kernelName:Oh,backendName:"cpu",kernelFunc:Mo};function Hd(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,s)}var RPe={kernelName:zk,backendName:"cpu",kernelFunc:Hd};function M9(e,t,n,r){if(r==="int32"){let a=Int32Array.from(e);return[t,"int32",a]}if(r==="bool"){let a=j.toTypedArray([0],n),[s,i]=ir((o,l)=>o!==l?1:0)(t,[],e,a,"bool");return[i,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function tc(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:s}=r;if(s==="complex64"){if(a.dtype==="complex64")return Mo({inputs:{x:a},backend:n});let u=X1(n,a.shape,a.dtype),h=tc({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),p=os({inputs:{real:h,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),p}if(a.dtype==="complex64"){let u=Hd({inputs:{input:a},backend:n}),h=tc({inputs:{x:u},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(u),h}if(!j.hasEncodingLoss(a.dtype,s)){let u=Mo({inputs:{x:a},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:s}}let i=n.data.get(a.dataId).values,[o,l,c]=M9(i,a.shape,a.dtype,s);return n.makeTensorInfo(o,l,c)}var DPe={kernelName:yh,backendName:"cpu",kernelFunc:tc};function Sr(e,t,n,r){return n==null?({inputs:a,backend:s})=>{let{a:i,b:o}=a,l=s;Xe([i,o],e);let c=l.data.get(i.dataId).values,u=l.data.get(o.dataId).values,h=i.dtype==="string"?P.fromUint8ToStringArray(c):c,p=i.dtype==="string"?P.fromUint8ToStringArray(u):u,f=r||i.dtype,[g,m]=t(i.shape,o.shape,h,p,f);return l.makeTensorInfo(m,f,g)}:({inputs:a,backend:s})=>{let{a:i,b:o}=a,l=s;if(i.dtype==="complex64"||o.dtype==="complex64"){let c=tc({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,p=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,g=l.data.get(p.dataId).values,m=tc({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(m.dataId),x=y.complexTensorInfos.real,v=y.complexTensorInfos.imag,b=l.data.get(x.dataId).values,w=l.data.get(v.dataId).values,[k,I,C]=n(i.shape,o.shape,f,g,b,w),S=l.makeTensorInfo(C,"float32",k),E=l.makeTensorInfo(C,"float32",I),T=os({inputs:{real:S,imag:E},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(S),l.disposeIntermediateTensorInfo(E),T}else{let c=l.data.get(i.dataId).values,u=l.data.get(o.dataId).values,h=r||i.dtype,[p,f]=t(i.shape,o.shape,c,u,h);return l.makeTensorInfo(f,h,p)}}}function AD(e){return(t,n,r,a,s,i)=>{let o=P.assertAndGetBroadcastShape(t,n),l=j.sizeFromShape(o),c=o.length,u=j.computeStrides(o),h=j.getTypedArrayFromDType("float32",l),p=j.getTypedArrayFromDType("float32",l),f=P.getBroadcastDims(t,o),g=P.getBroadcastDims(n,o),m=P.mergeRealAndImagArrays(r,a),y=P.mergeRealAndImagArrays(s,i),x=t.length,v=j.computeStrides(t),b=n.length,w=j.computeStrides(n);if(f.length+g.length===0)for(let k=0;k<h.length;k++){let I=k%m.length,C=k%y.length,S=e(m[I*2],m[I*2+1],y[C*2],y[C*2+1]);h[k]=S.real,p[k]=S.imag}else for(let k=0;k<h.length;k++){let I=j.indexToLoc(k,c,u),C=I.slice(-x);f.forEach(_=>C[_]=0);let S=j.locToIndex(C,x,v),E=I.slice(-b);g.forEach(_=>E[_]=0);let T=j.locToIndex(E,b,w),$=e(m[S*2],m[S*2+1],y[T*2],y[T*2+1]);h[k]=$.real,p[k]=$.imag}return[h,p,o]}}var O9=ir((e,t)=>e+t),MPe=AD((e,t,n,r)=>({real:e+n,imag:t+r})),Nm=Sr(mc,O9,MPe),OPe={kernelName:mc,backendName:"cpu",kernelFunc:Nm};function $D(e,t,n,r,a){let s=j.sizeFromShape(r),i=j.makeZerosTypedArray(a,n);for(let o=0;o<e.length;o++){let l=e[o];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(s>0?i[l]+=t[o]:i[l]+=1)}return i}function F9(e,t,n,r=!1){let a=e.shape[0],s=e.shape[1],i=jt([a,n],t.dtype);for(let o=0;o<a;o++)for(let l=0;l<s;l++){let c=e.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?i.set(1,o,c):t.size>0?i.set(i.get(o,c)+t.get(o,l),o,c):i.set(i.get(o,c)+1,o,c))}return i}var P9=ir((e,t)=>e&t),FPe=Sr(ng,P9),PPe={kernelName:ng,backendName:"cpu",kernelFunc:FPe};function Uo(e){return(t,n,r)=>{let a=j.getArrayFromDType(n,t.length);for(let s=0;s<t.length;++s)a[s]=e(t[s],r);return a}}function mn(e,t,n){let r=Uo(t);return Sc(e,r,n)}function Sc(e,t,n){return({inputs:r,attrs:a,backend:s})=>{let{x:i}=r;Xe(i,e);let o=s,l=o.data.get(i.dataId).values,c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=P.fromUint8ToStringArray(l)}else c=l;let u=n||i.dtype,h=t(c,u,a);return o.makeTensorInfo(i.shape,u,h)}}var L9=Uo(e=>Math.ceil(e)),LPe=Sc(xh,L9),zPe={kernelName:xh,backendName:"cpu",kernelFunc:LPe};function RD(e,t,n,r){let a=j.getArrayFromDType(n,j.sizeFromShape(t));if(r&&n!=="string"){let s=0;e.forEach(i=>{let o=j.sizeFromShape(i.shape);a.set(i.vals,s),s+=o})}else{let s=0;e.forEach(i=>{let o=n==="string"?P.fromUint8ToStringArray(i.vals):i.vals,l=0;for(let c=0;c<i.shape[0];++c){let u=c*t[1]+s;for(let h=0;h<i.shape[1];++h)a[u+h]=o[l++]}s+=i.shape[1]})}return a}var z9=ir((e,t)=>e===t?1:0),B9=Sr(cg,z9,null,"bool"),BPe={kernelName:cg,backendName:"cpu",kernelFunc:B9},U9=Uo(e=>Math.exp(e)),W9=Sc(jh,U9,"float32"),UPe={kernelName:jh,backendName:"cpu",kernelFunc:W9},V9=Uo(e=>Math.expm1(e)),WPe=Sc(Ah,V9),VPe={kernelName:Ah,backendName:"cpu",kernelFunc:WPe},H9=Uo(e=>Math.floor(e)),HPe=Sc($h,H9),GPe={kernelName:$h,backendName:"cpu",kernelFunc:HPe},G9=ir((e,t)=>Math.floor(e/t)),qPe=Sr(Rh,G9,null,"int32"),KPe={kernelName:Rh,backendName:"cpu",kernelFunc:qPe};function q9(e,t,n,r,a,s,i,o,l){let c=jt([r,s],n);for(let u=0;u<r;u++){let h=[],p=0;for(let f=0;f<a;f++){let g=e[u*a+f];p+=g*i[f],h.push(g)}if(p<0||p>=l/s)throw new Error(`Invalid indices: ${h} does not index into ${o}`);for(let f=0;f<s;f++)c.values[u*s+f]=t.get(...t.indexToLoc(p*s+f))}return c}function K9(e,t,n){let r=jt(n,e.dtype);for(let a=0;a<r.size;++a){let s=r.indexToLoc(a).slice(),i=s[0],o=s[2],l=t.locToIndex([i,o]);s[2]=t.values[l];let c=e.locToIndex(s);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var Q9=ir((e,t)=>e>t?1:0),QPe=Sr(mg,Q9,null,"bool"),XPe={kernelName:mg,backendName:"cpu",kernelFunc:QPe},X9=ir((e,t)=>e>=t?1:0),YPe=Sr(Mh,X9,null,"bool"),JPe={kernelName:Mh,backendName:"cpu",kernelFunc:YPe},Y9=ir((e,t)=>e<t?1:0),ZPe=Sr(gg,Y9,null,"bool"),eLe={kernelName:gg,backendName:"cpu",kernelFunc:ZPe},J9=ir((e,t)=>e<=t?1:0),tLe=Sr(yg,J9,null,"bool"),nLe={kernelName:yg,backendName:"cpu",kernelFunc:tLe};function Z9(e,t,n){let r=(t-e)/(n-1),a=j.makeZerosTypedArray(n,"float32");a[0]=e;for(let s=1;s<a.length;s++)a[s]=a[s-1]+r;return a}var eQ=Uo(e=>Math.log(e)),rLe=Sc(Bh,eQ),aLe={kernelName:Bh,backendName:"cpu",kernelFunc:rLe};function tQ(e,t,n,r){let a=j.getTypedArrayFromDType(r,j.sizeFromShape(n));for(let s=0;s<a.length;++s){let i=s*t,o=e[i];for(let l=0;l<t;++l){let c=e[i+l];(Number.isNaN(c)||c>o)&&(o=c)}a[s]=o}return a}var nQ=ir((e,t)=>Math.max(e,t)),sLe=Sr(Hh,nQ),iLe={kernelName:Hh,backendName:"cpu",kernelFunc:sLe},rQ=ir((e,t)=>Math.min(e,t)),oLe=Sr(Qh,rQ),lLe={kernelName:Qh,backendName:"cpu",kernelFunc:oLe},DD=ir((e,t)=>e*t),uLe=AD((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),GS=Sr(Jh,DD,uLe),cLe={kernelName:Jh,backendName:"cpu",kernelFunc:GS};function aQ(e,t,n){let r=j.createScalarValue(-1,n);return DD([],t,r,e,n)}function dLe(e){let{inputs:t,backend:n}=e,{x:r}=t;Xe(r,"neg");let a=n.data.get(r.dataId).values,[s,i]=aQ(a,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,s)}var hLe={kernelName:_g,backendName:"cpu",kernelFunc:dLe},sQ=ir((e,t)=>e!==t?1:0),pLe=Sr(Cg,sQ,null,"bool"),fLe={kernelName:Cg,backendName:"cpu",kernelFunc:pLe};function MD(e,t,n,r,a){let s=t.length,i=j.sizeFromShape(t),o=j.computeStrides(t),l=j.computeStrides(a),c=j.getTypedArrayFromDType(n,j.sizeFromShape(a));for(let u=0;u<i;++u){let h=j.indexToLoc(u,s,o),p=new Array(h.length);for(let g=0;g<p.length;g++)p[g]=h[r[g]];let f=j.locToIndex(p,s,l);c[f]=e[u]}return c}function Va(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{perm:s}=n;Xe(a,"transpose");let i=a.shape.length,o=new Array(i);for(let u=0;u<o.length;u++)o[u]=a.shape[s[u]];let l=r.data.get(a.dataId).values,c=MD(l,a.shape,a.dtype,s,o);return{dataId:r.write(c,o,a.dtype),shape:o,dtype:a.dtype}}var mLe={kernelName:dl,backendName:"cpu",kernelFunc:Va};function iQ(e,t,n,r){let[a,s]=P.computeOutAndReduceShapes(e,r),i=Bs(t,"int32"),o=j.makeZerosTypedArray(j.sizeFromShape(a),i),l=j.sizeFromShape(s);for(let c=0;c<o.length;++c){let u=c*l,h=1;for(let p=0;p<l;++p)h*=n[u+p];o[c]=h}return{outVals:o,outShape:a,outDtype:i}}function gLe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r;Xe(a,"prod");let o=a.shape.length,l=j.parseAxisParam(s,a.shape),c=P.getAxesPermutation(l,o),u=l,h=a,p=[];c!=null&&(h=Va({inputs:{x:a},backend:n,attrs:{perm:c}}),p.push(h),u=P.getInnerMostAxes(u.length,o));let f=n.data.get(h.dataId).values,{outVals:g,outShape:m,outDtype:y}=iQ(h.shape,h.dtype,f,u),x=m;return i&&(x=P.expandShapeToKeepDim(m,l)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(x,y,g)}var yLe={kernelName:rp,backendName:"cpu",kernelFunc:gLe};function xLe(e,t,n){e.forEach((r,a)=>{if(r<0||r>=n){let s=j.indexToLoc(a,t.length,j.computeStrides(t)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function vLe(e,t){for(let n=0;n<e.length;++n){let r=e[n],a=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function bLe(e,t,n,r){let a=[],s=0,i=t.length-1+n.length,o=new Array(i).fill(null).map(()=>[0]);vLe(n,r);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];let u=t[c+1];for(let h=1;h<l+1;++h)o[c].push(h*u)}for(let c=0;c<e.length;++c){let u=e[c],h=e[c]+1;for(let p=0;p<n.length;++p){let f=n[p],g=p+t.length-1;if(g>=0){let m=o[g],y=m[m.length-1]-f[u];for(let x=u;x<h;++x)o[g].push(f[x+1]+y)}u=f[u],h=f[h]}h!==u&&(a.push([u,h]),s+=h-u)}return{outSplits:o,valueSlices:a,numValues:s}}function wLe(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,a=j.getArrayFromDType("int32",r);t.push(a),e[n].forEach((s,i)=>a[i]=s)}return t}function o3(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function NLe(e,t,n,r,a,s){let i=o3(t,2)[1],o=o3(s,2)[1],l=0;for(let c of n)for(let u=c[0];u<c[1];++u){for(let h=0;h<r;++h)a[l*o+h]=e[u*i+h];++l}}function kLe(e,t,n,r,a){let s=t.slice();s[0]=a;let i=j.getArrayFromDType(n,j.sizeFromShape(s)),o=e.length,l=o===0?0:o/t[0];return NLe(e,t,r,l,i,s),[i,s]}function oQ(e,t,n,r,a,s,i,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");let l=t[0][0]-1;if(xLe(s,i,l),r.length===0)throw new Error("params.rank must be nonzero");let c=r[0],{outSplits:u,valueSlices:h,numValues:p}=bLe(s,i,e,c),f=wLe(u),g=kLe(n,r,a,h,p);return[f,g[0],g[1]]}var l3=2147483647;function lQ(e,t,n,r,a,s,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");let o=t.length===0,l=a.length===0,c=i.length===0,u=[];o||u.push(t[0]),l||u.push(a[0]),c||u.push(i[0]);for(let y=1;y<u.length;++y)if(u[y]!==u[y-1])throw new Error("starts, limits, and deltas must have the same shape");let h=u.length===0?1:u[0],p=j.getArrayFromDType("int32",h+1);p[0]=0;for(let y=0;y<h;++y){let x=o?e[0]:e[y],v=l?r[0]:r[y],b=c?s[0]:s[y];if(b===0)throw new Error("Requires delta != 0");let w;if(b>0&&v<x||b<0&&v>x)w=0;else if(w=Math.ceil(Math.abs((v-x)/b)),w>l3)throw new Error(`Requires ((limit - start) / delta) <= ${l3}`);p[y+1]=p[y]+w}let f=p[h],g=j.getArrayFromDType(n,f),m=0;for(let y=0;y<h;++y){let x=p[y+1]-p[y],v=o?e[0]:e[y],b=c?s[0]:s[y];for(let w=0;w<x;++w)g[m++]=v,v+=b}return[p,g]}var Qs=P.RowPartitionType,SLe=class _E{constructor(t,n,r,a,s,i,o,l,c,u){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=s,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=P.getRowPartitionTypesHelper(u),this.raggedRank=P.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===Qs.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===Qs.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){let n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case Qs.VALUE_ROWIDS:return _E.getMaxWidthValueRowID(n);case Qs.ROW_SPLITS:return _E.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Qs[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){let n=t.length;if(n===0||n===1)return 0;let r=0;for(let a=0;a<n-1;++a){let s=t[a+1]-t[a];s>r&&(r=s)}return r}static getMaxWidthValueRowID(t){let n=t.length;if(n===0)return 0;let r=0,a=t[0],s=0;for(let i=1;i<n;++i){let o=t[i];o!==a&&(a=o,s=Math.max(i-r,s),r=i)}return Math.max(n-r,s)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return c3(t,r)}calculateOutputSize(t){let n=this.valuesShape,r=this.defaultValueShape;P.validateDefaultValueShape(r,n);let a=this.tensorShapeFromTensor(this.shape,this.shapeShape),s=P.combineRaggedTensorToTensorShapes(this.raggedRank,a,n);s[0]<0&&(s[0]=t);for(let i=1;i<=this.raggedRank;++i)s[i]<0&&(s[i]=this.getMaxWidth(i));return s}calculateFirstParentOutputIndex(t,n,r){let a=Math.min(t,r),s=[],i=0;for(let o=0;o<a;++o,i+=n)s.push(i);for(let o=a;o<t;++o)s.push(-1);return j.assert(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,n,r,a){let s=t.length,i=[];for(let o=0;o<s-1;++o){let l=t[o+1]-t[o],c=Math.min(a,l),u=n[o];u===-1&&(c=0);for(let h=0;h<c;++h)i.push(u),u+=r;for(let h=0;h<l-c;++h)i.push(-1)}if(s>0&&i.length!==t[s-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(t,n,r,a){let s=t.length,i=[];if(s===0)return[];let o=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let u=1;u<s;++u){let h=t[u];if(h===l)c>=0&&(++o,o<a?c+=r:c=-1);else{if(o=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);c=n[h]}i.push(c)}if(i.length!==t.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(t,n,r,a){let s=this.getRowPartitionTensor(t),i=this.getRowPartitionTypeByDimension(t);switch(i){case Qs.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,a);case Qs.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,a);default:throw new Error(`Unsupported partition type: ${Qs[i]}`)}}getFirstDimensionSize(){let t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let n=this.rowPartitionTypes[0];switch(n){case Qs.FIRST_DIM_SIZE:return t[0];case Qs.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Qs.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Qs[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let t=this.getFirstDimensionSize(),n=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let i=r.length-2;i>=0;--i)r[i]=r[i+1]*n[i+1];let a=c3(n,!1),s=j.getArrayFromDType(this.valuesDType,j.sizeFromShape(a));if(r[0]*n[0]>0){let i=this.calculateFirstParentOutputIndex(t,r[0],n[0]);for(let o=1;o<=this.raggedRank;++o)i=this.calculateOutputIndex(o-1,i,r[o],n[o]);this.setOutput(this.raggedRank,i,s,a)}return[a,s]}setOutput(t,n,r,a){if(r.length===0)return;let s=this.values,i=r,o=a.slice();o=o.slice(t+1);let l=j.sizeFromShape(o),c=n.length,u=this.defaultValue;if(u.length!==l&&u.length!==1){let g=this.defaultValueShape;te(()=>{let m=ee(u,g);u=fd(m,o).dataSync()})}let h=0,p=0,f=0;for(let g=0;g<=c;++g){let m=g<c?n[g]:-1;if(m===f){++f;continue}if(p<f){let y=s.subarray(h*l),x=i.subarray(p*l),v=(f-p)*l;u3(x,y,v)}if(g>=c){let y=r.length;m=Math.floor(y/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){let y=i.slice(f*l);u3(y,u,l),++f}m<0?(h=g+1,p=f):(h=g,p=f,f=p+1)}}};function u3(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function c3(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function uQ(e,t,n,r,a,s,i,o,l,c){return new SLe(e,t,n,r,a,s,i,o,l,c).compute()}function OD(e,t,n,r){let a=e===t,s=e<t&&n<0,i=t<e&&n>1;if(a||s||i)return j.makeZerosTypedArray(0,r);let o=Math.abs(Math.ceil((t-e)/n)),l=j.makeZerosTypedArray(o,r);t<e&&n===1&&(n=-1),l[0]=e;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}var cQ=Uo(e=>1/Math.sqrt(e)),_Le=Sc(dp,cQ),CLe={kernelName:dp,backendName:"cpu",kernelFunc:_Le};function Zc(e,t,n,r,a,s,i,o,l,c){let u=[r/a,a],h=e.values,p=t.values;if(r===0)return jt(n,t.dtype);let f=l instanceof hr?l:jt(u,t.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let g=0;g<s;g++){let m=[],y=0;for(let x=0;x<i;x++){let v=h[g*i+x];m.push(v),y+=v*o[x]}if(y<0||y>=r/a)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let x=0;x<a;x++)c?f.values[y*a+x]+=p[g*a+x]:f.values[y*a+x]=t.rank===0?p[0]:p[g*a+x]}return f}var ILe=Uo(e=>1/(1+Math.exp(-e))),dQ=mn(gp,e=>1/(1+Math.exp(-e))),ELe={kernelName:gp,backendName:"cpu",kernelFunc:dQ};function Y1(e,t,n,r,a){let s=wr.isSliceContinous(r,t,n),i=j.sizeFromShape(n),o=j.computeStrides(r);if(s){let h=wr.computeFlatOffset(t,o);return a==="string"?e.slice(h,h+i):e.subarray(h,h+i)}let l=a==="string"?P.fromUint8ToStringArray(e):e,c=jt(r,a,l),u=jt(n,a);for(let h=0;h<u.size;++h){let p=u.indexToLoc(h),f=p.map((g,m)=>g+t[m]);u.set(c.get(...f),...p)}return a==="string"?P.fromStringArrayToUint8(u.values):u.values}function Gd(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:s,size:i}=r;Xe(a,"slice");let[o,l]=wr.parseSliceParams(a,s,i);wr.assertParamsValid(a,o,l);let c=n.data.get(a.dataId).values,u=Y1(c,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,u)}var TLe={kernelName:Lg,backendName:"cpu",kernelFunc:Gd};function hQ(e,t,n,r,a,s,i){let o=t[0],l=s[0],c=new Array(l),u=new Array(o),h=t[1];if(l===0){if(o!==0)throw new Error(P.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));let y=j.getArrayFromDType(n,0),x=j.getArrayFromDType(a,0);return[y,[0,h],x,c,u]}let p=!0,f=0,g=new Array(l).fill(0);for(let y=0;y<o;++y){let x=e[y*h];if(x<0)throw new Error(P.getSparseFillEmptyRowsNegativeIndexErrorMessage(y,x));if(x>=l)throw new Error(P.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(y,x,l));++g[x],p=p&&x>=f,f=x}let m=!0;for(let y=0;y<l;++y){let x=g[y]===0;c[y]=x,m=m&&!x,g[y]=Math.max(g[y],1),y>0&&(g[y]+=g[y-1])}if(m&&p){let y=e,x=r;for(let v=0;v<o;++v)u[v]=v;return[y,[o,h],x,c,u]}else{let y=g[l-1],x=j.getArrayFromDType(n,y*h),v=j.getArrayFromDType(a,y),b=new Array(l).fill(0);for(let w=0;w<o;++w){let k=e[w*h],I=b[k],C=(k===0?0:g[k-1])+I;b[k]++;for(let S=0;S<h;++S)x[C*h+S]=e[w*h+S];v[C]=r[w],u[w]=C}for(let w=0;w<l;++w)if(b[w]===0){let k=w===0?0:g[w-1];x[k*h+0]=w;for(let I=1;I<h;++I)x[k*h+I]=0;v[k]=i}return[x,[y,h],v,c,u]}}function pQ(e,t,n,r,a){let s=j.sizeFromShape(r),i=t[0],o=a.length,l=[],c=1,u=-1;for(let m=0;m<o;++m){let y=a[m];if(y===-1){if(u!==-1)throw new Error(P.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(u,m));u=m,l.push(1)}else{if(y<0)throw new Error(P.getSparseReshapeNegativeOutputDimErrorMessage(m,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(P.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let m=Math.trunc(s/c);if(c*m!==s)throw new Error(P.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[u]=m}if(j.sizeFromShape(l)!==s)throw new Error(P.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let h=r.length,p=[];if(h>0){p[h-1]=1;for(let m=h-2;m>=0;--m)p[m]=p[m+1]*r[m+1]}let f=[];if(o>0){f[o-1]=1;for(let m=o-2;m>=0;--m)f[m]=f[m+1]*l[m+1]}let g=j.getArrayFromDType(n,i*o);for(let m=0;m<i;++m){let y=0;for(let x=0;x<h;++x)y+=e[m*h+x]*p[x];for(let x=0;x<o;++x)g[m*o+x]=Math.trunc(y/f[x]),y%=f[x]}return[g,[i,o],l]}function FD(e,t,n,r,a,s=!1,i=0){let o=r.length,l=[t[0],e.length/t[0]],c=l[1],u=o>0?a[o-1]+1:0;if(u<0)throw new Error(P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let h=t.slice();h[0]=u;let p=h.reduce((v,b)=>v*b,1),f=j.getArrayFromDType(n,p);if(o===0)return u>0&&f.fill(i),[f,h];if(u<=0)throw new Error(P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let g=0,m=1,y=0,x=a[g];for(;;){let v=0;if(m<o){if(v=a[m],x===v){++m;continue}if(x>=v)throw new Error(P.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(x<0||x>=u)throw new Error(P.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(x,u));x>y&&f.fill(i,y*c,x*c);for(let b=g;b<m;++b){let w=r[b];if(w<0||w>=l[0])throw new Error(P.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(b,r[b],l[0]));for(let k=0;k<c;k++)f[x*c+k]+=e[w*c+k]}if(s)for(let b=0;b<c;b++)f[x*c+b]/=m-g;if(g=m,++m,y=x+1,x=v,m>o)break}return y<u&&f.fill(i,y*c,u*c),[f,h]}var jLe=Uo(e=>Math.sqrt(e)),ALe=mn(xp,e=>Math.sqrt(e)),$Le={kernelName:xp,backendName:"cpu",kernelFunc:ALe},fQ=ir((e,t)=>{let n=e-t;return n*n}),RLe=Sr(wp,fQ),DLe={kernelName:wp,backendName:"cpu",kernelFunc:RLe},mQ=Uo((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:a}=t;return e.replace(new RegExp(n,r?"g":""),a)}),MLe=Sc(ub,mQ),OLe={kernelName:ub,backendName:"cpu",kernelFunc:MLe};function gQ(e,t,n,r){let a=jt(e,t.dtype);for(let s=0;s<a.size;s++){let i=a.indexToLoc(s),o=new Array(i.length);for(let l=0;l<o.length;l++)o[l]=i[l]*n[l]+r[l];a.set(t.get(...o),...i)}return a}var FLe=class{constructor(e,t,n,r,a,s){this.separator=j.encodeString(e),this.nGramWidths=t,this.leftPad=j.encodeString(n),this.rightPad=j.encodeString(r),this.padWidth=a,this.preserveShort=s}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,s){for(let i=0;i<a;++i){let o=this.getPadWidth(s),l=Math.max(0,o-i),c=Math.max(0,o-(a-(i+1))),u=s-(l+c),h=t+(l>0?0:i-o),p=0;p+=l*this.leftPad.length;for(let x=0;x<u;++x)p+=e[h+x].length;p+=c*this.rightPad.length;let f=l+c+u-1;p+=f*this.separator.length,n[r+i]=new Uint8Array(p);let g=n[r+i],m=0,y=x=>x.forEach(v=>g[m++]=v);for(let x=0;x<l;++x)y(this.leftPad),y(this.separator);for(let x=0;x<u-1;++x)y(e[h+x]),y(this.separator);if(u>0){y(e[h+u-1]);for(let x=0;x<c;++x)y(this.separator),y(this.rightPad)}else{for(let x=0;x<c-1;++x)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,t){let n=e.length,r=t.length;if(r>0){let o=t[0];if(o!==0)throw new Error(`First split value must be 0, got ${o}`);for(let l=1;l<r;++l){let c=t[l]>=o;if(c=c&&t[l]<=n,!c)throw new Error(`Invalid split value ${t[l]}, must be in [${o}, ${n}]`);o=t[l]}if(o!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${o}`)}let a=r-1,s=j.getArrayFromDType("int32",r);if(n===0||r===0){let o=new Array(n);for(let l=0;l<=a;++l)s[l]=0;return[o,s]}s[0]=0;for(let o=1;o<=a;++o){let l=t[o]-t[o-1],c=0;this.nGramWidths.forEach(u=>{c+=this.getNumNGrams(l,u)}),this.preserveShort&&l>0&&c===0&&(c=1),s[o]=s[o-1]+c}let i=new Array(s[a]);for(let o=0;o<a;++o){let l=t[o],c=s[o];if(this.nGramWidths.forEach(u=>{let h=t[o+1]-t[o],p=this.getNumNGrams(h,u);this.createNGrams(e,l,i,c,p,u),c+=p}),this.preserveShort&&c===s[o]){let u=t[o+1]-t[o];if(u===0)continue;let h=u+2*this.padWidth;this.createNGrams(e,l,i,c,1,h)}}return[i,s]}};function PD(e,t,n,r,a,s,i,o){return new FLe(n,r,a,s,i,o).compute(e,t)}function PLe(e,t,n,r){if(!e.length)return;if(t.length===0){for(let s=0;s<e.length;++s)r.push(e.subarray(s,s+1));return}if(t.length===1){let s=t[0],i=e.indexOf(s);for(;i!==-1;){let o=e.subarray(0,i);(!n||o.length!==0)&&r.push(o),e=e.subarray(i+1),i=e.indexOf(s)}(!n||e.length!==0)&&r.push(e);return}let a=0;for(let s=0;s<e.length+1;s++)if(s===e.length||t.indexOf(e[s])!==-1){let i=e.subarray(a,s);(!n||i.length!==0)&&r.push(i),a=s+1}}function LD(e,t,n){let r=e.length,a=[],s=0,i=0,o=new Array(r);for(let p=0;p<r;++p){let f=a.length;PLe(e[p],t,n,a);let g=a.length-f;o[p]=g,s+=g,i=Math.max(i,g)}let l=j.getArrayFromDType("int32",s*2),c=new Array(s),u=[r,i],h=0;for(let p=0;p<r;++p)for(let f=0;f<o[p];++f)l[h*2]=p,l[h*2+1]=f,c[h]=a[h],++h;return[l,c,u]}function zD(e,t){let n=j.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=j.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var yQ=ir((e,t)=>e-t),LLe=AD((e,t,n,r)=>({real:e-n,imag:t-r})),BD=Sr(Np,yQ,LLe),zLe={kernelName:Np,backendName:"cpu",kernelFunc:BD};function xQ(e,t){let n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];let r=jt(n,e.dtype);for(let a=0;a<r.values.length;++a){let s=r.indexToLoc(a),i=new Array(e.rank);for(let l=0;l<i.length;l++)i[l]=s[l]%e.shape[l];let o=e.locToIndex(i);r.values[a]=e.values[o]}return r}var Yy=(e,t)=>{let n=t.value-e.value;return n===0?e.index-t.index:n};function vQ(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){let o=r-n+1,l=t-n+1,c=Math.log(o),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(o-u)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(t-l*u/o+h)),f=Math.min(r,Math.floor(t+(o-l)*u/o+h));vQ(e,t,p,f)}let a=e[t],s=n,i=r;for(j.swap(e,n,t),Yy(e[r],a)>0&&j.swap(e,n,r);s<i;){for(j.swap(e,s,i),s++,i--;Yy(e[s],a)<0;)s=s+1;for(;Yy(e[i],a)>0;)i=i-1}Yy(e[n],a)===0?j.swap(e,n,i):(i=i+1,j.swap(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}}function bQ(e,t,n,r,a){let s=t[t.length-1],[i,o]=[e.length/s,s],l=j.getTypedArrayFromDType(n,i*r),c=j.getTypedArrayFromDType("int32",i*r);for(let h=0;h<i;h++){let p=h*o,f=e.subarray(p,p+o),g=new Array(f.length);f.forEach((v,b)=>g[b]={value:v,index:b}),r<g.length&&(vQ(g,r),g=g.slice(0,r)),a&&g.sort(Yy);let m=h*r,y=l.subarray(m,m+r),x=c.subarray(m,m+r);for(let v=0;v<r;v++)y[v]=g[v].value,x[v]=g[v].index}let u=t.slice();return u[u.length-1]=r,[jt(u,n,l),jt(u,"int32",c)]}function UD(e,t,n,r){let a=j.parseAxisParam(t,n)[0],s=[1,n[0],1];for(let g=0;g<a;g++)s[0]*=n[g];s[1]=n[a];for(let g=a+1;g<n.length;g++)s[2]*=n[g];let i=new Map,o=new Int32Array(n[a]),l=new hr(s,r,e),c=[],u=s[0]===1&&s[2]===1;for(let g=0;g<n[a];g++){let m;if(u)m=e[g].toString();else{let x=[];for(let v=0;v<s[0];v++)for(let b=0;b<s[2];b++)x.push(l.get(v,g,b));m=x.join(",")}let y=i.get(m);if(y!=null)o[g]=y;else{let x=i.size;i.set(m,x),o[g]=x,c.push(g)}}let h=s.slice();h[1]=i.size;let p=new hr(h,r);c.forEach((g,m)=>{for(let y=0;y<s[0];y++)for(let x=0;x<s[2];x++)p.set(l.get(y,g,x),y,m,x)});let f=n.slice();return f[a]=h[1],{outputValues:p.values,outputShape:f,indices:o}}var BLe="4.22.0";Wk("cpu",()=>new TD,1);var wQ=mn(Eh,e=>e>=0?e:Math.exp(e)-1),ULe={kernelName:Eh,backendName:"cpu",kernelFunc:wQ};function NQ(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:s}=r;Xe([a],"leakyRelu");let i=j.sizeFromShape(a.shape),o=n.data.get(a.dataId).values,l=j.getTypedArrayFromDType("float32",i);for(let c=0;c<o.length;c++)l[c]=o[c]<0?s*o[c]:o[c];return n.makeTensorInfo(a.shape,"float32",l)}var WLe={kernelName:zh,backendName:"cpu",kernelFunc:NQ},VLe=ir((e,t)=>e<0?t*e:e);function kQ(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t;Xe([r,a],"prelu");let s=n.data.get(r.dataId).values,i=n.data.get(a.dataId).values,[o,l]=VLe(r.shape,a.shape,s,i,"float32");return n.makeTensorInfo(l,"float32",o)}var HLe={kernelName:np,backendName:"cpu",kernelFunc:kQ},SQ=mn(sp,e=>Math.max(0,e)),GLe={kernelName:sp,backendName:"cpu",kernelFunc:SQ},_Q=mn(lp,e=>Math.min(Math.max(0,e),6)),qLe={kernelName:lp,backendName:"cpu",kernelFunc:_Q};function J1(e,t,n,r,a){if(n==="linear")return Mo({inputs:{x:t},backend:e});if(n==="relu")return SQ({inputs:{x:t},backend:e});if(n==="elu")return wQ({inputs:{x:t},backend:e});if(n==="relu6")return _Q({inputs:{x:t},backend:e});if(n==="prelu")return kQ({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return NQ({inputs:{x:t},backend:e,attrs:{alpha:a}});if(n==="sigmoid")return dQ({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function En(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:s}=r,i=j.sizeFromShape(a.shape),o=j.inferFromImplicitShape(s,i),l=j.sizeFromShape(o);j.assert(i===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${a.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(a.dataId);let c=n.data.get(a.dataId);if(c.complexTensorInfos!=null){let u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=o,h.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}var KLe={kernelName:$g,backendName:"cpu",kernelFunc:En};function CQ(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:s}=t,{transposeA:i,transposeB:o}=r;Xe([a,s],"matMul");let l=a.shape.length,c=s.shape.length,u=i?a.shape[l-2]:a.shape[l-1],h=o?s.shape[c-1]:s.shape[c-2],p=i?a.shape[l-1]:a.shape[l-2],f=o?s.shape[c-2]:s.shape[c-1],g=a.shape.slice(0,-2),m=s.shape.slice(0,-2),y=j.sizeFromShape(g),x=j.sizeFromShape(m),v=Xg.assertAndGetBroadcastShape(a.shape.slice(0,-2),s.shape.slice(0,-2)).concat([p,f]);j.assert(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${a.shape} and ${s.shape} and transposeA=${i} and transposeB=${o} must match.`);let b=i?[y,u,p]:[y,p,u],w=o?[x,f,h]:[x,h,f],k=En({inputs:{x:a},backend:n,attrs:{shape:b}}),I=En({inputs:{x:s},backend:n,attrs:{shape:w}}),C=i?k.shape[1]:k.shape[2],S=i?k.shape[2]:k.shape[1],E=o?I.shape[1]:I.shape[2],T=Math.max(y,x),$=n.data.get(k.dataId).values,_=n.data.get(I.dataId).values,M=j.computeStrides(k.shape),L=j.computeStrides(I.shape),[U,O,F]=i?[M[0],1,M[1]]:[M[0],M[1],1],[D,R,V]=o?[1,L[1],L[0]]:[L[1],1,L[0]],G=S*E,W=jt([T,S,E],k.dtype),B=W.values,Q=n.blockSize;for(let X=0;X<T;X++){let pe=X%y,ie=X%x;for(let oe=0;oe<S;oe+=Q){let q=Math.min(oe+Q,S);for(let de=0;de<E;de+=Q){let ye=Math.min(de+Q,E);for(let be=0;be<C;be+=Q){let Ce=Math.min(be+Q,C);for(let se=oe;se<q;se++)for(let ae=de;ae<ye;ae++){let ue=0;for(let ke=be;ke<Ce;ke++){let _e=$[pe*U+se*O+ke*F],qe=_[ke*D+ae*R+ie*V];ue+=_e*qe}B[X*G+(se*E+ae)]+=ue}}}}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(v,W.dtype,W.values)}var QLe={kernelName:gh,backendName:"cpu",kernelFunc:CQ};function XLe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:s,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r,p,f,g,m=[];p=CQ({inputs:{a,b:s},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(f=Nm({inputs:{a:p,b:i},backend:n}),m.push(p),p=f),u&&(g=J1(n,p,u,o,h),m.push(p),p=g);for(let y of m)n.disposeIntermediateTensorInfo(y);return p}var YLe={kernelName:$d,backendName:"cpu",kernelFunc:XLe},JLe=mn(oh,e=>Math.acos(e)),ZLe={kernelName:oh,backendName:"cpu",kernelFunc:JLe},e3e=mn(lh,e=>Math.acosh(e)),t3e={kernelName:lh,backendName:"cpu",kernelFunc:e3e};function n3e(e){let{inputs:t,backend:n}=e,r=t;Xe(t,"addN");let a=r.map(o=>n.data.get(o.dataId).values),s=jt(r[0].shape,r[0].dtype),i=s.values;for(let o=0;o<r.length;o++){let l=a[o];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}var r3e={kernelName:uh,backendName:"cpu",kernelFunc:n3e};function a3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r;Xe(a,"all");let o=j.parseAxisParam(s,a.shape),l=o,c=P.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Va({inputs:{x:a},backend:n,attrs:{perm:c}}),l=P.getInnerMostAxes(l.length,a.shape.length)),P.assertAxesAreInnerMostDims("all",l,u.shape.length);let[h,p]=P.computeOutAndReduceShapes(u.shape,l),f=j.sizeFromShape(p),g=j.makeZerosTypedArray(j.sizeFromShape(h),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<g.length;++x){let v=x*f,b=m[v];for(let w=0;w<f;++w){let k=m[v+w];b=b&&k}g[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);let y=n.makeTensorInfo(h,u.dtype,g);if(i){let x=P.expandShapeToKeepDim(h,o),v=En({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}var s3e={kernelName:Qm,backendName:"cpu",kernelFunc:a3e};function i3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r;Xe(a,"any");let o=j.parseAxisParam(s,a.shape),l=o,c=P.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Va({inputs:{x:a},backend:n,attrs:{perm:c}}),l=P.getInnerMostAxes(l.length,a.shape.length)),P.assertAxesAreInnerMostDims("any",l,u.shape.length);let[h,p]=P.computeOutAndReduceShapes(u.shape,l),f=j.sizeFromShape(p),g=j.makeZerosTypedArray(j.sizeFromShape(h),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<g.length;++x){let v=x*f,b=m[v];for(let w=0;w<f;++w){let k=m[v+w];b=b||k}g[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);let y=n.makeTensorInfo(h,u.dtype,g);if(i){let x=P.expandShapeToKeepDim(h,o),v=En({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}var o3e={kernelName:Xm,backendName:"cpu",kernelFunc:i3e};function l3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s}=r;Xe(a,"argMax");let i=j.parseAxisParam(s,a.shape),o=P.getAxesPermutation(i,a.shape.length),l=a,c=[];o!=null&&(l=Va({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),i=P.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],P.assertAxesAreInnerMostDims("argMax",i,l.shape.length);let[u,h]=P.computeOutAndReduceShapes(l.shape,i),p=j.sizeFromShape(u),f=j.makeZerosTypedArray(p,"int32"),g=j.sizeFromShape(h),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){let x=y*g,v=m[x],b=0;for(let w=0;w<g;++w){let k=m[x+w];k>v&&(v=k,b=w)}f[y]=b}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}var u3e={kernelName:Ym,backendName:"cpu",kernelFunc:l3e};function c3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s}=r;Xe(a,"argMin");let i=j.parseAxisParam(s,a.shape),o=P.getAxesPermutation(i,a.shape.length),l=a,c=[];o!=null&&(l=Va({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),i=P.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],P.assertAxesAreInnerMostDims("argMin",i,l.shape.length);let[u,h]=P.computeOutAndReduceShapes(l.shape,i),p=j.sizeFromShape(u),f=j.makeZerosTypedArray(p,"int32"),g=j.sizeFromShape(h),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){let x=y*g,v=m[x],b=0;for(let w=0;w<g;++w){let k=m[x+w];k<v&&(v=k,b=w)}f[y]=b}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}var d3e={kernelName:Jm,backendName:"cpu",kernelFunc:c3e},h3e=mn(ch,e=>Math.asin(e)),p3e={kernelName:ch,backendName:"cpu",kernelFunc:h3e},f3e=mn(dh,e=>Math.asinh(e)),m3e={kernelName:dh,backendName:"cpu",kernelFunc:f3e},g3e=mn(hh,e=>Math.atan(e)),y3e={kernelName:hh,backendName:"cpu",kernelFunc:g3e},x3e=ir((e,t)=>Math.atan2(e,t)),v3e=Sr(fh,x3e),b3e={kernelName:fh,backendName:"cpu",kernelFunc:v3e},w3e=mn(ph,e=>Math.atanh(e)),N3e={kernelName:ph,backendName:"cpu",kernelFunc:w3e};function WD(e,t,n,r,a,s){let i=a.strideHeight,o=a.strideWidth,l=a.dilationHeight,c=a.dilationWidth,u=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=a.padInfo.top,f=a.padInfo.left,g=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=jt(a.outShape,n),y=m.values,x=a.outShape[1]*a.outShape[2]*a.outShape[3],v=a.outShape[2]*a.outShape[3],b=a.outShape[3];for(let w=0;w<a.batchSize;++w){let k=w*x,I=w*r[0];for(let C=0;C<a.inChannels;++C)for(let S=0;S<a.outHeight;++S){let E=S*i-p,T=Math.max(0,E),$=Math.min(a.inHeight,u+E),_=k+S*v;for(let M=0;M<a.outWidth;++M){let L=M*o-f,U=Math.max(0,L),O=Math.min(a.inWidth,h+L),F=g,D=0,R=0;for(let G=T;G<$;G+=l){let W=I+G*r[1];for(let B=U;B<O;B+=c){let Q=W+B*r[2],X=e[Q+C];s==="max"&&X>F?F=X:s==="avg"&&(D+=X,R++)}if(isNaN(F))break}let V=_+M*b+C;y[V]=s==="avg"?D/R:F}}}return m}function IQ(e,t,n,r,a=!1,s=!1){let i=jt(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=r.padInfo.top,g=r.padInfo.left,m=jt(t,n,e);for(let y=0;y<r.batchSize;++y)for(let x=0;x<r.inChannels;++x)for(let v=0;v<r.outHeight;++v){let b=v*o-f,w=b;for(;w<0;)w+=c;let k=Math.min(r.inHeight,h+b);for(let I=0;I<r.outWidth;++I){let C=I*l-g,S=C;for(;S<0;)S+=u;let E=Math.min(r.inWidth,p+C),T=Number.NEGATIVE_INFINITY,$=-1;for(let _=w;_<k;_+=c){let M=_-b;for(let L=S;L<E;L+=u){let U=L-C,O=m.get(y,_,L,x);O>T&&(T=O,a?$=s?((y*r.inHeight+_)*r.inWidth+L)*r.inChannels+x:(_*r.inWidth+L)*r.inChannels+x:$=M*p+U)}}i.set($,y,v,I,x)}}return i}function EQ(e,t,n,r,a,s){let i=a.strideDepth,o=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,u=a.dilationHeight,h=a.dilationWidth,p=a.effectiveFilterDepth,f=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=a.padInfo.front,y=a.padInfo.top,x=a.padInfo.left,v=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=jt(a.outShape,n),w=b.values,k=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],I=a.outShape[2]*a.outShape[3]*a.outShape[4],C=a.outShape[3]*a.outShape[4],S=a.outShape[4];for(let E=0;E<a.batchSize;++E){let T=E*k,$=E*r[0];for(let _=0;_<a.inChannels;++_)for(let M=0;M<a.outDepth;++M){let L=M*i-m,U=L;for(;U<0;)U+=c;let O=Math.min(a.inDepth,p+L),F=T+M*I;for(let D=0;D<a.outHeight;++D){let R=D*o-y,V=R;for(;V<0;)V+=u;let G=Math.min(a.inHeight,f+R),W=F+D*C;for(let B=0;B<a.outWidth;++B){let Q=B*l-x,X=Q;for(;X<0;)X+=h;let pe=Math.min(a.inWidth,g+Q),ie=W+B*S,oe=v,q=0,de=0;for(let be=U;be<O;be+=c){let Ce=$+be*r[1];for(let se=V;se<G;se+=u){let ae=Ce+se*r[2];for(let ue=X;ue<pe;ue+=h){let ke=ae+ue*r[3],_e=e[ke+_];if(s==="max"&&_e>oe?oe=_e:s==="avg"&&(q+=_e,de++),isNaN(oe))break}if(isNaN(oe))break}if(isNaN(oe))break}let ye=ie+_;w[ye]=s==="avg"?q/Math.max(de,1):oe}}}}return b}function k3e(e,t){let n=jt(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,s=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.front,f=t.padInfo.top,g=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let y=0;y<t.inChannels;++y)for(let x=0;x<t.outDepth;++x){let v=x*r-p,b=v;for(;b<0;)b+=i;let w=Math.min(t.inDepth,c+v);for(let k=0;k<t.outHeight;++k){let I=k*a-f,C=I;for(;C<0;)C+=o;let S=Math.min(t.inHeight,u+I);for(let E=0;E<t.outWidth;++E){let T=E*s-g,$=T;for(;$<0;)$+=l;let _=Math.min(t.inWidth,h+T),M=Number.NEGATIVE_INFINITY,L=-1;for(let U=b;U<w;U+=i){let O=U-v;for(let F=C;F<S;F+=o){let D=F-I;for(let R=$;R<_;R+=l){let V=R-T,G=e.get(m,U,F,R,y);G>=M&&(M=G,L=O*u*h+D*u+V)}}}n.set(L,m,x,k,E,y)}}}return n}function S3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Xe(a,"avgPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=r,c=1;j.assert(P.eitherStridesOrDilationsAreOne(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=P.computePool2DInfo(a.shape,s,i,c,o,l),h;if(u.filterWidth===1&&u.filterHeight===1&&j.arraysEqual(u.inShape,u.outShape))h=Mo({inputs:{x:a},backend:n});else{let p=n.data.get(a.dataId).values,f=j.computeStrides(a.shape),g=WD(p,a.shape,a.dtype,f,u,"avg");h=n.makeTensorInfo(u.outShape,a.dtype,g.values)}return h}var _3e={kernelName:mh,backendName:"cpu",kernelFunc:S3e};function C3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=r;Xe(a,"avgPool3d");let u=P.computePool3DInfo(a.shape,s,i,1,o,l,c),h=n.data.get(a.dataId).values,p=EQ(h,a.shape,a.dtype,j.computeStrides(a.shape),u,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}var I3e={kernelName:Zm,backendName:"cpu",kernelFunc:C3e};function E3e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=r;Xe([a,s],"avgPool3DGrad");let u=P.computePool3DInfo(s.shape,i,o,1,l,c),h=u.strideDepth,p=u.strideHeight,f=u.strideWidth,g=u.filterDepth,m=u.filterHeight,y=u.filterWidth,x=u.dilationDepth,v=u.dilationHeight,b=u.dilationWidth,w=u.effectiveFilterDepth,k=u.effectiveFilterHeight,I=u.effectiveFilterWidth,C=w-1-u.padInfo.front,S=I-1-u.padInfo.left,E=k-1-u.padInfo.top,T=jt(s.shape,"float32"),$=1/(g*m*y),_=n.bufferSync(a);for(let M=0;M<u.batchSize;++M)for(let L=0;L<u.inChannels;++L)for(let U=0;U<u.inDepth;++U)for(let O=0;O<u.inHeight;++O)for(let F=0;F<u.inWidth;++F){let D=U-C,R=O-E,V=F-S,G=0;for(let W=0;W<w;W+=x){let B=(D+W)/h;if(!(B<0||B>=u.outDepth||Math.floor(B)!==B))for(let Q=0;Q<k;Q+=v){let X=(R+Q)/p;if(!(X<0||X>=u.outHeight||Math.floor(X)!==X))for(let pe=0;pe<I;pe+=b){let ie=(V+pe)/f;if(ie<0||ie>=u.outWidth||Math.floor(ie)!==ie)continue;let oe=_.get(M,B,X,ie,L);G+=oe}}}T.set(G*$,M,U,O,F,L)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}var T3e={kernelName:Qv,backendName:"cpu",kernelFunc:E3e};function j3e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,i=s;Xe([a,s],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=r,u=P.computePool2DInfo(i.shape,o,l,1,c),h=u.strideHeight,p=u.strideWidth,f=u.filterHeight,g=u.filterWidth,m=u.dilationHeight,y=u.dilationWidth,x=u.effectiveFilterHeight,v=u.effectiveFilterWidth,b=v-1-u.padInfo.left,w=x-1-u.padInfo.top,k=jt(i.shape,"float32"),I=1/(f*g),C=n.data.get(a.dataId).values,S=jt(a.shape,"float32",C);for(let E=0;E<u.batchSize;++E)for(let T=0;T<u.inChannels;++T)for(let $=0;$<u.inHeight;++$)for(let _=0;_<u.inWidth;++_){let M=$-w,L=_-b,U=0;for(let O=0;O<x;O+=m){let F=(M+O)/h;if(!(F<0||F>=u.outHeight||Math.floor(F)!==F))for(let D=0;D<v;D+=y){let R=(L+D)/p;if(R<0||R>=u.outWidth||Math.floor(R)!==R)continue;let V=S.get(E,F,R,T);U+=V}}k.set(U*I,E,$,_,T)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}var A3e={kernelName:Kv,backendName:"cpu",kernelFunc:j3e};function $3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,scale:s,offset:i,mean:o,variance:l}=t;j.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j.assert(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Xe([a,o,l,s,i],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);let u=n.data.get(a.dataId).values,h=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,f=s?n.data.get(s.dataId).values:new Float32Array([1]),g=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),y=g.length,x=f.length,v=p.length,b=h.length,w=0,k=0,I=0,C=0;for(let S=0;S<u.length;++S)m[S]=g[w++]+(u[S]-h[k++])*f[I++]/Math.sqrt(p[C++]+c),w>=y&&(w=0),k>=b&&(k=0),I>=x&&(I=0),C>=v&&(C=0);return n.makeTensorInfo(a.shape,a.dtype,m)}var R3e={kernelName:Dh,backendName:"cpu",kernelFunc:$3e};function D3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,crops:i}=r;Xe([a],"batchToSpaceND");let o=s.reduce((x,v)=>x*v),l=P.getReshaped(a.shape,s,o),c=P.getPermuted(l.length,s.length),u=P.getReshapedPermuted(a.shape,s,o),h=P.getSliceBeginCoords(i,s.length),p=P.getSliceSize(u,i,s.length),f=En({inputs:{x:a},backend:n,attrs:{shape:l}}),g=Va({inputs:{x:f},backend:n,attrs:{perm:c}}),m=En({inputs:{x:g},backend:n,attrs:{shape:u}}),y=Gd({inputs:{x:m},backend:n,attrs:{begin:h,size:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}var M3e={kernelName:eg,backendName:"cpu",kernelFunc:D3e};function O3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:s}=t,{size:i}=r,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values,c=$D(o,l,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,c)}var F3e={kernelName:tg,backendName:"cpu",kernelFunc:O3e};function P3e(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,s=n.data.get(r.dataId).values,i=n.data.get(a.dataId).values,o=P.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var L3e={kernelName:Xv,backendName:"cpu",kernelFunc:P3e},z3e=mn(gc,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),B3e={kernelName:gc,backendName:"cpu",kernelFunc:z3e},U3e=e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(j.sizeFromShape(t.shape)),a=n.data.get(t.dataId),s=a.complexTensorInfos.real,i=a.complexTensorInfos.imag,o=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<o.length;c++){let u=o[c],h=l[c];r[c]=Math.hypot(u,h)}return n.makeOutput(r,t.shape,"float32")},W3e={kernelName:Yv,backendName:"cpu",kernelFunc:U3e};function km(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,s)}var V3e={kernelName:Ok,backendName:"cpu",kernelFunc:km};function Sm(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,s=j.parseAxisParam(a,t[0].shape)[0],i=t.map(m=>m.shape);P.assertParamsConsistent(i,s);let o=P.computeOutShape(t.map(m=>m.shape),s);if(j.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(m=>j.sizeFromShape(m.shape)>0);if(l.length===1)return Mo({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){let m=l.map(w=>Hd({inputs:{input:w},backend:n})),y=l.map(w=>km({inputs:{input:w},backend:n})),x=Sm({inputs:m,backend:n,attrs:{axis:s}}),v=Sm({inputs:y,backend:n,attrs:{axis:s}}),b=os({inputs:{real:x,imag:v},backend:n});return m.forEach(w=>n.disposeIntermediateTensorInfo(w)),y.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),b}let c=l.map(m=>{let y=[-1,j.sizeFromShape(m.shape.slice(s))];return En({inputs:{x:m},backend:n,attrs:{shape:y}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));o=P.computeOutShape(c.map(m=>m.shape),1);let h=c[0].shape[0]===1,p=RD(u,o,t[0].dtype,h),f=P.computeOutShape(l.map(m=>m.shape),s),g=n.makeTensorInfo(f,t[0].dtype,p);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}var H3e={kernelName:rg,backendName:"cpu",kernelFunc:Sm};function TQ(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r;Xe([a,s],"conv2d");let h=P.convertConv2DDataFormat(l),p=P.computeConv2DInfo(a.shape,s.shape,i,c,o,u,!1,h),f=p.filterHeight,g=p.filterWidth,m=p.dilationHeight,y=p.dilationWidth,x=p.padInfo.left,v=p.padInfo.top,b=p.dataFormat==="channelsLast",w=new hr(p.outShape,a.dtype),k=j.computeStrides(a.shape),I=j.computeStrides(s.shape),C=k[0],S=b?k[1]:k[2],E=b?k[2]:1,T=b?1:k[1],$=w.strides[0],_=b?w.strides[1]:w.strides[2],M=b?w.strides[2]:1,L=b?1:w.strides[1],U=n.data.get(a.dataId).values,O=n.data.get(s.dataId).values,F=w.values;for(let D=0;D<p.batchSize;++D){let R=D*C,V=D*$;for(let G=0;G<p.outHeight;++G){let W=V+G*_,B=G*p.strideHeight-v;for(let Q=0;Q<f;++Q){let X=B+Q*m;if(X<0||X>=p.inHeight)continue;let pe=Q*I[0],ie=R+X*S;for(let oe=0;oe<p.outWidth;++oe){let q=W+oe*M,de=oe*p.strideWidth-x;for(let ye=0;ye<g;++ye){let be=de+ye*y;if(be<0||be>=p.inWidth)continue;let Ce=pe+ye*I[1],se=ie+be*E,ae=Ce;for(let ue=0;ue<p.inChannels;++ue){let ke=U[se+ue*T];for(let _e=0;_e<p.outChannels;++_e)F[q+_e*L]+=ke*O[ae+_e];ae+=p.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,F)}var G3e={kernelName:vh,backendName:"cpu",kernelFunc:TQ};function q3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:s}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;Xe([a,s],"conv2dBackpropFilter");let h=P.convertConv2DDataFormat(l),p=P.computeConv2DInfo(a.shape,u,i,1,o,c,!1,h),{strideHeight:f,strideWidth:g,filterHeight:m,filterWidth:y}=p,x=p.dataFormat==="channelsLast",v=new hr(p.filterShape,"float32"),b=p.padInfo.left,w=p.padInfo.top,k=n.data.get(a.dataId).values,I=n.data.get(s.dataId).values,C=new hr(a.shape,a.dtype,k),S=new hr(s.shape,s.dtype,I);for(let E=0;E<m;++E){let T=Math.max(0,Math.ceil((w-E)/f)),$=Math.min(p.outHeight,(p.inHeight+w-E)/f);for(let _=0;_<y;++_){let M=Math.max(0,Math.ceil((b-_)/g)),L=Math.min(p.outWidth,(p.inWidth+b-_)/g);for(let U=0;U<p.inChannels;++U)for(let O=0;O<p.outChannels;++O){let F=0;for(let D=0;D<p.batchSize;++D)for(let R=T;R<$;++R){let V=E+R*f-w;for(let G=M;G<L;++G){let W=_+G*g-b;x?F+=C.get(D,V,W,U)*S.get(D,R,G,O):F+=C.get(D,U,V,W)*S.get(D,O,R,G)}}v.set(F,E,_,U,O)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}var K3e={kernelName:Tk,backendName:"cpu",kernelFunc:q3e};function Q3e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:s}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r;Xe([a,s],"conv2dBackpropInput");let h=j.computeStrides(s.shape),p=j.computeStrides(a.shape),f=P.convertConv2DDataFormat(c),g=P.computeConv2DInfo(i,s.shape,o,1,l,u,!1,f),m=new hr(g.inShape,"float32"),y=m.values,x=n.data.get(a.dataId).values,v=n.data.get(s.dataId).values,[b,w,k]=h,{batchSize:I,filterHeight:C,filterWidth:S,inChannels:E,inHeight:T,inWidth:$,outChannels:_,outHeight:M,outWidth:L,strideHeight:U,strideWidth:O}=g;f=g.dataFormat;let F=C-1-g.padInfo.top,D=S-1-g.padInfo.left,R=f==="channelsLast",V=m.strides[0],G=R?m.strides[1]:m.strides[2],W=R?m.strides[2]:1,B=R?1:m.strides[1],Q=p[0],X=R?p[1]:p[2],pe=R?p[2]:1,ie=R?1:p[1];for(let oe=0;oe<I;++oe)for(let q=0;q<E;++q)for(let de=0;de<T;++de){let ye=de-F,be=Math.max(0,Math.ceil(ye/U)),Ce=Math.min(M,(C+ye)/U);for(let se=0;se<$;++se){let ae=se-D,ue=Math.max(0,Math.ceil(ae/O)),ke=Math.min(L,(S+ae)/O),_e=0;for(let Ue=be;Ue<Ce;++Ue){let it=Ue*U-ye;for(let yt=ue;yt<ke;++yt){let At=yt*O-ae,Bt=Q*oe+X*Ue+pe*yt,an=b*(C-1-it)+w*(S-1-At)+k*q;for(let nt=0;nt<_;++nt){let ht=x[Bt+ie*nt],un=v[an+nt];_e+=ht*un}}}let qe=V*oe+G*de+W*se+B*q;y[qe]=_e}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}var X3e={kernelName:bh,backendName:"cpu",kernelFunc:Q3e};function Y3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:l}=r;Xe([a,s],"conv3d");let c=P.computeConv3DInfo(a.shape,s.shape,i,l,o),{filterDepth:u,filterHeight:h,filterWidth:p,dilationDepth:f,dilationHeight:g,dilationWidth:m,padInfo:y}=c,x=y.front,v=y.left,b=y.top,w=new hr(c.outShape,a.dtype),k=n.data.get(a.dataId).values,I=n.data.get(s.dataId).values,C=w.values,S=j.computeStrides(a.shape),E=j.computeStrides(s.shape);for(let T=0;T<c.batchSize;++T){let $=T*S[0],_=T*w.strides[0];for(let M=0;M<c.outDepth;++M){let L=_+M*w.strides[1],U=M*c.strideDepth-x;for(let O=0;O<u;++O){let F=U+O*f;if(F<0||F>=c.inDepth)continue;let D=O*E[0],R=$+F*S[1];for(let V=0;V<c.outHeight;++V){let G=L+V*w.strides[2],W=V*c.strideHeight-b;for(let B=0;B<h;++B){let Q=W+B*g;if(Q<0||Q>=c.inHeight)continue;let X=D+B*E[1],pe=R+Q*S[2];for(let ie=0;ie<c.outWidth;++ie){let oe=G+ie*c.outChannels,q=ie*c.strideWidth-v;for(let de=0;de<p;++de){let ye=q+de*m;if(ye<0||ye>=c.inWidth)continue;let be=X+de*E[2],Ce=pe+ye*c.inChannels,se=be;for(let ae=0;ae<c.inChannels;++ae){let ue=k[Ce+ae];for(let ke=0;ke<c.outChannels;++ke)C[oe+ke]+=ue*I[se+ke];se+=c.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var J3e={kernelName:wh,backendName:"cpu",kernelFunc:Y3e};function Z3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:s}=t,{strides:i,pad:o,filterShape:l}=r;Xe([a,s],"conv3dBackpropFilterV2");let c=j.computeStrides(a.shape),u=j.computeStrides(s.shape),h=P.computeConv3DInfo(a.shape,l,i,1,o),p=h.strideDepth,f=h.strideHeight,g=h.strideWidth,m=h.filterDepth,y=h.filterHeight,x=h.filterWidth,v=new hr(h.filterShape,"float32"),b=v.values,[w,k,I,C]=v.strides,S=n.data.get(s.dataId).values,[E,T,$,_]=u,M=n.data.get(a.dataId).values,[L,U,O,F]=c,D=h.padInfo.front,R=h.padInfo.left,V=h.padInfo.top;for(let G=0;G<m;++G){let W=Math.max(0,Math.ceil((D-G)/p)),B=Math.min(h.outDepth,(h.inDepth+D-G)/p),Q=G*w;for(let X=0;X<y;++X){let pe=Math.max(0,Math.ceil((V-X)/f)),ie=Math.min(h.outHeight,(h.inHeight+V-X)/f),oe=X*k+Q;for(let q=0;q<x;++q){let de=Math.max(0,Math.ceil((R-q)/g)),ye=Math.min(h.outWidth,(h.inWidth+R-q)/g),be=q*I+oe;for(let Ce=0;Ce<h.inChannels;++Ce){let se=Ce*C+be;for(let ae=0;ae<h.outChannels;++ae){let ue=0;for(let ke=0;ke<h.batchSize;++ke){let _e=ke*L,qe=ke*E;for(let Ue=W;Ue<B;++Ue){let it=(G+Ue*p-D)*U+_e,yt=Ue*T+qe;for(let At=pe;At<ie;++At){let Bt=(X+At*f-V)*O+it,an=At*$+yt;for(let nt=de;nt<ye;++nt){let ht=(q+nt*g-R)*F+Bt,un=nt*_+an;ue+=M[ht+Ce]*S[un+ae]}}}}b[se+ae]=ue}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}var e4e={kernelName:ag,backendName:"cpu",kernelFunc:Z3e};function t4e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:s}=t,{pad:i,strides:o,inputShape:l}=r;Xe([a],"conv3dBackpropInputV2");let c=j.computeStrides(a.shape),u=j.computeStrides(s.shape),h=P.computeConv3DInfo(l,s.shape,o,1,i),p=new hr(h.inShape,"float32"),f=p.values,[g,m,y,x]=p.strides,v=n.data.get(a.dataId).values,[b,w,k,I]=c,C=n.data.get(s.dataId).values,[S,E,T,$]=u,{batchSize:_,filterDepth:M,filterHeight:L,filterWidth:U,inChannels:O,inDepth:F,inHeight:D,inWidth:R,outChannels:V,outDepth:G,outHeight:W,outWidth:B,strideDepth:Q,strideHeight:X,strideWidth:pe}=h,ie=M-1-h.padInfo.front,oe=L-1-h.padInfo.top,q=U-1-h.padInfo.left;for(let de=0;de<_;++de)for(let ye=0;ye<O;++ye)for(let be=0;be<F;++be){let Ce=be-ie,se=Math.max(0,Math.ceil(Ce/Q)),ae=Math.min(G,(M+Ce)/Q);for(let ue=0;ue<D;++ue){let ke=ue-oe,_e=Math.max(0,Math.ceil(ke/X)),qe=Math.min(W,(L+ke)/X);for(let Ue=0;Ue<R;++Ue){let it=Ue-q,yt=Math.max(0,Math.ceil(it/pe)),At=Math.min(B,(U+it)/pe),Bt=0;for(let an=se;an<ae;++an){let nt=an*Q-Ce;for(let ht=_e;ht<qe;++ht){let un=ht*X-ke;for(let er=yt;er<At;++er){let xe=er*pe-it,$n=b*de+w*an+k*ht+I*er,Pn=S*(M-1-nt)+E*(L-1-un)+T*(U-1-xe)+$*ye;for(let sn=0;sn<V;++sn){let tn=v[$n+sn],Ln=C[Pn+sn];Bt+=tn*Ln}}}}f[g*de+m*be+y*ue+x*Ue+ye]=Bt}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}var n4e={kernelName:sg,backendName:"cpu",kernelFunc:t4e},r4e=mn(Nh,e=>Math.cos(e)),a4e={kernelName:Nh,backendName:"cpu",kernelFunc:r4e},s4e=mn(kh,e=>Math.cosh(e)),i4e={kernelName:kh,backendName:"cpu",kernelFunc:s4e};function o4e(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:s,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=r,[u,h,p,f]=a.shape,g=s.shape[0],[m,y]=o,x=jt([g,m,y,f],"float32"),v=n.data.get(s.dataId).values,b=n.data.get(i.dataId).values,w=n.data.get(a.dataId).values,k=j.computeStrides(a.shape),I=j.computeStrides(x.shape);for(let C=0;C<g;C++){let S=C*4,E=v[S],T=v[S+1],$=v[S+2],_=v[S+3],M=b[C];if(M>=u)continue;let L=m>1?($-E)*(h-1)/(m-1):0,U=y>1?(_-T)*(p-1)/(y-1):0;for(let O=0;O<m;O++){let F=m>1?E*(h-1)+O*L:.5*(E+$)*(h-1);if(F<0||F>h-1){for(let D=0;D<y;D++)for(let R=0;R<f;R++){let V=R+D*I[2]+O*I[1]+C*I[0];x.values[V]=c}continue}if(l==="bilinear"){let D=Math.floor(F),R=Math.ceil(F),V=F-D;for(let G=0;G<y;G++){let W=y>1?T*(p-1)+G*U:.5*(T+_)*(p-1);if(W<0||W>p-1){for(let pe=0;pe<f;pe++){let ie=pe+G*I[2]+O*I[1]+C*I[0];x.values[ie]=c}continue}let B=Math.floor(W),Q=Math.ceil(W),X=W-B;for(let pe=0;pe<f;pe++){let ie=pe+B*k[2]+D*k[1]+M*k[0],oe=w[ie];ie=pe+Q*k[2]+D*k[1]+M*k[0];let q=w[ie];ie=pe+B*k[2]+R*k[1]+M*k[0];let de=w[ie];ie=pe+Q*k[2]+R*k[1]+M*k[0];let ye=w[ie],be=oe+(q-oe)*X,Ce=de+(ye-de)*X;ie=pe+G*I[2]+O*I[1]+C*I[0],x.values[ie]=be+(Ce-be)*V}}}else for(let D=0;D<y;++D){let R=y>1?T*(p-1)+D*U:.5*(T+_)*(p-1);if(R<0||R>p-1){for(let W=0;W<f;W++){let B=W+D*I[2]+O*I[1]+C*I[0];x.values[B]=c}continue}let V=Math.round(R),G=Math.round(F);for(let W=0;W<f;W++){let B=W+V*k[2]+G*k[1]+M*k[0],Q=W+D*I[2]+O*I[1]+C*I[0];x.values[Q]=w[B]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}var l4e={kernelName:og,backendName:"cpu",kernelFunc:o4e};function u4e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=r;Xe(a,"cumprod");let l=P.getAxesPermutation([s],a.shape.length),c=a;l!=null&&(c=Va({inputs:{x:a},backend:n,attrs:{perm:l}}));let u=P.getInnerMostAxes(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let h=Bs(c.dtype,"int32"),p=j.makeOnesTypedArray(j.sizeFromShape(c.shape),h),f=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],m=o?(x,v)=>x+g-v-1:(x,v)=>x+v;for(let x=0;x<f.length;x+=g)for(let v=0;v<g;v++){let b=m(x,v);if(v===0)p[b]=i?1:f[b];else{let w=m(x,v-1);p[b]=i?f[w]*p[w]:f[b]*p[w]}}let y=n.makeTensorInfo(c.shape,h,p);if(l!=null){let x=P.getUndoAxesPermutation(l),v=Va({inputs:{x:y},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}var c4e={kernelName:ig,backendName:"cpu",kernelFunc:u4e};function d4e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=r;Xe(a,"cumsum");let l=P.getAxesPermutation([s],a.shape.length),c=a;l!=null&&(c=Va({inputs:{x:a},backend:n,attrs:{perm:l}}));let u=P.getInnerMostAxes(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let h=Bs(c.dtype,"int32"),p=j.makeZerosTypedArray(j.sizeFromShape(c.shape),h),f=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],m=o?(x,v)=>x+g-v-1:(x,v)=>x+v;for(let x=0;x<f.length;x+=g)for(let v=0;v<g;v++){let b=m(x,v);if(v===0)p[b]=i?0:f[b];else{let w=m(x,v-1);p[b]=i?f[w]+p[w]:f[b]+p[w]}}let y=n.makeTensorInfo(c.shape,h,p);if(l!=null){let x=P.getUndoAxesPermutation(l),v=Va({inputs:{x:y},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}var h4e={kernelName:Sh,backendName:"cpu",kernelFunc:d4e};function p4e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:s}=t,{size:i,binaryOutput:o}=r;if(a.shape.length===1){let l=n.data.get(a.dataId).values,c=n.data.get(s.dataId).values,u=$D(l,c,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,u)}else if(a.shape.length===2){let l=n.bufferSync(a),c=n.bufferSync(s),u=F9(l,c,i,o);return n.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}var f4e={kernelName:Jv,backendName:"cpu",kernelFunc:p4e};function m4e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:s,dataFormat:i}=r;j.assert(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);let o=a.shape[0],l=a.shape[1],c=a.shape[2],u=a.shape[3],h=l*s,p=c*s,f=u/(s*s),g=n.data.get(a.dataId).values,m=new Float32Array(o*h*p*f),y=0;for(let x=0;x<o;++x)for(let v=0;v<h;++v){let b=Math.floor(v/s),w=v%s;for(let k=0;k<p;++k){let I=Math.floor(k/s),C=k%s,S=(w*s+C)*f;for(let E=0;E<f;++E){let T=E+S+u*(I+c*(b+l*x));m[y++]=g[T]}}}return n.makeTensorInfo([o,h,p,f],a.dtype,m)}var g4e={kernelName:lg,backendName:"cpu",kernelFunc:m4e};function jQ(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=r;Xe([a,s],"depthwiseConv2DNative");let u=j.computeStrides(a.shape),h=j.computeStrides(s.shape),p=l;p==null&&(p=[1,1]),j.assert(P.eitherStridesOrDilationsAreOne(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);let f=P.computeConv2DInfo(a.shape,s.shape,i,p,o,c,!0),{filterHeight:g,filterWidth:m,dilationHeight:y,dilationWidth:x,padInfo:v}=f,b=v.left,w=v.top,k=f.outChannels/f.inChannels,I=new hr(f.outShape,a.dtype),C=n.data.get(a.dataId).values,S=n.data.get(s.dataId).values,E=I.values;for(let T=0;T<f.batchSize;++T){let $=T*u[0],_=T*I.strides[0];for(let M=0;M<f.outHeight;++M){let L=_+M*I.strides[1],U=M*f.strideHeight-w;for(let O=0;O<g;++O){let F=U+O*y;if(F<0||F>=f.inHeight)continue;let D=O*h[0],R=$+F*u[1];for(let V=0;V<f.outWidth;++V){let G=L+V*I.strides[2],W=V*f.strideWidth-b;for(let B=0;B<m;++B){let Q=W+B*x;if(Q<0||Q>=f.inWidth)continue;let X=D+B*h[1],pe=R+Q*f.inChannels,ie=G,oe=X;for(let q=0;q<f.inChannels;++q){let de=C[pe+q];for(let ye=0;ye<k;++ye)E[ie+ye]+=de*S[oe+ye];ie+=k,oe+=k}}}}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}var y4e={kernelName:_h,backendName:"cpu",kernelFunc:jQ};function x4e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r;Xe([a,s],"depthwiseConv2dNativeBackpropFilter");let h=P.computeConv2DInfo(a.shape,u,i,o,l,c,!0),{strideHeight:p,strideWidth:f,filterHeight:g,filterWidth:m}=h,y=new hr(h.filterShape,"float32"),x=h.padInfo.left,v=h.padInfo.top,b=h.outChannels/h.inChannels,w=n.data.get(a.dataId).values,k=new hr(a.shape,a.dtype,w),I=n.data.get(s.dataId).values,C=new hr(s.shape,s.dtype,I);for(let S=0;S<g;++S){let E=Math.max(0,Math.ceil((v-S)/p)),T=Math.min(h.outHeight,(h.inHeight+v-S)/p);for(let $=0;$<m;++$){let _=Math.max(0,Math.ceil((x-$)/f)),M=Math.min(h.outWidth,(h.inWidth+x-$)/f);for(let L=0;L<h.outChannels;++L){let U=Math.trunc(L/b),O=L%b,F=0;for(let D=0;D<h.batchSize;++D)for(let R=E;R<T;++R){let V=S+R*p-v;for(let G=_;G<M;++G){let W=$+G*f-x;F+=k.get(D,V,W,U)*C.get(D,R,G,L)}}y.set(F,S,$,U,O)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}var v4e={kernelName:jk,backendName:"cpu",kernelFunc:x4e};function b4e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r;Xe([a,s],"depthwiseConv2DNativeBackpropInput");let h=j.computeStrides(a.shape),p=j.computeStrides(s.shape),f=P.computeConv2DInfo(u,s.shape,i,o,l,c,!0),g=new hr(f.inShape,"float32"),m=g.values,[y,x,v]=g.strides,b=n.data.get(a.dataId).values,[w,k,I]=h,C=n.data.get(s.dataId).values,[S,E,T]=p,{batchSize:$,filterHeight:_,filterWidth:M,inChannels:L,inHeight:U,inWidth:O,outChannels:F,outHeight:D,outWidth:R,strideHeight:V,strideWidth:G}=f,W=_-1-f.padInfo.top,B=M-1-f.padInfo.left,Q=F/L;for(let X=0;X<$;++X)for(let pe=0;pe<L;++pe)for(let ie=0;ie<U;++ie){let oe=ie-W,q=Math.max(0,Math.ceil(oe/V)),de=Math.min(D,(_+oe)/V);for(let ye=0;ye<O;++ye){let be=ye-B,Ce=Math.max(0,Math.ceil(be/G)),se=Math.min(R,(M+be)/G),ae=0;for(let ue=q;ue<de;++ue){let ke=ue*V-oe;for(let _e=Ce;_e<se;++_e){let qe=_e*G-be,Ue=w*X+k*ue+I*_e,it=S*(_-1-ke)+E*(M-1-qe)+T*pe;for(let yt=0;yt<Q;++yt){let At=pe*Q+yt,Bt=b[Ue+At],an=C[it+yt];ae+=Bt*an}}}m[y*X+x*ie+v*ye+pe]=ae}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}var w4e={kernelName:Ak,backendName:"cpu",kernelFunc:b4e};function N4e(e){let{inputs:t,backend:n}=e,{x:r}=t,a=j.sizeFromShape(r.shape),s=n.data.get(r.dataId).values,i=jt([a,a],r.dtype),o=i.values;for(let c=0;c<s.length;c++)o[c*a+c]=s[c];let l=[...r.shape,...r.shape];return n.makeTensorInfo(l,i.dtype,i.values)}var k4e={kernelName:Zv,backendName:"cpu",kernelFunc:N4e},S4e={kernelName:Ch,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a}=e,{strides:s,pad:i,dilations:o}=n,l=t,c=l.data.get(r.dataId).values,u=r.shape.length,h=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:f,inHeight:g,inWidth:m,inChannels:y,outHeight:x,outWidth:v,padInfo:b,strideHeight:w,strideWidth:k,filterHeight:I,filterWidth:C,dilationHeight:S,dilationWidth:E,outShape:T}=P.computeDilation2DInfo(r.shape,a.shape,s,i,"NHWC",o),$=j.sizeFromShape(T),_=T.length,M=j.getArrayFromDType(r.dtype,$);for(let L=0;L<f;++L)for(let U=0;U<x;++U){let O=U*w-b.top;for(let F=0;F<v;++F){let D=F*k-b.left;for(let R=0;R<y;++R){let V=Number.MIN_SAFE_INTEGER;for(let W=0;W<I;++W){let B=O+W*S;if(B>=0&&B<g)for(let Q=0;Q<C;++Q){let X=D+Q*E;if(X>=0&&X<m){let pe=j.locToIndex([L,B,X,R],u,j.computeStrides(r.shape)),ie=j.locToIndex([W,Q,R],p,j.computeStrides(a.shape)),oe=c[pe]+h[ie];oe>V&&(V=oe)}}}let G=j.locToIndex([L,U,F,R],_,j.computeStrides(T));M[G]=V}}}return{dataId:l.write(j.toTypedArray(M,r.dtype),T,r.dtype),shape:T,dtype:r.dtype}}},_4e={kernelName:cm,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:s}=e,{strides:i,pad:o,dilations:l}=n,c=t,u=j.toNestedArray(r.shape,c.data.get(r.dataId).values),h=j.toNestedArray(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:g,inChannels:m,outHeight:y,outWidth:x,padInfo:v,strideHeight:b,strideWidth:w,filterHeight:k,filterWidth:I,dilationHeight:C,dilationWidth:S,outShape:E}=P.computeDilation2DInfo(r.shape,a.shape,i,o,"NHWC",l);j.assert(s.rank===E.length,()=>`Error in ${cm}, dy must have the same rank as output ${E.length}, but got ${s.rank}`);let T=j.toNestedArray(E,c.data.get(s.dataId).values),$=j.makeZerosNestedTypedArray(a.shape,a.dtype);for(let _=0;_<p;++_)for(let M=0;M<y;++M){let L=M*b-v.top;for(let U=0;U<x;++U){let O=U*w-v.left;for(let F=0;F<m;++F){let D=Number.MIN_SAFE_INTEGER,R=0,V=0;for(let G=0;G<k;++G){let W=L+G*C;if(W>=0&&W<f)for(let B=0;B<I;++B){let Q=O+B*S;if(Q>=0&&Q<g){let X=u[_][W][Q][F]+h[G][B][F];X>D&&(D=X,R=G,V=B)}}}$[R][V][F]+=T[_][M][U][F]}}}return{dataId:c.write(j.toTypedArray($,r.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},C4e={kernelName:um,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:s}=e,{strides:i,pad:o,dilations:l}=n,c=t,u=j.toNestedArray(r.shape,c.data.get(r.dataId).values),h=j.toNestedArray(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:g,inChannels:m,outHeight:y,outWidth:x,padInfo:v,strideHeight:b,strideWidth:w,filterHeight:k,filterWidth:I,dilationHeight:C,dilationWidth:S,outShape:E}=P.computeDilation2DInfo(r.shape,a.shape,i,o,"NHWC",l);j.assert(s.rank===E.length,()=>`Error in ${um}, dy must have the same rank as output ${E.length}, but got ${s.rank}`);let T=j.toNestedArray(E,c.data.get(s.dataId).values),$=j.makeZerosNestedTypedArray(r.shape,r.dtype);for(let _=0;_<p;++_)for(let M=0;M<y;++M){let L=M*b-v.top;for(let U=0;U<x;++U){let O=U*w-v.left;for(let F=0;F<m;++F){let D=Number.MIN_SAFE_INTEGER,R=L<0?0:L,V=O<0?0:O;for(let G=0;G<k;++G){let W=L+G*C;if(W>=0&&W<f)for(let B=0;B<I;++B){let Q=O+B*S;if(Q>=0&&Q<g){let X=u[_][W][Q][F]+h[G][B][F];X>D&&(D=X,R=W,V=Q)}}}$[_][R][V][F]+=T[_][M][U][F]}}}return{dataId:c.write(j.toTypedArray($,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function I4e(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{canvas:s,options:i}=r,{contextOptions:o,imageOptions:l}=i||{},c=(l==null?void 0:l.alpha)||1,u=(o==null?void 0:o.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);let h=s.getContext(u,(o==null?void 0:o.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${u} type.`);let[p,f]=a.shape.slice(0,2),g=a.shape.length===2?1:a.shape[2],m=n.data.get(a.dataId).values,y=a.dtype==="float32"?255:1,x=new Uint8ClampedArray(f*p*4);for(let b=0;b<p*f;++b){let w=[0,0,0,255*c];for(let I=0;I<g;I++){let C=m[b*g+I];if(a.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(a.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);g===1?(w[0]=C*y,w[1]=C*y,w[2]=C*y):w[I]=C*y}let k=b*4;x[k+0]=Math.round(w[0]),x[k+1]=Math.round(w[1]),x[k+2]=Math.round(w[2]),x[k+3]=Math.round(w[3])}s.width=f,s.height=p;let v=new ImageData(x,f,p);return h.putImageData(v,0,0),a}var E4e={kernelName:$k,backendName:"cpu",kernelFunc:I4e};function Wb(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r;Xe(a,"sum");let o;a.dtype==="bool"?o=tc({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):o=Mo({inputs:{x:a},backend:n});let l=o.shape.length,c=j.parseAxisParam(s,o.shape),u=P.getAxesPermutation(c,l),h=c,p=o;u!=null&&(p=Va({inputs:{x:o},backend:n,attrs:{perm:u}}),h=P.getInnerMostAxes(h.length,l)),P.assertAxesAreInnerMostDims("sum",h,p.shape.length);let[f,g]=P.computeOutAndReduceShapes(p.shape,h),m=P.upcastType(p.dtype,"int32"),y=X1(n,f,m),x=j.sizeFromShape(g),v=n.data.get(y.dataId).values,b=n.data.get(p.dataId).values;for(let w=0;w<v.length;++w){let k=w*x,I=0;for(let C=0;C<x;++C)I+=b[k+C];v[w]=I}if(i){let w=P.expandShapeToKeepDim(y.shape,c),k=y;y=En({inputs:{x:y},backend:n,attrs:{shape:w}}),n.disposeIntermediateTensorInfo(k)}return n.disposeIntermediateTensorInfo(o),u!=null&&n.disposeIntermediateTensorInfo(p),y}var T4e={kernelName:vp,backendName:"cpu",kernelFunc:Wb};function j4e(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,s=t,{allDims:i,summedDims:o,idDims:l}=P.decodeEinsumEquation(a,s.length);P.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=P.getEinsumComputePath(o,l),h=u.length,p=null,f=i.length,g=[];for(let m=0;m<h;++m){for(let y of u[m]){let{permutationIndices:x,expandDims:v}=P.getEinsumPermutation(f,l[y]),b;P.isIdentityPermutation(x)?b=s[y]:(b=Va({inputs:{x:s[y]},backend:n,attrs:{perm:x}}),g.push(b));let w=b.shape.slice();for(let k=0;k<v.length;++k)w.splice(v[k],0,1);j.arraysEqual(b.shape,w)||(b=En({inputs:{x:b},backend:n,attrs:{shape:w}}),g.push(b)),p===null?p=b:(p=GS({inputs:{a:b,b:p},backend:n}),g.push(p))}m<h-1&&(c[m]>=0&&(p=Wb({inputs:{x:p},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),g.push(p)),f--)}for(let m of g)m!==p&&n.disposeIntermediateTensorInfo(m);return p}var A4e={kernelName:Rk,backendName:"cpu",kernelFunc:j4e};function $4e(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t;Xe([r,a],"eluGrad");let s=new Float32Array(j.sizeFromShape(a.shape)),i=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<i.length;++l){let c=i[l];c>=0?s[l]=o[l]:s[l]=o[l]*(c+1)}return n.makeTensorInfo(a.shape,"float32",s)}var R4e={kernelName:ug,backendName:"cpu",kernelFunc:$4e},D4e=P.ERF_P,M4e=P.ERF_A1,O4e=P.ERF_A2,F4e=P.ERF_A3,P4e=P.ERF_A4,L4e=P.ERF_A5,z4e=mn(Th,e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+D4e*n);return t*(1-((((L4e*r+P4e)*r+F4e)*r+O4e)*r+M4e)*r*Math.exp(-n*n))}),B4e={kernelName:Th,backendName:"cpu",kernelFunc:z4e};function Z1(e){let{inputs:t,backend:n,attrs:r}=e,{input:a}=t,{dim:s}=r,i=a.shape.length,o=a.shape.slice(),l=s;return s<0&&(j.assert(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),o.splice(l,0,1),En({inputs:{x:a},backend:n,attrs:{shape:o}})}var U4e={kernelName:dg,backendName:"cpu",kernelFunc:Z1},W4e=ir((e,t)=>e/t),VD=Sr(Ih,W4e),CE={kernelName:Ih,backendName:"cpu",kernelFunc:VD};function AQ(e,t,n){let r=e.shape,a=r[0],s=r[1],i=n.data.get(e.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[a,s],u=j.sizeFromShape(c),h=j.getTypedArrayFromDType("float32",u),p=j.getTypedArrayFromDType("float32",u);for(let y=0;y<a;y++){let x=Gd({inputs:{x:o},backend:n,attrs:{begin:[y,0],size:[1,s]}}),v=Gd({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,s]}}),b=os({inputs:{real:x,imag:v},backend:n}),{real:w,imag:k}=V4e(b,t,n),I=P.mergeRealAndImagArrays(w,k);for(let C=0;C<s;C++){let S=P.getComplexWithIndex(I,C);h[y*s+C]=S.real,p[y*s+C]=S.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b)}let f=n.makeTensorInfo(c,"float32",h),g=n.makeTensorInfo(c,"float32",p),m=os({inputs:{real:f,imag:g},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}function V4e(e,t,n){let r=j.sizeFromShape(e.shape),a=n.data.get(e.dataId),s=n.data.get(a.complexTensorInfos.real.dataId).values,i=n.data.get(a.complexTensorInfos.imag.dataId).values;if(H4e(r)){let o=IE(s,i,r,t,n),l=[e.shape[0],e.shape[1]];if(t){let c=n.makeTensorInfo(l,"float32",o.real),u=n.makeTensorInfo(l,"float32",o.imag),h=n.makeTensorInfo([],"float32",j.createScalarValue(r,"float32")),p=Mo({inputs:{x:h},backend:n}),f=CE.kernelFunc({inputs:{a:c,b:h},backend:n}),g=CE.kernelFunc({inputs:{a:u,b:p},backend:n}),m=n.data.get(f.dataId).values,y=n.data.get(g.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),{real:m,imag:y}}return o}else{let o=P.mergeRealAndImagArrays(s,i),l=G4e(o,r,t);return P.splitRealAndImagArrays(l)}}function H4e(e){return(e&e-1)===0}function IE(e,t,n,r,a){if(n===1)return{real:e,imag:t};let s=P.mergeRealAndImagArrays(e,t),i=n/2,o=P.complexWithEvenIndex(s),l=o.real,c=o.imag,u=[l.length],h=a.makeTensorInfo(u,"float32",l),p=a.makeTensorInfo(u,"float32",c),f=os({inputs:{real:h,imag:p},backend:a}),g=P.complexWithOddIndex(s),m=g.real,y=g.imag,x=[m.length],v=a.makeTensorInfo(x,"float32",m),b=a.makeTensorInfo(x,"float32",y),w=os({inputs:{real:v,imag:b},backend:a}),k=IE(l,c,i,r,a),I=k.real,C=k.imag,S=[I.length],E=a.makeTensorInfo(S,"float32",I),T=a.makeTensorInfo(S,"float32",C),$=os({inputs:{real:E,imag:T},backend:a}),_=IE(m,y,i,r,a),M=_.real,L=_.imag,U=[M.length],O=a.makeTensorInfo(U,"float32",M),F=a.makeTensorInfo(U,"float32",L),D=os({inputs:{real:O,imag:F},backend:a}),R=P.exponents(n,r),V=[R.real.length],G=a.makeTensorInfo(V,"float32",R.real),W=a.makeTensorInfo(V,"float32",R.imag),B=os({inputs:{real:G,imag:W},backend:a}),Q=GS({inputs:{a:B,b:D},backend:a}),X=Nm({inputs:{a:$,b:Q},backend:a}),pe=BD({inputs:{a:$,b:Q},backend:a}),ie=Hd({inputs:{input:X},backend:a}),oe=Hd({inputs:{input:pe},backend:a}),q=km({inputs:{input:X},backend:a}),de=km({inputs:{input:pe},backend:a}),ye=Sm({inputs:[ie,oe],backend:a,attrs:{axis:0}}),be=Sm({inputs:[q,de],backend:a,attrs:{axis:0}}),Ce=a.data.get(ye.dataId).values,se=a.data.get(be.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo($),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(Q),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(pe),a.disposeIntermediateTensorInfo(ie),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(oe),a.disposeIntermediateTensorInfo(de),a.disposeIntermediateTensorInfo(ye),a.disposeIntermediateTensorInfo(be),{real:Ce,imag:se}}function G4e(e,t,n){let r=new Float32Array(t*2);for(let a=0;a<t;a++){let s=0,i=0;for(let o=0;o<t;o++){let l=P.exponent(a*o,t,n),c=P.getComplexWithIndex(e,o);s+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(s/=t,i/=t),P.assignToTypedArray(r,s,i,a)}return r}function q4e(e){let{inputs:t,backend:n}=e,{input:r}=t,a=j.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=a/s,o=En({inputs:{x:r},backend:n,attrs:{shape:[i,s]}}),l=AQ(o,!1,n),c=En({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}var K4e={kernelName:Dk,backendName:"cpu",kernelFunc:q4e};function HD(e){let{backend:t,attrs:n}=e,{shape:r,value:a,dtype:s}=n,i=s||j.inferDtype(a),o=j.getArrayFromDType(i,j.sizeFromShape(r));return X4e(o,a),t.makeTensorInfo(r,i,o)}var Q4e={kernelName:eb,backendName:"cpu",kernelFunc:HD};function X4e(e,t,n){e.fill(t)}var Y4e={kernelName:hg,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,a=n,s=j.getTypedArrayFromDType(r.dtype,j.sizeFromShape(r.shape)),[i,o,l,c]=r.shape,u=a.data.get(r.dataId).values;for(let h=0;h<i;h++){let p=h*l*o*c;for(let f=0;f<o;f++){let g=f*(l*c);for(let m=0;m<l;m++){let y=m*c;for(let x=0;x<c;x++){let v=Math.round(l-m-1),b=p+g+y+x,w=u[b];if(v>=0&&v<l){let k=v*c,I=p+g+k+x;w=u[I]}s[b]=w}}}}return{dataId:a.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function J4e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r,m=TQ({inputs:{x:a,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}});if(i){let y=m;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){let x=En({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=Nm({inputs:{a:m,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else m=Nm({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(y)}if(f){let y=m;if(u==="NCHW"&&f==="prelu"&&o.shape.length===1&&o.shape[0]!==1){let x=En({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=J1(n,m,f,x,g),n.disposeIntermediateTensorInfo(x)}else m=J1(n,m,f,o,g);n.disposeIntermediateTensorInfo(y)}return m}var Z4e={kernelName:Rd,backendName:"cpu",kernelFunc:J4e};function eze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r,m=jQ({inputs:{x:a,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p}});if(i){let y=m;m=Nm({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(y)}if(f){let y=m;m=J1(n,m,f,o,g),n.disposeIntermediateTensorInfo(y)}return m}var tze={kernelName:Dd,backendName:"cpu",kernelFunc:eze};function nze(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,s=j.sizeFromShape(r.shape),i=a.shape,o=i[i.length-1],[l,c,u,h]=P.prepareAndValidate(r,a);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);let p=n.data.get(a.dataId).values,f=n.bufferSync(r),g=q9(p,f,r.dtype,c,o,u,h,r.shape,s);return n.makeTensorInfo(l,r.dtype,g.values)}var rze={kernelName:fg,backendName:"cpu",kernelFunc:nze};function aze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:s}=t,{axis:i,batchDims:o}=r;Xe([a,s],"gatherV2");let l=j.parseAxisParam(i,a.shape)[0],c=n.data.get(s.dataId).values,u=a.shape[l];for(let w=0;w<c.length;++w){let k=c[w];j.assert(k<=u-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${u-1}]`)}let h=o;o==null&&(h=0);let p=j.sizeFromShape(s.shape),f=P.segment_util.collectGatherOpShapeInfo(a,s,l,h),g=En({inputs:{x:a},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=En({inputs:{x:s},backend:n,attrs:{shape:[f.batchSize,p/f.batchSize]}}),y=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize],x=n.bufferSync(m),v=n.bufferSync(g),b=K9(v,x,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}var sze={kernelName:pg,backendName:"cpu",kernelFunc:aze};function ize(e){let{inputs:t,backend:n}=e,{input:r}=t,a=j.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=a/s,o=En({inputs:{x:r},backend:n,attrs:{shape:[i,s]}}),l=AQ(o,!0,n),c=En({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}var oze={kernelName:Mk,backendName:"cpu",kernelFunc:ize},lze=mn(Fh,e=>Number.isFinite(e)?1:0,"bool"),uze={kernelName:Fh,backendName:"cpu",kernelFunc:lze},cze=mn(Ph,e=>Math.abs(e)===1/0?1:0,"bool"),dze={kernelName:Ph,backendName:"cpu",kernelFunc:cze},hze=mn(Lh,e=>Number.isNaN(e)?1:0,"bool"),pze={kernelName:Lh,backendName:"cpu",kernelFunc:hze};function fze(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:s}=n,i=Z9(r,a,s);return t.makeTensorInfo([i.length],"float32",i)}var mze={kernelName:xg,backendName:"cpu",kernelFunc:fze},gze=mn(Uh,e=>Math.log1p(e)),yze={kernelName:Uh,backendName:"cpu",kernelFunc:gze},xze=ir((e,t)=>e&&t),vze=Sr(vg,xze,null,"bool"),bze={kernelName:vg,backendName:"cpu",kernelFunc:vze},wze=mn(bg,e=>e?0:1,"bool"),Nze={kernelName:bg,backendName:"cpu",kernelFunc:wze},kze=ir((e,t)=>e||t),Sze=Sr(wg,kze,null,"bool"),_ze={kernelName:wg,backendName:"cpu",kernelFunc:Sze};function Cze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:s,bias:i,alpha:o,beta:l}=r;Xe(a,"LRN");let c=a.shape[3],u=c-1,h=n.data.get(a.dataId).values,p=j.sizeFromShape(a.shape),f=new Float32Array(p);function g(m){let y=m%c,x=m-y+Math.max(0,y-s),v=m-y+Math.min(y+s,u),b=0;for(;x<=v;x++){let w=h[x];b+=w*w}return b}for(let m=0;m<p;m++){let y=g(m),x=h[m]*Math.pow(i+o*y,-l);f[m]=x}return n.makeTensorInfo(a.shape,a.dtype,f)}var Ize={kernelName:Wh,backendName:"cpu",kernelFunc:Cze};function Eze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:s,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r;Xe(i,"LRNGrad");let h=j.sizeFromShape(i.shape),p=i.shape[3],f=n.data.get(i.dataId).values,g=n.data.get(a.dataId).values,m=n.data.get(s.dataId).values,y=new Float32Array(h),x=h;for(let v=0;v<x;v++){let b=v%p,w=v-b+Math.max(0,b-o),k=v-b+Math.min(p,b+o+1),I=0;for(let C=w;C<k;C++)I+=Math.pow(g[C],2);I=c*I+l;for(let C=w;C<k;C++){let S=-2*c*u*g[C]*m[v]/I;v===C&&(S+=Math.pow(I,-u)),S*=f[v],y[C]+=S}}return n.makeTensorInfo(i.shape,a.dtype,y)}var Tze={kernelName:Ng,backendName:"cpu",kernelFunc:Eze};function $Q(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:s,keepDims:i}=r,o=n,l=a.shape,c=l.length,u=j.parseAxisParam(s,l),h=u,p=P.getAxesPermutation(h,c),f=o.data.get(a.dataId).values;if(p!=null){let w=new Array(c);for(let k=0;k<w.length;k++)w[k]=l[p[k]];f=MD(f,l,a.dtype,p,w),h=P.getInnerMostAxes(h.length,c),l=w}Xe(a,"max"),P.assertAxesAreInnerMostDims("max",h,c);let[g,m]=P.computeOutAndReduceShapes(l,h),y=j.sizeFromShape(m),x=tQ(f,y,g,a.dtype),v=o.write(x,g,a.dtype),b=g;return i&&(b=P.expandShapeToKeepDim(g,u)),{dataId:v,shape:b,dtype:a.dtype}}var jze={kernelName:Vh,backendName:"cpu",kernelFunc:$Q};function Aze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Xe(a,"maxPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=r,c=1;j.assert(P.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=P.computePool2DInfo(a.shape,s,i,c,o,l),h;if(u.filterWidth===1&&u.filterHeight===1&&j.arraysEqual(u.inShape,u.outShape))h=Mo({inputs:{x:a},backend:n});else{let p=n.data.get(a.dataId).values,f=j.computeStrides(a.shape),g=WD(p,a.shape,a.dtype,f,u,"max");h=n.makeTensorInfo(u.outShape,a.dtype,g.values)}return h}var $ze={kernelName:Gh,backendName:"cpu",kernelFunc:Aze};function Rze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=r;Xe(a,"maxPool3d");let u=P.computePool3DInfo(a.shape,s,i,1,o,l,c),h=n.data.get(a.dataId).values,p=EQ(h,a.shape,a.dtype,j.computeStrides(a.shape),u,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}var Dze={kernelName:kg,backendName:"cpu",kernelFunc:Rze};function Mze(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=r;Xe([a,s],"maxPool3DGrad");let u=P.computePool3DInfo(s.shape,i,o,1,l,c),h=n.bufferSync(s),p=k3e(h,u),f=u.strideDepth,g=u.strideHeight,m=u.strideWidth,y=u.dilationDepth,x=u.dilationHeight,v=u.dilationWidth,b=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,I=b-1-u.padInfo.front,C=k-1-u.padInfo.left,S=w-1-u.padInfo.top,E=jt(s.shape,"float32"),T=n.bufferSync(a);for(let $=0;$<u.batchSize;++$)for(let _=0;_<u.inChannels;++_)for(let M=0;M<u.inDepth;++M)for(let L=0;L<u.inHeight;++L)for(let U=0;U<u.inWidth;++U){let O=M-I,F=L-S,D=U-C,R=0;for(let V=0;V<b;V+=y){let G=(O+V)/f;if(!(G<0||G>=u.outDepth||Math.floor(G)!==G))for(let W=0;W<w;W+=x){let B=(F+W)/g;if(!(B<0||B>=u.outHeight||Math.floor(B)!==B))for(let Q=0;Q<k;Q+=v){let X=(D+Q)/m;if(X<0||X>=u.outWidth||Math.floor(X)!==X)continue;let pe=b*w*k-1-p.get($,G,B,X,_),ie=V*w*k+W*k+Q,oe=pe===ie?1:0;if(oe===0)continue;let q=T.get($,G,B,X,_);R+=q*oe}}}E.set(R,$,M,L,U,_)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}var Oze={kernelName:nb,backendName:"cpu",kernelFunc:Mze};function Fze(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s,output:i}=t,o=s;Xe([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=r,p=P.computePool2DInfo(o.shape,l,c,1,u,h),f=n.data.get(o.dataId).values,g=jt(p.outShape,o.dtype,IQ(f,o.shape,o.dtype,p).values),m=p.strideHeight,y=p.strideWidth,x=p.dilationHeight,v=p.dilationWidth,b=p.effectiveFilterHeight,w=p.effectiveFilterWidth,k=w-1-p.padInfo.left,I=b-1-p.padInfo.top,C=jt(o.shape,"float32"),S=n.data.get(a.dataId).values,E=jt(a.shape,"float32",S);for(let T=0;T<p.batchSize;++T)for(let $=0;$<p.inChannels;++$)for(let _=0;_<p.inHeight;++_)for(let M=0;M<p.inWidth;++M){let L=_-I,U=M-k,O=0;for(let F=0;F<b;F+=x){let D=(L+F)/m;if(!(D<0||D>=p.outHeight||Math.floor(D)!==D))for(let R=0;R<w;R+=v){let V=(U+R)/y;if(V<0||V>=p.outWidth||Math.floor(V)!==V)continue;let G=b*w-1-g.get(T,D,V,$),W=F*w+R,B=G===W?1:0;if(B===0)continue;let Q=E.get(T,D,V,$);O+=Q*B}}C.set(O,T,_,M,$)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}var Pze={kernelName:tb,backendName:"cpu",kernelFunc:Fze};function Lze(e,t,n,r,a){let s=j.computeStrides(t),i=WD(e,t,n,s,a,"max"),o=IQ(e,t,n,a,!0,r);return[i.values,o.values]}var zze={kernelName:rb,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:s,pad:i,includeBatchInIndex:o}=t,l=n;Xe(r,"MaxPoolWithArgmax");let c=l.data.get(r.dataId).values,u=P.computePool2DInfo(r.shape,a,s,[1,1],i),[h,p]=Lze(c,r.shape,r.dtype,o,u),f=l.write(h,u.outShape,r.dtype),g=l.write(p,u.outShape,r.dtype);return[{dataId:f,shape:u.outShape,dtype:r.dtype},{dataId:g,shape:u.outShape,dtype:"int32"}]}};function Bze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r,o=j.parseAxisParam(s,a.shape),l=P.computeOutAndReduceShapes(a.shape,o)[1],c=j.sizeFromShape(l),u=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));u.push(h);let p=tc({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});u.push(p);let f=VD({inputs:{a:p,b:h},backend:n});u.push(f);let g=Wb({inputs:{x:f},backend:n,attrs:{axis:s,keepDims:i}});return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}var Uze={kernelName:qh,backendName:"cpu",kernelFunc:Bze};function Wze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r;Xe(a,"min");let o=j.parseAxisParam(s,a.shape),l=o,c=P.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Va({inputs:{x:a},backend:n,attrs:{perm:c}}),l=P.getInnerMostAxes(l.length,a.shape.length)),P.assertAxesAreInnerMostDims("min",l,u.shape.length);let[h,p]=P.computeOutAndReduceShapes(u.shape,l),f=j.sizeFromShape(p),g=j.makeZerosTypedArray(j.sizeFromShape(h),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<g.length;++x){let v=x*f,b=m[v];for(let w=0;w<f;++w){let k=m[v+w];(Number.isNaN(k)||k<b)&&(b=k)}g[x]=b}c!=null&&n.disposeIntermediateTensorInfo(u);let y=n.makeTensorInfo(h,u.dtype,g);if(i){let x=P.expandShapeToKeepDim(h,o),v=En({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}var Vze={kernelName:Kh,backendName:"cpu",kernelFunc:Wze};function Hze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:s,mode:i}=r;Xe(a,"mirrorPad");let o=s.map((v,b)=>v[0]+a.shape[b]+v[1]),l=s.map(v=>v[0]),c=s.map((v,b)=>v[0]+a.shape[b]),u=i==="reflect"?0:1,h=n.data.get(a.dataId).values,p=a.shape.length,f=j.computeStrides(a.shape),g=j.sizeFromShape(o),m=o.length,y=j.computeStrides(o),x=j.getTypedArrayFromDType(a.dtype,g);for(let v=0;v<g;v++){let b=j.indexToLoc(v,m,y);for(let k=0;k<m;k++)b[k]<l[k]?b[k]=l[k]*2-b[k]-u:b[k]>=c[k]&&(b[k]=(c[k]-1)*2-b[k]+u);b=b.map((k,I)=>k-l[I]);let w=j.locToIndex(b,p,f);x[v]=h[w]}return{dataId:n.write(x,o,a.dtype),shape:o,dtype:a.dtype}}var Gze={kernelName:Xh,backendName:"cpu",kernelFunc:Hze},qze=ir((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),Kze=Sr(Yh,qze),Qze={kernelName:Yh,backendName:"cpu",kernelFunc:Kze},Xze=fc(Sk());function RQ(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:s}=r,i=a.shape.length,o=s;if(o===-1&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);let l=j.parseAxisParam([o],a.shape),c=$Q({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=P.expandShapeToKeepDim(c.shape,l),h=En({inputs:{x:c},backend:n,attrs:{shape:u}}),p=BD({inputs:{a,b:h},backend:n}),f=W9({inputs:{x:p},backend:n}),g=Wb({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=En({inputs:{x:g},backend:n,attrs:{shape:u}}),y=VD({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}var Yze={kernelName:bp,backendName:"cpu",kernelFunc:RQ};function Jze(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:s,seed:i,normalized:o}=r;Xe(a,"multinomial");let l=o?a:RQ({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,p=[c,s],f=j.makeZerosTypedArray(j.sizeFromShape(p),"int32");for(let g=0;g<c;++g){let m=g*u,y=new Float32Array(u-1);y[0]=h[m];for(let b=1;b<y.length;++b)y[b]=y[b-1]+h[m+b];let x=Xze.alea(i.toString()),v=g*s;for(let b=0;b<s;++b){let w=x();f[v+b]=y.length;for(let k=0;k<y.length;k++)if(w<y[k]){f[v+b]=k;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",f)}var Zze={kernelName:Sg,backendName:"cpu",kernelFunc:Jze},eBe=Bo.nonMaxSuppressionV3Impl;function tBe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=r;Xe(a,"NonMaxSuppression");let c=n.data.get(a.dataId).values,u=n.data.get(s.dataId).values,{selectedIndices:h}=eBe(c,u,i,o,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}var nBe={kernelName:Ig,backendName:"cpu",kernelFunc:tBe},rBe=Bo.nonMaxSuppressionV4Impl;function aBe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r;Xe(a,"NonMaxSuppressionPadded");let u=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,{selectedIndices:p,validOutputs:f}=rBe(u,h,i,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}var sBe={kernelName:Eg,backendName:"cpu",kernelFunc:aBe},iBe=Bo.nonMaxSuppressionV5Impl;function oBe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r;Xe(a,"NonMaxSuppressionWithScore");let u=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,p=i,f=o,g=l,m=c,{selectedIndices:y,selectedScores:x}=iBe(u,h,p,f,g,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}var lBe={kernelName:Tg,backendName:"cpu",kernelFunc:oBe};function uBe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:s,depth:i,onValue:o,offValue:l}=r;Xe(a,"oneHot");let c=j.sizeFromShape(a.shape),u=new Float32Array(c*i);u.fill(l);let h=n.data.get(a.dataId).values;for(let p=0;p<c;++p)h[p]>=0&&h[p]<i&&(u[p*i+h[p]]=o);return n.makeTensorInfo([...a.shape,i],s,u)}var cBe={kernelName:Zh,backendName:"cpu",kernelFunc:uBe};function eN(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let a=Hd({inputs:{input:r},backend:n}),s=eN({inputs:{x:a},backend:n}),i=km({inputs:{input:r},backend:n}),o=eN({inputs:{x:i},backend:n}),l=os({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return HD({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var dBe={kernelName:Kg,backendName:"cpu",kernelFunc:eN};function DQ(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let a=Hd({inputs:{input:r},backend:n}),s=DQ({inputs:{x:a},backend:n}),i=km({inputs:{input:r},backend:n}),o=eN({inputs:{x:i},backend:n}),l=os({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return HD({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var hBe={kernelName:jg,backendName:"cpu",kernelFunc:DQ};function MQ(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return Z1({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let s=t[0].shape,i=t[0].dtype;t.forEach(u=>{j.assertShapesMatch(s,u.shape,"All tensors passed to stack must have matching shapes"),j.assert(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let h=Z1({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(h),h}),c=Sm({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}var pBe={kernelName:Ag,backendName:"cpu",kernelFunc:MQ};function fBe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:s,constantValue:i}=r;Xe(a,"pad");let o=s.map((x,v)=>x[0]+a.shape[v]+x[1]),l=s.map(x=>x[0]),c=n.data.get(a.dataId).values,u=j.sizeFromShape(a.shape),h=a.shape.length,p=j.computeStrides(a.shape),f=j.sizeFromShape(o),g=o.length,m=j.computeStrides(o),y=j.getTypedArrayFromDType(a.dtype,f);i!==0&&y.fill(i);for(let x=0;x<u;x++){let v=j.indexToLoc(x,h,p).map((w,k)=>w+l[k]),b=j.locToIndex(v,g,m);y[b]=c[x]}return{dataId:n.write(y,o,a.dtype),shape:o,dtype:a.dtype}}var OQ={kernelName:ep,backendName:"cpu",kernelFunc:fBe},mBe=ir((e,t)=>Math.pow(e,t)),gBe=Sr(tp,mBe),yBe={kernelName:tp,backendName:"cpu",kernelFunc:gBe};function xBe(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:s,indices:i}=t,{outputRaggedRank:o}=r,l=a.map(x=>n.data.get(x.dataId).values),c=a.map(x=>x.shape),u=n.data.get(s.dataId).values,h=n.data.get(i.dataId).values,[p,f,g]=oQ(l,c,u,s.shape,s.dtype,h,i.shape),m=p.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(g,s.dtype,f);return m.concat([y])}var vBe={kernelName:Fk,backendName:"cpu",kernelFunc:xBe};function bBe(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:s}=t,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values,[c,u]=lQ(i,r.shape,r.dtype,o,a.shape,l,s.shape),h=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([u.length],r.dtype,u);return[h,p]}var wBe={kernelName:Pk,backendName:"cpu",kernelFunc:bBe};function NBe(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:s,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.data.get(a.dataId).values,u=n.data.get(s.dataId).values,h=n.data.get(i.dataId).values,p=o.map(y=>n.data.get(y.dataId).values),f=o.map(y=>y.shape),[g,m]=uQ(c,a.shape,u,s.shape,s.dtype,h,i.shape,p,f,l);return n.makeTensorInfo(g,s.dtype,m)}var kBe={kernelName:Lk,backendName:"cpu",kernelFunc:NBe};function SBe(e){let{backend:t,attrs:n}=e,{start:r,stop:a,dtype:s,step:i}=n,o=OD(r,a,i,s);return t.makeTensorInfo([o.length],s,o)}var _Be={kernelName:ab,backendName:"cpu",kernelFunc:SBe},CBe=mn(ap,e=>1/e),IBe={kernelName:ap,backendName:"cpu",kernelFunc:CBe};function EBe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=r;Xe(a,"resizeBilinear");let l=j.computeStrides(a.shape),[c,u]=o,[h,p,f,g]=a.shape,m=n.data.get(a.dataId).values,y=new Float32Array(j.sizeFromShape([h,c,u,g])),x=[s&&c>1?p-1:p,s&&u>1?f-1:f],v=[s&&c>1?c-1:c,s&&u>1?u-1:u],b=0,w=x[0]/v[0],k=x[1]/v[1];for(let I=0;I<h;I++)for(let C=0;C<c;C++){let S;i?S=w*(C+.5)-.5:S=w*C;let E=Math.max(0,Math.floor(S)),T=S-E,$=Math.min(p-1,Math.ceil(S)),_=I*l[0]+E*l[1],M=I*l[0]+$*l[1];for(let L=0;L<u;L++){let U;i?U=k*(L+.5)-.5:U=k*L;let O=Math.max(0,Math.floor(U)),F=U-O,D=Math.min(f-1,Math.ceil(U)),R=_+O*l[2],V=M+O*l[2],G=_+D*l[2],W=M+D*l[2];for(let B=0;B<g;B++){let Q=m[R+B],X=m[V+B],pe=m[G+B],ie=m[W+B],oe=Q+(pe-Q)*F,q=X+(ie-X)*F,de=oe+(q-oe)*T;y[b++]=de}}}return n.makeTensorInfo([h,c,u,g],"float32",y)}var TBe={kernelName:op,backendName:"cpu",kernelFunc:EBe};function jBe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:s}=t,{alignCorners:i}=r;Xe([s,a],"resizeBilinearGrad");let o=j.computeStrides(a.shape),[l,c,u,h]=a.shape,[,p,f]=s.shape,g=new Float32Array(l*c*u*h),m=[i&&p>1?c-1:c,i&&f>1?u-1:u],y=[i&&p>1?p-1:p,i&&f>1?f-1:f],x=m[0]/y[0],v=m[1]/y[1],b=n.data.get(s.dataId).values,w=0;for(let k=0;k<l;k++){let I=k*o[0];for(let C=0;C<p;C++){let S=C*x,E=Math.floor(S),T=Math.min(Math.ceil(S),c-1),$=I+E*o[1],_=I+T*o[1],M=S-E,L=1-M;for(let U=0;U<f;U++){let O=U*v,F=Math.floor(O),D=Math.min(Math.ceil(O),u-1),R=O-F,V=1-R,G=$+F*o[2],W=$+D*o[2],B=_+F*o[2],Q=_+D*o[2],X=L*V,pe=L*R,ie=M*V,oe=M*R;for(let q=0;q<h;q++){let de=b[w++];g[G+q]+=de*X,g[W+q]+=de*pe,g[B+q]+=de*ie,g[Q+q]+=de*oe}}}}return n.makeTensorInfo([l,u,c,h],"float32",g)}var ABe={kernelName:Dg,backendName:"cpu",kernelFunc:jBe};function $Be(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=r;Xe(a,"resizeNearestNeighbor");let l=j.computeStrides(a.shape),[c,u]=o,[h,p,f,g]=a.shape,m=n.data.get(a.dataId).values,y=new Float32Array(h*c*u*g),x=[s&&c>1?p-1:p,s&&u>1?f-1:f],v=[s&&c>1?c-1:c,s&&u>1?u-1:u],b=x[0]/v[0],w=x[1]/v[1],k=0;for(let I=0;I<h;I++){let C=I*l[0];for(let S=0;S<c;S++){let E=i?b*(S+.5):b*S,T=Math.min(p-1,s?Math.round(E):Math.floor(E));i&&(T=Math.max(0,T));let $=C+T*l[1];for(let _=0;_<u;_++){let M=i?w*(_+.5):w*_,L=Math.min(f-1,s?Math.round(M):Math.floor(M));i&&(L=Math.max(0,L));let U=$+L*l[2];for(let O=0;O<g;O++){let F=m[U+O];y[k++]=F}}}}return n.makeTensorInfo([h,c,u,g],a.dtype,y)}var RBe={kernelName:ip,backendName:"cpu",kernelFunc:$Be};function DBe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:s}=t,{alignCorners:i}=r;Xe([s,a],"resizeNearestNeighborGrad");let o=j.computeStrides(a.shape),l=j.computeStrides(s.shape),[c,u,h,p]=a.shape,[,f,g]=s.shape,m=new Float32Array(c*u*h*p),y=n.data.get(s.dataId).values,x=[i&&f>1?u-1:u,i&&g>1?h-1:h],v=[i&&f>1?f-1:f,i&&g>1?g-1:g],b=x[0]/v[0],w=x[1]/v[1],k=1/b,I=1/w,C=Math.ceil(k)*2+2,S=Math.ceil(I)*2+2;for(let E=0;E<c;E++){let T=E*o[0];for(let $=0;$<u;$++){let _=T+$*o[1],M=Math.floor($*k),L=Math.floor(M-C/2);for(let U=0;U<h;U++){let O=_+U*o[2],F=Math.floor(U*I),D=Math.floor(F-S/2);for(let R=0;R<p;R++){let V=0;for(let G=0;G<C;G++){let W=G+L;if(W<0||W>=f)continue;let B=T+W*l[1],Q=W*b,X=Math.min(u-1,i?Math.round(Q):Math.floor(Q));if($===X)for(let pe=0;pe<S;pe++){let ie=pe+D;if(ie<0||ie>=g)continue;let oe=B+ie*l[2],q=ie*w,de=Math.min(h-1,i?Math.round(q):Math.floor(q));U===de&&(V+=y[oe+R])}}m[O+R]=V}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}var MBe={kernelName:Rg,backendName:"cpu",kernelFunc:DBe};function OBe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:s}=r;Xe(a,"reverse");let i=a.shape.length,o=j.parseAxisParam(s,a.shape);if(i===0)return Mo({inputs:{x:a},backend:n});let l=new hr(a.shape,a.dtype),c=n.bufferSync(a);for(let u=0;u<l.size;u++){let h=l.indexToLoc(u),p=h.slice();o.forEach(f=>p[f]=a.shape[f]-1-p[f]),l.set(c.get(...p),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}var FBe={kernelName:up,backendName:"cpu",kernelFunc:OBe},PBe={kernelName:Qg,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:s,center:i}=t,o=n,l=j.getTypedArrayFromDType(r.dtype,j.sizeFromShape(r.shape)),[c,u,h,p]=r.shape,[f,g]=P.getImageCenter(i,u,h),m=255,y=Math.sin(a),x=Math.cos(a),v=o.data.get(r.dataId).values;for(let b=0;b<c;b++){let w=b*h*u*p;for(let k=0;k<u;k++){let I=k*(h*p);for(let C=0;C<h;C++){let S=C*p;for(let E=0;E<p;E++){let T=[c,k,C,E],$=T[2],_=T[1],M=($-f)*x-(_-g)*y,L=($-f)*y+(_-g)*x;M=Math.round(M+f),L=Math.round(L+g);let U=s;if(typeof s!="number"&&(E===3?U=m:U=s[E]),M>=0&&M<h&&L>=0&&L<u){let F=L*(h*p),D=M*p,R=w+F+D+E;U=v[R]}let O=w+I+S+E;l[O]=U}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},LBe=mn(cp,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),zBe={kernelName:cp,backendName:"cpu",kernelFunc:LBe};function BBe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:s}=t,{shape:i}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=P.calculateShapes(s,a,i),p=!0,f=n.bufferSync(a),g=n.bufferSync(s),m=Zc(f,g,i,h,c,l,o,u,0,p);return n.makeTensorInfo(i,m.dtype,m.values)}var UBe={kernelName:Mg,backendName:"cpu",kernelFunc:BBe};function WBe(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<t?n=a+1:r=a;return r}function VBe(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<=t?n=a+1:r=a;return r}function HBe(e,t,n,r,a,s){let i=j.getArrayFromDType("int32",n*a);for(let o=0;o<n;++o){let l=e.slice(o*r,(o+1)*r),c=o*a;for(let u=0;u<a;++u)i[c+u]=s==="left"?WBe(l,t[u+c]):VBe(l,t[u+c])}return i}function GBe(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:s}=t,{side:i}=r,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values,c=HBe(o,l,a.shape[0],a.shape[1],s.shape[1],i);return n.makeTensorInfo(s.shape,"int32",c)}var qBe={kernelName:Fg,backendName:"cpu",kernelFunc:GBe};function KBe(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:s}=t;Xe([r,a,s],"select");let i=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(s.dataId).values,u=Bs(a.dtype,s.dtype),h=j.makeZerosTypedArray(j.sizeFromShape(a.shape),u),p=0,f=i===0||i>1||a.shape.length===1?1:j.sizeFromShape(a.shape.slice(1));for(let g=0;g<o.length;g++)for(let m=0;m<f;m++)o[g]===1?h[p++]=l[g]:h[p++]=c[g];return n.makeTensorInfo(a.shape,u,h)}var QBe={kernelName:Pg,backendName:"cpu",kernelFunc:KBe},XBe=P.SELU_SCALEALPHA,YBe=P.SELU_SCALE,JBe=mn(hp,e=>e>=0?YBe*e:XBe*(Math.exp(e)-1)),ZBe={kernelName:hp,backendName:"cpu",kernelFunc:JBe},eUe=mn(mp,e=>e<0?-1:e>0?1:0),tUe={kernelName:mp,backendName:"cpu",kernelFunc:eUe},nUe=mn(pp,e=>Math.sin(e)),rUe={kernelName:pp,backendName:"cpu",kernelFunc:nUe},aUe=mn(fp,e=>Math.sinh(e)),sUe={kernelName:fp,backendName:"cpu",kernelFunc:aUe},iUe=11920928955078125e-23,d3=Math.log(iUe)+2,oUe=mn(yp,e=>{let t=e>-d3,n=e<d3,r=Math.exp(e),a;return n?a=r:t?a=e:a=Math.log(1+r),a}),lUe={kernelName:yp,backendName:"cpu",kernelFunc:oUe};function uUe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,paddings:i}=r;Xe([a],"spaceToBatchND");let o=j.sizeFromShape(s),l=[[0,0]];l.push(...i);for(let y=1+s.length;y<a.shape.length;++y)l.push([0,0]);let c=OQ.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),u=P.getReshaped(c.shape,s,o,!1),h=P.getPermuted(u.length,s.length,!1),p=P.getReshapedPermuted(c.shape,s,o,!1),f=En({inputs:{x:c},backend:n,attrs:{shape:u}}),g=Va({inputs:{x:f},backend:n,attrs:{perm:h}}),m=En({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}var cUe={kernelName:zg,backendName:"cpu",kernelFunc:uUe};function dUe(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:s,defaultValue:i}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values[0],[h,p,f,g,m]=hQ(o,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(p,r.dtype,h),n.makeTensorInfo([p[0]],a.dtype,f),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(y=>Number(y)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var hUe={kernelName:sb,backendName:"cpu",kernelFunc:dUe};function pUe(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(n.data.get(a.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(s.dataId).values),[c,u,h]=pQ(o,r.shape,r.dtype,i,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([h.length],s.dtype,new Int32Array(h))]}var fUe={kernelName:Ug,backendName:"cpu",kernelFunc:pUe};function mUe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(a.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values,[c,u]=FD(i,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}var gUe={kernelName:ib,backendName:"cpu",kernelFunc:mUe};function yUe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(a.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values,[c,u]=FD(i,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}var xUe={kernelName:ob,backendName:"cpu",kernelFunc:yUe};function vUe(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:s,defaultValue:i}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:p}=P.calculateShapes(s,a,o),f=!1,g=n.bufferSync(a),m;switch(s.dtype){case"bool":{let y=n.bufferSync(s),x=!!n.data.get(i.dataId).values[0];m=Zc(g,y,o,p,u,c,l,h,x,f);break}case"float32":{let y=n.bufferSync(s),x=n.data.get(i.dataId).values[0];m=Zc(g,y,o,p,u,c,l,h,x,f);break}case"int32":{let y=n.bufferSync(s),x=n.data.get(i.dataId).values[0];m=Zc(g,y,o,p,u,c,l,h,x,f);break}case"string":{let y=n.bufferSync(s),x=j.decodeString(n.data.get(i.dataId).values[0]);m=Zc(g,y,o,p,u,c,l,h,x,f);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(o,m.dtype,m.values)}var bUe={kernelName:Wg,backendName:"cpu",kernelFunc:vUe};function wUe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:s,axis:i}=r,o=j.parseAxisParam(i,a.shape)[0],l=P.prepareSplitSize(a,s,o),c=new Array(a.shape.length).fill(0),u=a.shape.slice();return l.map(h=>{let p=[...u];p[o]=h;let f=Gd({inputs:{x:a},backend:n,attrs:{begin:c,size:p}});return c[o]+=h,f})}var NUe={kernelName:Bg,backendName:"cpu",kernelFunc:wUe},kUe={kernelName:lb,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{let{x:n}=e,r=t;Xe(n,"square");let a=r.data.get(n.dataId).values,s=new Float32Array(a.length);for(let i=0;i<a.length;++i){let o=a[i];s[i]=o*o}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},SUe=mn(xc,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),_Ue={kernelName:xc,backendName:"cpu",kernelFunc:SUe};function CUe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:s,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:p}=r;Xe(a,"stridedSlice");let{finalShapeSparse:f,finalShape:g,isIdentity:m,sliceDim0:y,isSimpleSlice:x,begin:v,end:b,strides:w}=wr.sliceInfo(a.shape,s,i,o,l,c,u,h,p),k;if(m)k=En({inputs:{x:a},backend:n,attrs:{shape:g}});else if(y||x){j.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let I=wr.computeOutShape(v,b,w),C=Gd({inputs:{x:a},backend:n,attrs:{begin:v,size:I}});k=En({inputs:{x:C},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(C)}else{let I=n.bufferSync(a),C=gQ(f,I,w,v);k=n.makeTensorInfo(g,C.dtype,C.values)}return k}var IUe={kernelName:Vg,backendName:"cpu",kernelFunc:CUe};function EUe(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:s,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:h}=t,p=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[g,m]=PD(p,f,a,s,i,o,l,c);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(h.shape,"int32",m)]}var TUe={kernelName:cb,backendName:"cpu",kernelFunc:EUe};function jUe(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:s,delimiter:i}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let o=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,h]=LD(o,l,a),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}var AUe={kernelName:db,backendName:"cpu",kernelFunc:jUe};function $Ue(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let i=n.data.get(s.dataId).values,o=zD(i,a);return n.makeTensorInfo(s.shape,"int32",o)}var RUe={kernelName:hb,backendName:"cpu",kernelFunc:$Ue},DUe=mn(kp,e=>Math.tan(e)),MUe={kernelName:kp,backendName:"cpu",kernelFunc:DUe},OUe=mn(Sp,e=>Math.tanh(e)),FUe={kernelName:Sp,backendName:"cpu",kernelFunc:OUe};function PUe(e){let{inputs:t,backend:n}=e,{tensor:r,indices:a,updates:s}=t,{sliceRank:i,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=P.calculateShapes(s,a,r.shape),h=!1,p=n.bufferSync(a),f=n.bufferSync(s),g=n.bufferSync(r),m=Zc(p,f,r.shape,u,l,o,i,c,g,h);return n.makeTensorInfo(r.shape,m.dtype,m.values)}var LUe={kernelName:Og,backendName:"cpu",kernelFunc:PUe};function zUe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:s}=r;Xe(a,"tile");let i=xQ(n.bufferSync(a),s);return n.makeTensorInfo(i.shape,i.dtype,i.values)}var BUe={kernelName:yc,backendName:"cpu",kernelFunc:zUe};function UUe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:s,sorted:i}=r;Xe(a,"topk");let o=n.data.get(a.dataId).values,[l,c]=bQ(o,a.shape,a.dtype,s,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}var WUe={kernelName:Hg,backendName:"cpu",kernelFunc:UUe};function VUe(e){let{inputs:t,attrs:n,backend:r}=e,{image:a,transforms:s}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=n,[u,h,p,f]=a.shape,[g,m]=c??[h,p],y=[u,g,m,f],x=j.computeStrides(a.shape),v=x[0],b=x[1],w=x[2],k=j.computeStrides(y),I=k[0],C=k[1],S=k[2],E=j.getTypedArrayFromDType(a.dtype,j.sizeFromShape(y));E.fill(l);let T=r.data.get(a.dataId).values,$=r.data.get(s.dataId).values;for(let _=0;_<u;++_){let M=s.shape[0]===1?$:$.subarray(_*8,_*8+8);for(let L=0;L<g;++L)for(let U=0;U<m;++U)for(let O=0;O<f;++O){let F,D=M[6]*U+M[7]*L+1;if(D===0)continue;let R=(M[0]*U+M[1]*L+M[2])/D,V=(M[3]*U+M[4]*L+M[5])/D,G=h3(R,p,o),W=h3(V,h,o);switch(i){case"nearest":F=XUe(T,h,p,v,b,w,_,W,G,O,l);break;case"bilinear":F=YUe(T,h,p,v,b,w,_,W,G,O,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}let B=_*I+L*C+U*S+O;E[B]=F}return r.makeTensorInfo(y,a.dtype,E)}return{dataId:r.write(E,y,a.dtype),shape:a.shape,dtype:a.dtype}}var HUe={kernelName:Gg,backendName:"cpu",kernelFunc:VUe};function h3(e,t,n){switch(n){case"reflect":return GUe(e,t);case"wrap":return qUe(e,t);case"nearest":return QUe(e,t);case"constant":default:return KUe(e)}}function GUe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{let r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return j.clamp(0,n,t-1)}function qUe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{let r=t-1;n-=t*Math.trunc(n/r)}return j.clamp(0,n,t-1)}function KUe(e,t){return e}function QUe(e,t){return j.clamp(0,e,t-1)}function Jy(e,t,n,r,a,s,i,o,l,c,u){let h=i*r+o*a+l*s+c;return 0<=o&&o<t&&0<=l&&l<n?e[h]:u}function XUe(e,t,n,r,a,s,i,o,l,c,u){let h=Math.round(o),p=Math.round(l);return Jy(e,t,n,r,a,s,i,h,p,c,u)}function YUe(e,t,n,r,a,s,i,o,l,c,u){let h=Math.floor(o),p=Math.floor(l),f=h+1,g=p+1,m=(g-l)*Jy(e,t,n,r,a,s,i,h,p,c,u)+(l-p)*Jy(e,t,n,r,a,s,i,h,g,c,u),y=(g-l)*Jy(e,t,n,r,a,s,i,f,p,c,u)+(l-p)*Jy(e,t,n,r,a,s,i,f,g,c,u);return(f-o)*m+(o-h)*y}function JUe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:s}=t;Xe(s,"unique");let i=r.data.get(s.dataId).values,{outputValues:o,outputShape:l,indices:c}=UD(i,a,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}var ZUe={kernelName:pb,backendName:"cpu",kernelFunc:JUe};function eWe(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:s}=r;s<0&&(s+=a.shape.length);let i=a.shape.length,o=a.shape[s],l=new Array(i-1),c=0;for(let f=0;f<i;f++)f!==s&&(l[c++]=a.shape[f]);let u=new Array(i).fill(0),h=a.shape.slice();h[s]=1;let p=new Array(o);for(let f=0;f<p.length;f++){u[s]=f;let g=Gd({inputs:{x:a},backend:n,attrs:{begin:u,size:h}});p[f]=En({inputs:{x:g},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(g)}return p}var tWe={kernelName:qg,backendName:"cpu",kernelFunc:eWe};function nWe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:s}=t,{numSegments:i}=r;Xe(a,"unsortedSegmentSum");let o=a.shape.length,l=s.shape.length,c=[],u=[],h=o-l,p=s;for(let g=0;g<h;++g){let m=Z1({inputs:{input:p},backend:n,attrs:{dim:g+1}});p=m,u.push(m)}for(let g=0;g<i;++g){let m=j.createScalarValue(g,"int32"),y=n.makeTensorInfo([],"int32",m),x=B9({inputs:{a:y,b:p},backend:n}),v=tc({inputs:{x},backend:n,attrs:{dtype:"float32"}}),b=GS({inputs:{a:v,b:a},backend:n}),w=Wb({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(w),u.push(y),u.push(x),u.push(v),u.push(b),u.push(w)}let f=MQ({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}var rWe={kernelName:fb,backendName:"cpu",kernelFunc:nWe},aWe=[YLe,jPe,ZLe,t3e,OPe,r3e,s3e,o3e,u3e,d3e,p3e,m3e,y3e,b3e,N3e,_3e,I3e,T3e,A3e,QLe,R3e,M3e,F3e,PPe,L3e,DPe,zPe,B3e,APe,W3e,H3e,G3e,K3e,X3e,J3e,e4e,n4e,a4e,i4e,l4e,c4e,h4e,f4e,g4e,y4e,v4e,w4e,k4e,S4e,_4e,C4e,E4e,A4e,ULe,R4e,BPe,B4e,UPe,U4e,VPe,K4e,Q4e,Y4e,GPe,KPe,Z4e,tze,rze,sze,XPe,JPe,$Pe,oze,V3e,uze,dze,pze,WLe,eLe,nLe,mze,aLe,yze,bze,Nze,_ze,Ize,Tze,jze,iLe,$ze,Dze,Oze,Pze,zze,Uze,Vze,lLe,Gze,Qze,Zze,cLe,hLe,nBe,sBe,lBe,fLe,cBe,hBe,pBe,OQ,yBe,HLe,yLe,vBe,wBe,kBe,_Be,RPe,CE,IBe,GLe,qLe,KLe,TBe,ABe,RBe,MBe,FBe,PBe,zBe,CLe,UBe,qBe,QBe,ZBe,ELe,tUe,rUe,sUe,TLe,Yze,lUe,cUe,hUe,fUe,gUe,xUe,bUe,NUe,$Le,kUe,DLe,OLe,_Ue,IUe,TUe,AUe,RUe,zLe,T4e,MUe,FUe,LUe,BUe,WUe,HUe,mLe,ZUe,tWe,rWe,dBe];for(let e of aWe)mb(e);var FQ={};gt(FQ,{assertNotComplex:()=>ly,bindCanvasToFramebuffer:()=>mWe,bindColorTextureToFramebuffer:()=>j0,bindTextureToProgramUniformSampler:()=>ZQ,bindTextureUnit:()=>XQ,bindVertexBufferToProgramAttribute:()=>EE,callAndCheck:()=>Me,canBeRepresented:()=>LQ,createFragmentShader:()=>UQ,createFramebuffer:()=>QQ,createProgram:()=>WQ,createStaticIndexBuffer:()=>GQ,createStaticVertexBuffer:()=>HQ,createTexture:()=>qQ,createVertexShader:()=>BQ,getBatchDim:()=>qd,getExtensionOrThrow:()=>Zy,getFramebufferErrorMessage:()=>eX,getMaxTexturesInShader:()=>aX,getNumChannels:()=>pWe,getProgramUniformLocation:()=>JQ,getProgramUniformLocationOrThrow:()=>YQ,getRowsCols:()=>Kd,getShapeAs3D:()=>tx,getTextureShapeFromLogicalShape:()=>nX,getWebGLDisjointQueryTimerVersion:()=>sX,getWebGLErrorMessage:()=>zQ,getWebGLMaxTextureSize:()=>rX,hasExtension:()=>Ds,isCapableOfRenderingToFloatTexture:()=>iX,isDownloadFloatTextureEnabled:()=>oX,isReshapeFree:()=>dv,isWebGLFenceEnabled:()=>lX,isWebGLVersionEnabled:()=>jE,linkProgram:()=>VQ,logShaderSourceAndInfoLog:()=>qD,resetMaxTextureSize:()=>gWe,resetMaxTexturesInShader:()=>yWe,unbindColorTextureFromFramebuffer:()=>TE,unbindTextureUnit:()=>fWe,validateFramebuffer:()=>ex,validateProgram:()=>T0,validateTextureSize:()=>KQ});var qc={},Kw={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function PQ(e,t){qc[e]=t}function Vi(e,t){if(!(e in qc)||t!=null){let r=iWe(e,t);if(r!==null)qc[e]=r;else return console.log("Could not get context for WebGL version",e),null}let n=qc[e];return n==null||n.isContextLost()?(delete qc[e],Vi(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),qc[e])}function sWe(e){if(!le().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function iWe(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=t??sWe(e);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete qc[e]},!1),le().getBool("SOFTWARE_WEBGL_ENABLED")&&(Kw.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",Kw)||n.getContext("experimental-webgl",Kw):n.getContext("webgl2",Kw)}var cv;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(cv||(cv={}));var Rs;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Rs||(Rs={}));var Hr;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Hr||(Hr={}));function Vb(e,t){return[t,e]}function oWe(e,t){return e*t}function Qw(e){let t=j.sizeFromShape(e),n=Math.ceil(t/4);return j.sizeToSquarishShape(n)}function oy(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function lWe(e,t){let[n,r]=oy(e,t);return n*r*4}function GD(e,t){let n=e,r,a,s,i,o,l,c,u,h,p;return le().getNumber("WEBGL_VERSION")===2?(r=n.R32F,a=n.R16F,s=n.RGBA16F,i=n.RGBA32F,o=n.RED,c=4,u=1,h=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=e.RGBA,a=e.RGBA,s=e.RGBA,i=n.RGBA,o=e.RGBA,c=4,u=4,h=t!=null?t.HALF_FLOAT_OES:null,p=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:p}}function Me(e,t){let n=t();return le().getBool("DEBUG")&&uWe(e),n}function uWe(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+zQ(e,t))}var cWe=596e-10,dWe=65504;function LQ(e){return!!(le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||cWe<Math.abs(e)&&Math.abs(e)<dWe)}function zQ(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function Zy(e,t){return Rl(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function BQ(e,t){let n=Rl(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Me(e,()=>e.shaderSource(n,t)),Me(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function UQ(e,t){let n=Rl(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Me(e,()=>e.shaderSource(n,t)),Me(e,()=>e.compileShader(n)),le().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw qD(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var hWe=/ERROR: [0-9]+:([0-9]+):/g;function qD(e,t){let n=hWe.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let r=+n[1],a=e.split(`
`),s=a.length.toString().length+2,i=a.map((h,p)=>j.rightPad((p+1).toString(),s)+h),o=0;for(let h=0;h<i.length;h++)o=Math.max(i[h].length,o);let l=i.slice(0,r-1),c=i.slice(r-1,r),u=i.slice(r);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${j.rightPad(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function WQ(e){return Rl(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function VQ(e,t){if(Me(e,()=>e.linkProgram(t)),!le().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function T0(e,t){if(Me(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function HQ(e,t){let n=Rl(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Me(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Me(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function GQ(e,t){let n=Rl(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Me(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),Me(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function pWe(){return le().getNumber("WEBGL_VERSION")===2?1:4}function qQ(e){return Rl(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function KQ(e,t){let n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){let r=`[${e}x${t}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function QQ(e){return Rl(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function EE(e,t,n,r,a,s,i){let o=e.getAttribLocation(t,n);return o===-1?!1:(Me(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Me(e,()=>e.vertexAttribPointer(o,a,e.FLOAT,!1,s,i)),Me(e,()=>e.enableVertexAttribArray(o)),!0)}function XQ(e,t,n){tX(e,n),Me(e,()=>e.activeTexture(e.TEXTURE0+n)),Me(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function fWe(e,t){tX(e,t),Me(e,()=>e.activeTexture(e.TEXTURE0+t)),Me(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function YQ(e,t,n){return Rl(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function JQ(e,t,n){return e.getUniformLocation(t,n)}function ZQ(e,t,n,r){Me(e,()=>XQ(e,t,r)),Me(e,()=>e.uniform1i(n,r))}function mWe(e){Me(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Me(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),Me(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function j0(e,t,n){Me(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),Me(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function TE(e,t){Me(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Me(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function ex(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+eX(e,t))}function eX(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Rl(e,t,n){let r=Me(e,()=>t());if(r==null)throw new Error(n);return r}function tX(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${a}.`)}}function qd(e,t=2){return j.sizeFromShape(e.slice(0,e.length-t))}function Kd(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function tx(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[qd(e),...Kd(e)]),t}function nX(e,t=!1){let n=le().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=le().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&le().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((o,l)=>l>=e.length-2?j.nearestLargerEven(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=j.squeezeShape(e).newShape);let a=j.sizeFromShape(e),s=null;e.length<=1&&a<=n?s=[1,a]:e.length===2&&e[0]<=n&&e[1]<=n?s=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);let i=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(s==null||i)if(t){let o=qd(e),l=2,c=2;e.length&&([l,c]=Kd(e)),a=o*(l/2)*(c/2),s=j.sizeToSquarishShape(a).map(u=>u*2)}else s=j.sizeToSquarishShape(a);return s}function Xw(e){return e%2===0}function dv(e,t){if(e=e.slice(-2),t=t.slice(-2),j.arraysEqual(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||Xw(n)&&Xw(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&Xw(e[0])&&Xw(t[0])}var A0,$0;function rX(e){if(A0==null){let t=Vi(e);A0=t.getParameter(t.MAX_TEXTURE_SIZE)}return A0}function gWe(){A0=null}function yWe(){$0=null}function aX(e){if($0==null){let t=Vi(e);$0=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,$0)}function sX(e){if(e===0)return 0;let t,n=Vi(e);return Ds(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:Ds(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Ds(e,t){return e.getExtension(t)!=null}function jE(e){try{if(Vi(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function iX(e){if(e===0)return!1;let t=Vi(e);if(e===1){if(!Ds(t,"OES_texture_float"))return!1}else if(!Ds(t,"EXT_color_buffer_float"))return!1;return AE(t)}function oX(e){if(e===0)return!1;let t=Vi(e);if(e===1){if(!Ds(t,"OES_texture_float")||!Ds(t,"WEBGL_color_buffer_float"))return!1}else{if(Ds(t,"EXT_color_buffer_float"))return AE(t);let n="EXT_color_buffer_half_float";if(Ds(t,n)){let r=t.getExtension(n);return xWe(t,r)}return!1}return AE(t)}function AE(e){let t=GD(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function xWe(e,t){let n=GD(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),s}function lX(e){return e!==2?!1:Vi(e).fenceSync!=null}function ly(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&j.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var Ye=le();Ye.registerFlag("HAS_WEBGL",()=>Ye.getNumber("WEBGL_VERSION")>0);Ye.registerFlag("WEBGL_VERSION",()=>jE(2)?2:jE(1)?1:0);Ye.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ye.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ye.get("WEBGL_VERSION")===2);Ye.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ye.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ye.registerFlag("WEBGL_PACK",()=>Ye.getBool("HAS_WEBGL"));Ye.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_CLIP",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_REDUCE",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_CONV_IM2COL",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>rX(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>aX(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=Ye.getNumber("WEBGL_VERSION");return e===0?0:sX(e)});Ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ye.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!xb.isMobile());Ye.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>iX(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ye.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ye.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ye.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>oX(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_FENCE_API_ENABLED",()=>lX(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ye.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ye.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});Ye.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>xb.isMobile()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});Ye.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ye.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ye.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ye.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ye.registerFlag("WEBGL_EXP_CONV",()=>!1);Ye.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ye.getBool("IS_TEST"));Ye.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ye.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ye.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ye.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function ja(){let e,t,n,r,a,s,i,o,l,c;return le().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",a="texture",s="outputColor",i="out vec4 outputColor;",o=le().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",a="texture2D",s="gl_FragColor",i="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:s,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}function $p(e,t,n="index"){let r=j.computeStrides(t);return r.map((a,s)=>{let i=`int ${e[s]} = ${n} / ${a}`,o=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${a}`:`index -= ${e[s]} * ${a}`;return`${i}; ${o};`}).join("")}function qS(e,t,n="index"){let r=j.computeStrides(t);return r.map((a,s)=>{let i=`int ${e[s]} = ${n} / outShapeStrides[${s}]`,o=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * outShapeStrides[${s}]`:`index -= ${e[s]} * outShapeStrides[${s}]`;return`${i}; ${o};`}).join("")}function vWe(e,t){let n=e.length,r=e.map(s=>`${t}[${s}]`),a=new Array(n-1);a[n-2]=r[n-1];for(let s=n-3;s>=0;--s)a[s]=`(${a[s+1]} * ${r[s+1]})`;return a}function bWe(e,t,n="index"){let r=e.map((s,i)=>i),a=vWe(r,t);return a.map((s,i)=>{let o=`int ${e[i]} = ${n} / ${a[i]}`,l=i===a.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${a[i]}`:`index -= ${e[i]} * ${a[i]}`;return`${o}; ${l};`}).join("")}function KD(e){let t=j.computeStrides(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function QD(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var uX=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`,{getBroadcastDims:cX}=P;function wWe(e,t,n){let r=[];if(e.forEach(p=>{let f=j.sizeFromShape(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){let{uniformShape:g}=XD(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});let a=r.join(`
`),s=e.map(p=>NWe(p,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=t.texShape,o=ja(),l=_We(o),c,u,h=EWe(o);return t.isPacked?(c=kWe(t.logicalShape,i,n.enableShapeUniforms),u=IWe(o)):(c=SWe(t.logicalShape,i,n.enableShapeUniforms),u=CWe(o)),n.packedInputs&&(h+=$We),[h,l,u,a,c,s,n.userCode].join(`
`)}function uy(e,t=!1){let n=e.shapeInfo.logicalShape;switch(n.length){case 0:return VWe(e,t);case 1:return GWe(e,t);case 2:return KWe(e,t);case 3:return XWe(e,t);case 4:return JWe(e,t);case 5:return ZWe(e);case 6:return e5e(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function dX(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return WWe(e);case 1:return HWe(e,t);case 2:return qWe(e,t);case 3:return QWe(e,t);default:return YWe(e,t)}}function NWe(e,t,n=!1,r){let a="";n?a+=dX(e,r):a+=uy(e,r);let s=e.shapeInfo.logicalShape,i=t.logicalShape;return s.length<=i.length&&(n?a+=t5e(e,t):a+=n5e(e,t)),a}function kWe(e,t,n){switch(e.length){case 0:return hX();case 1:return RWe(e,t,n);case 2:return BWe(e,t,n);case 3:return MWe(e,t,n);default:return FWe(e,t,n)}}function SWe(e,t,n){switch(e.length){case 0:return hX();case 1:return DWe(e,t,n);case 2:return UWe(e,t,n);case 3:return OWe(e,t,n);case 4:return PWe(e,t,n);case 5:return LWe(e,t);case 6:return zWe(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function _We(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function CWe(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function IWe(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function EWe(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${TWe}
    ${jWe}
    ${AWe}
  `}var TWe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jWe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,AWe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,$We=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function hX(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function RWe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function DWe(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function MWe(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),s=a*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function OWe(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${qS(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;let r=$p(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function FWe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),s=a*Math.ceil(e[e.length-2]/2),i=s,o="",l="b, r, c";for(let c=2;c<e.length-1;c++)i*=e[e.length-c-1],o=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+o,l=`b${c}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${e.length}(${l});
    }
  `}function PWe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${qS(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;let r=$p(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function LWe(e,t){let n=$p(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function zWe(e,t){let n=$p(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function BWe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(j.arraysEqual(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;let a=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function UWe(e,t,n){return j.arraysEqual(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function Rp(e){return`offset${e}`}function WWe(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=ja();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function VWe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;let[a,s]=e.shapeInfo.texShape;if(a===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;let i=Rp(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;let[o,l]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function HWe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,s=ja();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;let i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function GWe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${cy(e)}
      }
    `;let a=e.shapeInfo.texShape,s=a[0],i=a[1];if(i===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;let o=Rp(n);return i===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${i}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function qWe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,i=s[0],o=s[1],l=ja();if(s!=null&&j.arraysEqual(n,s))return t?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;let c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function KWe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape;if(s!=null&&j.arraysEqual(n,s)){if(t)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;let p=s[0],f=s[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}let{newShape:i,keptDims:o}=j.squeezeShape(n),l=i;if(l.length<n.length){let p=dy(e,l),f=["row","col"];return`
      ${uy(p,t)}
      float ${a}(int row, int col) {
        return ${a}(${hy(f,o)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${cy(e)}
      }
    `;let c=s[0],u=s[1],h=Rp(r);return u===1?t?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?t?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function QWe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){let p=n.slice(1),f=[1,2],g=dy(e,p),m=["b","row","col"];return`
        ${dX(g,t)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${hy(m,f)});
        }
      `}let o=ja();if(t)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;let l=i[0],c=i[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${h}, ${u}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function XWe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],i=n[2],{newShape:o,keptDims:l}=j.squeezeShape(n),c=o;if(c.length<n.length){let m=dy(e,c),y=["row","col","depth"];return`
        ${uy(m,t)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${hy(y,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${i}, 1)));
        ${cy(e)}
      }
    `;let u=e.shapeInfo.texShape,h=u[0],p=u[1],f=e.shapeInfo.flatOffset;if(p===s&&f==null)return t?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${h}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===i&&f==null)return t?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `;let g=Rp(r);return t?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${g};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${i} + depth + ${g};
        vec2 uv = uvFromFlat(${h}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function YWe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=ja();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);
    }
  `;let s=e.shapeInfo.logicalShape,i=s.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],h=Math.ceil(s[i-1]/2),p=h*Math.ceil(s[i-2]/2),f="int b, int row, int col",g=`b * ${p} + (row / 2) * ${h} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,p*=s[i-m-1],g=`b${m} * ${p} + `+g;return`
    vec4 ${r}(${f}) {
      int index = ${g};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${a.texture2D}(${n}, uv);
    }
  `}function JWe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],i=n[2]*s,o=n[1]*i,{newShape:l,keptDims:c}=j.squeezeShape(n);if(l.length<n.length){let v=dy(e,l),b=["row","col","depth","depth2"];return`
      ${uy(v,t)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${hy(b,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${i}, ${s}, 1)));
        ${cy(e)}
      }
    `;let u=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1],g=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,y=`int stride0 = ${r}Shape[1] * stride1;`;if(f===o&&u==null)return t?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${g}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===s&&u==null)return t?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;let x=Rp(r);return t?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${g}
      ${m}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${x});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${p}, ${f}, index + ${x});
      return sampleTexture(${r}, uv);
    }
  `}function ZWe(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],s=t[3]*a,i=t[2]*s,o=t[1]*i,{newShape:l,keptDims:c}=j.squeezeShape(t);if(l.length<t.length){let m=dy(e,l),y=["row","col","depth","depth2","depth3"];return`
      ${uy(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${hy(y,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${i}, ${s}, ${a})) +
          depth3;
        ${cy(e)}
      }
    `;let u=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];if(f===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${s}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;let g=Rp(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} + depth * ${s} +
          depth2 * ${a} + depth3 + ${g};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function e5e(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:s}=j.squeezeShape(t);if(a.length<t.length){let y=dy(e,a),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${uy(y)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${hy(x,s)});
      }
    `}let i=t[5],o=t[4]*i,l=t[3]*o,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${cy(e)}
      }
    `;let h=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,f=p[0],g=p[1];if(g===u&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(g===i&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;let m=Rp(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${g}, index);
      return sampleTexture(${n}, uv);
    }
  `}function cy(e){let t=e.name,n=j.sizeFromShape(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function t5e(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,o=cX(e.shapeInfo.logicalShape,t.logicalShape),l=kn(i),c=i-s,u,h=["x","y","z","w","u","v"];s===0?u="":i<2&&o.length>=1?u="coords = 0;":u=o.map(y=>`coords.${h[y+c]} = 0;`).join(`
`);let p="";i<2&&s>0?p="coords":p=e.shapeInfo.logicalShape.map((y,x)=>`coords.${h[x+c]}`).join(", ");let f="return outputValue;",g=j.sizeFromShape(e.shapeInfo.logicalShape)===1,m=j.sizeFromShape(t.logicalShape)===1;if(s===1&&!g&&!m)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!m)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(o.length){let y=s-2,x=s-1;o.indexOf(y)>-1&&o.indexOf(x)>-1?f="return vec4(outputValue.x);":o.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(x)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${p});
      ${f}
    }
  `}function n5e(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",s=t.texShape,i=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&e.shapeInfo.flatOffset==null&&j.arraysEqual(i,s))return`
      float ${a}() {
        return sampleTexture(${n}, resultUV);
      }
    `;let c=kn(l),u=cX(e.shapeInfo.logicalShape,t.logicalShape),h=l-o,p,f=["x","y","z","w","u","v"];o===0?p="":l<2&&u.length>=1?p="coords = 0;":p=u.map(m=>`coords.${f[m+h]} = 0;`).join(`
`);let g="";return l<2&&o>0?g="coords":g=e.shapeInfo.logicalShape.map((m,y)=>`coords.${f[y+h]}`).join(", "),`
    float ${a}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${r}(${g});
    }
  `}function kn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function XD(e,t,n){let{newShape:r,keptDims:a}=j.squeezeShape(t),s=t.length,i=e&&s===3&&t[0]===1,o=i?t.slice(1):r,l=!e&&s>1&&!j.arraysEqual(t,n)&&r.length<s||i;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:a}}function dy(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function hy(e,t){return t.map(n=>e[n]).join(", ")}function r5e(e,t,n,r){let a=n.map((u,h)=>{let p={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(p.flatOffset=u.texData.slice.flatOffset),{name:t.variableNames[h],shapeInfo:p}}),s=a.map(u=>u.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=wWe(a,i,t),l=UQ(e.gl,o),c=e.createProgram(l);return le().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:s,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:s,outShapeInfo:i},pX(e,t,c)))}function pX(e,t,n){let r=[],a=[],s,i,o,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),le().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));let u=!1;for(let h of t.variableNames){let p={name:h,uniform:e.getUniformLocation(n,h,u),offset:e.getUniformLocation(n,`offset${h}`,u)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,`${h}Shape`,u),p.texShape=e.getUniformLocation(n,`${h}TexShape`,u)),r.push(p)}if(t.enableShapeUniforms&&(s=e.getUniformLocation(n,"outShape",u),o=e.getUniformLocation(n,"outShapeStrides",u),i=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(let h of t.customUniforms)a.push(e.getUniformLocation(n,h.name,u));return{variablesLocations:r,customUniformLocations:a,infLoc:l,nanLoc:c,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:i}}function p3(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{let a=n.logicalShape,s=t[r],i=s.shape;if(!j.arraysEqual(a,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${i} must match`);if(n.isUniform&&s.isUniform)return;let o=n.texShape,l=s.isUniform?null:s.texData.texShape;if(!j.arraysEqual(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function a5e(e,t,n,r,a){t.program.enableShapeUniforms||(p3(t.inShapeInfos,n),p3([t.outShapeInfo],[r]));let s=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,i[0],i[1]):e.setOutputMatrixTexture(s.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),le().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let c=n[l],{uniform:u,offset:h,shape:p,texShape:f}=t.variablesLocations[l];if(p){let{uniformShape:g}=XD(t.program.packedInputs,c.shape,c.texData.texShape);switch(g.length){case 1:e.gl.uniform1iv(p,new Int32Array(g));break;case 2:e.gl.uniform2iv(p,new Int32Array(g));break;case 3:e.gl.uniform3iv(p,new Int32Array(g));break;case 4:e.gl.uniform4iv(p,new Int32Array(g));break}}if(f&&e.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(j.sizeFromShape(c.shape)<2)e.gl.uniform1f(u,c.uniformValues[0]);else{let g=c.uniformValues;g instanceof Float32Array||(g=new Float32Array(g)),e.gl.uniform1fv(u,g)}continue}c.texData.slice!=null&&h!=null&&e.gl.uniform1i(h,c.texData.slice.flatOffset),e.setInputMatrixTexture(c.texData.texture.texture,u,l)}}let o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){let l=j.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(let l=0;l<t.program.customUniforms.length;++l){let c=t.program.customUniforms[l],u=t.customUniformLocations[l],h=a[l];if(c.type==="float")e.gl.uniform1fv(u,h);else if(c.type==="vec2")e.gl.uniform2fv(u,h);else if(c.type==="vec3")e.gl.uniform3fv(u,h);else if(c.type==="vec4")e.gl.uniform4fv(u,h);else if(c.type==="int")e.gl.uniform1iv(u,h);else if(c.type==="ivec2")e.gl.uniform2iv(u,h);else if(c.type==="ivec3")e.gl.uniform3iv(u,h);else if(c.type==="ivec4")e.gl.uniform4iv(u,h);else throw Error(`uniform type ${c.type} is not supported yet.`)}e.executeProgram()}function s5e(e,t,n){let r="";t.concat(n).forEach(i=>{let o=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!i.isUniform){let l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:h}=XD(e.packedInputs,i.shape,l),p="",f="",g="";if(u.length===1&&e.packedInputs){let k=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${k[0]>1}_${k[1]>1}`}else if(u.length===2&&!e.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!e.packedInputs){let k=j.computeStrides(u);g=`${k[0]===l[1]}_${k[k.length-1]===l[1]}`}let m=i.shape.length,y=u.length===2&&j.arraysEqual(i.shape,l),x=j.sizeFromShape(i.shape)===1,v=P.getBroadcastDims(i.shape,n.shape),b=!e.packedInputs&&m===n.shape.length&&j.arraysEqual(l,n.texData.texShape),w=e.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${b}_${c?h:""}_${u.length}_${x}_${v}_${y}_${p}_${f}_${g}_${w}_${o}`}else{let l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${o}`}});let a=e.userCode,s=e.constructor.name;return s+="_"+r+"_"+a+`${le().getNumber("WEBGL_VERSION")}`,s}function la(e){return le().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var i5e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=cv.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=ja();this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?qS(["r","c","d"],e):$p(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}},o5e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=cv.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=ja();this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?qS(["r","c","d"],e):$p(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}},l5e=class{constructor(e){this.variableNames=["A"],this.outTexUsage=Rs.DOWNLOAD;let t=ja();this.outputShape=e,this.userCode=`
      ${uX}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}},u5e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Rs.DOWNLOAD;let t=ja();this.outputShape=e,this.userCode=`
      ${uX}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}},c5e={R:0,G:1,B:2,A:3},f3=class{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=ja();this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let s="";for(let i=0;i<n.length;i++){let o=n[i];s+=`
          if(offset == ${i}) {
            result = values[${c5e[o]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?QD():KD(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${n.length});

        flatIndex = idiv(flatIndex, ${n.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${s}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}},d5e=class{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=ja();this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let i=0;i<=1;i++){let o=s*2+i;r+=`
          localCoords = coords;
          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${i};
          if (localCoords[1] + ${s} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${s};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${o}] = values[0];
            } else if (offset == 1) {
              result[${o}] = values[1];
            } else if (offset == 2) {
              result[${o}] = values[2];
            } else {
              result[${o}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?QD():KD(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${n.output} = ${a};
        }
    `}},fX={};gt(fX,{bindVertexProgramAttributeStreams:()=>kX,createBufferFromOutputTexture:()=>CX,createFloat16MatrixTexture:()=>vX,createFloat16PackedMatrixTexture:()=>NX,createFloat32MatrixTexture:()=>xX,createIndexBuffer:()=>yX,createPackedMatrixTexture:()=>wX,createUnsignedBytesMatrixTexture:()=>bX,createVertexBuffer:()=>gX,createVertexShader:()=>mX,downloadByteEncodedFloatMatrixFromOutputTexture:()=>EX,downloadFloat32MatrixFromBuffer:()=>IX,downloadMatrixFromPackedOutputTexture:()=>jX,downloadPackedMatrixFromBuffer:()=>TX,getInternalFormatForFloat16MatrixTexture:()=>JD,getInternalFormatForFloat16PackedMatrixTexture:()=>tM,getInternalFormatForFloat32MatrixTexture:()=>YD,getInternalFormatForPackedMatrixTexture:()=>eM,getInternalFormatForUnsignedBytesMatrixTexture:()=>ZD,uploadDenseMatrixToTexture:()=>SX,uploadPixelDataToTexture:()=>_X});function mX(e){let t=ja(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return BQ(e,n)}function gX(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return HQ(e,t)}function yX(e){let t=new Uint16Array([0,1,2,2,1,3]);return GQ(e,t)}function Hb(e,t,n,r,a,s){KQ(t,n);let i=qQ(e),o=e.TEXTURE_2D;return Me(e,()=>e.bindTexture(o,i)),Me(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Me(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Me(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),Me(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),le().getNumber("WEBGL_VERSION")===1?Me(e,()=>e.texImage2D(o,0,r,t,n,0,a,s,null)):Me(e,()=>e.texStorage2D(o,1,r,t,n)),Me(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:i,texShape:[n,t]}}function YD(e){return e.internalFormatFloat}function xX(e,t,n,r){let[a,s]=Vb(t,n);return Hb(e,a,s,YD(r),r.textureFormatFloat,e.FLOAT)}function JD(e){return e.internalFormatHalfFloat}function vX(e,t,n,r){let[a,s]=Vb(t,n);return Hb(e,a,s,JD(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function ZD(e){return e.downloadTextureFormat}function bX(e,t,n,r){let[a,s]=Vb(t,n);return Hb(e,a,s,ZD(r),e.RGBA,e.UNSIGNED_BYTE)}function eM(e){return e.internalFormatPackedFloat}function wX(e,t,n,r){let[a,s]=oy(t,n);return Hb(e,a,s,eM(r),e.RGBA,e.FLOAT)}function tM(e){return e.internalFormatPackedHalfFloat}function NX(e,t,n,r){let[a,s]=oy(t,n);return Hb(e,a,s,tM(r),e.RGBA,r.textureTypeHalfFloat)}function kX(e,t,n){return Me(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),EE(e,t,"clipSpacePos",n,3,20,0)&&EE(e,t,"uv",n,2,20,12)}function SX(e,t,n,r,a,s){Me(e,()=>e.bindTexture(e.TEXTURE_2D,t));let i,o,l;a instanceof Uint8Array?(i=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(i=new Float32Array(n*r*4),o=e.FLOAT,l=s.internalFormatPackedFloat),i.set(a),le().getNumber("WEBGL_VERSION")===2?Me(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,i)):Me(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,i)),Me(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function _X(e,t,n){Me(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?le().getNumber("WEBGL_VERSION")===2?Me(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):Me(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):le().getNumber("WEBGL_VERSION")===2?Me(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):Me(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),Me(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function CX(e,t,n,r){let a=e.createBuffer();Me(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,a));let s=4*4*t*n;return Me(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ)),Me(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),Me(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),a}function IX(e,t,n){let r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function EX(e,t,n,r){let[a,s]=Vb(t,n),i=4,o=new Uint8Array(oWe(t*n,i));return Me(e,()=>e.readPixels(0,0,a,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function TX(e,t,n,r,a,s,i,o){let l=e,c=new Float32Array(lWe(s,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function jX(e,t,n){let r=new Float32Array(t*n*4);return Me(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}var R0=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=le().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,PQ(t,e)):this.gl=Vi(t),e=this.gl,le().getNumber("WEBGL_VERSION")===2){let a=e;this.createVertexArray=()=>Me(a,()=>a.createVertexArray()),this.bindVertexArray=s=>Me(a,()=>a.bindVertexArray(s)),this.deleteVertexArray=s=>Me(a,()=>a.deleteVertexArray(s)),this.getVertexArray=()=>Me(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){let a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Me(e,()=>a.createVertexArrayOES()),this.bindVertexArray=s=>Me(e,()=>a.bindVertexArrayOES(s)),this.deleteVertexArray=s=>Me(e,()=>a.deleteVertexArrayOES(s)),this.getVertexArray=()=>Me(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float",r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),le().getNumber("WEBGL_VERSION")===1){let a="OES_texture_float",s="OES_texture_half_float";if(this.textureFloatExtension=Zy(this.gl,a),Ds(this.gl,s))this.textureHalfFloatExtension=Zy(this.gl,s);else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Ds(this.gl,r))this.colorBufferHalfFloatExtension=Zy(this.gl,r);else if(le().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Ds(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(Ds(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=gX(this.gl),this.indexBuffer=yX(this.gl),this.framebuffer=QQ(this.gl),this.textureConfig=GD(this.gl,this.textureHalfFloatExtension)}get debug(){return le().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;Me(e,()=>e.finish()),Me(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Me(e,()=>e.deleteFramebuffer(this.framebuffer)),Me(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Me(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Me(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),xX(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),vX(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),bX(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),_X(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),SX(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),NX(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),wX(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(TE(this.gl,this.framebuffer),this.outputTexture=null),Me(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>EX(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,a,s){return TX(this.gl,e,t,n,r,a,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return IX(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=CX(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(le().getBool("WEBGL_FENCE_API_ENABLED")){let r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let s=r.clientWaitSync(a,0,0);return s===r.ALREADY_SIGNALED||s===r.CONDITION_SATISFIED},t=a}else le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>jX(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;this.vertexShader==null&&(this.vertexShader=mX(t));let n=WQ(t);Me(t,()=>t.attachShader(n,this.vertexShader)),Me(t,()=>t.attachShader(n,e)),VQ(t,n);let r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&T0(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;Me(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),kX(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Me(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&T0(this.gl,this.program),Me(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?YQ(this.gl,e,t):JQ(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Me(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),ZQ(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,a]=oy(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&T0(this.gl,this.program),ex(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Me(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Me(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Zy(this.gl,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.createQuery();return n.beginQuery(r.TIME_ELAPSED_EXT,a),a}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await j.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){let n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{let n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{let n=this.getQueryTimerExtensionWebGL1(),r=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=h5e(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in le().platform&&(n=le().platform.setTimeoutCustom.bind(le().platform)),j.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),j0(this.gl,e,this.framebuffer),this.debug&&ex(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(j0(this.gl,this.outputTexture,this.framebuffer),this.debug&&ex(this.gl)):TE(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;j0(r,e,this.framebuffer),this.debug&&ex(r),this.outputTexture=e,Me(r,()=>r.viewport(0,0,t,n)),Me(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),Me(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function h5e(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var{addImpl:p5e,bincountImpl:AX,bincountReduceImpl:f5e,bitwiseAndImpl:m5e,castImpl:g5e,ceilImpl:y5e,concatImpl:x5e,equalImpl:v5e,expImpl:b5e,expm1Impl:w5e,floorImpl:N5e,gatherNdImpl:k5e,gatherV2Impl:S5e,greaterImpl:_5e,greaterEqualImpl:C5e,lessImpl:I5e,lessEqualImpl:E5e,linSpaceImpl:T5e,logImpl:j5e,maxImpl:A5e,maximumImpl:$5e,minimumImpl:R5e,multiplyImpl:D5e,negImpl:M5e,notEqualImpl:O5e,prodImpl:F5e,raggedGatherImpl:P5e,raggedRangeImpl:L5e,raggedTensorToTensorImpl:z5e,rangeImpl:B5e,rsqrtImpl:U5e,scatterImpl:W5e,sigmoidImpl:V5e,simpleAbsImpl:$X,sliceImpl:H5e,sparseFillEmptyRowsImpl:G5e,sparseReshapeImpl:q5e,sparseSegmentReductionImpl:RX,sqrtImpl:K5e,staticRegexReplaceImpl:Q5e,stridedSliceImpl:X5e,stringNGramsImpl:Y5e,stringSplitImpl:J5e,stringToHashBucketFastImpl:Z5e,subImpl:e6e,tileImpl:t6e,topKImpl:n6e,transposeImpl:nM,uniqueImpl:r6e}=jD;function DX(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function xa(e,t){return t===1?[e]:DX(e,t)}function a6e(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}var s6e=class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=la(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let t=xa("rc",this.rank),n=kn(this.rank),r=this.getOutOfBoundsCondition(t),a=this.getSetup(t),s=this.getOutput(t);this.userCode=`
        void main() {
          ${n} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${s}));
          }
        }
      `}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a=`${n===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let s=2;s<this.rank;s++)a=`${e[e.length-1-s]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";let t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${n};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){let t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}},MX=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length);let n="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${i6e(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?QD():KD(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${n}

        setOutput(result);
      }
    `}};function i6e(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?bWe(["r","c","d"],"inputShape"):$p(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}var o6e=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let r=g3(t,n),a=y3(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);let s=m3(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let o=this.freeTextures[a].pop();return this.usedTextures[a].push(o),o}let i;return r===Hr.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Hr.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Hr.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Hr.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Hr.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),i}releaseTexture(e,t,n,r){if(this.freeTextures==null)return;let a=g3(n,r),s=y3(t,a,r);s in this.freeTextures||(this.freeTextures[s]=[]);let i=m3(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=le().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");o!==-1&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[s].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;let l=this.usedTextures[s],c=l&&l.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function l6e(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function m3(e,t,n,r,a){let s=u6e(t,r),i;if(a){let[l,c]=oy(e[0],e[1]);i=l*c}else{let[l,c]=Vb(e[0],e[1]);i=l*c}let o=l6e(n,s);return i*o}function u6e(e,t){switch(e){case Hr.PACKED_2X2_FLOAT32:return eM(t);case Hr.PACKED_2X2_FLOAT16:return tM(t);case Hr.UNPACKED_FLOAT32:return YD(t);case Hr.UNPACKED_FLOAT16:return JD(t);case Hr.PACKED_4X1_UNSIGNED_BYTE:return ZD(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function c6e(e){return le().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Hr.PACKED_2X2_FLOAT32:Hr.UNPACKED_FLOAT32:e?Hr.PACKED_2X2_FLOAT16:Hr.UNPACKED_FLOAT16}function g3(e,t){if(e===Rs.UPLOAD)return Hr.PACKED_2X2_FLOAT32;if(e===Rs.RENDER||e==null)return c6e(t);if(e===Rs.DOWNLOAD||e===Rs.PIXELS)return Hr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function y3(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}var xo=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},fi="if (isnan(x)) return x;",d6e="return x;",x3="return abs(x);",h6e="return (x >= 0.0) ? x : (exp(x) - 1.0);",p6e=fi+`
  return (x < 0.0) ? 0.0 : x;
`,f6e=fi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Jl="return x;",m6e="return 1.0 / (1.0 + exp(-1.0 * x));",g6e="return x;",y6e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,x6e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,v6e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,b6e="return 1.0 / (1.0 + exp(-1.0 * x));",vu=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}},w6e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length);let t=e.length,n=xa("rc",t),r=kn(t),a=a6e(t,n),s=n.slice(-2),i=t<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${i}));
      }
    `}},N6e=Bo.whereImpl,k6e=1e-7,S6e=1e-4,TC={};function _6e(e){return e in TC||(TC[e]={}),TC[e]}var C6e=le().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),I6e=600;function E6e(){return le().global.screen==null?1024:le().global.screen.height*le().global.screen.width*window.devicePixelRatio*I6e/1024/1024}var rM=class OX extends Gv{nextDataId(){return OX.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!le().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof R0)n=t;else{let r=Vi(le().getNumber("WEBGL_VERSION"),t);n=new R0(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let r=Vi(le().getNumber("WEBGL_VERSION"));n=new R0(r),this.binaryCache=_6e(le().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new o6e(this.gpgpu),this.numMBBeforeWarning=E6e(),this.texData=new _k(this,Ys())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,r,a,s,i){let o=this.makeTensorInfo(n,r),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[a,s]},l.texShape=[a,s];let c=tx(n),u=new f3(c,!1,i),h=this.runWebGLProgram(u,[o],r,[[a,s]]);return h.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),h.dataId}write(t,n,r){if((le().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||le().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let a={id:this.nextDataId()};return this.texData.set(a,{shape:n,dtype:r,values:t,usage:Rs.UPLOAD,refCount:1}),a}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){let n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){let n=this.texData.get(t);n.refCount--}}move(t,n,r,a,s){if(le().getBool("DEBUG")&&this.checkNumericalProblems(n),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:a,values:n,usage:Rs.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){let n=this.texData.get(t),{values:r,dtype:a,complexTensorInfos:s,slice:i,shape:o,isPacked:l}=n;if(i!=null){let p;l?p=new vu(o,Jl):p=new xo(o,Jl);let f=this.runWebGLProgram(p,[{dataId:t,shape:o,dtype:a}],a),g=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),g}if(r!=null)return this.convertAndCacheOnCPU(t);if(a==="string")return r;let c=this.activeTimers!=null,u;c&&(u=j.now());let h;if(a==="complex64"){let p=this.readSync(s.real.dataId),f=this.readSync(s.imag.dataId);h=P.mergeRealAndImagArrays(p,f)}else h=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=j.now()-u),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){let g=this.pendingRead.get(t);return new Promise(m=>g.push(m))}let n=this.texData.get(t),{values:r,shape:a,slice:s,dtype:i,complexTensorInfos:o,isPacked:l}=n;if(s!=null){let g;l?g=new vu(a,Jl):g=new xo(a,Jl);let m=this.runWebGLProgram(g,[{dataId:t,shape:a,dtype:i}],i),y=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),y}if(r!=null)return this.convertAndCacheOnCPU(t);if(le().getBool("DEBUG")&&!le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&le().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(i!=="complex64"&&le().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);let g=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(g.texture.texture,...Qw(a))}this.pendingRead.set(t,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(i==="complex64"){let g=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),m=g[0],y=g[1];h=P.mergeRealAndImagArrays(m,y)}else if(c==null)h=this.getValuesFromTexture(t);else{let g=j.sizeFromShape(a);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,g)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){let g=this.gpgpu.gl;Me(g,()=>g.deleteBuffer(c))}let p=this.convertAndCacheOnCPU(t,h),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach(g=>g(p)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Ys().removeDataId(t,this),this.pendingDeletes--),p}readToGPU(t,n={}){let r=this.texData.get(t),{values:a,shape:s,slice:i,dtype:o,isPacked:l,texture:c}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new vu(s,Jl):f=new xo(s,Jl);let g=this.runWebGLProgram(f,[{dataId:t,shape:s,dtype:o}],o),m=this.readToGPU(g,n);return this.disposeIntermediateTensorInfo(g),m}if(c==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let u=this.decode(t,n.customTexShape),h=Ys().makeTensorFromTensorInfo(u),p=this.texData.get(u.dataId);return Object.assign({tensorRef:h},p.texture)}bufferSync(t){let n=this.readSync(t.dataId);if(t.dtype==="string")try{let r=n.map(a=>j.decodeString(a));return jt(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return jt(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){let r=t[n];if(!LQ(r))throw le().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){let{shape:n,dtype:r,isPacked:a}=this.texData.get(t),s=j.sizeFromShape(n);if(le().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let p=this.decode(t),f=this.texData.get(p.dataId),g=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Qw(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(p),g}let i=le().getBool("WEBGL_PACK")&&a===!0,o=i?tx(n):n,l=i?new u5e(o):new l5e(o),c=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:t}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){let n=this.activeTimers,r=[],a=!1;this.programTimersStack==null?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t();let s=j.flatten(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=j.flatten(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,a&&(this.programTimersStack=null);let o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let l=await Promise.all(s);o.kernelMs=j.sum(l),o.getExtraProfileInfo=()=>l.map((c,u)=>({name:i[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:j.now(),endMs:null}}endTimer(t){return le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=j.now(),t)}async getQueryTime(t){if(le().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);let n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);let{complexTensorInfos:r}=this.texData.get(t);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){let{texture:n,dtype:r,texShape:a,usage:s,isPacked:i,slice:o}=this.texData.get(t),l=o&&o.origDataId||t,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,s,i)));let u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=C6e){return le().getBool("WEBGL_CPU_FORWARD")&&t.every(r=>this.texData.get(r.dataId).texture==null&&j.sizeFromShape(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){P.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let n=t.dataSync();return N6e(t.shape,n)}packedUnaryOp(t,n,r){let a=new vu(t.shape,n),s=this.compileAndRun(a,[t],r);return Ys().makeTensorFromTensorInfo(s)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){let a=$X(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,a)}if(le().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,x3,t.dtype);let n=new xo(t.shape,x3),r=this.compileAndRun(n,[t]);return Ys().makeTensorFromTensorInfo(r)}makeTensorInfo(t,n,r){let a;if(n==="string"&&r!=null&&r.length>0&&j.isString(r[0])){let s=r.map(i=>j.encodeString(i));a=this.write(s,t,n)}else a=this.write(r,t,n);return this.texData.get(a).usage=null,{dataId:a,shape:t,dtype:n}}makeOutput(t,n,r){return Ys().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,r),this)}unpackTensor(t){let n=new w6e(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){let n=new s6e(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){let r=[qd(t.shape),...Kd(t.shape)],a={dtype:t.dtype,shape:r,dataId:t.dataId},s=[qd(n),...Kd(n)],i=new MX(s,r),o=!0,l=[r],c=this.runWebGLProgram(i,[a],t.dtype,l,o);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(t,n){let r=this.texData.get(t),{isPacked:a,shape:s,dtype:i}=r;if(n!=null){let p=j.sizeFromShape(s),f=n[0]*n[1]*4;j.assert(p<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let o=tx(s),l;a?l=new o5e(o):l=new i5e(o);let c=!0,u=[n??Qw(o)],h=this.runWebGLProgram(l,[{shape:o,dtype:i,dataId:t}],i,u,c,n);return{dtype:i,shape:s,dataId:h.dataId}}runWebGLProgram(t,n,r,a,s=!1,i){let o=this.makeTensorInfo(t.outputShape,r),l=this.texData.get(o.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===cv.DENSE){let x=i??Qw(t.outputShape);l.texShape=x.map(v=>v*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),j.sizeFromShape(o.shape)===0)return l.values=j.getTypedArrayFromDType(o.dtype,0),o;let c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(x.dataId);if(v.texture==null){if(!t.packedInputs&&j.sizeFromShape(x.shape)<=le().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:v.values};t.packedInputs&&(v.isPacked=!0,v.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!v.isPacked!=!!t.packedInputs)x=v.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),v=this.texData.get(x.dataId);else if(v.isPacked&&!dv(v.shape,x.shape)){let b=x,w=x.shape;x.shape=v.shape,x=this.packedReshape(x,w),c.push(x),v=this.texData.get(x.dataId),b.shape=w}return{shape:x.shape,texData:v,isUniform:!1}});this.uploadToGPU(o.dataId);let h={shape:o.shape,texData:l,isUniform:!1},p=s5e(t,u,h),f=this.getAndSaveBinary(p,()=>r5e(this.gpgpu,t,u,h)),g=this.activeTimers!=null,m;g&&(m=this.startTimer()),le().get("ENGINE_COMPILE_ONLY")||a5e(this.gpgpu,f,u,h,a),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),g&&(m=this.endTimer(m),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(m)}));let y=le().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){let x=j.now();x-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!le().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){let x=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),x}return o}compileAndRun(t,n,r,a,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(t,n,r,a,s)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(le().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=te(()=>{if(!le().get("WEBGL_RENDER_FLOAT32_ENABLED")){let t=le().getBool("DEBUG");le().set("DEBUG",!1);let n=this.abs(Ze(1e-8)).dataSync()[0];if(le().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?k6e:S6e}uploadToGPU(t){let n=this.texData.get(t),{shape:r,dtype:a,values:s,texture:i,usage:o,isPacked:l}=n;if(i!=null)return;let c=this.activeTimers!=null,u;c&&(u=j.now());let h=n.texShape;if(h==null&&(h=nX(r,l),n.texShape=h),s!=null){let p=tx(r),f,g=h[1],m=h[0],y=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(l||!y)&&([g,m]=oy(h[0],h[1])),l?f=new d5e(p,y):f=new f3(p,y);let x=y?[m,g]:h,v=this.makeTensorInfo(x,a),b=this.texData.get(v.dataId);y?b.usage=Rs.PIXELS:b.usage=Rs.UPLOAD,b.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),g,m,s);let w=[[m,g]],k=this.runWebGLProgram(f,[v],a,w,!0),I=this.texData.get(k.dataId);n.texShape=I.texShape,n.isPacked=I.isPacked,n.usage=I.usage,le().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=I.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(v),c&&(this.uploadWaitMs+=j.now()-u)}else{let p=this.acquireTexture(h,o,a,l);n.texture=p}}convertAndCacheOnCPU(t,n){let r=this.texData.get(t),{dtype:a}=r;return n!=null&&(r.values=T6e(n,a)),r.values}acquireTexture(t,n,r,a){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,a)}computeBytes(t,n){return t[0]*t[1]*j.bytesPerElement(n)}checkCompileCompletion(){for(let[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){let t=[];if(this.gpgpu.parallelCompilationExtension){for(let[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(let[,n]of Object.entries(this.binaryCache)){let r=new Promise(a=>{try{this.checkCompletion_(n),a(!0)}catch(s){throw s}});t.push(r)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await G$(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(qD(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);let{variablesLocations:n,customUniformLocations:r,infLoc:a,nanLoc:s,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:l}=pX(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=r,t.infLoc=a,t.nanLoc=s,t.outShapeLocation=i,t.outShapeStridesLocation=o,t.outTexShapeLocation=l}}createTensorFromGPUData(t,n,r){t.channels=t.channels||"RGBA";let{texture:a,height:s,width:i,channels:o}=t,l=Ys().backend;if(!l.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let c=l.writeTexture(a,n,r,s,i,o);return Ys().makeTensorFromDataId(c,n,r,l)}};rM.nextDataId=0;function T6e(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){let n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}var j6e="4.22.0";function FX(){le().set("WEBGL_FORCE_F16_TEXTURES",!0)}xb.isBrowser()&&Wk("webgl",()=>new rM,2);var A6e={forceHalfFloat:FX},aM=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,Qd=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=P.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=la(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}},Dp=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`,py=class{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=P.assertAndGetBroadcastShape(t,n);let a=this.outputShape.length;this.enableShapeUniforms=la(a);let s="";if(r)if(a===0||j.sizeFromShape(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          ${kn(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?s+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:s+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let i=xa("coords",a);this.enableShapeUniforms?s+=`
            bool nextRowOutOfBounds =
              (${i[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${i[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:s+=`
            bool nextRowOutOfBounds =
              (${i[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${i[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${s}

        setOutput(result);
      }
    `}};function ks(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var $6e={kernelName:Oh,backendName:"webgl",kernelFunc:ks};function _c(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,s=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(s.dataId),o=ks({inputs:{x:r},backend:n}),l=ks({inputs:{x:a},backend:n});return i.complexTensorInfos={real:o,imag:l},s}var R6e={kernelName:Ek,backendName:"webgl",kernelFunc:_c},PX="return (a < 0.) ? b * a : a;",LX=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function D6e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:s}=r,i=n.makeTensorInfo([],"float32",j.createScalarValue(s,"float32")),o=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new py(LX,a.shape,i.shape):new Qd(PX,a.shape,i.shape),l=n.runWebGLProgram(o,[a,i],"float32");return n.disposeIntermediateTensorInfo(i),l}var M6e={kernelName:zh,backendName:"webgl",kernelFunc:D6e},zX="return (a < 0.) ? b * a : a;",BX=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function O6e(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new py(BX,r.shape,a.shape):new Qd(zX,r.shape,a.shape);return n.runWebGLProgram(s,[r,a],"float32")}var F6e={kernelName:np,backendName:"webgl",kernelFunc:O6e},fy="if (isnan(x)) return x;";function en({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:s})=>{let{x:i}=a,o=s,l=r||i.dtype;if(o.shouldExecuteOnCPU([i])&&n!=null){let h=o.texData.get(i.dataId),p=n(h.values,l);return o.makeTensorInfo(i.shape,l,p)}let c=le().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,u;return c?u=new vu(i.shape,t):u=new xo(i.shape,e),o.runWebGLProgram(u,[i],l)}}function Yr({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:s}){return({inputs:i,backend:o})=>{let{a:l,b:c}=i,u=o;if(r&&l.dtype==="complex64"){let g=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[y,x]=[[g.complexTensorInfos.real,m.complexTensorInfos.real],[g.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{let[w,k]=b,I={dataId:w.dataId,dtype:w.dtype,shape:l.shape},C={dataId:k.dataId,dtype:k.dtype,shape:c.shape},S=new Qd(e,l.shape,c.shape);return u.runWebGLProgram(S,[I,C],Bs(w.dtype,k.dtype))}),v=_c({inputs:{real:y,imag:x},backend:u});return u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(x),v}let h=s||Bs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&a!=null){let g=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,y=l.dtype==="string"?P.fromUint8ToStringArray(g):g,x=l.dtype==="string"?P.fromUint8ToStringArray(m):m,[v,b]=a(l.shape,c.shape,y,x,h),w=u.makeTensorInfo(b,h),k=u.texData.get(w.dataId);return k.values=v,w}let p=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,f;return p?f=new py(t,l.shape,c.shape,n):f=new Qd(e,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function hv(e,t=!1){if(e==="linear")return t?g6e:d6e;if(e==="relu")return t?x6e:p6e;if(e==="elu")return t?y6e:h6e;if(e==="relu6")return t?v6e:f6e;if(e==="prelu")return t?BX:zX;if(e==="leakyrelu")return t?LX:PX;if(e==="sigmoid")return t?b6e:m6e;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}var UX=class{constructor(e,t,n,r=!1,a=!1,s=!1,i=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=la(this.outputShape.length);let c=r?e[1]:e[2],u=Math.ceil(c/2),h=r?"i * 2, rc.y":"rc.y, i * 2",p=a?"rc.z, i * 2":"i * 2, rc.z",f=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",y="";i&&(o?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${i}
        }`:l?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${i}
        }`:m=`vec4 activation(vec4 x) {
          ${i}
        }`,y="result = activation(result);");let x=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<t[0]?v=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(b=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${u}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${b};
        for (int i = 0; i < ${u}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${g[0]});
          result += (${f[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${y}

        setOutput(result);
      }
    `}},v3={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},b3=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=P.assertAndGetBroadcastShape(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}},w3="return a * b;";function sM(e){let{inputs:t,backend:n}=e,{a:r,b:a}=t,s=P.upcastType(r.dtype,a.dtype);if(r.dtype==="complex64"){let o=n.texData.get(r.dataId),l=n.texData.get(a.dataId),c=new b3(v3.REAL,r.shape,a.shape),u=new b3(v3.IMAG,r.shape,a.shape),h=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],p=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),g=_c({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),g}if(n.shouldExecuteOnCPU([r,a])){let o=n.texData.get(r.dataId),l=n.texData.get(a.dataId),[c,u]=D5e(r.shape,a.shape,o.values,l.values,s),h=n.makeTensorInfo(u,s),p=n.texData.get(h.dataId);return p.values=c,h}let i;return le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new py(w3,r.shape,a.shape):i=new Qd(w3,r.shape,a.shape),n.runWebGLProgram(i,[r,a],s)}var P6e={kernelName:Jh,backendName:"webgl",kernelFunc:sM};function L6e(e,t,n){let r=[qd(e.shape),...Kd(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},s=[qd(t),...Kd(t)],i=new MX(s,r),o=!0,l=[r],c=n.runWebGLProgram(i,[a],e.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}function Re(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:s}=r,i=n,o=j.sizeFromShape(a.shape),l=j.inferFromImplicitShape(s,o),c=j.sizeFromShape(l);j.assert(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);let u=i.texData.get(a.dataId);return u.isPacked&&!dv(a.shape,l)&&!(u.texture!==null&&dv(u.shape,l))?L6e(a,l,i):(i.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}var z6e={kernelName:$g,backendName:"webgl",kernelFunc:Re},N3=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:s}=e;this.outputShape=[r,s];let i=Math.floor(n/4)*4,o=n%4,l="sumValue += dot(values, ones);";if(t!=null){let u=1/t;l=`sumValue += dot(values * ${j.isInt(u)?u.toPrecision(2):u}, ones);`}let c="";a%n>0&&(c=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${i}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${i};
        if (${o===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${o===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${o===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}},B6e=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:s}=e;this.outputShape=[r,s];let i="0.0",o="";t==="prod"?i="1.0":t==="min"?(i="1.0 / 1e-20",o="min"):t==="max"&&(i="-1.0 / 1e-20",o="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");let c=Math.floor(n/4)*4,u=n%4,h=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${o}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${o}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";t==="all"?(i="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(i="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let f="";a%n>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${i};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${i});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${u===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${u===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${u===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${l});
      }
    `}};function U6e(e){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let n=t.length?t[t.length-1].outSize:e[1],r=P.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function Mp(e,t,n,r){let a=U6e(e.shape),s=e;for(let i=0;i<a.length;i++){let{inSize:o,windowSize:l,outSize:c}=a[i],u,h;n==="mean"?u=i===0?new N3({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},o):new N3({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c}):u=new B6e({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},n),h=s,s=r.runWebGLProgram(u,[s],t),h.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(h)}return s}var W6e=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let s=0;s<n.length;s++)n[s]=e[t[s]];this.outputShape=n,this.rank=n.length;let r=kn(this.rank),a=V6e(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}};function V6e(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}var H6e=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let r=kn(this.rank),a=DX("rc",this.rank),s=new Array(this.rank);for(let c=0;c<t.length;c++)s[t[c]]=a[c];let i=`vec2(${s.slice(-2).join()})`,o=`++${a[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${s.join()}), ${i})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${o}) {
        result[1] = ${l};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${l};
        if(${o}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}};function KS(e,t,n){let r=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new H6e(e.shape,t):new W6e(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function G6e(e,t,n,r){let a=t,s=e.shape.length,i=j.parseAxisParam(a,e.shape),o=i,l=P.getAxesPermutation(o,s),c=l!=null,u=e;c&&(u=KS(e,l,r),o=P.getInnerMostAxes(o.length,s)),P.assertAxesAreInnerMostDims("sum",o,s);let[h,p]=P.computeOutAndReduceShapes(u.shape,o),f=h;n&&(f=P.expandShapeToKeepDim(h,i));let g=j.sizeFromShape(p),m=j.sizeFromShape(e.shape)/g,y=Re({inputs:{x:u},attrs:{shape:[m,g]},backend:r}),x=Uk(e.dtype),v=Mp(y,x,"sum",r),b=Re({inputs:{x:v},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(v),c&&r.disposeIntermediateTensorInfo(u),b}function QS(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r;return G6e(a,s,i,n)}var q6e={kernelName:vp,backendName:"webgl",kernelFunc:QS};function _a(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{perm:s}=r,i=n,o=a.shape.length,l=new Array(o);for(let u=0;u<l.length;u++)l[u]=a.shape[s[u]];let c;if(i.shouldExecuteOnCPU([a])){let u=i.texData.get(a.dataId).values,h=nM(u,a.shape,a.dtype,s,l);c=i.makeTensorInfo(l,a.dtype);let p=i.texData.get(c.dataId);p.values=h}else c=KS(a,s,i);return c}var K6e={kernelName:dl,backendName:"webgl",kernelFunc:_a},WX=1e3;function tN({a:e,b:t,transposeA:n,transposeB:r,backend:a,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}){let c=e.shape.length,u=t.shape.length,h=n?e.shape[c-2]:e.shape[c-1],p=r?t.shape[u-1]:t.shape[u-2],f=n?e.shape[c-1]:e.shape[c-2],g=r?t.shape[u-2]:t.shape[u-1],m=e.shape.slice(0,-2),y=t.shape.slice(0,-2),x=j.sizeFromShape(m),v=j.sizeFromShape(y),b=Xg.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([f,g]);j.assert(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);let w=n?[x,h,f]:[x,f,h],k=r?[v,g,p]:[v,p,g],I=Re({inputs:{x:e},backend:a,attrs:{shape:w}}),C=Re({inputs:{x:t},backend:a,attrs:{shape:k}}),S=[I,C],E=Math.max(x,v),T=n?I.shape[1]:I.shape[2],$=s!=null,_=i!=null,M=l==="leakyrelu",L=l!=null?hv(l,!0):null,U=$||_||M||L!=null,O;if((f===1||g===1)&&T>WX&&U===!1){let D=I,R=C;n&&(D=_a({inputs:{x:I},backend:a,attrs:{perm:[0,2,1]}}),S.push(D)),r&&(R=_a({inputs:{x:C},backend:a,attrs:{perm:[0,2,1]}}),S.push(R));let V=g!==1,G=g===1,W=D;V&&(W=Re({inputs:{x:D},backend:a,attrs:{shape:[E,T,1]}}),S.push(W));let B=g===1?2:1,Q=R;G&&(Q=Re({inputs:{x:R},backend:a,attrs:{shape:[E,1,T]}}),S.push(Q));let X=sM({inputs:{a:W,b:Q},backend:a});O=QS({inputs:{x:X},backend:a,attrs:{axis:B,keepDims:!0}}),S.push(X)}else{let D=Bs(e.dtype,t.dtype),R=new UX(w,k,[E,f,g],n,r,$,L,_,M),V=[I,C];if(s!=null&&V.push(s),_&&V.push(i),M){let G=a.makeTensorInfo([],"float32",j.createScalarValue(o,"float32"));V.push(G),S.push(G)}O=a.runWebGLProgram(R,V,D)}let F=Re({inputs:{x:O},backend:a,attrs:{shape:b}});S.push(O);for(let D of S)a.disposeIntermediateTensorInfo(D);return F}function Q6e(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:s,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r;return tN({a,b:s,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:o,leakyreluAlpha:h,activation:u})}var X6e={kernelName:$d,backendName:"webgl",kernelFunc:Q6e},k3="return abs(x);";function Y6e(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let s=n.texData.get(r.dataId),i=$X(s.values);return n.makeTensorInfo(r.shape,r.dtype,i)}let a;return le().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new vu(r.shape,k3):a=new xo(r.shape,k3),n.runWebGLProgram(a,[r],r.dtype)}var J6e={kernelName:Km,backendName:"webgl",kernelFunc:Y6e},Z6e=fi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,eVe=en({opSnippet:Z6e}),tVe={kernelName:oh,backendName:"webgl",kernelFunc:eVe},nVe=fi+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,rVe=en({opSnippet:nVe}),aVe={kernelName:lh,backendName:"webgl",kernelFunc:rVe},S3="return a + b;",sVe=Yr({opSnippet:S3,packedOpSnippet:S3,supportsComplex:!0,cpuKernelImpl:p5e}),iVe={kernelName:mc,backendName:"webgl",kernelFunc:sVe},oVe=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,s)=>`T${s}`);let n=[];this.variableNames.forEach(a=>{n.push(`float v${a} = get${a}AtOutCoords();`)});let r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}},lVe=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,s)=>`T${s}`);let n=[];this.variableNames.forEach(a=>{n.push(`vec4 v${a} = get${a}AtOutCoords();`)});let r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}};function D0(e){let{inputs:t,backend:n}=e,r=t;if(r.length===1)return ks({inputs:{x:r[0]},backend:n});if(r.length>le().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let o=Math.floor(r.length/2),l=D0({inputs:r.slice(0,o),backend:n}),c=D0({inputs:r.slice(o),backend:n});return D0({inputs:[l,c],backend:n})}let a=r.map(o=>o.dtype).reduce((o,l)=>Bs(o,l)),s=r.map(o=>o.shape),i=le().getBool("WEBGL_PACK")?new lVe(r[0].shape,s):new oVe(r[0].shape,s);return n.runWebGLProgram(i,r,a)}var uVe={kernelName:uh,backendName:"webgl",kernelFunc:D0};function cVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r,o=a.shape.length,l=j.parseAxisParam(s,a.shape),c=l,u=P.getAxesPermutation(c,o),h=a;u!=null&&(h=_a({inputs:{x:a},backend:n,attrs:{perm:u}}),c=P.getInnerMostAxes(c.length,o)),P.assertAxesAreInnerMostDims("all",c,o);let[p,f]=P.computeOutAndReduceShapes(h.shape,c),g=j.sizeFromShape(f),m=Re({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),y=Mp(m,m.dtype,"all",n),x;if(i){let v=P.expandShapeToKeepDim(p,l);x=Re({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=Re({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(h),x}var dVe={kernelName:Qm,backendName:"webgl",kernelFunc:cVe};function hVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r,o=a.shape.length,l=j.parseAxisParam(s,a.shape),c=l,u=P.getAxesPermutation(c,o),h=a;u!=null&&(h=_a({inputs:{x:a},backend:n,attrs:{perm:u}}),c=P.getInnerMostAxes(c.length,o)),P.assertAxesAreInnerMostDims("any",c,o);let[p,f]=P.computeOutAndReduceShapes(h.shape,c),g=j.sizeFromShape(f),m=Re({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),y=Mp(m,m.dtype,"any",n),x;if(i){let v=P.expandShapeToKeepDim(p,l);x=Re({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=Re({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(h),x}var pVe={kernelName:Xm,backendName:"webgl",kernelFunc:hVe},fVe=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:r,batchSize:a,outSize:s}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];let i=t==="max"?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${o};
          float candidate = getA(batch, inIdx);
          if (candidate ${i} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}},mVe=class{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,j.assert(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let a=e[e.length-1],s=Math.ceil(a/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),r||this.variableNames.push("bestIndicesA");let i=this.outputShape,o=i.length,l=kn(o),c=xa("coords",o),u,h;if(s===1){h=o+1;let C=kn(h);u=`
        ${C} sourceLocR = ${C}(${c.join()}, 0);
        ++${c[o-1]};
        ${C} sourceLocG = ${C}(${c.join()}, 0);
        ++${c[o-2]};
        ${C} sourceLocA = ${C}(${c.join()}, 0);
        --${c[o-1]};
        ${C} sourceLocB = ${C}(${c.join()}, 0);
        --${c[o-2]};`}else h=o,u=`
        ${l} sourceLocR = coords;
        ++${c[o-1]};
        ${l} sourceLocG = coords;
        ++${c[o-2]};
        ${l} sourceLocA = coords;
        --${c[o-1]};
        ${l} sourceLocB = coords;
        --${c[o-2]};`;let p=["x","y","z","w","u","v"].slice(0,h),f="."+p[h-1],g=p.map(C=>"int "+C),m=xa("sourceLocR",h-1).concat("inIdx.r"),y=xa("sourceLocG",h-1).concat("inIdx.g"),x=xa("sourceLocB",h-1).concat("inIdx.b"),v=xa("sourceLocA",h-1).concat("inIdx.a"),b=n==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,k=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,I=r?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${I}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${c[o-1]} < ${i[o-1]-1};
        bool hasNextRow = ${c[o-2]} < ${i[o-2]-1};
        ${u}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function VX(e,t,n,r=null){let a=t.shape[0],s=t.shape[1];r!=null&&(a=r.shape[0],s=r.shape[1]);let i=P.computeOptimalWindowSize(s),o={windowSize:i,inSize:s,batchSize:a,outSize:Math.ceil(s/i)},l=new fVe(o,n,r==null),c=[t];r!=null&&c.push(r);let u=e.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;let h=VX(e,t,n,u);return e.disposeIntermediateTensorInfo(u),h}function HX(e,t,n,r=null){let a=r!=null?r.shape:t.shape,s=a[a.length-1],i=P.computeOptimalWindowSize(s),o=new mVe(a,i,n,r==null),l=r==null?[t]:[t,r],c=e.runWebGLProgram(o,l,"int32");if(c.shape.length===t.shape.length){let u=HX(e,t,n,c);return e.disposeIntermediateTensorInfo(c),u}return c}function GX(e,t,n,r){let a=[n];if(P.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!le().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let s=[],i=e.texData.get(t.dataId),o=i!==null&&i.isPacked,l=t;o&&(l=e.unpackTensor(t),s.push(l));let[c,u]=P.computeOutAndReduceShapes(l.shape,a),h=j.sizeFromShape(u),p=Re({inputs:{x:l},backend:e,attrs:{shape:[-1,h]}});s.push(p);let f=VX(e,p,r);s.push(f);let g=Re({inputs:{x:f},backend:e,attrs:{shape:c}});return s.forEach(m=>e.disposeIntermediateTensorInfo(m)),g}return HX(e,t,r)}function gVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s}=r,i=j.parseAxisParam(s,a.shape),o=P.getAxesPermutation(i,a.shape.length),l=a,c=[];o!=null&&(l=_a({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),i=P.getInnerMostAxes(i.length,l.shape.length)),P.assertAxesAreInnerMostDims("argMax",[i[0]],l.shape.length);let u=GX(n,l,i[0],"max");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}var yVe={kernelName:Ym,backendName:"webgl",kernelFunc:gVe};function xVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s}=r,i=j.parseAxisParam(s,a.shape),o=P.getAxesPermutation(i,a.shape.length),l=a,c=[];o!=null&&(l=_a({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),i=P.getInnerMostAxes(i.length,l.shape.length)),P.assertAxesAreInnerMostDims("argMin",[i[0]],l.shape.length);let u=GX(n,l,i[0],"min");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}var vVe={kernelName:Jm,backendName:"webgl",kernelFunc:xVe},bVe=fi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,wVe=en({opSnippet:bVe}),NVe={kernelName:ch,backendName:"webgl",kernelFunc:wVe},kVe=fi+"return log(x + sqrt(x * x + 1.0));",SVe=en({opSnippet:kVe}),_Ve={kernelName:dh,backendName:"webgl",kernelFunc:SVe},CVe=fi+`
  return atan(x);
`,IVe=en({opSnippet:CVe}),EVe={kernelName:hh,backendName:"webgl",kernelFunc:IVe},TVe=aM+`
  return atan(a, b);
`,jVe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Dp+`
  return result;
`,AVe=Yr({opSnippet:TVe,packedOpSnippet:jVe}),$Ve={kernelName:fh,backendName:"webgl",kernelFunc:AVe},RVe=fi+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,DVe=en({opSnippet:RVe}),MVe={kernelName:ph,backendName:"webgl",kernelFunc:DVe},pv=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let s=e.filterWidth,i=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;let g=t==="avg",m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,x="0.0";if(g||(x="-1.0 / 1e-20"),n){let C=">=";this.userCode=`
        const ivec2 strides = ivec2(${i}, ${o});
        const ivec2 pads = ivec2(${p}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${u};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${C} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?m:y:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let v="max",b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(b="avgValue / max(count, 1.0)");let w=Math.floor(s/4)*4,k=s%4,I=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${p}, ${f});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${u};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${I}
          }

          int xC = xCCorner + ${w};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${I}
          }
        }
        setOutput(${b});
      }
    `}},iM=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,g=e.effectiveFilterWidth,m=e.padInfo.front,y=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;let v=t==="avg",b="0.0";if(v||(b="-1.0 / 1e-20"),n){let E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${i}, ${o}, ${l});
        const ivec3 pads = ivec3(${m}, ${y}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${u}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let w="max",k=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(k="avgValue / max(count, 1.0)");let I=Math.floor(s/4)*4,C=s%4,S=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${i}, ${o}, ${l});
      const ivec3 pads = ivec3(${m}, ${y}, ${x});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${I}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${S}
            }

            int xC = xCCorner + ${I};
            if (${C===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${S}
            } else if (${C===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${S}
            } else if (${C===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${S}
            }
          }
        }
        setOutput(${k});
      }
    `}};function OVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;ly(a,"avgPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=r,c=1;j.assert(P.eitherStridesOrDilationsAreOne(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=P.computePool2DInfo(a.shape,s,i,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&j.arraysEqual(u.inShape,u.outShape))return ks({inputs:{x:a},backend:n});let h=new pv(u,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}var FVe={kernelName:mh,backendName:"webgl",kernelFunc:OVe};function PVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],h=P.computePool3DInfo(a.shape,s,i,u,o,l,c),p=new iM(h,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}var LVe={kernelName:Zm,backendName:"webgl",kernelFunc:PVe},zVe=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,s=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=l-1-e.padInfo.left,h=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${u});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
            wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${i}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},BVe=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=u-1-e.padInfo.front,g=h-1-e.padInfo.top,m=p-1-e.padInfo.left,y=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${g}, ${m});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
            wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function UVe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,i=s,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,h=[1,1,1],p=P.computePool3DInfo(i.shape,o,l,h,c,u),f=new BVe(p);return n.runWebGLProgram(f,[a],i.dtype)}var WVe={kernelName:Qv,backendName:"webgl",kernelFunc:UVe};function VVe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,i=s;ly([a,s],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=r,u=P.computePool2DInfo(i.shape,o,l,1,c),h=new zVe(u);return n.runWebGLProgram(h,[a],i.dtype)}var HVe={kernelName:Kv,backendName:"webgl",kernelFunc:VVe};function GVe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:s}=t,{transposeA:i,transposeB:o}=r;return tN({a,b:s,transposeA:i,transposeB:o,backend:n})}var qVe={kernelName:gh,backendName:"webgl",kernelFunc:GVe},KVe=class{constructor(e,t,n,r,a,s){this.outputShape=[],this.variableNames=["x","mean","variance"],P.assertAndGetBroadcastShape(e,t),P.assertAndGetBroadcastShape(e,n);let i="0.0";r!=null&&(P.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="1.0";a!=null&&(P.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${i};
        float scale = ${o};
        float inv = scale * inversesqrt(variance + float(${s}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}},QVe=class{constructor(e,t,n,r,a,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],P.assertAndGetBroadcastShape(e,t),P.assertAndGetBroadcastShape(e,n);let i="vec4(0.0)";r!=null&&(P.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="vec4(1.0)";a!=null&&(P.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${i};
        vec4 scale = ${o};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${s}));

        setOutput((x - mean) * inv + offset);
      }
    `}},XVe=({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:a,variance:s,offset:i,scale:o}=e;j.assert(a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j.assert(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j.assert(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);let c=[r,a,s],u=null;i!=null&&(u=i.shape,c.push(i));let h=null;o!=null&&(h=o.shape,c.push(o));let p=le().getBool("WEBGL_PACK_NORMALIZATION")?new QVe(r.shape,a.shape,s.shape,u,h,l):new KVe(r.shape,a.shape,s.shape,u,h,l);return t.runWebGLProgram(p,c,c[0].dtype)},YVe={kernelName:Dh,backendName:"webgl",kernelFunc:XVe},JVe=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=kn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n=ZVe(this.rank),r,a=e.map((s,i)=>`sourceLoc.${$E[i]} = start[${i}] + coords.${$E[i]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${n}));
      }
    `}},$E=["x","y","z","w","u","v"];function ZVe(e){if(e===1)return"sourceLoc";if(e<=6)return $E.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}var eHe=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=kn(this.rank),n=xa("coords",this.rank),r=xa("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,s=`getChannel(getSource(${r.join()}), ${a})`,i=`
      result.x = ${s};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${s};
        --${r[this.rank-1]};
      }
    `,o=this.rank===1?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${s};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${s};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((c,u)=>`start[${u}]`).join()});`:e.map((c,u)=>`${r[u]} = ${n[u]} + start[${u}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${i}
        ${o}
        setOutput(result);
      }
    `}};function tHe(e,t,n,r){let a=r.texData.get(e.dataId),s=r.makeTensorInfo(n,e.dtype),i=r.texData.get(s.dataId);Object.assign(i,a),i.refCount=1,i.shape=n,i.dtype=e.dtype;let o=wr.computeFlatOffset(t,j.computeStrides(e.shape));a.slice&&(o+=a.slice.flatOffset),i.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||e.dataId};let l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),s}function my(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:s,size:i}=r,[o,l]=wr.parseSliceParams(a,s,i);if(wr.assertParamsValid(a,o,l),j.sizeFromShape(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){let h=n.texData.get(a.dataId),p=H5e(h.values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,p)}let{isPacked:c}=n.texData.get(a.dataId),u=wr.isSliceContinous(a.shape,o,l);if(c||!u){let h=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eHe(l):new JVe(l),p=[o];return n.runWebGLProgram(h,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),tHe(a,o,l,n)}var nHe={kernelName:Lg,backendName:"webgl",kernelFunc:my},rHe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,crops:i}=r;j.assert(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=s.reduce((v,b)=>v*b),l=P.getReshaped(a.shape,s,o),c=P.getPermuted(l.length,s.length),u=P.getReshapedPermuted(a.shape,s,o),h=P.getSliceBeginCoords(i,s.length),p=P.getSliceSize(u,i,s.length),f=[],g=Re({inputs:{x:a},backend:n,attrs:{shape:l}}),m=_a({inputs:{x:g},backend:n,attrs:{perm:c}}),y=Re({inputs:{x:m},backend:n,attrs:{shape:u}}),x=my({inputs:{x:y},backend:n,attrs:{begin:h,size:p}});return f.push(g),f.push(m),f.push(y),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),x},aHe={kernelName:eg,backendName:"webgl",kernelFunc:rHe};function sHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:s}=t,{size:i}=r,o=n.readSync(a.dataId),l=n.readSync(s.dataId),c=AX(o,l,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,c)}var iHe={kernelName:tg,backendName:"webgl",kernelFunc:sHe},oHe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,lHe=`
  return float(int(a.r) & int(b.r));
`;function uHe(e){let{inputs:t,backend:n}=e,{a:r,b:a}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=le().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,a])||i===1){let l=n.texData.get(r.dataId).values,c=n.texData.get(a.dataId).values,[u,h]=m5e(r.shape,a.shape,l,c,r.dtype),p=n.makeTensorInfo(h,r.dtype),f=n.texData.get(p.dataId);return f.values=u,p}let o;return s?o=new py(oHe,r.shape,a.shape,!1):o=new Qd(lHe,r.shape,a.shape),n.runWebGLProgram(o,[r,a],r.dtype)}var cHe={kernelName:ng,backendName:"webgl",kernelFunc:uHe};function dHe(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,s=n.readSync(r.dataId),i=n.readSync(a.dataId),o=P.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var hHe={kernelName:Xv,backendName:"webgl",kernelFunc:dHe},pHe="return float(a != b);",qX=Yr({opSnippet:pHe,cpuKernelImpl:O5e,dtype:"bool"}),fHe={kernelName:Cg,backendName:"webgl",kernelFunc:qX};function Gb(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return ks({inputs:{x:a.complexTensorInfos.real},backend:n})}var mHe={kernelName:zk,backendName:"webgl",kernelFunc:Gb},gHe="return float(int(x));";function yHe(e,t){let n=new xo(e.shape,gHe),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function RE(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:s}=r;if(s==="complex64"){if(a.dtype==="complex64")return ks({inputs:{x:a},backend:n});let i=Vn(a.shape),o=RE({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=_c({inputs:{real:o,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(o),l}if(a.dtype==="complex64"){let i=Gb({inputs:{input:a},backend:n}),o=RE({inputs:{x:i},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(i),o}if(!j.hasEncodingLoss(a.dtype,s)){let i=ks({inputs:{x:a},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:s}}if(n.shouldExecuteOnCPU([a])){let i=n.texData.get(a.dataId).values,[o,l,c]=g5e(i,a.shape,a.dtype,s);return n.makeTensorInfo(o,l,c)}if(s==="int32")return yHe(a,n);if(s==="bool"){let i=n.makeTensorInfo([],"bool",j.getTypedArrayFromDType("bool",1)),o=qX({inputs:{a,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),o}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${s}`)}var xHe={kernelName:yh,backendName:"webgl",kernelFunc:RE},_3="return ceil(x);",vHe=en({opSnippet:_3,packedOpSnippet:_3,cpuKernelImpl:y5e}),bHe={kernelName:xh,backendName:"webgl",kernelFunc:vHe},wHe=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}},NHe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function kHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:s,clipValueMax:i}=r,o;le().getBool("WEBGL_PACK_CLIP")?o=new NHe(a.shape):o=new wHe(a.shape);let l=[[s],[i]];return n.runWebGLProgram(o,[a],a.dtype,l)}var SHe={kernelName:gc,backendName:"webgl",kernelFunc:kHe},_He=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function C3(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function CHe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),s=new _He(r.shape),i=[C3(r,a.complexTensorInfos.real),C3(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(s,i,i[0].dtype)}var IHe={kernelName:Yv,backendName:"webgl",kernelFunc:CHe},EHe=class{constructor(e){this.outputShape=[],this.outputShape=P.computeOutShape(e,1),this.variableNames=e.map((s,i)=>`T${i}`);let t=new Array(e.length-1);t[0]=e[0][1];for(let s=1;s<t.length;s++)t[s]=t[s-1]+e[s][1];let n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<t.length;s++){let i=t[s-1];n.push(`else if (yC < ${t[s]}) setOutput(getT${s}(yR, yC-${i}));`)}let r=t.length,a=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join(`
        `)}
      }
    `}},THe=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=P.computeOutShape(e,t);let n=this.outputShape,r=n.length,a=kn(r),s=xa("coords",r),i=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((g,m)=>`T${m}`);let o=new Array(e.length-1);o[0]=e[0][t];for(let g=1;g<o.length;g++)o[g]=o[g-1]+e[g][t];let l=i[t],c=i.slice(-2),u=i.join(),h=`if (${l} < ${o[0]}) {
        return getChannel(
            getT0(${u}), vec2(${c.join()}));
        }`;for(let g=1;g<o.length;g++){let m=o[g-1];h+=`
        if (${l} < ${o[g]}  && ${l} >= ${o[g-1]}) {
          return getChannel(
            getT${g}(${Yw(i,l,m)}),
            vec2(${Yw(c,l,m)}));
        }`}let p=o.length,f=o[o.length-1];h+=`
        return getChannel(
          getT${p}(${Yw(i,l,f)}),
          vec2(${Yw(c,l,f)}));`,this.userCode=`
      float getValue(${i.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${s}), 0., 0., 0.);

        ${s[r-1]} = ${s[r-1]} + 1;
        if (${s[r-1]} < ${n[r-1]}) {
          result.g = getValue(${s});
        }

        ${s[r-2]} = ${s[r-2]} + 1;
        if (${s[r-2]} < ${n[r-2]}) {
          result.a = getValue(${s});
        }

        ${s[r-1]} = ${s[r-1]} - 1;
        if (${s[r-2]} < ${n[r-2]} &&
            ${s[r-1]} < ${n[r-1]}) {
          result.b = getValue(${s});
        }
        setOutput(result);
      }
    `}};function Yw(e,t,n){let r=e.indexOf(t);return e.map((a,s)=>s===r?`${a} - ${n}`:a).join()}function XS(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return ks({inputs:{x:a.complexTensorInfos.imag},backend:n})}var jHe={kernelName:Ok,backendName:"webgl",kernelFunc:XS};function nx(e,t,n){let r=e[0].dtype;if(r==="complex64"){let f=e.map(v=>Gb({inputs:{input:v},backend:n})),g=e.map(v=>XS({inputs:{input:v},backend:n})),m=nx(f,t,n),y=nx(g,t,n),x=_c({inputs:{real:m,imag:y},backend:n});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),g.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),x}let a=n.shouldExecuteOnCPU(e);if(r==="string"&&(a=!0),a){let f=e.map(w=>{let k=[-1,j.sizeFromShape(w.shape.slice(t))];return Re({inputs:{x:w},backend:n,attrs:{shape:k}})}),g=f.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),m=P.computeOutShape(f.map(w=>w.shape),1),y=f[0].shape[0]===1,x=x5e(g,m,r,y),v=P.computeOutShape(e.map(w=>w.shape),t),b=n.makeTensorInfo(v,r,x);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}let s=e.filter(f=>j.sizeFromShape(f.shape)>0),i=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){let f=i?new xo(e[0].shape,Jl):new vu(e[0].shape,Jl);return n.runWebGLProgram(f,e,r)}let o=le().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>o){let f=[];for(let m=0;m<s.length;m+=o){let y=s.slice(m,m+o);f.push(nx(y,t,n))}let g=nx(f,t,n);for(let m of f)n.disposeIntermediateTensorInfo(m);return g}if(i){let f=new THe(s.map(g=>g.shape),t);return n.runWebGLProgram(f,s,r)}let{tensors2D:l,outShape:c}=AHe(s,t,n),u=new EHe(l.map(f=>f.shape)),h=n.runWebGLProgram(u,l,r);l.forEach(f=>n.disposeIntermediateTensorInfo(f));let p=Re({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),p}function AHe(e,t,n){let r=P.computeOutShape(e.map(a=>a.shape),t);return{tensors2D:e.map(a=>Re({inputs:{x:a},attrs:{shape:[-1,j.sizeFromShape(a.shape.slice(t))]},backend:n})),outShape:r}}function KX(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,s=j.parseAxisParam(a,t[0].shape)[0],i=t.map(c=>c.shape);P.assertParamsConsistent(i,s);let o=P.computeOutShape(t.map(c=>c.shape),s);if(j.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(c=>j.sizeFromShape(c.shape)>0);return l.length===1?ks({inputs:{x:l[0]},backend:n}):nx(l,s,n)}var $He={kernelName:rg,backendName:"webgl",kernelFunc:KX},QX=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let s=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,m=e.dataFormat==="channelsLast",y=m?1:2,x=m?2:3,v=m?3:1,b="",w="";n&&(r?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:b=`
          float activation(float x) {
            ${n}
          }
        `,w="result = activation(result);");let k=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${u};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${w}
        setOutput(result);
      }
    `}},RHe=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${s}, ${i});
      const ivec3 pads = ivec3(${t}, ${n}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${u}; wF++) {
          int xF = xFCorner + wF * ${o};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},XX=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=la(this.outputShape.length);let s=e.padInfo.left,i=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,u=c,h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<c;m++)h+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;h+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let m=0;m<c;m++)h+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(u+1)/2;m++){let y=m*2;if(h+=`
           xC = xCCorner + ${y*o};
           `,i===1){if(y<c&&(s%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,o===1&&y>0?h+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<c)){let x=s%2===0?j.nearestLargerEven(o):o;o%2===0&&s%2===1||o%2!==0&&s%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,o>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:h+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):x===1?h+=`
                     xC${y+1} = xTexelC${y};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<c&&(s%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<c&&(h+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<c&&(h+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<c&&(h+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let p="",f="";n&&(r?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${n}
         }`:a?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${n}
         }`:p=`vec4 activation(vec4 x) {
           ${n}
         }`,f="result = activation(result);");let g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${f}
         setOutput(result);
       }
     `}},DHe=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=la(this.outputShape.length);let{dataFormat:n}=t,r=ja(),a=n==="channelsLast",s=a?1:2,i=a?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,l="";for(let c=0;c<=1;c++)for(let u=0;u<=1;u++)l+=`
          blockIndex = rc.z + ${u};
          pos = rc.y + ${c};

          ${o}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${s}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${i}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+u}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+u}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${r.output} = result;
      }
    `}};function nN(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function YX({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:o=null}){let l=e.shape,c=r.texData.get(e.dataId),u=n.inChannels,h=l[0]*l[1]*l[2],p=n.outChannels,f=n.dataFormat==="channelsLast",g=!1,m=!1,y,x=[];if(s!=null){let v=nN(s.shape,f);v!=null&&(s=Re({inputs:{x:s},backend:r,attrs:{shape:v}}),x.push(s))}if(a!=null){let v=nN(a.shape,f);v!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:v}}),x.push(a))}if(!((h===1||p===1)&&u>WX)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&j.arraysEqual(c.shape.slice(-3),l.slice(-3))){let v=l[0]*l[1]*(l[2]+1),b={dataId:e.dataId,shape:[1,v,n.inChannels],dtype:e.dtype},w=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,j.assert(dv(c.shape,b.shape),()=>`packed reshape ${c.shape} to ${b.shape} isn't free`);let k=Re({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(k);let I=tN({a:b,b:k,backend:r,transposeA:g,transposeB:m,bias:a,activation:o,preluActivationWeights:s,leakyreluAlpha:i}),C=r.texData.get(I.dataId);j.assert(C.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=w,C.shape=n.outShape,y=ks({inputs:{x:I},backend:r}),y.shape=n.outShape,x.push(I)}else{let v=n.outHeight*n.outWidth,b=Re({inputs:{x:e},backend:r,attrs:{shape:f?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),w=Re({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),k=tN({a:f?b:w,b:f?w:b,transposeA:!f,transposeB:m,backend:r,bias:a,activation:o,preluActivationWeights:s,leakyreluAlpha:i});y=Re({inputs:{x:k},backend:r,attrs:{shape:n.outShape}}),x.push(b),x.push(w),x.push(k)}for(let v of x)r.disposeIntermediateTensorInfo(v);return y}function JX({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:o=null}){let{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:p,dataFormat:f}=n,g=f==="channelsLast",m=l*c*u,y=p*h,x=[n.batchSize,m,y],v=!0,b=!1,w=[];if(s!=null){let D=nN(s.shape,g);D!=null&&(s=Re({inputs:{x:s},backend:r,attrs:{shape:D}}),w.push(s))}if(a!=null){let D=nN(a.shape,g);D!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:D}}),w.push(a))}let k=Re({inputs:{x:t},backend:r,attrs:{shape:[1,m,j.sizeFromShape(t.shape)/m]}});w.push(k);let I=new DHe(x,n),C=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],S=r.runWebGLProgram(I,[e],"float32",C),E=Re({inputs:{x:S},backend:r,attrs:{shape:x}});w.push(S),w.push(E);let T=a!=null,$=s!=null,_=o==="leakyrelu",M=o?hv(o,!0):null,L=new UX(g?E.shape:k.shape,g?k.shape:E.shape,g?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],v,b,T,M,$,_),U=g?[E,k]:[k,E];if(a&&U.push(a),$&&U.push(s),_){let D=r.makeTensorInfo([],"float32",j.createScalarValue(i,"float32"));U.push(D),w.push(D)}let O=r.runWebGLProgram(L,U,"float32"),F=Re({inputs:{x:O},backend:r,attrs:{shape:n.outShape}});w.push(O);for(let D of w)r.disposeIntermediateTensorInfo(D);return F}function MHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r,h=P.convertConv2DDataFormat(l),p=P.computeConv2DInfo(a.shape,s.shape,i,c,o,u,!1,h),f;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))f=YX({x:a,filter:s,convInfo:p,backend:n});else if(p.strideWidth<=2&&h==="channelsLast"&&le().getBool("WEBGL_EXP_CONV")){let m=new XX(p),y=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];f=n.runWebGLProgram(m,[a,s],"float32",y)}else if(le().getBool("WEBGL_CONV_IM2COL"))f=JX({x:a,filter:s,convInfo:p,backend:n});else{let m=new QX(p);f=n.runWebGLProgram(m,[a,s],"float32")}let g=Re({inputs:{x:f},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(f),g}var OHe={kernelName:vh,backendName:"webgl",kernelFunc:MHe},FHe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,s=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${s?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},PHe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,s=e.dataFormat==="channelsLast",i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=s?1:2,c=s?2:3,u=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${u}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${s}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},LHe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,s=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${s};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${i};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},zHe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${o}, ${l}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function BHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:s}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,h=P.convertConv2DDataFormat(l),p=P.computeConv2DInfo(a.shape,u,i,1,o,c,!1,h),f=new FHe(p);return n.runWebGLProgram(f,[a,s],"float32")}var UHe={kernelName:Tk,backendName:"webgl",kernelFunc:BHe},WHe=class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=la(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,a=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            int wCPerm = ${n} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function VHe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:s}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r,h=P.convertConv2DDataFormat(c),p=P.computeConv2DInfo(i,s.shape,o,1,l,u,!1,h);if(le().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&h==="channelsLast"){let f=[[p.strideHeight,p.strideWidth]],g=new WHe(p);return n.runWebGLProgram(g,[a,s],"float32",f)}else{let f=new PHe(p);return n.runWebGLProgram(f,[a,s],"float32")}}var HHe={kernelName:bh,backendName:"webgl",kernelFunc:VHe};function GHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:l}=r,c=P.computeConv3DInfo(a.shape,s.shape,i,l,o),u=new RHe(c);return n.runWebGLProgram(u,[a,s],"float32")}var qHe={kernelName:wh,backendName:"webgl",kernelFunc:GHe};function KHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:s}=t,{strides:i,pad:o,filterShape:l}=r,c=P.computeConv3DInfo(a.shape,l,i,1,o),u=new LHe(c);return n.runWebGLProgram(u,[a,s],"float32")}var QHe={kernelName:ag,backendName:"webgl",kernelFunc:KHe};function XHe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:s}=t,{pad:i,strides:o,inputShape:l}=r,c=P.computeConv3DInfo(l,s.shape,o,1,i),u=new zHe(c);return n.runWebGLProgram(u,[a,s],"float32")}var YHe={kernelName:sg,backendName:"webgl",kernelFunc:XHe},JHe=fy+`
  return cos(x);
`,ZHe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Dp}
  return result;
`,eGe=en({opSnippet:JHe,packedOpSnippet:ZHe}),tGe={kernelName:Nh,backendName:"webgl",kernelFunc:eGe},nGe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,rGe=en({opSnippet:nGe}),aGe={kernelName:kh,backendName:"webgl",kernelFunc:rGe},sGe=class{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[s,i,o,l]=e,[c]=t,[u,h]=n;this.outputShape=[c,u,h,l];let p=r==="bilinear"?1:0,[f,g]=[`${i-1}.0`,`${o-1}.0`],[m,y,x]=u>1?[`${(i-1)/(u-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[v,b,w]=h>1?[`${(o-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${s}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${b};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}},iGe=e=>{let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:s,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=r,u=new sGe(a.shape,s.shape,o,l,c);return n.runWebGLProgram(u,[a,s,i],"float32")},oGe={kernelName:og,backendName:"webgl",kernelFunc:iGe},fv;(function(e){e.Prod="*",e.Sum="+"})(fv||(fv={}));var I3=class{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let a=this.outputShape.length,s=this.op===fv.Prod?"1.0":"0.0",i=n?s:`getX(${E3(a,"coords",this.op)})`,o=this.outputShape[this.outputShape.length-1],l="",c="";n?(l=r?`end != ${o-1}`:"end != 0",c=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${o}`:"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${kn(a)} coords = getOutputCoords();
        int end = ${T3(a,"coords",this.op)};
        float val = ${i};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${c};
          ${T3(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${E3(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}};function E3(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function T3(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function ZX(e,t,n,r,a,s){let i=t.shape.length,o=P.getAxesPermutation([r],i),l=t;o!=null&&(l=_a({inputs:{x:t},backend:n,attrs:{perm:o}}));let c=P.getInnerMostAxes(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let u=l.shape[c],h=ks({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(u))-1;p++){let f=new I3(e,l.shape,!1,s),g=[[p]],m=h;h=n.runWebGLProgram(f,[h],h.dtype,g),n.disposeIntermediateTensorInfo(m)}if(a){let p=new I3(e,l.shape,a,s),f=h;h=n.runWebGLProgram(p,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(o!=null){let p=P.getUndoAxesPermutation(o),f=_a({inputs:{x:h},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}function lGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=r;return ZX(fv.Prod,a,n,s,i,o)}var uGe={kernelName:ig,backendName:"webgl",kernelFunc:lGe};function cGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=r;return ZX(fv.Sum,a,n,s,i,o)}var dGe={kernelName:Sh,backendName:"webgl",kernelFunc:cGe};function hGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:s}=t,{size:i,binaryOutput:o}=r;if(a.shape.length===1){let l=n.readSync(a.dataId),c=n.readSync(s.dataId),u=AX(l,c,s.dtype,s.shape,i);return n.makeTensorInfo([i],s.dtype,u)}else if(a.shape.length===2){let l=n.bufferSync(a),c=n.bufferSync(s),u=f5e(l,c,i,o);return n.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}var pGe={kernelName:Jv,backendName:"webgl",kernelFunc:hGe},fGe=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function mGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:s,dataFormat:i}=r,o=a.shape[0],l=i==="NHWC"?a.shape[1]:a.shape[2],c=i==="NHWC"?a.shape[2]:a.shape[3],u=i==="NHWC"?a.shape[3]:a.shape[1],h=l*s,p=c*s,f=u/(s*s),g=i==="NHWC"?[o,h,p,f]:[o,f,h,p],m=new fGe(g,s,i);return n.runWebGLProgram(m,[a],a.dtype)}var gGe={kernelName:lg,backendName:"webgl",kernelFunc:mGe},eY=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=la(this.outputShape.length);let s=e.filterHeight,i=e.filterWidth,o=e.outChannels/e.inChannels,l="",c="";n&&(r?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:l=`
          float activation(float x) {
            ${n}
          }
        `,c="result = activation(result);");let u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${s}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${i}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${u}
        ${c}
        setOutput(result);
      }
    `}},tY=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=la(this.outputShape.length);let s=e.outChannels/e.inChannels,i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h=u,p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<u;y++)p+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;p+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let y=0;y<u;y++)p+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(h+1)/2;y++){let x=y*2;if(p+=`
          xC = xCCorner + ${x*l};
          `,o===1){if(x<u&&(i%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,l===1&&x>0?p+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<u)){let v=i%2===0?j.nearestLargerEven(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,l>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:p+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):v===1?p+=`
                    xC${x+1} = xTexelC${x};
                    `:p+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<u&&(i%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<u&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<u&&(p+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<u&&(p+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<u&&(p+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let f="",g="";n&&(r?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:f=`vec4 activation(vec4 x) {
          ${n}
        }`,g="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}};function yGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=r,u=l;u==null&&(u=[1,1]),j.assert(P.eitherStridesOrDilationsAreOne(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);let h=P.computeConv2DInfo(a.shape,s.shape,i,u,o,c,!0),p;le().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?p=new tY(h):p=new eY(h);let f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(p,[a,s],"float32",f)}var xGe={kernelName:_h,backendName:"webgl",kernelFunc:yGe},vGe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${s} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},bGe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.top,i=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${o}; dm++) {
              int d2 = d1 * ${o} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function wGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r,h=P.computeConv2DInfo(a.shape,u,i,o,l,c,!0),p=new vGe(h);return n.runWebGLProgram(p,[a,s],"float32")}var NGe={kernelName:jk,backendName:"webgl",kernelFunc:wGe};function kGe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:s}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r,h=P.computeConv2DInfo(u,s.shape,i,o,l,c,!0),p=new bGe(h);return n.runWebGLProgram(p,[a,s],"float32")}var SGe={kernelName:Ak,backendName:"webgl",kernelFunc:kGe},_Ge=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function CGe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],s=j.sizeFromShape(r.shape),i=Re({inputs:{x:r},backend:n,attrs:{shape:[s]}}),o=new _Ge(s),l=n.runWebGLProgram(o,[i],i.dtype),c=Re({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}var IGe={kernelName:Zv,backendName:"webgl",kernelFunc:CGe},EGe=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:s,filterHeight:i,filterWidth:o,dilationHeight:l,dilationWidth:c}=e,{top:u,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${s});
      const ivec2 pads = ivec2(${u}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${i}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${o}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function TGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:l}=r,c=P.computeDilation2DInfo(a.shape,s.shape,i,o,"NHWC",l),u,h=new EGe(c);u=n.runWebGLProgram(h,[a,s],"float32");let p=Re({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),p}var jGe={kernelName:Ch,backendName:"webgl",kernelFunc:TGe};function AGe(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,s=t,{allDims:i,summedDims:o,idDims:l}=P.decodeEinsumEquation(a,s.length);P.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=P.getEinsumComputePath(o,l),h=u.length,p=null,f=i.length,g=[];for(let m=0;m<h;++m){for(let y of u[m]){let{permutationIndices:x,expandDims:v}=P.getEinsumPermutation(f,l[y]),b;P.isIdentityPermutation(x)?b=s[y]:(b=_a({inputs:{x:s[y]},backend:n,attrs:{perm:x}}),g.push(b));let w=b.shape.slice();for(let k=0;k<v.length;++k)w.splice(v[k],0,1);j.arraysEqual(b.shape,w)||(b=Re({inputs:{x:b},backend:n,attrs:{shape:w}}),g.push(b)),p===null?p=b:(p=sM({inputs:{a:b,b:p},backend:n}),g.push(p))}m<h-1&&(c[m]>=0&&(p=QS({inputs:{x:p},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),g.push(p)),f--)}for(let m of g)m!==p&&n.disposeIntermediateTensorInfo(m);return p}var $Ge={kernelName:Rk,backendName:"webgl",kernelFunc:AGe},RGe="return (x >= 0.0) ? x : (exp(x) - 1.0);",DGe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,MGe=en({opSnippet:RGe,packedOpSnippet:DGe}),OGe={kernelName:Eh,backendName:"webgl",kernelFunc:MGe},FGe="return (b >= 0.0) ? a : a * (b + 1.0);",PGe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,LGe=e=>{let{inputs:t,backend:n}=e,{dy:r,y:a}=t,s=le().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new py(PGe,r.shape,a.shape):new Qd(FGe,r.shape,a.shape);return n.runWebGLProgram(s,[r,a],r.dtype)},zGe={kernelName:ug,backendName:"webgl",kernelFunc:LGe},BGe=`
  return vec4(equal(a, b));
`,UGe="return float(a == b);",WGe=Yr({opSnippet:UGe,packedOpSnippet:BGe,dtype:"bool",cpuKernelImpl:v5e}),VGe={kernelName:cg,backendName:"webgl",kernelFunc:WGe},HGe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${P.ERF_P};
  float a1 = ${P.ERF_A1};
  float a2 = ${P.ERF_A2};
  float a3 = ${P.ERF_A3};
  float a4 = ${P.ERF_A4};
  float a5 = ${P.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,GGe=en({opSnippet:HGe}),qGe={kernelName:Th,backendName:"webgl",kernelFunc:GGe},KGe=fy+`
  return exp(x);
`,QGe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,nY=en({opSnippet:KGe,packedOpSnippet:QGe,cpuKernelImpl:b5e,dtype:"float32"}),XGe={kernelName:jh,backendName:"webgl",kernelFunc:nY};function DE(e){let{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:s}=t,i=s.shape.length,o=s.shape.slice(),l=a;return a<0&&(j.assert(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+a+1),o.splice(l,0,1),Re({inputs:{x:s},backend:r,attrs:{shape:o}})}var YGe={kernelName:dg,backendName:"webgl",kernelFunc:DE},j3="return exp(x) - 1.0;",JGe=en({opSnippet:j3,packedOpSnippet:j3,cpuKernelImpl:w5e}),ZGe={kernelName:Ah,backendName:"webgl",kernelFunc:JGe},A3=class{constructor(e,t,n){this.variableNames=["real","imag"];let r=t[1];this.outputShape=t;let a=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=n?`${r}.0`:"1.0",i;if(e==="real")i="return real * expR - imag * expI;";else if(e==="imag")i="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${i}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function rY(e,t,n){let r=n.texData.get(e.dataId),a=j.sizeFromShape(e.shape),s=e.shape[e.shape.length-1],i=a/s,o=Re({inputs:{x:e},backend:n,attrs:{shape:[i,s]}}),l=o.shape,c=new A3("real",l,t),u=new A3("imag",l,t),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),g=_c({inputs:{real:p,imag:f},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f);let m=Re({inputs:{x:g},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(g),m}function e8e(e){let{inputs:t,backend:n}=e,{input:r}=t;return rY(r,!1,n)}var t8e={kernelName:Dk,backendName:"webgl",kernelFunc:e8e},n8e=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function qb(e){let{backend:t,attrs:n}=e,{shape:r,value:a}=n,{dtype:s}=n;if(s=s||j.inferDtype(a),s==="string"){let i=j.getArrayFromDType(s,j.sizeFromShape(r));return i.fill(a),t.makeTensorInfo(r,s,i)}else{let i=new n8e(r,a),o=[[a]];return t.runWebGLProgram(i,[],s,o)}}var r8e={kernelName:eb,backendName:"webgl",kernelFunc:qb},a8e=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}},s8e={kernelName:hg,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=t,a=new a8e(n.shape);return r.runWebGLProgram(a,[n],n.dtype)}},$3="return floor(x);",i8e=en({opSnippet:$3,packedOpSnippet:$3,cpuKernelImpl:N5e}),o8e={kernelName:$h,backendName:"webgl",kernelFunc:i8e},l8e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,u8e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,c8e=Yr({opSnippet:l8e,packedOpSnippet:u8e,dtype:"int32"}),d8e={kernelName:Rh,backendName:"webgl",kernelFunc:c8e},h8e=class{constructor(e){this.variableNames=["A"];let t=ja(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}},p8e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=ja(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}},f8e={kernelName:D1,backendName:"webgl",kernelFunc:m8e},Xp,jC=le().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function m8e(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:a}=t,{numChannels:s}=r,i=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,c]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=[c,l],h=[c,l,s];if(o||i){let m=le().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Xp==null||m!==jC)&&(jC=m,Xp=document.createElement("canvas").getContext("2d",{willReadFrequently:jC})),Xp.canvas.width=l,Xp.canvas.height=c,Xp.drawImage(a,0,0,l,c),a=Xp.canvas}let p=n.makeTensorInfo(u,"int32");n.texData.get(p.dataId).usage=Rs.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);let f=le().getBool("WEBGL_PACK")?new p8e(h):new h8e(h),g=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),g}function g8e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r,m=P.convertConv2DDataFormat(u),y=P.computeConv2DInfo(a.shape,s.shape,l,h,c,p,!1,m),x,v=[],b=i!=null,w=o!=null,k=f==="leakyrelu",I=()=>{let S=[a,s],E=(T,$)=>{if($==="NCHW"&&T.shape.length===1&&T.shape[0]!==1){let _=Re({inputs:{x:T},backend:n,attrs:{shape:[T.shape[0],1,1]}});return v.push(_),_}return T};if(b&&S.push(E(i,u)),w&&S.push(E(o,u)),k){let T=n.makeTensorInfo([],"float32",j.createScalarValue(g,"float32"));S.push(T),v.push(T)}return S};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))x=YX({x:a,filter:s,convInfo:y,backend:n,bias:i,activation:f,preluActivationWeights:o,leakyreluAlpha:g});else if(y.strideWidth<=2&&m==="channelsLast"&&le().getBool("WEBGL_EXP_CONV")){let S=f?hv(f,!0):null,E=new XX(y,b,S,w,k),T=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],$=I();x=n.runWebGLProgram(E,$,"float32",T)}else if(le().getBool("WEBGL_CONV_IM2COL"))x=JX({x:a,filter:s,convInfo:y,backend:n,bias:i,activation:f,preluActivationWeights:o,leakyreluAlpha:g});else{let S=f?hv(f,!1):null,E=new QX(y,b,S,w,k),T=I();x=n.runWebGLProgram(E,T,"float32")}let C=Re({inputs:{x},backend:n,attrs:{shape:y.outShape}});return v.push(x),v.forEach(S=>n.disposeIntermediateTensorInfo(S)),C}var y8e={kernelName:Rd,backendName:"webgl",kernelFunc:g8e};function x8e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,g=[],m=u;m==null&&(m=[1,1]),j.assert(P.eitherStridesOrDilationsAreOne(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);let y=P.computeConv2DInfo(a.shape,s.shape,l,m,c,h,!0),x=le().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,v=p?hv(p,x):null,b=[a,s],w=i!=null,k=o!=null,I=p==="leakyrelu";if(w&&b.push(i),k&&b.push(o),I){let T=n.makeTensorInfo([],"float32",j.createScalarValue(f,"float32"));b.push(T),g.push(T)}let C;x?C=new tY(y,w,v,k,I):C=new eY(y,w,v,k,I);let S=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],E=n.runWebGLProgram(C,b,"float32",S);return g.forEach(T=>n.disposeIntermediateTensorInfo(T)),E}var v8e={kernelName:Dd,backendName:"webgl",kernelFunc:x8e},b8e=class{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;let a=kn(n.length),s=`
    int index;`;for(let i=0;i<this.sliceDim;i++)s+=`
          index = round(getIndices(coords[0], ${i}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[i]};
          flattenIndex += index * ${this.strides[i]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${s}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function w8e(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,s=a.shape,i=s[s.length-1],o=j.sizeFromShape(r.shape),[l,c,u,h]=P.prepareAndValidate(r,a),p=Re({inputs:{x:a},backend:n,attrs:{shape:[c,i]}}),f=Re({inputs:{x:r},backend:n,attrs:{shape:[j.sizeFromShape(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){let x=n.readSync(a.dataId),v=n.bufferSync(r),b=k5e(x,v,r.dtype,c,i,u,h,r.shape,o);return n.makeTensorInfo(l,r.dtype,b.values)}let g=new b8e(i,h,[c,u],r.shape),m=n.runWebGLProgram(g,[f,p],f.dtype),y=Re({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}var N8e={kernelName:fg,backendName:"webgl",kernelFunc:w8e},k8e=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=kn(this.rank),r=S8e(e);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}};function S8e(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<e.length;a++)a===2?r.push("index"):r.push(`${n[a]}`);return r.join()}function aY(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:s}=t,{axis:i,batchDims:o}=r,l=j.parseAxisParam(i,a.shape)[0];if(le().get("DEBUG")){let v=n.readSync(s.dataId),b=a.shape[l];for(let w=0;w<v.length;++w){let k=v[w];j.assert(k<=b-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${b-1}]`)}}let c=P.segment_util.collectGatherOpShapeInfo(a,s,l,o),u=j.sizeFromShape(s.shape),h=[],p=Re({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=Re({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(p),h.push(f);let g=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,s])||a.dtype==="string"){let v=n.bufferSync(f),b=n.bufferSync(p),w=S5e(b,v,g);return h.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.makeTensorInfo(c.outputShape,w.dtype,w.values)}let m=new k8e(p.shape,g),y=n.runWebGLProgram(m,[p,f],p.dtype);h.push(y);let x=Re({inputs:{x:y},backend:n,attrs:{shape:c.outputShape}});return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),x}var _8e={kernelName:pg,backendName:"webgl",kernelFunc:aY},C8e="return float(a > b);",I8e=`
  return vec4(greaterThan(a, b));
`,E8e=Yr({opSnippet:C8e,packedOpSnippet:I8e,cpuKernelImpl:_5e,dtype:"bool"}),T8e={kernelName:mg,backendName:"webgl",kernelFunc:E8e},j8e="return float(a >= b);",A8e=`
  return vec4(greaterThanEqual(a, b));
`,$8e=Yr({opSnippet:j8e,packedOpSnippet:A8e,dtype:"bool",cpuKernelImpl:C5e}),R8e={kernelName:Mh,backendName:"webgl",kernelFunc:$8e};function D8e(e){let{inputs:t,backend:n}=e,{input:r}=t;return rY(r,!0,n)}var M8e={kernelName:Mk,backendName:"webgl",kernelFunc:D8e},O8e="return float(!isnan(x) && !isinf(x));",F8e=en({opSnippet:O8e,dtype:"bool"}),P8e={kernelName:Fh,backendName:"webgl",kernelFunc:F8e},L8e="return float(isinf(x));",z8e=en({opSnippet:L8e,dtype:"bool"}),B8e={kernelName:Ph,backendName:"webgl",kernelFunc:z8e},U8e="return float(isnan(x));",W8e=en({opSnippet:U8e,dtype:"bool"}),V8e={kernelName:Lh,backendName:"webgl",kernelFunc:W8e},H8e="return float(a < b);",G8e=`
  return vec4(lessThan(a, b));
`,q8e=Yr({opSnippet:H8e,packedOpSnippet:G8e,cpuKernelImpl:I5e,dtype:"bool"}),K8e={kernelName:gg,backendName:"webgl",kernelFunc:q8e},Q8e="return float(a <= b);",X8e=`
  return vec4(lessThanEqual(a, b));
`,Y8e=Yr({opSnippet:Q8e,packedOpSnippet:X8e,cpuKernelImpl:E5e,dtype:"bool"}),J8e={kernelName:yg,backendName:"webgl",kernelFunc:Y8e};function Z8e(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:s}=n,i=T5e(r,a,s);return t.makeTensorInfo([i.length],"float32",i)}var eqe={kernelName:xg,backendName:"webgl",kernelFunc:Z8e},tqe=fy+`
  return x < 0.0 ? 0./0. : log(x);
`,nqe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,rqe=en({opSnippet:tqe,packedOpSnippet:nqe,cpuKernelImpl:j5e}),aqe={kernelName:Bh,backendName:"webgl",kernelFunc:rqe},sqe=fy+`
  return log(1.0 + x);
`,iqe=en({opSnippet:sqe}),oqe={kernelName:Uh,backendName:"webgl",kernelFunc:iqe},lqe="return float(a >= 1.0 && b >= 1.0);",uqe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,cqe=Yr({opSnippet:lqe,packedOpSnippet:uqe,dtype:"bool"}),dqe={kernelName:vg,backendName:"webgl",kernelFunc:cqe},hqe="return float(!(x >= 1.0));",pqe=en({opSnippet:hqe}),fqe={kernelName:bg,backendName:"webgl",kernelFunc:pqe},mqe="return float(a >= 1.0 || b >= 1.0);",gqe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,yqe=Yr({opSnippet:mqe,packedOpSnippet:gqe,dtype:"bool"}),xqe={kernelName:wg,backendName:"webgl",kernelFunc:yqe},vqe=class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];let s=t,i=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;a===.5?o=`inversesqrt(${l})`:a===1?o=`1.0/(${l})`:o=`exp(log(${l}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${s}; j <= ${s}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${i}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${o};
        setOutput(val);
      }
    `}},bqe=class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let s=t,i=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;a===.5?o=`inversesqrt(${l})`:a===1?o=`1.0/(${l})`:o=`exp(log(${l}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${s};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${s}; j <= ${s}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${i}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${o};
        setOutput(result);
      }
    `}},wqe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:s,bias:i,alpha:o,beta:l}=r,c=le().getBool("WEBGL_PACK_NORMALIZATION")?new bqe(a.shape,s,i,o,l):new vqe(a.shape,s,i,o,l);return n.runWebGLProgram(c,[a],a.dtype)},Nqe={kernelName:Wh,backendName:"webgl",kernelFunc:wqe},kqe=class{constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}},Sqe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a,y:s,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r,h=new kqe(a.shape,o,l,c,u);return n.runWebGLProgram(h,[a,s,i],a.dtype)},_qe={kernelName:Ng,backendName:"webgl",kernelFunc:Sqe};function Cqe(e,t,n,r){let a=j.sizeFromShape(t),s=j.sizeFromShape(e.shape)/a,i=Re({inputs:{x:e},attrs:{shape:[s,a]},backend:r}),o=Mp(i,e.dtype,"max",r),l=Re({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),l}function sY(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:s,keepDims:i}=r,o=a.shape.length,l=j.parseAxisParam(s,a.shape),c=l,u=P.getAxesPermutation(c,o),h=u!=null,p=n.shouldExecuteOnCPU([a]),f=a;if(h){if(p){let v=n.texData.get(f.dataId).values,b=new Array(o);for(let I=0;I<b.length;I++)b[I]=a.shape[u[I]];let w=nM(v,a.shape,a.dtype,u,b);f=n.makeTensorInfo(b,a.dtype);let k=n.texData.get(f.dataId);k.values=w}else f=KS(a,u,n);c=P.getInnerMostAxes(c.length,o)}P.assertAxesAreInnerMostDims("max",c,o);let[g,m]=P.computeOutAndReduceShapes(f.shape,c),y=g;i&&(y=P.expandShapeToKeepDim(g,l));let x;if(p){let v=n.texData.get(f.dataId).values,b=A5e(v,j.sizeFromShape(m),y,a.dtype);x=n.makeTensorInfo(y,a.dtype);let w=n.texData.get(x.dataId);w.values=b}else x=Cqe(f,m,y,n);return h&&n.disposeIntermediateTensorInfo(f),x}var Iqe={kernelName:Vh,backendName:"webgl",kernelFunc:sY},Eqe=aM+`
  return max(a, b);
`,Tqe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Dp+`
  return result;
`,jqe=Yr({opSnippet:Eqe,packedOpSnippet:Tqe,cpuKernelImpl:$5e}),Aqe={kernelName:Hh,backendName:"webgl",kernelFunc:jqe};function $qe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;ly(a,"maxPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:l}=r,c=1;j.assert(P.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=P.computePool2DInfo(a.shape,s,i,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&j.arraysEqual(u.inShape,u.outShape))return ks({inputs:{x:a},backend:n});let h=new pv(u,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}var Rqe={kernelName:Gh,backendName:"webgl",kernelFunc:$qe};function Dqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],h=P.computePool3DInfo(a.shape,s,i,u,o,c,l),p=new iM(h,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}var Mqe={kernelName:kg,backendName:"webgl",kernelFunc:Dqe},Oqe=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,s=e.effectiveFilterWidth,i=a-1-e.padInfo.top,o=s-1-e.padInfo.left,l=a*s-1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${s} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},Fqe=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=o-1-e.padInfo.front,h=l-1-e.padInfo.top,p=c-1-e.padInfo.left,f=o*l*c-1;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${h}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${o};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${s}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${i}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Pqe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,i=s,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,h=[1,1,1],p=P.computePool3DInfo(i.shape,o,l,h,c,u),f=new iM(p,"max",!0),g=n.runWebGLProgram(f,[i],i.dtype),m=new Fqe(p),y=n.runWebGLProgram(m,[a,g],i.dtype);return n.disposeIntermediateTensorInfo(g),y}var Lqe={kernelName:nb,backendName:"webgl",kernelFunc:Pqe};function zqe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s,output:i}=t,o=s;ly([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=r,p=P.computePool2DInfo(o.shape,l,c,1,u,h),f=!0,g=new pv(p,"max",f),m=n.runWebGLProgram(g,[o],o.dtype),y=new Oqe(p),x=n.runWebGLProgram(y,[a,m],o.dtype);return n.disposeIntermediateTensorInfo(m),x}var Bqe={kernelName:tb,backendName:"webgl",kernelFunc:zqe};function Uqe(e,t,n,r){let a=new pv(n,"max",!1),s=r.runWebGLProgram(a,[e],"float32");a=new pv(n,"max",!0,!0,t);let i=r.runWebGLProgram(a,[e],"float32");return[s,i]}var Wqe={kernelName:rb,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:s,pad:i,includeBatchInIndex:o}=t,l=n;j.assert(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let c=[1,1];j.assert(P.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=P.computePool2DInfo(r.shape,a,s,c,i),[h,p]=Uqe(r,o,u,l);return[h,p]}};function Vqe(e,t,n,r){let a=j.sizeFromShape(t),s=j.sizeFromShape(e.shape)/a,i=Re({inputs:{x:e},attrs:{shape:[s,a]},backend:r}),o=Mp(i,"float32","mean",r),l=Re({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),l}var Hqe={kernelName:qh,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:a,axis:s}=t,i=n,o=r.shape.length,l=j.parseAxisParam(s,r.shape),c=l,u=P.getAxesPermutation(c,o),h=u!=null,p=i.shouldExecuteOnCPU([r]),f=[],g=r;if(h){if(p){let b=i.texData.get(g.dataId).values,w=new Array(o);for(let C=0;C<w.length;C++)w[C]=r.shape[u[C]];let k=nM(b,r.shape,r.dtype,u,w);g=i.makeTensorInfo(w,r.dtype);let I=i.texData.get(g.dataId);I.values=k}else g=KS(r,u,i);f.push(g),c=P.getInnerMostAxes(c.length,o)}P.assertAxesAreInnerMostDims("sum",c,o);let[m,y]=P.computeOutAndReduceShapes(g.shape,c),x=m;a&&(x=P.expandShapeToKeepDim(m,l));let v=Vqe(g,y,x,i);for(let b of f)i.disposeIntermediateTensorInfo(b);return v}};function Gqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r,o=a.shape.length,l=j.parseAxisParam(s,a.shape),c=l,u=P.getAxesPermutation(c,o),h=a;u!=null&&(h=_a({inputs:{x:a},backend:n,attrs:{perm:u}}),c=P.getInnerMostAxes(c.length,a.shape.length)),P.assertAxesAreInnerMostDims("min",c,o);let[p,f]=P.computeOutAndReduceShapes(h.shape,c),g=j.sizeFromShape(f),m=Re({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),y=Mp(m,m.dtype,"min",n),x;if(i){let v=P.expandShapeToKeepDim(p,l);x=Re({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=Re({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(h),x}var qqe={kernelName:Kh,backendName:"webgl",kernelFunc:Gqe},Kqe=aM+`
  return min(a, b);
`,Qqe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Dp+`
  return result;
`,Xqe=Yr({opSnippet:Kqe,packedOpSnippet:Qqe,cpuKernelImpl:R5e}),Yqe={kernelName:Qh,backendName:"webgl",kernelFunc:Xqe},Jqe=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((c,u)=>c[0]+e[u]+c[1]);let r=e.length,a=kn(r),s=t.map(c=>c[0]).join(","),i=t.map((c,u)=>c[0]+e[u]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l=n==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${s};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${i});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${o}));
      }
    `}},Zqe=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((f,g)=>f[0]+e[g]+f[1]);let r=e.length,a=kn(r),s=t.map(f=>f[0]).join(","),i=t.map((f,g)=>f[0]+e[g]).join(","),o=xa("rc",r),l=xa("source",r),c=`${o[r-1]} < ${this.outputShape[r-1]}`,u=r===1?"source":`vec2(${l.slice(-2).join()})`,h=n==="reflect"?0:1,p="";if(r===1){let f=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${l.join()}), ${u});
        ${o[r-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${l.join()}), ${u});
        }
      `}else{let f=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${l.join()}), ${u});
        ${o[r-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${l.join()}), ${u});
        }
        rc = outputLoc;
        ${o[r-2]} += 1;
        if(${o[r-2]} < ${this.outputShape[r-2]}) {
          ${f}
          result[2] = getChannel(getX(${l.join()}), ${u});
          ${o[r-1]} += 1;
          if(${c}) {
            ${f}
            result[3] = getChannel(getX(${l.join()}), ${u});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${i});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}},e7e=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:a,mode:s}=n,i=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Zqe(r.shape,a,s):new Jqe(r.shape,a,s);return t.runWebGLProgram(i,[r],r.dtype)},t7e={kernelName:Xh,backendName:"webgl",kernelFunc:e7e},n7e=`if (b == 0.0) return NAN;
  return mod(a, b);`,r7e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Dp+`
  return result;
`,a7e=Yr({opSnippet:n7e,packedOpSnippet:r7e}),s7e={kernelName:Yh,backendName:"webgl",kernelFunc:a7e},i7e=class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}},o7e=`
if (a == b) {
  return 1.0;
};
return a / b;`,l7e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,iY=Yr({opSnippet:o7e,packedOpSnippet:l7e,checkOutOfBounds:!0}),u7e={kernelName:Ih,backendName:"webgl",kernelFunc:iY},R3="return a - b;",oY=Yr({opSnippet:R3,packedOpSnippet:R3,supportsComplex:!0,cpuKernelImpl:e6e}),c7e={kernelName:Np,backendName:"webgl",kernelFunc:oY};function lY(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:s}=r,i=j.parseAxisParam([s],a.shape),o=sY({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=P.expandShapeToKeepDim(o.shape,i),c=Re({inputs:{x:o},backend:n,attrs:{shape:l}}),u=oY({inputs:{a,b:c},backend:n}),h=nY({inputs:{x:u},backend:n}),p=QS({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:!1}}),f=Re({inputs:{x:p},backend:n,attrs:{shape:l}}),g=iY({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),g}var d7e={kernelName:bp,backendName:"webgl",kernelFunc:lY};function h7e(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:s,seed:i,normalized:o}=r,l=o?a:lY({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new i7e(c,u,s),p=[[i]],f=n.runWebGLProgram(h,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),f}var p7e={kernelName:Sg,backendName:"webgl",kernelFunc:h7e},f7e=fi+`
  return -x;
`,m7e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function g7e(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){let s=n.texData.get(r.dataId),[i,o]=M5e(s.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}let a;return le().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new vu(r.shape,m7e):a=new xo(r.shape,f7e),n.runWebGLProgram(a,[r],r.dtype)}var y7e={kernelName:_g,backendName:"webgl",kernelFunc:g7e},x7e=Bo.nonMaxSuppressionV3Impl;function v7e(e){P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=r,c=n.readSync(a.dataId),u=n.readSync(s.dataId),{selectedIndices:h}=x7e(c,u,i,o,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}var b7e={kernelName:Ig,backendName:"webgl",kernelFunc:v7e},w7e=Bo.nonMaxSuppressionV4Impl;function N7e(e){P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(a.dataId),h=n.readSync(s.dataId),{selectedIndices:p,validOutputs:f}=w7e(u,h,i,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}var k7e={kernelName:Eg,backendName:"webgl",kernelFunc:N7e},S7e=Bo.nonMaxSuppressionV5Impl;function _7e(e){P.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(a.dataId),h=n.readSync(s.dataId),p=i,f=o,g=l,m=c,{selectedIndices:y,selectedScores:x}=S7e(u,h,p,f,g,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}var C7e={kernelName:Tg,backendName:"webgl",kernelFunc:_7e},I7e=class{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${n}),
                      float(index == coords.y)));
      }
    `}},E7e=e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:s,depth:i,onValue:o,offValue:l}=r,c=j.sizeFromShape(a.shape),u=new I7e(c,i,o,l),h=Re({inputs:{x:a},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(u,[h],s);n.disposeIntermediateTensorInfo(h);let f=[...a.shape,i],g=Re({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(p),g},T7e={kernelName:Zh,backendName:"webgl",kernelFunc:E7e};function rN(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){let a=Gb({inputs:{input:r},backend:n}),s=rN({inputs:{x:a},backend:n}),i=XS({inputs:{input:r},backend:n}),o=rN({inputs:{x:i},backend:n}),l=_c({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return qb({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}var j7e={kernelName:Kg,backendName:"webgl",kernelFunc:rN};function uY(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let a=Gb({inputs:{input:r},backend:n}),s=uY({inputs:{x:a},backend:n}),i=XS({inputs:{input:r},backend:n}),o=rN({inputs:{x:i},backend:n}),l=_c({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return qb({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}var A7e={kernelName:jg,backendName:"webgl",kernelFunc:uY};function $7e(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return DE({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let s=t[0].shape,i=t[0].dtype;t.forEach(u=>{j.assertShapesMatch(s,u.shape,"All tensors passed to stack must have matching shapes"),j.assert(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let h=DE({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(h),h}),c=KX({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}var R7e={kernelName:Ag,backendName:"webgl",kernelFunc:$7e},D7e=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((l,c)=>l[0]+e[c]+l[1]);let r=e.length,a=kn(r),s=t.map(l=>l[0]).join(","),i=t.map((l,c)=>l[0]+e[c]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${s};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${i});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${o}));
        }
      }
    `}},M7e=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((g,m)=>g[0]+e[m]+g[1]);let r=e.length,a=kn(r),s=t.map(g=>g[0]).join(","),i=t.map((g,m)=>g[0]+e[m]).join(","),o=xa("rc",r),l=xa("source",r),c=`${o[r-1]} < ${this.outputShape[r-1]}`,u=r===1?"source":`vec2(${l.slice(-2).join()})`,h=[`${a} rc = outputLoc;`,`${o[r-1]} += 1;
       if(${c}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${o[r-2]} += 1;
       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${o[r-1]} += 1;
         if(${c}) {`],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="";for(let g=0,m=r===1?2:4;g<m;g++)f+=`
        ${h[g]}
        if (${p}) {
          result[${g}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${g}] = getChannel(getX(${l.join()}), ${u});
        }
      `;f+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${i});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}},cY=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:s,constantValue:i}=r;if(j.sizeFromShape(a.shape)===0){let c=s.map((u,h)=>u[0]+a.shape[h]+u[1]);return qb({backend:n,attrs:{shape:c,value:i,dtype:a.dtype}})}let o=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new M7e(a.shape,s,i):new D7e(a.shape,s,i),l=[[i]];return n.runWebGLProgram(o,[a],a.dtype,l)},O7e={kernelName:ep,backendName:"webgl",kernelFunc:cY},F7e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,P7e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Dp+`
  return result;
`,L7e=Yr({opSnippet:F7e,packedOpSnippet:P7e}),z7e={kernelName:tp,backendName:"webgl",kernelFunc:L7e};function B7e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,keepDims:i}=r,o=a.shape.length,l=[],c=j.parseAxisParam(s,a.shape),u=c,h=P.getAxesPermutation(u,o),p=a;h!=null&&(p=_a({inputs:{x:a},backend:n,attrs:{perm:h}}),u=P.getInnerMostAxes(u.length,o),l.push(p)),P.assertAxesAreInnerMostDims("prod",u,o);let f;if(n.shouldExecuteOnCPU([p])){let g=n.texData.get(p.dataId).values,{outVals:m,outShape:y,outDtype:x}=F5e(p.shape,p.dtype,g,u);f=n.makeTensorInfo(y,x,m)}else{let[g,m]=P.computeOutAndReduceShapes(p.shape,u),y=j.sizeFromShape(m),x=Re({inputs:{x:p},backend:n,attrs:{shape:[-1,y]}}),v=Uk(a.dtype),b=Mp(x,v,"prod",n);f=Re({inputs:{x:b},backend:n,attrs:{shape:g}}),l.push(x),l.push(b)}if(i){l.push(f);let g=P.expandShapeToKeepDim(f.shape,c);f=Re({inputs:{x:f},backend:n,attrs:{shape:g}})}return l.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}var U7e={kernelName:rp,backendName:"webgl",kernelFunc:B7e};function W7e(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:s,indices:i}=t,{outputRaggedRank:o}=r,l=a.map(x=>n.readSync(x.dataId)),c=a.map(x=>x.shape),u=n.readSync(s.dataId),h=n.readSync(i.dataId),[p,f,g]=P5e(l,c,u,s.shape,s.dtype,h,i.shape,o),m=p.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(g,s.dtype,f);return m.concat([y])}var V7e={kernelName:Fk,backendName:"webgl",kernelFunc:W7e};function H7e(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:s}=t,i=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(s.dataId),[c,u]=L5e(i,r.shape,r.dtype,o,a.shape,l,s.shape),h=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([u.length],r.dtype,u);return[h,p]}var G7e={kernelName:Pk,backendName:"webgl",kernelFunc:H7e};function q7e(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:s,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.readSync(a.dataId),u=n.readSync(s.dataId),h=n.readSync(i.dataId),p=o.map(y=>n.readSync(y.dataId)),f=o.map(y=>y.shape),[g,m]=z5e(c,a.shape,u,s.shape,s.dtype,h,i.shape,p,f,l);return n.makeTensorInfo(g,s.dtype,m)}var K7e={kernelName:Lk,backendName:"webgl",kernelFunc:q7e},dY=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:s,dtype:i}=n,o=B5e(r,a,s,i);return t.makeTensorInfo([o.length],i,o)},Q7e={kernelName:ab,backendName:"webgl",kernelFunc:dY},X7e="return 1.0 / x;",Y7e=en({opSnippet:X7e}),J7e={kernelName:ap,backendName:"webgl",kernelFunc:Y7e},Z7e=fi+`
  return (x < 0.0) ? 0.0 : x;
`,eKe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,tKe=en({opSnippet:Z7e,packedOpSnippet:eKe}),nKe={kernelName:sp,backendName:"webgl",kernelFunc:tKe},rKe=fi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,aKe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sKe=en({opSnippet:rKe,packedOpSnippet:aKe}),iKe={kernelName:lp,backendName:"webgl",kernelFunc:sKe},oKe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c=[r&&t>1?i-1:i,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],h;a?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/u[0]},
          ${c[1]/u[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}},lKe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c=[r&&t>1?i-1:i,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],h;a?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/u[0]},
          ${c[1]/u[1]},
          ${c[1]/u[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function uKe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=r,[l,c]=o,u=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new lKe(a.shape,l,c,s,i):new oKe(a.shape,l,c,s,i);return n.runWebGLProgram(u,[a],"float32")}var cKe={kernelName:op,backendName:"webgl",kernelFunc:uKe},dKe=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,s,i]=e,o=[n&&s>1?r-1:r,n&&i>1?a-1:a],l=[n&&s>1?s-1:s,n&&i>1?i-1:i],c=o[0]/l[0],u=o[1]/l[1],h=1/c,p=1/u,f=Math.ceil(h)*2+2,g=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${u});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function hKe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:s}=t,{alignCorners:i}=r,o=new dKe(s.shape,a.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}var pKe={kernelName:Dg,backendName:"webgl",kernelFunc:hKe},fKe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c=[r&&t>1?i-1:i,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=r?"0.5":"0.0",p;a?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/u[0]},
          ${c[1]/u[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}},mKe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,i,o,l]=e;this.outputShape=[s,t,n,l];let c=[r&&t>1?i-1:i,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=r?"0.5":"0.0",p;a?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/u[0]},
          ${c[1]/u[1]},
          ${c[1]/u[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function gKe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=r,[l,c]=o,u=le().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new mKe(a.shape,l,c,s,i):new fKe(a.shape,l,c,s,i);return n.runWebGLProgram(u,[a],a.dtype)}var yKe={kernelName:ip,backendName:"webgl",kernelFunc:gKe},xKe=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,s,i]=e,o=[n&&s>1?r-1:r,n&&i>1?a-1:a],l=[n&&s>1?s-1:s,n&&i>1?i-1:i],c=o[0]/l[0],u=o[1]/l[1],h=1/c,p=1/u,f=Math.ceil(h)*2+2,g=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${u});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float sourceFracRow =
              float(${o[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${o[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function vKe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:s}=t,{alignCorners:i}=r,o=new xKe(s.shape,a.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}var bKe={kernelName:Rg,backendName:"webgl",kernelFunc:vKe},wKe=class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,n===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let r=i=>t.indexOf(i)!==-1&&e[i]!==1?`${e[i]} - coords[${i}] - 1`:`coords[${i}]`,a=e.map((i,o)=>r(o)).join(","),s=kn(n);this.userCode=`
      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}},NKe=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;let r=xa("rc",n),a=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,s=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,i=kn(n);n===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${i} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${o(r.slice())};
          if(${a}){
            result.g = ${l(r.slice())};
          }
          if(${s}) {
            result.b = ${c(r.slice())};
            if(${a}) {
              result.a = ${u(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function o(f){return h(f)}function l(f){return f[n-1]="("+f[n-1]+" + 1)",h(f)}function c(f){return f[n-2]="("+f[n-2]+" + 1)",h(f)}function u(f){return f[n-1]="("+f[n-1]+" + 1)",f[n-2]="("+f[n-2]+" + 1)",h(f)}function h(f){let g=e.map((x,v)=>p(v,f)),m=g.join(","),y=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${y}))`}function p(f,g){return t.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${g[f]} - 1`:`${g[f]}`}}};function kKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:s}=r,i=a.shape.length,o=j.parseAxisParam(s,a.shape);if(i===0)return ks({inputs:{x:a},backend:n});let l=le().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new NKe(a.shape,o):new wKe(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}var SKe={kernelName:up,backendName:"webgl",kernelFunc:kKe},_Ke=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],r=e[2];this.outputShape=e;let a="";typeof t=="number"?a=`float outputValue = ${t.toFixed(2)};`:a=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}},CKe={kernelName:Qg,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:s,center:i}=t,o=n,l=new _Ke(r.shape,s),[c,u]=P.getImageCenter(i,r.shape[1],r.shape[2]),h=[[c,u,Math.sin(a),Math.cos(a)]];return o.runWebGLProgram(l,[r],r.dtype,h)}},IKe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,EKe=en({opSnippet:IKe}),TKe={kernelName:cp,backendName:"webgl",kernelFunc:EKe},jKe="return inversesqrt(x);",AKe=en({opSnippet:jKe,cpuKernelImpl:U5e}),$Ke={kernelName:dp,backendName:"webgl",kernelFunc:AKe},oM=class{constructor(e,t,n,r,a,s,i=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;let l=kn(a.length),c=kn(s.length),u="";n===1?u="i":n===2&&(u="i, j");let h=`getIndices(${u})`,p="";r===1?p="i":r===2&&(p="i, coords[1]");let f=`getUpdates(${p})`,g="";o&&(g="coords[0], coords[1]");let m=`getDefaultValue(${g})`,y=t>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${a});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}},RKe=class{constructor(e,t,n,r,a,s,i=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;let l=kn(a.length),c=kn(s.length),u="";n===1?u="i":n===2&&(u="i, j");let h=`getIndices(${u})`,p="";r===1?p="i":r===2&&(p="i, coords[1]");let f=`getUpdates(${p})`,g="";o&&(g="coords[0], coords[1]");let m=`getDefaultValue(${g})`,y=t>1?"strides[j]":"strides",x=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${a});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}};function DKe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:s}=t,{shape:i}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=P.calculateShapes(s,a,i),p=[h/c,c];if(h===0)return n.makeTensorInfo(i,a.dtype);let f=Re({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),g=Re({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),y;le().getBool("WEBGL_PACK")?y=new RKe(l,o,f.shape.length,g.shape.length,u,p):y=new oM(l,o,f.shape.length,g.shape.length,u,p);let x=n.runWebGLProgram(y,[g,f,m],g.dtype),v=Re({inputs:{x},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(m),v}var MKe={kernelName:Mg,backendName:"webgl",kernelFunc:DKe},OKe=class{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let a="while (left < right) {",s=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,i=le().getNumber("WEBGL_VERSION")===2?a:s,o=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${o} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function FKe(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:s}=t,{side:i}=r,o=new OKe(a.shape[0],a.shape[1],s.shape[1],i),l=[[a.shape[1]]];return n.runWebGLProgram(o,[a,s],"int32",l)}var PKe={kernelName:Fg,backendName:"webgl",kernelFunc:FKe},LKe=class{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let r,a;if(n>4)throw Error(`Where for rank ${n} is not yet supported`);if(n===1)a="resRC",r="resRC";else{let i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],l=[];for(let c=0;c<t.length;c++)l.push(`${i[c]}`),c<e&&o.push(`${i[c]}`);r=o.join(),a=l.join()}let s=kn(n);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}};function zKe(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:s}=t,i=new LKe(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(i,[r,a,s],Bs(a.dtype,s.dtype))}var BKe={kernelName:Pg,backendName:"webgl",kernelFunc:zKe},UKe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${P.SELU_SCALEALPHA};
  float scale = ${P.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,WKe=en({opSnippet:UKe}),VKe={kernelName:hp,backendName:"webgl",kernelFunc:WKe},HKe=fy+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,GKe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qKe=en({opSnippet:HKe,packedOpSnippet:GKe,cpuKernelImpl:V5e}),KKe={kernelName:gp,backendName:"webgl",kernelFunc:qKe},QKe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,XKe=en({opSnippet:QKe}),YKe={kernelName:mp,backendName:"webgl",kernelFunc:XKe},JKe=fy+`
  return sin(x);
`,ZKe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Dp}
  return result;
`,e9e=en({opSnippet:JKe,packedOpSnippet:ZKe}),t9e={kernelName:pp,backendName:"webgl",kernelFunc:e9e},n9e=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,r9e=en({opSnippet:n9e}),a9e={kernelName:fp,backendName:"webgl",kernelFunc:r9e},s9e=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,i9e=en({opSnippet:s9e}),o9e={kernelName:yp,backendName:"webgl",kernelFunc:i9e},l9e=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,paddings:i}=r;j.assert(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=s.reduce((x,v)=>x*v),l=[[0,0]];l.push(...i);for(let x=1+s.length;x<a.shape.length;++x)l.push([0,0]);let c=[],u=cY({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),h=P.getReshaped(u.shape,s,o,!1),p=P.getPermuted(h.length,s.length,!1),f=P.getReshapedPermuted(u.shape,s,o,!1),g=Re({inputs:{x:u},backend:n,attrs:{shape:h}}),m=_a({inputs:{x:g},backend:n,attrs:{perm:p}}),y=Re({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(g),c.push(m),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),y},u9e={kernelName:zg,backendName:"webgl",kernelFunc:l9e};function c9e(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:s,defaultValue:i}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let o=n.readSync(r.dataId),l=n.readSync(a.dataId),c=n.readSync(s.dataId),u=n.readSync(i.dataId)[0],[h,p,f,g,m]=G5e(o,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(p,r.dtype,h),n.makeTensorInfo([p[0]],a.dtype,f),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(y=>Number(y)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var d9e={kernelName:sb,backendName:"webgl",kernelFunc:c9e};function h9e(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(n.readSync(a.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(s.dataId)),[c,u,h]=q5e(o,r.shape,r.dtype,i,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([h.length],s.dtype,new Int32Array(h))]}var p9e={kernelName:Ug,backendName:"webgl",kernelFunc:h9e};function f9e(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);let i=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(s.dataId),[c,u]=RX(i,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}var m9e={kernelName:ib,backendName:"webgl",kernelFunc:f9e};function g9e(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);let i=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(s.dataId),[c,u]=RX(i,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}var y9e={kernelName:ob,backendName:"webgl",kernelFunc:g9e};function x9e(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:s,defaultValue:i}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:p}=P.calculateShapes(s,a,o),f=!1;if(s.dtype==="string"){let x=n.bufferSync(a),v=n.bufferSync(s),b=j.decodeString(n.readSync(i.dataId)[0]),w=W5e(x,v,o,p,u,c,l,h,b,f);return n.makeTensorInfo(o,w.dtype,w.values)}let g=new oM(c,l,a.shape.length,s.shape.length,h,[p,1],f),m=n.runWebGLProgram(g,[s,a,i],s.dtype),y=Re({inputs:{x:m},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),y}var v9e={kernelName:Wg,backendName:"webgl",kernelFunc:x9e};function b9e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:s,axis:i}=r,o=j.parseAxisParam(i,a.shape)[0],l=P.prepareSplitSize(a,s,o),c=a.shape.length,u=new Array(c).fill(0),h=a.shape.slice();return l.map(p=>{let f=[...h];f[o]=p;let g=my({inputs:{x:a},backend:n,attrs:{begin:u,size:f}});return u[o]+=p,g})}var w9e={kernelName:Bg,backendName:"webgl",kernelFunc:b9e},D3="return sqrt(x);",N9e=en({opSnippet:D3,packedOpSnippet:D3,cpuKernelImpl:K5e}),k9e={kernelName:xp,backendName:"webgl",kernelFunc:N9e},S9e="return x * x;",_9e=en({opSnippet:S9e}),C9e={kernelName:lb,backendName:"webgl",kernelFunc:_9e},M3="return (a - b) * (a - b);",I9e=Yr({opSnippet:M3,packedOpSnippet:M3}),E9e={kernelName:wp,backendName:"webgl",kernelFunc:I9e};function T9e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");let s=n.readSync(a.dataId),i=P.fromUint8ToStringArray(s),o=Q5e(i,"string",r);return n.makeTensorInfo(a.shape,"string",o)}var j9e={kernelName:ub,backendName:"webgl",kernelFunc:T9e};function A9e({inputs:e,attrs:t,backend:n}){let{x:r}=e,a=fi+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,s=new xo(r.shape,a);return n.runWebGLProgram(s,[r],r.dtype)}var $9e={kernelName:xc,backendName:"webgl",kernelFunc:A9e},R9e=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,a=kn(n.length),s=kn(n.length),i="";if(r===1)i="coords * strides + begin";else{let o=0;i=n.map((l,c)=>(o++,n.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${o-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}};function D9e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:s,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:g,isIdentity:m,sliceDim0:y,isSimpleSlice:x,begin:v,end:b,strides:w}=wr.sliceInfo(a.shape,s,i,o,l,c,u,h,p),k;if(m)k=Re({inputs:{x:a},backend:n,attrs:{shape:g}});else if(y||x){j.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let C=wr.computeOutShape(v,b,w),S=my({inputs:{x:a},backend:n,attrs:{begin:v,size:C}});k=Re({inputs:{x:S},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(S)}else if(n.shouldExecuteOnCPU([a])){let C=n.readSync(a.dataId),S=jt(a.shape,a.dtype,C),E=X5e(f,S,w,v);k=n.makeTensorInfo(g,a.dtype,E.values)}else{let C=new R9e(v,w,f);k=n.runWebGLProgram(C,[a],a.dtype)}let I=Re({inputs:{x:k},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(k),I}var M9e={kernelName:Vg,backendName:"webgl",kernelFunc:D9e};function O9e(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:s,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:h}=t,p=n.readSync(u.dataId),f=n.readSync(h.dataId),[g,m]=Y5e(p,f,a,s,i,o,l,c);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(h.shape,"int32",m)]}var F9e={kernelName:cb,backendName:"webgl",kernelFunc:O9e};function P9e(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:s,delimiter:i}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let o=n.readSync(s.dataId),l=n.readSync(i.dataId)[0],[c,u,h]=J5e(o,l,a),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}var L9e={kernelName:db,backendName:"webgl",kernelFunc:P9e};function z9e(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let i=n.readSync(s.dataId),o=Z5e(i,a);return n.makeTensorInfo(s.shape,"int32",o)}var B9e={kernelName:hb,backendName:"webgl",kernelFunc:z9e},U9e="return tan(x);",W9e=en({opSnippet:U9e}),V9e={kernelName:kp,backendName:"webgl",kernelFunc:W9e},H9e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,G9e=en({opSnippet:H9e}),q9e={kernelName:Sp,backendName:"webgl",kernelFunc:G9e};function K9e(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:s,updates:i}=t,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=P.calculateShapes(i,s,a.shape),p=[h/c,c];if(h===0)return n.makeTensorInfo(a.shape,s.dtype);let f=Re({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),g=Re({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=Re({inputs:{x:a},backend:n,attrs:{shape:p}}),y=new oM(l,o,f.shape.length,g.shape.length,u,p,!1,!0),x=n.runWebGLProgram(y,[g,f,m],m.dtype),v=Re({inputs:{x},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),v}var Q9e={kernelName:Og,backendName:"webgl",kernelFunc:K9e},X9e=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let s=0;s<n.length;s++)n[s]=e[s]*t[s];this.outputShape=n,this.rank=n.length;let r=kn(this.rank),a=Y9e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}};function Y9e(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push(`imod(${n[a]}, ${e[a]})`);return r.join()}function hY(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:s}=r;if(a.dtype==="string"||a.shape.length>5){let o=n.readSync(a.dataId),l=a.dtype==="string"?o.map(h=>j.decodeString(h)):o,c=jt(a.shape,a.dtype,l),u=t6e(c,s);return n.makeTensorInfo(u.shape,u.dtype,u.values)}let i=new X9e(a.shape,s);return n.runWebGLProgram(i,[a],a.dtype)}var J9e={kernelName:yc,backendName:"webgl",kernelFunc:hY},Z9e=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},eQe=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function Dc(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function O3(e){let t=1;for(;t<e;)t*=2;return t}function tQe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:s,sorted:i}=r,o=le().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=le().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([a])||u<o||s>l){let E=n.readSync(a.dataId),[T,$]=n6e(E,c,a.dtype,s,i);return[n.makeTensorInfo(T.shape,T.dtype,T.values),n.makeTensorInfo($.shape,$.dtype,$.values)]}if(s===0)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[a,qb({attrs:{shape:c,dtype:"int32",value:0},backend:n})];let h=n.texData.get(a.dataId),p=h!==null&&h.isPacked,f=p?n.unpackTensor(a):a,g=j.sizeFromShape(c)/u,m=Re({inputs:{x:f},attrs:{shape:[g,u]},backend:n});p&&Dc(n,f);let y=O3(s),x=O3(u),v=null,b=()=>v===null?[m,m]:[m,v],w=(E,T,$)=>{let _=b(),M=new Z9e($),L=[[u],[v===null?1:0],[Number.NEGATIVE_INFINITY],[E],[T]],U=v;v=n.runWebGLProgram(M,_,"int32",L),Dc(n,U)};for(let E=1;E<y;E*=2){let T=E*2;for(let $=E;$>=1;$/=2)w(T,$,[g,x])}for(let E=x;E>y;E/=2){let T=b(),$=new eQe([g,E/2]),_=[[u],[v===null?1:0],[y]],M=v;v=n.runWebGLProgram($,T,"int32",_),Dc(n,M);let L=y/2,U=L*2;for(let O=L;O>=1;O/=2)w(U,O,v.shape)}let k=v;v=my({inputs:{x:v},backend:n,attrs:{begin:0,size:[g,s]}}),Dc(n,k);let I=aY({inputs:{x:m,indices:v},backend:n,attrs:{axis:1,batchDims:1}});Dc(n,m);let C=c.slice(0,-1);C.push(s),k=v,v=Re({inputs:{x:v},attrs:{shape:C},backend:n}),Dc(n,k);let S=I;return I=Re({inputs:{x:I},attrs:{shape:C},backend:n}),Dc(n,S),[I,v]}var nQe={kernelName:Hg,backendName:"webgl",kernelFunc:tQe},rQe=class{constructor(e,t,n,r,a,s){this.variableNames=["Image","Transforms"],this.outputShape=s;let i=n==="nearest"?1:2,o;switch(r){case"constant":o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4;break;default:o=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${o} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${i} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function aQe(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:s}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=r,[u,h,p,f]=a.shape,[g,m]=c??[h,p],y=[u,g,m,f],x=new rQe(h,p,i,o,l,y);return n.runWebGLProgram(x,[a,s],"float32")}var sQe={kernelName:Gg,backendName:"webgl",kernelFunc:aQe};function iQe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:s}=t;ly(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let i=r.readSync(s.dataId),{outputValues:o,outputShape:l,indices:c}=r6e(i,a,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}var oQe={kernelName:pb,backendName:"webgl",kernelFunc:iQe};function lQe(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:s}=r;s<0&&(s+=a.shape.length);let i=a,o=i.shape.length,l=a.shape[s],c=new Array(o-1),u=0;for(let m=0;m<o;m++)m!==s&&(c[u++]=i.shape[m]);let h=[],p=new Array(o).fill(0),f=i.shape.slice();f[s]=1;let g=new Array(l);for(let m=0;m<g.length;m++){p[s]=m;let y=my({inputs:{x:i},backend:n,attrs:{begin:p,size:f}}),x=Re({inputs:{x:y},backend:n,attrs:{shape:c}});g[m]=x,h.push(y)}return h.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}var uQe={kernelName:qg,backendName:"webgl",kernelFunc:lQe},cQe=class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,r=e.batchSize,a=e.inSize,s=e.numSegments,i=s*Math.ceil(a/n);this.outputShape=[r,i];let o="0.0",l="sumValue",c=Math.floor(n/4)*4,u=n%4,h=`
        sumValue += dot(values, segFilter);
    `,p="";a%n>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let f="";a%n>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${o};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${s})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${s})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${u===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${l});
      }
    `}};function dQe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:s}=t,{numSegments:i}=r,o=a.shape.length,l=[],c=0,u=P.getAxesPermutation([c],o),h=a;u!=null&&(h=_a({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(h),c=P.getInnerMostAxes(1,o)[0]);let p=P.segment_util.computeOutShape(h.shape,c,i),f=j.sizeFromShape([h.shape[c]]),g=Re({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(g);let m=Uk(a.dtype),y=(w,k,I,C,S)=>{let E=w.shape[0],T=w.shape[1],$=P.segment_util.segOpComputeOptimalWindowSize(T,S),_={windowSize:$,inSize:T,batchSize:E,numSegments:S},M=new cQe(_,k),L=n.compileAndRun(M,[w,I],C);if(l.push(L),L.shape[1]===S)return L;let U=dY({backend:n,attrs:{start:0,stop:S,step:1,dtype:"float32"}}),O=hY({inputs:{x:U},backend:n,attrs:{reps:[T/$]}});return l.push(U),l.push(O),y(L,k,O,C,S)},x=y(g,"unsortedSegmentSum",s,m,i),v=Re({inputs:{x},backend:n,attrs:{shape:p}}),b=v;if(u!=null){l.push(v);let w=P.getUndoAxesPermutation(u);b=_a({inputs:{x:b},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}var hQe={kernelName:fb,backendName:"webgl",kernelFunc:dQe},pQe=[X6e,J6e,tVe,aVe,iVe,uVe,dVe,pVe,yVe,vVe,NVe,_Ve,EVe,$Ve,MVe,FVe,LVe,WVe,HVe,qVe,YVe,aHe,iHe,cHe,hHe,xHe,bHe,SHe,R6e,IHe,$He,OHe,UHe,HHe,qHe,QHe,YHe,tGe,aGe,oGe,uGe,dGe,pGe,gGe,xGe,NGe,SGe,IGe,jGe,$Ge,OGe,zGe,VGe,qGe,XGe,YGe,ZGe,t8e,r8e,s8e,o8e,d8e,f8e,y8e,v8e,N8e,_8e,T8e,R8e,$6e,M8e,jHe,P8e,B8e,V8e,M6e,K8e,J8e,eqe,aqe,oqe,dqe,fqe,xqe,Nqe,_qe,Iqe,Aqe,Rqe,Mqe,Lqe,Bqe,Wqe,Hqe,qqe,Yqe,t7e,s7e,p7e,P6e,y7e,b7e,k7e,C7e,fHe,T7e,A7e,R7e,O7e,z7e,F6e,U7e,V7e,G7e,K7e,Q7e,mHe,u7e,J7e,nKe,iKe,z6e,cKe,pKe,yKe,bKe,SKe,CKe,TKe,$Ke,MKe,PKe,BKe,VKe,KKe,YKe,t9e,a9e,nHe,d7e,o9e,u9e,d9e,p9e,m9e,y9e,v9e,w9e,k9e,C9e,E9e,j9e,$9e,M9e,F9e,L9e,B9e,c7e,q6e,V9e,q9e,Q9e,J9e,nQe,sQe,K6e,oQe,uQe,hQe,j7e];for(let e of pQe)mb(e);var rn;(function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"})(rn||(rn={}));var mv;(function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"})(mv||(mv={}));var pY;function fQe(e){pY=e.wasm.cwrap($d,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function mQe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:s,bias:i,preluActivationWeights:o}=t;if(a.dtype!=="float32"||s.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r,p=n.dataIdMap.get(a.dataId).id,f=n.dataIdMap.get(s.dataId).id,g=0;if(i!=null){let S=n.dataIdMap.get(i.dataId);if(S.shape.length!==1)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${S.shape.length}.`);g=S.id}let m=o==null?0:n.dataIdMap.get(o.dataId).id,y=mv[u];if(y==null)throw new Error(`${u} activation not yet supported for FusedConv2D in the wasm backend.`);let x=l?a.shape[2]:a.shape[1],v=c?s.shape[1]:s.shape[2],b=Xg.assertAndGetBroadcastShape(a.shape.slice(0,-2),s.shape.slice(0,-2)),w=n.makeOutput([...b,x,v],a.dtype),k=n.dataIdMap.get(w.dataId).id,I=new Uint8Array(new Int32Array(a.shape).buffer),C=new Uint8Array(new Int32Array(s.shape).buffer);return pY(p,I,a.shape.length,f,C,s.shape.length,l,c,y,g,m,h||0,k),w}var gQe={kernelName:$d,backendName:"wasm",setupFunc:fQe,kernelFunc:mQe};function Jt(e,t){let n;function r(s){n=s.wasm.cwrap(e,null,["number","number","number"])}function a(s){let{backend:i,inputs:{x:o}}=s,l=i.dataIdMap.get(o.dataId).id,c=i.makeOutput(o.shape,t||o.dtype),u=i.dataIdMap.get(c.dataId).id;return j.sizeFromShape(c.shape)===0||n(l,rn[o.dtype],u),c}return{kernelName:e,backendName:"wasm",setupFunc:r,kernelFunc:a}}var yQe=Jt(Km),xQe=Jt(oh),vQe=Jt(lh);function yr(e,t,n){let r;function a(i){r=i.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])}function s(i){let{backend:o,inputs:l}=i,{a:c,b:u}=l,h=o.dataIdMap.get(c.dataId).id,p=o.dataIdMap.get(u.dataId).id,f=n??c.dtype,g=P.assertAndGetBroadcastShape(c.shape,u.shape),m=o.makeOutput(g,f);if(j.sizeFromShape(g)===0)return m;let y=new Uint8Array(new Int32Array(c.shape).buffer),x=new Uint8Array(new Int32Array(u.shape).buffer),v=o.dataIdMap.get(m.dataId).id;return r(h,y,c.shape.length,p,x,u.shape.length,rn[c.dtype],v),m}return{kernelName:e,backendName:"wasm",setupFunc:a,kernelFunc:s}}var bQe=yr(mc),fY;function wQe(e){fY=e.wasm.cwrap(uh,null,["array","number","number","number"])}function NQe(e){let{inputs:t,backend:n}=e,r=n.makeOutput(t[0].shape,t[0].dtype);if(j.sizeFromShape(r.shape)===0)return r;let a=t.map(o=>n.dataIdMap.get(o.dataId).id),s=new Uint8Array(new Int32Array(a).buffer),i=n.dataIdMap.get(r.dataId).id;return fY(s,a.length,rn[r.dtype],i),r}var kQe={kernelName:uh,backendName:"wasm",setupFunc:wQe,kernelFunc:NQe};function YS(e){let{inputs:{x:t},backend:n}=e;if(t.dtype==="string")return va(n.readSync(t.dataId),t.shape,t.dtype);let r=n.makeOutput(t.shape,t.dtype),a=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(r).set(a),r}var SQe={kernelName:Oh,backendName:"wasm",kernelFunc:YS},mY;function _Qe(e){mY=e.wasm.cwrap(dl,null,["number","array","number","number","number","array","number"])}function nc(e){let{inputs:t,backend:n,attrs:r}=e,[a,s]=IQe(t.x.shape,r.perm),i=!0;for(let g=0;g<s.length;g++)s[g]!==g&&(i=!1);let o=CQe(t.x.shape,r.perm),l={dataId:t.x.dataId,shape:a,dtype:t.x.dtype};if(i){let g=YS({inputs:t,backend:n});return g.shape=o,g}let c=n.makeOutput(o,l.dtype),u=n.dataIdMap.get(l.dataId).id,h=n.dataIdMap.get(c.dataId).id,p=new Uint8Array(new Int32Array(s).buffer),f=new Uint8Array(new Int32Array(l.shape).buffer);return mY(u,f,l.shape.length,rn[l.dtype],h,p,s.length),c}function CQe(e,t){let n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];return n}function IQe(e,t){let n=[],r=[];for(let a=0;a<e.length;++a)e[a]!==1&&n.push(e[a]),e[t[a]]!==1&&r.push(t[a]);for(let a=0;a<r.length;++a){let s=-1;for(let i=0;i<r.length;++i)r[i]>=a&&(s===-1||r[s]>r[i])&&(s=i);r[s]=a}return[n,r]}var EQe={kernelName:dl,backendName:"wasm",kernelFunc:nc,setupFunc:_Qe};function Cc(e,t,n){let r=e.shape,a=e.shape.length,s=j.parseAxisParam(t,r),i=s,o=P.getAxesPermutation(i,a),l=null,c=!1;if(o!=null){let u=new Array(a);for(let p=0;p<u.length;p++)u[p]=r[o[p]];i=P.getInnerMostAxes(i.length,a),l=nc({inputs:{x:e},attrs:{perm:o},backend:n});let h=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(l.dataId).id!==h&&(c=!0)}return{transposed:l,originalAxes:s,axes:i,inputWasTransposed:c}}var gY;function TQe(e){gY=e.wasm.cwrap(Qm,null,["number, number, number"])}function jQe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:u,originalAxes:h,inputWasTransposed:p}=Cc(i,a,t);if(p){let v=t.dataIdMap.get(c.dataId).id;l=c,o=v}let f=l.shape.length;P.assertAxesAreInnerMostDims("all",u,f);let[g,m]=P.computeOutAndReduceShapes(l.shape,u),y=j.sizeFromShape(m),x=t.makeOutput(g,i.dtype);if(j.sizeFromShape(l.shape)!==0){let v=t.dataIdMap.get(x.dataId).id;gY(o,y,v)}if(p&&t.disposeData(c.dataId),s){let v=P.expandShapeToKeepDim(x.shape,h);x.shape=v}return x}var AQe={kernelName:Qm,backendName:"wasm",setupFunc:TQe,kernelFunc:jQe},yY;function $Qe(e){yY=e.wasm.cwrap(Xm,null,["number, number, number"])}function RQe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:u,originalAxes:h,inputWasTransposed:p}=Cc(i,a,t);if(p){let v=t.dataIdMap.get(c.dataId).id;l=c,o=v}let f=l.shape.length;P.assertAxesAreInnerMostDims("any",u,f);let[g,m]=P.computeOutAndReduceShapes(l.shape,u),y=j.sizeFromShape(m),x=t.makeOutput(g,i.dtype);if(j.sizeFromShape(l.shape)!==0){let v=t.dataIdMap.get(x.dataId).id;yY(o,y,v)}if(p&&t.disposeData(c.dataId),s){let v=P.expandShapeToKeepDim(x.shape,h);x.shape=v}return x}var DQe={kernelName:Xm,backendName:"wasm",setupFunc:$Qe,kernelFunc:RQe};function xY(e){let t;function n(a){t=a.wasm.cwrap(e,null,["number","number","number","number","number"])}function r(a){let{backend:s,inputs:i,attrs:o}=a,{axis:l}=o,{x:c}=i,u=s.dataIdMap.get(c.dataId).id,h=u,p=c,{transposed:f,axes:g,inputWasTransposed:m}=Cc(c,l,s);if(m){let k=s.dataIdMap.get(f.dataId).id;k!==u&&(p=f,h=k)}let y=p.shape.slice(0,-1),x=s.makeOutput(y,"int32"),v=s.dataIdMap.get(x.dataId).id,b=j.sizeFromShape(x.shape),w=p.shape[g[0]];return t(h,rn[p.dtype],b,w,v),m&&s.disposeData(f.dataId),x}return{kernelName:e,backendName:"wasm",setupFunc:n,kernelFunc:r}}var MQe=xY(Ym),OQe=xY(Jm),FQe=Jt(ch),PQe=Jt(dh),LQe=Jt(hh),zQe=yr(fh),BQe=Jt(ph),vY;function UQe(e){vY=e.wasm.cwrap(mh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function WQe(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,s=r.dataIdMap.get(a.dataId).id,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=n,u=P.computePool2DInfo(a.shape,i,o,1,l,c),h=u.filterHeight,p=u.filterWidth,f=u.padInfo.top,g=u.padInfo.right,m=u.padInfo.bottom,y=u.padInfo.left,x=u.strideHeight,v=u.strideWidth,b=u.inChannels;if(u.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${u.dataFormat}'. Please use 'channelsLast'.`);if(u.dilationWidth!==1||u.dilationHeight!==1)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${u.dilationHeight}, ${u.dilationWidth}].`);let w=r.makeOutput(u.outShape,"float32"),k=r.dataIdMap.get(w.dataId).id;return vY(s,a.shape[0],a.shape[1],a.shape[2],h,p,f,g,m,y,x,v,b,k),w}var VQe={kernelName:mh,backendName:"wasm",setupFunc:UQe,kernelFunc:WQe},bY;function HQe(e){bY=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function GQe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=P.computePool3DInfo(a.shape,s,i,1,o,l,c),h=n.makeOutput(u.outShape,a.dtype);return bY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(h.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),h}var qQe={kernelName:Zm,backendName:"wasm",setupFunc:HQe,kernelFunc:GQe},wY;function KQe(e){wY=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function QQe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=r,u=P.computePool3DInfo(s.shape,i,o,1,l,c),h=n.makeOutput(s.shape,s.dtype);return wY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(h.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left,u.filterDepth,u.filterHeight,u.filterWidth),h}var XQe={kernelName:Qv,backendName:"wasm",setupFunc:KQe,kernelFunc:QQe},NY;function YQe(e){NY=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function JQe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:l}=r,c=P.computePool2DInfo(s.shape,i,o,1,l),u=n.makeOutput(s.shape,s.dtype);return NY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left,c.filterHeight,c.filterWidth),u}var ZQe={kernelName:Kv,backendName:"wasm",setupFunc:YQe,kernelFunc:JQe};function Ba(e){let{inputs:t,attrs:n}=e,{x:r}=t,{shape:a}=n,s=j.sizeFromShape(r.shape),i=j.inferFromImplicitShape(a,s);return j.assert(s===j.sizeFromShape(i),()=>`new shape: ${i}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:i,dtype:r.dtype}}var eXe={kernelName:$g,backendName:"wasm",kernelFunc:Ba},kY;function tXe(e){kY=e.wasm.cwrap(gh,null,["number","array","number","number","array","number","number","number","number"])}function nXe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:s}=t,{transposeA:i,transposeB:o}=r;if(a.dtype!=="float32"||s.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let l=a.shape.length,c=s.shape.length,u=i?a.shape[l-2]:a.shape[l-1],h=o?s.shape[c-1]:s.shape[c-2],p=i?a.shape[l-1]:a.shape[l-2],f=o?s.shape[c-2]:s.shape[c-1],g=a.shape.slice(0,-2),m=s.shape.slice(0,-2),y=j.sizeFromShape(g),x=j.sizeFromShape(m),v=Xg.assertAndGetBroadcastShape(a.shape.slice(0,-2),s.shape.slice(0,-2)).concat([p,f]);j.assert(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${a.shape} and ${s.shape} and transposeA=${i} and transposeB=${o} must match.`);let b=i?[y,u,p]:[y,p,u],w=o?[x,f,h]:[x,h,f],k=Ba({inputs:{x:a},backend:n,attrs:{shape:b}}),I=Ba({inputs:{x:s},backend:n,attrs:{shape:w}}),C=n.dataIdMap.get(k.dataId).id,S=n.dataIdMap.get(I.dataId).id,E=i?k.shape[2]:k.shape[1],T=o?I.shape[1]:I.shape[2],$=Math.max(y,x),_=n.makeOutput([$,E,T],k.dtype),M=n.dataIdMap.get(_.dataId).id,L=new Uint8Array(new Int32Array(k.shape).buffer),U=new Uint8Array(new Int32Array(I.shape).buffer);return kY(C,L,k.shape.length,S,U,I.shape.length,i,o,M),n.disposeData(k.dataId),n.disposeData(I.dataId),_.shape=v,_}var rXe={kernelName:gh,backendName:"wasm",setupFunc:tXe,kernelFunc:nXe};function Xd(e){let{inputs:{x:t},attrs:{begin:n,size:r},backend:a}=e,[s,i]=wr.parseSliceParams(t,n,r),o=wr.isSliceContinous(t.shape,s,i),l=a.readSync(t.dataId),c=a.makeOutput(i,t.dtype),u=j.computeStrides(t.shape),h=a.dataIdMap.get(c.dataId);if(o){let g=wr.computeFlatOffset(s,u);return t.dtype==="string"?h.stringBytes=l.slice(g,g+j.sizeFromShape(i)):a.typedArrayFromHeap(c).set(l.subarray(g,g+j.sizeFromShape(i))),c}if(t.dtype==="string"){let g=Y1(l,s,i,t.shape,t.dtype);return h.stringBytes=g,c}let p=a.typedArrayFromHeap(c),f=t.shape.length;if(f===2)aXe(l,u[0],p,s,i);else if(f===3)sXe(l,u[0],u[1],p,s,i);else if(f===4)iXe(l,u[0],u[1],u[2],p,s,i);else{let g=Y1(l,s,i,t.shape,t.dtype);p.set(g)}return c}function aXe(e,t,n,r,a){let s=0,i=r[0],o=r[1],l=i+a[0];for(let c=i;c<l;c++){let u=c*t+o;n.set(e.subarray(u,u+a[1]),s),s+=a[1]}}function sXe(e,t,n,r,a,s){let i=0,o=a[0],l=a[1],c=a[2],u=o+s[0],h=l+s[1];for(let p=o;p<u;p++)for(let f=l;f<h;f++){let g=p*t+f*n+c;r.set(e.subarray(g,g+s[2]),i),i+=s[2]}}function iXe(e,t,n,r,a,s,i){let o=0,l=s[0],c=s[1],u=s[2],h=l+i[0],p=c+i[1],f=u+i[2],g=s[3];for(let m=l;m<h;m++)for(let y=c;y<p;y++)for(let x=u;x<f;x++){let v=m*t+y*n+x*r+g;a.set(e.subarray(v,v+i[3]),o),o+=i[3]}}var oXe={kernelName:Lg,backendName:"wasm",kernelFunc:Xd};function lXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,crops:i}=r,o=s.reduce((x,v)=>x*v),l=P.getReshaped(a.shape,s,o),c=P.getPermuted(l.length,s.length),u=P.getReshapedPermuted(a.shape,s,o),h=P.getSliceBeginCoords(i,s.length),p=P.getSliceSize(u,i,s.length),f=Ba({inputs:{x:a},backend:n,attrs:{shape:l}}),g=nc({inputs:{x:f},backend:n,attrs:{perm:c}}),m=Ba({inputs:{x:g},backend:n,attrs:{shape:u}}),y=Xd({inputs:{x:m},backend:n,attrs:{begin:h,size:p}});return n.disposeData(f.dataId),n.disposeData(g.dataId),n.disposeData(m.dataId),y}var uXe={kernelName:eg,backendName:"wasm",kernelFunc:lXe},SY;function cXe(e){SY=e.wasm.cwrap(tg,null,["number","number","boolean","number","number","number"])}function dXe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:s}=n,{size:i}=r,o=s.shape.reduce((h,p)=>h*p,1)!==0,l=a.shape.length===1?[i]:[a.shape[0],i],c=t.makeOutput(l,s.dtype);function u(h){return t.dataIdMap.get(h.dataId).id}return SY(u(a),i,o,u(s),rn[s.dtype],u(c)),c}var hXe={kernelName:tg,backendName:"wasm",setupFunc:cXe,kernelFunc:dXe},pXe=yr(ng);function fXe(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,s=n.typedArrayFromHeap(r),i=n.typedArrayFromHeap(a),o=P.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return n.makeOutput([o.length],"int32",void 0,new Int32Array(o))}var mXe={kernelName:Xv,backendName:"wasm",kernelFunc:fXe};function Ic(e){let{inputs:{x:t},attrs:{dtype:n},backend:r}=e,a=r.makeOutput(t.shape,n),s=r.typedArrayFromHeap(t);return r.typedArrayFromHeap(a).set(s),a}var gXe={kernelName:yh,backendName:"wasm",kernelFunc:Ic},yXe=Jt(xh),_Y;function xXe(e){_Y=e.wasm.cwrap(gc,null,["number","number","number","number"])}function vXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:s,clipValueMax:i}=r,o=n.dataIdMap.get(a.dataId).id,l=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(l.dataId).id;return _Y(o,s,i,c),l}var bXe={kernelName:gc,backendName:"wasm",setupFunc:xXe,kernelFunc:vXe};function CY(e){let{inputs:t,backend:n}=e,r=j.parseAxisParam(e.attrs.axis,t[0].shape)[0],a=t.map(f=>f.shape);P.assertParamsConsistent(a,r);let s=P.computeOutShape(t.map(f=>f.shape),r),i=t.filter(f=>j.sizeFromShape(f.shape)>0);if(i.length===1)return YS({inputs:{x:i[0]},backend:n});let o=n.makeOutput(s,t[0].dtype);if(j.sizeFromShape(s)===0)return o;if(i[0].dtype==="string"){let f=i.map(b=>{let w=[-1,j.sizeFromShape(b.shape.slice(r))];return Ba({inputs:{x:b},backend:n,attrs:{shape:w}})}),g=f.map(b=>({vals:n.readSync(b.dataId),shape:b.shape}));s=P.computeOutShape(f.map(b=>b.shape),1);let m=f[0].shape[0]===1,y=RD(g,s,t[0].dtype,m),x=P.computeOutShape(i.map(b=>b.shape),r);o.shape=x;let v=n.dataIdMap.get(o.dataId);return v.stringBytes=P.fromStringArrayToUint8(y),f.forEach(b=>n.disposeData(b.dataId)),o}let l=j.sizeFromShape(i[0].shape.slice(0,r)),c=0,u=i.map(f=>{let g=j.sizeFromShape(f.shape.slice(r));return c+=g,g}),h=i.map(f=>n.typedArrayFromHeap(f)),p=n.typedArrayFromHeap(o);for(let f=0;f<l;f++){let g=f*c;for(let m=0;m<h.length;m++){let y=u[m],x=f*y,v=h[m].subarray(x,x+y);p.set(v,g),g+=y}}return o}var wXe={kernelName:rg,backendName:"wasm",kernelFunc:CY},IY;function NXe(e){IY=e.wasm.cwrap(vh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function kXe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s}=t,i=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(s.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:h,dataFormat:p}=n,f=P.convertConv2DDataFormat(p),g=P.computeConv2DInfo(a.shape,s.shape,l,c,u,h,!1,f),m=g.filterHeight,y=g.filterWidth,x=g.padInfo.top,v=g.padInfo.right,b=g.padInfo.bottom,w=g.padInfo.left,k=g.dilationHeight,I=g.dilationWidth,C=g.strideHeight,S=g.strideWidth,E=g.inChannels,T=g.outChannels,$=g.padInfo.type==="SAME"?1:0;if(g.dataFormat!=="channelsLast")throw new Error(`wasm backend Conv2D does not support dataFormat:'${g.dataFormat}'. Please use 'channelsLast'.`);let _=r.makeOutput(g.outShape,"float32"),M=r.dataIdMap.get(_.dataId).id;return IY(i,a.shape[0],a.shape[1],a.shape[2],o,m,y,x,v,b,w,$,k,I,C,S,E,T,M),_}var SXe={kernelName:vh,backendName:"wasm",setupFunc:NXe,kernelFunc:kXe},EY;function _Xe(e){EY=e.wasm.cwrap(bh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function CXe(e){let{backend:t,inputs:n,attrs:r}=e,{dy:a,filter:s}=n,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,inputShape:u}=r,h=1,p=P.convertConv2DDataFormat(l),f=P.computeConv2DInfo(u,s.shape,i,h,o,c,!1,p),{batchSize:g,filterHeight:m,filterWidth:y,inChannels:x,inHeight:v,inWidth:b,outChannels:w,outHeight:k,outWidth:I,strideHeight:C,strideWidth:S}=f,E=m-1-f.padInfo.top,T=y-1-f.padInfo.left,$=f.dataFormat==="channelsLast",_=j.computeStrides(f.inShape),M=j.computeStrides(a.shape),[L,U,O]=j.computeStrides(s.shape),F=_[0],D=$?_[1]:_[2],R=$?_[2]:1,V=$?1:_[1],G=M[0],W=$?M[1]:M[2],B=$?M[2]:1,Q=$?1:M[1],X=t.makeOutput(f.inShape,"float32"),pe=t.dataIdMap.get(X.dataId).id,ie=t.dataIdMap.get(a.dataId).id,oe=t.dataIdMap.get(s.dataId).id;return EY(ie,oe,g,m,y,v,b,x,k,I,w,C,S,E,T,L,U,O,F,D,R,V,G,W,B,Q,pe),X}var IXe={kernelName:bh,backendName:"wasm",setupFunc:_Xe,kernelFunc:CXe},TY;function EXe(e){TY=e.wasm.cwrap(wh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function TXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor x must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);let c=P.computeConv3DInfo(a.shape,s.shape,i,l,o),u=n.makeOutput(c.outShape,a.dtype);return TY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var jXe={kernelName:wh,backendName:"wasm",setupFunc:EXe,kernelFunc:TXe},jY;function AXe(e){jY=e.wasm.cwrap(ag,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function $Xe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:s}=t,{strides:i,pad:o,filterShape:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);let c=P.computeConv3DInfo(a.shape,l,i,1,o),u=n.makeOutput(c.filterShape,s.dtype);return jY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var RXe={kernelName:ag,backendName:"wasm",setupFunc:AXe,kernelFunc:$Xe},AY;function DXe(e){AY=e.wasm.cwrap(sg,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function MXe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:s}=t,{pad:i,strides:o,inputShape:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);let c=P.computeConv3DInfo(l,s.shape,o,1,i),u=n.makeOutput(c.inShape,a.dtype);return AY(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var OXe={kernelName:sg,backendName:"wasm",setupFunc:DXe,kernelFunc:MXe},FXe=Jt(Nh),PXe=Jt(kh),ME;(function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"})(ME||(ME={}));var $Y;function LXe(e){$Y=e.wasm.cwrap(og,null,["number","number","number","number","array","number","number","number","number","number"])}function zXe(e){let{backend:t,inputs:n,attrs:r}=e,{method:a,extrapolationValue:s,cropSize:i}=r,{image:o,boxes:l,boxInd:c}=n,u=l.shape[0],[h,p]=i,f=[u,h,p,o.shape[3]],g=t.dataIdMap.get(o.dataId),m;o.dtype!=="float32"&&(m=Ic({backend:t,inputs:{x:o},attrs:{dtype:"float32"}}),g=t.dataIdMap.get(m.dataId));let y=g.id,x=t.dataIdMap.get(l.dataId).id,v=t.dataIdMap.get(c.dataId).id,b=t.makeOutput(f,"float32"),w=t.dataIdMap.get(b.dataId).id,k=new Uint8Array(new Int32Array(o.shape).buffer);return $Y(y,x,v,u,k,h,p,ME[a],s,w),m!=null&&t.disposeData(m.dataId),b}var BXe={kernelName:og,backendName:"wasm",setupFunc:LXe,kernelFunc:zXe},RY;function UXe(e){RY=e.wasm.cwrap(ig,null,["number","number","number","number","number","number"])}function WXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=r,l=a.shape.length;j.assert(a.dtype==="float32"||a.dtype==="int32",()=>`cumprod does not support ${a.dtype} tensors in the WASM backend`);let c=P.getAxesPermutation([s],l),u=a;c!==null&&(u=nc({inputs:{x:a},attrs:{perm:c},backend:n}));let h=P.getInnerMostAxes(1,l)[0];P.assertAxesAreInnerMostDims("cumprod",[h],l);let p=n.makeOutput(u.shape,u.dtype),f=u.shape[h],g=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;RY(g,i?1:0,o?1:0,f,m,rn[a.dtype]);let y=p;if(c!==null){let x=P.getUndoAxesPermutation(c);y=nc({inputs:{x:p},attrs:{perm:x},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return y}var VXe={kernelName:ig,backendName:"wasm",setupFunc:UXe,kernelFunc:WXe},DY;function HXe(e){DY=e.wasm.cwrap(Sh,null,["number","number","number","number","number","number"])}function GXe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=r,l=a.shape.length;j.assert(a.dtype==="float32"||a.dtype==="int32",()=>`cumsum does not support ${a.dtype} tensors in the WASM backend`);let c=P.getAxesPermutation([s],l),u=a;c!==null&&(u=nc({inputs:{x:a},attrs:{perm:c},backend:n}));let h=P.getInnerMostAxes(1,l)[0];P.assertAxesAreInnerMostDims("cumsum",[h],l);let p=n.makeOutput(u.shape,u.dtype),f=u.shape[h],g=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;DY(g,i?1:0,o?1:0,f,m,rn[a.dtype]);let y=p;if(c!==null){let x=P.getUndoAxesPermutation(c);y=nc({inputs:{x:p},attrs:{perm:x},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return y}var qXe={kernelName:Sh,backendName:"wasm",setupFunc:HXe,kernelFunc:GXe},MY;function KXe(e){MY=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])}function QXe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:s}=n,{size:i,binaryOutput:o}=r,l=s.shape.reduce((p,f)=>p*f,1)!==0,c=a.shape.length===1?[i]:[a.shape[0],i],u=t.makeOutput(c,s.dtype);function h(p){return t.dataIdMap.get(p.dataId).id}return MY(h(a),new Uint8Array(new Int32Array(a.shape).buffer),a.shape.length,i,l,h(s),rn[s.dtype],o,h(u)),u}var XXe={kernelName:Jv,backendName:"wasm",setupFunc:KXe,kernelFunc:QXe},OY;function YXe(e){OY=e.wasm.cwrap(lg,null,["number","number","number","array","number","array","array","number","number"])}function JXe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{blockSize:s,dataFormat:i}=r,o=a.shape[0],l=i==="NHWC"?a.shape[1]:a.shape[2],c=i==="NHWC"?a.shape[2]:a.shape[3],u=i==="NHWC"?a.shape[3]:a.shape[1],h=l*s,p=c*s,f=u/(s*s),g=i==="NHWC"?[o,h,p,f]:[o,f,h,p],m=t.makeOutput(g,"float32"),y=t.dataIdMap.get(a.dataId).id,x=new Uint8Array(new Int32Array(j.computeStrides(a.shape)).buffer),v=new Uint8Array(new Int32Array(g).buffer),b=new Uint8Array(new Int32Array(j.computeStrides(g)).buffer),w=t.dataIdMap.get(m.dataId).id;return OY(y,s,i==="NHWC"?1:0,x,a.shape.length-1,v,b,g.length,w),m}var ZXe={kernelName:lg,backendName:"wasm",setupFunc:YXe,kernelFunc:JXe},FY;function eYe(e){FY=e.wasm.cwrap(_h,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function tYe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s}=t,i=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(s.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:h}=n,p=c??[1,1],f=P.computeConv2DInfo(a.shape,s.shape,l,p,u,h,!0),g=f.filterHeight,m=f.filterWidth,y=f.padInfo.top,x=f.padInfo.right,v=f.padInfo.bottom,b=f.padInfo.left,w=f.dilationHeight,k=f.dilationWidth,I=f.strideHeight,C=f.strideWidth,S=f.inChannels,E=f.outChannels,T=f.padInfo.type==="SAME"?1:0;if(f.dataFormat!=="channelsLast")throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);let $=r.makeOutput(f.outShape,"float32"),_=r.dataIdMap.get($.dataId).id;return FY(i,a.shape[0],a.shape[1],a.shape[2],o,g,m,y,x,v,b,T,w,k,I,C,S,E,_),$}var nYe={kernelName:_h,backendName:"wasm",setupFunc:eYe,kernelFunc:tYe},PY;function rYe(e){PY=e.wasm.cwrap("Diag",null,["number","number","number","number"])}function aYe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=j.sizeFromShape(r.shape),s=n.makeOutput([...r.shape,...r.shape],r.dtype);return PY(n.dataIdMap.get(r.dataId).id,rn[r.dtype],a,n.dataIdMap.get(s.dataId).id),s}var sYe={kernelName:Zv,backendName:"wasm",setupFunc:rYe,kernelFunc:aYe},LY;function iYe(e){LY=e.wasm.cwrap(Ch,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function oYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:l}=r;if(a.dtype!==s.dtype)throw new Error(`Dilation2D error: x must have the same dtype as filter. Got ${a.dtype} and ${s.dtype}`);let c=P.computeDilation2DInfo(a.shape,s.shape,i,o,"NHWC",l),u=n.makeOutput(c.outShape,a.dtype);return LY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(u.dataId).id,rn[a.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),u}var lYe={kernelName:Ch,backendName:"wasm",setupFunc:iYe,kernelFunc:oYe},zY;function uYe(e){zY=e.wasm.cwrap(cm,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function cYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s,dy:i}=t,{strides:o,pad:l,dilations:c}=r;if(a.dtype!==s.dtype||a.dtype!==i.dtype)throw new Error(`Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${s.dtype}, and ${i.dtype}`);let u=P.computeDilation2DInfo(a.shape,s.shape,o,l,"NHWC",c),h=n.makeOutput(s.shape,s.dtype);return zY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(h.dataId).id,rn[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),h}var dYe={kernelName:cm,backendName:"wasm",setupFunc:uYe,kernelFunc:cYe},BY;function hYe(e){BY=e.wasm.cwrap(um,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function pYe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:s,dy:i}=t,{strides:o,pad:l,dilations:c}=r;if(a.dtype!==s.dtype||a.dtype!==i.dtype)throw new Error(`Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${s.dtype}, and ${i.dtype}`);let u=P.computeDilation2DInfo(a.shape,s.shape,o,l,"NHWC",c),h=n.makeOutput(a.shape,a.dtype);return BY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(h.dataId).id,rn[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),h}var fYe={kernelName:um,backendName:"wasm",setupFunc:hYe,kernelFunc:pYe},mYe=Jt(Eh),UY;function gYe(e){UY=e.wasm.cwrap(ug,null,["number","number","number"])}function yYe(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t,s=n.makeOutput(a.shape,"float32"),i=o=>n.dataIdMap.get(o.dataId).id;return UY(i(a),i(r),i(s)),s}var xYe={kernelName:ug,backendName:"wasm",setupFunc:gYe,kernelFunc:yYe},vYe=!1,bYe=yr(cg,vYe,"bool"),wYe=Jt(Th),NYe=Jt(jh,"float32");function OE(e){let{inputs:t,attrs:n,backend:r}=e,{input:a}=t,{dim:s}=n,i=a.shape.length,o=a.shape.slice(),l=s;return s<0&&(j.assert(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),o.splice(l,0,1),Ba({inputs:{x:a},backend:r,attrs:{shape:o}})}var kYe={kernelName:dg,backendName:"wasm",kernelFunc:OE},SYe=Jt(Ah,"float32");function WY(e){let{attrs:{shape:t,value:n},backend:r}=e,{attrs:{dtype:a}}=e;a=a||j.inferDtype(n);let s=r.makeOutput(t,a);return r.typedArrayFromHeap(s).fill(n),s}var _Ye={kernelName:eb,backendName:"wasm",kernelFunc:WY},VY;function CYe(e){VY=e.wasm.cwrap(hg,null,["number","number","number","number","number","number"])}function IYe(e){let{inputs:t,backend:n}=e,{image:r}=t,a=n.makeOutput(r.shape,r.dtype),s=n.dataIdMap.get(r.dataId).id,i=n.dataIdMap.get(a.dataId).id,[o,l,c,u]=r.shape;return VY(s,o,l,c,u,i),a}var EYe={kernelName:hg,backendName:"wasm",kernelFunc:IYe,setupFunc:CYe},TYe=Jt($h),jYe=yr(Rh),HY;function AYe(e){HY=e.wasm.cwrap(Dh,null,["number","number","number","number","number","number","number"])}function $Ye(e){let{backend:t,inputs:n,attrs:r}=e,{varianceEpsilon:a}=r,{x:s,mean:i,variance:o,offset:l,scale:c}=n,u=t.dataIdMap.get(s.dataId).id,h=t.dataIdMap.get(i.dataId).id,p=t.dataIdMap.get(o.dataId).id,f=l!=null?t.dataIdMap.get(l.dataId).id:0,g=c!=null?t.dataIdMap.get(c.dataId).id:0,m=t.makeOutput(s.shape,s.dtype);if(j.sizeFromShape(s.shape)===0)return m;let y=t.dataIdMap.get(m.dataId).id;return HY(u,h,p,f,g,a,y),m}var RYe={kernelName:Dh,backendName:"wasm",setupFunc:AYe,kernelFunc:$Ye},GY;function DYe(e){GY=e.wasm.cwrap(Rd,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function MYe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=n,m=P.computeConv2DInfo(a.shape,s.shape,l,u,c,p),y=mv[f];if(y==null)throw new Error(`${f} activation not yet supported for FusedConv2D in the wasm backend.`);let x=r.dataIdMap.get(a.dataId).id,v=r.dataIdMap.get(s.dataId).id,b=m.outChannels,w=0;if(i!=null){let B=r.dataIdMap.get(i.dataId);if(B.shape.length!==1)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${B.shape.length}.`);if(B.shape[0]!==b)throw new Error(`FusedConv2D bias shape (${B.shape}) does not match the number of output channels (${b})`);w=B.id}let k=m.filterHeight,I=m.filterWidth,C=m.padInfo.top,S=m.padInfo.right,E=m.padInfo.bottom,T=m.padInfo.left,$=m.dilationHeight,_=m.dilationWidth,M=m.strideHeight,L=m.strideWidth,U=m.inChannels,O=m.padInfo.type==="SAME"?1:0,F=m.batchSize,D=m.inHeight,R=m.inWidth;if(h!=="NHWC")throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${h}'. Please use 'NHWC'.`);let V=r.makeOutput(m.outShape,"float32"),G=r.dataIdMap.get(V.dataId).id,W=o==null?0:r.dataIdMap.get(o.dataId).id;return GY(x,F,D,R,v,k,I,w,C,S,E,T,O,$,_,M,L,U,b,y,W,g||0,G),V}var OYe={kernelName:Rd,backendName:"wasm",setupFunc:DYe,kernelFunc:MYe},qY;function FYe(e){qY=e.wasm.cwrap(Dd,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function PYe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=n,m=P.computeConv2DInfo(a.shape,s.shape,l,u,c,p,!0),y=mv[f];if(y==null)throw new Error(`${f} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);let x=r.dataIdMap.get(a.dataId).id,v=r.dataIdMap.get(s.dataId).id,b=m.outChannels,w=0;if(i!=null){let B=r.dataIdMap.get(i.dataId);if(B.shape.length!==1)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${B.shape.length}.`);if(B.shape[0]!==b)throw new Error(`FusedDepthwiseConv2D bias shape (${B.shape}) does not match the number of output channels (${b})`);w=B.id}let k=m.filterHeight,I=m.filterWidth,C=m.padInfo.top,S=m.padInfo.right,E=m.padInfo.bottom,T=m.padInfo.left,$=m.dilationHeight,_=m.dilationWidth,M=m.strideHeight,L=m.strideWidth,U=m.inChannels,O=m.padInfo.type==="SAME"?1:0,F=m.batchSize,D=m.inHeight,R=m.inWidth;if(h!=="NHWC")throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${h}'. Please use 'NHWC'.`);let V=r.makeOutput(m.outShape,"float32"),G=r.dataIdMap.get(V.dataId).id,W=o==null?0:r.dataIdMap.get(o.dataId).id;return qY(x,F,D,R,v,k,I,w,C,S,E,T,O,$,_,M,L,U,b,y,W,g||0,G),V}var LYe={kernelName:Dd,backendName:"wasm",setupFunc:FYe,kernelFunc:PYe},KY;function zYe(e){KY=e.wasm.cwrap(fg,null,["number","number","number","number","number","number","array","number"])}function BYe(e){let{backend:t,inputs:n}=e,{params:r,indices:a}=n,[s,i,o,l]=H$.prepareAndValidate(r,a),c=t.makeOutput(s,r.dtype);if(i===0)return c;let u=a.shape,h=u[u.length-1],p=t.dataIdMap.get(r.dataId).id,f=t.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(l).buffer),m=t.dataIdMap.get(c.dataId).id;return KY(p,rn[r.dtype],f,i,h,o,g,m),c}var UYe={kernelName:fg,backendName:"wasm",setupFunc:zYe,kernelFunc:BYe},QY;function WYe(e){QY=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function VYe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,indices:s}=n,{axis:i,batchDims:o}=r,l=j.parseAxisParam(i,a.shape)[0],c=t.readSync(s.dataId),u=a.shape[l];for(let C=0;C<c.length;++C){let S=c[C];j.assert(S<=u-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${u-1}]`)}let h=P.segment_util.collectGatherOpShapeInfo(a,s,l,o),p=Ba({inputs:{x:a},attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]},backend:t}),f=j.sizeFromShape(s.shape),g=Ba({inputs:{x:s},attrs:{shape:[h.batchSize,f/h.batchSize]},backend:t}),m=[h.batchSize,h.outerSize,f/h.batchSize,h.sliceSize],y=t.makeOutput(m,a.dtype);if(j.sizeFromShape(a.shape)===0)return y;let x=p.shape.length-1,v=t.dataIdMap.get(p.dataId).id,b=t.dataIdMap.get(g.dataId).id,w=t.dataIdMap.get(y.dataId).id,k=new Uint8Array(new Int32Array(j.computeStrides(p.shape)).buffer),I=new Uint8Array(new Int32Array(j.computeStrides(m)).buffer);return QY(v,rn[a.dtype],k,x,b,h.batchSize,I,w),t.disposeData(p.dataId),t.disposeData(g.dataId),y.shape=h.outputShape,y}var HYe={kernelName:pg,backendName:"wasm",setupFunc:WYe,kernelFunc:VYe},GYe=!1,qYe=yr(mg,GYe,"bool"),KYe=!1,QYe=yr(Mh,KYe,"bool"),XYe=Jt(Fh,"bool"),YYe=Jt(Ph,"bool"),JYe=Jt(Lh,"bool"),XY;function ZYe(e){XY=e.wasm.cwrap(zh,null,["number","number","number","number"])}function eJe(e){let{inputs:{x:t},attrs:{alpha:n},backend:r}=e,a=r.dataIdMap.get(t.dataId).id,s=r.makeOutput(t.shape,"float32");if(j.sizeFromShape(t.shape)!==0){let i=r.dataIdMap.get(s.dataId).id;XY(a,rn[t.dtype],n,i)}return s}var tJe={kernelName:zh,backendName:"wasm",setupFunc:ZYe,kernelFunc:eJe},nJe=!1,rJe=yr(gg,nJe,"bool"),aJe=!1,sJe=yr(yg,aJe,"bool"),YY;function iJe(e){YY=e.wasm.cwrap(xg,null,["number","number","number","number"])}function oJe(e){let{attrs:t,backend:n}=e,{start:r,stop:a,num:s}=t,i=Math.floor(s),o=n.makeOutput([i],"float32");return YY(n.dataIdMap.get(o.dataId).id,r,a,i),o}var lJe={kernelName:xg,backendName:"wasm",setupFunc:iJe,kernelFunc:oJe},uJe=Jt(Bh),cJe=Jt(Uh),dJe=!1,hJe=yr(vg,dJe,"bool"),pJe=Jt(bg),fJe=!1,mJe=yr(wg,fJe,"bool"),gJe=!1,yJe=yr(XG,gJe,"bool"),JY;function xJe(e){JY=e.wasm.cwrap(Wh,null,["number","number","number","number","number","number","number"])}function vJe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:s,bias:i,alpha:o,beta:l}=r;if(a.dtype!=="float32")throw new Error("LRN error: x must have dtype float32");let c=n.makeOutput(a.shape,a.dtype);return JY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,a.shape[3],s,i,o,l),c}var bJe={kernelName:Wh,backendName:"wasm",setupFunc:xJe,kernelFunc:vJe},ZY;function wJe(e){ZY=e.wasm.cwrap(Ng,null,["number","number","number","number","number","number","number","number","number"])}function NJe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:s,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r;if(a.dtype!=="float32"||s.dtype!=="float32"||i.dtype!=="float32")throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let h=n.makeOutput(a.shape,a.dtype);return ZY(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(h.dataId).id,i.shape[3],o,l,c,u),h}var kJe={kernelName:Ng,backendName:"wasm",setupFunc:wJe,kernelFunc:NJe},eJ;function SJe(e){eJ=e.wasm.cwrap(Vh,null,["number","number","number","number"])}function _Je(e){let{backend:t,inputs:n,attrs:r}=e,{reductionIndices:a,keepDims:s}=r,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=i,{transposed:c,axes:u,originalAxes:h,inputWasTransposed:p}=Cc(i,a,t);if(p){let v=t.dataIdMap.get(c.dataId).id;l=c,o=v}let f=l.shape.length;P.assertAxesAreInnerMostDims("max",u,f);let[g,m]=P.computeOutAndReduceShapes(l.shape,u),y=j.sizeFromShape(m),x=t.makeOutput(g,i.dtype);if(j.sizeFromShape(l.shape)!==0){let v=t.dataIdMap.get(x.dataId).id;eJ(o,rn[i.dtype],y,v)}if(p&&t.disposeData(c.dataId),s){let v=P.expandShapeToKeepDim(x.shape,h);x.shape=v}return x}var CJe={kernelName:Vh,backendName:"wasm",setupFunc:SJe,kernelFunc:_Je},IJe=yr(Hh),tJ;function EJe(e){tJ=e.wasm.cwrap(Gh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function TJe(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,s=r.dataIdMap.get(a.dataId).id;j.assert(a.dtype==="float32",()=>`Error in MaxPool: only float32 input is supported. Got ${a.dtype}.`);let{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=n,u=P.computePool2DInfo(a.shape,i,o,1,l,c),h=u.filterHeight,p=u.filterWidth,f=u.padInfo.top,g=u.padInfo.right,m=u.padInfo.bottom,y=u.padInfo.left,x=u.dilationHeight,v=u.dilationWidth,b=u.strideHeight,w=u.strideWidth,k=u.inChannels,I=u.outChannels;if(u.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${u.dataFormat}'. Please use 'channelsLast'.`);let C=r.makeOutput(u.outShape,"float32"),S=r.dataIdMap.get(C.dataId).id;return tJ(s,a.shape[0],a.shape[1],a.shape[2],h,p,f,g,m,y,x,v,b,w,k,I,S),C}var jJe={kernelName:Gh,backendName:"wasm",setupFunc:EJe,kernelFunc:TJe},nJ;function AJe(e){nJ=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function $Je(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=P.computePool3DInfo(a.shape,s,i,1,o,l,c),h=n.makeOutput(u.outShape,a.dtype);return nJ(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(h.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),h}var RJe={kernelName:kg,backendName:"wasm",setupFunc:AJe,kernelFunc:$Je},rJ;function DJe(e){rJ=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function MJe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=r,u=P.computePool3DInfo(s.shape,i,o,1,l,c),h=n.makeOutput(s.shape,s.dtype);return rJ(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(h.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),h}var OJe={kernelName:nb,backendName:"wasm",setupFunc:DJe,kernelFunc:MJe},aJ;function FJe(e){aJ=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function PJe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=r,u=P.computePool2DInfo(s.shape,i,o,1,l,c),h=n.makeOutput(s.shape,s.dtype);return aJ(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(h.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),h}var LJe={kernelName:tb,backendName:"wasm",setupFunc:FJe,kernelFunc:PJe},sJ;function zJe(e){sJ=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function BJe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:l}=r;j.assert(a.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.shape.length}.`);let c=[1,1];j.assert(P.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=P.computePool2DInfo(a.shape,s,i,[1,1],o),h=n.makeOutput(u.outShape,a.dtype),p=n.makeOutput(u.outShape,"int32");return sJ(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(h.dataId).id,n.dataIdMap.get(p.dataId).id,rn[a.dtype],l,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),[h,p]}var UJe={kernelName:rb,backendName:"wasm",setupFunc:zJe,kernelFunc:BJe},iJ;function WJe(e){iJ=e.wasm.cwrap(qh,null,["number, number, number"])}function VJe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:h,originalAxes:p,inputWasTransposed:f}=Cc(i,a,t),g=h;if(f){let w=t.dataIdMap.get(u.dataId).id;w!==o&&(c=u,l=w,g=P.getInnerMostAxes(g.length,c.shape.length))}P.assertAxesAreInnerMostDims("mean",g,c.shape.length);let[m,y]=P.computeOutAndReduceShapes(c.shape,g),x=j.sizeFromShape(y),v=c;c.dtype!=="float32"&&(v=Ic({backend:t,inputs:{x:c},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(v.dataId).id);let b=t.makeOutput(m,"float32");if(j.sizeFromShape(c.shape)!==0){let w=t.dataIdMap.get(b.dataId).id;iJ(l,x,w)}if(f&&t.disposeData(u.dataId),s){let w=P.expandShapeToKeepDim(b.shape,p);b.shape=w}return c.dtype!=="float32"&&t.disposeData(v.dataId),b}var HJe={kernelName:qh,backendName:"wasm",setupFunc:WJe,kernelFunc:VJe},oJ;function GJe(e){oJ=e.wasm.cwrap(Kh,null,["number","number","number","number"])}function qJe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:h,originalAxes:p,inputWasTransposed:f}=Cc(i,a,t);if(f){let b=t.dataIdMap.get(u.dataId).id;b!==o&&(c=u,l=b)}let g=c.shape.length;P.assertAxesAreInnerMostDims("min",h,g);let[m,y]=P.computeOutAndReduceShapes(c.shape,h),x=j.sizeFromShape(y),v=t.makeOutput(m,c.dtype);if(j.sizeFromShape(c.shape)!==0){let b=t.dataIdMap.get(v.dataId).id;oJ(l,rn[i.dtype],x,b)}if(f&&t.disposeData(u.dataId),s){let b=P.expandShapeToKeepDim(v.shape,p);v.shape=b}return v}var KJe={kernelName:Kh,backendName:"wasm",setupFunc:GJe,kernelFunc:qJe},QJe=yr(Qh),FE;(function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"})(FE||(FE={}));var lJ;function XJe(e){lJ=e.wasm.cwrap(Xh,null,["number","array","number","number","array","array","number","number"])}function YJe(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,mode:a}}=e,s=r.map((g,m)=>g[0]+t.shape[m]+g[1]),i=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(s,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=r.map(g=>g[0]),h=r.map(g=>g[1]),p=new Uint8Array(new Int32Array(u).buffer),f=new Uint8Array(new Int32Array(h).buffer);return lJ(i,c,t.shape.length,rn[t.dtype],p,f,FE[a],l),o}var JJe={kernelName:Xh,backendName:"wasm",kernelFunc:YJe,setupFunc:XJe},uJ;function ZJe(e){uJ=e.wasm.cwrap(bp,null,["number","number","number","number"])}function cJ(e){let{backend:t,inputs:{logits:n},attrs:{dim:r}}=e,a=t.dataIdMap.get(n.dataId).id,s=t.makeOutput(n.shape,n.dtype),i=t.dataIdMap.get(s.dataId).id,o=n.shape[r],l=j.sizeFromShape(n.shape)/o;return j.sizeFromShape(s.shape)===0||uJ(a,i,o,l),s}var eZe={kernelName:bp,backendName:"wasm",setupFunc:ZJe,kernelFunc:cJ},dJ;function tZe(e){dJ=e.wasm.cwrap(Sg,null,["number","number","number","number","number","number"])}function nZe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:s,seed:i,normalized:o}=r;if(a.dtype!=="float32")throw new Error(`Tensor logits must have dtype float32, got ${a.dtype}`);let l=o?a:cJ({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),[c,u]=l.shape,h=n.makeOutput([c,s],"int32");return dJ(n.dataIdMap.get(l.dataId).id,c,u,s,i,n.dataIdMap.get(h.dataId).id),o||n.disposeData(l.dataId),h}var rZe={kernelName:Sg,backendName:"wasm",setupFunc:tZe,kernelFunc:nZe},aZe=yr(Yh),sZe=yr(Jh),iZe=Jt(_g);function lM(e,t){let n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),r=n[0],a=n[1],s=n[2],i=n[3];return e.wasm._free(t),{pSelectedIndices:r,selectedSize:a,pSelectedScores:s,pValidOutputs:i}}var hJ;function oZe(e){hJ=e.wasm.cwrap(Ig,"number",["number","number","number","number","number"])}function lZe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:i}=r,{boxes:o,scores:l}=n,c=t.dataIdMap.get(o.dataId).id,u=t.dataIdMap.get(l.dataId).id,h=hJ(c,u,s,a,i),{pSelectedIndices:p,selectedSize:f,pSelectedScores:g,pValidOutputs:m}=lM(t,h);return t.wasm._free(g),t.wasm._free(m),t.makeOutput([f],"int32",p)}var uZe={kernelName:Ig,backendName:"wasm",setupFunc:oZe,kernelFunc:lZe},pJ;function cZe(e){pJ=e.wasm.cwrap(Eg,"number",["number","number","number","number","number","bool"])}function dZe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:i,padToMaxOutputSize:o}=r,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,h=t.dataIdMap.get(c.dataId).id,p=pJ(u,h,s,a,i,o),{pSelectedIndices:f,selectedSize:g,pSelectedScores:m,pValidOutputs:y}=lM(t,p);t.wasm._free(m);let x=t.makeOutput([g],"int32",f),v=t.makeOutput([],"int32",y);return[x,v]}var hZe={kernelName:Eg,backendName:"wasm",setupFunc:cZe,kernelFunc:dZe},fJ;function pZe(e){fJ=e.wasm.cwrap(Tg,"number",["number","number","number","number","number","number"])}function fZe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:i,softNmsSigma:o}=r,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,h=t.dataIdMap.get(c.dataId).id,p=fJ(u,h,s,a,i,o),{pSelectedIndices:f,selectedSize:g,pSelectedScores:m,pValidOutputs:y}=lM(t,p);t.wasm._free(y);let x=t.makeOutput([g],"int32",f),v=t.makeOutput([g],"float32",m);return[x,v]}var mZe={kernelName:Tg,backendName:"wasm",setupFunc:pZe,kernelFunc:fZe},gZe=!1,yZe=yr(Cg,gZe,"bool"),mJ;function xZe(e){mJ=e.wasm.cwrap(Zh,null,["number","number","number","number","number"])}function vZe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:s,depth:i,onValue:o,offValue:l}=r,c=n.makeOutput([...a.shape,i],s),u=n.dataIdMap.get(c.dataId).id,h=n.dataIdMap.get(a.dataId).id;return mJ(h,i,o,l,u),c}var bZe={kernelName:Zh,backendName:"wasm",setupFunc:xZe,kernelFunc:vZe};function wZe(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(1),r}var NZe={kernelName:jg,backendName:"wasm",kernelFunc:wZe};function kZe(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return OE({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let s=t[0].shape,i=t[0].dtype;t.forEach(u=>{j.assertShapesMatch(s,u.shape,"All tensors passed to stack must have matching shapes"),j.assert(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let h=OE({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(h),h}),c=CY({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeData(u.dataId)),c}var SZe={kernelName:Ag,backendName:"wasm",kernelFunc:kZe},gJ;function _Ze(e){gJ=e.wasm.cwrap(ep,null,["number","array","number","number","array","array","number","number"])}function CZe(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,constantValue:a}}=e,s=r.map((g,m)=>g[0]+t.shape[m]+g[1]);if(j.sizeFromShape(t.shape)===0)return WY({backend:n,attrs:{shape:s,value:a,dtype:t.dtype}});let i=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(s,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=r.map(g=>g[0]),h=r.map(g=>g[1]),p=new Uint8Array(new Int32Array(u).buffer),f=new Uint8Array(new Int32Array(h).buffer);return gJ(i,c,t.shape.length,rn[t.dtype],p,f,a,l),o}var yJ={kernelName:ep,backendName:"wasm",kernelFunc:CZe,setupFunc:_Ze},IZe=yr(tp),xJ;function EZe(e){xJ=e.wasm.cwrap(np,null,["number","number","number"])}function TZe(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,s=n.dataIdMap.get(r.dataId).id,i=n.dataIdMap.get(a.dataId).id,o=s,l=r,c=l;l.dtype!=="float32"&&(c=Ic({backend:n,inputs:{x:r},attrs:{dtype:"float32"}}),o=n.dataIdMap.get(c.dataId).id);let u=n.makeOutput(r.shape,"float32"),h=n.dataIdMap.get(u.dataId).id;return xJ(o,i,h),l.dtype!=="float32"&&n.disposeData(c.dataId),u}var jZe={kernelName:np,backendName:"wasm",setupFunc:EZe,kernelFunc:TZe},vJ;function AZe(e){vJ=e.wasm.cwrap(rp,null,["number","number","number","number"])}function $Ze(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:h,originalAxes:p,inputWasTransposed:f}=Cc(i,a,t),g=h;if(f){let b=t.dataIdMap.get(u.dataId).id;b!==o&&(c=u,l=b,g=P.getInnerMostAxes(g.length,c.shape.length))}P.assertAxesAreInnerMostDims("prod",g,c.shape.length);let[m,y]=P.computeOutAndReduceShapes(c.shape,g),x=j.sizeFromShape(y),v=t.makeOutput(m,c.dtype);if(j.sizeFromShape(c.shape)!==0){let b=t.dataIdMap.get(v.dataId).id;vJ(l,x,rn[v.dtype],b)}if(f&&t.disposeData(u.dataId),s){let b=P.expandShapeToKeepDim(v.shape,p);v.shape=b}return v}var RZe={kernelName:rp,backendName:"wasm",setupFunc:AZe,kernelFunc:$Ze},DZe=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:s,dtype:i}=n,o=OD(r,a,s,i),l=t.makeOutput([o.length],i);return t.typedArrayFromHeap(l).set(o),l},MZe={kernelName:ab,backendName:"wasm",kernelFunc:DZe},OZe=yr(Ih),FZe=Jt(ap),PZe=Jt(sp),LZe=Jt(lp),bJ;function zZe(e){bJ=e.wasm.cwrap(op,null,["number","number","number","number","number","number","number","number","number","number"])}function BZe(e){let{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:s,halfPixelCenters:i,size:o}=r,[l,c]=o,[u,h,p,f]=a.shape,g=[u,l,c,f],m=t.dataIdMap.get(a.dataId),y;m.dtype!=="float32"&&(y=Ic({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),m=t.dataIdMap.get(y.dataId));let x=m.id,v=t.makeOutput(g,"float32");if(j.sizeFromShape(a.shape)===0)return v;let b=t.dataIdMap.get(v.dataId).id;return bJ(x,u,h,p,f,l,c,s?1:0,i?1:0,b),y!=null&&t.disposeData(y.dataId),v}var UZe={kernelName:op,backendName:"wasm",setupFunc:zZe,kernelFunc:BZe},wJ;function WZe(e){wJ=e.wasm.cwrap(Dg,null,["number","number","number","array","array","boolean"])}function VZe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:s}=t,{alignCorners:i}=r,o=n.makeOutput(a.shape,"float32"),l=n.dataIdMap.get(a.dataId),c;return l.dtype!=="float32"&&(c=Ic({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(c.dataId)),wJ(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),i),c!=null&&n.disposeData(c.dataId),o}var HZe={kernelName:Dg,backendName:"wasm",setupFunc:WZe,kernelFunc:VZe},NJ;function GZe(e){NJ=e.wasm.cwrap(ip,null,["number","number","number","number","number","number","number","number","number","number"])}function qZe(e){let{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:s,halfPixelCenters:i,size:o}=r,[l,c]=o,[u,h,p,f]=a.shape,g=[u,l,c,f],m=t.makeOutput(g,"float32");if(j.sizeFromShape(a.shape)===0)return m;let y=t.dataIdMap.get(a.dataId),x;y.dtype!=="float32"&&(x=Ic({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),y=t.dataIdMap.get(x.dataId));let v=y.id,b=t.dataIdMap.get(m.dataId).id;return NJ(v,u,h,p,f,l,c,s?1:0,i?1:0,b),x!=null&&t.disposeData(x.dataId),m}var KZe={kernelName:ip,backendName:"wasm",setupFunc:GZe,kernelFunc:qZe},kJ;function QZe(e){kJ=e.wasm.cwrap(Rg,null,["number","number","number","array","array","boolean"])}function XZe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:s}=t,{alignCorners:i}=r,o=n.makeOutput(a.shape,"float32"),l=n.dataIdMap.get(a.dataId),c;return l.dtype!=="float32"&&(c=Ic({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(c.dataId)),kJ(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),i),c!=null&&n.disposeData(c.dataId),o}var YZe={kernelName:Rg,backendName:"wasm",setupFunc:QZe,kernelFunc:XZe},SJ;function JZe(e){SJ=e.wasm.cwrap(up,null,["number","array","number","array","number","number"])}function ZZe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:s}=r,i=j.parseAxisParam(s,a.shape);if(a.shape.length===0)return YS({inputs:{x:a},backend:n});let o=n.makeOutput(a.shape,a.dtype),l=n.dataIdMap.get(a.dataId).id,c=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(i).buffer),h=new Uint8Array(new Int32Array(a.shape).buffer);SJ(l,u,i.length,h,a.shape.length,c);let p=Ba({inputs:{x:o},attrs:{shape:a.shape},backend:n});return n.disposeData(o.dataId),p}var eet={kernelName:up,backendName:"wasm",kernelFunc:ZZe,setupFunc:JZe},_J;function tet(e){_J=e.wasm.cwrap(Qg,null,["number","number","number","number","number","number","number","number","array","number","number"])}function net(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{radians:s,fillValue:i,center:o}=r,l=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(l.dataId).id,[h,p,f,g]=a.shape,[m,y]=P.getImageCenter(o,p,f),x=i===0,v=255,b=typeof i=="number"?[i,i,i,x?0:v]:[...i,v],w=new Uint8Array(new Int32Array(b).buffer);return _J(c,h,p,f,g,s,m,y,w,b.length,u),l}var ret={kernelName:Qg,backendName:"wasm",kernelFunc:net,setupFunc:tet},aet=Jt(cp),set=Jt(dp),CJ;function iet(e){CJ=e.wasm.cwrap(Mg,null,["number","number","number","number","number","number","array","number","number"])}function oet(e){let{backend:t,inputs:n,attrs:r}=e,{indices:a,updates:s}=n,{shape:i}=r,o=t.makeOutput(i,s.dtype);if(j.sizeFromShape(i)===0)return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:p}=pS.calculateShapes(s,a,i),f=t.dataIdMap.get(a.dataId).id,g=t.dataIdMap.get(s.dataId).id,m=new Uint8Array(new Int32Array(h).buffer),y=t.dataIdMap.get(o.dataId).id;return CJ(f,g,rn[s.dtype],l,c,u,m,p,y),o}var uet={kernelName:Mg,backendName:"wasm",setupFunc:iet,kernelFunc:oet},IJ;function cet(e){IJ=e.wasm.cwrap(Fg,null,["number","number","number","number","number","number","bool","number"])}function det(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:s}=t,{side:i}=r;if(a.dtype!==s.dtype)throw new Error(`SearchSorted error: sorted_sequence must have the same dtype as values. Got ${a.dtype} and ${s.dtype}`);let o=n.makeOutput(s.shape,"int32");function l(c){return n.dataIdMap.get(c.dataId).id}return IJ(l(a),l(s),a.shape[0],a.shape[1],s.shape[1],rn[a.dtype],i==="left",l(o)),o}var het={kernelName:Fg,backendName:"wasm",setupFunc:cet,kernelFunc:det},EJ;function pet(e){EJ=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function fet(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:s}=t,i=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id,l=n.dataIdMap.get(s.dataId).id,c=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(c.dataId).id,h=r.shape.length,p=a.shape.length,f=h===0||h>1||p===1?1:j.sizeFromShape(a.shape.slice(1));return EJ(i,o,l,f,u),c}var met={kernelName:Pg,backendName:"wasm",kernelFunc:fet,setupFunc:pet},get=Jt(hp),TJ;function yet(e){TJ=e.wasm.cwrap(gp,null,["number","number"])}function xet(e){let{backend:t,inputs:{x:n}}=e,r=t.dataIdMap.get(n.dataId).id,a=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(a.dataId).id;return j.sizeFromShape(a.shape)===0||TJ(r,s),a}var vet={kernelName:"Sigmoid",backendName:"wasm",setupFunc:yet,kernelFunc:xet},bet=Jt(mp),wet=Jt(pp),Net=Jt(fp),ket=Jt(yp);function _et(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,paddings:i}=r,o=j.sizeFromShape(s),l=[[0,0]];l.push(...i);for(let y=1+s.length;y<a.shape.length;++y)l.push([0,0]);let c=yJ.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),u=P.getReshaped(c.shape,s,o,!1),h=P.getPermuted(u.length,s.length,!1),p=P.getReshapedPermuted(c.shape,s,o,!1),f=Ba({inputs:{x:c},backend:n,attrs:{shape:u}}),g=nc({inputs:{x:f},backend:n,attrs:{perm:h}}),m=Ba({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeData(c.dataId),n.disposeData(f.dataId),n.disposeData(g.dataId),m}var Cet={kernelName:zg,backendName:"wasm",kernelFunc:_et},jJ;function Iet(e){jJ=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])}function Eet(e){let{backend:t,inputs:n}=e,{indices:r,values:a,denseShape:s,defaultValue:i}=n,o=r.shape[0],l=r.shape[1],c=t.readSync(s.dataId)[0],u=[o+c,l],h=t.dataIdMap.get(r.dataId).id,p=t.dataIdMap.get(a.dataId).id,f=t.dataIdMap.get(i.dataId).id,g=t.makeOutput(u,r.dtype),m=t.dataIdMap.get(g.dataId).id,y=t.makeOutput(u.slice(0,1),a.dtype),x=t.dataIdMap.get(y.dataId).id,v=t.makeOutput([c],"bool"),b=t.dataIdMap.get(v.dataId).id,w=t.makeOutput([o],r.dtype),k=t.dataIdMap.get(w.dataId).id,I=t.makeOutput([4],"int32"),C=t.dataIdMap.get(I.dataId).id,S=jJ(h,p,rn[a.dtype],o,c,l,f,m,x,b,k,C),E=t.readSync(I.dataId),T;switch(E[0]){case 1:{T=P.getSparseFillEmptyRowsIndicesDenseShapeMismatch(E[1]);break}case 2:{T=P.getSparseFillEmptyRowsNegativeIndexErrorMessage(E[1],E[2]);break}case 3:T=P.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(E[1],E[2],E[3]);break;default:T=""}if(t.disposeData(I.dataId),T)throw t.disposeData(g.dataId),t.disposeData(y.dataId),t.disposeData(v.dataId),t.disposeData(w.dataId),new Error(T);let $=g,_=y;return S!==u[0]&&($=Xd({inputs:{x:g},attrs:{begin:0,size:[S,l]},backend:t}),_=Xd({inputs:{x:y},attrs:{begin:0,size:S},backend:t}),t.disposeData(g.dataId),t.disposeData(y.dataId)),[$,_,v,w]}var Tet={kernelName:sb,backendName:"wasm",setupFunc:Iet,kernelFunc:Eet},AJ;function jet(e){AJ=e.wasm.cwrap(Ug,null,["number","number","number","number","number","number","number"])}function Aet(e){let{backend:t,inputs:n}=e,{inputIndices:r,inputShape:a,newShape:s}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=t.dataIdMap.get(r.dataId).id,o=t.dataIdMap.get(a.dataId).id,l=t.dataIdMap.get(s.dataId).id,c=r.shape[0],u=j.sizeFromShape(s.shape),h=t.makeOutput([c,u],r.dtype),p=t.dataIdMap.get(h.dataId).id,f=t.makeOutput([u],s.dtype),g=t.dataIdMap.get(f.dataId).id,m=t.makeOutput([3],"int32"),y=t.dataIdMap.get(m.dataId).id;AJ(i,o,l,c,p,g,y);let x=t.readSync(m.dataId),v;switch(x[0]){case 0:{v=P.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(x[1],x[2]);break}case 1:{v=P.getSparseReshapeNegativeOutputDimErrorMessage(x[1],x[2]);break}case 2:v=P.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let b=Array.from(t.readSync(a.dataId)),w=Array.from(t.readSync(f.dataId));v=P.getSparseReshapeInputOutputMultipleErrorMessage(b,w);break}case 4:{let b=Array.from(t.readSync(a.dataId)),w=Array.from(t.readSync(f.dataId));v=P.getSparseReshapeInputOutputMismatchErrorMessage(b,w);break}default:v=""}if(t.disposeData(m.dataId),v)throw t.disposeData(h.dataId),t.disposeData(f.dataId),new Error(v);return[h,f]}var $et={kernelName:Ug,backendName:"wasm",setupFunc:jet,kernelFunc:Aet},$J;function RJ(e){$J=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function DJ(e,t){let{backend:n,inputs:r}=e,{data:a,indices:s,segmentIds:i}=r,o=s.shape[0],l=n.readSync(i.dataId,o-1,o)[0],c=o>0?l+1:0;if(c<0)throw new Error(P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let u=a.shape.slice();u[0]=c;let h=n.dataIdMap.get(a.dataId).id,p=n.dataIdMap.get(s.dataId).id,f=n.dataIdMap.get(i.dataId).id,g=n.makeOutput(u,a.dtype),m=n.dataIdMap.get(g.dataId).id,y=n.makeOutput([4],"int32"),x=n.dataIdMap.get(y.dataId).id;$J(h,rn[a.dtype],a.shape[0],p,f,m,x,t,0);let v=n.readSync(y.dataId),b;switch(v[0]){case 0:{b=P.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break}case 1:{b=P.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break}case 2:b=P.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(v[1],v[2]);break;case 3:b=P.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v[1],v[2],v[3]);break;default:b=""}if(n.disposeData(y.dataId),b)throw n.disposeData(g.dataId),new Error(b);return g}function Ret(e){return DJ(e,!0)}var Det={kernelName:ib,backendName:"wasm",setupFunc:RJ,kernelFunc:Ret};function Met(e){return DJ(e,!1)}var Oet={kernelName:ob,backendName:"wasm",setupFunc:RJ,kernelFunc:Met},MJ;function Fet(e){MJ=e.wasm.cwrap(Wg,null,["number","number","number","number","number","number","number","number","array","number","number"])}function Pet(e){let{backend:t,inputs:n,attrs:r}=e,{sparseIndices:a,sparseValues:s,defaultValue:i}=n,{outputShape:o}=r,l=t.makeOutput(o,i.dtype);if(j.sizeFromShape(o)===0)return l;let{sliceRank:c,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=P.calculateShapes(s,a,o),g=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(s.dataId).id,y=t.dataIdMap.get(i.dataId).id,x=new Uint8Array(new Int32Array(p).buffer),v=t.dataIdMap.get(l.dataId).id;return MJ(g,m,s.shape.length,y,rn[i.dtype],c,u,h,x,f,v),l}var Let={kernelName:Wg,backendName:"wasm",setupFunc:Fet,kernelFunc:Pet};function zet(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{numOrSizeSplits:s,axis:i}=n,o=j.parseAxisParam(i,a.shape)[0],l=P.prepareSplitSize(a,s,o),c=new Array(a.shape.length).fill(0),u=a.shape.slice();return l.map(h=>{let p=[...u];p[o]=h;let f=Xd({inputs:{x:a},attrs:{begin:c,size:p},backend:r});return c[o]+=h,f})}var Bet={kernelName:Bg,backendName:"wasm",kernelFunc:zet},Uet=Jt(xp),Wet=Jt(lb),Vet=yr(wp),OJ;function Het(e){OJ=e.wasm.cwrap(xc,null,["number","number","number","number"])}function Get(e){let{backend:t,inputs:n,attrs:r}=e,{alpha:a}=r,{x:s}=n,i=t.dataIdMap.get(s.dataId).id,o=t.makeOutput(s.shape,s.dtype),l=t.dataIdMap.get(o.dataId).id;return OJ(i,a,rn[s.dtype],l),o}var qet={kernelName:xc,backendName:"wasm",setupFunc:Het,kernelFunc:Get},FJ;function Ket(e){FJ=e.wasm.cwrap(Vg,null,["number","array","number","array","array","array","array","array","number","number"])}function Qet(e){let{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{begin:s,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:g,isIdentity:m,sliceDim0:y,isSimpleSlice:x,begin:v,end:b,strides:w}=wr.sliceInfo(a.shape,s,i,o,l,c,u,h,p),k;if(m)k=Ba({inputs:{x:a},backend:t,attrs:{shape:g}});else if(y||x){j.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let I=wr.computeOutShape(v,b,w),C=Xd({inputs:{x:a},backend:t,attrs:{begin:v,size:I}});k=Ba({inputs:{x:C},backend:t,attrs:{shape:g}}),t.disposeData(C.dataId)}else{let I=t.makeOutput(f,"float32"),C=t.dataIdMap.get(a.dataId).id,S=new Uint8Array(new Int32Array(j.computeStrides(a.shape)).buffer),E=new Uint8Array(new Int32Array(v).buffer),T=new Uint8Array(new Int32Array(b).buffer),$=new Uint8Array(new Int32Array(w).buffer),_=new Uint8Array(new Int32Array(f).buffer),M=new Uint8Array(new Int32Array(j.computeStrides(f)).buffer),L=t.dataIdMap.get(I.dataId).id;FJ(C,S,a.shape.length,E,T,$,_,M,f.length,L),k=Ba({inputs:{x:I},backend:t,attrs:{shape:g}}),t.disposeData(I.dataId)}return k}var Xet={kernelName:Vg,backendName:"wasm",setupFunc:Ket,kernelFunc:Qet};function Yet(e){let{backend:t,inputs:n,attrs:r}=e,{data:a,dataSplits:s}=n,{separator:i,nGramWidths:o,leftPad:l,rightPad:c,padWidth:u,preserveShortSequences:h}=r,p=t.readSync(a.dataId),f=t.readSync(s.dataId),[g,m]=PD(p,f,i,o,l,c,u,h),y=t.makeOutput([g.length],"string"),x=t.dataIdMap.get(y.dataId);x.stringBytes=g;let v=t.makeOutput(s.shape,"int32");return t.typedArrayFromHeap(v).set(m),[y,v]}var Jet={kernelName:cb,backendName:"wasm",kernelFunc:Yet};function Zet(e){let{backend:t,inputs:n,attrs:r}=e,{input:a,delimiter:s}=n,{skipEmpty:i}=r,o=t.readSync(a.dataId),l=t.readSync(s.dataId),[c,u,h]=LD(o,l[0],i),p=u.length,f=t.makeOutput([p,2],"int32");t.typedArrayFromHeap(f).set(c);let g=t.makeOutput([p],"string"),m=t.dataIdMap.get(g.dataId);m.stringBytes=u;let y=t.makeOutput([2],"int32");return t.typedArrayFromHeap(y).set(h),[f,g,y]}var ett={kernelName:db,backendName:"wasm",kernelFunc:Zet};function ttt(e){let{backend:t,inputs:n,attrs:r}=e,{input:a}=n,{numBuckets:s}=r,i=t.readSync(a.dataId),o=zD(i,s),l=t.makeOutput(a.shape,"int32");return t.typedArrayFromHeap(l).set(o),l}var ntt={kernelName:hb,backendName:"wasm",kernelFunc:ttt},rtt=yr(Np),PJ;function att(e){PJ=e.wasm.cwrap(vp,null,["number","number","number","number"])}function stt(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:i}=n,o=t.dataIdMap.get(i.dataId).id,l=o,c=i,{transposed:u,axes:h,originalAxes:p,inputWasTransposed:f}=Cc(i,a,t),g=h;if(f){let b=t.dataIdMap.get(u.dataId).id;b!==o&&(c=u,l=b,g=P.getInnerMostAxes(g.length,c.shape.length))}P.assertAxesAreInnerMostDims("sum",g,c.shape.length);let[m,y]=P.computeOutAndReduceShapes(c.shape,g),x=j.sizeFromShape(y),v=t.makeOutput(m,c.dtype);if(j.sizeFromShape(c.shape)!==0){let b=t.dataIdMap.get(v.dataId).id;PJ(l,x,rn[v.dtype],b)}if(f&&t.disposeData(u.dataId),s){let b=P.expandShapeToKeepDim(v.shape,p);v.shape=b}return v}var itt={kernelName:vp,backendName:"wasm",setupFunc:att,kernelFunc:stt},ott=Jt(kp),ltt=Jt(Sp),LJ;function utt(e){LJ=e.wasm.cwrap(Og,null,["number","number","number","number","number","number","array","number","number","number"])}function ctt(e){let{backend:t,inputs:n,attrs:r}=e,{tensor:a,indices:s,updates:i}=n,o=t.makeOutput(a.shape,a.dtype);if(j.sizeFromShape(a.shape)===0)return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:p}=pS.calculateShapes(i,s,a.shape),f=t.dataIdMap.get(s.dataId).id,g=t.dataIdMap.get(i.dataId).id,m=t.dataIdMap.get(a.dataId).id,y=new Uint8Array(new Int32Array(h).buffer),x=t.dataIdMap.get(o.dataId).id;return LJ(f,g,rn[i.dtype],l,c,u,y,p,x,m),o}var dtt={kernelName:Og,backendName:"wasm",setupFunc:utt,kernelFunc:ctt},zJ;function htt(e){zJ=e.wasm.cwrap(yc,null,["number","array","number","array","number","number"])}function ptt(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,s=n.dataIdMap.get(a.dataId).id,{reps:i}=r,o=new Array(a.shape.length);for(let p=0;p<o.length;p++)o[p]=a.shape[p]*i[p];let l=new Uint8Array(new Int32Array(a.shape).buffer),c=new Uint8Array(new Int32Array(o).buffer),u=n.makeOutput(o,a.dtype),h=n.dataIdMap.get(u.dataId).id;return zJ(s,l,a.shape.length,c,o.length,rn[u.dtype],h),u}var ftt={kernelName:yc,backendName:"wasm",setupFunc:htt,kernelFunc:ptt},BJ;function mtt(e){BJ=e.wasm.cwrap(Hg,null,["number","array","number","number","number","bool","number","number"])}var gtt=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{k:a,sorted:s}=n,i=t.dataIdMap.get(r.dataId).id,o=new Uint8Array(new Int32Array(r.shape).buffer),l=r.shape.slice();l[l.length-1]=a;let c=t.makeOutput(l,r.dtype),u=t.dataIdMap.get(c.dataId).id,h=t.makeOutput(l,"int32"),p=t.dataIdMap.get(h.dataId).id;return BJ(i,o,r.shape.length,rn[r.dtype],a,s,u,p),[c,h]},ytt={kernelName:Hg,backendName:"wasm",setupFunc:mtt,kernelFunc:gtt},UJ;function xtt(e){UJ=e.wasm.cwrap(Gg,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])}function vtt(e){let{backend:t,inputs:n,attrs:r}=e,{image:a,transforms:s}=n,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=r,[u,h,p,f]=a.shape,[g,m]=c??[h,p],y=[u,g,m,f],x=new Uint8Array(new Int32Array(j.computeStrides(a.shape)).buffer),v=new Uint8Array(new Int32Array(j.computeStrides(y)).buffer),b=t.makeOutput(y,a.dtype),w=t.dataIdMap.get(b.dataId).id,k=t.dataIdMap.get(a.dataId).id,I=t.dataIdMap.get(s.dataId).id,C=i==="nearest"?1:2,S;switch(o){case"constant":S=1;break;case"reflect":S=2;break;case"wrap":S=3;break;case"nearest":S=4;break;default:S=1;break}return UJ(k,I,s.shape[0]>1,u,g,m,f,p,h,x,a.shape.length-1,v,y.length-1,C,S,l,w),b}var btt={kernelName:Gg,backendName:"wasm",setupFunc:xtt,kernelFunc:vtt};function wtt(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:s}=t,{outputValues:i,outputShape:o,indices:l}=UD(r.readSync(s.dataId),a,s.shape,s.dtype);return[r.makeOutput(o,s.dtype,void 0,i),r.makeOutput([l.length],"int32",void 0,l)]}var Ntt={kernelName:pb,backendName:"wasm",kernelFunc:wtt};function ktt(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:s}=r;s<0&&(s+=a.shape.length);let i=a.shape[s],o=a.shape.length,l=new Array(o-1),c=0;for(let f=0;f<o;f++)f!==s&&(l[c++]=a.shape[f]);let u=new Array(i),h=new Array(o).fill(0),p=a.shape.slice();p[s]=1;for(let f=0;f<u.length;f++)h[s]=f,u[f]=Xd({inputs:{x:a},attrs:{begin:h,size:p},backend:n});return u.map(({dataId:f,dtype:g})=>({dataId:f,dtype:g,shape:l}))}var Stt={kernelName:qg,backendName:"wasm",kernelFunc:ktt};function _tt(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(0),r}var Ctt={kernelName:Kg,backendName:"wasm",kernelFunc:_tt},Itt=[gQe,yQe,xQe,vQe,bQe,kQe,AQe,DQe,MQe,OQe,FQe,PQe,LQe,zQe,BQe,VQe,ZQe,qQe,XQe,rXe,uXe,hXe,pXe,mXe,gXe,yXe,bXe,wXe,SXe,IXe,jXe,RXe,OXe,FXe,PXe,BXe,VXe,qXe,XXe,ZXe,nYe,sYe,lYe,dYe,fYe,mYe,xYe,bYe,wYe,NYe,kYe,SYe,_Ye,EYe,TYe,jYe,RYe,OYe,LYe,UYe,HYe,qYe,QYe,SQe,XYe,YYe,JYe,tJe,rJe,sJe,lJe,cJe,uJe,hJe,pJe,mJe,yJe,bJe,kJe,CJe,IJe,jJe,RJe,OJe,LJe,UJe,HJe,KJe,QJe,JJe,rZe,aZe,sZe,iZe,uZe,hZe,mZe,yZe,bZe,NZe,SZe,yJ,IZe,jZe,RZe,MZe,OZe,FZe,PZe,LZe,eXe,UZe,HZe,KZe,YZe,eet,ret,aet,set,uet,het,met,get,vet,bet,wet,Net,oXe,eZe,ket,Cet,Tet,$et,Det,Oet,Let,Bet,Uet,Wet,Vet,qet,Xet,Jet,ett,ntt,rtt,itt,ott,ltt,dtt,ftt,ytt,btt,EQe,Ntt,Stt,Ctt];for(let e of Itt)mb(e);var PE=le();PE.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch{return!1}});PE.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(PE.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}});var F3=fc(iNe()),Ett=fc(oNe()),P3=fc(lNe()),L3=F3.default||F3,Ttt=P3.default||P3,WJ=class extends Gv{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(VJ),LE=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new _k(this,Ys())}write(e,t,n){let r={id:this.dataIdNextNumber++};return this.move(r,e,t,n,1),r}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=j.now();return e(),{kernelMs:j.now()-t}}move(e,t,n,r,a){let s=this.dataIdNextNumber++;if(r==="string"){let c=t;this.dataIdMap.set(e,{id:s,stringBytes:c,shape:n,dtype:r,memoryOffset:null,refCount:a});return}let i=j.sizeFromShape(n),o=i*j.bytesPerElement(r),l=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:s,memoryOffset:l,shape:n,dtype:r,refCount:a}),this.wasm.tfjs.registerTensor(s,i,l),t!=null&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),l)}async read(e){return this.readSync(e)}readSync(e,t,n){let{memoryOffset:r,dtype:a,shape:s,stringBytes:i}=this.dataIdMap.get(e);if(a==="string")return(t==null||t===0)&&(n==null||n>=i.length)?i:i.slice(t,n);t=t||0,n=n||j.sizeFromShape(s);let o=j.bytesPerElement(a),l=this.wasm.HEAPU8.slice(r+t*o,r+n*o);return $tt(l.buffer,a)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);t!=null&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n,r){let a;if(n==null)a=this.write(r??null,e,t);else{let s=this.dataIdNextNumber++;a={id:s},this.dataIdMap.set(a,{id:s,memoryOffset:n,shape:e,dtype:t,refCount:1});let i=j.sizeFromShape(e);this.wasm.tfjs.registerTensor(s,i,n)}return{dataId:a,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:n}){let r=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(n),s=j.sizeFromShape(e);switch(t){case"float32":return new Float32Array(r,a,s);case"int32":return new Int32Array(r,a,s);case"bool":return new Uint8Array(r,a,s);default:throw new Error(`Unknown dtype ${t}`)}}};function jtt(e){return(t,n)=>(j.fetch(e,{credentials:"same-origin"}).then(r=>{r.ok||t.env.a(`failed to load wasm binary file at '${e}'`),r.arrayBuffer().then(a=>{WebAssembly.instantiate(a,t).then(s=>{n(s.instance,s.module)})})}),{})}function z3(e,t,n){if(aN!=null)return aN;let r="tfjs-backend-wasm.wasm";return e&&t?r="tfjs-backend-wasm-threaded-simd.wasm":e&&(r="tfjs-backend-wasm-simd.wasm"),vx!=null&&vx[r]!=null?vx[r]:n+r}async function Att(){let[e,t]=await Promise.all([le().getAsync("WASM_HAS_SIMD_SUPPORT"),le().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,r)=>{let a={};a.locateFile=(o,l)=>{if(o.endsWith(".worker.js")){let c=Ett.wasmWorkerContents.replace(/\n/g,"\\n"),u=new Blob([c],{type:"application/javascript"});return URL.createObjectURL(u)}return o.endsWith(".wasm")?z3(e,t,rx??l):l+o},uM&&(a.instantiateWasm=jtt(z3(e,t,rx??"")));let s=!1;a.onAbort=()=>{s||bx||(bx=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))};let i;t&&e&&aN==null?(a.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+L3.toString()],{type:"text/javascript"}),i=L3(a)):i=Ttt(a),i.then(o=>{s=!0,bx=!1;let l=null;o.tfjs={init:o.cwrap("init",null,[]),initWithThreadsCount:o.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:o.cwrap("get_threads_count","number",[]),registerTensor:o.cwrap("register_tensor",null,["number","number","number"]),disposeData:o.cwrap("dispose_data",l,["number"]),dispose:o.cwrap("dispose",l,[])},n({wasm:o})}).catch(r)})}function $tt(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}var Rtt=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],aN=null,rx=null,vx={},bx=!1,uM=!1;function Dtt(e,t=!1){if(d8("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),bx)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");aN=e,uM=t}function Mtt(e,t=!1){if(bx)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if(typeof e=="string")rx=e;else{vx=e;let n=Rtt.filter(r=>vx[r]==null);if(n.length>0)throw new Error(`There were no entries found for the following binaries: ${n.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}uM=t}var VJ=-1,LE=-1;function Ott(e){VJ=e}function Ftt(){if(LE===-1)throw new Error("WASM backend not initialized.");return LE}var Ptt="4.22.0",Ltt=2;Wk("wasm",async()=>{let{wasm:e}=await Att();return new WJ(e)},Ltt);var B3="4.22.0",ztt="4.22.0",Btt="4.22.0",Utt="4.22.0",Wtt="4.22.0",Vtt={tfjs:B3,"tfjs-core":B3,"tfjs-converter":ztt,"tfjs-backend-cpu":Btt,"tfjs-backend-webgl":Utt,"tfjs-backend-wasm":Wtt},Htt={};yA(Htt,{AnchorPosition:()=>sZ,DrawBox:()=>lZ,DrawBoxOptions:()=>oZ,DrawFaceLandmarks:()=>_Z,DrawFaceLandmarksOptions:()=>SZ,DrawTextField:()=>gM,DrawTextFieldOptions:()=>mM,drawContour:()=>ql,drawDetections:()=>snt,drawFaceExpressions:()=>vnt,drawFaceLandmarks:()=>Nnt});function ql(e,t,n=!1){if(e.beginPath(),t.slice(1).forEach(({x:r,y:a},s)=>{let i=t[s];e.moveTo(i.x,i.y),e.lineTo(r,a)}),n){let r=t[t.length-1],a=t[0];if(!r||!a)return;e.moveTo(r.x,r.y),e.lineTo(a.x,a.y)}e.stroke()}var Gtt={};yA(Gtt,{computeReshapedDimensions:()=>KJ,getCenterPoint:()=>dM,isDimensions:()=>BE,isEven:()=>zE,isFloat:()=>qJ,isTensor:()=>gy,isTensor1D:()=>qtt,isTensor2D:()=>GJ,isTensor3D:()=>Kb,isTensor4D:()=>pl,isValidNumber:()=>yd,isValidProbablitiy:()=>Ktt,range:()=>_m,round:()=>cM});var Rf=class HJ{constructor(t,n){if(!yd(t)||!yd(n))throw new Error(`Dimensions.constructor - expected width and height to be valid numbers, instead have ${JSON.stringify({width:t,height:n})}`);this._width=t,this._height=n}get width(){return this._width}get height(){return this._height}reverse(){return new HJ(1/this.width,1/this.height)}};function gy(e,t){return e instanceof Dt&&e.shape.length===t}function qtt(e){return gy(e,1)}function GJ(e){return gy(e,2)}function Kb(e){return gy(e,3)}function pl(e){return gy(e,4)}function qJ(e){return e%1!==0}function zE(e){return e%2===0}function cM(e,t=2){let n=10**t;return Math.floor(e*n)/n}function BE(e){return e&&e.width&&e.height}function KJ({width:e,height:t},n){let r=n/Math.max(t,e);return new Rf(Math.round(e*r),Math.round(t*r))}function dM(e){return e.reduce((t,n)=>t.add(n),new xn(0,0)).div(new xn(e.length,e.length))}function _m(e,t,n){return Array(e).fill(0).map((r,a)=>t+a*n)}function yd(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||e===0}function Ktt(e){return yd(e)&&e>=0&&e<=1}var xn=class Bc{constructor(t,n){this._x=t,this._y=n}get x(){return this._x}get y(){return this._y}add(t){return new Bc(this.x+t.x,this.y+t.y)}sub(t){return new Bc(this.x-t.x,this.y-t.y)}mul(t){return new Bc(this.x*t.x,this.y*t.y)}div(t){return new Bc(this.x/t.x,this.y/t.y)}abs(){return new Bc(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new Bc(Math.floor(this.x),Math.floor(this.y))}},Yd=class bi{static isRect(t){return!!t&&[t.x,t.y,t.width,t.height].every(yd)}static assertIsValidBox(t,n,r=!1){if(!bi.isRect(t))throw new Error(`${n} - invalid box: ${JSON.stringify(t)}, expected object with properties x, y, width, height`);if(!r&&(t.width<0||t.height<0))throw new Error(`${n} - width (${t.width}) and height (${t.height}) must be positive numbers`)}constructor(t,n=!0){let r=t||{},a=[r.left,r.top,r.right,r.bottom].every(yd),s=[r.x,r.y,r.width,r.height].every(yd);if(!s&&!a)throw new Error(`Box.constructor - expected box to be IBoundingBox | IRect, instead have ${JSON.stringify(r)}`);let[i,o,l,c]=s?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top];bi.assertIsValidBox({x:i,y:o,width:l,height:c},"Box.constructor",n),this._x=i,this._y=o,this._width=l,this._height=c}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new xn(this.left,this.top)}get topRight(){return new xn(this.right,this.top)}get bottomLeft(){return new xn(this.left,this.bottom)}get bottomRight(){return new xn(this.right,this.bottom)}round(){let[t,n,r,a]=[this.x,this.y,this.width,this.height].map(s=>Math.round(s));return new bi({x:t,y:n,width:r,height:a})}floor(){let[t,n,r,a]=[this.x,this.y,this.width,this.height].map(s=>Math.floor(s));return new bi({x:t,y:n,width:r,height:a})}toSquare(){let{x:t,y:n,width:r,height:a}=this,s=Math.abs(r-a);return r<a&&(t-=s/2,r+=s),a<r&&(n-=s/2,a+=s),new bi({x:t,y:n,width:r,height:a})}rescale(t){let n=BE(t)?t.width:t,r=BE(t)?t.height:t;return new bi({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})}pad(t,n){let[r,a,s,i]=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new bi({x:r,y:a,width:s,height:i})}clipAtImageBorders(t,n){let{x:r,y:a,right:s,bottom:i}=this,o=Math.max(r,0),l=Math.max(a,0),c=s-o,u=i-l,h=Math.min(c,t-o),p=Math.min(u,n-l);return new bi({x:o,y:l,width:h,height:p}).floor()}shift(t,n){let{width:r,height:a}=this,s=this.x+t,i=this.y+n;return new bi({x:s,y:i,width:r,height:a})}padAtBorders(t,n){let r=this.width+1,a=this.height+1,s=1,i=1,o=r,l=a,c=this.left,u=this.top,h=this.right,p=this.bottom;return h>n&&(o=-h+n+r,h=n),p>t&&(l=-p+t+a,p=t),c<1&&(l=2-c,c=1),u<1&&(l=2-u,u=1),{dy:i,edy:l,dx:s,edx:o,y:u,ey:p,x:c,ex:h,w:r,h:a}}calibrate(t){return new bi({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()}},QJ=class extends Yd{constructor(e,t,n,r,a=!1){super({left:e,top:t,right:n,bottom:r},a)}},XJ=class YJ{constructor(t,n,r,a,s){this._imageDims=new Rf(s.width,s.height),this._score=t,this._classScore=n,this._className=r,this._box=new Yd(a).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new Yd(this._box).rescale(this.imageDims.reverse())}forSize(t,n){return new YJ(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})}},Hi=class JJ extends XJ{constructor(t,n,r){super(t,t,"",n,r)}forSize(t,n){let{score:r,relativeBox:a,imageDims:s}=super.forSize(t,n);return new JJ(r,a,s)}};function Qtt(e,t,n=!0){let r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),s=r*a;return n?s/(e.area+t.area-s):s/Math.min(e.area,t.area)}function Xtt(e){let t=e.map(o=>o.x),n=e.map(o=>o.y),r=t.reduce((o,l)=>l<o?l:o,1/0),a=n.reduce((o,l)=>l<o?l:o,1/0),s=t.reduce((o,l)=>o<l?l:o,0),i=n.reduce((o,l)=>o<l?l:o,0);return new QJ(r,a,s,i)}function Ytt(e,t,n,r=!0){let a=t.map((i,o)=>({score:i,boxIndex:o})).sort((i,o)=>i.score-o.score).map(i=>i.boxIndex),s=[];for(;a.length>0;){let i=a.pop();s.push(i);let o=a,l=[];for(let c=0;c<o.length;c++){let u=o[c],h=e[i],p=e[u];l.push(Qtt(h,p,r))}a=a.filter((c,u)=>l[u]<=n)}return s}function Qb(e,t){return te(()=>{let[n,r,a]=t,s=xs([...e.shape.slice(0,3),1],n,"float32"),i=xs([...e.shape.slice(0,3),1],r,"float32"),o=xs([...e.shape.slice(0,3),1],a,"float32"),l=wn([s,i,o],3);return Oe(e,l)})}function Jtt(e,t=!1){return te(()=>{let[n,r]=e.shape.slice(1);if(n===r)return e;let a=Math.abs(n-r),s=Math.round(a*(t?.5:1)),i=n>r?2:1,o=h=>{let p=e.shape.slice();return p[i]=h,xs(p,0,"float32")},l=o(s),c=a-l.shape[i],u=[t&&c?o(c):null,e,l].filter(h=>!!h).map(h=>Se(h,"float32"));return wn(u,i)})}function AC(e){return 1/(1+Math.exp(-e))}var ZJ=class extends Yd{constructor(e,t,n,r,a=!1){super({x:e,y:t,width:n,height:r},a)}},Ztt=.5,ent=.43,tnt=.45,sN=class{constructor(e,t,n=new xn(0,0)){let{width:r,height:a}=t;this._imgDims=new Rf(r,a),this._shift=n,this._positions=e.map(s=>s.mul(new xn(r,a)).add(n))}get shift(){return new xn(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map(e=>e.sub(this._shift).div(new xn(this.imageWidth,this.imageHeight)))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new xn(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e,t={}){if(e){let a=e instanceof Hi?e.box.floor():new Yd(e);return this.shiftBy(a.x,a.y).align(null,t)}let{useDlibAlignment:n,minBoxPadding:r}={useDlibAlignment:!1,minBoxPadding:.2,...t};return n?this.alignDlib():this.alignMinBbox(r)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,n,r]=e,a=u=>r.sub(u).magnitude(),s=(a(t)+a(n))/2,i=Math.floor(s/tnt),o=dM(e),l=Math.floor(Math.max(0,o.x-Ztt*i)),c=Math.floor(Math.max(0,o.y-ent*i));return new ZJ(l,c,Math.min(i,this.imageWidth+l),Math.min(i,this.imageHeight+c))}alignMinBbox(e){let t=Xtt(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},eZ=class extends sN{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(dM)}};function iN(e){return e.detection instanceof Hi}function nnt(e,t){return{...e,detection:t}}function tZ(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function hM(){return typeof global=="object"&&typeof process<"u"&&process.versions!=null&&process.versions.node!=null}function nZ(e){let t="";if(!e&&hM())try{e=P1e("fs")}catch(n){t=n.toString()}return{readFile:e?n=>new Promise((r,a)=>{e.readFile(n,(s,i)=>s?a(s):r(i))}):()=>{throw new Error(`readFile - failed to require fs in nodejs environment with error: ${t}`)}}}function rZ(){let e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=global.Video||global.HTMLVideoElement,r=()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},a=()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},s=()=>{if(n)return new n;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},i=global.fetch,o=nZ();return{Canvas:e||class{},CanvasRenderingContext2D:global.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:global.ImageData||class{},Video:global.HTMLVideoElement||class{},createCanvasElement:r,createImageElement:a,createVideoElement:s,fetch:i,...o}}function aZ(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}var Cr;function rnt(){if(!Cr)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Cr}function UE(e){Cr=e}function pM(){return aZ()?UE(tZ()):hM()?UE(rZ()):null}function ant(e){if(Cr||pM(),!Cr)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=Cr.Canvas,Image:n=Cr.Image}=e;Cr.Canvas=t,Cr.Image=n,Cr.createCanvasElement=e.createCanvasElement||(()=>new t),Cr.createImageElement=e.createImageElement||(()=>new n),Cr.ImageData=e.ImageData||Cr.ImageData,Cr.Video=e.Video||Cr.Video,Cr.fetch=e.fetch||Cr.fetch,Cr.readFile=e.readFile||Cr.readFile}var Ha={getEnv:rnt,setEnv:UE,initialize:pM,createBrowserEnv:tZ,createFileSystem:nZ,createNodejsEnv:rZ,monkeyPatch:ant,isBrowser:aZ,isNodejs:hM};pM();function fM(e){return!Ha.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function rc(e){let{Canvas:t,CanvasRenderingContext2D:n}=Ha.getEnv();if(e instanceof n)return e;let r=fM(e);if(!(r instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let a=r.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}var sZ=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e))(sZ||{}),mM=class{constructor(e={}){let{anchorPosition:t,backgroundColor:n,fontColor:r,fontSize:a,fontStyle:s,padding:i}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=a||14,this.fontStyle=s||"Georgia",this.padding=i||4}},gM=class iZ{constructor(t,n,r={}){this.text=typeof t=="string"?[t]:t instanceof iZ?t.text:t,this.anchor=n,this.options=new mM(r)}measureWidth(t){let{padding:n}=this.options;return this.text.map(r=>t.measureText(r).width).reduce((r,a)=>r<a?a:r,0)+2*n}measureHeight(){let{fontSize:t,padding:n}=this.options;return this.text.length*t+2*n}getUpperLeft(t,n){let{anchorPosition:r}=this.options,a=r==="BOTTOM_RIGHT"||r==="TOP_RIGHT",s=r==="BOTTOM_LEFT"||r==="BOTTOM_RIGHT",i=this.measureWidth(t),o=this.measureHeight(),l=a?this.anchor.x-i:this.anchor.x,c=s?this.anchor.y-o:this.anchor.y;if(n){let{width:u,height:h}=n,p=Math.max(Math.min(l,u-i),0),f=Math.max(Math.min(c,h-o),0);return{x:p,y:f}}return{x:l,y:c}}draw(t){let n=fM(t),r=rc(n),{backgroundColor:a,fontColor:s,fontSize:i,fontStyle:o,padding:l}=this.options;r.font=`${i}px ${o}`;let c=this.measureWidth(r),u=this.measureHeight();r.fillStyle=a;let h=this.getUpperLeft(r,n);r.fillRect(h.x,h.y,c,u),r.fillStyle=s,this.text.forEach((p,f)=>{let g=l+h.x,m=l+h.y+(f+1)*i;r.fillText(p,g,m)})}},oZ=class{constructor(e={}){let{boxColor:t,lineWidth:n,label:r,drawLabelOptions:a}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;let s={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new mM({...s,...a})}},lZ=class{constructor(e,t={}){this.box=new Yd(e),this.options=new oZ(t)}draw(e){let t=rc(e),{boxColor:n,lineWidth:r}=this.options,{x:a,y:s,width:i,height:o}=this.box;t.strokeStyle=n,t.lineWidth=r,t.strokeRect(a,s,i,o);let{label:l}=this.options;l&&new gM([l],{x:a-r/2,y:s},this.options.drawLabelOptions).draw(e)}};function snt(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof Hi?n.score:iN(n)?n.detection.score:void 0,a=n instanceof Hi?n.box:iN(n)?n.detection.box:new Yd(n),s=r?`${cM(r)}`:void 0;new lZ(a,{label:s}).draw(e)})}function uZ(e){let{Image:t,Video:n}=Ha.getEnv();return e instanceof t&&e.complete||e instanceof n&&e.readyState>=3}function int(e){return new Promise((t,n)=>{if(e instanceof Ha.getEnv().Canvas||uZ(e)){t(null);return}function r(s){s.currentTarget&&(s.currentTarget.removeEventListener("load",a),s.currentTarget.removeEventListener("error",r),n(s))}function a(s){s.currentTarget&&(s.currentTarget.removeEventListener("load",a),s.currentTarget.removeEventListener("error",r),t(s))}e.addEventListener("load",a),e.addEventListener("error",r)})}function cZ(e){let{Image:t,Video:n}=Ha.getEnv();return e instanceof t?new Rf(e.naturalWidth,e.naturalHeight):e instanceof n?new Rf(e.videoWidth,e.videoHeight):new Rf(e.width,e.height)}function oN({width:e,height:t}){let{createCanvasElement:n}=Ha.getEnv(),r=n();return r.width=e,r.height=t,r}function dZ(e,t){let{ImageData:n}=Ha.getEnv();if(!(e instanceof n)&&!uZ(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:r,height:a}=cZ(e),s=oN({width:r,height:a});return e instanceof n?rc(s).putImageData(e,0,0):rc(s).drawImage(e,0,0,r,a),s}async function ont(e,t){let n=t||Ha.getEnv().createCanvasElement(),[r,a,s]=e.shape.slice(pl(e)?1:0),i=te(()=>e.as3D(r,a,s).toInt());return await Db.toPixels(i,n),i.dispose(),n}function U3(e){let{Image:t,Canvas:n,Video:r}=Ha.getEnv();return e instanceof t||e instanceof n||e instanceof r}function lnt(e,t,n=!1){let{Image:r,Canvas:a}=Ha.getEnv();if(!(e instanceof r||e instanceof a))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return oN({width:1,height:1});let s=cZ(e),i=t/Math.max(s.height,s.width),o=i*s.width,l=i*s.height,c=oN({width:t,height:t}),u=e instanceof a?e:dZ(e),h=Math.abs(o-l)/2,p=n&&o<l?h:0,f=n&&l<o?h:0;return u.width>0&&u.height>0&&rc(c).drawImage(u,p,f,o,l),c}var lN=class{constructor(e,t=!1){if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error(`NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ${e}`);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((n,r)=>{if(Kb(n)){this._imageTensors[r]=n,this._inputDimensions[r]=n.shape;return}if(pl(n)){let s=n.shape[0];if(s!==1)throw new Error(`NetInput - tf.Tensor4D with batchSize ${s} passed, but not supported in input array`);this._imageTensors[r]=n,this._inputDimensions[r]=n.shape.slice(1);return}let a=n instanceof Ha.getEnv().Canvas?n:dZ(n);this._canvases[r]=a,this._inputDimensions[r]=[a.height,a.width,3]})}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return _m(this.batchSize,0,1).map((e,t)=>this.getReshapedInputDimensions(t))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");let t=this.getInputWidth(e),n=this.getInputHeight(e);return KJ({width:t,height:n},this.inputSize)}toBatchTensor(e,t=!0){return this._inputSize=e,te(()=>{let n=_m(this.batchSize,0,1).map(r=>{let a=this.getInput(r);if(a instanceof Dt){let s=pl(a)?a:$r(a);return s=Jtt(s,t),(s.shape[1]!==e||s.shape[2]!==e)&&(s=$s.resizeBilinear(s,[e,e],!1,!1)),s.as3D(e,e,3)}if(a instanceof Ha.getEnv().Canvas)return Db.fromPixels(lnt(a,e,t));throw new Error(`toBatchTensor - at batchIdx ${r}, expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ${a}`)});return pr(n.map(r=>Se(r,"float32"))).as4D(this.batchSize,e,e,3)})}};async function Ca(e){if(e instanceof lN)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let n=a=>Array.isArray(e)?` at input index ${a}:`:"",r=t.map(fM);return r.forEach((a,s)=>{if(!U3(a)&&!Kb(a)&&!pl(a))throw typeof t[s]=="string"?new Error(`toNetInput -${n(s)} string passed, but could not resolve HTMLElement for element id ${t[s]}`):new Error(`toNetInput -${n(s)} expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id`);if(pl(a)){let i=a.shape[0];if(i!==1)throw new Error(`toNetInput -${n(s)} tf.Tensor4D with batchSize ${i} passed, but not supported in input array`)}}),await Promise.all(r.map(a=>U3(a)&&int(a))),new lN(r,Array.isArray(e))}async function hZ(e,t){let{Canvas:n}=Ha.getEnv(),r=e;if(!(e instanceof n)){let s=await Ca(e);if(s.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let i=s.getInput(0);r=i instanceof n?i:await ont(i)}let a=rc(r);return t.map(s=>s instanceof Hi?s.forSize(r.width,r.height).box.floor():s).map(s=>s.clipAtImageBorders(r.width,r.height)).map(({x:s,y:i,width:o,height:l})=>{let c=oN({width:o,height:l});return o>0&&l>0&&rc(c).putImageData(a.getImageData(s,i,o,l),0,0),c})}async function pZ(e,t){if(!Kb(e)&&!pl(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(pl(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return te(()=>{let[n,r,a]=e.shape.slice(pl(e)?1:0);return t.map(s=>s instanceof Hi?s.forSize(r,n).box:s).map(s=>s.clipAtImageBorders(r,n)).filter(s=>s.width>0&&s.height>0).map(({x:s,y:i,width:o,height:l})=>ny(e.as3D(n,r,a),[i,s,0],[l,o,a]))})}async function unt(e,t){let{fetch:n}=Ha.getEnv(),r=await n(e,t);if(!(r.status<400))throw new Error(`failed to fetch: (${r.status}) ${r.statusText}, from url: ${r.url}`);return r}async function cnt(e){return(await unt(e)).json()}function fZ(e,t){let n=`${t}-weights_manifest.json`;if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:`/${n}`};let r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");let a=e.split("/").filter(o=>o),s=e.endsWith(".json")?a[a.length-1]:n,i=r+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return i=e.startsWith("/")?`/${i}`:i,{modelBaseUri:i,manifestUri:i==="/"?`/${s}`:`${i}/${s}`}}async function dnt(e,t){let{manifestUri:n,modelBaseUri:r}=fZ(e,t),a=await cnt(n);return qr.loadWeights(a,r)}var Ec=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:n}=this.traversePropertyPath(e);return t[n]}reassignParamFromPath(e,t){let{obj:n,objProp:r}=this.traversePropertyPath(e);n[r].dispose(),n[r]=t}getParamList(){return this._paramMappings.map(({paramPath:e})=>({path:e,tensor:this.getParamFromPath(e)}))}getTrainableParams(){return this.getParamList().filter(e=>e.tensor instanceof Md)}getFrozenParams(){return this.getParamList().filter(e=>!(e.tensor instanceof Md))}variable(){this.getFrozenParams().forEach(({path:e,tensor:t})=>{this.reassignParamFromPath(e,t.variable())})}freeze(){this.getTrainableParams().forEach(({path:e,tensor:t})=>{let n=va(t.dataSync());t.dispose(),this.reassignParamFromPath(e,n)})}dispose(e=!0){this.getParamList().forEach(t=>{if(e&&t.tensor.isDisposed)throw new Error(`param tensor has already been disposed for path ${t.path}`);t.tensor.dispose()}),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map(({tensor:e})=>Array.from(e.dataSync())).reduce((e,t)=>e.concat(t)))}async load(e){if(e instanceof Float32Array){this.extractWeights(e);return}await this.loadFromUri(e)}async loadFromUri(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromUri - expected model uri`);let t=await dnt(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromDisk - expected model file path`);let{readFile:t}=Ha.getEnv(),{manifestUri:n,modelBaseUri:r}=fZ(e,this.getDefaultModelName()),a=l=>Promise.all(l.map(c=>t(c).then(u=>typeof u=="string"?Buffer.from(u):u.buffer))),s=qr.weightsLoaderFactory(a),i=JSON.parse((await t(n)).toString()),o=await s(i,r);this.loadFromWeightMap(o)}loadFromWeightMap(e){let{paramMappings:t,params:n}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=n}extractWeights(e){let{paramMappings:t,params:n}=this.extractParams(e);this._paramMappings=t,this._params=n}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce((a,s)=>{if(!a.nextObj.hasOwnProperty(s))throw new Error(`traversePropertyPath - object does not have property ${s}, for path ${e}`);return{obj:a.nextObj,objProp:s,nextObj:a.nextObj[s]}},{nextObj:this.params}),{obj:n,objProp:r}=t;if(!n||!r||!(n[r]instanceof Dt))throw new Error(`traversePropertyPath - parameter is not a tensor, for path ${e}`);return{obj:n,objProp:r}}};function Ms(e,t,n){return te(()=>{let r=ty(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=me(r,t.bias),r})}function $C(e,t,n=!1){return te(()=>{let r=hn(n?me(Sa(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Ms(e,t.conv0,[2,2])),a=Ms(r,t.conv1,[1,1]),s=hn(me(r,a)),i=Ms(s,t.conv2,[1,1]);return hn(me(r,me(a,i)))})}function Jw(e,t,n=!1,r=!0){return te(()=>{let a=hn(n?me(Sa(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Ms(e,t.conv0,r?[2,2]:[1,1])),s=Ms(a,t.conv1,[1,1]),i=hn(me(a,s)),o=Ms(i,t.conv2,[1,1]),l=hn(me(a,me(s,o))),c=Ms(l,t.conv3,[1,1]);return hn(me(a,me(s,me(o,c))))})}function wx(e,t,n="same",r=!1){return te(()=>{let a=me(Sa(e,t.filters,[1,1],n),t.bias);return r?hn(a):a})}function Tc(e,t){Object.keys(e).forEach(n=>{t.some(r=>r.originalPath===n)||e[n].dispose()})}function yM(e,t){return(n,r,a,s)=>{let i=Xu(e(n*r*a*a),[a,a,n,r]),o=cn(e(r));return t.push({paramPath:`${s}/filters`},{paramPath:`${s}/bias`}),{filters:i,bias:o}}}function mZ(e,t){return(n,r,a)=>{let s=So(e(n*r),[n,r]),i=cn(e(r));return t.push({paramPath:`${a}/weights`},{paramPath:`${a}/bias`}),{weights:s,bias:i}}}var gZ=class{constructor(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}};function xM(e,t){return(n,r,a)=>{let s=Xu(e(9*n),[3,3,n,1]),i=Xu(e(n*r),[1,1,n,r]),o=cn(e(r));return t.push({paramPath:`${a}/depthwise_filter`},{paramPath:`${a}/pointwise_filter`},{paramPath:`${a}/bias`}),new gZ(s,i,o)}}function vM(e){return t=>{let n=e(`${t}/depthwise_filter`,4),r=e(`${t}/pointwise_filter`,4),a=e(`${t}/bias`,1);return new gZ(n,r,a)}}function Op(e,t){return(n,r,a)=>{let s=e[n];if(!gy(s,r))throw new Error(`expected weightMap[${n}] to be a Tensor${r}D, instead have ${s}`);return t.push({originalPath:n,paramPath:a||n}),s}}function jc(e){let t=e;function n(a){let s=t.slice(0,a);return t=t.slice(a),s}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function yZ(e,t){let n=yM(e,t),r=xM(e,t);function a(i,o,l,c=!1){let u=c?n(i,o,3,`${l}/conv0`):r(i,o,`${l}/conv0`),h=r(o,o,`${l}/conv1`),p=r(o,o,`${l}/conv2`);return{conv0:u,conv1:h,conv2:p}}function s(i,o,l,c=!1){let{conv0:u,conv1:h,conv2:p}=a(i,o,l,c),f=r(o,o,`${l}/conv3`);return{conv0:u,conv1:h,conv2:p,conv3:f}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:s}}function hnt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=jc(e),{extractDenseBlock4Params:a}=yZ(n,t),s=a(3,32,"dense0",!0),i=a(32,64,"dense1"),o=a(64,128,"dense2"),l=a(128,256,"dense3");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:s,dense1:i,dense2:o,dense3:l}}}function xZ(e){return t=>{let n=e(`${t}/filters`,4),r=e(`${t}/bias`,1);return{filters:n,bias:r}}}function vZ(e,t){let n=Op(e,t),r=xZ(n),a=vM(n);function s(o,l=!1){let c=l?r(`${o}/conv0`):a(`${o}/conv0`),u=a(`${o}/conv1`),h=a(`${o}/conv2`);return{conv0:c,conv1:u,conv2:h}}function i(o,l=!1){let c=l?r(`${o}/conv0`):a(`${o}/conv0`),u=a(`${o}/conv1`),h=a(`${o}/conv2`),p=a(`${o}/conv3`);return{conv0:c,conv1:u,conv2:h,conv3:p}}return{extractDenseBlock3Params:s,extractDenseBlock4Params:i}}function pnt(e){let t=[],{extractDenseBlock4Params:n}=vZ(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Tc(e,t),{params:r,paramMappings:t}}var bZ=class extends Ec{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return te(()=>{let n=Se(e.toBatchTensor(112,!0),"float32"),r=Qb(n,[122.782,117.001,104.298]).div(255),a=Jw(r,t.dense0,!0);return a=Jw(a,t.dense1),a=Jw(a,t.dense2),a=Jw(a,t.dense3),a=El(a,[7,7],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await Ca(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return pnt(e)}extractParams(e){return hnt(e)}};function WE(e,t){return te(()=>me(_t(e,t.weights),t.bias))}function fnt(e,t,n){let r=[],{extractWeights:a,getRemainingWeights:s}=jc(e),i=mZ(a,r)(t,n,"fc");if(s().length!==0)throw new Error(`weights remaing after extract: ${s().length}`);return{paramMappings:r,params:{fc:i}}}function mnt(e){let t=[],n=Op(e,t);function r(s){let i=n(`${s}/weights`,2),o=n(`${s}/bias`,1);return{weights:i,bias:o}}let a={fc:r("fc")};return Tc(e,t),{params:a,paramMappings:t}}function wZ(e){let t={},n={};return Object.keys(e).forEach(r=>{let a=r.startsWith("fc")?n:t;a[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var NZ=class extends Ec{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return te(()=>{let n=e instanceof lN?this.faceFeatureExtractor.forwardInput(e):e;return WE(n.as2D(n.shape[0],-1),t.fc)})}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return fnt(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=wZ(e);return this.faceFeatureExtractor.loadFromWeightMap(t),mnt(n)}extractParams(e){let t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,a=e.slice(0,e.length-r),s=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)}},W3=["neutral","happy","sad","angry","fearful","disgusted","surprised"],bM=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,e.length!==7)throw new Error(`FaceExpressions.constructor - expected probabilities.length to be 7, have: ${e.length}`);W3.forEach((t,n)=>{this[t]=e[n]})}asSortedArray(){return W3.map(e=>({expression:e,probability:this[e]})).sort((e,t)=>t.probability-e.probability)}},gnt=class extends NZ{constructor(e=new bZ){super("FaceExpressionNet",e)}forwardInput(e){return te(()=>Nc(this.runNet(e)))}async forward(e){return this.forwardInput(await Ca(e))}async predictExpressions(e){let t=await Ca(e),n=await this.forwardInput(t),r=await Promise.all(Zn(n).map(async s=>{let i=s.dataSync();return s.dispose(),i}));n.dispose();let a=r.map(s=>new bM(s));return t.isBatchInput?a:a[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}};function ynt(e){return e.expressions instanceof bM}function xnt(e,t){return{...e,expressions:t}}function vnt(e,t,n=.1,r){(Array.isArray(t)?t:[t]).forEach(a=>{let s=a instanceof bM?a:ynt(a)?a.expressions:void 0;if(!s)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let i=s.asSortedArray().filter(l=>l.probability>n),o=iN(a)?a.detection.box.bottomLeft:r||new xn(0,0);new gM(i.map(l=>`${l.expression} (${cM(l.probability)})`),o).draw(e)})}function kZ(e){return iN(e)&&e.landmarks instanceof sN&&e.unshiftedLandmarks instanceof sN&&e.alignedRect instanceof Hi}function bnt(e){let t=l=>l*180/Math.PI,n=(l,c)=>Math.sqrt((l.x-c.x)**2+(l.y-c.y)**2),r={roll:void 0,pitch:void 0,yaw:void 0},a=(l,c,u)=>{let h=Math.floor(l.x-c.x),p=Math.floor(c.x-u.x);return h-p},s=(l,c)=>{let u=Math.hypot(c.x-l.x,c.y-l.y),h=c.y-l.y,p=Math.asin(h/u),f=t(p),g=Math.floor(90-f),m=c.x-l.x<0?-1:1;return g*m},i=(l,c,u)=>{let h=n(l,u),p=new xn((l.x+u.x)/2,(l.y+u.y)/2),f=n(c,p),g=Math.atan(f/h),m=Math.floor(t(g)),y=p.y-c.y<0?-1:1;return m*y};if(!e||!e.positions||e.positions.length!==68)return r;let o=e.positions;return r.roll=s(o[27],o[66]),r.pitch=i(o[14],o[30],o[2]),r.yaw=a(o[14],o[33],o[2]),r}function wnt(e,t){let{box:n}=e.detection,r=t.shiftBy(n.x,n.y),a=r.align(),{imageDims:s}=e.detection,i=new Hi(e.detection.score,a.rescale(s.reverse()),s),o=bnt(t);return{...e,landmarks:r,unshiftedLandmarks:t,alignedRect:i,angle:o}}var SZ=class{constructor(e={}){let{drawLines:t=!0,drawPoints:n=!0,lineWidth:r,lineColor:a,pointSize:s,pointColor:i}=e;this.drawLines=t,this.drawPoints=n,this.lineWidth=r||1,this.pointSize=s||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=i||"rgba(255, 0, 255, 1)"}},_Z=class{constructor(e,t={}){this.faceLandmarks=e,this.options=new SZ(t)}draw(e){let t=rc(e),{drawLines:n,drawPoints:r,lineWidth:a,lineColor:s,pointSize:i,pointColor:o}=this.options;if(n&&this.faceLandmarks instanceof eZ&&(t.strokeStyle=s,t.lineWidth=a,ql(t,this.faceLandmarks.getJawOutline()),ql(t,this.faceLandmarks.getLeftEyeBrow()),ql(t,this.faceLandmarks.getRightEyeBrow()),ql(t,this.faceLandmarks.getNose()),ql(t,this.faceLandmarks.getLeftEye(),!0),ql(t,this.faceLandmarks.getRightEye(),!0),ql(t,this.faceLandmarks.getMouth(),!0)),r){t.strokeStyle=o,t.fillStyle=o;let l=c=>{t.beginPath(),t.arc(c.x,c.y,i,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(l)}}};function Nnt(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof sN?n:kZ(n)?n.landmarks:void 0;if(!r)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new _Z(r).draw(e)})}function knt(e,t){let n=yM(e,t),r=xM(e,t);function a(i,o,l){let c=r(i,o,`${l}/separable_conv0`),u=r(o,o,`${l}/separable_conv1`),h=n(i,o,1,`${l}/expansion_conv`);return{separable_conv0:c,separable_conv1:u,expansion_conv:h}}function s(i,o){let l=r(i,i,`${o}/separable_conv0`),c=r(i,i,`${o}/separable_conv1`),u=r(i,i,`${o}/separable_conv2`);return{separable_conv0:l,separable_conv1:c,separable_conv2:u}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:a,extractMainBlockParams:s}}function Snt(e,t){let n=[],{extractWeights:r,getRemainingWeights:a}=jc(e),{extractConvParams:s,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:l}=knt(r,n),c=s(3,32,3,"entry_flow/conv_in"),u=o(32,64,"entry_flow/reduction_block_0"),h=o(64,128,"entry_flow/reduction_block_1"),p={conv_in:c,reduction_block_0:u,reduction_block_1:h},f={};_m(t,0,1).forEach(x=>{f[`main_block_${x}`]=l(128,`middle_flow/main_block_${x}`)});let g=o(128,256,"exit_flow/reduction_block"),m=i(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:m};if(a().length!==0)throw new Error(`weights remaing after extract: ${a().length}`);return{paramMappings:n,params:{entry_flow:p,middle_flow:f,exit_flow:y}}}function _nt(e,t){let n=Op(e,t),r=xZ(n),a=vM(n);function s(o){let l=a(`${o}/separable_conv0`),c=a(`${o}/separable_conv1`),u=r(`${o}/expansion_conv`);return{separable_conv0:l,separable_conv1:c,expansion_conv:u}}function i(o){let l=a(`${o}/separable_conv0`),c=a(`${o}/separable_conv1`),u=a(`${o}/separable_conv2`);return{separable_conv0:l,separable_conv1:c,separable_conv2:u}}return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:s,extractMainBlockParams:i}}function Cnt(e,t){let n=[],{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:s,extractMainBlockParams:i}=_nt(e,n),o=r("entry_flow/conv_in"),l=s("entry_flow/reduction_block_0"),c=s("entry_flow/reduction_block_1"),u={conv_in:o,reduction_block_0:l,reduction_block_1:c},h={};_m(t,0,1).forEach(m=>{h[`main_block_${m}`]=i(`middle_flow/main_block_${m}`)});let p=s("exit_flow/reduction_block"),f=a("exit_flow/separable_conv"),g={reduction_block:p,separable_conv:f};return Tc(e,n),{params:{entry_flow:u,middle_flow:h,exit_flow:g},paramMappings:n}}function CZ(e,t,n){return me(Sa(e,t.filters,n,"same"),t.bias)}function RC(e,t,n=!0){let r=n?hn(e):e;return r=Ms(r,t.separable_conv0,[1,1]),r=Ms(hn(r),t.separable_conv1,[1,1]),r=Ir(r,[3,3],[2,2],"same"),r=me(r,CZ(e,t.expansion_conv,[2,2])),r}function Int(e,t){let n=Ms(hn(e),t.separable_conv0,[1,1]);return n=Ms(hn(n),t.separable_conv1,[1,1]),n=Ms(hn(n),t.separable_conv2,[1,1]),n=me(n,e),n}var Ent=class extends Ec{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return te(()=>{let n=Se(e.toBatchTensor(112,!0),"float32"),r=Qb(n,[122.782,117.001,104.298]).div(255),a=hn(CZ(r,t.entry_flow.conv_in,[2,2]));return a=RC(a,t.entry_flow.reduction_block_0,!1),a=RC(a,t.entry_flow.reduction_block_1),_m(this._numMainBlocks,0,1).forEach(s=>{a=Int(a,t.middle_flow[`main_block_${s}`])}),a=RC(a,t.exit_flow.reduction_block),a=hn(Ms(a,t.exit_flow.separable_conv,[1,1])),a})}async forward(e){return this.forwardInput(await Ca(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return Cnt(e,this._numMainBlocks)}extractParams(e){return Snt(e,this._numMainBlocks)}};function Tnt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=jc(e),a=mZ(n,t),s=a(512,1,"fc/age"),i=a(512,2,"fc/gender");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{fc:{age:s,gender:i}}}}function jnt(e){let t=[],n=Op(e,t);function r(s){let i=n(`${s}/weights`,2),o=n(`${s}/bias`,1);return{weights:i,bias:o}}let a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Tc(e,t),{params:a,paramMappings:t}}var Ant=(e=>(e.FEMALE="female",e.MALE="male",e))(Ant||{}),$nt=class extends Ec{constructor(e=new Ent(2)){super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return te(()=>{let n=e instanceof lN?this.faceFeatureExtractor.forwardInput(e):e,r=El(n,[7,7],[2,2],"valid").as2D(n.shape[0],-1),a=WE(r,t.fc.age).as1D(),s=WE(r,t.fc.gender);return{age:a,gender:s}})}forwardInput(e){return te(()=>{let{age:t,gender:n}=this.runNet(e);return{age:t,gender:Nc(n)}})}async forward(e){return this.forwardInput(await Ca(e))}async predictAgeAndGender(e){let t=await Ca(e),n=await this.forwardInput(t),r=Zn(n.age),a=Zn(n.gender),s=r.map((o,l)=>({ageTensor:o,genderTensor:a[l]})),i=await Promise.all(s.map(async({ageTensor:o,genderTensor:l})=>{let c=o.dataSync()[0],u=l.dataSync()[0],h=u>.5,p=h?"male":"female",f=h?u:1-u;return o.dispose(),l.dispose(),{age:c,gender:p,genderProbability:f}}));return n.age.dispose(),n.gender.dispose(),t.isBatchInput?i:i[0]}getDefaultModelName(){return"age_gender_model"}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return Tnt(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=wZ(e);return this.faceFeatureExtractor.loadFromWeightMap(t),jnt(n)}extractParams(e){let t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)}},IZ=class extends NZ{postProcess(e,t,n){let r=n.map(({width:s,height:i})=>{let o=t/Math.max(i,s);return{width:s*o,height:i*o}}),a=r.length;return te(()=>{let s=(c,u)=>pr([xs([68],c,"float32"),xs([68],u,"float32")],1).as2D(1,136).as1D(),i=(c,u)=>{let{width:h,height:p}=r[c];return u(h,p)?Math.abs(h-p)/2:0},o=c=>i(c,(u,h)=>u<h),l=c=>i(c,(u,h)=>h<u);return e.mul(xs([a,136],t,"float32")).sub(pr(Array.from(Array(a),(c,u)=>s(o(u),l(u))))).div(pr(Array.from(Array(a),(c,u)=>s(r[u].width,r[u].height))))})}forwardInput(e){return te(()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map(([n,r])=>({height:n,width:r})))})}async forward(e){return this.forwardInput(await Ca(e))}async detectLandmarks(e){let t=await Ca(e),n=te(()=>Zn(this.forwardInput(t))),r=await Promise.all(n.map(async(a,s)=>{let i=Array.from(a.dataSync()),o=i.filter((c,u)=>zE(u)),l=i.filter((c,u)=>!zE(u));return new eZ(Array(68).fill(0).map((c,u)=>new xn(o[u],l[u])),{height:t.getInputHeight(s),width:t.getInputWidth(s)})}));return n.forEach(a=>a.dispose()),t.isBatchInput?r:r[0]}getClassifierChannelsOut(){return 136}},Rnt=class extends IZ{constructor(e=new bZ){super("FaceLandmark68Net",e)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}};function Dnt(e){let t=[],{extractDenseBlock3Params:n}=vZ(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Tc(e,t),{params:r,paramMappings:t}}function Mnt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=jc(e),{extractDenseBlock3Params:a}=yZ(n,t),s=a(3,32,"dense0",!0),i=a(32,64,"dense1"),o=a(64,128,"dense2");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:s,dense1:i,dense2:o}}}var Ont=class extends Ec{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return te(()=>{let n=Se(e.toBatchTensor(112,!0),"float32"),r=Qb(n,[122.782,117.001,104.298]).div(255),a=$C(r,t.dense0,!0);return a=$C(a,t.dense1),a=$C(a,t.dense2),a=El(a,[14,14],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await Ca(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return Dnt(e)}extractParams(e){return Mnt(e)}},Fnt=class extends IZ{constructor(e=new Ont){super("FaceLandmark68TinyNet",e)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}};function Pnt(e,t){return me(Z(e,t.weights),t.biases)}function wM(e,t,n,r,a="same"){let{filters:s,bias:i}=t.conv,o=Sa(e,s,n,a);return o=me(o,i),o=Pnt(o,t.scale),r?hn(o):o}function Lnt(e,t){return wM(e,t,[1,1],!0)}function EZ(e,t){return wM(e,t,[1,1],!1)}function TZ(e,t){return wM(e,t,[2,2],!0,"valid")}function znt(e,t){function n(o,l,c){let u=e(o),h=u.length/(l*c*c);if(qJ(h))throw new Error(`depth has to be an integer: ${h}, weights.length: ${u.length}, numFilters: ${l}, filterSize: ${c}`);return te(()=>Tt(Xu(u,[l,h,c,c]),[2,3,1,0]))}function r(o,l,c,u){let h=n(o,l,c),p=cn(e(l));return t.push({paramPath:`${u}/filters`},{paramPath:`${u}/bias`}),{filters:h,bias:p}}function a(o,l){let c=cn(e(o)),u=cn(e(o));return t.push({paramPath:`${l}/weights`},{paramPath:`${l}/biases`}),{weights:c,biases:u}}function s(o,l,c,u){let h=r(o,l,c,`${u}/conv`),p=a(l,`${u}/scale`);return{conv:h,scale:p}}function i(o,l,c,u,h=!1){let p=s((h?.5:1)*o,l,c,`${u}/conv1`),f=s(o,l,c,`${u}/conv2`);return{conv1:p,conv2:f}}return{extractConvLayerParams:s,extractResidualLayerParams:i}}function Bnt(e){let{extractWeights:t,getRemainingWeights:n}=jc(e),r=[],{extractConvLayerParams:a,extractResidualLayerParams:s}=znt(t,r),i=a(4704,32,7,"conv32_down"),o=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),c=s(9216,32,3,"conv32_3"),u=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),f=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),m=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),v=s(589824,256,3,"conv256_1"),b=s(589824,256,3,"conv256_2"),w=s(589824,256,3,"conv256_down_out"),k=te(()=>Tt(So(t(256*128),[128,256]),[1,0]));if(r.push({paramPath:"fc"}),n().length!==0)throw new Error(`weights remaing after extract: ${n().length}`);return{params:{conv32_down:i,conv32_1:o,conv32_2:l,conv32_3:c,conv64_down:u,conv64_1:h,conv64_2:p,conv64_3:f,conv128_down:g,conv128_1:m,conv128_2:y,conv256_down:x,conv256_1:v,conv256_2:b,conv256_down_out:w,fc:k},paramMappings:r}}function Unt(e,t){let n=Op(e,t);function r(i){let o=n(`${i}/scale/weights`,1),l=n(`${i}/scale/biases`,1);return{weights:o,biases:l}}function a(i){let o=n(`${i}/conv/filters`,4),l=n(`${i}/conv/bias`,1),c=r(i);return{conv:{filters:o,bias:l},scale:c}}function s(i){return{conv1:a(`${i}/conv1`),conv2:a(`${i}/conv2`)}}return{extractConvLayerParams:a,extractResidualLayerParams:s}}function Wnt(e){let t=[],{extractConvLayerParams:n,extractResidualLayerParams:r}=Unt(e,t),a=n("conv32_down"),s=r("conv32_1"),i=r("conv32_2"),o=r("conv32_3"),l=r("conv64_down"),c=r("conv64_1"),u=r("conv64_2"),h=r("conv64_3"),p=r("conv128_down"),f=r("conv128_1"),g=r("conv128_2"),m=r("conv256_down"),y=r("conv256_1"),x=r("conv256_2"),v=r("conv256_down_out"),{fc:b}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!GJ(b))throw new Error(`expected weightMap[fc] to be a Tensor2D, instead have ${b}`);let w={conv32_down:a,conv32_1:s,conv32_2:i,conv32_3:o,conv64_down:l,conv64_1:c,conv64_2:u,conv64_3:h,conv128_down:p,conv128_1:f,conv128_2:g,conv256_down:m,conv256_1:y,conv256_2:x,conv256_down_out:v,fc:b};return Tc(e,t),{params:w,paramMappings:t}}function eo(e,t){let n=Lnt(e,t.conv1);return n=EZ(n,t.conv2),n=me(n,e),n=hn(n),n}function Zw(e,t){let n=TZ(e,t.conv1);n=EZ(n,t.conv2);let r=El(e,2,2,"valid"),a=Vn(r.shape),s=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){let i=[...n.shape];i[1]=1;let o=Vn(i);n=wn([n,o],1);let l=[...n.shape];l[2]=1;let c=Vn(l);n=wn([n,c],2)}return r=s?wn([r,a],3):r,n=me(r,n),n=hn(n),n}var Vnt=class extends Ec{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return te(()=>{let n=Se(e.toBatchTensor(150,!0),"float32"),r=Qb(n,[122.782,117.001,104.298]).div(255),a=TZ(r,t.conv32_down);a=Ir(a,3,2,"valid"),a=eo(a,t.conv32_1),a=eo(a,t.conv32_2),a=eo(a,t.conv32_3),a=Zw(a,t.conv64_down),a=eo(a,t.conv64_1),a=eo(a,t.conv64_2),a=eo(a,t.conv64_3),a=Zw(a,t.conv128_down),a=eo(a,t.conv128_1),a=eo(a,t.conv128_2),a=Zw(a,t.conv256_down),a=eo(a,t.conv256_1),a=eo(a,t.conv256_2),a=Zw(a,t.conv256_down_out);let s=a.mean([1,2]);return _t(s,t.fc)})}async forward(e){return this.forwardInput(await Ca(e))}async computeFaceDescriptor(e){var t;if((t=e==null?void 0:e.shape)!=null&&t.some(s=>s<=0))return new Float32Array(128);let n=await Ca(e),r=te(()=>Zn(this.forwardInput(n))),a=await Promise.all(r.map(s=>s.data()));return r.forEach(s=>s.dispose()),n.isBatchInput?a:a[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return Wnt(e)}extractParams(e){return Bnt(e)}};function Hnt(e,t){return{...e,descriptor:t}}function Gnt(e,t){return{...e,age:t}}function qnt(e,t,n){return{...e,gender:t,genderProbability:n}}function Knt(e,t){function n(l,c){let u=Xu(e(9*l),[3,3,l,1]),h=cn(e(l)),p=cn(e(l)),f=cn(e(l)),g=cn(e(l));return t.push({paramPath:`${c}/filters`},{paramPath:`${c}/batch_norm_scale`},{paramPath:`${c}/batch_norm_offset`},{paramPath:`${c}/batch_norm_mean`},{paramPath:`${c}/batch_norm_variance`}),{filters:u,batch_norm_scale:h,batch_norm_offset:p,batch_norm_mean:f,batch_norm_variance:g}}function r(l,c,u,h,p){let f=Xu(e(l*c*u*u),[u,u,l,c]),g=cn(e(c));return t.push({paramPath:`${h}/filters`},{paramPath:`${h}/${p?"batch_norm_offset":"bias"}`}),{filters:f,bias:g}}function a(l,c,u,h){let{filters:p,bias:f}=r(l,c,u,h,!0);return{filters:p,batch_norm_offset:f}}function s(l,c,u){let h=n(l,`${u}/depthwise_conv`),p=a(l,c,1,`${u}/pointwise_conv`);return{depthwise_conv:h,pointwise_conv:p}}function i(){let l=a(3,32,3,"mobilenetv1/conv_0"),c=s(32,64,"mobilenetv1/conv_1"),u=s(64,128,"mobilenetv1/conv_2"),h=s(128,128,"mobilenetv1/conv_3"),p=s(128,256,"mobilenetv1/conv_4"),f=s(256,256,"mobilenetv1/conv_5"),g=s(256,512,"mobilenetv1/conv_6"),m=s(512,512,"mobilenetv1/conv_7"),y=s(512,512,"mobilenetv1/conv_8"),x=s(512,512,"mobilenetv1/conv_9"),v=s(512,512,"mobilenetv1/conv_10"),b=s(512,512,"mobilenetv1/conv_11"),w=s(512,1024,"mobilenetv1/conv_12"),k=s(1024,1024,"mobilenetv1/conv_13");return{conv_0:l,conv_1:c,conv_2:u,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:m,conv_8:y,conv_9:x,conv_10:v,conv_11:b,conv_12:w,conv_13:k}}function o(){let l=a(1024,256,1,"prediction_layer/conv_0"),c=a(256,512,3,"prediction_layer/conv_1"),u=a(512,128,1,"prediction_layer/conv_2"),h=a(128,256,3,"prediction_layer/conv_3"),p=a(256,128,1,"prediction_layer/conv_4"),f=a(128,256,3,"prediction_layer/conv_5"),g=a(256,64,1,"prediction_layer/conv_6"),m=a(64,128,3,"prediction_layer/conv_7"),y=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),x=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),v=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),k=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),I=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),C=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),S=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),E=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),T=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),$=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor");return{conv_0:l,conv_1:c,conv_2:u,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:m,box_predictor_0:{box_encoding_predictor:y,class_predictor:x},box_predictor_1:{box_encoding_predictor:v,class_predictor:b},box_predictor_2:{box_encoding_predictor:w,class_predictor:k},box_predictor_3:{box_encoding_predictor:I,class_predictor:C},box_predictor_4:{box_encoding_predictor:S,class_predictor:E},box_predictor_5:{box_encoding_predictor:T,class_predictor:$}}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:o}}function Qnt(e){let t=[],{extractWeights:n,getRemainingWeights:r}=jc(e),{extractMobilenetV1Params:a,extractPredictionLayerParams:s}=Knt(n,t),i=a(),o=s(),l={extra_dim:hS(n(5118*4),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{params:{mobilenetv1:i,prediction_layer:o,output_layer:l},paramMappings:t}}function Xnt(e,t){let n=Op(e,t);function r(c,u,h){let p=n(`${c}/Conv2d_${u}_pointwise/weights`,4,`${h}/filters`),f=n(`${c}/Conv2d_${u}_pointwise/convolution_bn_offset`,1,`${h}/batch_norm_offset`);return{filters:p,batch_norm_offset:f}}function a(c){let u=`mobilenetv1/conv_${c}`,h=`MobilenetV1/Conv2d_${c}_depthwise`,p=`${u}/depthwise_conv`,f=`${u}/pointwise_conv`,g=n(`${h}/depthwise_weights`,4,`${p}/filters`),m=n(`${h}/BatchNorm/gamma`,1,`${p}/batch_norm_scale`),y=n(`${h}/BatchNorm/beta`,1,`${p}/batch_norm_offset`),x=n(`${h}/BatchNorm/moving_mean`,1,`${p}/batch_norm_mean`),v=n(`${h}/BatchNorm/moving_variance`,1,`${p}/batch_norm_variance`);return{depthwise_conv:{filters:g,batch_norm_scale:m,batch_norm_offset:y,batch_norm_mean:x,batch_norm_variance:v},pointwise_conv:r("MobilenetV1",c,f)}}function s(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function i(c,u){let h=n(`${c}/weights`,4,`${u}/filters`),p=n(`${c}/biases`,1,`${u}/bias`);return{filters:h,bias:p}}function o(c){let u=i(`Prediction/BoxPredictor_${c}/BoxEncodingPredictor`,`prediction_layer/box_predictor_${c}/box_encoding_predictor`),h=i(`Prediction/BoxPredictor_${c}/ClassPredictor`,`prediction_layer/box_predictor_${c}/class_predictor`);return{box_encoding_predictor:u,class_predictor:h}}function l(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:l}}function Ynt(e){let t=[],{extractMobilenetV1Params:n,extractPredictionLayerParams:r}=Xnt(e,t),a=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Kb(a))throw new Error(`expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ${a}`);let s={mobilenetv1:n(),prediction_layer:r(),output_layer:{extra_dim:a}};return Tc(e,t),{params:s,paramMappings:t}}function ao(e,t,n){return te(()=>{let r=Sa(e,t.filters,n,"same");return r=me(r,t.batch_norm_offset),aa(r,0,6)})}var Jnt=.0010000000474974513;function Znt(e,t,n){return te(()=>{let r=Cp(e,t.filters,n,"same");return r=_p(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,Jnt),aa(r,0,6)})}function ert(e){return[2,4,6,12].some(t=>t===e)?[2,2]:[1,1]}function trt(e,t){return te(()=>{let n,r=ao(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((a,s)=>{let i=s+1,o=ert(i);r=Znt(r,a.depthwise_conv,o),r=ao(r,a.pointwise_conv,[1,1]),i===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function nrt(e,t,n){let r=e.arraySync(),a=Math.min(r[t][0],r[t][2]),s=Math.min(r[t][1],r[t][3]),i=Math.max(r[t][0],r[t][2]),o=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),u=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),p=(i-a)*(o-s),f=(u-l)*(h-c);if(p<=0||f<=0)return 0;let g=Math.max(a,l),m=Math.max(s,c),y=Math.min(i,u),x=Math.min(o,h),v=Math.max(y-g,0)*Math.max(x-m,0);return v/(p+f-v)}function rrt(e,t,n,r,a){let s=e.shape[0],i=Math.min(n,s),o=t.map((u,h)=>({score:u,boxIndex:h})).filter(u=>u.score>a).sort((u,h)=>h.score-u.score),l=u=>u<=r?1:0,c=[];return o.forEach(u=>{if(c.length>=i)return;let h=u.score;for(let p=c.length-1;p>=0;--p){let f=nrt(e,u.boxIndex,c[p]);if(f!==0&&(u.score*=l(f),u.score<=a))break}h===u.score&&c.push(u.boxIndex)}),c}function art(e){let t=Zn(Tt(e,[1,0])),n=[Oe(t[2],t[0]),Oe(t[3],t[1])],r=[me(t[0],ze(n[0],2)),me(t[1],ze(n[1],2))];return{sizes:n,centers:r}}function srt(e,t){let{sizes:n,centers:r}=art(e),a=Zn(Tt(t,[1,0])),s=ze(Z(sa(ze(a[2],5)),n[0]),2),i=me(Z(ze(a[0],10),n[0]),r[0]),o=ze(Z(sa(ze(a[3],5)),n[1]),2),l=me(Z(ze(a[1],10),n[1]),r[1]);return Tt(pr([Oe(i,s),Oe(l,o),me(i,s),me(l,o)]),[1,0])}function irt(e,t,n){return te(()=>{let r=e.shape[0],a=srt(ee(ds(n.extra_dim,[r,1,1]),[-1,4]),ee(e,[-1,4]));a=ee(a,[r,a.shape[0]/r,4]);let s=si(Ut(t,[0,0,1],[-1,-1,-1])),i=Ut(s,[0,0,0],[-1,-1,1]);i=ee(i,[r,i.shape[1]]);let o=Zn(a),l=Zn(i);return{boxes:o,scores:l}})}function Yp(e,t){return te(()=>{let n=e.shape[0],r=ee(wx(e,t.box_encoding_predictor),[n,-1,1,4]),a=ee(wx(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:a}})}function ort(e,t,n){return te(()=>{let r=ao(e,n.conv_0,[1,1]),a=ao(r,n.conv_1,[2,2]),s=ao(a,n.conv_2,[1,1]),i=ao(s,n.conv_3,[2,2]),o=ao(i,n.conv_4,[1,1]),l=ao(o,n.conv_5,[2,2]),c=ao(l,n.conv_6,[1,1]),u=ao(c,n.conv_7,[2,2]),h=Yp(t,n.box_predictor_0),p=Yp(e,n.box_predictor_1),f=Yp(a,n.box_predictor_2),g=Yp(i,n.box_predictor_3),m=Yp(l,n.box_predictor_4),y=Yp(u,n.box_predictor_5),x=wn([h.boxPredictionEncoding,p.boxPredictionEncoding,f.boxPredictionEncoding,g.boxPredictionEncoding,m.boxPredictionEncoding,y.boxPredictionEncoding],1),v=wn([h.classPrediction,p.classPrediction,f.classPrediction,g.classPrediction,m.classPrediction,y.classPrediction],1);return{boxPredictions:x,classPredictions:v}})}var JS=class{constructor({minConfidence:e,maxResults:t}={}){if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(`${this._name} - expected minConfidence to be a number between 0 and 1`);if(typeof this._maxResults!="number")throw new Error(`${this._name} - expected maxResults to be a number`)}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},lrt=class extends Ec{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return te(()=>{let n=Se(e.toBatchTensor(512,!1),"float32"),r=Oe(ze(n,127.5),1),a=trt(r,t.mobilenetv1),{boxPredictions:s,classPredictions:i}=ort(a.out,a.conv11,t.prediction_layer);return irt(s,i,t.output_layer)})}async forward(e){return this.forwardInput(await Ca(e))}async locateFaces(e,t={}){let{maxResults:n,minConfidence:r}=new JS(t),a=await Ca(e),{boxes:s,scores:i}=this.forwardInput(a),o=s[0],l=i[0];for(let x=1;x<s.length;x++)s[x].dispose(),i[x].dispose();let c=Array.from(l.dataSync()),u=rrt(o,c,n,.5,r),h=a.getReshapedInputDimensions(0),p=a.inputSize,f=p/h.width,g=p/h.height,m=o.arraySync(),y=u.map(x=>{let[v,b]=[Math.max(0,m[x][0]),Math.min(1,m[x][2])].map(I=>I*g),[w,k]=[Math.max(0,m[x][1]),Math.min(1,m[x][3])].map(I=>I*f);return new Hi(c[x],new ZJ(w,v,k-w,b-v),{height:a.getInputHeight(0),width:a.getInputWidth(0)})});return o.dispose(),l.dispose(),y}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return Ynt(e)}extractParams(e){return Qnt(e)}},urt=.4,crt=[new xn(.738768,.874946),new xn(2.42204,2.65704),new xn(4.30971,7.04493),new xn(10.246,4.59428),new xn(12.6868,11.8741)],drt=[new xn(1.603231,2.094468),new xn(6.041143,7.080126),new xn(2.882459,3.518061),new xn(4.266906,5.178857),new xn(9.041765,10.66308)],hrt=[117.001,114.697,97.404],prt="tiny_yolov2_model",frt="tiny_yolov2_separable_conv_model",e0=e=>typeof e=="number";function mrt(e){if(!e)throw new Error(`invalid config: ${e}`);if(typeof e.withSeparableConvs!="boolean")throw new Error(`config.withSeparableConvs has to be a boolean, have: ${e.withSeparableConvs}`);if(!e0(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error(`config.iouThreshold has to be a number between [0, 1], have: ${e.iouThreshold}`);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(t=>typeof t=="string"))throw new Error(`config.classes has to be an array class names: string[], have: ${JSON.stringify(e.classes)}`);if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(t=>t||{}).every(t=>e0(t.x)&&e0(t.y)))throw new Error(`config.anchors has to be an array of { x: number, y: number }, have: ${JSON.stringify(e.anchors)}`);if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(e0)))throw new Error(`config.meanRgb has to be an array of shape [number, number, number], have: ${JSON.stringify(e.meanRgb)}`)}function NM(e){return te(()=>{let t=Z(e,Ze(.10000000149011612));return me(hn(Oe(e,t)),t)})}function zl(e,t){return te(()=>{let n=Ki(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Sa(n,t.conv.filters,[1,1],"valid"),n=Oe(n,t.bn.sub),n=Z(n,t.bn.truediv),n=me(n,t.conv.bias),NM(n)})}function Bl(e,t){return te(()=>{let n=Ki(e,[[0,0],[1,1],[1,1],[0,0]]);return n=ty(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=me(n,t.bias),NM(n)})}function grt(e,t){let n=yM(e,t);function r(i,o){let l=cn(e(i)),c=cn(e(i));return t.push({paramPath:`${o}/sub`},{paramPath:`${o}/truediv`}),{sub:l,truediv:c}}function a(i,o,l){let c=n(i,o,3,`${l}/conv`),u=r(o,`${l}/bn`);return{conv:c,bn:u}}let s=xM(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:a,extractSeparableConvParams:s}}function yrt(e,t,n,r){let{extractWeights:a,getRemainingWeights:s}=jc(e),i=[],{extractConvParams:o,extractConvWithBatchNormParams:l,extractSeparableConvParams:c}=grt(a,i),u;if(t.withSeparableConvs){let[h,p,f,g,m,y,x,v,b]=r,w=t.isFirstLayerConv2d?o(h,p,3,"conv0"):c(h,p,"conv0"),k=c(p,f,"conv1"),I=c(f,g,"conv2"),C=c(g,m,"conv3"),S=c(m,y,"conv4"),E=c(y,x,"conv5"),T=v?c(x,v,"conv6"):void 0,$=b?c(v,b,"conv7"):void 0,_=o(b||v||x,5*n,1,"conv8");u={conv0:w,conv1:k,conv2:I,conv3:C,conv4:S,conv5:E,conv6:T,conv7:$,conv8:_}}else{let[h,p,f,g,m,y,x,v,b]=r,w=l(h,p,"conv0"),k=l(p,f,"conv1"),I=l(f,g,"conv2"),C=l(g,m,"conv3"),S=l(m,y,"conv4"),E=l(y,x,"conv5"),T=l(x,v,"conv6"),$=l(v,b,"conv7"),_=o(b,5*n,1,"conv8");u={conv0:w,conv1:k,conv2:I,conv3:C,conv4:S,conv5:E,conv6:T,conv7:$,conv8:_}}if(s().length!==0)throw new Error(`weights remaing after extract: ${s().length}`);return{params:u,paramMappings:i}}function xrt(e,t){let n=Op(e,t);function r(o){let l=n(`${o}/sub`,1),c=n(`${o}/truediv`,1);return{sub:l,truediv:c}}function a(o){let l=n(`${o}/filters`,4),c=n(`${o}/bias`,1);return{filters:l,bias:c}}function s(o){let l=a(`${o}/conv`),c=r(`${o}/bn`);return{conv:l,bn:c}}let i=vM(n);return{extractConvParams:a,extractConvWithBatchNormParams:s,extractSeparableConvParams:i}}function vrt(e,t){let n=[],{extractConvParams:r,extractConvWithBatchNormParams:a,extractSeparableConvParams:s}=xrt(e,n),i;if(t.withSeparableConvs){let o=t.filterSizes&&t.filterSizes.length||9;i={conv0:t.isFirstLayerConv2d?r("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:o>7?s("conv6"):void 0,conv7:o>8?s("conv7"):void 0,conv8:r("conv8")}}else i={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:r("conv8")};return Tc(e,n),{params:i,paramMappings:n}}var kM=class{constructor({inputSize:e,scoreThreshold:t}={}){if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(`${this._name} - expected inputSize to be a number divisible by 32`);if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(`${this._name} - expected scoreThreshold to be a number between 0 and 1`)}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},jZ=class AZ extends Ec{constructor(t){super("TinyYolov2"),mrt(t),this._config=t}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(t,n){let r=zl(t,n.conv0);return r=Ir(r,[2,2],[2,2],"same"),r=zl(r,n.conv1),r=Ir(r,[2,2],[2,2],"same"),r=zl(r,n.conv2),r=Ir(r,[2,2],[2,2],"same"),r=zl(r,n.conv3),r=Ir(r,[2,2],[2,2],"same"),r=zl(r,n.conv4),r=Ir(r,[2,2],[2,2],"same"),r=zl(r,n.conv5),r=Ir(r,[2,2],[1,1],"same"),r=zl(r,n.conv6),r=zl(r,n.conv7),wx(r,n.conv8,"valid",!1)}runMobilenet(t,n){let r=this.config.isFirstLayerConv2d?NM(wx(t,n.conv0,"valid",!1)):Bl(t,n.conv0);return r=Ir(r,[2,2],[2,2],"same"),r=Bl(r,n.conv1),r=Ir(r,[2,2],[2,2],"same"),r=Bl(r,n.conv2),r=Ir(r,[2,2],[2,2],"same"),r=Bl(r,n.conv3),r=Ir(r,[2,2],[2,2],"same"),r=Bl(r,n.conv4),r=Ir(r,[2,2],[2,2],"same"),r=Bl(r,n.conv5),r=Ir(r,[2,2],[1,1],"same"),r=n.conv6?Bl(r,n.conv6):r,r=n.conv7?Bl(r,n.conv7):r,wx(r,n.conv8,"valid",!1)}forwardInput(t,n){let{params:r}=this;if(!r)throw new Error("TinyYolov2 - load model before inference");return te(()=>{let a=Se(t.toBatchTensor(n,!1),"float32");return a=this.config.meanRgb?Qb(a,this.config.meanRgb):a,a=a.div(255),this.config.withSeparableConvs?this.runMobilenet(a,r):this.runTinyYolov2(a,r)})}async forward(t,n){return this.forwardInput(await Ca(t),n)}async detect(t,n={}){let{inputSize:r,scoreThreshold:a}=new kM(n),s=await Ca(t),i=await this.forwardInput(s,r),o=te(()=>Zn(i)[0].expandDims()),l={width:s.getInputWidth(0),height:s.getInputHeight(0)},c=await this.extractBoxes(o,s.getReshapedInputDimensions(0),a);i.dispose(),o.dispose();let u=c.map(g=>g.box),h=c.map(g=>g.score),p=c.map(g=>g.classScore),f=c.map(g=>this.config.classes[g.label]);return Ytt(u.map(g=>g.rescale(r)),h,this.config.iouThreshold,!0).map(g=>new XJ(h[g],p[g],f[g],u[g],l))}getDefaultModelName(){return""}extractParamsFromWeightMap(t){return vrt(t,this.config)}extractParams(t){let n=this.config.filterSizes||AZ.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(r!==7&&r!==8&&r!==9)throw new Error(`TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ${r} filterSizes in config`);return yrt(t,this.config,this.boxEncodingSize,n)}async extractBoxes(t,n,r){let{width:a,height:s}=n,i=Math.max(a,s),o=i/a,l=i/s,c=t.shape[1],u=this.config.anchors.length,[h,p,f]=te(()=>{let x=t.reshape([c,c,u,this.boxEncodingSize]),v=x.slice([0,0,0,0],[c,c,u,4]),b=x.slice([0,0,0,4],[c,c,u,1]),w=this.withClassScores?Nc(x.slice([0,0,0,5],[c,c,u,this.config.classes.length]),3):Ze(0);return[v,b,w]}),g=[],m=await p.array(),y=await h.array();for(let x=0;x<c;x++)for(let v=0;v<c;v++)for(let b=0;b<u;b++){let w=AC(m[x][v][b][0]);if(!r||w>r){let k=(v+AC(y[x][v][b][0]))/c*o,I=(x+AC(y[x][v][b][1]))/c*l,C=Math.exp(y[x][v][b][2])*this.config.anchors[b].x/c*o,S=Math.exp(y[x][v][b][3])*this.config.anchors[b].y/c*l,E=k-C/2,T=I-S/2,$={row:x,col:v,anchor:b},{classScore:_,label:M}=this.withClassScores?await this.extractPredictedClass(f,$):{classScore:1,label:0};g.push({box:new QJ(E,T,E+C,T+S),score:w,classScore:w*_,label:M,...$})}}return h.dispose(),p.dispose(),f.dispose(),g}async extractPredictedClass(t,n){let{row:r,col:a,anchor:s}=n,i=await t.array();return Array(this.config.classes.length).fill(0).map((o,l)=>i[r][a][s][l]).map((o,l)=>({classScore:o,label:l})).reduce((o,l)=>o.classScore>l.classScore?o:l)}};jZ.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var $Z=jZ,brt=class extends $Z{constructor(e=!0){let t={withSeparableConvs:e,iouThreshold:urt,classes:["face"],...e?{anchors:drt,meanRgb:hrt}:{anchors:crt,withClassScores:!0}};super(t)}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new Hi(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return this.withSeparableConvs?frt:prt}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},RZ=class extends kM{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},Xb=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function SM(e,t,n,r,a=({alignedRect:s})=>s){let s=e.map(l=>kZ(l)?a(l):l.detection),i=r||(t instanceof Dt?await pZ(t,s):await hZ(t,s)),o=await n(i);return i.forEach(l=>l instanceof Dt&&l.dispose()),o}var wrt=.4,Nrt=[new xn(1.603231,2.094468),new xn(6.041143,7.080126),new xn(2.882459,3.518061),new xn(4.266906,5.178857),new xn(9.041765,10.66308)],krt=[117.001,114.697,97.404],Srt=class extends $Z{constructor(){let e={withSeparableConvs:!0,iouThreshold:wrt,classes:["face"],anchors:Nrt,meanRgb:krt,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};super(e)}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new Hi(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},Co={ssdMobilenetv1:new lrt,tinyFaceDetector:new Srt,tinyYolov2:new brt,faceLandmark68Net:new Rnt,faceLandmark68TinyNet:new Fnt,faceRecognitionNet:new Vnt,faceExpressionNet:new gnt,ageGenderNet:new $nt},_rt=class extends Xb{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},_M=class extends _rt{async run(){let e=await this.parentTask,t=await SM(e,this.input,async n=>Promise.all(n.map(r=>Co.faceExpressionNet.predictExpressions(r))),this.extractedFaces);return e.map((n,r)=>xnt(n,t[r]))}withAgeAndGender(){return new IM(this,this.input)}},CM=class extends _M{withAgeAndGender(){return new EM(this,this.input)}withFaceDescriptors(){return new TM(this,this.input)}},Crt=class extends Xb{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},IM=class extends Crt{async run(){let e=await this.parentTask,t=await SM(e,this.input,async n=>Promise.all(n.map(r=>Co.ageGenderNet.predictAgeAndGender(r))),this.extractedFaces);return e.map((n,r)=>{let{age:a,gender:s,genderProbability:i}=t[r];return Gnt(qnt(n,s,i),a)})}withFaceExpressions(){return new _M(this,this.input)}},EM=class extends IM{withFaceExpressions(){return new CM(this,this.input)}withFaceDescriptors(){return new TM(this,this.input)}},Irt=class extends Xb{constructor(e,t){super(),this.parentTask=e,this.input=t}},TM=class extends Irt{async run(){let e=await this.parentTask;return(await SM(e,this.input,t=>Promise.all(t.map(n=>Co.faceRecognitionNet.computeFaceDescriptor(n))),null,t=>t.landmarks.align(null,{useDlibAlignment:!0}))).map((t,n)=>Hnt(e[n],t))}withFaceExpressions(){return new CM(this,this.input)}withAgeAndGender(){return new EM(this,this.input)}},Ert=class extends Xb{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=n}get landmarkNet(){return this.useTinyLandmarkNet?Co.faceLandmark68TinyNet:Co.faceLandmark68Net}},Trt=class extends Ert{async run(){let e=await this.parentTask,t=e.map(a=>a.detection),n=this.input instanceof Dt?await pZ(this.input,t):await hZ(this.input,t),r=await Promise.all(n.map(a=>this.landmarkNet.detectLandmarks(a)));return n.forEach(a=>a instanceof Dt&&a.dispose()),e.filter((a,s)=>r[s]).map((a,s)=>wnt(a,r[s]))}withFaceExpressions(){return new CM(this,this.input)}withAgeAndGender(){return new EM(this,this.input)}withFaceDescriptors(){return new TM(this,this.input)}},jrt=class extends Xb{constructor(e,t=new JS){super(),this.input=e,this.options=t}},Art=class extends jrt{async run(){let{input:e,options:t}=this,n;if(t instanceof RZ)n=Co.tinyFaceDetector.locateFaces(e,t);else if(t instanceof JS)n=Co.ssdMobilenetv1.locateFaces(e,t);else if(t instanceof kM)n=Co.tinyYolov2.locateFaces(e,t);else throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");return n}runAndExtendWithFaceDetections(){return new Promise((e,t)=>{this.run().then(n=>e(n.map(r=>nnt({},r)))).catch(n=>t(n))})}withFaceLandmarks(e=!1){return new Trt(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new _M(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new IM(this.runAndExtendWithFaceDetections(),this.input)}};function $rt(e,t=new JS){return new Art(e,t)}let V3=!1;const Rrt=async()=>{if(!V3)try{const e="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/model";await Promise.all([Co.tinyFaceDetector.loadFromUri(e),Co.faceLandmark68Net.loadFromUri(e)]),V3=!0,console.log("Face detection models loaded successfully")}catch(e){throw console.error("Error loading face detection models:",e),new Error("Failed to load face detection models")}},Drt=async e=>{try{await Rrt();const t=await Mrt(e);return(await $rt(t,new RZ).withFaceLandmarks()).length>0}catch(t){return console.error("Error detecting face:",t),!1}},Mrt=e=>new Promise((t,n)=>{const r=new Image,a=new FileReader;a.onload=s=>{var i;r.onload=()=>t(r),r.onerror=()=>n(new Error("Failed to load image")),r.src=(i=s.target)==null?void 0:i.result},a.onerror=()=>n(new Error("Failed to read file")),a.readAsDataURL(e)}),Ort=()=>{const e=Pr(),{toast:t}=Qt(),{selectedLanguage:n}=gA(),[r,a]=N.useState([]),[s,i]=N.useState([]),[o,l]=N.useState([]),[c,u]=N.useState([]),[h,p]=N.useState([]),[f,g]=N.useState([]),[m,y]=N.useState([]),[x,v]=N.useState(""),[b,w]=N.useState({states:!1,districts:!1,blocks:!1}),[k,I]=N.useState({profileImage:null,firstName:"",middleName:"",lastName:"",dateOfBirth:"",whatsappNumber:"",alternateNumber:"",email:"",gender:"",state:"",stateCode:"",district:"",districtCode:"",block:"",blockCode:"",city:"",pinCode:"",currentStatus:"",maximumQualification:"",schoolMedium:"",casteTribe:"",religion:""}),[C,S]=N.useState(null),E=B=>({image_url:B.profileImage||null,first_name:B.firstName,middle_name:B.middleName,last_name:B.lastName,dob:B.dateOfBirth,whatsapp_number:B.whatsappNumber,phone_number:B.alternateNumber,email:B.email,gender:B.gender,state:B.state,state_code:B.stateCode,district:B.district,district_code:B.districtCode,block:B.block,block_code:B.blockCode,city:B.city,pin_code:B.pinCode,school_medium:B.schoolMedium,current_status_id:Number(B.currentStatus)||null,qualification_id:Number(B.maximumQualification)||null,cast_id:Number(B.casteTribe)||null,religion_id:Number(B.religion)||null}),T=async()=>{try{w(X=>({...X,states:!0}));const B=await XN();let Q=[];Array.isArray(B)?Q=B:B&&Array.isArray(B.data)?Q=B.data:B&&B.states?Q=B.states:B&&B.result&&(Q=B.result),p(Q||[])}catch{t({title:"Error",description:"Failed to load states",variant:"destructive"}),p([])}finally{w(B=>({...B,states:!1}))}},$=async B=>{if(!B){g([]),y([]);return}try{w(pe=>({...pe,districts:!0}));const Q=await YN(B);let X=[];Array.isArray(Q)?X=Q:Q&&Array.isArray(Q.data)?X=Q.data:Q&&Q.districts?X=Q.districts:Q&&Q.result&&(X=Q.result),g(X||[])}catch(Q){console.error("Error fetching districts:",Q),t({title:"Error",description:"Failed to load districts",variant:"destructive"}),g([])}finally{w(Q=>({...Q,districts:!1}))}},_=async B=>{if(!B){y([]);return}try{w(pe=>({...pe,blocks:!0}));const Q=await bj(B);let X=[];Array.isArray(Q)?X=Q:Q&&Array.isArray(Q.data)?X=Q.data:Q&&Q.blocks?X=Q.blocks:Q&&Q.result&&(X=Q.result),y(X||[])}catch{t({title:"Error",description:"Failed to load blocks",variant:"destructive"}),y([])}finally{w(Q=>({...Q,blocks:!1}))}};N.useEffect(()=>{const B=localStorage.getItem("studentFormData");if(B){const oe=JSON.parse(B);I(oe),oe.stateCode&&$(oe.stateCode),oe.districtCode&&_(oe.districtCode)}T(),(async()=>{try{const oe=await GN();a(oe)}catch{}})(),(async()=>{try{const oe=await yj();i(oe)}catch{}})(),(async()=>{try{const oe=await the();l(oe)}catch{}})(),(async()=>{try{const oe=await qN();u(oe)}catch{}})()},[]);const M=B=>{const{name:Q,value:X}=B.target;let pe={...k,[Q]:X};if(Q==="stateCode"){const ie=h.find(oe=>oe.state_code===X);pe={...pe,stateCode:X,state:(ie==null?void 0:ie.state_name)||"",district:"",districtCode:"",block:"",blockCode:""},g([]),y([]),X&&$(X)}if(Q==="districtCode"){const ie=f.find(oe=>oe.district_code===X);pe={...pe,districtCode:X,district:(ie==null?void 0:ie.district_name)||"",block:"",blockCode:""},y([]),X&&_(X)}if(Q==="blockCode"){const ie=m.find(oe=>oe.block_code===X);pe={...pe,blockCode:X,block:(ie==null?void 0:ie.block_name)||""}}I(pe),localStorage.setItem("studentFormData",JSON.stringify(pe)),Q==="email"&&(L(X)?v(""):v("Please enter a valid email address"))},L=B=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B),U=async B=>{var X;const Q=(X=B.target.files)==null?void 0:X[0];if(Q){if(t({title:W.verifying||"Verifying...",description:W.verifyingMessage||"Please wait while we verify the image..."}),!await Drt(Q)){t({variant:"destructive",title:W.noFaceDetected||"No Face Detected",description:W.noFaceMessage||"Please upload an image with a clear human face."}),B.target.value="";return}const ie={...k,profileImage:Q};I(ie);const oe=new FileReader;oe.onloadend=()=>{S(oe.result)},oe.readAsDataURL(Q),t({title:W.faceVerified||"Face Verified",description:W.faceVerifiedMessage||"Image uploaded successfully!"})}},O=B=>{if(!B)return 0;const Q=new Date(B);return(new Date().getTime()-Q.getTime())/(1e3*60*60*24*365.25)},F=()=>{const B=O(k.dateOfBirth);return k.profileImage&&k.firstName&&k.dateOfBirth&&k.whatsappNumber&&k.gender&&k.stateCode&&k.districtCode&&k.city&&k.pinCode&&k.currentStatus&&k.maximumQualification&&k.schoolMedium&&k.casteTribe&&k.religion&&B>=16.5},D=async()=>{const B=O(k.dateOfBirth);if(!k.profileImage)return t({title:"Profile Image Required",description:"Please upload a profile image.",variant:"destructive"});if(!k.firstName)return t({title:"First Name Required",description:"Please enter your first name.",variant:"destructive"});if(!k.dateOfBirth||B<16.5)return t({title:"Invalid Date of Birth",description:"You must be at least 16.5 years old.",variant:"destructive"});if(!k.whatsappNumber||!/^\d{10}$/.test(k.whatsappNumber))return t({title:"Invalid WhatsApp Number",description:"Enter a valid 10-digit WhatsApp number.",variant:"destructive"});if(!k.gender)return t({title:"Gender Required",description:"Please select your gender.",variant:"destructive"});if(!k.stateCode||!k.districtCode||!k.city||!k.pinCode)return t({title:"Address Required",description:"Please fill all required address fields.",variant:"destructive"});if(!k.currentStatus||!k.maximumQualification||!k.schoolMedium||!k.casteTribe||!k.religion)return t({title:"Additional Info Required",description:"Please fill all required additional fields.",variant:"destructive"});try{const Q=E(k);await OW(Q),localStorage.setItem("registrationDone","true"),localStorage.setItem("studentFormData",JSON.stringify(k)),t({title:"Student Created",description:"Your registration was successful!",variant:"default"}),e("/students/test/start")}catch(Q){console.error("Error creating student:",Q),t({title:"Registration Failed",description:Q.message||"Something went wrong while creating student.",variant:"destructive"})}},R=()=>{e("/students/details/instructions")},V=()=>{const B=new Date;return B.setFullYear(B.getFullYear()-16),B.setMonth(B.getMonth()-6),B.toISOString().split("T")[0]},W=(()=>{switch(n){case"hindi":return{signUp:"साइन अप करें",addPhoto:"फोटो जोड़ें",basicDetails:"बुनियादी विवरण",contactInfo:"संपर्क जानकारी",firstName:"पहला नाम *",middleName:"मध्य नाम",lastName:"अंतिम नाम ",dateOfBirth:"जन्म तिथि *",gender:"लिंग *",male:"पुरुष",female:"महिला",whatsappNumber:"व्हाट्सऐप नंबर *",alternateNumber:"वैकल्पिक नंबर",email:"ईमेल पता ",state:"राज्य चुनें *",district:"जिला चुनें *",block:"ब्लॉक चुनें",city:"शहर *",pinCode:"पिन कोड *",currentStatus:"वर्तमान स्थिति *",maximumQualification:"अधिकतम योग्यता *",schoolMedium:"स्कूल माध्यम *",casteTribe:"जाति/जनजाति *",religion:"धर्म *",back:"वापस",saveContinue:"सहेजें और जारी रखें",selectState:"राज्य चुनें",selectDistrict:"जिला चुनें",selectBlock:"ब्लॉक चुनें",selectOption:"विकल्प चुनें",selectQualification:"योग्यता चुनें",selectMedium:"माध्यम चुनें",selectReligion:"धर्म चुनें",enterFirstName:"पहला नाम दर्ज करें",enterMiddleName:"मध्य नाम दर्ज करें",enterLastName:"अंतिम नाम दर्ज करें",enterWhatsapp:"व्हाट्सऐप नंबर दर्ज करें",enterAlternate:"वैकल्पिक नंबर दर्ज करें",enterEmail:"ईमेल पता दर्ज करें",cityExample:"उदा. मुंबई",pinCodeExample:"उदा. 400001",verifying:"सत्यापन हो रहा है...",verifyingMessage:"कृपया प्रतीक्षा करें जबकि हम छवि सत्यापित करते हैं...",noFaceDetected:"कोई चेहरा नहीं मिला",noFaceMessage:"कृपया स्पष्ट मानव चेहरे वाली छवि अपलोड करें।",faceVerified:"चेहरा सत्यापित",faceVerifiedMessage:"छवि सफलतापूर्वक अपलोड की गई!"};case"marathi":return{signUp:"साइन अप करा",addPhoto:"फोटो जोडा",basicDetails:"मूलभूत तपशील",contactInfo:"संपर्क तपशील",firstName:"पहिले नाव *",middleName:"मध्यम नाव",lastName:"आडनाव ",dateOfBirth:"जन्म तारीख *",gender:"लिंग *",male:"पुरुष",female:"स्त्री",whatsappNumber:"व्हाट्सअॅप नंबर *",alternateNumber:"पर्यायी नंबर",email:"ईमेल पत्ता ",state:"राज्य निवडा *",district:"जिल्हा निवडा *",block:"ब्लॉक निवडा",city:"शहर *",pinCode:"पिन कोड *",currentStatus:"सध्याची स्थिती *",maximumQualification:"कमाल पात्रता *",schoolMedium:"शाळेचे माध्यम *",casteTribe:"जात/आदिवासी *",religion:"धर्म *",back:"मागे",saveContinue:"जतन करा आणि सुरू ठेवा",selectState:"राज्य निवडा",selectDistrict:"जिल्हा निवडा",selectBlock:"ब्लॉक निवडा",selectOption:"पर्याय निवडा",selectQualification:"पात्रता निवडा",selectMedium:"माध्यम निवडा",selectReligion:"धर्म निवडा",enterFirstName:"पहिले नाव प्रविष्ट करा",enterMiddleName:"मध्यम नाव प्रविष्ट करा",enterLastName:"आडनाव प्रविष्ट करा",enterWhatsapp:"व्हाट्सअॅप नंबर प्रविष्ट करा",enterAlternate:"पर्यायी नंबर प्रविष्ट करा",enterEmail:"ईमेल पत्ता प्रविष्ट करा",cityExample:"उदा. पुणे",pinCodeExample:"उदा. 411001",verifying:"पडताळणी करत आहे...",verifyingMessage:"कृपया प्रतीक्षा करा जेव्हा आम्ही प्रतिमा सत्यापित करतो...",noFaceDetected:"चेहरा सापडला नाही",noFaceMessage:"कृपया स्पष्ट मानवी चेहऱ्याची प्रतिमा अपलोड करा.",faceVerified:"चेहरा सत्यापित",faceVerifiedMessage:"प्रतिमा यशस्वीरित्या अपलोड केली!"};default:return{signUp:"Sign Up",addPhoto:"Add Photo",basicDetails:"Basic Details",contactInfo:"Contact Information",firstName:"First Name *",middleName:"Middle Name",lastName:"Last Name",dateOfBirth:"Date of Birth *",gender:"Gender *",male:"Male",female:"Female",whatsappNumber:"WhatsApp Number *",alternateNumber:"Alternate Number",email:"Email Address",state:"Select State *",district:"Select District *",block:"Select Block",city:"City *",pinCode:"Pin Code *",currentStatus:"Current Status *",maximumQualification:"Maximum Qualification *",schoolMedium:"School Medium *",casteTribe:"Caste/Tribe *",religion:"Religion *",back:"Back",saveContinue:"Save & Continue",selectState:"Select State",selectDistrict:"Select District",selectBlock:"Select Block",selectOption:"Select Option",selectQualification:"Select Qualification",selectMedium:"Select Medium",selectReligion:"Select Religion",enterFirstName:"Enter first name",enterMiddleName:"Enter middle name",enterLastName:"Enter last name",enterWhatsapp:"Enter WhatsApp number",enterAlternate:"Enter alternate number",enterEmail:"Enter email address",cityExample:"Ex. Bangalore",pinCodeExample:"Ex. 4402xx",verifying:"Verifying...",verifyingMessage:"Please wait while we verify the image...",noFaceDetected:"No Face Detected",noFaceMessage:"Please upload an image with a clear human face.",faceVerified:"Face Verified",faceVerifiedMessage:"Image uploaded successfully!"}}})();return d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"text-center mb-6",children:[d.jsx(Gm,{}),d.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2 ",children:W.signUp})]}),d.jsx("div",{className:"text-center",children:d.jsxs("div",{className:"w-24 h-24 mx-auto border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center bg-gray-50 relative cursor-pointer hover:border-orange-400 transition-colors",children:[C?d.jsx("img",{src:C,alt:"Profile",className:"w-full h-full object-cover rounded-xl"}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center mb-1",children:d.jsx("span",{className:"text-white text-sm",children:"📷"})}),d.jsx("span",{className:"text-xs text-gray-500",children:W.addPhoto})]}),d.jsx("input",{type:"file",accept:"image/*",onChange:U,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]})}),d.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:W.basicDetails}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.firstName}),d.jsx("input",{type:"text",name:"firstName",value:k.firstName,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:W.enterFirstName})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.middleName}),d.jsx("input",{type:"text",name:"middleName",value:k.middleName,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:W.enterMiddleName})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.lastName}),d.jsx("input",{type:"text",name:"lastName",value:k.lastName,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:W.enterLastName})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.dateOfBirth}),d.jsx("div",{className:"relative",children:d.jsx("input",{type:"date",name:"dateOfBirth",value:k.dateOfBirth,onChange:M,max:V(),className:"w-full p-3 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.gender}),d.jsxs("div",{className:"flex space-x-4",children:[d.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[d.jsx("input",{type:"radio",name:"gender",value:"male",checked:k.gender==="male",onChange:M,className:"text-orange-500 focus:ring-orange-500"}),d.jsx("span",{className:"text-sm",children:W.male})]}),d.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[d.jsx("input",{type:"radio",name:"gender",value:"female",checked:k.gender==="female",onChange:M,className:"text-orange-500 focus:ring-orange-500"}),d.jsx("span",{className:"text-sm",children:W.female})]})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:W.contactInfo}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.whatsappNumber}),d.jsx("input",{type:"tel",name:"whatsappNumber",maxLength:10,pattern:"[0-9]{10}",value:k.whatsappNumber,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:W.enterWhatsapp})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.alternateNumber}),d.jsx("input",{type:"tel",name:"alternateNumber",maxLength:10,pattern:"[0-9]{10}",value:k.alternateNumber,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:W.enterAlternate})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[W.email," *"]}),d.jsx("input",{type:"email",name:"email",value:k.email,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:W.enterEmail}),x&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:x})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Additional Information"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.state}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"stateCode",value:k.stateCode,onChange:M,disabled:b.states,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[d.jsx("option",{value:"",children:b.states?W.loading:W.selectState}),Array.isArray(h)&&h.map(B=>d.jsx("option",{value:B.state_code,children:B.state_name},B.state_code))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.district}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"districtCode",value:k.districtCode,onChange:M,disabled:b.districts||!k.stateCode,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[d.jsx("option",{value:"",children:b.districts?W.loading:k.stateCode?W.selectDistrict:"Select state first"}),Array.isArray(f)&&f.map(B=>d.jsx("option",{value:B.district_code,children:B.district_name},B.district_code))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.block}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"blockCode",value:k.blockCode,onChange:M,disabled:b.blocks||!k.districtCode,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[d.jsx("option",{value:"",children:b.blocks?W.loading:k.districtCode?W.selectBlock:"Select district first"}),Array.isArray(m)&&m.map(B=>d.jsx("option",{value:B.block_code,children:B.block_name},B.block_code))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.city}),d.jsx("input",{type:"text",name:"city",value:k.city,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter city"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:W.cityExample})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.pinCode}),d.jsx("input",{type:"text",name:"pinCode",value:k.pinCode,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter pin code"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:W.pinCodeExample})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.currentStatus}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"currentStatus",value:k.currentStatus,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[d.jsx("option",{value:"",children:W.selectOption}),o.map(B=>d.jsx("option",{value:B.id,children:B.current_status_name},B.id))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.maximumQualification}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"maximumQualification",value:k.maximumQualification,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[d.jsx("option",{value:"",children:W.selectQualification}),s.map(B=>d.jsx("option",{value:B.id,children:B.qualification_name},B.id))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.schoolMedium}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"schoolMedium",value:k.schoolMedium,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[d.jsx("option",{value:"",children:W.selectMedium}),d.jsx("option",{value:"English",children:"English"}),d.jsx("option",{value:"Hindi",children:"Hindi"}),d.jsx("option",{value:"Marathi",children:"Marathi"}),d.jsx("option",{value:"Other",children:"Other"})]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.casteTribe}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"casteTribe",value:k.casteTribe,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[d.jsx("option",{value:"",children:W.selectOption}),r.map(B=>d.jsx("option",{value:B.id,children:B.cast_name},B.id))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:W.religion}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{name:"religion",value:k.religion,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[d.jsx("option",{value:"",children:W.selectReligion}),c.map(B=>d.jsx("option",{value:B.id,children:B.religion_name},B.id))]}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:d.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})]}),d.jsxs("div",{className:"flex justify-center space-x-4",children:[d.jsx("button",{onClick:R,className:"px-6 py-2 bg-gray-300 text-gray-500 rounded-lg hover:bg-gray-600 transition duration-200",children:W.back}),d.jsx("button",{onClick:D,disabled:!F(),className:`px-6 py-2 rounded-lg transition duration-200 ${F()?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:W.saveContinue})]}),d.jsxs("div",{className:"flex justify-center space-x-2 mt-6",children:[d.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),d.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),d.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"})]})]})})},DZ=N.createContext(void 0),H3="tests_data",Frt=({children:e})=>{const[t,n]=N.useState(()=>{const a=localStorage.getItem(H3);return a?JSON.parse(a):[]});N.useEffect(()=>{localStorage.setItem(H3,JSON.stringify(t))},[t]);const r=(a,s)=>n(i=>i.map(o=>o.id===a?{...o,slotBooking:{...o.slotBooking,...s}}:o));return d.jsx(DZ.Provider,{value:{tests:t,setTests:n,updateSlot:r},children:e})},ZS=()=>{const e=N.useContext(DZ);if(!e)throw new Error("useTests must be used inside TestsProvider");return e},MZ=N.createContext({student:null,setStudent:()=>{}}),Prt=({children:e})=>{const[t,n]=N.useState(null);return N.useEffect(()=>{const r=localStorage.getItem("studentFormData");if(r)try{const a=JSON.parse(r);n(a)}catch(a){console.error("Error parsing studentFormData:",a)}},[]),d.jsx(MZ.Provider,{value:{student:t,setStudent:n},children:e})},OZ=()=>N.useContext(MZ),Lrt="203783247002-amrp0mkp58jna7mhcf368vcn0ilnq7hd.apps.googleusercontent.com",zrt="https://www.googleapis.com/auth/calendar.events";let fl=null,M0=null;const Brt=()=>new Promise((e,t)=>{try{if(typeof window>"u"){t(new Error("Window object not available"));return}if(window.google){console.log("Google Identity Services already loaded"),G3(),e(!0);return}const n=document.createElement("script");n.src="https://accounts.google.com/gsi/client",n.async=!0,n.defer=!0,n.onload=()=>{console.log("Google Identity Services loaded successfully"),G3(),e(!0)},n.onerror=r=>{console.error("Failed to load Google Identity Services:",r),t(new Error("Failed to load Google Identity Services"))},document.head.appendChild(n)}catch(n){console.error("Error initializing Google Identity Services:",n),t(n)}}),G3=()=>{try{const e=window.google;if(!e)throw new Error("Google Identity Services not loaded");M0=e.accounts.oauth2.initTokenClient({client_id:Lrt,scope:zrt,callback:t=>{if(t.error)throw console.error("Token client error:",t),new Error(t.error);fl=t.access_token,console.log("Access token received successfully")}}),console.log("Token client initialized successfully")}catch(e){throw console.error("Error initializing token client:",e),e}},Urt=async()=>new Promise((e,t)=>{try{if(!M0)throw new Error("Token client not initialized. Please refresh the page.");console.log("Requesting access token..."),M0.callback=n=>{if(n.error){console.error("Sign-in error:",n),t(new Error(n.error_description||n.error||"Failed to sign in"));return}fl=n.access_token,console.log("Sign-in successful, access token received"),e(!0)},M0.requestAccessToken({prompt:"select_account"})}catch(n){console.error("Error during sign-in:",n),t(n)}}),DC=()=>fl!=null&&fl!=="",Wrt=async e=>{var t;try{if(!fl)throw new Error("Not authenticated. Please sign in first.");const n={summary:e.summary,description:e.description,start:{dateTime:e.startDateTime,timeZone:"Asia/Kolkata"},end:{dateTime:e.endDateTime,timeZone:"Asia/Kolkata"},attendees:[{email:e.attendeeEmail}],conferenceData:{createRequest:{requestId:`meet-${Date.now()}`,conferenceSolutionKey:{type:"hangoutsMeet"}}},reminders:{useDefault:!1,overrides:[{method:"email",minutes:24*60},{method:"popup",minutes:30}]}};console.log("Creating calendar event...");const r=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events?conferenceDataVersion=1&sendUpdates=all",{method:"POST",headers:{Authorization:`Bearer ${fl}`,"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const s=await r.json();throw console.error("Calendar API error:",s),new Error(((t=s.error)==null?void 0:t.message)||"Failed to create calendar event")}const a=await r.json();return console.log("Calendar event created successfully:",a.id),{success:!0,eventId:a.id,meetLink:a.hangoutLink,htmlLink:a.htmlLink}}catch(n){throw console.error("Error creating calendar event:",n),n}},Vrt=async e=>{var t;try{if(!fl)throw new Error("Not authenticated. Please sign in first.");console.log("Deleting calendar event:",e);const n=await fetch(`https://www.googleapis.com/calendar/v3/calendars/primary/events/${e}?sendUpdates=all`,{method:"DELETE",headers:{Authorization:`Bearer ${fl}`}});if(!n.ok){const r=await n.json();throw console.error("Calendar API error:",r),new Error(((t=r.error)==null?void 0:t.message)||"Failed to delete calendar event")}return console.log("Calendar event deleted successfully"),{success:!0}}catch(n){throw console.error("Error deleting calendar event:",n),n}},q3=(e,t)=>`${e}T${t}:00+05:30`,Hrt=()=>{const{student:e}=OZ(),{tests:t,updateSlot:n}=ZS(),{id:r}=UT(),a=Number(r),s={firstName:"Test",lastName:"Student",email:"test@example.com",whatsappNumber:"1234567890",city:"Test City"},i={id:a,name:"Technical Interview",status:"Pending",action:"slot-book",score:null,slotBooking:{status:"Pending"}},o=t.find(X=>X.id===a)||i,l=e||s,c=[{id:1,from:"9:00",to:"10:00"},{id:2,from:"10:00",to:"11:00"},{id:3,from:"11:00",to:"12:00"},{id:4,from:"12:00",to:"13:00"},{id:5,from:"13:00",to:"14:00"},{id:6,from:"14:00",to:"15:00"}],[u,h]=N.useState(!0),[p,f]=N.useState({from:"",to:"",id:null,is_cancelled:!0}),[g,m]=N.useState(new Date),[y,x]=N.useState(c),[v,b]=N.useState(!1),[w,k]=N.useState(""),[I,C]=N.useState("success"),[S,E]=N.useState(!1),[T,$]=N.useState(!1),[_,M]=N.useState(!1),L=Pr(),U=X=>X.toISOString().split("T")[0],O=X=>{const[pe,ie]=X.split(":"),oe=new Date;return oe.setHours(parseInt(pe),parseInt(ie)),oe.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},F=X=>X.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),D=(X,pe)=>{k(X),C(pe),b(!0),setTimeout(()=>b(!1),5e3)},R=async()=>{try{return $(!0),M(!0),DC()||(D("Opening Google Sign-in popup... Please allow popups if blocked.","info"),await Urt(),E(!0),M(!1),D("Google Sign-in successful!","success")),!0}catch(X){console.error("Google sign-in error:",X),M(!1);let pe="Failed to sign in with Google. Please try again.";return X.message&&X.message.includes("popup")?pe="Sign-in popup was closed. Please click the button again and complete the sign-in.":X.message&&X.message.includes("access_denied")?pe="Access denied. Please grant calendar permissions to continue.":X.message&&(pe=X.message),D(pe,"error"),!1}finally{$(!1)}},V=async X=>{try{const pe=q3(X.on_date,X.start_time),ie=q3(X.on_date,X.end_time_expected),oe={summary:`${X.topic_name} - Interview`,description:`Interview scheduled for ${X.student_name}
Topic: ${X.topic_name}`,startDateTime:pe,endDateTime:ie,attendeeEmail:l.email,studentName:X.student_name};return await Wrt(oe)}catch(pe){throw console.error("Error creating calendar event:",pe),pe}},G=async()=>{if(!(!p.id||!l||!o))try{if($(!0),!DC()&&!await R())return;const X={...p,is_cancelled:!1,on_date:U(g),start_time:p.from,end_time_expected:p.to,student_name:`${l.firstName} ${l.lastName}`,topic_name:o.name};D("Creating Google Meet...","info");const pe=await V(X);X.calendar_event_id=pe.eventId,X.meet_link=pe.meetLink,f(X),localStorage.setItem(`bookedSlot_${a}`,JSON.stringify(X)),n(a,{status:"Booked",scheduledTime:`${X.on_date} ${X.start_time}`}),D("Slot Booked & Meet Scheduled Successfully!","success")}catch(X){console.error("Booking error:",X),D("Failed to book slot. Please try again.","error")}finally{$(!1)}},W=async()=>{if(o)try{if(p.calendar_event_id)try{await Vrt(p.calendar_event_id)}catch(X){console.error("Error deleting calendar event:",X)}f({from:"",to:"",id:null,is_cancelled:!0}),localStorage.removeItem(`bookedSlot_${a}`),n(a,{status:"Pending",scheduledTime:""}),D("Slot Cancelled & Meet Removed","info")}catch{D("Error cancelling slot","error")}},B=()=>L("/students/result"),Q=()=>{const X=localStorage.getItem(`bookedSlot_${a}`);if(X)try{f(JSON.parse(X))}catch{f({from:"",to:"",id:null,is_cancelled:!0})}else f({from:"",to:"",id:null,is_cancelled:!0})};return N.useEffect(()=>((async()=>{try{await Brt(),DC()&&E(!0),Q(),x(c)}catch(pe){console.error("Initialization error:",pe);const ie=pe.message||"Failed to initialize Google Calendar. Please check console for details.";D(ie,"error")}finally{h(!1)}})(),window.addEventListener("storage",Q),()=>window.removeEventListener("storage",Q)),[a]),u?d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsx(wo,{className:"w-12 h-12 text-orange-600 animate-spin"})}):!e||!o?d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-md text-center",children:[d.jsx(l1,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),d.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Cannot Book Slot"}),d.jsx("p",{className:"text-gray-600",children:"Student or test data not found."})]})}):d.jsxs("div",{className:"min-h-screen bg-gradient-to-r from-orange-500 to-red-500 py-8 px-4",children:[v&&d.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-all duration-300 ${I==="success"?"bg-green-500":I==="error"?"bg-red-500":"bg-orange-500"} text-white`,children:d.jsxs("div",{className:"flex items-center space-x-2",children:[I==="success"&&d.jsx(dd,{className:"w-5 h-5"}),I==="error"&&d.jsx(l1,{className:"w-5 h-5"}),I==="info"&&d.jsx(Eo,{className:"w-5 h-5"}),d.jsx("span",{children:w})]})}),_&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsx("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md mx-4 animate-fade-in",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"flex justify-center mb-4",children:d.jsx(wo,{className:"w-16 h-16 text-orange-600 animate-spin"})}),d.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Sign in with Google"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"A popup window should have opened for Google sign-in."}),d.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:d.jsxs("p",{className:"text-sm text-gray-700",children:[d.jsx("strong",{children:"Popup blocked?"}),d.jsx("br",{}),"Please allow popups for this site and try again."]})}),d.jsx("p",{className:"text-xs text-gray-500",children:"Grant calendar permissions to schedule your interview."})]})})}),d.jsx("div",{className:"max-w-4xl mx-auto",children:p.is_cancelled?d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[d.jsxs("div",{className:"bg-orange-400 px-8 py-6 text-white",children:[d.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Book Interview Slot"}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(Ai,{className:"w-5 h-5"}),d.jsxs("span",{className:"text-lg",children:["Book Interview Slot for ",l.firstName," ",l.lastName]})]})]}),d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[d.jsx(Eo,{className:"w-6 h-6 mr-2 text-orange-600"}),"Select Date"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsx("input",{type:"date",value:U(g),onChange:X=>m(new Date(X.target.value)),min:U(new Date),max:U(new Date(Date.now()+15*24*60*60*1e3)),className:"w-full p-3 border border-gray-300 rounded-lg"}),d.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Selected Date:"}),d.jsx("p",{className:"text-lg font-semibold text-orange-600",children:F(g)})]})]})]}),d.jsxs("div",{className:"mb-8",children:[d.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[d.jsx(To,{className:"w-6 h-6 mr-2 text-orange-600"}),"Available Time Slots"]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(({id:X,from:pe,to:ie})=>d.jsxs("button",{onClick:()=>f({id:X,from:pe,to:ie,is_cancelled:!0}),className:`p-4 rounded-lg border-2 transition-all ${p.id===X?"border-orange-500 bg-orange-50":"border-gray-200 bg-white"}`,children:[O(pe)," - ",O(ie)]},X))})]}),!S&&p.id&&d.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(F_,{className:"w-5 h-5 text-blue-600 mt-0.5"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Google Meet Setup Required"}),d.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"You'll need to sign in with Google to automatically create a Meet link for your interview."}),d.jsx("p",{className:"text-xs text-blue-600",children:'ℹ️ A popup will open for sign-in when you click "Book Slot"'})]})]})}),S&&p.id&&d.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(dd,{className:"w-5 h-5 text-green-600"}),d.jsx("p",{className:"text-sm text-green-700",children:"✓ Google account connected. Meet link will be created automatically."})]})}),d.jsx("button",{onClick:G,disabled:!p.id||T,className:`w-full py-4 px-6 rounded-lg font-semibold text-lg transition-all ${!p.id||T?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-orange-600 to-orange-400 text-white hover:from-orange-700 hover:to-orange-500"}`,children:T?d.jsxs("span",{className:"flex items-center justify-center",children:[d.jsx(wo,{className:"w-5 h-5 mr-2 animate-spin"}),"Booking..."]}):p.id?"Book Selected Slot & Schedule Meet":"Select a Time Slot"})]})]}):d.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[d.jsx("div",{className:"bg-orange-400 px-8 py-6 text-white",children:d.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-2",children:[d.jsx(dd,{className:"w-8 h-8"}),d.jsx("h1",{className:"text-3xl font-bold",children:"Interview Slot Booked"})]})}),d.jsxs("div",{className:"p-8",children:[d.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Slot Details"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Student Name"}),d.jsx("p",{className:"text-lg font-semibold",children:p.student_name}),d.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Topic"}),d.jsx("p",{className:"text-lg font-semibold",children:p.topic_name})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),d.jsx("p",{className:"text-lg font-semibold",children:p.on_date&&F(new Date(p.on_date))}),d.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Time"}),d.jsx("p",{className:"text-lg font-semibold",children:p.start_time&&p.end_time_expected&&`${O(p.start_time)} - ${O(p.end_time_expected)}`})]})]}),p.meet_link&&d.jsxs("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-6 mb-6",children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx(F_,{className:"w-6 h-6 text-green-600 mr-2"}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Google Meet Link"})]}),d.jsxs("a",{href:p.meet_link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors",children:[d.jsx(F_,{className:"w-5 h-5 mr-2"}),"Join Google Meet"]}),d.jsx("p",{className:"text-sm text-gray-600 mt-3",children:"Meeting link has been sent to your email as well."})]}),d.jsx("button",{onClick:W,className:"w-full md:w-auto py-3 px-8 m-2 bg-gradient-to-r from-orange-500 to-red-500 text-white font-semibold rounded-lg",children:"Reschedule Slot"}),d.jsx("button",{onClick:B,className:"w-full md:w-auto py-3 px-8 m-2 bg-gradient-to-r from-green-400 to-green-500 text-white font-semibold rounded-lg",children:"Result Section"})]})]})})]})},Grt=()=>{const{student:e,setStudent:t}=OZ();N.useEffect(()=>{const r=setTimeout(()=>{n()},3e3);return()=>clearTimeout(r)},[]);const n=()=>{const r=`Hello! I am ${e==null?void 0:e.firstName}. I have successfully completed the test and booked my interview slot. My phone number is ${e} and email is ${e==null?void 0:e.email}.`,a=`https://wa.me/YOUR_WHATSAPP_NUMBER?text=${encodeURIComponent(r)}`;window.open(a,"_blank")};return d.jsx("div",{className:"whatsapp-redirect",children:d.jsxs("div",{className:"success-message",children:[d.jsx("h2",{children:"🎉 Slot Booked Successfully!"}),d.jsxs("p",{children:["Thank you ",e==null?void 0:e.firstName,"! Your interview slot has been confirmed."]}),d.jsx("p",{children:"You will be redirected to WhatsApp to connect with our team."}),d.jsxs("div",{className:"redirect-info",children:[d.jsx("p",{children:"Redirecting in 3 seconds..."}),d.jsx("button",{className:"whatsapp-btn primary-btn",onClick:n,children:"Connect on WhatsApp Now"})]}),d.jsxs("div",{className:"contact-details",children:[d.jsx("h3",{children:"Your Details:"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Name:"})," ",e==null?void 0:e.firstName]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Email:"})," ",e==null?void 0:e.email]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Phone:"})," ",e==null?void 0:e.whatsappNumber]})]})]})})},qo=[{id:1,image:"https://img.youtube.com/vi/NC2ymm6Sots/maxresdefault.jpg",videoUrl:"https://youtu.be/NC2ymm6Sots",englishCaption:"Interview of Abhishek, Co-founder of Navgurukul",hindiCaption:"अभिषेक, नवगुरुकुल के सह-संस्थापक का साक्षात्कार",marathiCaption:"अभिषेक, नवगुरुकुलचे सह-संस्थापक यांचे मुलाखत"},{id:2,image:"https://img.youtube.com/vi/vuSwndj5cbs/maxresdefault.jpg",videoUrl:"https://www.youtube.com/watch?time_continue=1&v=vuSwndj5cbs&embeds_referring_euri=https%3A%2F%2Fdev-admissions.navgurukul.org%2F&embeds_referring_origin=https%3A%2F%2Fdev-admissions.navgurukul.org&source_ve_path=Mjg2NjQsMjg2NjY",englishCaption:"Experience of Navgurukul Alumni & Graduates",hindiCaption:"नवगुरुकुल के पूर्व छात्रों और स्नातकों का अनुभव",marathiCaption:"नवगुरुकुलच्या माजी विद्यार्थ्यांचा अनुभव"},{id:3,image:"https://img.youtube.com/vi/sfU1m8MuZ5Y/maxresdefault.jpg",videoUrl:"https://www.youtube.com/watch?v=HjqfZ-Matyk&ab_channel=NavGurukul",englishCaption:"Detailed explanation about Navgurukul",hindiCaption:"नवगुरुकुल के बारे में विस्तृत जानकारी",marathiCaption:"नवगुरुकुलबद्दल सविस्तर माहिती"},{id:4,image:"https://img.youtube.com/vi/HjqfZ-Matyk/maxresdefault.jpg",videoUrl:"https://www.youtube.com/watch?v=HjqfZ-Matyk&ab_channel=NavGurukul",englishCaption:"2 mins introduction to NavGurukul",hindiCaption:"नवगुरुकुल का 2 मिनट का परिचय",marathiCaption:"नवगुरुकुलचा 2 मिनिटांचा परिचय"}],Ko={english:{heading:"Software Engineering Scholarship",title:"Navgurukul",subtitle:"Welcome to",description:"Learn coding, problem-solving, and critical thinking in a thriving community of learners. Take the scholarship test today and begin your journey towards becoming a software engineer.",buttonText:"Get Started",footerText:"For more queries, email at",footerContact:"hi@navgurukul.org",imageUrl:"https://admissions.navgurukul.org/assets/logo.71054d69.png"},hindi:{heading:"सॉफ्टवेयर इंजीनियरिंग छात्रवृत्ति",title:"नवगुरुकुल",subtitle:"में आपका स्वागत है",description:"एक समृद्ध शिक्षार्थी समुदाय में कोडिंग, समस्या-समाधान, और आलोचनात्मक सोच सीखें। आज ही छात्रवृत्ति परीक्षा दें और सॉफ्टवेयर इंजीनियर बनने की अपनी यात्रा शुरू करें।",buttonText:"शुरू करें",footerText:"अधिक जानकारी के लिए ईमेल करें:",footerContact:"hi@navgurukul.org",imageUrl:"https://admissions.navgurukul.org/assets/logo.71054d69.png"},marathi:{heading:"सॉफ्टवेअर अभियांत्रिकी शिष्यवृत्ती",title:"नवगुरुकुल",subtitle:"मध्ये आपले स्वागत आहे",description:"कोडिंग, समस्या सोडवणे, आणि विचारशक्ती विकसित करणे यामध्ये एक समृद्ध समुदायात शिकणे. आजच शिष्यवृत्ती चाचणी द्या आणि सॉफ्टवेअर अभियंता बनण्याच्या आपल्या प्रवासाची सुरूवात करा.",buttonText:"सुरू करा",footerText:"अधिक प्रश्नांसाठी, ईमेल करा:",footerContact:"hi@navgurukul.org",imageUrl:"https://admissions.navgurukul.org/assets/logo.71054d69.png"}},qrt=()=>{const[e,t]=N.useState(0),{selectedLanguage:n,setSelectedLanguage:r}=gA(),a=Pr(),s=()=>t(o=>(o+1)%qo.length);N.useEffect(()=>{const o=setInterval(s,5e3);return()=>clearInterval(o)},[]),N.useEffect(()=>{const o=localStorage.getItem("selectedLanguage");o&&r(o)},[r]),N.useEffect(()=>{n&&localStorage.setItem("selectedLanguage",n)},[n]);const i=()=>{const o=localStorage.getItem("studentId"),l=localStorage.getItem("testStarted")==="true",c=localStorage.getItem("testCompleted")==="true",u=localStorage.getItem("allowRetest")==="true";if(!o){a("/students/login");return}if(c&&!u){a("/students/final-result");return}if(l||u){a("/students/test/start");return}a("/students/details/instructions")};return d.jsxs("div",{className:"min-h-screen flex flex-col",children:[d.jsxs("header",{className:"flex justify-between items-center px-6 py-4 shadow",children:[d.jsx("div",{className:"flex items-center space-x-2",children:d.jsx("img",{src:Ko[n].imageUrl,alt:"NavGurukul Logo",className:"h-10"})}),d.jsx("div",{className:"flex items-center space-x-4",children:d.jsxs("select",{value:n,onChange:o=>r(o.target.value),className:"border rounded px-3 py-1 text-gray-700",children:[d.jsx("option",{value:"english",children:"English"}),d.jsx("option",{value:"marathi",children:"Marathi"}),d.jsx("option",{value:"hindi",children:"Hindi"})]})})]}),d.jsxs("main",{className:"flex flex-col items-center flex-1 px-6 py-12",children:[d.jsx("h1",{className:"text-2xl md:text-3xl font-semibold mb-8 text-center",children:Ko[n].heading}),d.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start md:space-x-12 w-full max-w-6xl",children:[d.jsx("div",{className:"flex justify-center px-8 md:px-10",children:d.jsxs("div",{className:"relative w-full overflow-hidden rounded-lg shadow-2xl",children:[d.jsx("a",{href:qo[e].videoUrl,target:"_blank",rel:"noreferrer",children:d.jsx("img",{src:qo[e].image,alt:n==="english"?qo[e].englishCaption:n==="hindi"?qo[e].hindiCaption:qo[e].marathiCaption,className:"w-full h-60 object-cover"})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0  bg-opacity-50 text-white text-center py-3 text-base",children:n==="english"?qo[e].englishCaption:n==="hindi"?qo[e].hindiCaption:qo[e].marathiCaption})]})}),d.jsxs("div",{className:"mt-10 md:mt-0 md:ml-10 flex flex-col justify-center text-center bg-white p-6",children:[d.jsxs("h1",{className:"text-3xl md:text-3xl font-bold text-gray-900 mb-6 leading-tight",children:[Ko[n].subtitle," ",d.jsx("span",{className:"text-orange-500",children:Ko[n].title})]}),d.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:Ko[n].description}),d.jsx("div",{children:d.jsx("button",{className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg shadow-md",onClick:()=>i(),children:Ko[n].buttonText})})]})]})]}),d.jsxs("footer",{className:"bg-gray-100 text-center text-sm py-4",children:[Ko[n].footerText," ",d.jsx("a",{href:`mailto:${Ko[n].footerContact}`,className:"text-blue-600",children:Ko[n].footerContact})]})]})},Krt=()=>{const e=Pr(),{selectedLanguage:t}=gA(),[n,r]=N.useState(null),[a,s]=N.useState(1800),[i,o]=N.useState([]),[l,c]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const m=await ohe(t);o(m||[]),r((m==null?void 0:m.length)||0)}catch(m){console.error("Error fetching exam data:",m)}finally{c(!1)}})()},[t]);const u=g=>{const m=Math.floor(g/60),y=g%60;return`${m>0?`${m} Hour${m>1?"s":""}`:""} ${y>0?`${y} Minute${y>1?"s":""}`:""}`},p=(()=>{const g=a?u(a):"...",m=n??"...";switch(t){case"hindi":return{heading:"एक और बात:",description1:"अब, आपसे परीक्षा में कुछ प्रश्न पूछे जाएंगे। उन्हें ध्यान से उत्तर दें।",description2:"लेकिन समय पर भी ध्यान रखें",description3:`आपको ${g} में ${m} प्रश्नों का उत्तर देना होगा`,buttonText:"परीक्षा शुरू करें"};case"marathi":return{heading:"आणखी एक गोष्ट:",description1:"आता, तुम्हाला परीक्षेत काही प्रश्न विचारले जातील. त्यांना काळजीपूर्वक उत्तर द्या.",description2:"पण वेळेवरही लक्ष ठेवा",description3:`तुम्हाला ${g} मध्ये ${m} प्रश्नांची उत्तरे द्यायची आहेत`,buttonText:"परीक्षा सुरू करा"};default:return{heading:"One More Thing:",description1:"You will be asked some questions in the test. Answer carefully.",description2:"But also keep an eye on time.",description3:`You have to answer ${m} questions in ${g}.`,buttonText:"START TEST"}}})(),f=()=>{!i.length||!a||(console.log("questions",i),localStorage.setItem("testStarted","true"),localStorage.setItem("testCompleted","false"),localStorage.setItem("allowRetest","false"),e("/students/test/section",{state:{questions:i,duration:a}}))};return l?d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-orange-400 to-red-500",children:d.jsx("p",{className:"text-white text-lg",children:"Loading test details..."})}):d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center",children:[d.jsx(Gm,{}),d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full flex flex-col items-center justify-center",children:[d.jsx("h1",{className:"text-2xl font-semibold mb-4",children:p.heading}),d.jsx("p",{className:"text-gray-600 mb-2",children:p.description1}),d.jsx("p",{className:"text-gray-800 font-medium mb-2",children:p.description2}),d.jsx("p",{className:"text-gray-800 font-semibold mb-2",children:p.description3}),d.jsx("button",{onClick:f,className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200 shadow-lg",children:p.buttonText})]})]})},Jp="student_test_progress",Qrt=e=>{const t=Math.floor(e/60),n=e%60;return`${t}:${n.toString().padStart(2,"0")}`},Xrt=()=>{const e=Pr(),t=ci(),{tests:n,setTests:r}=ZS(),{questions:a,duration:s}=t.state||{},[i,o]=N.useState(a||[]),[l,c]=N.useState(0),[u,h]=N.useState({}),[p,f]=N.useState(s||null),[g,m]=N.useState(!1);N.useEffect(()=>{if(!a||!s)return;const b=localStorage.getItem(Jp);if(b){const{answers:w,currentIndex:k,examStartTime:I,duration:C}=JSON.parse(b),S=Math.floor((Date.now()-I)/1e3),E=C-S;E>0?(h(w||{}),c(k||0),f(E)):localStorage.removeItem(Jp)}else localStorage.setItem(Jp,JSON.stringify({answers:{},currentIndex:0,examStartTime:Date.now(),duration:s}))},[a,s]),N.useEffect(()=>{if(p===null)return;if(p<=0){x();return}const b=setInterval(()=>f(w=>w!==null?w-1:0),1e3);return()=>clearInterval(b)},[p]),N.useEffect(()=>{if(p===null)return;const b=localStorage.getItem(Jp);if(b){const w=JSON.parse(b);localStorage.setItem(Jp,JSON.stringify({...w,answers:u,currentIndex:l}))}},[u,l,p]);const y=b=>{const w=i[l].id;h({...u,[w]:b})},x=()=>{m(!0)},v=()=>{m(!1);let b=0;i.forEach(I=>{const C=Array.isArray(I.answer)?I.answer[0]:I.answer;u[I.id]===C&&(b+=I.difficulty_level)});const w=i.reduce((I,C)=>I+C.difficulty_level,0),k=b>=w/2;localStorage.removeItem(Jp),r(I=>{const C=I.findIndex(S=>S.name==="Screening Test");if(C!==-1){const S=[...I];return S[C]={...S[C],score:b,status:k?"Pass":"Fail",action:"Completed"},S}else return[...I,{id:Date.now(),name:"Screening Test",score:b,status:k?"Pass":"Fail",action:"Completed",slotBooking:{status:null}}]}),localStorage.setItem("testStarted","false"),localStorage.setItem("testCompleted","true"),localStorage.setItem("allowRetest","false"),e("/students/test/result",{state:{score:b,total:w}})};return p===null||i.length===0?d.jsx("div",{className:"text-center mt-10 text-lg font-semibold",children:"Loading test..."}):d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-3xl flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("h2",{className:"font-bold text-xl",children:["Question ",l+1," / ",i.length]}),d.jsxs("div",{className:"bg-red-100 text-red-600 font-bold px-4 py-2 rounded-lg shadow",children:["⏳ ",Qrt(p)]})]}),d.jsx("div",{className:"border border-gray-300 rounded-xl p-6 mb-6 bg-gray-50 shadow-inner",children:d.jsx("p",{className:"text-lg font-medium text-gray-800 leading-relaxed",children:i[l].question})}),d.jsx("div",{className:"space-y-3",children:i[l].options.map((b,w)=>{const k=i[l].id;return d.jsxs("label",{className:`block border rounded-lg px-4 py-3 cursor-pointer transition ${u[k]===w?"bg-blue-100 border-blue-500":"hover:bg-gray-100 border-gray-300"}`,children:[d.jsx("input",{type:"radio",name:`q-${k}`,checked:u[k]===w,onChange:()=>y(w),className:"hidden"}),b]},w)})}),d.jsxs("div",{className:"mt-8 flex justify-between",children:[d.jsx("button",{disabled:l===0,onClick:()=>c(b=>b-1),className:"px-6 py-2 bg-gray-300 rounded-lg font-medium disabled:opacity-50",children:"Previous"}),l===i.length-1?d.jsxs(ta,{open:g,onOpenChange:m,children:[d.jsx(f5,{asChild:!0,children:d.jsx("button",{className:"px-6 py-2 bg-green-600 text-white rounded-lg font-medium shadow hover:bg-green-700",onClick:x,children:"Submit"})}),d.jsxs(na,{children:[d.jsxs(ka,{children:[d.jsx(ra,{children:"Confirm Submission"}),d.jsx(_j,{children:"Are you sure you want to submit the test? You won’t be able to change your answers afterwards."})]}),d.jsxs(Sj,{className:"flex justify-end gap-4",children:[d.jsx(fe,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),d.jsx(fe,{onClick:v,children:"Yes, Submit"})]})]})]}):d.jsx("button",{onClick:()=>c(b=>b+1),className:"px-6 py-2 bg-orange-500 text-white rounded-lg font-medium shadow hover:bg-orange-600",children:"Next"})]})]})})},Yrt=()=>{const{tests:e,setTests:t}=ZS(),n=Pr(),r=ci(),{score:a=0,total:s=0}=r.state||{},i=a>=Math.ceil(s*.5)?"pass":"fail";e.find(l=>l.name==="Screening Test");const o=()=>{t(l=>l.map(c=>c.name==="Screening Test"?{...c,status:i==="pass"?"Pass":"Fail",score:a}:c)),n("/students/final-result")};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:[d.jsx(Gm,{}),d.jsx("div",{className:"bg-white rounded-3xl shadow-2xl p-10 max-w-2xl w-full flex flex-col items-center text-center",children:i==="pass"?d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Congratulations!"}),d.jsxs("h2",{className:"text-2xl md:text-3xl font-semibold text-gray-800 mb-6",children:["You passed the test with a score of"," ",d.jsx("span",{className:"text-orange-500",children:a})," /"," ",d.jsx("span",{className:"text-orange-500",children:s})]}),d.jsx("p",{className:"text-gray-700 mb-2",children:"Thank you for applying to NavGurukul Program."}),d.jsx("p",{className:"text-gray-700 mb-4",children:"Our admission team will contact you for the next steps."}),d.jsxs("p",{className:"text-gray-700 mb-4",children:["You can send us a mail on ",d.jsx("a",{href:"mailto:hi@navgurukul.org",className:"text-blue-500",children:"hi@navgurukul.org"}),"."]}),d.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-6 w-full justify-center",children:[d.jsx("a",{href:"https://navgurukul.org",target:"_blank",rel:"noopener noreferrer",className:"bg-orange-50 border border-orange-500 text-orange-600 font-semibold py-3 px-6 rounded-lg hover:bg-orange-100 transition",children:"VISIT NAVGURUKUL"}),d.jsx("a",{href:"https://www.merakilearn.org/",target:"_blank",rel:"noopener noreferrer",className:"bg-orange-50 border border-orange-500 text-orange-600 font-semibold py-3 px-6 rounded-lg hover:bg-orange-100 transition",children:"START CODING NOW"})]}),d.jsx("button",{onClick:()=>o(),className:"mt-6 bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200",children:"Go to Result Section"})]}):d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"text-3xl font-semibold text-gray-900 mb-6",children:"Oh Sorry!"}),d.jsxs("p",{className:"text-gray-700 mb-4 text-lg",children:["You could not clear the NavGurukul Preliminary Test this time. You have scored"," ",d.jsx("span",{className:"font-bold",children:a})," marks in the test. Don’t worry, you can give the test again after some preparation."]}),d.jsxs("p",{className:"text-gray-700 mb-6",children:["You can use this study guide for more maths practice"," ",d.jsx("a",{href:"https://www.khanacademy.org/math",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 font-medium underline hover:text-blue-800",children:"Click Here"}),". Prepare, Practice and Pass"]}),d.jsx("button",{onClick:()=>o(),className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200",children:"OK"})]})})]})};function Jrt(){const[e,t]=N.useState(null),{tests:n}=ZS(),r=Pr();N.useEffect(()=>{const i=localStorage.getItem("studentFormData");i&&t(JSON.parse(i))},[]);const a=i=>{r(`/students/slot-booking/${i}`)},s=()=>{localStorage.setItem("testStarted","false"),localStorage.setItem("testCompleted","false"),localStorage.setItem("allowRetest","true"),r("/students/test/start",{replace:!0})};return e?d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 p-4 flex",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full h-[95vh] overflow-y-auto",children:[d.jsxs("header",{className:"mb-6",children:[d.jsx(Gm,{className:"from-orange-400 to-red-500"}),d.jsx("h1",{className:"text-2xl font-bold",children:"Student Results"}),d.jsx("p",{className:"text-gray-600",children:"Track your test results and interview slot booking status."})]}),d.jsxs(Ct,{className:"mb-6",children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Student Details"})}),d.jsxs(It,{className:"grid sm:grid-cols-2 gap-4",children:[d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Name:"})," ",e.firstName," ",e.middleName," ",e.lastName]}),d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Email:"})," ",e.email]}),d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Phone Number:"})," ",e.whatsappNumber]}),d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"City:"})," ",e.city]})]})]}),d.jsxs(Ct,{children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Test Results & Slot Booking"})}),d.jsx(It,{children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full border border-gray-200 text-left rounded-lg",children:[d.jsx("thead",{className:"bg-gray-100",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-2 border",children:"Stage"}),d.jsx("th",{className:"px-4 py-2 border",children:"Status"}),d.jsx("th",{className:"px-4 py-2 border",children:"Scheduled Time"}),d.jsx("th",{className:"px-4 py-2 border",children:"Actions"}),d.jsx("th",{className:"px-4 py-2 border",children:"Marks"})]})}),d.jsx("tbody",{children:n.map(i=>{var o,l,c;return d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-4 py-2 border",children:i.name}),d.jsx("td",{className:"px-4 py-2 border",children:d.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${i.status==="Pass"?"bg-green-100 text-green-700":i.status==="Pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:i.status})}),d.jsx("td",{className:"px-4 py-2 border",children:(o=i.slotBooking)!=null&&o.scheduledTime?new Date(i.slotBooking.scheduledTime).toLocaleString():"-"}),d.jsxs("td",{className:"px-4 py-2 border",children:[i.name==="Screening Test"&&i.status==="Fail"&&d.jsx(fe,{onClick:s,children:"Retest"}),["Pending","Booked","Cancelled"].includes((l=i.slotBooking)==null?void 0:l.status)&&d.jsx(fe,{onClick:()=>a(i.id),children:["Booked","Cancelled"].includes(((c=i.slotBooking)==null?void 0:c.status)||"")?"Reschedule":"Book Slot"}),i.action==="view-result"&&d.jsx("span",{className:"text-gray-600",children:"Result Ready"})]}),d.jsx("td",{className:"px-4 py-2 border",children:i.score})]},i.id)})})]})})})]})]})}):d.jsx("div",{className:"min-h-screen flex items-center justify-center",children:d.jsx("p",{className:"text-gray-600",children:"Loading student data…"})})}function Zrt(){const e=Pr(),{toast:t}=Qt(),[n,r]=N.useState({name:"",lastname:"",phone:""}),[a,s]=N.useState(!1),i=u=>{r({...n,[u.target.name]:u.target.value})},o={english:{title:"Student Login",description:"Sign in with your name and phone number to continue",namePlaceholder:"Enter your name",lastnamePlaceholder:"Enter your last name",phonePlaceholder:"Enter your phone number",signInButton:"Sign In",successMessage:"Login Successful! ",failureMessage:"Login Failed. Please try again."},hindi:{title:"छात्र लॉगिन",description:"जारी रखने के लिए अपना नाम और फोन नंबर दर्ज करें",namePlaceholder:"अपना नाम दर्ज करें",lastnamePlaceholder:"अपना उपनाम दर्ज करें",phonePlaceholder:"अपना फोन नंबर दर्ज करें",signInButton:"साइन इन करें",successMessage:"लॉगिन सफल! ",failureMessage:"लॉगिन विफल। कृपया पुनः प्रयास करें।"},marathi:{title:"विद्यार्थी लॉगिन",description:"सुरू ठेवण्यासाठी आपले नाव आणि फोन नंबर प्रविष्ट करा",namePlaceholder:"आपले नाव प्रविष्ट करा",lastnamePlaceholder:"आपले आडनाव प्रविष्ट करा",phonePlaceholder:"आपला फोन नंबर प्रविष्ट करा",signInButton:"साइन इन करा",successMessage:"लॉगिन यशस्वी! ",failureMessage:"लॉगिन अयशस्वी. कृपया पुन्हा प्रयत्न करा."}},l=()=>{switch(localStorage.getItem("selectedLanguage")||"english"){case"hindi":return o.hindi;case"marathi":return o.marathi;case"english":default:return o.english}},c=async u=>{u.preventDefault(),s(!0);try{const h={success:!0,student:{id:12,name:n.name,lastname:n.lastname,phone:n.phone}};if(!h.success||!h.student)throw new Error(h.message||"Login failed");localStorage.setItem("role","student"),localStorage.setItem("studentId",h.student.id),t({title:l().successMessage,description:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(oU,{className:"w-5 h-5 text-green-500"}),d.jsxs("span",{children:["Welcome back, ",h.student.name,"! 🎉"]})]}),className:"bg-green-50 border-green-500 text-green-800"}),e("/students/details/instructions")}catch(h){t({title:l().failureMessage,description:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(l1,{className:"w-5 h-5 text-red-500"}),d.jsx("span",{children:h.message})]}),className:"bg-red-50 border-red-500 text-red-800"})}finally{s(!1)}};return d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:d.jsxs(Ct,{className:"w-full max-w-md shadow-lg",children:[d.jsxs(Vt,{className:"space-y-1 text-center",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[d.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center",children:d.jsx(Ai,{className:"w-6 h-6 text-white"})}),d.jsx(Yt,{className:"text-2xl font-bold",children:l().title})]}),d.jsx(vs,{children:l().description})]}),d.jsx(It,{children:d.jsxs("form",{onSubmit:c,className:"space-y-4",children:[d.jsx(Je,{type:"text",name:"name",placeholder:l().namePlaceholder,value:n.name,onChange:i,required:!0}),d.jsx(Je,{type:"text",name:"lastname",placeholder:l().lastnamePlaceholder,value:n.lastname,onChange:i,required:!0}),d.jsx(Je,{type:"tel",name:"phone",placeholder:l().phonePlaceholder,value:n.phone,onChange:i,required:!0}),d.jsx(fe,{type:"submit",className:"w-full",disabled:a,children:a?"Signing in...":l().signInButton})]})})]})})}const t0=({children:e})=>{const n=ci().pathname;localStorage.getItem("testStarted")===null&&localStorage.setItem("testStarted","false"),localStorage.getItem("testCompleted")===null&&localStorage.setItem("testCompleted","false"),localStorage.getItem("allowRetest")===null&&localStorage.setItem("allowRetest","false"),localStorage.getItem("registrationDone")===null&&localStorage.setItem("registrationDone","false");const r=localStorage.getItem("studentId"),a=localStorage.getItem("testStarted")==="true",s=localStorage.getItem("testCompleted")==="true",i=localStorage.getItem("allowRetest")==="true",o=localStorage.getItem("registrationDone")==="true";return r?s&&!i&&!["/students/test/start","/students/test/section","/students/test/result"].includes(n)&&!n.startsWith("/students/final-result")?d.jsx(sl,{to:"/students/final-result",replace:!0}):i&&n.startsWith("/students/final-result")?d.jsx(sl,{to:"/students/test/start",replace:!0}):o&&n.startsWith("/students/details/instructions")?d.jsx(sl,{to:"/students/test/start",replace:!0}):!a&&!i&&!o&&n.startsWith("/students/test")?d.jsx(sl,{to:"/students/details/instructions",replace:!0}):d.jsx(d.Fragment,{children:e}):d.jsx(sl,{to:"/students",replace:!0})};function eat(){const[e,t]=N.useState([]);N.useEffect(()=>{t([{id:1,name:"Offer_Letter_July.pdf",url:"/mock/offer_july.pdf"},{id:2,name:"Convern_Letter.pdf",url:"/mock/offer_aug.pdf"},{id:3,name:"Required_Items_List_Which_In_Campus.pdf",url:"/mock/offer_aug.pdf"}])},[]);const n=r=>{const a=document.createElement("a");a.href=r.url,a.download=r.name,a.click()};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex",children:[d.jsx(Gm,{}),d.jsx("div",{className:"p-6 min-w-full overflow-y-auto",children:d.jsxs(Ct,{className:"h-[90vh] rounded-2xl",children:[d.jsx(Vt,{children:d.jsx(Yt,{children:"Documents"})}),d.jsx(It,{children:e.length>0?d.jsxs("table",{className:"w-full border-collapse text-left text-gray-700",children:[d.jsx("thead",{className:"bg-gray-100",children:d.jsxs("tr",{children:[d.jsx("th",{className:"border px-4 py-2 w-12",children:"#"}),d.jsx("th",{className:"border px-4 py-2",children:"File Name"}),d.jsx("th",{className:"border px-4 py-2 w-32 text-center",children:"Download"})]})}),d.jsx("tbody",{children:e.map((r,a)=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"border px-4 py-2",children:a+1}),d.jsx("td",{className:"border px-4 py-2",children:r.name}),d.jsx("td",{className:"border px-4 py-2 text-center",children:d.jsx(fe,{size:"sm",onClick:()=>n(r),variant:"default",children:"Download"})})]},r.id))})]}):d.jsx("p",{className:"text-gray-500",children:"No documents available."})})]})})]})}const tat=()=>d.jsxs(EB,{children:[d.jsx(xt,{index:!0,element:d.jsx(qrt,{})}),d.jsx(xt,{path:"login",element:d.jsx(Zrt,{})}),d.jsx(xt,{path:"language-selection",element:d.jsx(t0,{children:d.jsx(D1e,{})})}),d.jsxs(xt,{path:"details",element:d.jsxs(t0,{children:[d.jsx(T2,{})," "]}),children:[d.jsx(xt,{index:!0,element:d.jsx(sl,{to:"instructions",replace:!0})}),d.jsx(xt,{path:"instructions",element:d.jsx(M1e,{})}),d.jsx(xt,{path:"registration",element:d.jsx(Ort,{})})]}),d.jsxs(xt,{path:"test",element:d.jsx(t0,{children:d.jsx(T2,{})}),children:[d.jsx(xt,{index:!0,element:d.jsx(sl,{to:"start",replace:!0})}),d.jsx(xt,{path:"start",element:d.jsx(Krt,{})}),d.jsx(xt,{path:"section",element:d.jsx(Xrt,{})}),d.jsx(xt,{path:"result",element:d.jsx(Yrt,{})})]}),d.jsx(xt,{path:"final-result",element:d.jsx(t0,{children:d.jsx(Jrt,{})})}),d.jsx(xt,{path:"slot-booking/:id",element:d.jsx(Hrt,{})}),d.jsx(xt,{path:"offer-letter",element:d.jsx(eat,{})}),d.jsx(xt,{path:"whatsapp-redirect",element:d.jsx(Grt,{})}),d.jsx(xt,{path:"*",element:d.jsx(sl,{to:".",replace:!0})})]}),nat=new Fue,rat=()=>d.jsx(Prt,{children:d.jsx(Frt,{children:d.jsx(Uue,{client:nat,children:d.jsxs(bue,{children:[d.jsx(aoe,{}),d.jsx(Ooe,{}),d.jsx(xhe,{children:d.jsxs(EB,{children:[d.jsx(xt,{path:"/auth",element:d.jsx(_1e,{})}),d.jsx(xt,{path:"/",element:d.jsx(_r,{children:d.jsx(VH,{})})}),d.jsx(xt,{path:"/applicants",element:d.jsx(_r,{children:d.jsx(x1e,{})})}),d.jsx(xt,{path:"/interviews",element:d.jsx(_r,{children:d.jsx(XH,{})})}),d.jsx(xt,{path:"/schedule",element:d.jsx(_r,{children:d.jsx(b1e,{})})}),d.jsx(xt,{path:"/sourcing",element:d.jsx(_r,{children:d.jsx(w1e,{})})}),d.jsx(xt,{path:"/screening",element:d.jsx(_r,{children:d.jsx(N1e,{})})}),d.jsx(xt,{path:"/interview-rounds",element:d.jsx(_r,{children:d.jsx(k1e,{})})}),d.jsx(xt,{path:"/decisions",element:d.jsx(_r,{children:d.jsx(S1e,{})})}),d.jsx(xt,{path:"/partners",element:d.jsx(_r,{children:d.jsx(GH,{})})}),d.jsx(xt,{path:"/admin",element:d.jsx(_r,{children:d.jsx(PW,{})})}),d.jsx(xt,{path:"/owner",element:d.jsx(_r,{children:d.jsx(t6,{})})}),d.jsx(xt,{path:"/donor",element:d.jsx(_r,{children:d.jsx(HH,{})})}),d.jsx(xt,{path:"/offer-letters",element:d.jsx(_r,{children:d.jsx(hG,{})})}),d.jsx(xt,{path:"/campus",element:d.jsx(_r,{children:d.jsx(qH,{})})}),d.jsx(xt,{path:"/campus/:id",element:d.jsx(_r,{children:d.jsx(I1e,{})})}),d.jsx(xt,{path:"/school",element:d.jsx(_r,{children:d.jsx(KH,{})})}),d.jsx(xt,{path:"/school/:id",element:d.jsx(_r,{children:d.jsx(E1e,{})})}),d.jsx(xt,{path:"questions",element:d.jsx(_r,{children:d.jsx($G,{})})}),d.jsxs(xt,{path:"/settings",element:d.jsx(_r,{children:d.jsx(j1e,{})}),children:[d.jsx(xt,{path:"user-role",element:d.jsx(nL,{})}),d.jsx(xt,{path:"caste",element:d.jsx(A1e,{})}),d.jsx(xt,{path:"religion",element:d.jsx($1e,{})}),d.jsx(xt,{path:"qualification",element:d.jsx(R1e,{})}),d.jsx(xt,{index:!0,element:d.jsx(nL,{})})]}),d.jsx(xt,{path:"/students/*",element:d.jsx(tat,{})}),d.jsx(xt,{path:"*",element:d.jsx(ece,{})})]})})]})})})});yB(document.getElementById("root")).render(d.jsx($e.StrictMode,{children:d.jsx(Tre,{basename:"/Admission-Dashboard",children:d.jsx(O1e,{children:d.jsx(rat,{})})})}));
