var BO=e=>{throw TypeError(e)};var BC=(e,t,r)=>t.has(e)||BO("Cannot "+r);var de=(e,t,r)=>(BC(e,t,"read from private field"),r?r.call(e):t.get(e)),It=(e,t,r)=>t.has(e)?BO("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),lt=(e,t,r,n)=>(BC(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),ar=(e,t,r)=>(BC(e,t,"access private method"),r);var Tw=(e,t,r,n)=>({set _(a){lt(e,t,a,r)},get _(){return de(e,t,n)}});function xne(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var mi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cj(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function yne(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Yz={exports:{}},FS={},Jz={exports:{}},pr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb=Symbol.for("react.element"),vne=Symbol.for("react.portal"),bne=Symbol.for("react.fragment"),wne=Symbol.for("react.strict_mode"),Nne=Symbol.for("react.profiler"),Sne=Symbol.for("react.provider"),_ne=Symbol.for("react.context"),kne=Symbol.for("react.forward_ref"),Cne=Symbol.for("react.suspense"),Ine=Symbol.for("react.memo"),Ene=Symbol.for("react.lazy"),UO=Symbol.iterator;function Tne(e){return e===null||typeof e!="object"?null:(e=UO&&e[UO]||e["@@iterator"],typeof e=="function"?e:null)}var Zz={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e5=Object.assign,t5={};function _g(e,t,r){this.props=e,this.context=t,this.refs=t5,this.updater=r||Zz}_g.prototype.isReactComponent={};_g.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function r5(){}r5.prototype=_g.prototype;function Ij(e,t,r){this.props=e,this.context=t,this.refs=t5,this.updater=r||Zz}var Ej=Ij.prototype=new r5;Ej.constructor=Ij;e5(Ej,_g.prototype);Ej.isPureReactComponent=!0;var WO=Array.isArray,n5=Object.prototype.hasOwnProperty,Tj={current:null},a5={key:!0,ref:!0,__self:!0,__source:!0};function s5(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)n5.call(t,n)&&!a5.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var u=Array(o),d=0;d<o;d++)u[d]=arguments[d+2];a.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Eb,type:e,key:s,ref:i,props:a,_owner:Tj.current}}function jne(e,t){return{$$typeof:Eb,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function jj(e){return typeof e=="object"&&e!==null&&e.$$typeof===Eb}function Ane(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var VO=/\/+/g;function UC(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ane(""+e.key):t.toString(36)}function S1(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Eb:case vne:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+UC(i,0):n,WO(a)?(r="",e!=null&&(r=e.replace(VO,"$&/")+"/"),S1(a,t,r,"",function(d){return d})):a!=null&&(jj(a)&&(a=jne(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(VO,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",WO(e))for(var o=0;o<e.length;o++){s=e[o];var u=n+UC(s,o);i+=S1(s,t,r,u,a)}else if(u=Tne(e),typeof u=="function")for(e=u.call(e),o=0;!(s=e.next()).done;)s=s.value,u=n+UC(s,o++),i+=S1(s,t,r,u,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function jw(e,t,r){if(e==null)return e;var n=[],a=0;return S1(e,n,"","",function(s){return t.call(r,s,a++)}),n}function $ne(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ns={current:null},_1={transition:null},Rne={ReactCurrentDispatcher:Ns,ReactCurrentBatchConfig:_1,ReactCurrentOwner:Tj};function i5(){throw Error("act(...) is not supported in production builds of React.")}pr.Children={map:jw,forEach:function(e,t,r){jw(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return jw(e,function(){t++}),t},toArray:function(e){return jw(e,function(t){return t})||[]},only:function(e){if(!jj(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};pr.Component=_g;pr.Fragment=bne;pr.Profiler=Nne;pr.PureComponent=Ij;pr.StrictMode=wne;pr.Suspense=Cne;pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rne;pr.act=i5;pr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=e5({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Tj.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)n5.call(t,u)&&!a5.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var d=0;d<u;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:Eb,type:e.type,key:a,ref:s,props:n,_owner:i}};pr.createContext=function(e){return e={$$typeof:_ne,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Sne,_context:e},e.Consumer=e};pr.createElement=s5;pr.createFactory=function(e){var t=s5.bind(null,e);return t.type=e,t};pr.createRef=function(){return{current:null}};pr.forwardRef=function(e){return{$$typeof:kne,render:e}};pr.isValidElement=jj;pr.lazy=function(e){return{$$typeof:Ene,_payload:{_status:-1,_result:e},_init:$ne}};pr.memo=function(e,t){return{$$typeof:Ine,type:e,compare:t===void 0?null:t}};pr.startTransition=function(e){var t=_1.transition;_1.transition={};try{e()}finally{_1.transition=t}};pr.unstable_act=i5;pr.useCallback=function(e,t){return Ns.current.useCallback(e,t)};pr.useContext=function(e){return Ns.current.useContext(e)};pr.useDebugValue=function(){};pr.useDeferredValue=function(e){return Ns.current.useDeferredValue(e)};pr.useEffect=function(e,t){return Ns.current.useEffect(e,t)};pr.useId=function(){return Ns.current.useId()};pr.useImperativeHandle=function(e,t,r){return Ns.current.useImperativeHandle(e,t,r)};pr.useInsertionEffect=function(e,t){return Ns.current.useInsertionEffect(e,t)};pr.useLayoutEffect=function(e,t){return Ns.current.useLayoutEffect(e,t)};pr.useMemo=function(e,t){return Ns.current.useMemo(e,t)};pr.useReducer=function(e,t,r){return Ns.current.useReducer(e,t,r)};pr.useRef=function(e){return Ns.current.useRef(e)};pr.useState=function(e){return Ns.current.useState(e)};pr.useSyncExternalStore=function(e,t,r){return Ns.current.useSyncExternalStore(e,t,r)};pr.useTransition=function(){return Ns.current.useTransition()};pr.version="18.3.1";Jz.exports=pr;var w=Jz.exports;const qe=Cj(w),Aj=xne({__proto__:null,default:qe},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dne=w,Mne=Symbol.for("react.element"),Fne=Symbol.for("react.fragment"),One=Object.prototype.hasOwnProperty,Pne=Dne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lne={key:!0,ref:!0,__self:!0,__source:!0};function o5(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)One.call(t,n)&&!Lne.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Mne,type:e,key:s,ref:i,props:a,_owner:Pne.current}}FS.Fragment=Fne;FS.jsx=o5;FS.jsxs=o5;Yz.exports=FS;var l=Yz.exports,l5={exports:{}},_i={},u5={exports:{}},c5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(A,L){var z=A.length;A.push(L);e:for(;0<z;){var $=z-1>>>1,V=A[$];if(0<a(V,L))A[$]=L,A[z]=V,z=$;else break e}}function r(A){return A.length===0?null:A[0]}function n(A){if(A.length===0)return null;var L=A[0],z=A.pop();if(z!==L){A[0]=z;e:for(var $=0,V=A.length,B=V>>>1;$<B;){var Y=2*($+1)-1,re=A[Y],ae=Y+1,K=A[ae];if(0>a(re,z))ae<V&&0>a(K,re)?(A[$]=K,A[ae]=z,$=ae):(A[$]=re,A[Y]=z,$=Y);else if(ae<V&&0>a(K,z))A[$]=K,A[ae]=z,$=ae;else break e}}return L}function a(A,L){var z=A.sortIndex-L.sortIndex;return z!==0?z:A.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var u=[],d=[],c=1,h=null,p=3,f=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(A){for(var L=r(d);L!==null;){if(L.callback===null)n(d);else if(L.startTime<=A)n(d),L.sortIndex=L.expirationTime,t(u,L);else break;L=r(d)}}function N(A){if(m=!1,b(A),!g)if(r(u)!==null)g=!0,q(S);else{var L=r(d);L!==null&&P(N,L.startTime-A)}}function S(A,L){g=!1,m&&(m=!1,y(k),k=-1),f=!0;var z=p;try{for(b(L),h=r(u);h!==null&&(!(h.expirationTime>L)||A&&!j());){var $=h.callback;if(typeof $=="function"){h.callback=null,p=h.priorityLevel;var V=$(h.expirationTime<=L);L=e.unstable_now(),typeof V=="function"?h.callback=V:h===r(u)&&n(u),b(L)}else n(u);h=r(u)}if(h!==null)var B=!0;else{var Y=r(d);Y!==null&&P(N,Y.startTime-L),B=!1}return B}finally{h=null,p=z,f=!1}}var _=!1,C=null,k=-1,I=5,T=-1;function j(){return!(e.unstable_now()-T<I)}function E(){if(C!==null){var A=e.unstable_now();T=A;var L=!0;try{L=C(!0,A)}finally{L?O():(_=!1,C=null)}}else _=!1}var O;if(typeof v=="function")O=function(){v(E)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,W=M.port2;M.port1.onmessage=E,O=function(){W.postMessage(null)}}else O=function(){x(E,0)};function q(A){C=A,_||(_=!0,O())}function P(A,L){k=x(function(){A(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(A){A.callback=null},e.unstable_continueExecution=function(){g||f||(g=!0,q(S))},e.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<A?Math.floor(1e3/A):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(A){switch(p){case 1:case 2:case 3:var L=3;break;default:L=p}var z=p;p=L;try{return A()}finally{p=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(A,L){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var z=p;p=A;try{return L()}finally{p=z}},e.unstable_scheduleCallback=function(A,L,z){var $=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?$+z:$):z=$,A){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=z+V,A={id:c++,callback:L,priorityLevel:A,startTime:z,expirationTime:V,sortIndex:-1},z>$?(A.sortIndex=z,t(d,A),r(u)===null&&A===r(d)&&(m?(y(k),k=-1):m=!0,P(N,z-$))):(A.sortIndex=V,t(u,A),g||f||(g=!0,q(S))),A},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(A){var L=p;return function(){var z=p;p=L;try{return A.apply(this,arguments)}finally{p=z}}}})(c5);u5.exports=c5;var zne=u5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bne=w,gi=zne;function Be(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d5=new Set,Iv={};function Bh(e,t){Vm(e,t),Vm(e+"Capture",t)}function Vm(e,t){for(Iv[e]=t,e=0;e<t.length;e++)d5.add(t[e])}var Yl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xI=Object.prototype.hasOwnProperty,Une=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HO={},qO={};function Wne(e){return xI.call(qO,e)?!0:xI.call(HO,e)?!1:Une.test(e)?qO[e]=!0:(HO[e]=!0,!1)}function Vne(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Hne(e,t,r,n){if(t===null||typeof t>"u"||Vne(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ss(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Da={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Da[e]=new Ss(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Da[t]=new Ss(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Da[e]=new Ss(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Da[e]=new Ss(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Da[e]=new Ss(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Da[e]=new Ss(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Da[e]=new Ss(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Da[e]=new Ss(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Da[e]=new Ss(e,5,!1,e.toLowerCase(),null,!1,!1)});var $j=/[\-:]([a-z])/g;function Rj(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($j,Rj);Da[t]=new Ss(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($j,Rj);Da[t]=new Ss(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($j,Rj);Da[t]=new Ss(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Da[e]=new Ss(e,1,!1,e.toLowerCase(),null,!1,!1)});Da.xlinkHref=new Ss("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Da[e]=new Ss(e,1,!1,e.toLowerCase(),null,!0,!0)});function Dj(e,t,r,n){var a=Da.hasOwnProperty(t)?Da[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Hne(t,r,a,n)&&(r=null),n||a===null?Wne(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ou=Bne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Aw=Symbol.for("react.element"),Jf=Symbol.for("react.portal"),Zf=Symbol.for("react.fragment"),Mj=Symbol.for("react.strict_mode"),yI=Symbol.for("react.profiler"),h5=Symbol.for("react.provider"),p5=Symbol.for("react.context"),Fj=Symbol.for("react.forward_ref"),vI=Symbol.for("react.suspense"),bI=Symbol.for("react.suspense_list"),Oj=Symbol.for("react.memo"),Ru=Symbol.for("react.lazy"),f5=Symbol.for("react.offscreen"),GO=Symbol.iterator;function by(e){return e===null||typeof e!="object"?null:(e=GO&&e[GO]||e["@@iterator"],typeof e=="function"?e:null)}var kn=Object.assign,WC;function Wy(e){if(WC===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);WC=t&&t[1]||""}return`
`+WC+e}var VC=!1;function HC(e,t){if(!e||VC)return"";VC=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var u=`
`+a[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=i&&0<=o);break}}}finally{VC=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Wy(e):""}function qne(e){switch(e.tag){case 5:return Wy(e.type);case 16:return Wy("Lazy");case 13:return Wy("Suspense");case 19:return Wy("SuspenseList");case 0:case 2:case 15:return e=HC(e.type,!1),e;case 11:return e=HC(e.type.render,!1),e;case 1:return e=HC(e.type,!0),e;default:return""}}function wI(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zf:return"Fragment";case Jf:return"Portal";case yI:return"Profiler";case Mj:return"StrictMode";case vI:return"Suspense";case bI:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case p5:return(e.displayName||"Context")+".Consumer";case h5:return(e._context.displayName||"Context")+".Provider";case Fj:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Oj:return t=e.displayName||null,t!==null?t:wI(e.type)||"Memo";case Ru:t=e._payload,e=e._init;try{return wI(e(t))}catch{}}return null}function Gne(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wI(t);case 8:return t===Mj?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function m5(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Kne(e){var t=m5(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $w(e){e._valueTracker||(e._valueTracker=Kne(e))}function g5(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=m5(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function iN(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function NI(e,t){var r=t.checked;return kn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function KO(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=bc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function x5(e,t){t=t.checked,t!=null&&Dj(e,"checked",t,!1)}function SI(e,t){x5(e,t);var r=bc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_I(e,t.type,r):t.hasOwnProperty("defaultValue")&&_I(e,t.type,bc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function QO(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function _I(e,t,r){(t!=="number"||iN(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Vy=Array.isArray;function fm(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+bc(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function kI(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Be(91));return kn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function XO(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Be(92));if(Vy(r)){if(1<r.length)throw Error(Be(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:bc(r)}}function y5(e,t){var r=bc(t.value),n=bc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function YO(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function v5(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function CI(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?v5(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Rw,b5=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Rw=Rw||document.createElement("div"),Rw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ev(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var uv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qne=["Webkit","ms","Moz","O"];Object.keys(uv).forEach(function(e){Qne.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),uv[t]=uv[e]})});function w5(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||uv.hasOwnProperty(e)&&uv[e]?(""+t).trim():t+"px"}function N5(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=w5(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Xne=kn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function II(e,t){if(t){if(Xne[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Be(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Be(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Be(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Be(62))}}function EI(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var TI=null;function Pj(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var jI=null,mm=null,gm=null;function JO(e){if(e=Ab(e)){if(typeof jI!="function")throw Error(Be(280));var t=e.stateNode;t&&(t=BS(t),jI(e.stateNode,e.type,t))}}function S5(e){mm?gm?gm.push(e):gm=[e]:mm=e}function _5(){if(mm){var e=mm,t=gm;if(gm=mm=null,JO(e),t)for(e=0;e<t.length;e++)JO(t[e])}}function k5(e,t){return e(t)}function C5(){}var qC=!1;function I5(e,t,r){if(qC)return e(t,r);qC=!0;try{return k5(e,t,r)}finally{qC=!1,(mm!==null||gm!==null)&&(C5(),_5())}}function Tv(e,t){var r=e.stateNode;if(r===null)return null;var n=BS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Be(231,t,typeof r));return r}var AI=!1;if(Yl)try{var wy={};Object.defineProperty(wy,"passive",{get:function(){AI=!0}}),window.addEventListener("test",wy,wy),window.removeEventListener("test",wy,wy)}catch{AI=!1}function Yne(e,t,r,n,a,s,i,o,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(c){this.onError(c)}}var cv=!1,oN=null,lN=!1,$I=null,Jne={onError:function(e){cv=!0,oN=e}};function Zne(e,t,r,n,a,s,i,o,u){cv=!1,oN=null,Yne.apply(Jne,arguments)}function eae(e,t,r,n,a,s,i,o,u){if(Zne.apply(this,arguments),cv){if(cv){var d=oN;cv=!1,oN=null}else throw Error(Be(198));lN||(lN=!0,$I=d)}}function Uh(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function E5(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ZO(e){if(Uh(e)!==e)throw Error(Be(188))}function tae(e){var t=e.alternate;if(!t){if(t=Uh(e),t===null)throw Error(Be(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return ZO(a),e;if(s===n)return ZO(a),t;s=s.sibling}throw Error(Be(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(Be(189))}}if(r.alternate!==n)throw Error(Be(190))}if(r.tag!==3)throw Error(Be(188));return r.stateNode.current===r?e:t}function T5(e){return e=tae(e),e!==null?j5(e):null}function j5(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=j5(e);if(t!==null)return t;e=e.sibling}return null}var A5=gi.unstable_scheduleCallback,eP=gi.unstable_cancelCallback,rae=gi.unstable_shouldYield,nae=gi.unstable_requestPaint,On=gi.unstable_now,aae=gi.unstable_getCurrentPriorityLevel,Lj=gi.unstable_ImmediatePriority,$5=gi.unstable_UserBlockingPriority,uN=gi.unstable_NormalPriority,sae=gi.unstable_LowPriority,R5=gi.unstable_IdlePriority,OS=null,nl=null;function iae(e){if(nl&&typeof nl.onCommitFiberRoot=="function")try{nl.onCommitFiberRoot(OS,e,void 0,(e.current.flags&128)===128)}catch{}}var mo=Math.clz32?Math.clz32:uae,oae=Math.log,lae=Math.LN2;function uae(e){return e>>>=0,e===0?32:31-(oae(e)/lae|0)|0}var Dw=64,Mw=4194304;function Hy(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function cN(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Hy(o):(s&=i,s!==0&&(n=Hy(s)))}else i=r&~a,i!==0?n=Hy(i):s!==0&&(n=Hy(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-mo(t),a=1<<r,n|=e[r],t&=~a;return n}function cae(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dae(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-mo(s),o=1<<i,u=a[i];u===-1?(!(o&r)||o&n)&&(a[i]=cae(o,t)):u<=t&&(e.expiredLanes|=o),s&=~o}}function RI(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function D5(){var e=Dw;return Dw<<=1,!(Dw&4194240)&&(Dw=64),e}function GC(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Tb(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-mo(t),e[t]=r}function hae(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-mo(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function zj(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-mo(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Lr=0;function M5(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var F5,Bj,O5,P5,L5,DI=!1,Fw=[],ic=null,oc=null,lc=null,jv=new Map,Av=new Map,Lu=[],pae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tP(e,t){switch(e){case"focusin":case"focusout":ic=null;break;case"dragenter":case"dragleave":oc=null;break;case"mouseover":case"mouseout":lc=null;break;case"pointerover":case"pointerout":jv.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Av.delete(t.pointerId)}}function Ny(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=Ab(t),t!==null&&Bj(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function fae(e,t,r,n,a){switch(t){case"focusin":return ic=Ny(ic,e,t,r,n,a),!0;case"dragenter":return oc=Ny(oc,e,t,r,n,a),!0;case"mouseover":return lc=Ny(lc,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return jv.set(s,Ny(jv.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Av.set(s,Ny(Av.get(s)||null,e,t,r,n,a)),!0}return!1}function z5(e){var t=$d(e.target);if(t!==null){var r=Uh(t);if(r!==null){if(t=r.tag,t===13){if(t=E5(r),t!==null){e.blockedOn=t,L5(e.priority,function(){O5(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function k1(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=MI(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);TI=n,r.target.dispatchEvent(n),TI=null}else return t=Ab(r),t!==null&&Bj(t),e.blockedOn=r,!1;t.shift()}return!0}function rP(e,t,r){k1(e)&&r.delete(t)}function mae(){DI=!1,ic!==null&&k1(ic)&&(ic=null),oc!==null&&k1(oc)&&(oc=null),lc!==null&&k1(lc)&&(lc=null),jv.forEach(rP),Av.forEach(rP)}function Sy(e,t){e.blockedOn===t&&(e.blockedOn=null,DI||(DI=!0,gi.unstable_scheduleCallback(gi.unstable_NormalPriority,mae)))}function $v(e){function t(a){return Sy(a,e)}if(0<Fw.length){Sy(Fw[0],e);for(var r=1;r<Fw.length;r++){var n=Fw[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ic!==null&&Sy(ic,e),oc!==null&&Sy(oc,e),lc!==null&&Sy(lc,e),jv.forEach(t),Av.forEach(t),r=0;r<Lu.length;r++)n=Lu[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Lu.length&&(r=Lu[0],r.blockedOn===null);)z5(r),r.blockedOn===null&&Lu.shift()}var xm=ou.ReactCurrentBatchConfig,dN=!0;function gae(e,t,r,n){var a=Lr,s=xm.transition;xm.transition=null;try{Lr=1,Uj(e,t,r,n)}finally{Lr=a,xm.transition=s}}function xae(e,t,r,n){var a=Lr,s=xm.transition;xm.transition=null;try{Lr=4,Uj(e,t,r,n)}finally{Lr=a,xm.transition=s}}function Uj(e,t,r,n){if(dN){var a=MI(e,t,r,n);if(a===null)n2(e,t,n,hN,r),tP(e,n);else if(fae(a,e,t,r,n))n.stopPropagation();else if(tP(e,n),t&4&&-1<pae.indexOf(e)){for(;a!==null;){var s=Ab(a);if(s!==null&&F5(s),s=MI(e,t,r,n),s===null&&n2(e,t,n,hN,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else n2(e,t,n,null,r)}}var hN=null;function MI(e,t,r,n){if(hN=null,e=Pj(n),e=$d(e),e!==null)if(t=Uh(e),t===null)e=null;else if(r=t.tag,r===13){if(e=E5(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return hN=e,null}function B5(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(aae()){case Lj:return 1;case $5:return 4;case uN:case sae:return 16;case R5:return 536870912;default:return 16}default:return 16}}var Zu=null,Wj=null,C1=null;function U5(){if(C1)return C1;var e,t=Wj,r=t.length,n,a="value"in Zu?Zu.value:Zu.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return C1=a.slice(e,1<n?1-n:void 0)}function I1(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ow(){return!0}function nP(){return!1}function ki(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ow:nP,this.isPropagationStopped=nP,this}return kn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ow)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ow)},persist:function(){},isPersistent:Ow}),t}var kg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vj=ki(kg),jb=kn({},kg,{view:0,detail:0}),yae=ki(jb),KC,QC,_y,PS=kn({},jb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hj,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_y&&(_y&&e.type==="mousemove"?(KC=e.screenX-_y.screenX,QC=e.screenY-_y.screenY):QC=KC=0,_y=e),KC)},movementY:function(e){return"movementY"in e?e.movementY:QC}}),aP=ki(PS),vae=kn({},PS,{dataTransfer:0}),bae=ki(vae),wae=kn({},jb,{relatedTarget:0}),XC=ki(wae),Nae=kn({},kg,{animationName:0,elapsedTime:0,pseudoElement:0}),Sae=ki(Nae),_ae=kn({},kg,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kae=ki(_ae),Cae=kn({},kg,{data:0}),sP=ki(Cae),Iae={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Eae={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tae={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jae(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Tae[e])?!!t[e]:!1}function Hj(){return jae}var Aae=kn({},jb,{key:function(e){if(e.key){var t=Iae[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=I1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Eae[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hj,charCode:function(e){return e.type==="keypress"?I1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?I1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$ae=ki(Aae),Rae=kn({},PS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),iP=ki(Rae),Dae=kn({},jb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hj}),Mae=ki(Dae),Fae=kn({},kg,{propertyName:0,elapsedTime:0,pseudoElement:0}),Oae=ki(Fae),Pae=kn({},PS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Lae=ki(Pae),zae=[9,13,27,32],qj=Yl&&"CompositionEvent"in window,dv=null;Yl&&"documentMode"in document&&(dv=document.documentMode);var Bae=Yl&&"TextEvent"in window&&!dv,W5=Yl&&(!qj||dv&&8<dv&&11>=dv),oP=" ",lP=!1;function V5(e,t){switch(e){case"keyup":return zae.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function H5(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var em=!1;function Uae(e,t){switch(e){case"compositionend":return H5(t);case"keypress":return t.which!==32?null:(lP=!0,oP);case"textInput":return e=t.data,e===oP&&lP?null:e;default:return null}}function Wae(e,t){if(em)return e==="compositionend"||!qj&&V5(e,t)?(e=U5(),C1=Wj=Zu=null,em=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return W5&&t.locale!=="ko"?null:t.data;default:return null}}var Vae={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uP(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Vae[e.type]:t==="textarea"}function q5(e,t,r,n){S5(n),t=pN(t,"onChange"),0<t.length&&(r=new Vj("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var hv=null,Rv=null;function Hae(e){nB(e,0)}function LS(e){var t=nm(e);if(g5(t))return e}function qae(e,t){if(e==="change")return t}var G5=!1;if(Yl){var YC;if(Yl){var JC="oninput"in document;if(!JC){var cP=document.createElement("div");cP.setAttribute("oninput","return;"),JC=typeof cP.oninput=="function"}YC=JC}else YC=!1;G5=YC&&(!document.documentMode||9<document.documentMode)}function dP(){hv&&(hv.detachEvent("onpropertychange",K5),Rv=hv=null)}function K5(e){if(e.propertyName==="value"&&LS(Rv)){var t=[];q5(t,Rv,e,Pj(e)),I5(Hae,t)}}function Gae(e,t,r){e==="focusin"?(dP(),hv=t,Rv=r,hv.attachEvent("onpropertychange",K5)):e==="focusout"&&dP()}function Kae(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return LS(Rv)}function Qae(e,t){if(e==="click")return LS(t)}function Xae(e,t){if(e==="input"||e==="change")return LS(t)}function Yae(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var No=typeof Object.is=="function"?Object.is:Yae;function Dv(e,t){if(No(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!xI.call(t,a)||!No(e[a],t[a]))return!1}return!0}function hP(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pP(e,t){var r=hP(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hP(r)}}function Q5(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Q5(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function X5(){for(var e=window,t=iN();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=iN(e.document)}return t}function Gj(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Jae(e){var t=X5(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Q5(r.ownerDocument.documentElement,r)){if(n!==null&&Gj(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=pP(r,s);var i=pP(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Zae=Yl&&"documentMode"in document&&11>=document.documentMode,tm=null,FI=null,pv=null,OI=!1;function fP(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;OI||tm==null||tm!==iN(n)||(n=tm,"selectionStart"in n&&Gj(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pv&&Dv(pv,n)||(pv=n,n=pN(FI,"onSelect"),0<n.length&&(t=new Vj("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=tm)))}function Pw(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var rm={animationend:Pw("Animation","AnimationEnd"),animationiteration:Pw("Animation","AnimationIteration"),animationstart:Pw("Animation","AnimationStart"),transitionend:Pw("Transition","TransitionEnd")},ZC={},Y5={};Yl&&(Y5=document.createElement("div").style,"AnimationEvent"in window||(delete rm.animationend.animation,delete rm.animationiteration.animation,delete rm.animationstart.animation),"TransitionEvent"in window||delete rm.transitionend.transition);function zS(e){if(ZC[e])return ZC[e];if(!rm[e])return e;var t=rm[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Y5)return ZC[e]=t[r];return e}var J5=zS("animationend"),Z5=zS("animationiteration"),eB=zS("animationstart"),tB=zS("transitionend"),rB=new Map,mP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bc(e,t){rB.set(e,t),Bh(t,[e])}for(var e2=0;e2<mP.length;e2++){var t2=mP[e2],ese=t2.toLowerCase(),tse=t2[0].toUpperCase()+t2.slice(1);Bc(ese,"on"+tse)}Bc(J5,"onAnimationEnd");Bc(Z5,"onAnimationIteration");Bc(eB,"onAnimationStart");Bc("dblclick","onDoubleClick");Bc("focusin","onFocus");Bc("focusout","onBlur");Bc(tB,"onTransitionEnd");Vm("onMouseEnter",["mouseout","mouseover"]);Vm("onMouseLeave",["mouseout","mouseover"]);Vm("onPointerEnter",["pointerout","pointerover"]);Vm("onPointerLeave",["pointerout","pointerover"]);Bh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rse=new Set("cancel close invalid load scroll toggle".split(" ").concat(qy));function gP(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,eae(n,t,void 0,e),e.currentTarget=null}function nB(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],u=o.instance,d=o.currentTarget;if(o=o.listener,u!==s&&a.isPropagationStopped())break e;gP(a,o,d),s=u}else for(i=0;i<n.length;i++){if(o=n[i],u=o.instance,d=o.currentTarget,o=o.listener,u!==s&&a.isPropagationStopped())break e;gP(a,o,d),s=u}}}if(lN)throw e=$I,lN=!1,$I=null,e}function on(e,t){var r=t[UI];r===void 0&&(r=t[UI]=new Set);var n=e+"__bubble";r.has(n)||(aB(t,e,2,!1),r.add(n))}function r2(e,t,r){var n=0;t&&(n|=4),aB(r,e,n,t)}var Lw="_reactListening"+Math.random().toString(36).slice(2);function Mv(e){if(!e[Lw]){e[Lw]=!0,d5.forEach(function(r){r!=="selectionchange"&&(rse.has(r)||r2(r,!1,e),r2(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Lw]||(t[Lw]=!0,r2("selectionchange",!1,t))}}function aB(e,t,r,n){switch(B5(t)){case 1:var a=gae;break;case 4:a=xae;break;default:a=Uj}r=a.bind(null,t,r,e),a=void 0,!AI||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function n2(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;i=i.return}for(;o!==null;){if(i=$d(o),i===null)return;if(u=i.tag,u===5||u===6){n=s=i;continue e}o=o.parentNode}}n=n.return}I5(function(){var d=s,c=Pj(r),h=[];e:{var p=rB.get(e);if(p!==void 0){var f=Vj,g=e;switch(e){case"keypress":if(I1(r)===0)break e;case"keydown":case"keyup":f=$ae;break;case"focusin":g="focus",f=XC;break;case"focusout":g="blur",f=XC;break;case"beforeblur":case"afterblur":f=XC;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=aP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=bae;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Mae;break;case J5:case Z5:case eB:f=Sae;break;case tB:f=Oae;break;case"scroll":f=yae;break;case"wheel":f=Lae;break;case"copy":case"cut":case"paste":f=kae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=iP}var m=(t&4)!==0,x=!m&&e==="scroll",y=m?p!==null?p+"Capture":null:p;m=[];for(var v=d,b;v!==null;){b=v;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,y!==null&&(N=Tv(v,y),N!=null&&m.push(Fv(v,N,b)))),x)break;v=v.return}0<m.length&&(p=new f(p,g,null,r,c),h.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&r!==TI&&(g=r.relatedTarget||r.fromElement)&&($d(g)||g[Jl]))break e;if((f||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,f?(g=r.relatedTarget||r.toElement,f=d,g=g?$d(g):null,g!==null&&(x=Uh(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(f=null,g=d),f!==g)){if(m=aP,N="onMouseLeave",y="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=iP,N="onPointerLeave",y="onPointerEnter",v="pointer"),x=f==null?p:nm(f),b=g==null?p:nm(g),p=new m(N,v+"leave",f,r,c),p.target=x,p.relatedTarget=b,N=null,$d(c)===d&&(m=new m(y,v+"enter",g,r,c),m.target=b,m.relatedTarget=x,N=m),x=N,f&&g)t:{for(m=f,y=g,v=0,b=m;b;b=jf(b))v++;for(b=0,N=y;N;N=jf(N))b++;for(;0<v-b;)m=jf(m),v--;for(;0<b-v;)y=jf(y),b--;for(;v--;){if(m===y||y!==null&&m===y.alternate)break t;m=jf(m),y=jf(y)}m=null}else m=null;f!==null&&xP(h,p,f,m,!1),g!==null&&x!==null&&xP(h,x,g,m,!0)}}e:{if(p=d?nm(d):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var S=qae;else if(uP(p))if(G5)S=Xae;else{S=Kae;var _=Gae}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=Qae);if(S&&(S=S(e,d))){q5(h,S,r,c);break e}_&&_(e,p,d),e==="focusout"&&(_=p._wrapperState)&&_.controlled&&p.type==="number"&&_I(p,"number",p.value)}switch(_=d?nm(d):window,e){case"focusin":(uP(_)||_.contentEditable==="true")&&(tm=_,FI=d,pv=null);break;case"focusout":pv=FI=tm=null;break;case"mousedown":OI=!0;break;case"contextmenu":case"mouseup":case"dragend":OI=!1,fP(h,r,c);break;case"selectionchange":if(Zae)break;case"keydown":case"keyup":fP(h,r,c)}var C;if(qj)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else em?V5(e,r)&&(k="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(W5&&r.locale!=="ko"&&(em||k!=="onCompositionStart"?k==="onCompositionEnd"&&em&&(C=U5()):(Zu=c,Wj="value"in Zu?Zu.value:Zu.textContent,em=!0)),_=pN(d,k),0<_.length&&(k=new sP(k,e,null,r,c),h.push({event:k,listeners:_}),C?k.data=C:(C=H5(r),C!==null&&(k.data=C)))),(C=Bae?Uae(e,r):Wae(e,r))&&(d=pN(d,"onBeforeInput"),0<d.length&&(c=new sP("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:d}),c.data=C))}nB(h,t)})}function Fv(e,t,r){return{instance:e,listener:t,currentTarget:r}}function pN(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Tv(e,r),s!=null&&n.unshift(Fv(e,s,a)),s=Tv(e,t),s!=null&&n.push(Fv(e,s,a))),e=e.return}return n}function jf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function xP(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,u=o.alternate,d=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&d!==null&&(o=d,a?(u=Tv(r,s),u!=null&&i.unshift(Fv(r,u,o))):a||(u=Tv(r,s),u!=null&&i.push(Fv(r,u,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var nse=/\r\n?/g,ase=/\u0000|\uFFFD/g;function yP(e){return(typeof e=="string"?e:""+e).replace(nse,`
`).replace(ase,"")}function zw(e,t,r){if(t=yP(t),yP(e)!==t&&r)throw Error(Be(425))}function fN(){}var PI=null,LI=null;function zI(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var BI=typeof setTimeout=="function"?setTimeout:void 0,sse=typeof clearTimeout=="function"?clearTimeout:void 0,vP=typeof Promise=="function"?Promise:void 0,ise=typeof queueMicrotask=="function"?queueMicrotask:typeof vP<"u"?function(e){return vP.resolve(null).then(e).catch(ose)}:BI;function ose(e){setTimeout(function(){throw e})}function a2(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),$v(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);$v(t)}function uc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function bP(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Cg=Math.random().toString(36).slice(2),Yo="__reactFiber$"+Cg,Ov="__reactProps$"+Cg,Jl="__reactContainer$"+Cg,UI="__reactEvents$"+Cg,lse="__reactListeners$"+Cg,use="__reactHandles$"+Cg;function $d(e){var t=e[Yo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Jl]||r[Yo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=bP(e);e!==null;){if(r=e[Yo])return r;e=bP(e)}return t}e=r,r=e.parentNode}return null}function Ab(e){return e=e[Yo]||e[Jl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function nm(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Be(33))}function BS(e){return e[Ov]||null}var WI=[],am=-1;function Uc(e){return{current:e}}function ln(e){0>am||(e.current=WI[am],WI[am]=null,am--)}function tn(e,t){am++,WI[am]=e.current,e.current=t}var wc={},Xa=Uc(wc),Ws=Uc(!1),ah=wc;function Hm(e,t){var r=e.type.contextTypes;if(!r)return wc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Vs(e){return e=e.childContextTypes,e!=null}function mN(){ln(Ws),ln(Xa)}function wP(e,t,r){if(Xa.current!==wc)throw Error(Be(168));tn(Xa,t),tn(Ws,r)}function sB(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Be(108,Gne(e)||"Unknown",a));return kn({},r,n)}function gN(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wc,ah=Xa.current,tn(Xa,e),tn(Ws,Ws.current),!0}function NP(e,t,r){var n=e.stateNode;if(!n)throw Error(Be(169));r?(e=sB(e,t,ah),n.__reactInternalMemoizedMergedChildContext=e,ln(Ws),ln(Xa),tn(Xa,e)):ln(Ws),tn(Ws,r)}var Dl=null,US=!1,s2=!1;function iB(e){Dl===null?Dl=[e]:Dl.push(e)}function cse(e){US=!0,iB(e)}function Wc(){if(!s2&&Dl!==null){s2=!0;var e=0,t=Lr;try{var r=Dl;for(Lr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Dl=null,US=!1}catch(a){throw Dl!==null&&(Dl=Dl.slice(e+1)),A5(Lj,Wc),a}finally{Lr=t,s2=!1}}return null}var sm=[],im=0,xN=null,yN=0,Di=[],Mi=0,sh=null,Bl=1,Ul="";function vd(e,t){sm[im++]=yN,sm[im++]=xN,xN=e,yN=t}function oB(e,t,r){Di[Mi++]=Bl,Di[Mi++]=Ul,Di[Mi++]=sh,sh=e;var n=Bl;e=Ul;var a=32-mo(n)-1;n&=~(1<<a),r+=1;var s=32-mo(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Bl=1<<32-mo(t)+a|r<<a|n,Ul=s+e}else Bl=1<<s|r<<a|n,Ul=e}function Kj(e){e.return!==null&&(vd(e,1),oB(e,1,0))}function Qj(e){for(;e===xN;)xN=sm[--im],sm[im]=null,yN=sm[--im],sm[im]=null;for(;e===sh;)sh=Di[--Mi],Di[Mi]=null,Ul=Di[--Mi],Di[Mi]=null,Bl=Di[--Mi],Di[Mi]=null}var hi=null,oi=null,fn=!1,ho=null;function lB(e,t){var r=Oi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function SP(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,hi=e,oi=uc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,hi=e,oi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=sh!==null?{id:Bl,overflow:Ul}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Oi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,hi=e,oi=null,!0):!1;default:return!1}}function VI(e){return(e.mode&1)!==0&&(e.flags&128)===0}function HI(e){if(fn){var t=oi;if(t){var r=t;if(!SP(e,t)){if(VI(e))throw Error(Be(418));t=uc(r.nextSibling);var n=hi;t&&SP(e,t)?lB(n,r):(e.flags=e.flags&-4097|2,fn=!1,hi=e)}}else{if(VI(e))throw Error(Be(418));e.flags=e.flags&-4097|2,fn=!1,hi=e}}}function _P(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;hi=e}function Bw(e){if(e!==hi)return!1;if(!fn)return _P(e),fn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!zI(e.type,e.memoizedProps)),t&&(t=oi)){if(VI(e))throw uB(),Error(Be(418));for(;t;)lB(e,t),t=uc(t.nextSibling)}if(_P(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Be(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){oi=uc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}oi=null}}else oi=hi?uc(e.stateNode.nextSibling):null;return!0}function uB(){for(var e=oi;e;)e=uc(e.nextSibling)}function qm(){oi=hi=null,fn=!1}function Xj(e){ho===null?ho=[e]:ho.push(e)}var dse=ou.ReactCurrentBatchConfig;function ky(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Be(309));var n=r.stateNode}if(!n)throw Error(Be(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(Be(284));if(!r._owner)throw Error(Be(290,e))}return e}function Uw(e,t){throw e=Object.prototype.toString.call(t),Error(Be(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function kP(e){var t=e._init;return t(e._payload)}function cB(e){function t(y,v){if(e){var b=y.deletions;b===null?(y.deletions=[v],y.flags|=16):b.push(v)}}function r(y,v){if(!e)return null;for(;v!==null;)t(y,v),v=v.sibling;return null}function n(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function a(y,v){return y=pc(y,v),y.index=0,y.sibling=null,y}function s(y,v,b){return y.index=b,e?(b=y.alternate,b!==null?(b=b.index,b<v?(y.flags|=2,v):b):(y.flags|=2,v)):(y.flags|=1048576,v)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,v,b,N){return v===null||v.tag!==6?(v=h2(b,y.mode,N),v.return=y,v):(v=a(v,b),v.return=y,v)}function u(y,v,b,N){var S=b.type;return S===Zf?c(y,v,b.props.children,N,b.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ru&&kP(S)===v.type)?(N=a(v,b.props),N.ref=ky(y,v,b),N.return=y,N):(N=D1(b.type,b.key,b.props,null,y.mode,N),N.ref=ky(y,v,b),N.return=y,N)}function d(y,v,b,N){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=p2(b,y.mode,N),v.return=y,v):(v=a(v,b.children||[]),v.return=y,v)}function c(y,v,b,N,S){return v===null||v.tag!==7?(v=Qd(b,y.mode,N,S),v.return=y,v):(v=a(v,b),v.return=y,v)}function h(y,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=h2(""+v,y.mode,b),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Aw:return b=D1(v.type,v.key,v.props,null,y.mode,b),b.ref=ky(y,null,v),b.return=y,b;case Jf:return v=p2(v,y.mode,b),v.return=y,v;case Ru:var N=v._init;return h(y,N(v._payload),b)}if(Vy(v)||by(v))return v=Qd(v,y.mode,b,null),v.return=y,v;Uw(y,v)}return null}function p(y,v,b,N){var S=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:o(y,v,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Aw:return b.key===S?u(y,v,b,N):null;case Jf:return b.key===S?d(y,v,b,N):null;case Ru:return S=b._init,p(y,v,S(b._payload),N)}if(Vy(b)||by(b))return S!==null?null:c(y,v,b,N,null);Uw(y,b)}return null}function f(y,v,b,N,S){if(typeof N=="string"&&N!==""||typeof N=="number")return y=y.get(b)||null,o(v,y,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Aw:return y=y.get(N.key===null?b:N.key)||null,u(v,y,N,S);case Jf:return y=y.get(N.key===null?b:N.key)||null,d(v,y,N,S);case Ru:var _=N._init;return f(y,v,b,_(N._payload),S)}if(Vy(N)||by(N))return y=y.get(b)||null,c(v,y,N,S,null);Uw(v,N)}return null}function g(y,v,b,N){for(var S=null,_=null,C=v,k=v=0,I=null;C!==null&&k<b.length;k++){C.index>k?(I=C,C=null):I=C.sibling;var T=p(y,C,b[k],N);if(T===null){C===null&&(C=I);break}e&&C&&T.alternate===null&&t(y,C),v=s(T,v,k),_===null?S=T:_.sibling=T,_=T,C=I}if(k===b.length)return r(y,C),fn&&vd(y,k),S;if(C===null){for(;k<b.length;k++)C=h(y,b[k],N),C!==null&&(v=s(C,v,k),_===null?S=C:_.sibling=C,_=C);return fn&&vd(y,k),S}for(C=n(y,C);k<b.length;k++)I=f(C,y,k,b[k],N),I!==null&&(e&&I.alternate!==null&&C.delete(I.key===null?k:I.key),v=s(I,v,k),_===null?S=I:_.sibling=I,_=I);return e&&C.forEach(function(j){return t(y,j)}),fn&&vd(y,k),S}function m(y,v,b,N){var S=by(b);if(typeof S!="function")throw Error(Be(150));if(b=S.call(b),b==null)throw Error(Be(151));for(var _=S=null,C=v,k=v=0,I=null,T=b.next();C!==null&&!T.done;k++,T=b.next()){C.index>k?(I=C,C=null):I=C.sibling;var j=p(y,C,T.value,N);if(j===null){C===null&&(C=I);break}e&&C&&j.alternate===null&&t(y,C),v=s(j,v,k),_===null?S=j:_.sibling=j,_=j,C=I}if(T.done)return r(y,C),fn&&vd(y,k),S;if(C===null){for(;!T.done;k++,T=b.next())T=h(y,T.value,N),T!==null&&(v=s(T,v,k),_===null?S=T:_.sibling=T,_=T);return fn&&vd(y,k),S}for(C=n(y,C);!T.done;k++,T=b.next())T=f(C,y,k,T.value,N),T!==null&&(e&&T.alternate!==null&&C.delete(T.key===null?k:T.key),v=s(T,v,k),_===null?S=T:_.sibling=T,_=T);return e&&C.forEach(function(E){return t(y,E)}),fn&&vd(y,k),S}function x(y,v,b,N){if(typeof b=="object"&&b!==null&&b.type===Zf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Aw:e:{for(var S=b.key,_=v;_!==null;){if(_.key===S){if(S=b.type,S===Zf){if(_.tag===7){r(y,_.sibling),v=a(_,b.props.children),v.return=y,y=v;break e}}else if(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ru&&kP(S)===_.type){r(y,_.sibling),v=a(_,b.props),v.ref=ky(y,_,b),v.return=y,y=v;break e}r(y,_);break}else t(y,_);_=_.sibling}b.type===Zf?(v=Qd(b.props.children,y.mode,N,b.key),v.return=y,y=v):(N=D1(b.type,b.key,b.props,null,y.mode,N),N.ref=ky(y,v,b),N.return=y,y=N)}return i(y);case Jf:e:{for(_=b.key;v!==null;){if(v.key===_)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){r(y,v.sibling),v=a(v,b.children||[]),v.return=y,y=v;break e}else{r(y,v);break}else t(y,v);v=v.sibling}v=p2(b,y.mode,N),v.return=y,y=v}return i(y);case Ru:return _=b._init,x(y,v,_(b._payload),N)}if(Vy(b))return g(y,v,b,N);if(by(b))return m(y,v,b,N);Uw(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(r(y,v.sibling),v=a(v,b),v.return=y,y=v):(r(y,v),v=h2(b,y.mode,N),v.return=y,y=v),i(y)):r(y,v)}return x}var Gm=cB(!0),dB=cB(!1),vN=Uc(null),bN=null,om=null,Yj=null;function Jj(){Yj=om=bN=null}function Zj(e){var t=vN.current;ln(vN),e._currentValue=t}function qI(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ym(e,t){bN=e,Yj=om=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zs=!0),e.firstContext=null)}function Vi(e){var t=e._currentValue;if(Yj!==e)if(e={context:e,memoizedValue:t,next:null},om===null){if(bN===null)throw Error(Be(308));om=e,bN.dependencies={lanes:0,firstContext:e}}else om=om.next=e;return t}var Rd=null;function eA(e){Rd===null?Rd=[e]:Rd.push(e)}function hB(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,eA(t)):(r.next=a.next,a.next=r),t.interleaved=r,Zl(e,n)}function Zl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Du=!1;function tA(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pB(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Hl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function cc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Nr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Zl(e,r)}return a=n.interleaved,a===null?(t.next=t,eA(n)):(t.next=a.next,a.next=t),n.interleaved=t,Zl(e,r)}function E1(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zj(e,r)}}function CP(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function wN(e,t,r,n){var a=e.updateQueue;Du=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var u=o,d=u.next;u.next=null,i===null?s=d:i.next=d,i=u;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==i&&(o===null?c.firstBaseUpdate=d:o.next=d,c.lastBaseUpdate=u))}if(s!==null){var h=a.baseState;i=0,c=d=u=null,o=s;do{var p=o.lane,f=o.eventTime;if((n&p)===p){c!==null&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(p=t,f=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(f,h,p);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,p=typeof g=="function"?g.call(f,h,p):g,p==null)break e;h=kn({},h,p);break e;case 2:Du=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else f={eventTime:f,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(d=c=f,u=h):c=c.next=f,i|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(c===null&&(u=h),a.baseState=u,a.firstBaseUpdate=d,a.lastBaseUpdate=c,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);oh|=i,e.lanes=i,e.memoizedState=h}}function IP(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Be(191,a));a.call(n)}}}var $b={},al=Uc($b),Pv=Uc($b),Lv=Uc($b);function Dd(e){if(e===$b)throw Error(Be(174));return e}function rA(e,t){switch(tn(Lv,t),tn(Pv,e),tn(al,$b),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:CI(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=CI(t,e)}ln(al),tn(al,t)}function Km(){ln(al),ln(Pv),ln(Lv)}function fB(e){Dd(Lv.current);var t=Dd(al.current),r=CI(t,e.type);t!==r&&(tn(Pv,e),tn(al,r))}function nA(e){Pv.current===e&&(ln(al),ln(Pv))}var wn=Uc(0);function NN(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var i2=[];function aA(){for(var e=0;e<i2.length;e++)i2[e]._workInProgressVersionPrimary=null;i2.length=0}var T1=ou.ReactCurrentDispatcher,o2=ou.ReactCurrentBatchConfig,ih=0,Sn=null,aa=null,xa=null,SN=!1,fv=!1,zv=0,hse=0;function za(){throw Error(Be(321))}function sA(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!No(e[r],t[r]))return!1;return!0}function iA(e,t,r,n,a,s){if(ih=s,Sn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,T1.current=e===null||e.memoizedState===null?gse:xse,e=r(n,a),fv){s=0;do{if(fv=!1,zv=0,25<=s)throw Error(Be(301));s+=1,xa=aa=null,t.updateQueue=null,T1.current=yse,e=r(n,a)}while(fv)}if(T1.current=_N,t=aa!==null&&aa.next!==null,ih=0,xa=aa=Sn=null,SN=!1,t)throw Error(Be(300));return e}function oA(){var e=zv!==0;return zv=0,e}function Wo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xa===null?Sn.memoizedState=xa=e:xa=xa.next=e,xa}function Hi(){if(aa===null){var e=Sn.alternate;e=e!==null?e.memoizedState:null}else e=aa.next;var t=xa===null?Sn.memoizedState:xa.next;if(t!==null)xa=t,aa=e;else{if(e===null)throw Error(Be(310));aa=e,e={memoizedState:aa.memoizedState,baseState:aa.baseState,baseQueue:aa.baseQueue,queue:aa.queue,next:null},xa===null?Sn.memoizedState=xa=e:xa=xa.next=e}return xa}function Bv(e,t){return typeof t=="function"?t(e):t}function l2(e){var t=Hi(),r=t.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=e;var n=aa,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,u=null,d=s;do{var c=d.lane;if((ih&c)===c)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:c,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(o=u=h,i=n):u=u.next=h,Sn.lanes|=c,oh|=c}d=d.next}while(d!==null&&d!==s);u===null?i=n:u.next=o,No(n,t.memoizedState)||(zs=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Sn.lanes|=s,oh|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function u2(e){var t=Hi(),r=t.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);No(s,t.memoizedState)||(zs=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function mB(){}function gB(e,t){var r=Sn,n=Hi(),a=t(),s=!No(n.memoizedState,a);if(s&&(n.memoizedState=a,zs=!0),n=n.queue,lA(vB.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||xa!==null&&xa.memoizedState.tag&1){if(r.flags|=2048,Uv(9,yB.bind(null,r,n,a,t),void 0,null),Sa===null)throw Error(Be(349));ih&30||xB(r,t,a)}return a}function xB(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Sn.updateQueue,t===null?(t={lastEffect:null,stores:null},Sn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function yB(e,t,r,n){t.value=r,t.getSnapshot=n,bB(t)&&wB(e)}function vB(e,t,r){return r(function(){bB(t)&&wB(e)})}function bB(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!No(e,r)}catch{return!0}}function wB(e){var t=Zl(e,1);t!==null&&go(t,e,1,-1)}function EP(e){var t=Wo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bv,lastRenderedState:e},t.queue=e,e=e.dispatch=mse.bind(null,Sn,e),[t.memoizedState,e]}function Uv(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Sn.updateQueue,t===null?(t={lastEffect:null,stores:null},Sn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function NB(){return Hi().memoizedState}function j1(e,t,r,n){var a=Wo();Sn.flags|=e,a.memoizedState=Uv(1|t,r,void 0,n===void 0?null:n)}function WS(e,t,r,n){var a=Hi();n=n===void 0?null:n;var s=void 0;if(aa!==null){var i=aa.memoizedState;if(s=i.destroy,n!==null&&sA(n,i.deps)){a.memoizedState=Uv(t,r,s,n);return}}Sn.flags|=e,a.memoizedState=Uv(1|t,r,s,n)}function TP(e,t){return j1(8390656,8,e,t)}function lA(e,t){return WS(2048,8,e,t)}function SB(e,t){return WS(4,2,e,t)}function _B(e,t){return WS(4,4,e,t)}function kB(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function CB(e,t,r){return r=r!=null?r.concat([e]):null,WS(4,4,kB.bind(null,t,e),r)}function uA(){}function IB(e,t){var r=Hi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&sA(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function EB(e,t){var r=Hi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&sA(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function TB(e,t,r){return ih&21?(No(r,t)||(r=D5(),Sn.lanes|=r,oh|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zs=!0),e.memoizedState=r)}function pse(e,t){var r=Lr;Lr=r!==0&&4>r?r:4,e(!0);var n=o2.transition;o2.transition={};try{e(!1),t()}finally{Lr=r,o2.transition=n}}function jB(){return Hi().memoizedState}function fse(e,t,r){var n=hc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},AB(e))$B(t,r);else if(r=hB(e,t,r,n),r!==null){var a=ms();go(r,e,n,a),RB(r,t,n)}}function mse(e,t,r){var n=hc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(AB(e))$B(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,No(o,i)){var u=t.interleaved;u===null?(a.next=a,eA(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}r=hB(e,t,a,n),r!==null&&(a=ms(),go(r,e,n,a),RB(r,t,n))}}function AB(e){var t=e.alternate;return e===Sn||t!==null&&t===Sn}function $B(e,t){fv=SN=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function RB(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zj(e,r)}}var _N={readContext:Vi,useCallback:za,useContext:za,useEffect:za,useImperativeHandle:za,useInsertionEffect:za,useLayoutEffect:za,useMemo:za,useReducer:za,useRef:za,useState:za,useDebugValue:za,useDeferredValue:za,useTransition:za,useMutableSource:za,useSyncExternalStore:za,useId:za,unstable_isNewReconciler:!1},gse={readContext:Vi,useCallback:function(e,t){return Wo().memoizedState=[e,t===void 0?null:t],e},useContext:Vi,useEffect:TP,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,j1(4194308,4,kB.bind(null,t,e),r)},useLayoutEffect:function(e,t){return j1(4194308,4,e,t)},useInsertionEffect:function(e,t){return j1(4,2,e,t)},useMemo:function(e,t){var r=Wo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Wo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=fse.bind(null,Sn,e),[n.memoizedState,e]},useRef:function(e){var t=Wo();return e={current:e},t.memoizedState=e},useState:EP,useDebugValue:uA,useDeferredValue:function(e){return Wo().memoizedState=e},useTransition:function(){var e=EP(!1),t=e[0];return e=pse.bind(null,e[1]),Wo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Sn,a=Wo();if(fn){if(r===void 0)throw Error(Be(407));r=r()}else{if(r=t(),Sa===null)throw Error(Be(349));ih&30||xB(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,TP(vB.bind(null,n,s,e),[e]),n.flags|=2048,Uv(9,yB.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Wo(),t=Sa.identifierPrefix;if(fn){var r=Ul,n=Bl;r=(n&~(1<<32-mo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=zv++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=hse++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},xse={readContext:Vi,useCallback:IB,useContext:Vi,useEffect:lA,useImperativeHandle:CB,useInsertionEffect:SB,useLayoutEffect:_B,useMemo:EB,useReducer:l2,useRef:NB,useState:function(){return l2(Bv)},useDebugValue:uA,useDeferredValue:function(e){var t=Hi();return TB(t,aa.memoizedState,e)},useTransition:function(){var e=l2(Bv)[0],t=Hi().memoizedState;return[e,t]},useMutableSource:mB,useSyncExternalStore:gB,useId:jB,unstable_isNewReconciler:!1},yse={readContext:Vi,useCallback:IB,useContext:Vi,useEffect:lA,useImperativeHandle:CB,useInsertionEffect:SB,useLayoutEffect:_B,useMemo:EB,useReducer:u2,useRef:NB,useState:function(){return u2(Bv)},useDebugValue:uA,useDeferredValue:function(e){var t=Hi();return aa===null?t.memoizedState=e:TB(t,aa.memoizedState,e)},useTransition:function(){var e=u2(Bv)[0],t=Hi().memoizedState;return[e,t]},useMutableSource:mB,useSyncExternalStore:gB,useId:jB,unstable_isNewReconciler:!1};function io(e,t){if(e&&e.defaultProps){t=kn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function GI(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:kn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var VS={isMounted:function(e){return(e=e._reactInternals)?Uh(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ms(),a=hc(e),s=Hl(n,a);s.payload=t,r!=null&&(s.callback=r),t=cc(e,s,a),t!==null&&(go(t,e,a,n),E1(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ms(),a=hc(e),s=Hl(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=cc(e,s,a),t!==null&&(go(t,e,a,n),E1(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ms(),n=hc(e),a=Hl(r,n);a.tag=2,t!=null&&(a.callback=t),t=cc(e,a,n),t!==null&&(go(t,e,n,r),E1(t,e,n))}};function jP(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Dv(r,n)||!Dv(a,s):!0}function DB(e,t,r){var n=!1,a=wc,s=t.contextType;return typeof s=="object"&&s!==null?s=Vi(s):(a=Vs(t)?ah:Xa.current,n=t.contextTypes,s=(n=n!=null)?Hm(e,a):wc),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=VS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function AP(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&VS.enqueueReplaceState(t,t.state,null)}function KI(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},tA(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Vi(s):(s=Vs(t)?ah:Xa.current,a.context=Hm(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(GI(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&VS.enqueueReplaceState(a,a.state,null),wN(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Qm(e,t){try{var r="",n=t;do r+=qne(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function c2(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function QI(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var vse=typeof WeakMap=="function"?WeakMap:Map;function MB(e,t,r){r=Hl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){CN||(CN=!0,sE=n),QI(e,t)},r}function FB(e,t,r){r=Hl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){QI(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){QI(e,t),typeof n!="function"&&(dc===null?dc=new Set([this]):dc.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function $P(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new vse;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Rse.bind(null,e,t,r),t.then(e,e))}function RP(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function DP(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Hl(-1,1),t.tag=2,cc(r,t,1))),r.lanes|=1),e)}var bse=ou.ReactCurrentOwner,zs=!1;function ls(e,t,r,n){t.child=e===null?dB(t,null,r,n):Gm(t,e.child,r,n)}function MP(e,t,r,n,a){r=r.render;var s=t.ref;return ym(t,a),n=iA(e,t,r,n,s,a),r=oA(),e!==null&&!zs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,eu(e,t,a)):(fn&&r&&Kj(t),t.flags|=1,ls(e,t,n,a),t.child)}function FP(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!xA(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,OB(e,t,s,n,a)):(e=D1(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Dv,r(i,n)&&e.ref===t.ref)return eu(e,t,a)}return t.flags|=1,e=pc(s,n),e.ref=t.ref,e.return=t,t.child=e}function OB(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Dv(s,n)&&e.ref===t.ref)if(zs=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(zs=!0);else return t.lanes=e.lanes,eu(e,t,a)}return XI(e,t,r,n,a)}function PB(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},tn(um,si),si|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,tn(um,si),si|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,tn(um,si),si|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,tn(um,si),si|=n;return ls(e,t,a,r),t.child}function LB(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function XI(e,t,r,n,a){var s=Vs(r)?ah:Xa.current;return s=Hm(t,s),ym(t,a),r=iA(e,t,r,n,s,a),n=oA(),e!==null&&!zs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,eu(e,t,a)):(fn&&n&&Kj(t),t.flags|=1,ls(e,t,r,a),t.child)}function OP(e,t,r,n,a){if(Vs(r)){var s=!0;gN(t)}else s=!1;if(ym(t,a),t.stateNode===null)A1(e,t),DB(t,r,n),KI(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var u=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=Vi(d):(d=Vs(r)?ah:Xa.current,d=Hm(t,d));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||u!==d)&&AP(t,i,n,d),Du=!1;var p=t.memoizedState;i.state=p,wN(t,n,i,a),u=t.memoizedState,o!==n||p!==u||Ws.current||Du?(typeof c=="function"&&(GI(t,r,c,n),u=t.memoizedState),(o=Du||jP(t,r,o,n,p,u,d))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),i.props=n,i.state=u,i.context=d,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,pB(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:io(t.type,o),i.props=d,h=t.pendingProps,p=i.context,u=r.contextType,typeof u=="object"&&u!==null?u=Vi(u):(u=Vs(r)?ah:Xa.current,u=Hm(t,u));var f=r.getDerivedStateFromProps;(c=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||p!==u)&&AP(t,i,n,u),Du=!1,p=t.memoizedState,i.state=p,wN(t,n,i,a);var g=t.memoizedState;o!==h||p!==g||Ws.current||Du?(typeof f=="function"&&(GI(t,r,f,n),g=t.memoizedState),(d=Du||jP(t,r,d,n,p,g,u)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,u)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=u,n=d):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return YI(e,t,r,n,s,a)}function YI(e,t,r,n,a,s){LB(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&NP(t,r,!1),eu(e,t,s);n=t.stateNode,bse.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Gm(t,e.child,null,s),t.child=Gm(t,null,o,s)):ls(e,t,o,s),t.memoizedState=n.state,a&&NP(t,r,!0),t.child}function zB(e){var t=e.stateNode;t.pendingContext?wP(e,t.pendingContext,t.pendingContext!==t.context):t.context&&wP(e,t.context,!1),rA(e,t.containerInfo)}function PP(e,t,r,n,a){return qm(),Xj(a),t.flags|=256,ls(e,t,r,n),t.child}var JI={dehydrated:null,treeContext:null,retryLane:0};function ZI(e){return{baseLanes:e,cachePool:null,transitions:null}}function BB(e,t,r){var n=t.pendingProps,a=wn.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),tn(wn,a&1),e===null)return HI(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=GS(i,n,0,null),e=Qd(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ZI(r),t.memoizedState=JI,e):cA(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return wse(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var u={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=pc(a,u),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=pc(o,s):(s=Qd(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?ZI(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=JI,n}return s=e.child,e=s.sibling,n=pc(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function cA(e,t){return t=GS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ww(e,t,r,n){return n!==null&&Xj(n),Gm(t,e.child,null,r),e=cA(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function wse(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=c2(Error(Be(422))),Ww(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=GS({mode:"visible",children:n.children},a,0,null),s=Qd(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Gm(t,e.child,null,i),t.child.memoizedState=ZI(i),t.memoizedState=JI,s);if(!(t.mode&1))return Ww(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Be(419)),n=c2(s,n,void 0),Ww(e,t,i,n)}if(o=(i&e.childLanes)!==0,zs||o){if(n=Sa,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Zl(e,a),go(n,e,a,-1))}return gA(),n=c2(Error(Be(421))),Ww(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Dse.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,oi=uc(a.nextSibling),hi=t,fn=!0,ho=null,e!==null&&(Di[Mi++]=Bl,Di[Mi++]=Ul,Di[Mi++]=sh,Bl=e.id,Ul=e.overflow,sh=t),t=cA(t,n.children),t.flags|=4096,t)}function LP(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),qI(e.return,t,r)}function d2(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function UB(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(ls(e,t,n.children,r),n=wn.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&LP(e,r,t);else if(e.tag===19)LP(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(tn(wn,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&NN(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),d2(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&NN(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}d2(t,!0,r,null,s);break;case"together":d2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function A1(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function eu(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),oh|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Be(153));if(t.child!==null){for(e=t.child,r=pc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=pc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Nse(e,t,r){switch(t.tag){case 3:zB(t),qm();break;case 5:fB(t);break;case 1:Vs(t.type)&&gN(t);break;case 4:rA(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;tn(vN,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(tn(wn,wn.current&1),t.flags|=128,null):r&t.child.childLanes?BB(e,t,r):(tn(wn,wn.current&1),e=eu(e,t,r),e!==null?e.sibling:null);tn(wn,wn.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return UB(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),tn(wn,wn.current),n)break;return null;case 22:case 23:return t.lanes=0,PB(e,t,r)}return eu(e,t,r)}var WB,eE,VB,HB;WB=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};eE=function(){};VB=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Dd(al.current);var s=null;switch(r){case"input":a=NI(e,a),n=NI(e,n),s=[];break;case"select":a=kn({},a,{value:void 0}),n=kn({},n,{value:void 0}),s=[];break;case"textarea":a=kI(e,a),n=kI(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=fN)}II(r,n);var i;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var o=a[d];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Iv.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in n){var u=n[d];if(o=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&u!==o&&(u!=null||o!=null))if(d==="style")if(o){for(i in o)!o.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in u)u.hasOwnProperty(i)&&o[i]!==u[i]&&(r||(r={}),r[i]=u[i])}else r||(s||(s=[]),s.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(s=s||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Iv.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&on("scroll",e),s||o===u||(s=[])):(s=s||[]).push(d,u))}r&&(s=s||[]).push("style",r);var d=s;(t.updateQueue=d)&&(t.flags|=4)}};HB=function(e,t,r,n){r!==n&&(t.flags|=4)};function Cy(e,t){if(!fn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ba(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Sse(e,t,r){var n=t.pendingProps;switch(Qj(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ba(t),null;case 1:return Vs(t.type)&&mN(),Ba(t),null;case 3:return n=t.stateNode,Km(),ln(Ws),ln(Xa),aA(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Bw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ho!==null&&(lE(ho),ho=null))),eE(e,t),Ba(t),null;case 5:nA(t);var a=Dd(Lv.current);if(r=t.type,e!==null&&t.stateNode!=null)VB(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Be(166));return Ba(t),null}if(e=Dd(al.current),Bw(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Yo]=t,n[Ov]=s,e=(t.mode&1)!==0,r){case"dialog":on("cancel",n),on("close",n);break;case"iframe":case"object":case"embed":on("load",n);break;case"video":case"audio":for(a=0;a<qy.length;a++)on(qy[a],n);break;case"source":on("error",n);break;case"img":case"image":case"link":on("error",n),on("load",n);break;case"details":on("toggle",n);break;case"input":KO(n,s),on("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},on("invalid",n);break;case"textarea":XO(n,s),on("invalid",n)}II(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&zw(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&zw(n.textContent,o,e),a=["children",""+o]):Iv.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&on("scroll",n)}switch(r){case"input":$w(n),QO(n,s,!0);break;case"textarea":$w(n),YO(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=fN)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=v5(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Yo]=t,e[Ov]=n,WB(e,t,!1,!1),t.stateNode=e;e:{switch(i=EI(r,n),r){case"dialog":on("cancel",e),on("close",e),a=n;break;case"iframe":case"object":case"embed":on("load",e),a=n;break;case"video":case"audio":for(a=0;a<qy.length;a++)on(qy[a],e);a=n;break;case"source":on("error",e),a=n;break;case"img":case"image":case"link":on("error",e),on("load",e),a=n;break;case"details":on("toggle",e),a=n;break;case"input":KO(e,n),a=NI(e,n),on("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=kn({},n,{value:void 0}),on("invalid",e);break;case"textarea":XO(e,n),a=kI(e,n),on("invalid",e);break;default:a=n}II(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var u=o[s];s==="style"?N5(e,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&b5(e,u)):s==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Ev(e,u):typeof u=="number"&&Ev(e,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Iv.hasOwnProperty(s)?u!=null&&s==="onScroll"&&on("scroll",e):u!=null&&Dj(e,s,u,i))}switch(r){case"input":$w(e),QO(e,n,!1);break;case"textarea":$w(e),YO(e);break;case"option":n.value!=null&&e.setAttribute("value",""+bc(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?fm(e,!!n.multiple,s,!1):n.defaultValue!=null&&fm(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=fN)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ba(t),null;case 6:if(e&&t.stateNode!=null)HB(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Be(166));if(r=Dd(Lv.current),Dd(al.current),Bw(t)){if(n=t.stateNode,r=t.memoizedProps,n[Yo]=t,(s=n.nodeValue!==r)&&(e=hi,e!==null))switch(e.tag){case 3:zw(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zw(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Yo]=t,t.stateNode=n}return Ba(t),null;case 13:if(ln(wn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(fn&&oi!==null&&t.mode&1&&!(t.flags&128))uB(),qm(),t.flags|=98560,s=!1;else if(s=Bw(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Be(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Be(317));s[Yo]=t}else qm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ba(t),s=!1}else ho!==null&&(lE(ho),ho=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||wn.current&1?ua===0&&(ua=3):gA())),t.updateQueue!==null&&(t.flags|=4),Ba(t),null);case 4:return Km(),eE(e,t),e===null&&Mv(t.stateNode.containerInfo),Ba(t),null;case 10:return Zj(t.type._context),Ba(t),null;case 17:return Vs(t.type)&&mN(),Ba(t),null;case 19:if(ln(wn),s=t.memoizedState,s===null)return Ba(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Cy(s,!1);else{if(ua!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=NN(e),i!==null){for(t.flags|=128,Cy(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return tn(wn,wn.current&1|2),t.child}e=e.sibling}s.tail!==null&&On()>Xm&&(t.flags|=128,n=!0,Cy(s,!1),t.lanes=4194304)}else{if(!n)if(e=NN(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Cy(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!fn)return Ba(t),null}else 2*On()-s.renderingStartTime>Xm&&r!==1073741824&&(t.flags|=128,n=!0,Cy(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=On(),t.sibling=null,r=wn.current,tn(wn,n?r&1|2:r&1),t):(Ba(t),null);case 22:case 23:return mA(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?si&1073741824&&(Ba(t),t.subtreeFlags&6&&(t.flags|=8192)):Ba(t),null;case 24:return null;case 25:return null}throw Error(Be(156,t.tag))}function _se(e,t){switch(Qj(t),t.tag){case 1:return Vs(t.type)&&mN(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Km(),ln(Ws),ln(Xa),aA(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return nA(t),null;case 13:if(ln(wn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Be(340));qm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ln(wn),null;case 4:return Km(),null;case 10:return Zj(t.type._context),null;case 22:case 23:return mA(),null;case 24:return null;default:return null}}var Vw=!1,Va=!1,kse=typeof WeakSet=="function"?WeakSet:Set,pt=null;function lm(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){An(e,t,n)}else r.current=null}function tE(e,t,r){try{r()}catch(n){An(e,t,n)}}var zP=!1;function Cse(e,t){if(PI=dN,e=X5(),Gj(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,u=-1,d=0,c=0,h=e,p=null;t:for(;;){for(var f;h!==r||a!==0&&h.nodeType!==3||(o=i+a),h!==s||n!==0&&h.nodeType!==3||(u=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===e)break t;if(p===r&&++d===a&&(o=i),p===s&&++c===n&&(u=i),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(LI={focusedElem:e,selectionRange:r},dN=!1,pt=t;pt!==null;)if(t=pt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pt=e;else for(;pt!==null;){t=pt;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:io(t.type,m),x);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(N){An(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,pt=e;break}pt=t.return}return g=zP,zP=!1,g}function mv(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&tE(t,r,s)}a=a.next}while(a!==n)}}function HS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function rE(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function qB(e){var t=e.alternate;t!==null&&(e.alternate=null,qB(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Yo],delete t[Ov],delete t[UI],delete t[lse],delete t[use])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function GB(e){return e.tag===5||e.tag===3||e.tag===4}function BP(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||GB(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nE(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=fN));else if(n!==4&&(e=e.child,e!==null))for(nE(e,t,r),e=e.sibling;e!==null;)nE(e,t,r),e=e.sibling}function aE(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(aE(e,t,r),e=e.sibling;e!==null;)aE(e,t,r),e=e.sibling}var Aa=null,uo=!1;function bu(e,t,r){for(r=r.child;r!==null;)KB(e,t,r),r=r.sibling}function KB(e,t,r){if(nl&&typeof nl.onCommitFiberUnmount=="function")try{nl.onCommitFiberUnmount(OS,r)}catch{}switch(r.tag){case 5:Va||lm(r,t);case 6:var n=Aa,a=uo;Aa=null,bu(e,t,r),Aa=n,uo=a,Aa!==null&&(uo?(e=Aa,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Aa.removeChild(r.stateNode));break;case 18:Aa!==null&&(uo?(e=Aa,r=r.stateNode,e.nodeType===8?a2(e.parentNode,r):e.nodeType===1&&a2(e,r),$v(e)):a2(Aa,r.stateNode));break;case 4:n=Aa,a=uo,Aa=r.stateNode.containerInfo,uo=!0,bu(e,t,r),Aa=n,uo=a;break;case 0:case 11:case 14:case 15:if(!Va&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&tE(r,t,i),a=a.next}while(a!==n)}bu(e,t,r);break;case 1:if(!Va&&(lm(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){An(r,t,o)}bu(e,t,r);break;case 21:bu(e,t,r);break;case 22:r.mode&1?(Va=(n=Va)||r.memoizedState!==null,bu(e,t,r),Va=n):bu(e,t,r);break;default:bu(e,t,r)}}function UP(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new kse),t.forEach(function(n){var a=Mse.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ji(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Aa=o.stateNode,uo=!1;break e;case 3:Aa=o.stateNode.containerInfo,uo=!0;break e;case 4:Aa=o.stateNode.containerInfo,uo=!0;break e}o=o.return}if(Aa===null)throw Error(Be(160));KB(s,i,a),Aa=null,uo=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(d){An(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)QB(t,e),t=t.sibling}function QB(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ji(t,e),Po(e),n&4){try{mv(3,e,e.return),HS(3,e)}catch(m){An(e,e.return,m)}try{mv(5,e,e.return)}catch(m){An(e,e.return,m)}}break;case 1:Ji(t,e),Po(e),n&512&&r!==null&&lm(r,r.return);break;case 5:if(Ji(t,e),Po(e),n&512&&r!==null&&lm(r,r.return),e.flags&32){var a=e.stateNode;try{Ev(a,"")}catch(m){An(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&x5(a,s),EI(o,i);var d=EI(o,s);for(i=0;i<u.length;i+=2){var c=u[i],h=u[i+1];c==="style"?N5(a,h):c==="dangerouslySetInnerHTML"?b5(a,h):c==="children"?Ev(a,h):Dj(a,c,h,d)}switch(o){case"input":SI(a,s);break;case"textarea":y5(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?fm(a,!!s.multiple,f,!1):p!==!!s.multiple&&(s.defaultValue!=null?fm(a,!!s.multiple,s.defaultValue,!0):fm(a,!!s.multiple,s.multiple?[]:"",!1))}a[Ov]=s}catch(m){An(e,e.return,m)}}break;case 6:if(Ji(t,e),Po(e),n&4){if(e.stateNode===null)throw Error(Be(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){An(e,e.return,m)}}break;case 3:if(Ji(t,e),Po(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$v(t.containerInfo)}catch(m){An(e,e.return,m)}break;case 4:Ji(t,e),Po(e);break;case 13:Ji(t,e),Po(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(pA=On())),n&4&&UP(e);break;case 22:if(c=r!==null&&r.memoizedState!==null,e.mode&1?(Va=(d=Va)||c,Ji(t,e),Va=d):Ji(t,e),Po(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!c&&e.mode&1)for(pt=e,c=e.child;c!==null;){for(h=pt=c;pt!==null;){switch(p=pt,f=p.child,p.tag){case 0:case 11:case 14:case 15:mv(4,p,p.return);break;case 1:lm(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){An(n,r,m)}}break;case 5:lm(p,p.return);break;case 22:if(p.memoizedState!==null){VP(h);continue}}f!==null?(f.return=p,pt=f):VP(h)}c=c.sibling}e:for(c=null,h=e;;){if(h.tag===5){if(c===null){c=h;try{a=h.stateNode,d?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,u=h.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=w5("display",i))}catch(m){An(e,e.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(m){An(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ji(t,e),Po(e),n&4&&UP(e);break;case 21:break;default:Ji(t,e),Po(e)}}function Po(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(GB(r)){var n=r;break e}r=r.return}throw Error(Be(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ev(a,""),n.flags&=-33);var s=BP(e);aE(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=BP(e);nE(e,o,i);break;default:throw Error(Be(161))}}catch(u){An(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ise(e,t,r){pt=e,XB(e)}function XB(e,t,r){for(var n=(e.mode&1)!==0;pt!==null;){var a=pt,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Vw;if(!i){var o=a.alternate,u=o!==null&&o.memoizedState!==null||Va;o=Vw;var d=Va;if(Vw=i,(Va=u)&&!d)for(pt=a;pt!==null;)i=pt,u=i.child,i.tag===22&&i.memoizedState!==null?HP(a):u!==null?(u.return=i,pt=u):HP(a);for(;s!==null;)pt=s,XB(s),s=s.sibling;pt=a,Vw=o,Va=d}WP(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,pt=s):WP(e)}}function WP(e){for(;pt!==null;){var t=pt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Va||HS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Va)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:io(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&IP(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}IP(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var c=d.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&$v(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Va||t.flags&512&&rE(t)}catch(p){An(t,t.return,p)}}if(t===e){pt=null;break}if(r=t.sibling,r!==null){r.return=t.return,pt=r;break}pt=t.return}}function VP(e){for(;pt!==null;){var t=pt;if(t===e){pt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,pt=r;break}pt=t.return}}function HP(e){for(;pt!==null;){var t=pt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{HS(4,t)}catch(u){An(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(u){An(t,a,u)}}var s=t.return;try{rE(t)}catch(u){An(t,s,u)}break;case 5:var i=t.return;try{rE(t)}catch(u){An(t,i,u)}}}catch(u){An(t,t.return,u)}if(t===e){pt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,pt=o;break}pt=t.return}}var Ese=Math.ceil,kN=ou.ReactCurrentDispatcher,dA=ou.ReactCurrentOwner,Bi=ou.ReactCurrentBatchConfig,Nr=0,Sa=null,Gn=null,Ra=0,si=0,um=Uc(0),ua=0,Wv=null,oh=0,qS=0,hA=0,gv=null,Os=null,pA=0,Xm=1/0,$l=null,CN=!1,sE=null,dc=null,Hw=!1,ec=null,IN=0,xv=0,iE=null,$1=-1,R1=0;function ms(){return Nr&6?On():$1!==-1?$1:$1=On()}function hc(e){return e.mode&1?Nr&2&&Ra!==0?Ra&-Ra:dse.transition!==null?(R1===0&&(R1=D5()),R1):(e=Lr,e!==0||(e=window.event,e=e===void 0?16:B5(e.type)),e):1}function go(e,t,r,n){if(50<xv)throw xv=0,iE=null,Error(Be(185));Tb(e,r,n),(!(Nr&2)||e!==Sa)&&(e===Sa&&(!(Nr&2)&&(qS|=r),ua===4&&zu(e,Ra)),Hs(e,n),r===1&&Nr===0&&!(t.mode&1)&&(Xm=On()+500,US&&Wc()))}function Hs(e,t){var r=e.callbackNode;dae(e,t);var n=cN(e,e===Sa?Ra:0);if(n===0)r!==null&&eP(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&eP(r),t===1)e.tag===0?cse(qP.bind(null,e)):iB(qP.bind(null,e)),ise(function(){!(Nr&6)&&Wc()}),r=null;else{switch(M5(n)){case 1:r=Lj;break;case 4:r=$5;break;case 16:r=uN;break;case 536870912:r=R5;break;default:r=uN}r=aU(r,YB.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function YB(e,t){if($1=-1,R1=0,Nr&6)throw Error(Be(327));var r=e.callbackNode;if(vm()&&e.callbackNode!==r)return null;var n=cN(e,e===Sa?Ra:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=EN(e,n);else{t=n;var a=Nr;Nr|=2;var s=ZB();(Sa!==e||Ra!==t)&&($l=null,Xm=On()+500,Kd(e,t));do try{Ase();break}catch(o){JB(e,o)}while(!0);Jj(),kN.current=s,Nr=a,Gn!==null?t=0:(Sa=null,Ra=0,t=ua)}if(t!==0){if(t===2&&(a=RI(e),a!==0&&(n=a,t=oE(e,a))),t===1)throw r=Wv,Kd(e,0),zu(e,n),Hs(e,On()),r;if(t===6)zu(e,n);else{if(a=e.current.alternate,!(n&30)&&!Tse(a)&&(t=EN(e,n),t===2&&(s=RI(e),s!==0&&(n=s,t=oE(e,s))),t===1))throw r=Wv,Kd(e,0),zu(e,n),Hs(e,On()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Be(345));case 2:bd(e,Os,$l);break;case 3:if(zu(e,n),(n&130023424)===n&&(t=pA+500-On(),10<t)){if(cN(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){ms(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=BI(bd.bind(null,e,Os,$l),t);break}bd(e,Os,$l);break;case 4:if(zu(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-mo(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=On()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ese(n/1960))-n,10<n){e.timeoutHandle=BI(bd.bind(null,e,Os,$l),n);break}bd(e,Os,$l);break;case 5:bd(e,Os,$l);break;default:throw Error(Be(329))}}}return Hs(e,On()),e.callbackNode===r?YB.bind(null,e):null}function oE(e,t){var r=gv;return e.current.memoizedState.isDehydrated&&(Kd(e,t).flags|=256),e=EN(e,t),e!==2&&(t=Os,Os=r,t!==null&&lE(t)),e}function lE(e){Os===null?Os=e:Os.push.apply(Os,e)}function Tse(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!No(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zu(e,t){for(t&=~hA,t&=~qS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-mo(t),n=1<<r;e[r]=-1,t&=~n}}function qP(e){if(Nr&6)throw Error(Be(327));vm();var t=cN(e,0);if(!(t&1))return Hs(e,On()),null;var r=EN(e,t);if(e.tag!==0&&r===2){var n=RI(e);n!==0&&(t=n,r=oE(e,n))}if(r===1)throw r=Wv,Kd(e,0),zu(e,t),Hs(e,On()),r;if(r===6)throw Error(Be(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bd(e,Os,$l),Hs(e,On()),null}function fA(e,t){var r=Nr;Nr|=1;try{return e(t)}finally{Nr=r,Nr===0&&(Xm=On()+500,US&&Wc())}}function lh(e){ec!==null&&ec.tag===0&&!(Nr&6)&&vm();var t=Nr;Nr|=1;var r=Bi.transition,n=Lr;try{if(Bi.transition=null,Lr=1,e)return e()}finally{Lr=n,Bi.transition=r,Nr=t,!(Nr&6)&&Wc()}}function mA(){si=um.current,ln(um)}function Kd(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,sse(r)),Gn!==null)for(r=Gn.return;r!==null;){var n=r;switch(Qj(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&mN();break;case 3:Km(),ln(Ws),ln(Xa),aA();break;case 5:nA(n);break;case 4:Km();break;case 13:ln(wn);break;case 19:ln(wn);break;case 10:Zj(n.type._context);break;case 22:case 23:mA()}r=r.return}if(Sa=e,Gn=e=pc(e.current,null),Ra=si=t,ua=0,Wv=null,hA=qS=oh=0,Os=gv=null,Rd!==null){for(t=0;t<Rd.length;t++)if(r=Rd[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Rd=null}return e}function JB(e,t){do{var r=Gn;try{if(Jj(),T1.current=_N,SN){for(var n=Sn.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}SN=!1}if(ih=0,xa=aa=Sn=null,fv=!1,zv=0,dA.current=null,r===null||r.return===null){ua=1,Wv=t,Gn=null;break}e:{var s=e,i=r.return,o=r,u=t;if(t=Ra,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=RP(i);if(f!==null){f.flags&=-257,DP(f,i,o,s,t),f.mode&1&&$P(s,d,t),t=f,u=d;var g=t.updateQueue;if(g===null){var m=new Set;m.add(u),t.updateQueue=m}else g.add(u);break e}else{if(!(t&1)){$P(s,d,t),gA();break e}u=Error(Be(426))}}else if(fn&&o.mode&1){var x=RP(i);if(x!==null){!(x.flags&65536)&&(x.flags|=256),DP(x,i,o,s,t),Xj(Qm(u,o));break e}}s=u=Qm(u,o),ua!==4&&(ua=2),gv===null?gv=[s]:gv.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=MB(s,u,t);CP(s,y);break e;case 1:o=u;var v=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(dc===null||!dc.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var N=FB(s,o,t);CP(s,N);break e}}s=s.return}while(s!==null)}tU(r)}catch(S){t=S,Gn===r&&r!==null&&(Gn=r=r.return);continue}break}while(!0)}function ZB(){var e=kN.current;return kN.current=_N,e===null?_N:e}function gA(){(ua===0||ua===3||ua===2)&&(ua=4),Sa===null||!(oh&268435455)&&!(qS&268435455)||zu(Sa,Ra)}function EN(e,t){var r=Nr;Nr|=2;var n=ZB();(Sa!==e||Ra!==t)&&($l=null,Kd(e,t));do try{jse();break}catch(a){JB(e,a)}while(!0);if(Jj(),Nr=r,kN.current=n,Gn!==null)throw Error(Be(261));return Sa=null,Ra=0,ua}function jse(){for(;Gn!==null;)eU(Gn)}function Ase(){for(;Gn!==null&&!rae();)eU(Gn)}function eU(e){var t=nU(e.alternate,e,si);e.memoizedProps=e.pendingProps,t===null?tU(e):Gn=t,dA.current=null}function tU(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=_se(r,t),r!==null){r.flags&=32767,Gn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ua=6,Gn=null;return}}else if(r=Sse(r,t,si),r!==null){Gn=r;return}if(t=t.sibling,t!==null){Gn=t;return}Gn=t=e}while(t!==null);ua===0&&(ua=5)}function bd(e,t,r){var n=Lr,a=Bi.transition;try{Bi.transition=null,Lr=1,$se(e,t,r,n)}finally{Bi.transition=a,Lr=n}return null}function $se(e,t,r,n){do vm();while(ec!==null);if(Nr&6)throw Error(Be(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Be(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(hae(e,s),e===Sa&&(Gn=Sa=null,Ra=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Hw||(Hw=!0,aU(uN,function(){return vm(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Bi.transition,Bi.transition=null;var i=Lr;Lr=1;var o=Nr;Nr|=4,dA.current=null,Cse(e,r),QB(r,e),Jae(LI),dN=!!PI,LI=PI=null,e.current=r,Ise(r),nae(),Nr=o,Lr=i,Bi.transition=s}else e.current=r;if(Hw&&(Hw=!1,ec=e,IN=a),s=e.pendingLanes,s===0&&(dc=null),iae(r.stateNode),Hs(e,On()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(CN)throw CN=!1,e=sE,sE=null,e;return IN&1&&e.tag!==0&&vm(),s=e.pendingLanes,s&1?e===iE?xv++:(xv=0,iE=e):xv=0,Wc(),null}function vm(){if(ec!==null){var e=M5(IN),t=Bi.transition,r=Lr;try{if(Bi.transition=null,Lr=16>e?16:e,ec===null)var n=!1;else{if(e=ec,ec=null,IN=0,Nr&6)throw Error(Be(331));var a=Nr;for(Nr|=4,pt=e.current;pt!==null;){var s=pt,i=s.child;if(pt.flags&16){var o=s.deletions;if(o!==null){for(var u=0;u<o.length;u++){var d=o[u];for(pt=d;pt!==null;){var c=pt;switch(c.tag){case 0:case 11:case 15:mv(8,c,s)}var h=c.child;if(h!==null)h.return=c,pt=h;else for(;pt!==null;){c=pt;var p=c.sibling,f=c.return;if(qB(c),c===d){pt=null;break}if(p!==null){p.return=f,pt=p;break}pt=f}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}pt=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,pt=i;else e:for(;pt!==null;){if(s=pt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:mv(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,pt=y;break e}pt=s.return}}var v=e.current;for(pt=v;pt!==null;){i=pt;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,pt=b;else e:for(i=v;pt!==null;){if(o=pt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:HS(9,o)}}catch(S){An(o,o.return,S)}if(o===i){pt=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,pt=N;break e}pt=o.return}}if(Nr=a,Wc(),nl&&typeof nl.onPostCommitFiberRoot=="function")try{nl.onPostCommitFiberRoot(OS,e)}catch{}n=!0}return n}finally{Lr=r,Bi.transition=t}}return!1}function GP(e,t,r){t=Qm(r,t),t=MB(e,t,1),e=cc(e,t,1),t=ms(),e!==null&&(Tb(e,1,t),Hs(e,t))}function An(e,t,r){if(e.tag===3)GP(e,e,r);else for(;t!==null;){if(t.tag===3){GP(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(dc===null||!dc.has(n))){e=Qm(r,e),e=FB(t,e,1),t=cc(t,e,1),e=ms(),t!==null&&(Tb(t,1,e),Hs(t,e));break}}t=t.return}}function Rse(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ms(),e.pingedLanes|=e.suspendedLanes&r,Sa===e&&(Ra&r)===r&&(ua===4||ua===3&&(Ra&130023424)===Ra&&500>On()-pA?Kd(e,0):hA|=r),Hs(e,t)}function rU(e,t){t===0&&(e.mode&1?(t=Mw,Mw<<=1,!(Mw&130023424)&&(Mw=4194304)):t=1);var r=ms();e=Zl(e,t),e!==null&&(Tb(e,t,r),Hs(e,r))}function Dse(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),rU(e,r)}function Mse(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Be(314))}n!==null&&n.delete(t),rU(e,r)}var nU;nU=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ws.current)zs=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return zs=!1,Nse(e,t,r);zs=!!(e.flags&131072)}else zs=!1,fn&&t.flags&1048576&&oB(t,yN,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;A1(e,t),e=t.pendingProps;var a=Hm(t,Xa.current);ym(t,r),a=iA(null,t,n,e,a,r);var s=oA();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vs(n)?(s=!0,gN(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,tA(t),a.updater=VS,t.stateNode=a,a._reactInternals=t,KI(t,n,e,r),t=YI(null,t,n,!0,s,r)):(t.tag=0,fn&&s&&Kj(t),ls(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(A1(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Ose(n),e=io(n,e),a){case 0:t=XI(null,t,n,e,r);break e;case 1:t=OP(null,t,n,e,r);break e;case 11:t=MP(null,t,n,e,r);break e;case 14:t=FP(null,t,n,io(n.type,e),r);break e}throw Error(Be(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:io(n,a),XI(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:io(n,a),OP(e,t,n,a,r);case 3:e:{if(zB(t),e===null)throw Error(Be(387));n=t.pendingProps,s=t.memoizedState,a=s.element,pB(e,t),wN(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Qm(Error(Be(423)),t),t=PP(e,t,n,r,a);break e}else if(n!==a){a=Qm(Error(Be(424)),t),t=PP(e,t,n,r,a);break e}else for(oi=uc(t.stateNode.containerInfo.firstChild),hi=t,fn=!0,ho=null,r=dB(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(qm(),n===a){t=eu(e,t,r);break e}ls(e,t,n,r)}t=t.child}return t;case 5:return fB(t),e===null&&HI(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,zI(n,a)?i=null:s!==null&&zI(n,s)&&(t.flags|=32),LB(e,t),ls(e,t,i,r),t.child;case 6:return e===null&&HI(t),null;case 13:return BB(e,t,r);case 4:return rA(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Gm(t,null,n,r):ls(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:io(n,a),MP(e,t,n,a,r);case 7:return ls(e,t,t.pendingProps,r),t.child;case 8:return ls(e,t,t.pendingProps.children,r),t.child;case 12:return ls(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,tn(vN,n._currentValue),n._currentValue=i,s!==null)if(No(s.value,i)){if(s.children===a.children&&!Ws.current){t=eu(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(s.tag===1){u=Hl(-1,r&-r),u.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var c=d.pending;c===null?u.next=u:(u.next=c.next,c.next=u),d.pending=u}}s.lanes|=r,u=s.alternate,u!==null&&(u.lanes|=r),qI(s.return,r,t),o.lanes|=r;break}u=u.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(Be(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),qI(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}ls(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ym(t,r),a=Vi(a),n=n(a),t.flags|=1,ls(e,t,n,r),t.child;case 14:return n=t.type,a=io(n,t.pendingProps),a=io(n.type,a),FP(e,t,n,a,r);case 15:return OB(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:io(n,a),A1(e,t),t.tag=1,Vs(n)?(e=!0,gN(t)):e=!1,ym(t,r),DB(t,n,a),KI(t,n,a,r),YI(null,t,n,!0,e,r);case 19:return UB(e,t,r);case 22:return PB(e,t,r)}throw Error(Be(156,t.tag))};function aU(e,t){return A5(e,t)}function Fse(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oi(e,t,r,n){return new Fse(e,t,r,n)}function xA(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ose(e){if(typeof e=="function")return xA(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Fj)return 11;if(e===Oj)return 14}return 2}function pc(e,t){var r=e.alternate;return r===null?(r=Oi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function D1(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")xA(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Zf:return Qd(r.children,a,s,t);case Mj:i=8,a|=8;break;case yI:return e=Oi(12,r,t,a|2),e.elementType=yI,e.lanes=s,e;case vI:return e=Oi(13,r,t,a),e.elementType=vI,e.lanes=s,e;case bI:return e=Oi(19,r,t,a),e.elementType=bI,e.lanes=s,e;case f5:return GS(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case h5:i=10;break e;case p5:i=9;break e;case Fj:i=11;break e;case Oj:i=14;break e;case Ru:i=16,n=null;break e}throw Error(Be(130,e==null?e:typeof e,""))}return t=Oi(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Qd(e,t,r,n){return e=Oi(7,e,n,t),e.lanes=r,e}function GS(e,t,r,n){return e=Oi(22,e,n,t),e.elementType=f5,e.lanes=r,e.stateNode={isHidden:!1},e}function h2(e,t,r){return e=Oi(6,e,null,t),e.lanes=r,e}function p2(e,t,r){return t=Oi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Pse(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=GC(0),this.expirationTimes=GC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=GC(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function yA(e,t,r,n,a,s,i,o,u){return e=new Pse(e,t,r,o,u),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Oi(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},tA(s),e}function Lse(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jf,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function sU(e){if(!e)return wc;e=e._reactInternals;e:{if(Uh(e)!==e||e.tag!==1)throw Error(Be(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Be(171))}if(e.tag===1){var r=e.type;if(Vs(r))return sB(e,r,t)}return t}function iU(e,t,r,n,a,s,i,o,u){return e=yA(r,n,!0,e,a,s,i,o,u),e.context=sU(null),r=e.current,n=ms(),a=hc(r),s=Hl(n,a),s.callback=t??null,cc(r,s,a),e.current.lanes=a,Tb(e,a,n),Hs(e,n),e}function KS(e,t,r,n){var a=t.current,s=ms(),i=hc(a);return r=sU(r),t.context===null?t.context=r:t.pendingContext=r,t=Hl(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=cc(a,t,i),e!==null&&(go(e,a,i,s),E1(e,a,i)),i}function TN(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function KP(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function vA(e,t){KP(e,t),(e=e.alternate)&&KP(e,t)}function zse(){return null}var oU=typeof reportError=="function"?reportError:function(e){console.error(e)};function bA(e){this._internalRoot=e}QS.prototype.render=bA.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Be(409));KS(e,t,null,null)};QS.prototype.unmount=bA.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;lh(function(){KS(null,e,null,null)}),t[Jl]=null}};function QS(e){this._internalRoot=e}QS.prototype.unstable_scheduleHydration=function(e){if(e){var t=P5();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Lu.length&&t!==0&&t<Lu[r].priority;r++);Lu.splice(r,0,e),r===0&&z5(e)}};function wA(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function XS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function QP(){}function Bse(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var d=TN(i);s.call(d)}}var i=iU(t,n,e,0,null,!1,!1,"",QP);return e._reactRootContainer=i,e[Jl]=i.current,Mv(e.nodeType===8?e.parentNode:e),lh(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var d=TN(u);o.call(d)}}var u=yA(e,0,!1,null,null,!1,!1,"",QP);return e._reactRootContainer=u,e[Jl]=u.current,Mv(e.nodeType===8?e.parentNode:e),lh(function(){KS(t,u,r,n)}),u}function YS(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var u=TN(i);o.call(u)}}KS(t,i,e,a)}else i=Bse(r,t,e,a,n);return TN(i)}F5=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Hy(t.pendingLanes);r!==0&&(zj(t,r|1),Hs(t,On()),!(Nr&6)&&(Xm=On()+500,Wc()))}break;case 13:lh(function(){var n=Zl(e,1);if(n!==null){var a=ms();go(n,e,1,a)}}),vA(e,1)}};Bj=function(e){if(e.tag===13){var t=Zl(e,134217728);if(t!==null){var r=ms();go(t,e,134217728,r)}vA(e,134217728)}};O5=function(e){if(e.tag===13){var t=hc(e),r=Zl(e,t);if(r!==null){var n=ms();go(r,e,t,n)}vA(e,t)}};P5=function(){return Lr};L5=function(e,t){var r=Lr;try{return Lr=e,t()}finally{Lr=r}};jI=function(e,t,r){switch(t){case"input":if(SI(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=BS(n);if(!a)throw Error(Be(90));g5(n),SI(n,a)}}}break;case"textarea":y5(e,r);break;case"select":t=r.value,t!=null&&fm(e,!!r.multiple,t,!1)}};k5=fA;C5=lh;var Use={usingClientEntryPoint:!1,Events:[Ab,nm,BS,S5,_5,fA]},Iy={findFiberByHostInstance:$d,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Wse={bundleType:Iy.bundleType,version:Iy.version,rendererPackageName:Iy.rendererPackageName,rendererConfig:Iy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ou.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=T5(e),e===null?null:e.stateNode},findFiberByHostInstance:Iy.findFiberByHostInstance||zse,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qw.isDisabled&&qw.supportsFiber)try{OS=qw.inject(Wse),nl=qw}catch{}}_i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Use;_i.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wA(t))throw Error(Be(200));return Lse(e,t,null,r)};_i.createRoot=function(e,t){if(!wA(e))throw Error(Be(299));var r=!1,n="",a=oU;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=yA(e,1,!1,null,null,r,!1,n,a),e[Jl]=t.current,Mv(e.nodeType===8?e.parentNode:e),new bA(t)};_i.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Be(188)):(e=Object.keys(e).join(","),Error(Be(268,e)));return e=T5(t),e=e===null?null:e.stateNode,e};_i.flushSync=function(e){return lh(e)};_i.hydrate=function(e,t,r){if(!XS(t))throw Error(Be(200));return YS(null,e,t,!0,r)};_i.hydrateRoot=function(e,t,r){if(!wA(e))throw Error(Be(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=oU;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=iU(t,null,e,1,r??null,a,!1,s,i),e[Jl]=t.current,Mv(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new QS(t)};_i.render=function(e,t,r){if(!XS(t))throw Error(Be(200));return YS(null,e,t,!1,r)};_i.unmountComponentAtNode=function(e){if(!XS(e))throw Error(Be(40));return e._reactRootContainer?(lh(function(){YS(null,null,e,!1,function(){e._reactRootContainer=null,e[Jl]=null})}),!0):!1};_i.unstable_batchedUpdates=fA;_i.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!XS(r))throw Error(Be(200));if(e==null||e._reactInternals===void 0)throw Error(Be(38));return YS(e,t,r,!1,n)};_i.version="18.3.1-next-f1338f8080-20240426";function lU(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lU)}catch(e){console.error(e)}}lU(),l5.exports=_i;var Wh=l5.exports;const uU=Cj(Wh);var cU,XP=Wh;cU=XP.createRoot,XP.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vv(){return Vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vv.apply(this,arguments)}var tc;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(tc||(tc={}));const YP="popstate";function Vse(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return uE("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:jN(a)}return qse(t,r,null,e)}function _n(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function dU(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Hse(){return Math.random().toString(36).substr(2,8)}function JP(e,t){return{usr:e.state,key:e.key,idx:t}}function uE(e,t,r,n){return r===void 0&&(r=null),Vv({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ig(t):t,{state:r,key:t&&t.key||n||Hse()})}function jN(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ig(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function qse(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o=tc.Pop,u=null,d=c();d==null&&(d=0,i.replaceState(Vv({},i.state,{idx:d}),""));function c(){return(i.state||{idx:null}).idx}function h(){o=tc.Pop;let x=c(),y=x==null?null:x-d;d=x,u&&u({action:o,location:m.location,delta:y})}function p(x,y){o=tc.Push;let v=uE(m.location,x,y);d=c()+1;let b=JP(v,d),N=m.createHref(v);try{i.pushState(b,"",N)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(N)}s&&u&&u({action:o,location:m.location,delta:1})}function f(x,y){o=tc.Replace;let v=uE(m.location,x,y);d=c();let b=JP(v,d),N=m.createHref(v);i.replaceState(b,"",N),s&&u&&u({action:o,location:m.location,delta:0})}function g(x){let y=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof x=="string"?x:jN(x);return v=v.replace(/ $/,"%20"),_n(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let m={get action(){return o},get location(){return e(a,i)},listen(x){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(YP,h),u=x,()=>{a.removeEventListener(YP,h),u=null}},createHref(x){return t(a,x)},createURL:g,encodeLocation(x){let y=g(x);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:p,replace:f,go(x){return i.go(x)}};return m}var ZP;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ZP||(ZP={}));function Gse(e,t,r){return r===void 0&&(r="/"),Kse(e,t,r)}function Kse(e,t,r,n){let a=typeof t=="string"?Ig(t):t,s=Ym(a.pathname||"/",r);if(s==null)return null;let i=hU(e);Qse(i);let o=null;for(let u=0;o==null&&u<i.length;++u){let d=iie(s);o=aie(i[u],d)}return o}function hU(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,o)=>{let u={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};u.relativePath.startsWith("/")&&(_n(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let d=fc([n,u.relativePath]),c=r.concat(u);s.children&&s.children.length>0&&(_n(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),hU(s.children,t,c,d)),!(s.path==null&&!s.index)&&t.push({path:d,score:rie(d,s.index),routesMeta:c})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let u of pU(s.path))a(s,i,u)}),t}function pU(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=pU(n.join("/")),o=[];return o.push(...i.map(u=>u===""?s:[s,u].join("/"))),a&&o.push(...i),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function Qse(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:nie(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Xse=/^:[\w-]+$/,Yse=3,Jse=2,Zse=1,eie=10,tie=-2,eL=e=>e==="*";function rie(e,t){let r=e.split("/"),n=r.length;return r.some(eL)&&(n+=tie),t&&(n+=Jse),r.filter(a=>!eL(a)).reduce((a,s)=>a+(Xse.test(s)?Yse:s===""?Zse:eie),n)}function nie(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function aie(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let u=n[o],d=o===n.length-1,c=s==="/"?t:t.slice(s.length)||"/",h=cE({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},c),p=u.route;if(!h)return null;Object.assign(a,h.params),i.push({params:a,pathname:fc([s,h.pathname]),pathnameBase:cie(fc([s,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(s=fc([s,h.pathnameBase]))}return i}function cE(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=sie(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((d,c,h)=>{let{paramName:p,isOptional:f}=c;if(p==="*"){let m=o[h]||"";i=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[h];return f&&!g?d[p]=void 0:d[p]=(g||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:i,pattern:e}}function sie(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),dU(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function iie(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return dU(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Ym(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function oie(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Ig(e):e;return{pathname:r?r.startsWith("/")?r:lie(r,t):t,search:die(n),hash:hie(a)}}function lie(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function f2(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uie(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function NA(e,t){let r=uie(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function SA(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Ig(e):(a=Vv({},e),_n(!a.pathname||!a.pathname.includes("?"),f2("?","pathname","search",a)),_n(!a.pathname||!a.pathname.includes("#"),f2("#","pathname","hash",a)),_n(!a.search||!a.search.includes("#"),f2("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let h=t.length-1;if(!n&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),h-=1;a.pathname=p.join("/")}o=h>=0?t[h]:"/"}let u=oie(a,o),d=i&&i!=="/"&&i.endsWith("/"),c=(s||i===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||c)&&(u.pathname+="/"),u}const fc=e=>e.join("/").replace(/\/\/+/g,"/"),cie=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),die=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,hie=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function pie(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const fU=["post","put","patch","delete"];new Set(fU);const fie=["get",...fU];new Set(fie);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hv(){return Hv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hv.apply(this,arguments)}const JS=w.createContext(null),mU=w.createContext(null),lu=w.createContext(null),ZS=w.createContext(null),gl=w.createContext({outlet:null,matches:[],isDataRoute:!1}),gU=w.createContext(null);function mie(e,t){let{relative:r}=t===void 0?{}:t;Eg()||_n(!1);let{basename:n,navigator:a}=w.useContext(lu),{hash:s,pathname:i,search:o}=e_(e,{relative:r}),u=i;return n!=="/"&&(u=i==="/"?n:fc([n,i])),a.createHref({pathname:u,search:o,hash:s})}function Eg(){return w.useContext(ZS)!=null}function _s(){return Eg()||_n(!1),w.useContext(ZS).location}function xU(e){w.useContext(lu).static||w.useLayoutEffect(e)}function Rn(){let{isDataRoute:e}=w.useContext(gl);return e?jie():gie()}function gie(){Eg()||_n(!1);let e=w.useContext(JS),{basename:t,future:r,navigator:n}=w.useContext(lu),{matches:a}=w.useContext(gl),{pathname:s}=_s(),i=JSON.stringify(NA(a,r.v7_relativeSplatPath)),o=w.useRef(!1);return xU(()=>{o.current=!0}),w.useCallback(function(d,c){if(c===void 0&&(c={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let h=SA(d,JSON.parse(i),s,c.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:fc([t,h.pathname])),(c.replace?n.replace:n.push)(h,c.state,c)},[t,n,i,s,e])}const xie=w.createContext(null);function yie(e){let t=w.useContext(gl).outlet;return t&&w.createElement(xie.Provider,{value:e},t)}function Rb(){let{matches:e}=w.useContext(gl),t=e[e.length-1];return t?t.params:{}}function e_(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=w.useContext(lu),{matches:a}=w.useContext(gl),{pathname:s}=_s(),i=JSON.stringify(NA(a,n.v7_relativeSplatPath));return w.useMemo(()=>SA(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function vie(e,t){return bie(e,t)}function bie(e,t,r,n){Eg()||_n(!1);let{navigator:a}=w.useContext(lu),{matches:s}=w.useContext(gl),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let u=i?i.pathnameBase:"/";i&&i.route;let d=_s(),c;if(t){var h;let x=typeof t=="string"?Ig(t):t;u==="/"||(h=x.pathname)!=null&&h.startsWith(u)||_n(!1),c=x}else c=d;let p=c.pathname||"/",f=p;if(u!=="/"){let x=u.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=Gse(e,{pathname:f}),m=kie(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:fc([u,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:fc([u,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,r,n);return t&&m?w.createElement(ZS.Provider,{value:{location:Hv({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:tc.Pop}},m):m}function wie(){let e=Tie(),t=pie(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:a},r):null,null)}const Nie=w.createElement(wie,null);class Sie extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(gl.Provider,{value:this.props.routeContext},w.createElement(gU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _ie(e){let{routeContext:t,match:r,children:n}=e,a=w.useContext(JS);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(gl.Provider,{value:t},n)}function kie(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let c=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);c>=0||_n(!1),i=i.slice(0,Math.min(i.length,c+1))}let u=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<i.length;c++){let h=i[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=c),h.route.id){let{loaderData:p,errors:f}=r,g=h.route.loader&&p[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||g){u=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((c,h,p)=>{let f,g=!1,m=null,x=null;r&&(f=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||Nie,u&&(d<0&&p===0?(Aie("route-fallback"),g=!0,x=null):d===p&&(g=!0,x=h.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,p+1)),v=()=>{let b;return f?b=m:g?b=x:h.route.Component?b=w.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=c,w.createElement(_ie,{match:h,routeContext:{outlet:c,matches:y,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?w.createElement(Sie,{location:r.location,revalidation:r.revalidation,component:m,error:f,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}var yU=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(yU||{}),vU=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(vU||{});function Cie(e){let t=w.useContext(JS);return t||_n(!1),t}function Iie(e){let t=w.useContext(mU);return t||_n(!1),t}function Eie(e){let t=w.useContext(gl);return t||_n(!1),t}function bU(e){let t=Eie(),r=t.matches[t.matches.length-1];return r.route.id||_n(!1),r.route.id}function Tie(){var e;let t=w.useContext(gU),r=Iie(),n=bU();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function jie(){let{router:e}=Cie(yU.UseNavigateStable),t=bU(vU.UseNavigateStable),r=w.useRef(!1);return xU(()=>{r.current=!0}),w.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Hv({fromRouteId:t},s)))},[e,t])}const tL={};function Aie(e,t,r){tL[e]||(tL[e]=!0)}function $ie(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Jo(e){let{to:t,replace:r,state:n,relative:a}=e;Eg()||_n(!1);let{future:s,static:i}=w.useContext(lu),{matches:o}=w.useContext(gl),{pathname:u}=_s(),d=Rn(),c=SA(t,NA(o,s.v7_relativeSplatPath),u,a==="path"),h=JSON.stringify(c);return w.useEffect(()=>d(JSON.parse(h),{replace:r,state:n,relative:a}),[d,h,a,r,n]),null}function dE(e){return yie(e.context)}function Mt(e){_n(!1)}function Rie(e){let{basename:t="/",children:r=null,location:n,navigationType:a=tc.Pop,navigator:s,static:i=!1,future:o}=e;Eg()&&_n(!1);let u=t.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:u,navigator:s,static:i,future:Hv({v7_relativeSplatPath:!1},o)}),[u,o,s,i]);typeof n=="string"&&(n=Ig(n));let{pathname:c="/",search:h="",hash:p="",state:f=null,key:g="default"}=n,m=w.useMemo(()=>{let x=Ym(c,u);return x==null?null:{location:{pathname:x,search:h,hash:p,state:f,key:g},navigationType:a}},[u,c,h,p,f,g,a]);return m==null?null:w.createElement(lu.Provider,{value:d},w.createElement(ZS.Provider,{children:r,value:m}))}function wU(e){let{children:t,location:r}=e;return vie(hE(t),r)}new Promise(()=>{});function hE(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,a)=>{if(!w.isValidElement(n))return;let s=[...t,a];if(n.type===w.Fragment){r.push.apply(r,hE(n.props.children,s));return}n.type!==Mt&&_n(!1),!n.props.index||!n.props.children||_n(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=hE(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function AN(){return AN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AN.apply(this,arguments)}function NU(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Die(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Mie(e,t){return e.button===0&&(!t||t==="_self")&&!Die(e)}const Fie=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Oie=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Pie="6";try{window.__reactRouterVersion=Pie}catch{}const Lie=w.createContext({isTransitioning:!1}),zie="startTransition",rL=Aj[zie];function Bie(e){let{basename:t,children:r,future:n,window:a}=e,s=w.useRef();s.current==null&&(s.current=Vse({window:a,v5Compat:!0}));let i=s.current,[o,u]=w.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},c=w.useCallback(h=>{d&&rL?rL(()=>u(h)):u(h)},[u,d]);return w.useLayoutEffect(()=>i.listen(c),[i,c]),w.useEffect(()=>$ie(n),[n]),w.createElement(Rie,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const Uie=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Wie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,SU=w.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:i,state:o,target:u,to:d,preventScrollReset:c,viewTransition:h}=t,p=NU(t,Fie),{basename:f}=w.useContext(lu),g,m=!1;if(typeof d=="string"&&Wie.test(d)&&(g=d,Uie))try{let b=new URL(window.location.href),N=d.startsWith("//")?new URL(b.protocol+d):new URL(d),S=Ym(N.pathname,f);N.origin===b.origin&&S!=null?d=S+N.search+N.hash:m=!0}catch{}let x=mie(d,{relative:a}),y=Hie(d,{replace:i,state:o,target:u,preventScrollReset:c,relative:a,viewTransition:h});function v(b){n&&n(b),b.defaultPrevented||y(b)}return w.createElement("a",AN({},p,{href:g||x,onClick:m||s?n:v,ref:r,target:u}))}),_U=w.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:s="",end:i=!1,style:o,to:u,viewTransition:d,children:c}=t,h=NU(t,Oie),p=e_(u,{relative:h.relative}),f=_s(),g=w.useContext(mU),{navigator:m,basename:x}=w.useContext(lu),y=g!=null&&qie(p)&&d===!0,v=m.encodeLocation?m.encodeLocation(p).pathname:p.pathname,b=f.pathname,N=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;a||(b=b.toLowerCase(),N=N?N.toLowerCase():null,v=v.toLowerCase()),N&&x&&(N=Ym(N,x)||N);const S=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let _=b===v||!i&&b.startsWith(v)&&b.charAt(S)==="/",C=N!=null&&(N===v||!i&&N.startsWith(v)&&N.charAt(v.length)==="/"),k={isActive:_,isPending:C,isTransitioning:y},I=_?n:void 0,T;typeof s=="function"?T=s(k):T=[s,_?"active":null,C?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let j=typeof o=="function"?o(k):o;return w.createElement(SU,AN({},h,{"aria-current":I,className:T,ref:r,style:j,to:u,viewTransition:d}),typeof c=="function"?c(k):c)});var pE;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(pE||(pE={}));var nL;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(nL||(nL={}));function Vie(e){let t=w.useContext(JS);return t||_n(!1),t}function Hie(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:i,viewTransition:o}=t===void 0?{}:t,u=Rn(),d=_s(),c=e_(e,{relative:i});return w.useCallback(h=>{if(Mie(h,r)){h.preventDefault();let p=n!==void 0?n:jN(d)===jN(c);u(e,{replace:p,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[d,u,c,n,a,r,e,s,i,o])}function qie(e,t){t===void 0&&(t={});let r=w.useContext(Lie);r==null&&_n(!1);let{basename:n}=Vie(pE.useViewTransitionState),a=e_(e,{relative:t.relative});if(!r.isTransitioning)return!1;let s=Ym(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Ym(r.nextLocation.pathname,n)||r.nextLocation.pathname;return cE(a.pathname,i)!=null||cE(a.pathname,s)!=null}const Gie=1,Kie=1e6;let m2=0;function Qie(){return m2=(m2+1)%Number.MAX_SAFE_INTEGER,m2.toString()}const g2=new Map,aL=e=>{if(g2.has(e))return;const t=setTimeout(()=>{g2.delete(e),yv({type:"REMOVE_TOAST",toastId:e})},Kie);g2.set(e,t)},Xie=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,Gie)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?aL(r):e.toasts.forEach(n=>{aL(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},M1=[];let F1={toasts:[]};function yv(e){F1=Xie(F1,e),M1.forEach(t=>{t(F1)})}function ds({...e}){const t=Qie(),r=a=>yv({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>yv({type:"DISMISS_TOAST",toastId:t});return yv({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function Wt(){const[e,t]=w.useState(F1);return w.useEffect(()=>(M1.push(t),()=>{const r=M1.indexOf(t);r>-1&&M1.splice(r,1)}),[e]),{...e,toast:ds,dismiss:r=>yv({type:"DISMISS_TOAST",toastId:r})}}function ze(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function sL(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function tu(...e){return t=>{let r=!1;const n=e.map(a=>{const s=sL(a,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let a=0;a<n.length;a++){const s=n[a];typeof s=="function"?s():sL(e[a],null)}}}}function Bt(...e){return w.useCallback(tu(...e),e)}function Yie(e,t){const r=w.createContext(t),n=s=>{const{children:i,...o}=s,u=w.useMemo(()=>o,Object.values(o));return l.jsx(r.Provider,{value:u,children:i})};n.displayName=e+"Provider";function a(s){const i=w.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,a]}function Ia(e,t=[]){let r=[];function n(s,i){const o=w.createContext(i),u=r.length;r=[...r,i];const d=h=>{var y;const{scope:p,children:f,...g}=h,m=((y=p==null?void 0:p[e])==null?void 0:y[u])||o,x=w.useMemo(()=>g,Object.values(g));return l.jsx(m.Provider,{value:x,children:f})};d.displayName=s+"Provider";function c(h,p){var m;const f=((m=p==null?void 0:p[e])==null?void 0:m[u])||o,g=w.useContext(f);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${s}\``)}return[d,c]}const a=()=>{const s=r.map(i=>w.createContext(i));return function(o){const u=(o==null?void 0:o[e])||s;return w.useMemo(()=>({[`__scope${e}`]:{...o,[e]:u}}),[o,u])}};return a.scopeName=e,[n,Jie(a,...t)]}function Jie(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const i=n.reduce((o,{useScope:u,scopeName:d})=>{const h=u(s)[`__scope${d}`];return{...o,...h}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}function Nc(e){const t=eoe(e),r=w.forwardRef((n,a)=>{const{children:s,...i}=n,o=w.Children.toArray(s),u=o.find(toe);if(u){const d=u.props.children,c=o.map(h=>h===u?w.Children.count(d)>1?w.Children.only(null):w.isValidElement(d)?d.props.children:null:h);return l.jsx(t,{...i,ref:a,children:w.isValidElement(d)?w.cloneElement(d,void 0,c):null})}return l.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}var Zie=Nc("Slot");function eoe(e){const t=w.forwardRef((r,n)=>{const{children:a,...s}=r;if(w.isValidElement(a)){const i=noe(a),o=roe(s,a.props);return a.type!==w.Fragment&&(o.ref=n?tu(n,i):i),w.cloneElement(a,o)}return w.Children.count(a)>1?w.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var kU=Symbol("radix.slottable");function CU(e){const t=({children:r})=>l.jsx(l.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=kU,t}function toe(e){return w.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===kU}function roe(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const u=s(...o);return a(...o),u}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function noe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function t_(e){const t=e+"CollectionProvider",[r,n]=Ia(t),[a,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:x,children:y}=m,v=qe.useRef(null),b=qe.useRef(new Map).current;return l.jsx(a,{scope:x,itemMap:b,collectionRef:v,children:y})};i.displayName=t;const o=e+"CollectionSlot",u=Nc(o),d=qe.forwardRef((m,x)=>{const{scope:y,children:v}=m,b=s(o,y),N=Bt(x,b.collectionRef);return l.jsx(u,{ref:N,children:v})});d.displayName=o;const c=e+"CollectionItemSlot",h="data-radix-collection-item",p=Nc(c),f=qe.forwardRef((m,x)=>{const{scope:y,children:v,...b}=m,N=qe.useRef(null),S=Bt(x,N),_=s(c,y);return qe.useEffect(()=>(_.itemMap.set(N,{ref:N,...b}),()=>void _.itemMap.delete(N))),l.jsx(p,{[h]:"",ref:S,children:v})});f.displayName=c;function g(m){const x=s(e+"CollectionConsumer",m);return qe.useCallback(()=>{const v=x.collectionRef.current;if(!v)return[];const b=Array.from(v.querySelectorAll(`[${h}]`));return Array.from(x.itemMap.values()).sort((_,C)=>b.indexOf(_.ref.current)-b.indexOf(C.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:i,Slot:d,ItemSlot:f},g,n]}var aoe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],at=aoe.reduce((e,t)=>{const r=Nc(`Primitive.${t}`),n=w.forwardRef((a,s)=>{const{asChild:i,...o}=a,u=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(u,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function _A(e,t){e&&Wh.flushSync(()=>e.dispatchEvent(t))}function $n(e){const t=w.useRef(e);return w.useEffect(()=>{t.current=e}),w.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function soe(e,t=globalThis==null?void 0:globalThis.document){const r=$n(e);w.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var ioe="DismissableLayer",fE="dismissableLayer.update",ooe="dismissableLayer.pointerDownOutside",loe="dismissableLayer.focusOutside",iL,IU=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Vh=w.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:i,onDismiss:o,...u}=e,d=w.useContext(IU),[c,h]=w.useState(null),p=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=w.useState({}),g=Bt(t,C=>h(C)),m=Array.from(d.layers),[x]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(x),v=c?m.indexOf(c):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,N=v>=y,S=coe(C=>{const k=C.target,I=[...d.branches].some(T=>T.contains(k));!N||I||(a==null||a(C),i==null||i(C),C.defaultPrevented||o==null||o())},p),_=doe(C=>{const k=C.target;[...d.branches].some(T=>T.contains(k))||(s==null||s(C),i==null||i(C),C.defaultPrevented||o==null||o())},p);return soe(C=>{v===d.layers.size-1&&(n==null||n(C),!C.defaultPrevented&&o&&(C.preventDefault(),o()))},p),w.useEffect(()=>{if(c)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(iL=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(c)),d.layers.add(c),oL(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=iL)}},[c,p,r,d]),w.useEffect(()=>()=>{c&&(d.layers.delete(c),d.layersWithOutsidePointerEventsDisabled.delete(c),oL())},[c,d]),w.useEffect(()=>{const C=()=>f({});return document.addEventListener(fE,C),()=>document.removeEventListener(fE,C)},[]),l.jsx(at.div,{...u,ref:g,style:{pointerEvents:b?N?"auto":"none":void 0,...e.style},onFocusCapture:ze(e.onFocusCapture,_.onFocusCapture),onBlurCapture:ze(e.onBlurCapture,_.onBlurCapture),onPointerDownCapture:ze(e.onPointerDownCapture,S.onPointerDownCapture)})});Vh.displayName=ioe;var uoe="DismissableLayerBranch",EU=w.forwardRef((e,t)=>{const r=w.useContext(IU),n=w.useRef(null),a=Bt(t,n);return w.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),l.jsx(at.div,{...e,ref:a})});EU.displayName=uoe;function coe(e,t=globalThis==null?void 0:globalThis.document){const r=$n(e),n=w.useRef(!1),a=w.useRef(()=>{});return w.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let u=function(){TU(ooe,r,d,{discrete:!0})};const d={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=u,t.addEventListener("click",a.current,{once:!0})):u()}else t.removeEventListener("click",a.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function doe(e,t=globalThis==null?void 0:globalThis.document){const r=$n(e),n=w.useRef(!1);return w.useEffect(()=>{const a=s=>{s.target&&!n.current&&TU(loe,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function oL(){const e=new CustomEvent(fE);document.dispatchEvent(e)}function TU(e,t,r,{discrete:n}){const a=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?_A(a,s):a.dispatchEvent(s)}var hoe=Vh,poe=EU,Un=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},foe="Portal",Tg=w.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[a,s]=w.useState(!1);Un(()=>s(!0),[]);const i=r||a&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return i?uU.createPortal(l.jsx(at.div,{...n,ref:t}),i):null});Tg.displayName=foe;function moe(e,t){return w.useReducer((r,n)=>t[r][n]??r,e)}var fa=e=>{const{present:t,children:r}=e,n=goe(t),a=typeof r=="function"?r({present:n.isPresent}):w.Children.only(r),s=Bt(n.ref,xoe(a));return typeof r=="function"||n.isPresent?w.cloneElement(a,{ref:s}):null};fa.displayName="Presence";function goe(e){const[t,r]=w.useState(),n=w.useRef(null),a=w.useRef(e),s=w.useRef("none"),i=e?"mounted":"unmounted",[o,u]=moe(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const d=Gw(n.current);s.current=o==="mounted"?d:"none"},[o]),Un(()=>{const d=n.current,c=a.current;if(c!==e){const p=s.current,f=Gw(d);e?u("MOUNT"):f==="none"||(d==null?void 0:d.display)==="none"?u("UNMOUNT"):u(c&&p!==f?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,u]),Un(()=>{if(t){let d;const c=t.ownerDocument.defaultView??window,h=f=>{const m=Gw(n.current).includes(f.animationName);if(f.target===t&&m&&(u("ANIMATION_END"),!a.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",d=c.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},p=f=>{f.target===t&&(s.current=Gw(n.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{c.clearTimeout(d),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:w.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function Gw(e){return(e==null?void 0:e.animationName)||"none"}function xoe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var yoe=Aj[" useInsertionEffect ".trim().toString()]||Un;function So({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,s,i]=voe({defaultProp:t,onChange:r}),o=e!==void 0,u=o?e:a;{const c=w.useRef(e!==void 0);w.useEffect(()=>{const h=c.current;h!==o&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),c.current=o},[o,n])}const d=w.useCallback(c=>{var h;if(o){const p=boe(c)?c(e):c;p!==e&&((h=i.current)==null||h.call(i,p))}else s(c)},[o,e,s,i]);return[u,d]}function voe({defaultProp:e,onChange:t}){const[r,n]=w.useState(e),a=w.useRef(r),s=w.useRef(t);return yoe(()=>{s.current=t},[t]),w.useEffect(()=>{var i;a.current!==r&&((i=s.current)==null||i.call(s,r),a.current=r)},[r,a]),[r,n,s]}function boe(e){return typeof e=="function"}var jU=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),woe="VisuallyHidden",r_=w.forwardRef((e,t)=>l.jsx(at.span,{...e,ref:t,style:{...jU,...e.style}}));r_.displayName=woe;var Noe=r_,kA="ToastProvider",[CA,Soe,_oe]=t_("Toast"),[AU,oot]=Ia("Toast",[_oe]),[koe,n_]=AU(kA),$U=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:s=50,children:i}=e,[o,u]=w.useState(null),[d,c]=w.useState(0),h=w.useRef(!1),p=w.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${kA}\`. Expected non-empty \`string\`.`),l.jsx(CA.Provider,{scope:t,children:l.jsx(koe,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:s,toastCount:d,viewport:o,onViewportChange:u,onToastAdd:w.useCallback(()=>c(f=>f+1),[]),onToastRemove:w.useCallback(()=>c(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:p,children:i})})};$U.displayName=kA;var RU="ToastViewport",Coe=["F8"],mE="toast.viewportPause",gE="toast.viewportResume",DU=w.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=Coe,label:a="Notifications ({hotkey})",...s}=e,i=n_(RU,r),o=Soe(r),u=w.useRef(null),d=w.useRef(null),c=w.useRef(null),h=w.useRef(null),p=Bt(t,h,i.onViewportChange),f=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=i.toastCount>0;w.useEffect(()=>{const x=y=>{var b;n.length!==0&&n.every(N=>y[N]||y.code===N)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[n]),w.useEffect(()=>{const x=u.current,y=h.current;if(g&&x&&y){const v=()=>{if(!i.isClosePausedRef.current){const _=new CustomEvent(mE);y.dispatchEvent(_),i.isClosePausedRef.current=!0}},b=()=>{if(i.isClosePausedRef.current){const _=new CustomEvent(gE);y.dispatchEvent(_),i.isClosePausedRef.current=!1}},N=_=>{!x.contains(_.relatedTarget)&&b()},S=()=>{x.contains(document.activeElement)||b()};return x.addEventListener("focusin",v),x.addEventListener("focusout",N),x.addEventListener("pointermove",v),x.addEventListener("pointerleave",S),window.addEventListener("blur",v),window.addEventListener("focus",b),()=>{x.removeEventListener("focusin",v),x.removeEventListener("focusout",N),x.removeEventListener("pointermove",v),x.removeEventListener("pointerleave",S),window.removeEventListener("blur",v),window.removeEventListener("focus",b)}}},[g,i.isClosePausedRef]);const m=w.useCallback(({tabbingDirection:x})=>{const v=o().map(b=>{const N=b.ref.current,S=[N,...Loe(N)];return x==="forwards"?S:S.reverse()});return(x==="forwards"?v.reverse():v).flat()},[o]);return w.useEffect(()=>{const x=h.current;if(x){const y=v=>{var S,_,C;const b=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!b){const k=document.activeElement,I=v.shiftKey;if(v.target===x&&I){(S=d.current)==null||S.focus();return}const E=m({tabbingDirection:I?"backwards":"forwards"}),O=E.findIndex(M=>M===k);x2(E.slice(O+1))?v.preventDefault():I?(_=d.current)==null||_.focus():(C=c.current)==null||C.focus()}};return x.addEventListener("keydown",y),()=>x.removeEventListener("keydown",y)}},[o,m]),l.jsxs(poe,{ref:u,role:"region","aria-label":a.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&l.jsx(xE,{ref:d,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"forwards"});x2(x)}}),l.jsx(CA.Slot,{scope:r,children:l.jsx(at.ol,{tabIndex:-1,...s,ref:p})}),g&&l.jsx(xE,{ref:c,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"backwards"});x2(x)}})]})});DU.displayName=RU;var MU="ToastFocusProxy",xE=w.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,s=n_(MU,r);return l.jsx(r_,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:i=>{var d;const o=i.relatedTarget;!((d=s.viewport)!=null&&d.contains(o))&&n()}})});xE.displayName=MU;var Db="Toast",Ioe="toast.swipeStart",Eoe="toast.swipeMove",Toe="toast.swipeCancel",joe="toast.swipeEnd",FU=w.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:s,...i}=e,[o,u]=So({prop:n,defaultProp:a??!0,onChange:s,caller:Db});return l.jsx(fa,{present:r||o,children:l.jsx(Roe,{open:o,...i,ref:t,onClose:()=>u(!1),onPause:$n(e.onPause),onResume:$n(e.onResume),onSwipeStart:ze(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ze(e.onSwipeMove,d=>{const{x:c,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:ze(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ze(e.onSwipeEnd,d=>{const{x:c,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),u(!1)})})})});FU.displayName=Db;var[Aoe,$oe]=AU(Db,{onClose(){}}),Roe=w.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:s,onClose:i,onEscapeKeyDown:o,onPause:u,onResume:d,onSwipeStart:c,onSwipeMove:h,onSwipeCancel:p,onSwipeEnd:f,...g}=e,m=n_(Db,r),[x,y]=w.useState(null),v=Bt(t,M=>y(M)),b=w.useRef(null),N=w.useRef(null),S=a||m.duration,_=w.useRef(0),C=w.useRef(S),k=w.useRef(0),{onToastAdd:I,onToastRemove:T}=m,j=$n(()=>{var W;(x==null?void 0:x.contains(document.activeElement))&&((W=m.viewport)==null||W.focus()),i()}),E=w.useCallback(M=>{!M||M===1/0||(window.clearTimeout(k.current),_.current=new Date().getTime(),k.current=window.setTimeout(j,M))},[j]);w.useEffect(()=>{const M=m.viewport;if(M){const W=()=>{E(C.current),d==null||d()},q=()=>{const P=new Date().getTime()-_.current;C.current=C.current-P,window.clearTimeout(k.current),u==null||u()};return M.addEventListener(mE,q),M.addEventListener(gE,W),()=>{M.removeEventListener(mE,q),M.removeEventListener(gE,W)}}},[m.viewport,S,u,d,E]),w.useEffect(()=>{s&&!m.isClosePausedRef.current&&E(S)},[s,S,m.isClosePausedRef,E]),w.useEffect(()=>(I(),()=>T()),[I,T]);const O=w.useMemo(()=>x?WU(x):null,[x]);return m.viewport?l.jsxs(l.Fragment,{children:[O&&l.jsx(Doe,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:O}),l.jsx(Aoe,{scope:r,onClose:j,children:Wh.createPortal(l.jsx(CA.ItemSlot,{scope:r,children:l.jsx(hoe,{asChild:!0,onEscapeKeyDown:ze(o,()=>{m.isFocusedToastEscapeKeyDownRef.current||j(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:l.jsx(at.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection,...g,ref:v,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ze(e.onKeyDown,M=>{M.key==="Escape"&&(o==null||o(M.nativeEvent),M.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,j()))}),onPointerDown:ze(e.onPointerDown,M=>{M.button===0&&(b.current={x:M.clientX,y:M.clientY})}),onPointerMove:ze(e.onPointerMove,M=>{if(!b.current)return;const W=M.clientX-b.current.x,q=M.clientY-b.current.y,P=!!N.current,A=["left","right"].includes(m.swipeDirection),L=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,z=A?L(0,W):0,$=A?0:L(0,q),V=M.pointerType==="touch"?10:2,B={x:z,y:$},Y={originalEvent:M,delta:B};P?(N.current=B,Kw(Eoe,h,Y,{discrete:!1})):lL(B,m.swipeDirection,V)?(N.current=B,Kw(Ioe,c,Y,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(W)>V||Math.abs(q)>V)&&(b.current=null)}),onPointerUp:ze(e.onPointerUp,M=>{const W=N.current,q=M.target;if(q.hasPointerCapture(M.pointerId)&&q.releasePointerCapture(M.pointerId),N.current=null,b.current=null,W){const P=M.currentTarget,A={originalEvent:M,delta:W};lL(W,m.swipeDirection,m.swipeThreshold)?Kw(joe,f,A,{discrete:!0}):Kw(Toe,p,A,{discrete:!0}),P.addEventListener("click",L=>L.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),Doe=e=>{const{__scopeToast:t,children:r,...n}=e,a=n_(Db,t),[s,i]=w.useState(!1),[o,u]=w.useState(!1);return Ooe(()=>i(!0)),w.useEffect(()=>{const d=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(d)},[]),o?null:l.jsx(Tg,{asChild:!0,children:l.jsx(r_,{...n,children:s&&l.jsxs(l.Fragment,{children:[a.label," ",r]})})})},Moe="ToastTitle",OU=w.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(at.div,{...n,ref:t})});OU.displayName=Moe;var Foe="ToastDescription",PU=w.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(at.div,{...n,ref:t})});PU.displayName=Foe;var LU="ToastAction",zU=w.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?l.jsx(UU,{altText:r,asChild:!0,children:l.jsx(IA,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${LU}\`. Expected non-empty \`string\`.`),null)});zU.displayName=LU;var BU="ToastClose",IA=w.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=$oe(BU,r);return l.jsx(UU,{asChild:!0,children:l.jsx(at.button,{type:"button",...n,ref:t,onClick:ze(e.onClick,a.onClose)})})});IA.displayName=BU;var UU=w.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return l.jsx(at.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function WU(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Poe(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!a)if(s){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...WU(n))}}),t}function Kw(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?_A(a,s):a.dispatchEvent(s)}var lL=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),s=n>a;return t==="left"||t==="right"?s&&n>r:!s&&a>r};function Ooe(e=()=>{}){const t=$n(e);Un(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Poe(e){return e.nodeType===e.ELEMENT_NODE}function Loe(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function x2(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var zoe=$U,VU=DU,HU=FU,qU=OU,GU=PU,KU=zU,QU=IA;function XU(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=XU(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function YU(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=XU(e))&&(n&&(n+=" "),n+=t);return n}const uL=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,cL=YU,Mb=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return cL(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:s}=t,i=Object.keys(a).map(d=>{const c=r==null?void 0:r[d],h=s==null?void 0:s[d];if(c===null)return null;const p=uL(c)||uL(h);return a[d][p]}),o=r&&Object.entries(r).reduce((d,c)=>{let[h,p]=c;return p===void 0||(d[h]=p),d},{}),u=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,c)=>{let{class:h,className:p,...f}=c;return Object.entries(f).every(g=>{let[m,x]=g;return Array.isArray(x)?x.includes({...s,...o}[m]):{...s,...o}[m]===x})?[...d,h,p]:d},[]);return cL(e,i,u,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Boe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Uoe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),dL=e=>{const t=Uoe(e);return t.charAt(0).toUpperCase()+t.slice(1)},JU=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Woe=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Voe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hoe=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...o},u)=>w.createElement("svg",{ref:u,...Voe,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:JU("lucide",a),...!s&&!Woe(o)&&{"aria-hidden":"true"},...o},[...i.map(([d,c])=>w.createElement(d,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=(e,t)=>{const r=w.forwardRef(({className:n,...a},s)=>w.createElement(Hoe,{ref:s,iconNode:t,className:JU(`lucide-${Boe(dL(e))}`,`lucide-${e}`,n),...a}));return r.displayName=dL(e),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qoe=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Goe=dt("align-center",qoe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Koe=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Qoe=dt("align-left",Koe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xoe=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Yoe=dt("align-right",Xoe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Joe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],EA=dt("arrow-left",Joe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zoe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ele=dt("arrow-right",Zoe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tle=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],rle=dt("award",tle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nle=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],ale=dt("bold",nle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sle=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ZU=dt("book-open",sle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ile=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],$a=dt("calendar",ile);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ole=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Fb=dt("check",ole);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lle=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],TA=dt("chevron-down",lle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ule=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],cle=dt("chevron-left",ule);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dle=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],eW=dt("chevron-right",dle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hle=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ple=dt("chevron-up",hle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fle=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],tW=dt("chevrons-up-down",fle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],pn=dt("circle-alert",mle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gle=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Xd=dt("circle-check-big",gle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],$N=dt("circle-check",xle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Md=dt("circle-x",yle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],jA=dt("circle",vle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ble=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],yE=dt("clipboard-check",ble);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wle=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ya=dt("clock",wle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nle=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Sle=dt("copy",Nle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _le=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],vE=dt("database",_le);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kle=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Fi=dt("download",kle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cle=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],rW=dt("ellipsis-vertical",Cle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ile=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Ele=dt("ellipsis",Ile);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tle=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],hL=dt("external-link",Tle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jle=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jg=dt("eye",jle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ale=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xo=dt("file-text",Ale);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $le=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ob=dt("funnel",$le);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rle=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],nW=dt("graduation-cap",Rle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dle=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],aW=dt("handshake",Dle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mle=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Fle=dt("history",Mle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ole=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Ple=dt("italic",Ole);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lle=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],zle=dt("landmark",Lle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ble=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Ule=dt("layout-dashboard",Ble);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wle=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Vle=dt("link",Wle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hle=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],qle=dt("list-checks",Hle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gle=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],Kle=dt("list-ordered",Gle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qle=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Xle=dt("list",Qle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yle=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ya=dt("loader-circle",Yle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jle=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Zle=dt("loader",Jle);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eue=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],sW=dt("log-out",eue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tue=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],uh=dt("mail",tue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rue=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],iW=dt("map-pin",rue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nue=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],aue=dt("menu",nue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sue=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],bE=dt("message-square",sue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iue=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ru=dt("pencil",iue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oue=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],wE=dt("phone",oue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lue=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wn=dt("plus",lue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uue=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],AA=dt("refresh-cw",uue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ag=dt("save",cue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const due=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ja=dt("search",due);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hue=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],NE=dt("settings",hue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pue=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],O1=dt("shield",pue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fue=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],xl=dt("square-pen",fue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],gue=dt("target",mue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xue=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ka=dt("trash-2",xue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yue=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],oW=dt("trending-up",yue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vue=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],bue=dt("underline",vue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wue=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Nue=dt("undo-2",wue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sue=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],$g=dt("upload",Sue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ue=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],P1=dt("user-check",_ue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kue=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],pL=dt("user-plus",kue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],yo=dt("user",Cue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iue=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ch=dt("users",Iue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eue=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],vv=dt("video",Eue);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tue=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],wa=dt("x",Tue),$A="-",jue=e=>{const t=$ue(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const o=i.split($A);return o[0]===""&&o.length!==1&&o.shift(),lW(o,t)||Aue(i)},getConflictingClassGroupIds:(i,o)=>{const u=r[i]||[];return o&&n[i]?[...u,...n[i]]:u}}},lW=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?lW(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const s=e.join($A);return(i=t.validators.find(({validator:o})=>o(s)))==null?void 0:i.classGroupId},fL=/^\[(.+)\]$/,Aue=e=>{if(fL.test(e)){const t=fL.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},$ue=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Due(Object.entries(e.classGroups),r).forEach(([s,i])=>{SE(i,n,s,t)}),n},SE=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const s=a===""?t:mL(t,a);s.classGroupId=r;return}if(typeof a=="function"){if(Rue(a)){SE(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([s,i])=>{SE(i,mL(t,s),r,n)})})},mL=(e,t)=>{let r=e;return t.split($A).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Rue=e=>e.isThemeGetter,Due=(e,t)=>t?e.map(([r,n])=>{const a=n.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,o])=>[t+i,o])):s);return[r,a]}):e,Mue=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(s,i)=>{r.set(s,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let i=r.get(s);if(i!==void 0)return i;if((i=n.get(s))!==void 0)return a(s,i),i},set(s,i){r.has(s)?r.set(s,i):a(s,i)}}},uW="!",Fue=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],s=t.length,i=o=>{const u=[];let d=0,c=0,h;for(let x=0;x<o.length;x++){let y=o[x];if(d===0){if(y===a&&(n||o.slice(x,x+s)===t)){u.push(o.slice(c,x)),c=x+s;continue}if(y==="/"){h=x;continue}}y==="["?d++:y==="]"&&d--}const p=u.length===0?o:o.substring(c),f=p.startsWith(uW),g=f?p.substring(1):p,m=h&&h>c?h-c:void 0;return{modifiers:u,hasImportantModifier:f,baseClassName:g,maybePostfixModifierPosition:m}};return r?o=>r({className:o,parseClassName:i}):i},Oue=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Pue=e=>({cache:Mue(e.cacheSize),parseClassName:Fue(e),...jue(e)}),Lue=/\s+/,zue=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,s=[],i=e.trim().split(Lue);let o="";for(let u=i.length-1;u>=0;u-=1){const d=i[u],{modifiers:c,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:f}=r(d);let g=!!f,m=n(g?p.substring(0,f):p);if(!m){if(!g){o=d+(o.length>0?" "+o:o);continue}if(m=n(p),!m){o=d+(o.length>0?" "+o:o);continue}g=!1}const x=Oue(c).join(":"),y=h?x+uW:x,v=y+m;if(s.includes(v))continue;s.push(v);const b=a(m,g);for(let N=0;N<b.length;++N){const S=b[N];s.push(y+S)}o=d+(o.length>0?" "+o:o)}return o};function Bue(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=cW(t))&&(n&&(n+=" "),n+=r);return n}const cW=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=cW(e[n]))&&(r&&(r+=" "),r+=t);return r};function Uue(e,...t){let r,n,a,s=i;function i(u){const d=t.reduce((c,h)=>h(c),e());return r=Pue(d),n=r.cache.get,a=r.cache.set,s=o,o(u)}function o(u){const d=n(u);if(d)return d;const c=zue(u,r);return a(u,c),c}return function(){return s(Bue.apply(null,arguments))}}const sn=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},dW=/^\[(?:([a-z-]+):)?(.+)\]$/i,Wue=/^\d+\/\d+$/,Vue=new Set(["px","full","screen"]),Hue=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,que=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Gue=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Kue=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Que=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Il=e=>bm(e)||Vue.has(e)||Wue.test(e),wu=e=>Rg(e,"length",nce),bm=e=>!!e&&!Number.isNaN(Number(e)),y2=e=>Rg(e,"number",bm),Ey=e=>!!e&&Number.isInteger(Number(e)),Xue=e=>e.endsWith("%")&&bm(e.slice(0,-1)),er=e=>dW.test(e),Nu=e=>Hue.test(e),Yue=new Set(["length","size","percentage"]),Jue=e=>Rg(e,Yue,hW),Zue=e=>Rg(e,"position",hW),ece=new Set(["image","url"]),tce=e=>Rg(e,ece,sce),rce=e=>Rg(e,"",ace),Ty=()=>!0,Rg=(e,t,r)=>{const n=dW.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},nce=e=>que.test(e)&&!Gue.test(e),hW=()=>!1,ace=e=>Kue.test(e),sce=e=>Que.test(e),ice=()=>{const e=sn("colors"),t=sn("spacing"),r=sn("blur"),n=sn("brightness"),a=sn("borderColor"),s=sn("borderRadius"),i=sn("borderSpacing"),o=sn("borderWidth"),u=sn("contrast"),d=sn("grayscale"),c=sn("hueRotate"),h=sn("invert"),p=sn("gap"),f=sn("gradientColorStops"),g=sn("gradientColorStopPositions"),m=sn("inset"),x=sn("margin"),y=sn("opacity"),v=sn("padding"),b=sn("saturate"),N=sn("scale"),S=sn("sepia"),_=sn("skew"),C=sn("space"),k=sn("translate"),I=()=>["auto","contain","none"],T=()=>["auto","hidden","clip","visible","scroll"],j=()=>["auto",er,t],E=()=>[er,t],O=()=>["",Il,wu],M=()=>["auto",bm,er],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],q=()=>["solid","dashed","dotted","double","none"],P=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],L=()=>["","0",er],z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],$=()=>[bm,er];return{cacheSize:500,separator:":",theme:{colors:[Ty],spacing:[Il,wu],blur:["none","",Nu,er],brightness:$(),borderColor:[e],borderRadius:["none","","full",Nu,er],borderSpacing:E(),borderWidth:O(),contrast:$(),grayscale:L(),hueRotate:$(),invert:L(),gap:E(),gradientColorStops:[e],gradientColorStopPositions:[Xue,wu],inset:j(),margin:j(),opacity:$(),padding:E(),saturate:$(),scale:$(),sepia:L(),skew:$(),space:E(),translate:E()},classGroups:{aspect:[{aspect:["auto","square","video",er]}],container:["container"],columns:[{columns:[Nu]}],"break-after":[{"break-after":z()}],"break-before":[{"break-before":z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),er]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ey,er]}],basis:[{basis:j()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",er]}],grow:[{grow:L()}],shrink:[{shrink:L()}],order:[{order:["first","last","none",Ey,er]}],"grid-cols":[{"grid-cols":[Ty]}],"col-start-end":[{col:["auto",{span:["full",Ey,er]},er]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[Ty]}],"row-start-end":[{row:["auto",{span:[Ey,er]},er]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",er]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",er]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",er,t]}],"min-w":[{"min-w":[er,t,"min","max","fit"]}],"max-w":[{"max-w":[er,t,"none","full","min","max","fit","prose",{screen:[Nu]},Nu]}],h:[{h:[er,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[er,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[er,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[er,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Nu,wu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",y2]}],"font-family":[{font:[Ty]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",er]}],"line-clamp":[{"line-clamp":["none",bm,y2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Il,er]}],"list-image":[{"list-image":["none",er]}],"list-style-type":[{list:["none","disc","decimal",er]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Il,wu]}],"underline-offset":[{"underline-offset":["auto",Il,er]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:E()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",er]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",er]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),Zue]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Jue]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},tce]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...q(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:q()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...q()]}],"outline-offset":[{"outline-offset":[Il,er]}],"outline-w":[{outline:[Il,wu]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Il,wu]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Nu,rce]}],"shadow-color":[{shadow:[Ty]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...P(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":P()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Nu,er]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",er]}],duration:[{duration:$()}],ease:[{ease:["linear","in","out","in-out",er]}],delay:[{delay:$()}],animate:[{animate:["none","spin","ping","pulse","bounce",er]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Ey,er]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",er]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",er]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":E()}],"scroll-mx":[{"scroll-mx":E()}],"scroll-my":[{"scroll-my":E()}],"scroll-ms":[{"scroll-ms":E()}],"scroll-me":[{"scroll-me":E()}],"scroll-mt":[{"scroll-mt":E()}],"scroll-mr":[{"scroll-mr":E()}],"scroll-mb":[{"scroll-mb":E()}],"scroll-ml":[{"scroll-ml":E()}],"scroll-p":[{"scroll-p":E()}],"scroll-px":[{"scroll-px":E()}],"scroll-py":[{"scroll-py":E()}],"scroll-ps":[{"scroll-ps":E()}],"scroll-pe":[{"scroll-pe":E()}],"scroll-pt":[{"scroll-pt":E()}],"scroll-pr":[{"scroll-pr":E()}],"scroll-pb":[{"scroll-pb":E()}],"scroll-pl":[{"scroll-pl":E()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",er]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Il,wu,y2]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},oce=Uue(ice);function Ue(...e){return oce(YU(e))}const lce=zoe,pW=w.forwardRef(({className:e,...t},r)=>l.jsx(VU,{ref:r,className:Ue("fixed bottom-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:right-0 sm:flex-col md:max-w-[420px]",e),...t}));pW.displayName=VU.displayName;const uce=Mb("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),fW=w.forwardRef(({className:e,variant:t,...r},n)=>l.jsx(HU,{ref:n,className:Ue(uce({variant:t}),e),...r}));fW.displayName=HU.displayName;const cce=w.forwardRef(({className:e,...t},r)=>l.jsx(KU,{ref:r,className:Ue("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));cce.displayName=KU.displayName;const mW=w.forwardRef(({className:e,...t},r)=>l.jsx(QU,{ref:r,className:Ue("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:l.jsx(wa,{className:"h-4 w-4"})}));mW.displayName=QU.displayName;const gW=w.forwardRef(({className:e,...t},r)=>l.jsx(qU,{ref:r,className:Ue("text-sm font-semibold",e),...t}));gW.displayName=qU.displayName;const xW=w.forwardRef(({className:e,...t},r)=>l.jsx(GU,{ref:r,className:Ue("text-sm opacity-90",e),...t}));xW.displayName=GU.displayName;function dce(){const{toasts:e}=Wt();return l.jsxs(lce,{children:[e.map(function({id:t,title:r,description:n,action:a,...s}){return l.jsxs(fW,{...s,children:[l.jsxs("div",{className:"grid gap-1",children:[r&&l.jsx(gW,{children:r}),n&&l.jsx(xW,{children:n})]}),a,l.jsx(mW,{})]},t)}),l.jsx(pW,{})]})}var gL=["light","dark"],hce="(prefers-color-scheme: dark)",pce=w.createContext(void 0),fce={setTheme:e=>{},themes:[]},mce=()=>{var e;return(e=w.useContext(pce))!=null?e:fce};w.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:s,value:i,attrs:o,nonce:u})=>{let d=s==="system",c=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,h=a?gL.includes(s)&&s?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${s}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",p=(g,m=!1,x=!0)=>{let y=i?i[g]:g,v=m?g+"|| ''":`'${y}'`,b="";return a&&x&&!m&&gL.includes(g)&&(b+=`d.style.colorScheme = '${g}';`),r==="class"?m||y?b+=`c.add(${v})`:b+="null":y&&(b+=`d[s](n,${v})`),b},f=e?`!function(){${c}${p(e)}}()`:n?`!function(){try{${c}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${hce}',m=window.matchMedia(t);if(m.media!==t||m.matches){${p("dark")}}else{${p("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}${d?"":"else{"+p(s,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${c}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}else{${p(s,!1,!1)};}${h}}catch(t){}}();`;return w.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:f}})});var gce=e=>{switch(e){case"success":return vce;case"info":return wce;case"warning":return bce;case"error":return Nce;default:return null}},xce=Array(12).fill(0),yce=({visible:e,className:t})=>qe.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},qe.createElement("div",{className:"sonner-spinner"},xce.map((r,n)=>qe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),vce=qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},qe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),bce=qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},qe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),wce=qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},qe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Nce=qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},qe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Sce=qe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},qe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),qe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),_ce=()=>{let[e,t]=qe.useState(document.hidden);return qe.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},_E=1,kce=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;let{message:n,...a}=t,s=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:_E++,i=this.toasts.find(u=>u.id===s),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),i?this.toasts=this.toasts.map(u=>u.id===s?(this.publish({...u,...t,id:s,title:n}),{...u,...t,id:s,dismissible:o,title:n}):u):this.addToast({title:n,...a,dismissible:o,id:s}),s},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:t,dismiss:!0})),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let a=t instanceof Promise?t:t(),s=n!==void 0,i,o=a.then(async d=>{if(i=["resolve",d],qe.isValidElement(d))s=!1,this.create({id:n,type:"default",message:d});else if(Ice(d)&&!d.ok){s=!1;let c=typeof r.error=="function"?await r.error(`HTTP error! status: ${d.status}`):r.error,h=typeof r.description=="function"?await r.description(`HTTP error! status: ${d.status}`):r.description;this.create({id:n,type:"error",message:c,description:h})}else if(r.success!==void 0){s=!1;let c=typeof r.success=="function"?await r.success(d):r.success,h=typeof r.description=="function"?await r.description(d):r.description;this.create({id:n,type:"success",message:c,description:h})}}).catch(async d=>{if(i=["reject",d],r.error!==void 0){s=!1;let c=typeof r.error=="function"?await r.error(d):r.error,h=typeof r.description=="function"?await r.description(d):r.description;this.create({id:n,type:"error",message:c,description:h})}}).finally(()=>{var d;s&&(this.dismiss(n),n=void 0),(d=r.finally)==null||d.call(r)}),u=()=>new Promise((d,c)=>o.then(()=>i[0]==="reject"?c(i[1]):d(i[1])).catch(c));return typeof n!="string"&&typeof n!="number"?{unwrap:u}:Object.assign(n,{unwrap:u})},this.custom=(t,r)=>{let n=(r==null?void 0:r.id)||_E++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Ms=new kce,Cce=(e,t)=>{let r=(t==null?void 0:t.id)||_E++;return Ms.addToast({title:e,...t,id:r}),r},Ice=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Ece=Cce,Tce=()=>Ms.toasts,jce=()=>Ms.getActiveToasts();Object.assign(Ece,{success:Ms.success,info:Ms.info,warning:Ms.warning,error:Ms.error,custom:Ms.custom,message:Ms.message,promise:Ms.promise,dismiss:Ms.dismiss,loading:Ms.loading},{getHistory:Tce,getToasts:jce});function Ace(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}Ace(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Qw(e){return e.label!==void 0}var $ce=3,Rce="32px",Dce="16px",xL=4e3,Mce=356,Fce=14,Oce=20,Pce=200;function Zi(...e){return e.filter(Boolean).join(" ")}function Lce(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var zce=e=>{var t,r,n,a,s,i,o,u,d,c,h;let{invert:p,toast:f,unstyled:g,interacting:m,setHeights:x,visibleToasts:y,heights:v,index:b,toasts:N,expanded:S,removeToast:_,defaultRichColors:C,closeButton:k,style:I,cancelButtonStyle:T,actionButtonStyle:j,className:E="",descriptionClassName:O="",duration:M,position:W,gap:q,loadingIcon:P,expandByDefault:A,classNames:L,icons:z,closeButtonAriaLabel:$="Close toast",pauseWhenPageIsHidden:V}=e,[B,Y]=qe.useState(null),[re,ae]=qe.useState(null),[K,J]=qe.useState(!1),[Z,Q]=qe.useState(!1),[U,F]=qe.useState(!1),[te,pe]=qe.useState(!1),[ve,fe]=qe.useState(!1),[Me,je]=qe.useState(0),[Qe,ft]=qe.useState(0),Ot=qe.useRef(f.duration||M||xL),yt=qe.useRef(null),De=qe.useRef(null),Fe=b===0,et=b+1<=y,Ae=f.type,He=f.dismissible!==!1,st=f.className||"",kt=f.descriptionClassName||"",Vt=qe.useMemo(()=>v.findIndex(tt=>tt.toastId===f.id)||0,[v,f.id]),ur=qe.useMemo(()=>{var tt;return(tt=f.closeButton)!=null?tt:k},[f.closeButton,k]),we=qe.useMemo(()=>f.duration||M||xL,[f.duration,M]),wr=qe.useRef(0),nr=qe.useRef(0),Zt=qe.useRef(0),_r=qe.useRef(null),[Cs,vn]=W.split("-"),xe=qe.useMemo(()=>v.reduce((tt,me,Ce)=>Ce>=Vt?tt:tt+me.height,0),[v,Vt]),Ie=_ce(),Oe=f.invert||p,vt=Ae==="loading";nr.current=qe.useMemo(()=>Vt*q+xe,[Vt,xe]),qe.useEffect(()=>{Ot.current=we},[we]),qe.useEffect(()=>{J(!0)},[]),qe.useEffect(()=>{let tt=De.current;if(tt){let me=tt.getBoundingClientRect().height;return ft(me),x(Ce=>[{toastId:f.id,height:me,position:f.position},...Ce]),()=>x(Ce=>Ce.filter(rt=>rt.toastId!==f.id))}},[x,f.id]),qe.useLayoutEffect(()=>{if(!K)return;let tt=De.current,me=tt.style.height;tt.style.height="auto";let Ce=tt.getBoundingClientRect().height;tt.style.height=me,ft(Ce),x(rt=>rt.find(ee=>ee.toastId===f.id)?rt.map(ee=>ee.toastId===f.id?{...ee,height:Ce}:ee):[{toastId:f.id,height:Ce,position:f.position},...rt])},[K,f.title,f.description,x,f.id]);let $t=qe.useCallback(()=>{Q(!0),je(nr.current),x(tt=>tt.filter(me=>me.toastId!==f.id)),setTimeout(()=>{_(f)},Pce)},[f,_,x,nr]);qe.useEffect(()=>{if(f.promise&&Ae==="loading"||f.duration===1/0||f.type==="loading")return;let tt;return S||m||V&&Ie?(()=>{if(Zt.current<wr.current){let me=new Date().getTime()-wr.current;Ot.current=Ot.current-me}Zt.current=new Date().getTime()})():Ot.current!==1/0&&(wr.current=new Date().getTime(),tt=setTimeout(()=>{var me;(me=f.onAutoClose)==null||me.call(f,f),$t()},Ot.current)),()=>clearTimeout(tt)},[S,m,f,Ae,V,Ie,$t]),qe.useEffect(()=>{f.delete&&$t()},[$t,f.delete]);function cr(){var tt,me,Ce;return z!=null&&z.loading?qe.createElement("div",{className:Zi(L==null?void 0:L.loader,(tt=f==null?void 0:f.classNames)==null?void 0:tt.loader,"sonner-loader"),"data-visible":Ae==="loading"},z.loading):P?qe.createElement("div",{className:Zi(L==null?void 0:L.loader,(me=f==null?void 0:f.classNames)==null?void 0:me.loader,"sonner-loader"),"data-visible":Ae==="loading"},P):qe.createElement(yce,{className:Zi(L==null?void 0:L.loader,(Ce=f==null?void 0:f.classNames)==null?void 0:Ce.loader),visible:Ae==="loading"})}return qe.createElement("li",{tabIndex:0,ref:De,className:Zi(E,st,L==null?void 0:L.toast,(t=f==null?void 0:f.classNames)==null?void 0:t.toast,L==null?void 0:L.default,L==null?void 0:L[Ae],(r=f==null?void 0:f.classNames)==null?void 0:r[Ae]),"data-sonner-toast":"","data-rich-colors":(n=f.richColors)!=null?n:C,"data-styled":!(f.jsx||f.unstyled||g),"data-mounted":K,"data-promise":!!f.promise,"data-swiped":ve,"data-removed":Z,"data-visible":et,"data-y-position":Cs,"data-x-position":vn,"data-index":b,"data-front":Fe,"data-swiping":U,"data-dismissible":He,"data-type":Ae,"data-invert":Oe,"data-swipe-out":te,"data-swipe-direction":re,"data-expanded":!!(S||A&&K),style:{"--index":b,"--toasts-before":b,"--z-index":N.length-b,"--offset":`${Z?Me:nr.current}px`,"--initial-height":A?"auto":`${Qe}px`,...I,...f.style},onDragEnd:()=>{F(!1),Y(null),_r.current=null},onPointerDown:tt=>{vt||!He||(yt.current=new Date,je(nr.current),tt.target.setPointerCapture(tt.pointerId),tt.target.tagName!=="BUTTON"&&(F(!0),_r.current={x:tt.clientX,y:tt.clientY}))},onPointerUp:()=>{var tt,me,Ce,rt;if(te||!He)return;_r.current=null;let ee=Number(((tt=De.current)==null?void 0:tt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),be=Number(((me=De.current)==null?void 0:me.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),nt=new Date().getTime()-((Ce=yt.current)==null?void 0:Ce.getTime()),Te=B==="x"?ee:be,Ge=Math.abs(Te)/nt;if(Math.abs(Te)>=Oce||Ge>.11){je(nr.current),(rt=f.onDismiss)==null||rt.call(f,f),ae(B==="x"?ee>0?"right":"left":be>0?"down":"up"),$t(),pe(!0),fe(!1);return}F(!1),Y(null)},onPointerMove:tt=>{var me,Ce,rt,ee;if(!_r.current||!He||((me=window.getSelection())==null?void 0:me.toString().length)>0)return;let be=tt.clientY-_r.current.y,nt=tt.clientX-_r.current.x,Te=(Ce=e.swipeDirections)!=null?Ce:Lce(W);!B&&(Math.abs(nt)>1||Math.abs(be)>1)&&Y(Math.abs(nt)>Math.abs(be)?"x":"y");let Ge={x:0,y:0};B==="y"?(Te.includes("top")||Te.includes("bottom"))&&(Te.includes("top")&&be<0||Te.includes("bottom")&&be>0)&&(Ge.y=be):B==="x"&&(Te.includes("left")||Te.includes("right"))&&(Te.includes("left")&&nt<0||Te.includes("right")&&nt>0)&&(Ge.x=nt),(Math.abs(Ge.x)>0||Math.abs(Ge.y)>0)&&fe(!0),(rt=De.current)==null||rt.style.setProperty("--swipe-amount-x",`${Ge.x}px`),(ee=De.current)==null||ee.style.setProperty("--swipe-amount-y",`${Ge.y}px`)}},ur&&!f.jsx?qe.createElement("button",{"aria-label":$,"data-disabled":vt,"data-close-button":!0,onClick:vt||!He?()=>{}:()=>{var tt;$t(),(tt=f.onDismiss)==null||tt.call(f,f)},className:Zi(L==null?void 0:L.closeButton,(a=f==null?void 0:f.classNames)==null?void 0:a.closeButton)},(s=z==null?void 0:z.close)!=null?s:Sce):null,f.jsx||w.isValidElement(f.title)?f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title:qe.createElement(qe.Fragment,null,Ae||f.icon||f.promise?qe.createElement("div",{"data-icon":"",className:Zi(L==null?void 0:L.icon,(i=f==null?void 0:f.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||cr():null,f.type!=="loading"?f.icon||(z==null?void 0:z[Ae])||gce(Ae):null):null,qe.createElement("div",{"data-content":"",className:Zi(L==null?void 0:L.content,(o=f==null?void 0:f.classNames)==null?void 0:o.content)},qe.createElement("div",{"data-title":"",className:Zi(L==null?void 0:L.title,(u=f==null?void 0:f.classNames)==null?void 0:u.title)},typeof f.title=="function"?f.title():f.title),f.description?qe.createElement("div",{"data-description":"",className:Zi(O,kt,L==null?void 0:L.description,(d=f==null?void 0:f.classNames)==null?void 0:d.description)},typeof f.description=="function"?f.description():f.description):null),w.isValidElement(f.cancel)?f.cancel:f.cancel&&Qw(f.cancel)?qe.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||T,onClick:tt=>{var me,Ce;Qw(f.cancel)&&He&&((Ce=(me=f.cancel).onClick)==null||Ce.call(me,tt),$t())},className:Zi(L==null?void 0:L.cancelButton,(c=f==null?void 0:f.classNames)==null?void 0:c.cancelButton)},f.cancel.label):null,w.isValidElement(f.action)?f.action:f.action&&Qw(f.action)?qe.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||j,onClick:tt=>{var me,Ce;Qw(f.action)&&((Ce=(me=f.action).onClick)==null||Ce.call(me,tt),!tt.defaultPrevented&&$t())},className:Zi(L==null?void 0:L.actionButton,(h=f==null?void 0:f.classNames)==null?void 0:h.actionButton)},f.action.label):null))};function yL(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Bce(e,t){let r={};return[e,t].forEach((n,a)=>{let s=a===1,i=s?"--mobile-offset":"--offset",o=s?Dce:Rce;function u(d){["top","right","bottom","left"].forEach(c=>{r[`${i}-${c}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?u(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${i}-${d}`]=o:r[`${i}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):u(o)}),r}var Uce=w.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:i,className:o,offset:u,mobileOffset:d,theme:c="light",richColors:h,duration:p,style:f,visibleToasts:g=$ce,toastOptions:m,dir:x=yL(),gap:y=Fce,loadingIcon:v,icons:b,containerAriaLabel:N="Notifications",pauseWhenPageIsHidden:S}=e,[_,C]=qe.useState([]),k=qe.useMemo(()=>Array.from(new Set([n].concat(_.filter(V=>V.position).map(V=>V.position)))),[_,n]),[I,T]=qe.useState([]),[j,E]=qe.useState(!1),[O,M]=qe.useState(!1),[W,q]=qe.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),P=qe.useRef(null),A=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),L=qe.useRef(null),z=qe.useRef(!1),$=qe.useCallback(V=>{C(B=>{var Y;return(Y=B.find(re=>re.id===V.id))!=null&&Y.delete||Ms.dismiss(V.id),B.filter(({id:re})=>re!==V.id)})},[]);return qe.useEffect(()=>Ms.subscribe(V=>{if(V.dismiss){C(B=>B.map(Y=>Y.id===V.id?{...Y,delete:!0}:Y));return}setTimeout(()=>{uU.flushSync(()=>{C(B=>{let Y=B.findIndex(re=>re.id===V.id);return Y!==-1?[...B.slice(0,Y),{...B[Y],...V},...B.slice(Y+1)]:[V,...B]})})})}),[]),qe.useEffect(()=>{if(c!=="system"){q(c);return}if(c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?q("dark"):q("light")),typeof window>"u")return;let V=window.matchMedia("(prefers-color-scheme: dark)");try{V.addEventListener("change",({matches:B})=>{q(B?"dark":"light")})}catch{V.addListener(({matches:Y})=>{try{q(Y?"dark":"light")}catch(re){console.error(re)}})}},[c]),qe.useEffect(()=>{_.length<=1&&E(!1)},[_]),qe.useEffect(()=>{let V=B=>{var Y,re;a.every(ae=>B[ae]||B.code===ae)&&(E(!0),(Y=P.current)==null||Y.focus()),B.code==="Escape"&&(document.activeElement===P.current||(re=P.current)!=null&&re.contains(document.activeElement))&&E(!1)};return document.addEventListener("keydown",V),()=>document.removeEventListener("keydown",V)},[a]),qe.useEffect(()=>{if(P.current)return()=>{L.current&&(L.current.focus({preventScroll:!0}),L.current=null,z.current=!1)}},[P.current]),qe.createElement("section",{ref:t,"aria-label":`${N} ${A}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},k.map((V,B)=>{var Y;let[re,ae]=V.split("-");return _.length?qe.createElement("ol",{key:V,dir:x==="auto"?yL():x,tabIndex:-1,ref:P,className:o,"data-sonner-toaster":!0,"data-theme":W,"data-y-position":re,"data-lifted":j&&_.length>1&&!s,"data-x-position":ae,style:{"--front-toast-height":`${((Y=I[0])==null?void 0:Y.height)||0}px`,"--width":`${Mce}px`,"--gap":`${y}px`,...f,...Bce(u,d)},onBlur:K=>{z.current&&!K.currentTarget.contains(K.relatedTarget)&&(z.current=!1,L.current&&(L.current.focus({preventScroll:!0}),L.current=null))},onFocus:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||z.current||(z.current=!0,L.current=K.relatedTarget)},onMouseEnter:()=>E(!0),onMouseMove:()=>E(!0),onMouseLeave:()=>{O||E(!1)},onDragEnd:()=>E(!1),onPointerDown:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||M(!0)},onPointerUp:()=>M(!1)},_.filter(K=>!K.position&&B===0||K.position===V).map((K,J)=>{var Z,Q;return qe.createElement(zce,{key:K.id,icons:b,index:J,toast:K,defaultRichColors:h,duration:(Z=m==null?void 0:m.duration)!=null?Z:p,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:r,visibleToasts:g,closeButton:(Q=m==null?void 0:m.closeButton)!=null?Q:i,interacting:O,position:V,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:$,toasts:_.filter(U=>U.position==K.position),heights:I.filter(U=>U.position==K.position),setHeights:T,expandByDefault:s,gap:y,loadingIcon:v,expanded:j,pauseWhenPageIsHidden:S,swipeDirections:e.swipeDirections})})):null}))});const Wce=({...e})=>{const{theme:t="system"}=mce();return l.jsx(Uce,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Vce=Aj[" useId ".trim().toString()]||(()=>{}),Hce=0;function _a(e){const[t,r]=w.useState(Vce());return Un(()=>{r(n=>n??String(Hce++))},[e]),t?`radix-${t}`:""}const qce=["top","right","bottom","left"],Sc=Math.min,ii=Math.max,RN=Math.round,Xw=Math.floor,sl=e=>({x:e,y:e}),Gce={left:"right",right:"left",bottom:"top",top:"bottom"},Kce={start:"end",end:"start"};function kE(e,t,r){return ii(e,Sc(t,r))}function nu(e,t){return typeof e=="function"?e(t):e}function au(e){return e.split("-")[0]}function Dg(e){return e.split("-")[1]}function RA(e){return e==="x"?"y":"x"}function DA(e){return e==="y"?"height":"width"}const Qce=new Set(["top","bottom"]);function el(e){return Qce.has(au(e))?"y":"x"}function MA(e){return RA(el(e))}function Xce(e,t,r){r===void 0&&(r=!1);const n=Dg(e),a=MA(e),s=DA(a);let i=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=DN(i)),[i,DN(i)]}function Yce(e){const t=DN(e);return[CE(e),t,CE(t)]}function CE(e){return e.replace(/start|end/g,t=>Kce[t])}const vL=["left","right"],bL=["right","left"],Jce=["top","bottom"],Zce=["bottom","top"];function ede(e,t,r){switch(e){case"top":case"bottom":return r?t?bL:vL:t?vL:bL;case"left":case"right":return t?Jce:Zce;default:return[]}}function tde(e,t,r,n){const a=Dg(e);let s=ede(au(e),r==="start",n);return a&&(s=s.map(i=>i+"-"+a),t&&(s=s.concat(s.map(CE)))),s}function DN(e){return e.replace(/left|right|bottom|top/g,t=>Gce[t])}function rde(e){return{top:0,right:0,bottom:0,left:0,...e}}function yW(e){return typeof e!="number"?rde(e):{top:e,right:e,bottom:e,left:e}}function MN(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function wL(e,t,r){let{reference:n,floating:a}=e;const s=el(t),i=MA(t),o=DA(i),u=au(t),d=s==="y",c=n.x+n.width/2-a.width/2,h=n.y+n.height/2-a.height/2,p=n[o]/2-a[o]/2;let f;switch(u){case"top":f={x:c,y:n.y-a.height};break;case"bottom":f={x:c,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:h};break;case"left":f={x:n.x-a.width,y:h};break;default:f={x:n.x,y:n.y}}switch(Dg(t)){case"start":f[i]-=p*(r&&d?-1:1);break;case"end":f[i]+=p*(r&&d?-1:1);break}return f}const nde=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:s=[],platform:i}=r,o=s.filter(Boolean),u=await(i.isRTL==null?void 0:i.isRTL(t));let d=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:c,y:h}=wL(d,n,u),p=n,f={},g=0;for(let m=0;m<o.length;m++){const{name:x,fn:y}=o[m],{x:v,y:b,data:N,reset:S}=await y({x:c,y:h,initialPlacement:n,placement:p,strategy:a,middlewareData:f,rects:d,platform:i,elements:{reference:e,floating:t}});c=v??c,h=b??h,f={...f,[x]:{...f[x],...N}},S&&g<=50&&(g++,typeof S=="object"&&(S.placement&&(p=S.placement),S.rects&&(d=S.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):S.rects),{x:c,y:h}=wL(d,p,u)),m=-1)}return{x:c,y:h,placement:p,strategy:a,middlewareData:f}};async function qv(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:s,rects:i,elements:o,strategy:u}=e,{boundary:d="clippingAncestors",rootBoundary:c="viewport",elementContext:h="floating",altBoundary:p=!1,padding:f=0}=nu(t,e),g=yW(f),x=o[p?h==="floating"?"reference":"floating":h],y=MN(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(x)))==null||r?x:x.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:d,rootBoundary:c,strategy:u})),v=h==="floating"?{x:n,y:a,width:i.floating.width,height:i.floating.height}:i.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),N=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},S=MN(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:b,strategy:u}):v);return{top:(y.top-S.top+g.top)/N.y,bottom:(S.bottom-y.bottom+g.bottom)/N.y,left:(y.left-S.left+g.left)/N.x,right:(S.right-y.right+g.right)/N.x}}const ade=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:s,platform:i,elements:o,middlewareData:u}=t,{element:d,padding:c=0}=nu(e,t)||{};if(d==null)return{};const h=yW(c),p={x:r,y:n},f=MA(a),g=DA(f),m=await i.getDimensions(d),x=f==="y",y=x?"top":"left",v=x?"bottom":"right",b=x?"clientHeight":"clientWidth",N=s.reference[g]+s.reference[f]-p[f]-s.floating[g],S=p[f]-s.reference[f],_=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d));let C=_?_[b]:0;(!C||!await(i.isElement==null?void 0:i.isElement(_)))&&(C=o.floating[b]||s.floating[g]);const k=N/2-S/2,I=C/2-m[g]/2-1,T=Sc(h[y],I),j=Sc(h[v],I),E=T,O=C-m[g]-j,M=C/2-m[g]/2+k,W=kE(E,M,O),q=!u.arrow&&Dg(a)!=null&&M!==W&&s.reference[g]/2-(M<E?T:j)-m[g]/2<0,P=q?M<E?M-E:M-O:0;return{[f]:p[f]+P,data:{[f]:W,centerOffset:M-W-P,...q&&{alignmentOffset:P}},reset:q}}}),sde=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:s,rects:i,initialPlacement:o,platform:u,elements:d}=t,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:m=!0,...x}=nu(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const y=au(a),v=el(o),b=au(o)===o,N=await(u.isRTL==null?void 0:u.isRTL(d.floating)),S=p||(b||!m?[DN(o)]:Yce(o)),_=g!=="none";!p&&_&&S.push(...tde(o,m,g,N));const C=[o,...S],k=await qv(t,x),I=[];let T=((n=s.flip)==null?void 0:n.overflows)||[];if(c&&I.push(k[y]),h){const M=Xce(a,i,N);I.push(k[M[0]],k[M[1]])}if(T=[...T,{placement:a,overflows:I}],!I.every(M=>M<=0)){var j,E;const M=(((j=s.flip)==null?void 0:j.index)||0)+1,W=C[M];if(W&&(!(h==="alignment"?v!==el(W):!1)||T.every(A=>A.overflows[0]>0&&el(A.placement)===v)))return{data:{index:M,overflows:T},reset:{placement:W}};let q=(E=T.filter(P=>P.overflows[0]<=0).sort((P,A)=>P.overflows[1]-A.overflows[1])[0])==null?void 0:E.placement;if(!q)switch(f){case"bestFit":{var O;const P=(O=T.filter(A=>{if(_){const L=el(A.placement);return L===v||L==="y"}return!0}).map(A=>[A.placement,A.overflows.filter(L=>L>0).reduce((L,z)=>L+z,0)]).sort((A,L)=>A[1]-L[1])[0])==null?void 0:O[0];P&&(q=P);break}case"initialPlacement":q=o;break}if(a!==q)return{reset:{placement:q}}}return{}}}};function NL(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function SL(e){return qce.some(t=>e[t]>=0)}const ide=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=nu(e,t);switch(n){case"referenceHidden":{const s=await qv(t,{...a,elementContext:"reference"}),i=NL(s,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:SL(i)}}}case"escaped":{const s=await qv(t,{...a,altBoundary:!0}),i=NL(s,r.floating);return{data:{escapedOffsets:i,escaped:SL(i)}}}default:return{}}}}},vW=new Set(["left","top"]);async function ode(e,t){const{placement:r,platform:n,elements:a}=e,s=await(n.isRTL==null?void 0:n.isRTL(a.floating)),i=au(r),o=Dg(r),u=el(r)==="y",d=vW.has(i)?-1:1,c=s&&u?-1:1,h=nu(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&typeof g=="number"&&(f=o==="end"?g*-1:g),u?{x:f*c,y:p*d}:{x:p*d,y:f*c}}const lde=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:s,placement:i,middlewareData:o}=t,u=await ode(t,e);return i===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:a+u.x,y:s+u.y,data:{...u,placement:i}}}}},ude=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:o={fn:x=>{let{x:y,y:v}=x;return{x:y,y:v}}},...u}=nu(e,t),d={x:r,y:n},c=await qv(t,u),h=el(au(a)),p=RA(h);let f=d[p],g=d[h];if(s){const x=p==="y"?"top":"left",y=p==="y"?"bottom":"right",v=f+c[x],b=f-c[y];f=kE(v,f,b)}if(i){const x=h==="y"?"top":"left",y=h==="y"?"bottom":"right",v=g+c[x],b=g-c[y];g=kE(v,g,b)}const m=o.fn({...t,[p]:f,[h]:g});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[p]:s,[h]:i}}}}}},cde=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:s,middlewareData:i}=t,{offset:o=0,mainAxis:u=!0,crossAxis:d=!0}=nu(e,t),c={x:r,y:n},h=el(a),p=RA(h);let f=c[p],g=c[h];const m=nu(o,t),x=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(u){const b=p==="y"?"height":"width",N=s.reference[p]-s.floating[b]+x.mainAxis,S=s.reference[p]+s.reference[b]-x.mainAxis;f<N?f=N:f>S&&(f=S)}if(d){var y,v;const b=p==="y"?"width":"height",N=vW.has(au(a)),S=s.reference[h]-s.floating[b]+(N&&((y=i.offset)==null?void 0:y[h])||0)+(N?0:x.crossAxis),_=s.reference[h]+s.reference[b]+(N?0:((v=i.offset)==null?void 0:v[h])||0)-(N?x.crossAxis:0);g<S?g=S:g>_&&(g=_)}return{[p]:f,[h]:g}}}},dde=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:s,platform:i,elements:o}=t,{apply:u=()=>{},...d}=nu(e,t),c=await qv(t,d),h=au(a),p=Dg(a),f=el(a)==="y",{width:g,height:m}=s.floating;let x,y;h==="top"||h==="bottom"?(x=h,y=p===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(y=h,x=p==="end"?"top":"bottom");const v=m-c.top-c.bottom,b=g-c.left-c.right,N=Sc(m-c[x],v),S=Sc(g-c[y],b),_=!t.middlewareData.shift;let C=N,k=S;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(k=b),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(C=v),_&&!p){const T=ii(c.left,0),j=ii(c.right,0),E=ii(c.top,0),O=ii(c.bottom,0);f?k=g-2*(T!==0||j!==0?T+j:ii(c.left,c.right)):C=m-2*(E!==0||O!==0?E+O:ii(c.top,c.bottom))}await u({...t,availableWidth:k,availableHeight:C});const I=await i.getDimensions(o.floating);return g!==I.width||m!==I.height?{reset:{rects:!0}}:{}}}};function a_(){return typeof window<"u"}function Mg(e){return bW(e)?(e.nodeName||"").toLowerCase():"#document"}function pi(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function yl(e){var t;return(t=(bW(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function bW(e){return a_()?e instanceof Node||e instanceof pi(e).Node:!1}function _o(e){return a_()?e instanceof Element||e instanceof pi(e).Element:!1}function cl(e){return a_()?e instanceof HTMLElement||e instanceof pi(e).HTMLElement:!1}function _L(e){return!a_()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof pi(e).ShadowRoot}const hde=new Set(["inline","contents"]);function Pb(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=ko(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!hde.has(a)}const pde=new Set(["table","td","th"]);function fde(e){return pde.has(Mg(e))}const mde=[":popover-open",":modal"];function s_(e){return mde.some(t=>{try{return e.matches(t)}catch{return!1}})}const gde=["transform","translate","scale","rotate","perspective"],xde=["transform","translate","scale","rotate","perspective","filter"],yde=["paint","layout","strict","content"];function FA(e){const t=OA(),r=_o(e)?ko(e):e;return gde.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||xde.some(n=>(r.willChange||"").includes(n))||yde.some(n=>(r.contain||"").includes(n))}function vde(e){let t=_c(e);for(;cl(t)&&!Jm(t);){if(FA(t))return t;if(s_(t))return null;t=_c(t)}return null}function OA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const bde=new Set(["html","body","#document"]);function Jm(e){return bde.has(Mg(e))}function ko(e){return pi(e).getComputedStyle(e)}function i_(e){return _o(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function _c(e){if(Mg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||_L(e)&&e.host||yl(e);return _L(t)?t.host:t}function wW(e){const t=_c(e);return Jm(t)?e.ownerDocument?e.ownerDocument.body:e.body:cl(t)&&Pb(t)?t:wW(t)}function Gv(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=wW(e),s=a===((n=e.ownerDocument)==null?void 0:n.body),i=pi(a);if(s){const o=IE(i);return t.concat(i,i.visualViewport||[],Pb(a)?a:[],o&&r?Gv(o):[])}return t.concat(a,Gv(a,[],r))}function IE(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function NW(e){const t=ko(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=cl(e),s=a?e.offsetWidth:r,i=a?e.offsetHeight:n,o=RN(r)!==s||RN(n)!==i;return o&&(r=s,n=i),{width:r,height:n,$:o}}function PA(e){return _o(e)?e:e.contextElement}function wm(e){const t=PA(e);if(!cl(t))return sl(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:s}=NW(t);let i=(s?RN(r.width):r.width)/n,o=(s?RN(r.height):r.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const wde=sl(0);function SW(e){const t=pi(e);return!OA()||!t.visualViewport?wde:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Nde(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==pi(e)?!1:t}function dh(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),s=PA(e);let i=sl(1);t&&(n?_o(n)&&(i=wm(n)):i=wm(e));const o=Nde(s,r,n)?SW(s):sl(0);let u=(a.left+o.x)/i.x,d=(a.top+o.y)/i.y,c=a.width/i.x,h=a.height/i.y;if(s){const p=pi(s),f=n&&_o(n)?pi(n):n;let g=p,m=IE(g);for(;m&&n&&f!==g;){const x=wm(m),y=m.getBoundingClientRect(),v=ko(m),b=y.left+(m.clientLeft+parseFloat(v.paddingLeft))*x.x,N=y.top+(m.clientTop+parseFloat(v.paddingTop))*x.y;u*=x.x,d*=x.y,c*=x.x,h*=x.y,u+=b,d+=N,g=pi(m),m=IE(g)}}return MN({width:c,height:h,x:u,y:d})}function LA(e,t){const r=i_(e).scrollLeft;return t?t.left+r:dh(yl(e)).left+r}function _W(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:LA(e,n)),s=n.top+t.scrollTop;return{x:a,y:s}}function Sde(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const s=a==="fixed",i=yl(n),o=t?s_(t.floating):!1;if(n===i||o&&s)return r;let u={scrollLeft:0,scrollTop:0},d=sl(1);const c=sl(0),h=cl(n);if((h||!h&&!s)&&((Mg(n)!=="body"||Pb(i))&&(u=i_(n)),cl(n))){const f=dh(n);d=wm(n),c.x=f.x+n.clientLeft,c.y=f.y+n.clientTop}const p=i&&!h&&!s?_W(i,u,!0):sl(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-u.scrollLeft*d.x+c.x+p.x,y:r.y*d.y-u.scrollTop*d.y+c.y+p.y}}function _de(e){return Array.from(e.getClientRects())}function kde(e){const t=yl(e),r=i_(e),n=e.ownerDocument.body,a=ii(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=ii(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+LA(e);const o=-r.scrollTop;return ko(n).direction==="rtl"&&(i+=ii(t.clientWidth,n.clientWidth)-a),{width:a,height:s,x:i,y:o}}function Cde(e,t){const r=pi(e),n=yl(e),a=r.visualViewport;let s=n.clientWidth,i=n.clientHeight,o=0,u=0;if(a){s=a.width,i=a.height;const d=OA();(!d||d&&t==="fixed")&&(o=a.offsetLeft,u=a.offsetTop)}return{width:s,height:i,x:o,y:u}}const Ide=new Set(["absolute","fixed"]);function Ede(e,t){const r=dh(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,s=cl(e)?wm(e):sl(1),i=e.clientWidth*s.x,o=e.clientHeight*s.y,u=a*s.x,d=n*s.y;return{width:i,height:o,x:u,y:d}}function kL(e,t,r){let n;if(t==="viewport")n=Cde(e,r);else if(t==="document")n=kde(yl(e));else if(_o(t))n=Ede(t,r);else{const a=SW(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return MN(n)}function kW(e,t){const r=_c(e);return r===t||!_o(r)||Jm(r)?!1:ko(r).position==="fixed"||kW(r,t)}function Tde(e,t){const r=t.get(e);if(r)return r;let n=Gv(e,[],!1).filter(o=>_o(o)&&Mg(o)!=="body"),a=null;const s=ko(e).position==="fixed";let i=s?_c(e):e;for(;_o(i)&&!Jm(i);){const o=ko(i),u=FA(i);!u&&o.position==="fixed"&&(a=null),(s?!u&&!a:!u&&o.position==="static"&&!!a&&Ide.has(a.position)||Pb(i)&&!u&&kW(e,i))?n=n.filter(c=>c!==i):a=o,i=_c(i)}return t.set(e,n),n}function jde(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const i=[...r==="clippingAncestors"?s_(t)?[]:Tde(t,this._c):[].concat(r),n],o=i[0],u=i.reduce((d,c)=>{const h=kL(t,c,a);return d.top=ii(h.top,d.top),d.right=Sc(h.right,d.right),d.bottom=Sc(h.bottom,d.bottom),d.left=ii(h.left,d.left),d},kL(t,o,a));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function Ade(e){const{width:t,height:r}=NW(e);return{width:t,height:r}}function $de(e,t,r){const n=cl(t),a=yl(t),s=r==="fixed",i=dh(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const u=sl(0);function d(){u.x=LA(a)}if(n||!n&&!s)if((Mg(t)!=="body"||Pb(a))&&(o=i_(t)),n){const f=dh(t,!0,s,t);u.x=f.x+t.clientLeft,u.y=f.y+t.clientTop}else a&&d();s&&!n&&a&&d();const c=a&&!n&&!s?_W(a,o):sl(0),h=i.left+o.scrollLeft-u.x-c.x,p=i.top+o.scrollTop-u.y-c.y;return{x:h,y:p,width:i.width,height:i.height}}function v2(e){return ko(e).position==="static"}function CL(e,t){if(!cl(e)||ko(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return yl(e)===r&&(r=r.ownerDocument.body),r}function CW(e,t){const r=pi(e);if(s_(e))return r;if(!cl(e)){let a=_c(e);for(;a&&!Jm(a);){if(_o(a)&&!v2(a))return a;a=_c(a)}return r}let n=CL(e,t);for(;n&&fde(n)&&v2(n);)n=CL(n,t);return n&&Jm(n)&&v2(n)&&!FA(n)?r:n||vde(e)||r}const Rde=async function(e){const t=this.getOffsetParent||CW,r=this.getDimensions,n=await r(e.floating);return{reference:$de(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Dde(e){return ko(e).direction==="rtl"}const Mde={convertOffsetParentRelativeRectToViewportRelativeRect:Sde,getDocumentElement:yl,getClippingRect:jde,getOffsetParent:CW,getElementRects:Rde,getClientRects:_de,getDimensions:Ade,getScale:wm,isElement:_o,isRTL:Dde};function IW(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Fde(e,t){let r=null,n;const a=yl(e);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function i(o,u){o===void 0&&(o=!1),u===void 0&&(u=1),s();const d=e.getBoundingClientRect(),{left:c,top:h,width:p,height:f}=d;if(o||t(),!p||!f)return;const g=Xw(h),m=Xw(a.clientWidth-(c+p)),x=Xw(a.clientHeight-(h+f)),y=Xw(c),b={rootMargin:-g+"px "+-m+"px "+-x+"px "+-y+"px",threshold:ii(0,Sc(1,u))||1};let N=!0;function S(_){const C=_[0].intersectionRatio;if(C!==u){if(!N)return i();C?i(!1,C):n=setTimeout(()=>{i(!1,1e-7)},1e3)}C===1&&!IW(d,e.getBoundingClientRect())&&i(),N=!1}try{r=new IntersectionObserver(S,{...b,root:a.ownerDocument})}catch{r=new IntersectionObserver(S,b)}r.observe(e)}return i(!0),s}function Ode(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,d=PA(e),c=a||s?[...d?Gv(d):[],...Gv(t)]:[];c.forEach(y=>{a&&y.addEventListener("scroll",r,{passive:!0}),s&&y.addEventListener("resize",r)});const h=d&&o?Fde(d,r):null;let p=-1,f=null;i&&(f=new ResizeObserver(y=>{let[v]=y;v&&v.target===d&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(t)})),r()}),d&&!u&&f.observe(d),f.observe(t));let g,m=u?dh(e):null;u&&x();function x(){const y=dh(e);m&&!IW(m,y)&&r(),m=y,g=requestAnimationFrame(x)}return r(),()=>{var y;c.forEach(v=>{a&&v.removeEventListener("scroll",r),s&&v.removeEventListener("resize",r)}),h==null||h(),(y=f)==null||y.disconnect(),f=null,u&&cancelAnimationFrame(g)}}const Pde=lde,Lde=ude,zde=sde,Bde=dde,Ude=ide,IL=ade,Wde=cde,Vde=(e,t,r)=>{const n=new Map,a={platform:Mde,...r},s={...a.platform,_c:n};return nde(e,t,{...a,platform:s})};var Hde=typeof document<"u",qde=function(){},L1=Hde?w.useLayoutEffect:qde;function FN(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!FN(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const s=a[n];if(!(s==="_owner"&&e.$$typeof)&&!FN(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function EW(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function EL(e,t){const r=EW(e);return Math.round(t*r)/r}function b2(e){const t=w.useRef(e);return L1(()=>{t.current=e}),t}function Gde(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:s,floating:i}={},transform:o=!0,whileElementsMounted:u,open:d}=e,[c,h]=w.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[p,f]=w.useState(n);FN(p,n)||f(n);const[g,m]=w.useState(null),[x,y]=w.useState(null),v=w.useCallback(A=>{A!==_.current&&(_.current=A,m(A))},[]),b=w.useCallback(A=>{A!==C.current&&(C.current=A,y(A))},[]),N=s||g,S=i||x,_=w.useRef(null),C=w.useRef(null),k=w.useRef(c),I=u!=null,T=b2(u),j=b2(a),E=b2(d),O=w.useCallback(()=>{if(!_.current||!C.current)return;const A={placement:t,strategy:r,middleware:p};j.current&&(A.platform=j.current),Vde(_.current,C.current,A).then(L=>{const z={...L,isPositioned:E.current!==!1};M.current&&!FN(k.current,z)&&(k.current=z,Wh.flushSync(()=>{h(z)}))})},[p,t,r,j,E]);L1(()=>{d===!1&&k.current.isPositioned&&(k.current.isPositioned=!1,h(A=>({...A,isPositioned:!1})))},[d]);const M=w.useRef(!1);L1(()=>(M.current=!0,()=>{M.current=!1}),[]),L1(()=>{if(N&&(_.current=N),S&&(C.current=S),N&&S){if(T.current)return T.current(N,S,O);O()}},[N,S,O,T,I]);const W=w.useMemo(()=>({reference:_,floating:C,setReference:v,setFloating:b}),[v,b]),q=w.useMemo(()=>({reference:N,floating:S}),[N,S]),P=w.useMemo(()=>{const A={position:r,left:0,top:0};if(!q.floating)return A;const L=EL(q.floating,c.x),z=EL(q.floating,c.y);return o?{...A,transform:"translate("+L+"px, "+z+"px)",...EW(q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:L,top:z}},[r,o,q.floating,c.x,c.y]);return w.useMemo(()=>({...c,update:O,refs:W,elements:q,floatingStyles:P}),[c,O,W,q,P])}const Kde=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?IL({element:n.current,padding:a}).fn(r):{}:n?IL({element:n,padding:a}).fn(r):{}}}},Qde=(e,t)=>({...Pde(e),options:[e,t]}),Xde=(e,t)=>({...Lde(e),options:[e,t]}),Yde=(e,t)=>({...Wde(e),options:[e,t]}),Jde=(e,t)=>({...zde(e),options:[e,t]}),Zde=(e,t)=>({...Bde(e),options:[e,t]}),ehe=(e,t)=>({...Ude(e),options:[e,t]}),the=(e,t)=>({...Kde(e),options:[e,t]});var rhe="Arrow",TW=w.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...s}=e;return l.jsx(at.svg,{...s,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:l.jsx("polygon",{points:"0,0 30,0 15,10"})})});TW.displayName=rhe;var nhe=TW;function zA(e){const[t,r]=w.useState(void 0);return Un(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const s=a[0];let i,o;if("borderBoxSize"in s){const u=s.borderBoxSize,d=Array.isArray(u)?u[0]:u;i=d.inlineSize,o=d.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var BA="Popper",[jW,Vc]=Ia(BA),[ahe,AW]=jW(BA),$W=e=>{const{__scopePopper:t,children:r}=e,[n,a]=w.useState(null);return l.jsx(ahe,{scope:t,anchor:n,onAnchorChange:a,children:r})};$W.displayName=BA;var RW="PopperAnchor",DW=w.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,s=AW(RW,r),i=w.useRef(null),o=Bt(t,i);return w.useEffect(()=>{s.onAnchorChange((n==null?void 0:n.current)||i.current)}),n?null:l.jsx(at.div,{...a,ref:o})});DW.displayName=RW;var UA="PopperContent",[she,ihe]=jW(UA),MW=w.forwardRef((e,t)=>{var K,J,Z,Q,U,F;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:s="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:u=!0,collisionBoundary:d=[],collisionPadding:c=0,sticky:h="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:g,...m}=e,x=AW(UA,r),[y,v]=w.useState(null),b=Bt(t,te=>v(te)),[N,S]=w.useState(null),_=zA(N),C=(_==null?void 0:_.width)??0,k=(_==null?void 0:_.height)??0,I=n+(s!=="center"?"-"+s:""),T=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},j=Array.isArray(d)?d:[d],E=j.length>0,O={padding:T,boundary:j.filter(lhe),altBoundary:E},{refs:M,floatingStyles:W,placement:q,isPositioned:P,middlewareData:A}=Gde({strategy:"fixed",placement:I,whileElementsMounted:(...te)=>Ode(...te,{animationFrame:f==="always"}),elements:{reference:x.anchor},middleware:[Qde({mainAxis:a+k,alignmentAxis:i}),u&&Xde({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?Yde():void 0,...O}),u&&Jde({...O}),Zde({...O,apply:({elements:te,rects:pe,availableWidth:ve,availableHeight:fe})=>{const{width:Me,height:je}=pe.reference,Qe=te.floating.style;Qe.setProperty("--radix-popper-available-width",`${ve}px`),Qe.setProperty("--radix-popper-available-height",`${fe}px`),Qe.setProperty("--radix-popper-anchor-width",`${Me}px`),Qe.setProperty("--radix-popper-anchor-height",`${je}px`)}}),N&&the({element:N,padding:o}),uhe({arrowWidth:C,arrowHeight:k}),p&&ehe({strategy:"referenceHidden",...O})]}),[L,z]=PW(q),$=$n(g);Un(()=>{P&&($==null||$())},[P,$]);const V=(K=A.arrow)==null?void 0:K.x,B=(J=A.arrow)==null?void 0:J.y,Y=((Z=A.arrow)==null?void 0:Z.centerOffset)!==0,[re,ae]=w.useState();return Un(()=>{y&&ae(window.getComputedStyle(y).zIndex)},[y]),l.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:P?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(Q=A.transformOrigin)==null?void 0:Q.x,(U=A.transformOrigin)==null?void 0:U.y].join(" "),...((F=A.hide)==null?void 0:F.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:l.jsx(she,{scope:r,placedSide:L,onArrowChange:S,arrowX:V,arrowY:B,shouldHideArrow:Y,children:l.jsx(at.div,{"data-side":L,"data-align":z,...m,ref:b,style:{...m.style,animation:P?void 0:"none"}})})})});MW.displayName=UA;var FW="PopperArrow",ohe={top:"bottom",right:"left",bottom:"top",left:"right"},OW=w.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,s=ihe(FW,n),i=ohe[s.placedSide];return l.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:l.jsx(nhe,{...a,ref:r,style:{...a.style,display:"block"}})})});OW.displayName=FW;function lhe(e){return e!==null}var uhe=e=>({name:"transformOrigin",options:e,fn(t){var x,y,v;const{placement:r,rects:n,middlewareData:a}=t,i=((x=a.arrow)==null?void 0:x.centerOffset)!==0,o=i?0:e.arrowWidth,u=i?0:e.arrowHeight,[d,c]=PW(r),h={start:"0%",center:"50%",end:"100%"}[c],p=(((y=a.arrow)==null?void 0:y.x)??0)+o/2,f=(((v=a.arrow)==null?void 0:v.y)??0)+u/2;let g="",m="";return d==="bottom"?(g=i?h:`${p}px`,m=`${-u}px`):d==="top"?(g=i?h:`${p}px`,m=`${n.floating.height+u}px`):d==="right"?(g=`${-u}px`,m=i?h:`${f}px`):d==="left"&&(g=`${n.floating.width+u}px`,m=i?h:`${f}px`),{data:{x:g,y:m}}}});function PW(e){const[t,r="center"]=e.split("-");return[t,r]}var o_=$W,Lb=DW,l_=MW,u_=OW,[c_,uot]=Ia("Tooltip",[Vc]),d_=Vc(),LW="TooltipProvider",che=700,EE="tooltip.open",[dhe,WA]=c_(LW),zW=e=>{const{__scopeTooltip:t,delayDuration:r=che,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:s}=e,i=w.useRef(!0),o=w.useRef(!1),u=w.useRef(0);return w.useEffect(()=>{const d=u.current;return()=>window.clearTimeout(d)},[]),l.jsx(dhe,{scope:t,isOpenDelayedRef:i,delayDuration:r,onOpen:w.useCallback(()=>{window.clearTimeout(u.current),i.current=!1},[]),onClose:w.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:w.useCallback(d=>{o.current=d},[]),disableHoverableContent:a,children:s})};zW.displayName=LW;var Kv="Tooltip",[hhe,h_]=c_(Kv),BW=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a,onOpenChange:s,disableHoverableContent:i,delayDuration:o}=e,u=WA(Kv,e.__scopeTooltip),d=d_(t),[c,h]=w.useState(null),p=_a(),f=w.useRef(0),g=i??u.disableHoverableContent,m=o??u.delayDuration,x=w.useRef(!1),[y,v]=So({prop:n,defaultProp:a??!1,onChange:C=>{C?(u.onOpen(),document.dispatchEvent(new CustomEvent(EE))):u.onClose(),s==null||s(C)},caller:Kv}),b=w.useMemo(()=>y?x.current?"delayed-open":"instant-open":"closed",[y]),N=w.useCallback(()=>{window.clearTimeout(f.current),f.current=0,x.current=!1,v(!0)},[v]),S=w.useCallback(()=>{window.clearTimeout(f.current),f.current=0,v(!1)},[v]),_=w.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{x.current=!0,v(!0),f.current=0},m)},[m,v]);return w.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),l.jsx(o_,{...d,children:l.jsx(hhe,{scope:t,contentId:p,open:y,stateAttribute:b,trigger:c,onTriggerChange:h,onTriggerEnter:w.useCallback(()=>{u.isOpenDelayedRef.current?_():N()},[u.isOpenDelayedRef,_,N]),onTriggerLeave:w.useCallback(()=>{g?S():(window.clearTimeout(f.current),f.current=0)},[S,g]),onOpen:N,onClose:S,disableHoverableContent:g,children:r})})};BW.displayName=Kv;var TE="TooltipTrigger",UW=w.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=h_(TE,r),s=WA(TE,r),i=d_(r),o=w.useRef(null),u=Bt(t,o,a.onTriggerChange),d=w.useRef(!1),c=w.useRef(!1),h=w.useCallback(()=>d.current=!1,[]);return w.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),l.jsx(Lb,{asChild:!0,...i,children:l.jsx(at.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:u,onPointerMove:ze(e.onPointerMove,p=>{p.pointerType!=="touch"&&!c.current&&!s.isPointerInTransitRef.current&&(a.onTriggerEnter(),c.current=!0)}),onPointerLeave:ze(e.onPointerLeave,()=>{a.onTriggerLeave(),c.current=!1}),onPointerDown:ze(e.onPointerDown,()=>{a.open&&a.onClose(),d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:ze(e.onFocus,()=>{d.current||a.onOpen()}),onBlur:ze(e.onBlur,a.onClose),onClick:ze(e.onClick,a.onClose)})})});UW.displayName=TE;var phe="TooltipPortal",[cot,fhe]=c_(phe,{forceMount:void 0}),Zm="TooltipContent",WW=w.forwardRef((e,t)=>{const r=fhe(Zm,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...s}=e,i=h_(Zm,e.__scopeTooltip);return l.jsx(fa,{present:n||i.open,children:i.disableHoverableContent?l.jsx(VW,{side:a,...s,ref:t}):l.jsx(mhe,{side:a,...s,ref:t})})}),mhe=w.forwardRef((e,t)=>{const r=h_(Zm,e.__scopeTooltip),n=WA(Zm,e.__scopeTooltip),a=w.useRef(null),s=Bt(t,a),[i,o]=w.useState(null),{trigger:u,onClose:d}=r,c=a.current,{onPointerInTransitChange:h}=n,p=w.useCallback(()=>{o(null),h(!1)},[h]),f=w.useCallback((g,m)=>{const x=g.currentTarget,y={x:g.clientX,y:g.clientY},v=bhe(y,x.getBoundingClientRect()),b=whe(y,v),N=Nhe(m.getBoundingClientRect()),S=_he([...b,...N]);o(S),h(!0)},[h]);return w.useEffect(()=>()=>p(),[p]),w.useEffect(()=>{if(u&&c){const g=x=>f(x,c),m=x=>f(x,u);return u.addEventListener("pointerleave",g),c.addEventListener("pointerleave",m),()=>{u.removeEventListener("pointerleave",g),c.removeEventListener("pointerleave",m)}}},[u,c,f,p]),w.useEffect(()=>{if(i){const g=m=>{const x=m.target,y={x:m.clientX,y:m.clientY},v=(u==null?void 0:u.contains(x))||(c==null?void 0:c.contains(x)),b=!She(y,i);v?p():b&&(p(),d())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[u,c,i,d,p]),l.jsx(VW,{...e,ref:s})}),[ghe,xhe]=c_(Kv,{isInside:!1}),yhe=CU("TooltipContent"),VW=w.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:s,onPointerDownOutside:i,...o}=e,u=h_(Zm,r),d=d_(r),{onClose:c}=u;return w.useEffect(()=>(document.addEventListener(EE,c),()=>document.removeEventListener(EE,c)),[c]),w.useEffect(()=>{if(u.trigger){const h=p=>{const f=p.target;f!=null&&f.contains(u.trigger)&&c()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[u.trigger,c]),l.jsx(Vh,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:h=>h.preventDefault(),onDismiss:c,children:l.jsxs(l_,{"data-state":u.stateAttribute,...d,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[l.jsx(yhe,{children:n}),l.jsx(ghe,{scope:r,isInside:!0,children:l.jsx(Noe,{id:u.contentId,role:"tooltip",children:a||n})})]})})});WW.displayName=Zm;var HW="TooltipArrow",vhe=w.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=d_(r);return xhe(HW,r).isInside?null:l.jsx(u_,{...a,...n,ref:t})});vhe.displayName=HW;function bhe(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,n,a,s)){case s:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function whe(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function Nhe(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function She(e,t){const{x:r,y:n}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],u=t[i],d=o.x,c=o.y,h=u.x,p=u.y;c>n!=p>n&&r<(h-d)*(n-c)/(p-c)+d&&(a=!a)}return a}function _he(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),khe(t)}function khe(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const s=t[t.length-1],i=t[t.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const s=r[r.length-1],i=r[r.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var Che=zW,Ihe=BW,Ehe=UW,qW=WW;const cm=Che,Gy=Ihe,Ky=Ehe,dm=w.forwardRef(({className:e,sideOffset:t=4,...r},n)=>l.jsx(qW,{ref:n,sideOffset:t,className:Ue("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));dm.displayName=qW.displayName;var Fg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},hh=typeof window>"u"||"Deno"in globalThis;function us(){}function The(e,t){return typeof e=="function"?e(t):e}function jE(e){return typeof e=="number"&&e>=0&&e!==1/0}function GW(e,t){return Math.max(e+(t||0)-Date.now(),0)}function mc(e,t){return typeof e=="function"?e(t):e}function Ri(e,t){return typeof e=="function"?e(t):e}function TL(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:s,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==VA(i,t.options))return!1}else if(!Qv(t.queryKey,i))return!1}if(r!=="all"){const u=t.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||s&&!s(t))}function jL(e,t){const{exact:r,status:n,predicate:a,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(ph(t.options.mutationKey)!==ph(s))return!1}else if(!Qv(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function VA(e,t){return((t==null?void 0:t.queryKeyHashFn)||ph)(e)}function ph(e){return JSON.stringify(e,(t,r)=>AE(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Qv(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Qv(e[r],t[r])):!1}function KW(e,t){if(e===t)return e;const r=AL(e)&&AL(t);if(r||AE(e)&&AE(t)){const n=r?e:Object.keys(e),a=n.length,s=r?t:Object.keys(t),i=s.length,o=r?[]:{},u=new Set(n);let d=0;for(let c=0;c<i;c++){const h=r?c:s[c];(!r&&u.has(h)||r)&&e[h]===void 0&&t[h]===void 0?(o[h]=void 0,d++):(o[h]=KW(e[h],t[h]),o[h]===e[h]&&e[h]!==void 0&&d++)}return a===i&&d===a?e:o}return t}function ON(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function AL(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function AE(e){if(!$L(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!$L(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function $L(e){return Object.prototype.toString.call(e)==="[object Object]"}function jhe(e){return new Promise(t=>{setTimeout(t,e)})}function $E(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?KW(e,t):t}function Ahe(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function $he(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var HA=Symbol();function QW(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===HA?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function XW(e,t){return typeof e=="function"?e(...t):!!e}var Ld,Wu,$m,Bz,Rhe=(Bz=class extends Fg{constructor(){super();It(this,Ld);It(this,Wu);It(this,$m);lt(this,$m,t=>{if(!hh&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){de(this,Wu)||this.setEventListener(de(this,$m))}onUnsubscribe(){var t;this.hasListeners()||((t=de(this,Wu))==null||t.call(this),lt(this,Wu,void 0))}setEventListener(t){var r;lt(this,$m,t),(r=de(this,Wu))==null||r.call(this),lt(this,Wu,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){de(this,Ld)!==t&&(lt(this,Ld,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof de(this,Ld)=="boolean"?de(this,Ld):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ld=new WeakMap,Wu=new WeakMap,$m=new WeakMap,Bz),qA=new Rhe,Rm,Vu,Dm,Uz,Dhe=(Uz=class extends Fg{constructor(){super();It(this,Rm,!0);It(this,Vu);It(this,Dm);lt(this,Dm,t=>{if(!hh&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){de(this,Vu)||this.setEventListener(de(this,Dm))}onUnsubscribe(){var t;this.hasListeners()||((t=de(this,Vu))==null||t.call(this),lt(this,Vu,void 0))}setEventListener(t){var r;lt(this,Dm,t),(r=de(this,Vu))==null||r.call(this),lt(this,Vu,t(this.setOnline.bind(this)))}setOnline(t){de(this,Rm)!==t&&(lt(this,Rm,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return de(this,Rm)}},Rm=new WeakMap,Vu=new WeakMap,Dm=new WeakMap,Uz),PN=new Dhe;function RE(){let e,t;const r=new Promise((a,s)=>{e=a,t=s});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function Mhe(e){return Math.min(1e3*2**e,3e4)}function YW(e){return(e??"online")==="online"?PN.isOnline():!0}var JW=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function w2(e){return e instanceof JW}function ZW(e){let t=!1,r=0,n=!1,a;const s=RE(),i=m=>{var x;n||(p(new JW(m)),(x=e.abort)==null||x.call(e))},o=()=>{t=!0},u=()=>{t=!1},d=()=>qA.isFocused()&&(e.networkMode==="always"||PN.isOnline())&&e.canRun(),c=()=>YW(e.networkMode)&&e.canRun(),h=m=>{var x;n||(n=!0,(x=e.onSuccess)==null||x.call(e,m),a==null||a(),s.resolve(m))},p=m=>{var x;n||(n=!0,(x=e.onError)==null||x.call(e,m),a==null||a(),s.reject(m))},f=()=>new Promise(m=>{var x;a=y=>{(n||d())&&m(y)},(x=e.onPause)==null||x.call(e)}).then(()=>{var m;a=void 0,n||(m=e.onContinue)==null||m.call(e)}),g=()=>{if(n)return;let m;const x=r===0?e.initialPromise:void 0;try{m=x??e.fn()}catch(y){m=Promise.reject(y)}Promise.resolve(m).then(h).catch(y=>{var _;if(n)return;const v=e.retry??(hh?0:3),b=e.retryDelay??Mhe,N=typeof b=="function"?b(r,y):b,S=v===!0||typeof v=="number"&&r<v||typeof v=="function"&&v(r,y);if(t||!S){p(y);return}r++,(_=e.onFail)==null||_.call(e,r,y),jhe(N).then(()=>d()?void 0:f()).then(()=>{t?p(y):g()})})};return{promise:s,cancel:i,continue:()=>(a==null||a(),s),cancelRetry:o,continueRetry:u,canStart:c,start:()=>(c()?g():f().then(g),s)}}var Fhe=e=>setTimeout(e,0);function Ohe(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=Fhe;const s=o=>{t?e.push(o):a(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(u=>{r(u)})})})};return{batch:o=>{let u;t++;try{u=o()}finally{t--,t||i()}return u},batchCalls:o=>(...u)=>{s(()=>{o(...u)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var sa=Ohe(),zd,Wz,e6=(Wz=class{constructor(){It(this,zd)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),jE(this.gcTime)&&lt(this,zd,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(hh?1/0:5*60*1e3))}clearGcTimeout(){de(this,zd)&&(clearTimeout(de(this,zd)),lt(this,zd,void 0))}},zd=new WeakMap,Wz),Mm,Bd,ji,Ud,Wa,_b,Wd,oo,jl,Vz,Phe=(Vz=class extends e6{constructor(t){super();It(this,oo);It(this,Mm);It(this,Bd);It(this,ji);It(this,Ud);It(this,Wa);It(this,_b);It(this,Wd);lt(this,Wd,!1),lt(this,_b,t.defaultOptions),this.setOptions(t.options),this.observers=[],lt(this,Ud,t.client),lt(this,ji,de(this,Ud).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,lt(this,Mm,Lhe(this.options)),this.state=t.state??de(this,Mm),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=de(this,Wa))==null?void 0:t.promise}setOptions(t){this.options={...de(this,_b),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&de(this,ji).remove(this)}setData(t,r){const n=$E(this.state.data,t,this.options);return ar(this,oo,jl).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){ar(this,oo,jl).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=de(this,Wa))==null?void 0:n.promise;return(a=de(this,Wa))==null||a.cancel(t),r?r.then(us).catch(us):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(de(this,Mm))}isActive(){return this.observers.some(t=>Ri(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===HA||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>mc(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!GW(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=de(this,Wa))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=de(this,Wa))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),de(this,ji).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(de(this,Wa)&&(de(this,Wd)?de(this,Wa).cancel({revert:!0}):de(this,Wa).cancelRetry()),this.scheduleGc()),de(this,ji).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ar(this,oo,jl).call(this,{type:"invalidate"})}fetch(t,r){var d,c,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(de(this,Wa))return de(this,Wa).continueRetry(),de(this,Wa).promise}if(t&&this.setOptions(t),!this.options.queryFn){const p=this.observers.find(f=>f.options.queryFn);p&&this.setOptions(p.options)}const n=new AbortController,a=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(lt(this,Wd,!0),n.signal)})},s=()=>{const p=QW(this.options,r),g=(()=>{const m={client:de(this,Ud),queryKey:this.queryKey,meta:this.meta};return a(m),m})();return lt(this,Wd,!1),this.options.persister?this.options.persister(p,g,this):p(g)},o=(()=>{const p={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:de(this,Ud),state:this.state,fetchFn:s};return a(p),p})();(d=this.options.behavior)==null||d.onFetch(o,this),lt(this,Bd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&ar(this,oo,jl).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta});const u=p=>{var f,g,m,x;w2(p)&&p.silent||ar(this,oo,jl).call(this,{type:"error",error:p}),w2(p)||((g=(f=de(this,ji).config).onError)==null||g.call(f,p,this),(x=(m=de(this,ji).config).onSettled)==null||x.call(m,this.state.data,p,this)),this.scheduleGc()};return lt(this,Wa,ZW({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onSuccess:p=>{var f,g,m,x;if(p===void 0){u(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(y){u(y);return}(g=(f=de(this,ji).config).onSuccess)==null||g.call(f,p,this),(x=(m=de(this,ji).config).onSettled)==null||x.call(m,p,this.state.error,this),this.scheduleGc()},onError:u,onFail:(p,f)=>{ar(this,oo,jl).call(this,{type:"failed",failureCount:p,error:f})},onPause:()=>{ar(this,oo,jl).call(this,{type:"pause"})},onContinue:()=>{ar(this,oo,jl).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),de(this,Wa).start()}},Mm=new WeakMap,Bd=new WeakMap,ji=new WeakMap,Ud=new WeakMap,Wa=new WeakMap,_b=new WeakMap,Wd=new WeakMap,oo=new WeakSet,jl=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...t6(n.data,this.options),fetchMeta:t.meta??null};case"success":return lt(this,Bd,void 0),{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return w2(a)&&a.revert&&de(this,Bd)?{...de(this,Bd),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),sa.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),de(this,ji).notify({query:this,type:"updated",action:t})})},Vz);function t6(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:YW(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Lhe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Ho,Hz,zhe=(Hz=class extends Fg{constructor(t={}){super();It(this,Ho);this.config=t,lt(this,Ho,new Map)}build(t,r,n){const a=r.queryKey,s=r.queryHash??VA(a,r);let i=this.get(s);return i||(i=new Phe({client:t,queryKey:a,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){de(this,Ho).has(t.queryHash)||(de(this,Ho).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=de(this,Ho).get(t.queryHash);r&&(t.destroy(),r===t&&de(this,Ho).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){sa.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return de(this,Ho).get(t)}getAll(){return[...de(this,Ho).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>TL(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>TL(t,n)):r}notify(t){sa.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){sa.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){sa.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ho=new WeakMap,Hz),qo,is,Vd,Go,Iu,qz,Bhe=(qz=class extends e6{constructor(t){super();It(this,Go);It(this,qo);It(this,is);It(this,Vd);this.mutationId=t.mutationId,lt(this,is,t.mutationCache),lt(this,qo,[]),this.state=t.state||r6(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){de(this,qo).includes(t)||(de(this,qo).push(t),this.clearGcTimeout(),de(this,is).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){lt(this,qo,de(this,qo).filter(r=>r!==t)),this.scheduleGc(),de(this,is).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){de(this,qo).length||(this.state.status==="pending"?this.scheduleGc():de(this,is).remove(this))}continue(){var t;return((t=de(this,Vd))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,i,o,u,d,c,h,p,f,g,m,x,y,v,b,N,S,_,C,k;const r=()=>{ar(this,Go,Iu).call(this,{type:"continue"})};lt(this,Vd,ZW({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(I,T)=>{ar(this,Go,Iu).call(this,{type:"failed",failureCount:I,error:T})},onPause:()=>{ar(this,Go,Iu).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>de(this,is).canRun(this)}));const n=this.state.status==="pending",a=!de(this,Vd).canStart();try{if(n)r();else{ar(this,Go,Iu).call(this,{type:"pending",variables:t,isPaused:a}),await((i=(s=de(this,is).config).onMutate)==null?void 0:i.call(s,t,this));const T=await((u=(o=this.options).onMutate)==null?void 0:u.call(o,t));T!==this.state.context&&ar(this,Go,Iu).call(this,{type:"pending",context:T,variables:t,isPaused:a})}const I=await de(this,Vd).start();return await((c=(d=de(this,is).config).onSuccess)==null?void 0:c.call(d,I,t,this.state.context,this)),await((p=(h=this.options).onSuccess)==null?void 0:p.call(h,I,t,this.state.context)),await((g=(f=de(this,is).config).onSettled)==null?void 0:g.call(f,I,null,this.state.variables,this.state.context,this)),await((x=(m=this.options).onSettled)==null?void 0:x.call(m,I,null,t,this.state.context)),ar(this,Go,Iu).call(this,{type:"success",data:I}),I}catch(I){try{throw await((v=(y=de(this,is).config).onError)==null?void 0:v.call(y,I,t,this.state.context,this)),await((N=(b=this.options).onError)==null?void 0:N.call(b,I,t,this.state.context)),await((_=(S=de(this,is).config).onSettled)==null?void 0:_.call(S,void 0,I,this.state.variables,this.state.context,this)),await((k=(C=this.options).onSettled)==null?void 0:k.call(C,void 0,I,t,this.state.context)),I}finally{ar(this,Go,Iu).call(this,{type:"error",error:I})}}finally{de(this,is).runNext(this)}}},qo=new WeakMap,is=new WeakMap,Vd=new WeakMap,Go=new WeakSet,Iu=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),sa.batch(()=>{de(this,qo).forEach(n=>{n.onMutationUpdate(t)}),de(this,is).notify({mutation:this,type:"updated",action:t})})},qz);function r6(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Pl,lo,kb,Gz,Uhe=(Gz=class extends Fg{constructor(t={}){super();It(this,Pl);It(this,lo);It(this,kb);this.config=t,lt(this,Pl,new Set),lt(this,lo,new Map),lt(this,kb,0)}build(t,r,n){const a=new Bhe({mutationCache:this,mutationId:++Tw(this,kb)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){de(this,Pl).add(t);const r=Yw(t);if(typeof r=="string"){const n=de(this,lo).get(r);n?n.push(t):de(this,lo).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(de(this,Pl).delete(t)){const r=Yw(t);if(typeof r=="string"){const n=de(this,lo).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&de(this,lo).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Yw(t);if(typeof r=="string"){const n=de(this,lo).get(r),a=n==null?void 0:n.find(s=>s.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=Yw(t);if(typeof r=="string"){const a=(n=de(this,lo).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){sa.batch(()=>{de(this,Pl).forEach(t=>{this.notify({type:"removed",mutation:t})}),de(this,Pl).clear(),de(this,lo).clear()})}getAll(){return Array.from(de(this,Pl))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>jL(r,n))}findAll(t={}){return this.getAll().filter(r=>jL(t,r))}notify(t){sa.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return sa.batch(()=>Promise.all(t.map(r=>r.continue().catch(us))))}},Pl=new WeakMap,lo=new WeakMap,kb=new WeakMap,Gz);function Yw(e){var t;return(t=e.options.scope)==null?void 0:t.id}function RL(e){return{onFetch:(t,r)=>{var c,h,p,f,g;const n=t.options,a=(p=(h=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,s=((f=t.state.data)==null?void 0:f.pages)||[],i=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},u=0;const d=async()=>{let m=!1;const x=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},y=QW(t.options,t.fetchOptions),v=async(b,N,S)=>{if(m)return Promise.reject();if(N==null&&b.pages.length)return Promise.resolve(b);const C=(()=>{const j={client:t.client,queryKey:t.queryKey,pageParam:N,direction:S?"backward":"forward",meta:t.options.meta};return x(j),j})(),k=await y(C),{maxPages:I}=t.options,T=S?$he:Ahe;return{pages:T(b.pages,k,I),pageParams:T(b.pageParams,N,I)}};if(a&&s.length){const b=a==="backward",N=b?Whe:DL,S={pages:s,pageParams:i},_=N(n,S);o=await v(S,_,b)}else{const b=e??s.length;do{const N=u===0?i[0]??n.initialPageParam:DL(n,o);if(u>0&&N==null)break;o=await v(o,N),u++}while(u<b)}return o};t.options.persister?t.fetchFn=()=>{var m,x;return(x=(m=t.options).persister)==null?void 0:x.call(m,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function DL(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Whe(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Tn,Hu,qu,Fm,Om,Gu,Pm,Lm,Kz,Vhe=(Kz=class{constructor(e={}){It(this,Tn);It(this,Hu);It(this,qu);It(this,Fm);It(this,Om);It(this,Gu);It(this,Pm);It(this,Lm);lt(this,Tn,e.queryCache||new zhe),lt(this,Hu,e.mutationCache||new Uhe),lt(this,qu,e.defaultOptions||{}),lt(this,Fm,new Map),lt(this,Om,new Map),lt(this,Gu,0)}mount(){Tw(this,Gu)._++,de(this,Gu)===1&&(lt(this,Pm,qA.subscribe(async e=>{e&&(await this.resumePausedMutations(),de(this,Tn).onFocus())})),lt(this,Lm,PN.subscribe(async e=>{e&&(await this.resumePausedMutations(),de(this,Tn).onOnline())})))}unmount(){var e,t;Tw(this,Gu)._--,de(this,Gu)===0&&((e=de(this,Pm))==null||e.call(this),lt(this,Pm,void 0),(t=de(this,Lm))==null||t.call(this),lt(this,Lm,void 0))}isFetching(e){return de(this,Tn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return de(this,Hu).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=de(this,Tn).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=de(this,Tn).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(mc(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return de(this,Tn).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=de(this,Tn).get(n.queryHash),s=a==null?void 0:a.state.data,i=The(t,s);if(i!==void 0)return de(this,Tn).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return sa.batch(()=>de(this,Tn).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=de(this,Tn).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=de(this,Tn);sa.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=de(this,Tn);return sa.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=sa.batch(()=>de(this,Tn).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(us).catch(us)}invalidateQueries(e,t={}){return sa.batch(()=>(de(this,Tn).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=sa.batch(()=>de(this,Tn).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,r);return r.throwOnError||(s=s.catch(us)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(us)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=de(this,Tn).build(this,t);return r.isStaleByTime(mc(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(us).catch(us)}fetchInfiniteQuery(e){return e.behavior=RL(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(us).catch(us)}ensureInfiniteQueryData(e){return e.behavior=RL(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return PN.isOnline()?de(this,Hu).resumePausedMutations():Promise.resolve()}getQueryCache(){return de(this,Tn)}getMutationCache(){return de(this,Hu)}getDefaultOptions(){return de(this,qu)}setDefaultOptions(e){lt(this,qu,e)}setQueryDefaults(e,t){de(this,Fm).set(ph(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...de(this,Fm).values()],r={};return t.forEach(n=>{Qv(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){de(this,Om).set(ph(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...de(this,Om).values()],r={};return t.forEach(n=>{Qv(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...de(this,qu).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=VA(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===HA&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...de(this,qu).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){de(this,Tn).clear(),de(this,Hu).clear()}},Tn=new WeakMap,Hu=new WeakMap,qu=new WeakMap,Fm=new WeakMap,Om=new WeakMap,Gu=new WeakMap,Pm=new WeakMap,Lm=new WeakMap,Kz),$s,mr,Cb,os,Hd,zm,Ku,Qu,Ib,Bm,Um,qd,Gd,Xu,Wm,jr,Qy,DE,ME,FE,OE,PE,LE,zE,n6,Qz,Hhe=(Qz=class extends Fg{constructor(t,r){super();It(this,jr);It(this,$s);It(this,mr);It(this,Cb);It(this,os);It(this,Hd);It(this,zm);It(this,Ku);It(this,Qu);It(this,Ib);It(this,Bm);It(this,Um);It(this,qd);It(this,Gd);It(this,Xu);It(this,Wm,new Set);this.options=r,lt(this,$s,t),lt(this,Qu,null),lt(this,Ku,RE()),this.options.experimental_prefetchInRender||de(this,Ku).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(de(this,mr).addObserver(this),ML(de(this,mr),this.options)?ar(this,jr,Qy).call(this):this.updateResult(),ar(this,jr,OE).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return BE(de(this,mr),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return BE(de(this,mr),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ar(this,jr,PE).call(this),ar(this,jr,LE).call(this),de(this,mr).removeObserver(this)}setOptions(t){const r=this.options,n=de(this,mr);if(this.options=de(this,$s).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ri(this.options.enabled,de(this,mr))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ar(this,jr,zE).call(this),de(this,mr).setOptions(this.options),r._defaulted&&!ON(this.options,r)&&de(this,$s).getQueryCache().notify({type:"observerOptionsUpdated",query:de(this,mr),observer:this});const a=this.hasListeners();a&&FL(de(this,mr),n,this.options,r)&&ar(this,jr,Qy).call(this),this.updateResult(),a&&(de(this,mr)!==n||Ri(this.options.enabled,de(this,mr))!==Ri(r.enabled,de(this,mr))||mc(this.options.staleTime,de(this,mr))!==mc(r.staleTime,de(this,mr)))&&ar(this,jr,DE).call(this);const s=ar(this,jr,ME).call(this);a&&(de(this,mr)!==n||Ri(this.options.enabled,de(this,mr))!==Ri(r.enabled,de(this,mr))||s!==de(this,Xu))&&ar(this,jr,FE).call(this,s)}getOptimisticResult(t){const r=de(this,$s).getQueryCache().build(de(this,$s),t),n=this.createResult(r,t);return Ghe(this,n)&&(lt(this,os,n),lt(this,zm,this.options),lt(this,Hd,de(this,mr).state)),n}getCurrentResult(){return de(this,os)}trackResult(t,r){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),r==null||r(a),Reflect.get(n,a))})}trackProp(t){de(this,Wm).add(t)}getCurrentQuery(){return de(this,mr)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=de(this,$s).defaultQueryOptions(t),n=de(this,$s).getQueryCache().build(de(this,$s),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return ar(this,jr,Qy).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),de(this,os)))}createResult(t,r){var I;const n=de(this,mr),a=this.options,s=de(this,os),i=de(this,Hd),o=de(this,zm),d=t!==n?t.state:de(this,Cb),{state:c}=t;let h={...c},p=!1,f;if(r._optimisticResults){const T=this.hasListeners(),j=!T&&ML(t,r),E=T&&FL(t,n,r,a);(j||E)&&(h={...h,...t6(c.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:m,status:x}=h;f=h.data;let y=!1;if(r.placeholderData!==void 0&&f===void 0&&x==="pending"){let T;s!=null&&s.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(T=s.data,y=!0):T=typeof r.placeholderData=="function"?r.placeholderData((I=de(this,Um))==null?void 0:I.state.data,de(this,Um)):r.placeholderData,T!==void 0&&(x="success",f=$E(s==null?void 0:s.data,T,r),p=!0)}if(r.select&&f!==void 0&&!y)if(s&&f===(i==null?void 0:i.data)&&r.select===de(this,Ib))f=de(this,Bm);else try{lt(this,Ib,r.select),f=r.select(f),f=$E(s==null?void 0:s.data,f,r),lt(this,Bm,f),lt(this,Qu,null)}catch(T){lt(this,Qu,T)}de(this,Qu)&&(g=de(this,Qu),f=de(this,Bm),m=Date.now(),x="error");const v=h.fetchStatus==="fetching",b=x==="pending",N=x==="error",S=b&&v,_=f!==void 0,k={status:x,fetchStatus:h.fetchStatus,isPending:b,isSuccess:x==="success",isError:N,isInitialLoading:S,isLoading:S,data:f,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:m,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:v,isRefetching:v&&!b,isLoadingError:N&&!_,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:N&&_,isStale:GA(t,r),refetch:this.refetch,promise:de(this,Ku),isEnabled:Ri(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=O=>{k.status==="error"?O.reject(k.error):k.data!==void 0&&O.resolve(k.data)},j=()=>{const O=lt(this,Ku,k.promise=RE());T(O)},E=de(this,Ku);switch(E.status){case"pending":t.queryHash===n.queryHash&&T(E);break;case"fulfilled":(k.status==="error"||k.data!==E.value)&&j();break;case"rejected":(k.status!=="error"||k.error!==E.reason)&&j();break}}return k}updateResult(){const t=de(this,os),r=this.createResult(de(this,mr),this.options);if(lt(this,Hd,de(this,mr).state),lt(this,zm,this.options),de(this,Hd).data!==void 0&&lt(this,Um,de(this,mr)),ON(r,t))return;lt(this,os,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,s=typeof a=="function"?a():a;if(s==="all"||!s&&!de(this,Wm).size)return!0;const i=new Set(s??de(this,Wm));return this.options.throwOnError&&i.add("error"),Object.keys(de(this,os)).some(o=>{const u=o;return de(this,os)[u]!==t[u]&&i.has(u)})};ar(this,jr,n6).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ar(this,jr,OE).call(this)}},$s=new WeakMap,mr=new WeakMap,Cb=new WeakMap,os=new WeakMap,Hd=new WeakMap,zm=new WeakMap,Ku=new WeakMap,Qu=new WeakMap,Ib=new WeakMap,Bm=new WeakMap,Um=new WeakMap,qd=new WeakMap,Gd=new WeakMap,Xu=new WeakMap,Wm=new WeakMap,jr=new WeakSet,Qy=function(t){ar(this,jr,zE).call(this);let r=de(this,mr).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(us)),r},DE=function(){ar(this,jr,PE).call(this);const t=mc(this.options.staleTime,de(this,mr));if(hh||de(this,os).isStale||!jE(t))return;const n=GW(de(this,os).dataUpdatedAt,t)+1;lt(this,qd,setTimeout(()=>{de(this,os).isStale||this.updateResult()},n))},ME=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(de(this,mr)):this.options.refetchInterval)??!1},FE=function(t){ar(this,jr,LE).call(this),lt(this,Xu,t),!(hh||Ri(this.options.enabled,de(this,mr))===!1||!jE(de(this,Xu))||de(this,Xu)===0)&&lt(this,Gd,setInterval(()=>{(this.options.refetchIntervalInBackground||qA.isFocused())&&ar(this,jr,Qy).call(this)},de(this,Xu)))},OE=function(){ar(this,jr,DE).call(this),ar(this,jr,FE).call(this,ar(this,jr,ME).call(this))},PE=function(){de(this,qd)&&(clearTimeout(de(this,qd)),lt(this,qd,void 0))},LE=function(){de(this,Gd)&&(clearInterval(de(this,Gd)),lt(this,Gd,void 0))},zE=function(){const t=de(this,$s).getQueryCache().build(de(this,$s),this.options);if(t===de(this,mr))return;const r=de(this,mr);lt(this,mr,t),lt(this,Cb,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},n6=function(t){sa.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(de(this,os))}),de(this,$s).getQueryCache().notify({query:de(this,mr),type:"observerResultsUpdated"})})},Qz);function qhe(e,t){return Ri(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function ML(e,t){return qhe(e,t)||e.state.data!==void 0&&BE(e,t,t.refetchOnMount)}function BE(e,t,r){if(Ri(t.enabled,e)!==!1&&mc(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&GA(e,t)}return!1}function FL(e,t,r,n){return(e!==t||Ri(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&GA(e,r)}function GA(e,t){return Ri(t.enabled,e)!==!1&&e.isStaleByTime(mc(t.staleTime,e))}function Ghe(e,t){return!ON(e.getCurrentResult(),t)}var Yu,Ju,Rs,Ll,Xl,z1,UE,Xz,Khe=(Xz=class extends Fg{constructor(r,n){super();It(this,Xl);It(this,Yu);It(this,Ju);It(this,Rs);It(this,Ll);lt(this,Yu,r),this.setOptions(n),this.bindMethods(),ar(this,Xl,z1).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=de(this,Yu).defaultMutationOptions(r),ON(this.options,n)||de(this,Yu).getMutationCache().notify({type:"observerOptionsUpdated",mutation:de(this,Rs),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&ph(n.mutationKey)!==ph(this.options.mutationKey)?this.reset():((a=de(this,Rs))==null?void 0:a.state.status)==="pending"&&de(this,Rs).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=de(this,Rs))==null||r.removeObserver(this)}onMutationUpdate(r){ar(this,Xl,z1).call(this),ar(this,Xl,UE).call(this,r)}getCurrentResult(){return de(this,Ju)}reset(){var r;(r=de(this,Rs))==null||r.removeObserver(this),lt(this,Rs,void 0),ar(this,Xl,z1).call(this),ar(this,Xl,UE).call(this)}mutate(r,n){var a;return lt(this,Ll,n),(a=de(this,Rs))==null||a.removeObserver(this),lt(this,Rs,de(this,Yu).getMutationCache().build(de(this,Yu),this.options)),de(this,Rs).addObserver(this),de(this,Rs).execute(r)}},Yu=new WeakMap,Ju=new WeakMap,Rs=new WeakMap,Ll=new WeakMap,Xl=new WeakSet,z1=function(){var n;const r=((n=de(this,Rs))==null?void 0:n.state)??r6();lt(this,Ju,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},UE=function(r){sa.batch(()=>{var n,a,s,i,o,u,d,c;if(de(this,Ll)&&this.hasListeners()){const h=de(this,Ju).variables,p=de(this,Ju).context;(r==null?void 0:r.type)==="success"?((a=(n=de(this,Ll)).onSuccess)==null||a.call(n,r.data,h,p),(i=(s=de(this,Ll)).onSettled)==null||i.call(s,r.data,null,h,p)):(r==null?void 0:r.type)==="error"&&((u=(o=de(this,Ll)).onError)==null||u.call(o,r.error,h,p),(c=(d=de(this,Ll)).onSettled)==null||c.call(d,void 0,r.error,h,p))}this.listeners.forEach(h=>{h(de(this,Ju))})})},Xz),a6=w.createContext(void 0),p_=e=>{const t=w.useContext(a6);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Qhe=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),l.jsx(a6.Provider,{value:e,children:t})),s6=w.createContext(!1),Xhe=()=>w.useContext(s6);s6.Provider;function Yhe(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Jhe=w.createContext(Yhe()),Zhe=()=>w.useContext(Jhe),epe=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},tpe=e=>{w.useEffect(()=>{e.clearReset()},[e])},rpe=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||XW(r,[e.error,n])),npe=e=>{if(e.suspense){const t=n=>n==="static"?n:Math.max(n??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...n)=>t(r(...n)):t(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},ape=(e,t)=>e.isLoading&&e.isFetching&&!t,spe=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,OL=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function ipe(e,t,r){var h,p,f,g,m;const n=Xhe(),a=Zhe(),s=p_(),i=s.defaultQueryOptions(e);(p=(h=s.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,i),i._optimisticResults=n?"isRestoring":"optimistic",npe(i),epe(i,a),tpe(a);const o=!s.getQueryCache().get(i.queryHash),[u]=w.useState(()=>new t(s,i)),d=u.getOptimisticResult(i),c=!n&&e.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(x=>{const y=c?u.subscribe(sa.batchCalls(x)):us;return u.updateResult(),y},[u,c]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),w.useEffect(()=>{u.setOptions(i)},[i,u]),spe(i,d))throw OL(i,u,a);if(rpe({result:d,errorResetBoundary:a,throwOnError:i.throwOnError,query:s.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw d.error;if((g=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||g.call(f,i,d),i.experimental_prefetchInRender&&!hh&&ape(d,n)){const x=o?OL(i,u,a):(m=s.getQueryCache().get(i.queryHash))==null?void 0:m.promise;x==null||x.catch(us).finally(()=>{u.updateResult()})}return i.notifyOnChangeProps?d:u.trackResult(d)}function Og(e,t){return ipe(e,Hhe)}function B1(e,t){const r=p_(),[n]=w.useState(()=>new Khe(r,e));w.useEffect(()=>{n.setOptions(e)},[n,e]);const a=w.useSyncExternalStore(w.useCallback(i=>n.subscribe(sa.batchCalls(i)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=w.useCallback((i,o)=>{n.mutate(i,o).catch(us)},[n]);if(a.error&&XW(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:s,mutateAsync:a.mutate}}const ope=()=>{const e=_s(),t=Rn();return w.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),l.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),l.jsx("button",{onClick:()=>t("/auth"),className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};function i6(e,t){return function(){return e.apply(t,arguments)}}const{toString:lpe}=Object.prototype,{getPrototypeOf:KA}=Object,{iterator:f_,toStringTag:o6}=Symbol,m_=(e=>t=>{const r=lpe.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ro=e=>(e=e.toLowerCase(),t=>m_(t)===e),g_=e=>t=>typeof t===e,{isArray:Pg}=Array,Xv=g_("undefined");function zb(e){return e!==null&&!Xv(e)&&e.constructor!==null&&!Xv(e.constructor)&&qs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const l6=Ro("ArrayBuffer");function upe(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&l6(e.buffer),t}const cpe=g_("string"),qs=g_("function"),u6=g_("number"),Bb=e=>e!==null&&typeof e=="object",dpe=e=>e===!0||e===!1,U1=e=>{if(m_(e)!=="object")return!1;const t=KA(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(o6 in e)&&!(f_ in e)},hpe=e=>{if(!Bb(e)||zb(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},ppe=Ro("Date"),fpe=Ro("File"),mpe=Ro("Blob"),gpe=Ro("FileList"),xpe=e=>Bb(e)&&qs(e.pipe),ype=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||qs(e.append)&&((t=m_(e))==="formdata"||t==="object"&&qs(e.toString)&&e.toString()==="[object FormData]"))},vpe=Ro("URLSearchParams"),[bpe,wpe,Npe,Spe]=["ReadableStream","Request","Response","Headers"].map(Ro),_pe=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ub(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Pg(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(zb(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let o;for(n=0;n<i;n++)o=s[n],t.call(null,e[o],o,e)}}function c6(e,t){if(zb(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Fd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,d6=e=>!Xv(e)&&e!==Fd;function WE(){const{caseless:e}=d6(this)&&this||{},t={},r=(n,a)=>{const s=e&&c6(t,a)||a;U1(t[s])&&U1(n)?t[s]=WE(t[s],n):U1(n)?t[s]=WE({},n):Pg(n)?t[s]=n.slice():t[s]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Ub(arguments[n],r);return t}const kpe=(e,t,r,{allOwnKeys:n}={})=>(Ub(t,(a,s)=>{r&&qs(a)?e[s]=i6(a,r):e[s]=a},{allOwnKeys:n}),e),Cpe=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ipe=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Epe=(e,t,r,n)=>{let a,s,i;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&KA(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Tpe=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},jpe=e=>{if(!e)return null;if(Pg(e))return e;let t=e.length;if(!u6(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Ape=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&KA(Uint8Array)),$pe=(e,t)=>{const n=(e&&e[f_]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},Rpe=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},Dpe=Ro("HTMLFormElement"),Mpe=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),PL=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),Fpe=Ro("RegExp"),h6=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Ub(r,(a,s)=>{let i;(i=t(a,s,e))!==!1&&(n[s]=i||a)}),Object.defineProperties(e,n)},Ope=e=>{h6(e,(t,r)=>{if(qs(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(qs(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Ppe=(e,t)=>{const r={},n=a=>{a.forEach(s=>{r[s]=!0})};return Pg(e)?n(e):n(String(e).split(t)),r},Lpe=()=>{},zpe=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Bpe(e){return!!(e&&qs(e.append)&&e[o6]==="FormData"&&e[f_])}const Upe=e=>{const t=new Array(10),r=(n,a)=>{if(Bb(n)){if(t.indexOf(n)>=0)return;if(zb(n))return n;if(!("toJSON"in n)){t[a]=n;const s=Pg(n)?[]:{};return Ub(n,(i,o)=>{const u=r(i,a+1);!Xv(u)&&(s[o]=u)}),t[a]=void 0,s}}return n};return r(e,0)},Wpe=Ro("AsyncFunction"),Vpe=e=>e&&(Bb(e)||qs(e))&&qs(e.then)&&qs(e.catch),p6=((e,t)=>e?setImmediate:t?((r,n)=>(Fd.addEventListener("message",({source:a,data:s})=>{a===Fd&&s===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Fd.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",qs(Fd.postMessage)),Hpe=typeof queueMicrotask<"u"?queueMicrotask.bind(Fd):typeof process<"u"&&process.nextTick||p6,qpe=e=>e!=null&&qs(e[f_]),_e={isArray:Pg,isArrayBuffer:l6,isBuffer:zb,isFormData:ype,isArrayBufferView:upe,isString:cpe,isNumber:u6,isBoolean:dpe,isObject:Bb,isPlainObject:U1,isEmptyObject:hpe,isReadableStream:bpe,isRequest:wpe,isResponse:Npe,isHeaders:Spe,isUndefined:Xv,isDate:ppe,isFile:fpe,isBlob:mpe,isRegExp:Fpe,isFunction:qs,isStream:xpe,isURLSearchParams:vpe,isTypedArray:Ape,isFileList:gpe,forEach:Ub,merge:WE,extend:kpe,trim:_pe,stripBOM:Cpe,inherits:Ipe,toFlatObject:Epe,kindOf:m_,kindOfTest:Ro,endsWith:Tpe,toArray:jpe,forEachEntry:$pe,matchAll:Rpe,isHTMLForm:Dpe,hasOwnProperty:PL,hasOwnProp:PL,reduceDescriptors:h6,freezeMethods:Ope,toObjectSet:Ppe,toCamelCase:Mpe,noop:Lpe,toFiniteNumber:zpe,findKey:c6,global:Fd,isContextDefined:d6,isSpecCompliantForm:Bpe,toJSONObject:Upe,isAsyncFn:Wpe,isThenable:Vpe,setImmediate:p6,asap:Hpe,isIterable:qpe};function Yt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}_e.inherits(Yt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_e.toJSONObject(this.config),code:this.code,status:this.status}}});const f6=Yt.prototype,m6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{m6[e]={value:e}});Object.defineProperties(Yt,m6);Object.defineProperty(f6,"isAxiosError",{value:!0});Yt.from=(e,t,r,n,a,s)=>{const i=Object.create(f6);return _e.toFlatObject(e,i,function(u){return u!==Error.prototype},o=>o!=="isAxiosError"),Yt.call(i,e.message,t,r,n,a),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const Gpe=null;function VE(e){return _e.isPlainObject(e)||_e.isArray(e)}function g6(e){return _e.endsWith(e,"[]")?e.slice(0,-2):e}function LL(e,t,r){return e?e.concat(t).map(function(a,s){return a=g6(a),!r&&s?"["+a+"]":a}).join(r?".":""):t}function Kpe(e){return _e.isArray(e)&&!e.some(VE)}const Qpe=_e.toFlatObject(_e,{},null,function(t){return/^is[A-Z]/.test(t)});function x_(e,t,r){if(!_e.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=_e.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,x){return!_e.isUndefined(x[m])});const n=r.metaTokens,a=r.visitor||c,s=r.dots,i=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&_e.isSpecCompliantForm(t);if(!_e.isFunction(a))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(_e.isDate(g))return g.toISOString();if(_e.isBoolean(g))return g.toString();if(!u&&_e.isBlob(g))throw new Yt("Blob is not supported. Use a Buffer instead.");return _e.isArrayBuffer(g)||_e.isTypedArray(g)?u&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,m,x){let y=g;if(g&&!x&&typeof g=="object"){if(_e.endsWith(m,"{}"))m=n?m:m.slice(0,-2),g=JSON.stringify(g);else if(_e.isArray(g)&&Kpe(g)||(_e.isFileList(g)||_e.endsWith(m,"[]"))&&(y=_e.toArray(g)))return m=g6(m),y.forEach(function(b,N){!(_e.isUndefined(b)||b===null)&&t.append(i===!0?LL([m],N,s):i===null?m:m+"[]",d(b))}),!1}return VE(g)?!0:(t.append(LL(x,m,s),d(g)),!1)}const h=[],p=Object.assign(Qpe,{defaultVisitor:c,convertValue:d,isVisitable:VE});function f(g,m){if(!_e.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(g),_e.forEach(g,function(y,v){(!(_e.isUndefined(y)||y===null)&&a.call(t,y,_e.isString(v)?v.trim():v,m,p))===!0&&f(y,m?m.concat(v):[v])}),h.pop()}}if(!_e.isObject(e))throw new TypeError("data must be an object");return f(e),t}function zL(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function QA(e,t){this._pairs=[],e&&x_(e,this,t)}const x6=QA.prototype;x6.append=function(t,r){this._pairs.push([t,r])};x6.toString=function(t){const r=t?function(n){return t.call(this,n,zL)}:zL;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function Xpe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function y6(e,t,r){if(!t)return e;const n=r&&r.encode||Xpe;_e.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(a?s=a(t,r):s=_e.isURLSearchParams(t)?t.toString():new QA(t,r).toString(n),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class BL{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){_e.forEach(this.handlers,function(n){n!==null&&t(n)})}}const v6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ype=typeof URLSearchParams<"u"?URLSearchParams:QA,Jpe=typeof FormData<"u"?FormData:null,Zpe=typeof Blob<"u"?Blob:null,efe={isBrowser:!0,classes:{URLSearchParams:Ype,FormData:Jpe,Blob:Zpe},protocols:["http","https","file","blob","url","data"]},XA=typeof window<"u"&&typeof document<"u",HE=typeof navigator=="object"&&navigator||void 0,tfe=XA&&(!HE||["ReactNative","NativeScript","NS"].indexOf(HE.product)<0),rfe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",nfe=XA&&window.location.href||"http://localhost",afe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:XA,hasStandardBrowserEnv:tfe,hasStandardBrowserWebWorkerEnv:rfe,navigator:HE,origin:nfe},Symbol.toStringTag,{value:"Module"})),qa={...afe,...efe};function sfe(e,t){return x_(e,new qa.classes.URLSearchParams,{visitor:function(r,n,a,s){return qa.isNode&&_e.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function ife(e){return _e.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function ofe(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}function b6(e){function t(r,n,a,s){let i=r[s++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),u=s>=r.length;return i=!i&&_e.isArray(a)?a.length:i,u?(_e.hasOwnProp(a,i)?a[i]=[a[i],n]:a[i]=n,!o):((!a[i]||!_e.isObject(a[i]))&&(a[i]=[]),t(r,n,a[i],s)&&_e.isArray(a[i])&&(a[i]=ofe(a[i])),!o)}if(_e.isFormData(e)&&_e.isFunction(e.entries)){const r={};return _e.forEachEntry(e,(n,a)=>{t(ife(n),a,r,0)}),r}return null}function lfe(e,t,r){if(_e.isString(e))try{return(t||JSON.parse)(e),_e.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Wb={transitional:v6,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,s=_e.isObject(t);if(s&&_e.isHTMLForm(t)&&(t=new FormData(t)),_e.isFormData(t))return a?JSON.stringify(b6(t)):t;if(_e.isArrayBuffer(t)||_e.isBuffer(t)||_e.isStream(t)||_e.isFile(t)||_e.isBlob(t)||_e.isReadableStream(t))return t;if(_e.isArrayBufferView(t))return t.buffer;if(_e.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return sfe(t,this.formSerializer).toString();if((o=_e.isFileList(t))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return x_(o?{"files[]":t}:t,u&&new u,this.formSerializer)}}return s||a?(r.setContentType("application/json",!1),lfe(t)):t}],transformResponse:[function(t){const r=this.transitional||Wb.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(_e.isResponse(t)||_e.isReadableStream(t))return t;if(t&&_e.isString(t)&&(n&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(o){if(i)throw o.name==="SyntaxError"?Yt.from(o,Yt.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:qa.classes.FormData,Blob:qa.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_e.forEach(["delete","get","head","post","put","patch"],e=>{Wb.headers[e]={}});const ufe=_e.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),cfe=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),n=i.substring(a+1).trim(),!(!r||t[r]&&ufe[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},UL=Symbol("internals");function jy(e){return e&&String(e).trim().toLowerCase()}function W1(e){return e===!1||e==null?e:_e.isArray(e)?e.map(W1):String(e)}function dfe(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const hfe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function N2(e,t,r,n,a){if(_e.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!_e.isString(t)){if(_e.isString(n))return t.indexOf(n)!==-1;if(_e.isRegExp(n))return n.test(t)}}function pfe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function ffe(e,t){const r=_e.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,s,i){return this[n].call(this,t,a,s,i)},configurable:!0})})}let Gs=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function s(o,u,d){const c=jy(u);if(!c)throw new Error("header name must be a non-empty string");const h=_e.findKey(a,c);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||u]=W1(o))}const i=(o,u)=>_e.forEach(o,(d,c)=>s(d,c,u));if(_e.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(_e.isString(t)&&(t=t.trim())&&!hfe(t))i(cfe(t),r);else if(_e.isObject(t)&&_e.isIterable(t)){let o={},u,d;for(const c of t){if(!_e.isArray(c))throw TypeError("Object iterator must return a key-value pair");o[d=c[0]]=(u=o[d])?_e.isArray(u)?[...u,c[1]]:[u,c[1]]:c[1]}i(o,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=jy(t),t){const n=_e.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return dfe(a);if(_e.isFunction(r))return r.call(this,a,n);if(_e.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=jy(t),t){const n=_e.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||N2(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function s(i){if(i=jy(i),i){const o=_e.findKey(n,i);o&&(!r||N2(n,n[o],o,r))&&(delete n[o],a=!0)}}return _e.isArray(t)?t.forEach(s):s(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const s=r[n];(!t||N2(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const r=this,n={};return _e.forEach(this,(a,s)=>{const i=_e.findKey(n,s);if(i){r[i]=W1(a),delete r[s];return}const o=t?pfe(s):String(s).trim();o!==s&&delete r[s],r[o]=W1(a),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return _e.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&_e.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[UL]=this[UL]={accessors:{}}).accessors,a=this.prototype;function s(i){const o=jy(i);n[o]||(ffe(a,i),n[o]=!0)}return _e.isArray(t)?t.forEach(s):s(t),this}};Gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_e.reduceDescriptors(Gs.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});_e.freezeMethods(Gs);function S2(e,t){const r=this||Wb,n=t||r,a=Gs.from(n.headers);let s=n.data;return _e.forEach(e,function(o){s=o.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function w6(e){return!!(e&&e.__CANCEL__)}function Lg(e,t,r){Yt.call(this,e??"canceled",Yt.ERR_CANCELED,t,r),this.name="CanceledError"}_e.inherits(Lg,Yt,{__CANCEL__:!0});function N6(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Yt("Request failed with status code "+r.status,[Yt.ERR_BAD_REQUEST,Yt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function mfe(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function gfe(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,s=0,i;return t=t!==void 0?t:1e3,function(u){const d=Date.now(),c=n[s];i||(i=d),r[a]=u,n[a]=d;let h=s,p=0;for(;h!==a;)p+=r[h++],h=h%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),d-i<t)return;const f=c&&d-c;return f?Math.round(p*1e3/f):void 0}}function xfe(e,t){let r=0,n=1e3/t,a,s;const i=(d,c=Date.now())=>{r=c,a=null,s&&(clearTimeout(s),s=null),e(...d)};return[(...d)=>{const c=Date.now(),h=c-r;h>=n?i(d,c):(a=d,s||(s=setTimeout(()=>{s=null,i(a)},n-h)))},()=>a&&i(a)]}const LN=(e,t,r=3)=>{let n=0;const a=gfe(50,250);return xfe(s=>{const i=s.loaded,o=s.lengthComputable?s.total:void 0,u=i-n,d=a(u),c=i<=o;n=i;const h={loaded:i,total:o,progress:o?i/o:void 0,bytes:u,rate:d||void 0,estimated:d&&o&&c?(o-i)/d:void 0,event:s,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},r)},WL=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},VL=e=>(...t)=>_e.asap(()=>e(...t)),yfe=qa.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,qa.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(qa.origin),qa.navigator&&/(msie|trident)/i.test(qa.navigator.userAgent)):()=>!0,vfe=qa.hasStandardBrowserEnv?{write(e,t,r,n,a,s){const i=[e+"="+encodeURIComponent(t)];_e.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),_e.isString(n)&&i.push("path="+n),_e.isString(a)&&i.push("domain="+a),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function bfe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function wfe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function S6(e,t,r){let n=!bfe(t);return e&&(n||r==!1)?wfe(e,t):t}const HL=e=>e instanceof Gs?{...e}:e;function fh(e,t){t=t||{};const r={};function n(d,c,h,p){return _e.isPlainObject(d)&&_e.isPlainObject(c)?_e.merge.call({caseless:p},d,c):_e.isPlainObject(c)?_e.merge({},c):_e.isArray(c)?c.slice():c}function a(d,c,h,p){if(_e.isUndefined(c)){if(!_e.isUndefined(d))return n(void 0,d,h,p)}else return n(d,c,h,p)}function s(d,c){if(!_e.isUndefined(c))return n(void 0,c)}function i(d,c){if(_e.isUndefined(c)){if(!_e.isUndefined(d))return n(void 0,d)}else return n(void 0,c)}function o(d,c,h){if(h in t)return n(d,c);if(h in e)return n(void 0,d)}const u={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(d,c,h)=>a(HL(d),HL(c),h,!0)};return _e.forEach(Object.keys({...e,...t}),function(c){const h=u[c]||a,p=h(e[c],t[c],c);_e.isUndefined(p)&&h!==o||(r[c]=p)}),r}const _6=e=>{const t=fh({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:i,auth:o}=t;t.headers=i=Gs.from(i),t.url=y6(S6(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let u;if(_e.isFormData(r)){if(qa.hasStandardBrowserEnv||qa.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((u=i.getContentType())!==!1){const[d,...c]=u?u.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...c].join("; "))}}if(qa.hasStandardBrowserEnv&&(n&&_e.isFunction(n)&&(n=n(t)),n||n!==!1&&yfe(t.url))){const d=a&&s&&vfe.read(s);d&&i.set(a,d)}return t},Nfe=typeof XMLHttpRequest<"u",Sfe=Nfe&&function(e){return new Promise(function(r,n){const a=_6(e);let s=a.data;const i=Gs.from(a.headers).normalize();let{responseType:o,onUploadProgress:u,onDownloadProgress:d}=a,c,h,p,f,g;function m(){f&&f(),g&&g(),a.cancelToken&&a.cancelToken.unsubscribe(c),a.signal&&a.signal.removeEventListener("abort",c)}let x=new XMLHttpRequest;x.open(a.method.toUpperCase(),a.url,!0),x.timeout=a.timeout;function y(){if(!x)return;const b=Gs.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),S={data:!o||o==="text"||o==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:b,config:e,request:x};N6(function(C){r(C),m()},function(C){n(C),m()},S),x=null}"onloadend"in x?x.onloadend=y:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(y)},x.onabort=function(){x&&(n(new Yt("Request aborted",Yt.ECONNABORTED,e,x)),x=null)},x.onerror=function(){n(new Yt("Network Error",Yt.ERR_NETWORK,e,x)),x=null},x.ontimeout=function(){let N=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const S=a.transitional||v6;a.timeoutErrorMessage&&(N=a.timeoutErrorMessage),n(new Yt(N,S.clarifyTimeoutError?Yt.ETIMEDOUT:Yt.ECONNABORTED,e,x)),x=null},s===void 0&&i.setContentType(null),"setRequestHeader"in x&&_e.forEach(i.toJSON(),function(N,S){x.setRequestHeader(S,N)}),_e.isUndefined(a.withCredentials)||(x.withCredentials=!!a.withCredentials),o&&o!=="json"&&(x.responseType=a.responseType),d&&([p,g]=LN(d,!0),x.addEventListener("progress",p)),u&&x.upload&&([h,f]=LN(u),x.upload.addEventListener("progress",h),x.upload.addEventListener("loadend",f)),(a.cancelToken||a.signal)&&(c=b=>{x&&(n(!b||b.type?new Lg(null,e,x):b),x.abort(),x=null)},a.cancelToken&&a.cancelToken.subscribe(c),a.signal&&(a.signal.aborted?c():a.signal.addEventListener("abort",c)));const v=mfe(a.url);if(v&&qa.protocols.indexOf(v)===-1){n(new Yt("Unsupported protocol "+v+":",Yt.ERR_BAD_REQUEST,e));return}x.send(s||null)})},_fe=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const s=function(d){if(!a){a=!0,o();const c=d instanceof Error?d:this.reason;n.abort(c instanceof Yt?c:new Lg(c instanceof Error?c.message:c))}};let i=t&&setTimeout(()=>{i=null,s(new Yt(`timeout ${t} of ms exceeded`,Yt.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),e=null)};e.forEach(d=>d.addEventListener("abort",s));const{signal:u}=n;return u.unsubscribe=()=>_e.asap(o),u}},kfe=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},Cfe=async function*(e,t){for await(const r of Ife(e))yield*kfe(r,t)},Ife=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},qL=(e,t,r,n)=>{const a=Cfe(e,t);let s=0,i,o=u=>{i||(i=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:d,value:c}=await a.next();if(d){o(),u.close();return}let h=c.byteLength;if(r){let p=s+=h;r(p)}u.enqueue(new Uint8Array(c))}catch(d){throw o(d),d}},cancel(u){return o(u),a.return()}},{highWaterMark:2})},y_=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",k6=y_&&typeof ReadableStream=="function",Efe=y_&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),C6=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Tfe=k6&&C6(()=>{let e=!1;const t=new Request(qa.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),GL=64*1024,qE=k6&&C6(()=>_e.isReadableStream(new Response("").body)),zN={stream:qE&&(e=>e.body)};y_&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!zN[t]&&(zN[t]=_e.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new Yt(`Response type '${t}' is not supported`,Yt.ERR_NOT_SUPPORT,n)})})})(new Response);const jfe=async e=>{if(e==null)return 0;if(_e.isBlob(e))return e.size;if(_e.isSpecCompliantForm(e))return(await new Request(qa.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(_e.isArrayBufferView(e)||_e.isArrayBuffer(e))return e.byteLength;if(_e.isURLSearchParams(e)&&(e=e+""),_e.isString(e))return(await Efe(e)).byteLength},Afe=async(e,t)=>{const r=_e.toFiniteNumber(e.getContentLength());return r??jfe(t)},$fe=y_&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:s,timeout:i,onDownloadProgress:o,onUploadProgress:u,responseType:d,headers:c,withCredentials:h="same-origin",fetchOptions:p}=_6(e);d=d?(d+"").toLowerCase():"text";let f=_fe([a,s&&s.toAbortSignal()],i),g;const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let x;try{if(u&&Tfe&&r!=="get"&&r!=="head"&&(x=await Afe(c,n))!==0){let S=new Request(t,{method:"POST",body:n,duplex:"half"}),_;if(_e.isFormData(n)&&(_=S.headers.get("content-type"))&&c.setContentType(_),S.body){const[C,k]=WL(x,LN(VL(u)));n=qL(S.body,GL,C,k)}}_e.isString(h)||(h=h?"include":"omit");const y="credentials"in Request.prototype;g=new Request(t,{...p,signal:f,method:r.toUpperCase(),headers:c.normalize().toJSON(),body:n,duplex:"half",credentials:y?h:void 0});let v=await fetch(g,p);const b=qE&&(d==="stream"||d==="response");if(qE&&(o||b&&m)){const S={};["status","statusText","headers"].forEach(I=>{S[I]=v[I]});const _=_e.toFiniteNumber(v.headers.get("content-length")),[C,k]=o&&WL(_,LN(VL(o),!0))||[];v=new Response(qL(v.body,GL,C,()=>{k&&k(),m&&m()}),S)}d=d||"text";let N=await zN[_e.findKey(zN,d)||"text"](v,e);return!b&&m&&m(),await new Promise((S,_)=>{N6(S,_,{data:N,headers:Gs.from(v.headers),status:v.status,statusText:v.statusText,config:e,request:g})})}catch(y){throw m&&m(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new Yt("Network Error",Yt.ERR_NETWORK,e,g),{cause:y.cause||y}):Yt.from(y,y&&y.code,e,g)}}),GE={http:Gpe,xhr:Sfe,fetch:$fe};_e.forEach(GE,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const KL=e=>`- ${e}`,Rfe=e=>_e.isFunction(e)||e===null||e===!1,I6={getAdapter:e=>{e=_e.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let s=0;s<t;s++){r=e[s];let i;if(n=r,!Rfe(r)&&(n=GE[(i=String(r)).toLowerCase()],n===void 0))throw new Yt(`Unknown adapter '${i}'`);if(n)break;a[i||"#"+s]=n}if(!n){const s=Object.entries(a).map(([o,u])=>`adapter ${o} `+(u===!1?"is not supported by the environment":"is not available in the build"));let i=t?s.length>1?`since :
`+s.map(KL).join(`
`):" "+KL(s[0]):"as no adapter specified";throw new Yt("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:GE};function _2(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Lg(null,e)}function QL(e){return _2(e),e.headers=Gs.from(e.headers),e.data=S2.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),I6.getAdapter(e.adapter||Wb.adapter)(e).then(function(n){return _2(e),n.data=S2.call(e,e.transformResponse,n),n.headers=Gs.from(n.headers),n},function(n){return w6(n)||(_2(e),n&&n.response&&(n.response.data=S2.call(e,e.transformResponse,n.response),n.response.headers=Gs.from(n.response.headers))),Promise.reject(n)})}const E6="1.11.0",v_={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{v_[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const XL={};v_.transitional=function(t,r,n){function a(s,i){return"[Axios v"+E6+"] Transitional option '"+s+"'"+i+(n?". "+n:"")}return(s,i,o)=>{if(t===!1)throw new Yt(a(i," has been removed"+(r?" in "+r:"")),Yt.ERR_DEPRECATED);return r&&!XL[i]&&(XL[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,i,o):!0}};v_.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Dfe(e,t,r){if(typeof e!="object")throw new Yt("options must be an object",Yt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],i=t[s];if(i){const o=e[s],u=o===void 0||i(o,s,e);if(u!==!0)throw new Yt("option "+s+" must be "+u,Yt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Yt("Unknown option "+s,Yt.ERR_BAD_OPTION)}}const V1={assertOptions:Dfe,validators:v_},Lo=V1.validators;let Yd=class{constructor(t){this.defaults=t||{},this.interceptors={request:new BL,response:new BL}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=fh(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:s}=r;n!==void 0&&V1.assertOptions(n,{silentJSONParsing:Lo.transitional(Lo.boolean),forcedJSONParsing:Lo.transitional(Lo.boolean),clarifyTimeoutError:Lo.transitional(Lo.boolean)},!1),a!=null&&(_e.isFunction(a)?r.paramsSerializer={serialize:a}:V1.assertOptions(a,{encode:Lo.function,serialize:Lo.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),V1.assertOptions(r,{baseUrl:Lo.spelling("baseURL"),withXsrfToken:Lo.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=s&&_e.merge(s.common,s[r.method]);s&&_e.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=Gs.concat(i,s);const o=[];let u=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(u=u&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});const d=[];this.interceptors.response.forEach(function(m){d.push(m.fulfilled,m.rejected)});let c,h=0,p;if(!u){const g=[QL.bind(this),void 0];for(g.unshift(...o),g.push(...d),p=g.length,c=Promise.resolve(r);h<p;)c=c.then(g[h++],g[h++]);return c}p=o.length;let f=r;for(h=0;h<p;){const g=o[h++],m=o[h++];try{f=g(f)}catch(x){m.call(this,x);break}}try{c=QL.call(this,f)}catch(g){return Promise.reject(g)}for(h=0,p=d.length;h<p;)c=c.then(d[h++],d[h++]);return c}getUri(t){t=fh(this.defaults,t);const r=S6(t.baseURL,t.url,t.allowAbsoluteUrls);return y6(r,t.params,t.paramsSerializer)}};_e.forEach(["delete","get","head","options"],function(t){Yd.prototype[t]=function(r,n){return this.request(fh(n||{},{method:t,url:r,data:(n||{}).data}))}});_e.forEach(["post","put","patch"],function(t){function r(n){return function(s,i,o){return this.request(fh(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}Yd.prototype[t]=r(),Yd.prototype[t+"Form"]=r(!0)});let Mfe=class T6{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const i=new Promise(o=>{n.subscribe(o),s=o}).then(a);return i.cancel=function(){n.unsubscribe(s)},i},t(function(s,i,o){n.reason||(n.reason=new Lg(s,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new T6(function(a){t=a}),cancel:t}}};function Ffe(e){return function(r){return e.apply(null,r)}}function Ofe(e){return _e.isObject(e)&&e.isAxiosError===!0}const KE={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(KE).forEach(([e,t])=>{KE[t]=e});function j6(e){const t=new Yd(e),r=i6(Yd.prototype.request,t);return _e.extend(r,Yd.prototype,t,{allOwnKeys:!0}),_e.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return j6(fh(e,a))},r}const rn=j6(Wb);rn.Axios=Yd;rn.CanceledError=Lg;rn.CancelToken=Mfe;rn.isCancel=w6;rn.VERSION=E6;rn.toFormData=x_;rn.AxiosError=Yt;rn.Cancel=rn.CanceledError;rn.all=function(t){return Promise.all(t)};rn.spread=Ffe;rn.isAxiosError=Ofe;rn.mergeConfig=fh;rn.AxiosHeaders=Gs;rn.formToJSON=e=>b6(_e.isHTMLForm(e)?new FormData(e):e);rn.getAdapter=I6.getAdapter;rn.HttpStatusCode=KE;rn.default=rn;const{Axios:fot,AxiosError:mot,CanceledError:got,isCancel:xot,CancelToken:yot,VERSION:vot,all:bot,Cancel:wot,isAxiosError:Not,spread:Sot,toFormData:_ot,AxiosHeaders:kot,HttpStatusCode:Cot,formToJSON:Iot,getAdapter:Eot,mergeConfig:Tot}=rn,Le="https://dev-new-admissions.navgurukul.org/api/v1",A6=()=>sessionStorage.getItem("authToken"),Ke=(e=!0)=>{const t=A6();return t&&(t.startsWith("Bearer "),t.split(".").length),{...e?{"Content-Type":"application/json"}:{},...t?{Authorization:`Bearer ${t}`}:{}}},$6=async(e,t={})=>{const r=`${Le}${e}`,n=Ke(),a={...t,headers:{...n,...t.headers}};return fetch(r,a)},R6=async e=>{var n,a;const t=await fetch(`${Le}/users/login`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Login failed");if((n=r.data)!=null&&n.token){const s=r.data.token.startsWith("Bearer ")?r.data.token.substring(7):r.data.token;sessionStorage.setItem("authToken",s)}return(a=r.data)!=null&&a.user&&localStorage.setItem("user",JSON.stringify({...r.data.user,profile_pic:r.data.user.profile_pic||e.picture||""})),r},D6=async(e=1,t=10)=>{var s,i;const r=await fetch(`${Le}/users?page=${e}&limit=${t}`,{method:"GET",headers:Ke()}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to fetch users");return{users:(((s=n.data)==null?void 0:s.data)||[]).map(o=>({...o,role_id:o.user_role_id})),total:((i=n.data)==null?void 0:i.total)||0}},M6=()=>{try{const e=localStorage.getItem("user");if(!e)return"";const t=JSON.parse(e);return t.profile_pic||t.picture||""}catch{return""}},YA=()=>{try{const e=localStorage.getItem("user");return e?JSON.parse(e):null}catch{return null}},F6=async e=>{const t=await fetch(`${Le}/users/onboard`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to onboard user");return r},O6=async(e,t)=>{const r=await fetch(`${Le}/users/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update user");return n},P6=async e=>{const t=await fetch(`${Le}/users/${e}`,{method:"DELETE",headers:Ke(),body:JSON.stringify(e)});if(!t.ok){const r=await t.json(),n=new Error(r.message||"Failed to delete user");throw n.details=r.error||r.message,n}},H1=async e=>{const t=await fetch(`${Le}/users/search?q=${encodeURIComponent(e)}`,{method:"GET",headers:Ke()}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to search users");return r.data||[]},L6=async e=>{const t=new FormData;t.append("file",e);const r=Ke(!1),n={};r.Authorization&&(n.Authorization=r.Authorization);const a=await fetch(`${Le}/students/bulkUploadStudents`,{method:"POST",body:t,headers:n});if(!a.ok){const s=await a.text();throw new Error(`Upload failed: ${a.status} ${s}`)}return a.json()},z6=async e=>{const t=await fetch(`${Le}/students/deleteStudents/${e}`,{method:"DELETE",headers:Ke(),body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to delete student")}},B6=async e=>{const t=await fetch(`${Le}/roles/createRoles`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create role");return r.data},JA=async()=>{var r;const e=await fetch(`${Le}/roles/getRoles`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch roles");return((r=t.data)==null?void 0:r.data)||[]},U6=async(e,t)=>{const r=await fetch(`${Le}/roles/updateRole/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update role");return n.data??n},W6=async e=>{const t=Ke();t["Content-Type"]&&delete t["Content-Type"];const r=await fetch(`${Le}/roles/deleteRole/${e}`,{method:"DELETE",headers:t});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to delete role")}},V6=async e=>fetch(`${Le}/students/submit/learningRoundFeedback`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),H6=async(e,t)=>fetch(`${Le}/students/update/learningRoundFeedback/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),ZA=async e=>fetch(`${Le}/students/submit/screeningRoundFeedback`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),q6=async(e,t)=>fetch(`${Le}/students/update/screeningRoundFeedback/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),G6=async e=>fetch(`${Le}/students/submit/culturalFitRoundFeedback`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),K6=async(e,t)=>fetch(`${Le}/students/update/culturalFitRoundFeedback/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),to={learning:{submit:V6,update:H6},cultural:{submit:G6,update:K6},screening:{submit:ZA,update:q6}},e$=async e=>fetch(`${Le}/students/submit/finalDecision`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),Q6=async e=>fetch(`${Le}/slots/createSlots`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),b_=async(e,t)=>{const r=await fetch(`${Le}/slots/date/${e}/${t}`,{method:"GET",headers:Ke()}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to fetch slot");return n},X6=async(e,t)=>{const r=await fetch(`${Le}/slots/update/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update slot");return n},QE=()=>{sessionStorage.removeItem("authToken"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),localStorage.removeItem("googleUser"),localStorage.removeItem("roleAccess"),localStorage.removeItem("privileges")},Y6=async e=>{const t=await fetch(`${Le}/casts/createCast`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create cast");return r},Vb=async()=>{const e=await fetch(`${Le}/casts/getCasts`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch casts");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.castes&&Array.isArray(t.castes)?t.castes:Array.isArray(t)?t:[]},J6=async(e,t)=>{const r=await fetch(`${Le}/casts/updateCast/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update cast");return n},Z6=async e=>{const t=Ke();t["Content-Type"]&&delete t["Content-Type"];const r=await fetch(`${Le}/casts/deleteCast/${e}`,{method:"DELETE",headers:Ke(),body:JSON.stringify(e)});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to delete cast")}},eV=async e=>{const t=await fetch(`${Le}/religions/createReligion`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create religion");return r},Hb=async()=>{const e=await fetch(`${Le}/religions/getReligions`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch religions");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.religions&&Array.isArray(t.religions)?t.religions:Array.isArray(t)?t:[]},tV=async(e,t)=>{const r=await fetch(`${Le}/religions/updateReligion/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update religion");return n},rV=async()=>{const e=await fetch(`${Le}/donors/getDonors?page=1&pageSize=1000`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch donors");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:Array.isArray(t)?t:[]},nV=async e=>{const t=await fetch(`${Le}/religions/deleteReligion/${e}`,{method:"DELETE",headers:Ke()});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to delete religion")}},w_=async(e,t)=>{var i,o;const r=await $6(`/students/getStudents?page=${e}&limit=${t}`,{method:"GET",headers:Ke()}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to fetch students");const a=((i=n.data)==null?void 0:i.data)||[],s=((o=n.data)==null?void 0:o.pagination)||{};return{data:a,totalCount:Number(s.total)||a.length,totalPages:Number(s.totalPages)||Math.ceil(a.length/t),page:s.page||e,limit:s.limit||t}},XE=async e=>{var t,r;try{return(await rn.get(`${Le}/students/getStudentsById/${e}`)).data}catch(n){throw new Error(((r=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to fetch student")}},t$=async e=>{var t,r;try{return(await rn.get(`${Le}/students/getByEmail/${e}`)).data}catch(n){throw new Error(((r=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to fetch student")}},r$=async e=>{var t,r;try{return(await rn.get(`${Le}/students/getByEmail/${e}`)).data}catch(n){throw new Error(((r=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to fetch complete student data")}},Nm=async(e,t)=>{const r=await fetch(`${Le}/students/updateStudents/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to update student")}return r.json()},aV=async e=>{const t=await fetch(`${Le}/students/bulk-update`,{method:"PUT",headers:Ke(),body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to bulk update students")}return t.json()},qb=async()=>{const e=await fetch(`${Le}/qualifications/getQualifications`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch qualification");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.religions&&Array.isArray(t.religions)?t.religions:Array.isArray(t)?t:[]},n$=async()=>{const e=await fetch(`${Le}/current-statuses/currentallstatuses`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch statuses");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.statuses&&Array.isArray(t.statuses)?t.statuses:Array.isArray(t)?t:(console.error("Data structure:",JSON.stringify(t,null,2)),[])},a$=async e=>{var n;const t=await fetch(`${Le}/students/createStudent`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create student");if(((n=r==null?void 0:r.data)==null?void 0:n.error)===!0)throw new Error(r.data.message||"Validation failed");return r},Wl=async e=>{const t=new URLSearchParams(e).toString(),r=await fetch(`${Le}/students/filter?${t}`,{method:"GET",headers:Ke()}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to fetch statuses");return n&&n.data&&n.data.data&&Array.isArray(n.data.data)?n.data.data:n&&n.data&&Array.isArray(n.data)?n.data:n&&n.statuses&&Array.isArray(n.statuses)?n.statuses:Array.isArray(n)?n:(console.error("Data structure:",JSON.stringify(n,null,2)),[])},sV=async e=>{const t=await fetch(`${Le}/questions/submitExam`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to submit exam");return r},iV=async e=>{const t=await fetch(`${Le}/questions/createQuestions`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create questions");return r.data},oV=async()=>{const e=await fetch(`${Le}/questions/getQuestions`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch Questions");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.statuses&&Array.isArray(t.statuses)?t.statuses:Array.isArray(t)?t:(console.error("Data structure:",JSON.stringify(t,null,2)),[])},lV=async e=>{const t=await fetch(`${Le}/questions/deleteQuestions/${e}`,{method:"DELETE"});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to delete question")}},uV=async(e,t)=>{const r=await fetch(`${Le}/questions/updateQuestions/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update question");return n.data},N_=async()=>{const t=await(await fetch(`${Le}/questions/question-sets`,{method:"GET",headers:Ke()})).json();return Array.isArray(t.data)?t.data:[]},cV=async e=>{var t;try{return(await rn.post(`${Le}/questions/question-set-mappings`,e,{headers:{...Ke()}})).data}catch(r){throw console.error("Failed to create mappings:",((t=r.response)==null?void 0:t.data)||r.message),r}},dV=async(e="english",t)=>{var r,n;try{return((n=(r=(await rn.get(`${Le}/questions/random-for-test?student_id=${t}`,{headers:{...Ke()}})).data)==null?void 0:r.data)==null?void 0:n.map(i=>({id:i.id,question:i[`${e}_text`],options:i[`${e}_options`],difficulty_level:i.difficulty_level,answer:i.answer_key[0]})))||[]}catch(a){throw console.error("Error fetching questions:",a),a}},Yv=async e=>{try{const t=`${Le}/questions/set/${e}`;return(await rn.get(t)).data}catch(t){throw console.error(`Error fetching questions for set ${e}:`,t),t}},hV=async e=>{const t=await fetch(`${Le}/questions/question-set-mappings/remove/${e}`,{method:"DELETE"});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to delete question from set")}},BN=async e=>{const t=await fetch(`${Le}/questions/question-sets`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create question set");return r.data||r},pV=async(e,t)=>{const r=await fetch(`${Le}/questions/question-sets/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update question set");return n.data||n},fV=async e=>{const t=await fetch(`${Le}/questions/question-sets/${e}`,{method:"DELETE",headers:Ke(),body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to delete question set")}},mV=async e=>{const t=await fetch(`${Le}/questions/question-sets/${e}/set-default-online`,{method:"PUT",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to set default online question set");return r.data||r},gV=async(e,t)=>{let r=`${Le}/questions/download-pdf/${e}`;t&&t.toLowerCase()!=="english"&&(r+=`?language=${t.toLowerCase()}`);const n=await fetch(r,{method:"GET",headers:{...Ke(!1)}});if(!n.ok){const a=await n.json().catch(()=>({message:"Failed to download PDF"}));throw new Error(a.message||"Failed to download PDF")}return await n.blob()},xV=async e=>{const t=new Blob([e],{type:"text/csv"}),r=new File([t],"questions.csv",{type:"text/csv"}),n=new FormData;n.append("file",r),n.append("uploadType","bulk"),n.append("timestamp",new Date().toISOString());const s={...Ke()};delete s["Content-Type"],delete s["content-type"];const i=await fetch(`${Le}/questions/bulkUpload`,{method:"POST",headers:s,body:n}),o=await i.json();if(!i.ok)throw new Error(o.message||"Failed to upload questions");return o},s$=async()=>{const e=await fetch(`${Le}/stages/getStages`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch stages");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.stages&&Array.isArray(t.stages)?t.stages:Array.isArray(t)?t:[]},i$=async()=>{const e=await fetch(`${Le}/current-statuses/currentallstatuses`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch statuses");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:t&&t.statuses&&Array.isArray(t.statuses)?t.statuses:Array.isArray(t)?t:[]},Gb=async()=>{const t=await(await fetch(`${Le}/campuses/getCampuses`)).json();let r=[];return Array.isArray(t)?r=t:t.data&&Array.isArray(t.data)?r=t.data:t.data&&typeof t.data=="object"&&t.data.data&&Array.isArray(t.data.data)?r=t.data.data:t.data&&typeof t.data=="object"&&t.data.campuses&&Array.isArray(t.data.campuses)?r=t.data.campuses:t.data&&typeof t.data=="object"&&t.data.result&&Array.isArray(t.data.result)?r=t.data.result:t.campuses&&Array.isArray(t.campuses)?r=t.campuses:t.result&&Array.isArray(t.result)?r=t.result:r=[],r.map(n=>({id:n.id||n.campus_id,campus_name:n.campus_name||n.name||n.campusName||n.campus||""}))},yV=async e=>{const t=await fetch(`${Le}/campuses/getCampusById/${e}`,{method:"GET",headers:Ke()});if(!t.ok)throw new Error("Failed to fetch campus by ID");return t.json()},vV=async e=>{const t=await fetch(`${Le}/campuses/createCampus`,{method:"POST",headers:Ke(),body:JSON.stringify({campus_name:e})});if(!t.ok)throw await t.text(),new Error(`Failed to create campus: ${t.status} ${t.statusText}`);return t.json()},bV=async(e,t)=>{const r=await fetch(`${Le}/campuses/updateCampus/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify({campus_name:t})});if(!r.ok)throw new Error("Failed to update campus");return r.json()},wV=async e=>{var n;const t=await fetch(`${Le}/campuses/deleteCampus/${e}`,{method:"DELETE",headers:Ke(),body:JSON.stringify({id:e})}),r=await t.json();if((n=r.data)!=null&&n.error)throw new Error(r.data.details||r.data.error||"Failed to delete campus");if(!t.ok)throw new Error(r.message||r.error||"Failed to delete campus");return r},NV=async e=>{const t=await fetch(`${Le}/schools/createSchool`,{method:"POST",headers:Ke(),body:JSON.stringify({school_name:e})});if(!t.ok){const r=await t.text();throw new Error(`Failed to create school: ${t.status} ${t.statusText} - ${r}`)}return await t.json()},S_=async()=>{const t=await(await fetch(`${Le}/schools/getSchools`)).json();let r=[];return Array.isArray(t)?r=t:t.data&&Array.isArray(t.data)?r=t.data:t.data&&typeof t.data=="object"&&t.data.data&&Array.isArray(t.data.data)?r=t.data.data:t.data&&typeof t.data=="object"&&t.data.schools&&Array.isArray(t.data.schools)?r=t.data.schools:t.data&&typeof t.data=="object"&&t.data.result&&Array.isArray(t.data.result)?r=t.data.result:t.schools&&Array.isArray(t.schools)?r=t.schools:t.result&&Array.isArray(t.result)?r=t.result:r=[],r.map(n=>({id:n.id||n.school_id,school_name:n.school_name||n.name||n.schoolName||""}))},SV=async(e,t)=>{const r=await fetch(`${Le}/schools/updateSchool/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify({school_name:t})});if(!r.ok){const n=await r.text();throw new Error(`Failed to update school: ${r.status} ${r.statusText} - ${n}`)}return await r.json()},_V=async e=>{const t=await fetch(`${Le}/schools/deleteSchool/${e}`,{method:"DELETE",headers:Ke(),body:JSON.stringify(e)});if(!t.ok){const r=await t.json(),n=new Error((r==null?void 0:r.message)||"Failed to delete school");throw n.data=(r==null?void 0:r.data)||r,n.status=t.status,n}return await t.json()},zg=async()=>{const e=await fetch(`${Le}/states/getAll`,{method:"GET"});if(!e.ok)throw new Error("Failed to fetch states");return await e.json()},Hh=async e=>{const t=await fetch(`${Le}/states/getByState/${e}`,{method:"GET"});if(!t.ok)throw new Error(`Failed to fetch districts for ${e}`);return await t.json()},Kb=async e=>{const t=await fetch(`${Le}/districts/getByDistrict/${e}`,{method:"GET"});if(!t.ok)throw new Error(`Failed to fetch blocks for ${e}`);return await t.json()},kV=async e=>{try{const t=await fetch(`${Le}/stages/statuses/${e}`,{method:"GET"});if(!t.ok)throw new Error(`Failed to fetch statuses for stage ${e}`);const r=await t.json();return r!=null&&r.data&&Array.isArray(r.data)?r.data:Array.isArray(r)?r:r!=null&&r.statuses&&Array.isArray(r.statuses)?r.statuses:[]}catch(t){throw console.error("Error fetching statuses:",t),t}},o$=async e=>{const t=await fetch(`${Le}/students/search?search=${encodeURIComponent(e)}`,{method:"GET",headers:Ke()}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to search students");return r!=null&&r.data&&Array.isArray(r.data)?r.data:Array.isArray(r)?r:(console.error("Unexpected search API response:",r),[])},CV=async e=>{let t=`${Le}/slots/my-available-slots`;const r=Ke(),n=await fetch(t,{method:"GET",headers:r}),a=await n.text();let s;try{s=JSON.parse(a)}catch{throw new Error("Invalid response format from server")}if(!n.ok)throw n.status===401?(sessionStorage.removeItem("authToken"),localStorage.removeItem("user"),new Error("Session expired. Please login again.")):new Error(s.message||"Failed to fetch available slots");return s!=null&&s.data&&Array.isArray(s.data)?s.data:Array.isArray(s)?s:s!=null&&s.slots&&Array.isArray(s.slots)?s.slots:s},l$=async e=>{const t=Ke(),r=await fetch(`${Le}/interview-schedules/create`,{method:"POST",headers:t,body:JSON.stringify(e)}),n=await r.text();let a;try{a=JSON.parse(n)}catch{throw new Error("Invalid response format from server")}if(!r.ok)throw r.status===401?(sessionStorage.removeItem("authToken"),localStorage.removeItem("user"),new Error("Session expired. Please login again.")):new Error(a.message||"Failed to schedule interview");return a},q1=async e=>{let t=`${Le}/interview-schedules/`;e&&(t+=`?date=${e}`);const r=Ke(),n=await fetch(t,{method:"GET",headers:r}),a=await n.text();let s;try{s=JSON.parse(a)}catch{throw new Error("Invalid response format from server")}if(!n.ok)throw n.status===401?(sessionStorage.removeItem("authToken"),localStorage.removeItem("user"),new Error("Session expired. Please login again.")):new Error(s.message||"Failed to fetch scheduled interviews");return s!=null&&s.data&&Array.isArray(s.data)?s.data:Array.isArray(s)?s:s!=null&&s.interviews&&Array.isArray(s.interviews)?s.interviews:[]},IV=async(e,t)=>{const r=await fetch(`${Le}/interview-schedules/${e}/reschedule`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to reschedule interview");return n},EV=async e=>{const t=await fetch(`${Le}/slots/${e}`,{method:"DELETE",headers:Ke(),body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Cannot delete booked slots or past date slots")}},TV=async(e,t)=>{const r=await fetch(`${Le}/interview-schedules/${e}/cancel`,{method:"PUT",headers:Ke(),body:JSON.stringify({cancel_reason:t})});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to cancel interview")}},u$=async e=>{const t=new FormData;t.append("file",e);const r=await fetch(`${Le}/media/upload-profile`,{method:"POST",body:t}),n=await r.json();if(!r.ok||!n.success)throw new Error(n.message||"Failed to upload image");return n.data},jV=async e=>{const t=await fetch(`${Le}/students/sendBulkOfferLetters`,{method:"POST",headers:Ke(),body:JSON.stringify({student_ids:e})}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to send offer letters");return r},AV=async e=>{const t=new URLSearchParams;e.page&&t.append("page",e.page.toString()),e.pageSize&&t.append("pageSize",e.pageSize.toString()),e.slot_type&&t.append("slot_type",e.slot_type),e.date&&t.append("date",e.date),e.search&&t.append("search",e.search);const r=await fetch(`${Le}/interview-schedules/all?${t.toString()}`,{method:"GET",headers:Ke()}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to fetch interview schedules");return n},$V=async e=>{const t=new URLSearchParams;e.page&&t.append("page",e.page.toString()),e.pageSize&&t.append("pageSize",e.pageSize.toString()),e.slot_type&&t.append("slot_type",e.slot_type),e.date&&t.append("date",e.date),e.search&&t.append("search",e.search);const r=await fetch(`${Le}/slots/?${t.toString()}`,{method:"GET",headers:Ke()}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to fetch slots");return n},RV=async e=>{const t=await fetch(`${Le}/partners/createPartner`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create partner");return r},c$=async()=>{const e=await fetch(`${Le}/partners/getPartners`,{method:"GET",headers:Ke()}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch partners");return t&&t.data&&t.data.data&&Array.isArray(t.data.data)?t.data.data:t&&t.data&&Array.isArray(t.data)?t.data:(Array.isArray(t),t)},DV=async e=>{const t=await fetch(`${Le}/partners/getPartnerById/${e}`,{method:"GET",headers:Ke()}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to fetch partner");return r},MV=async(e,t)=>{const r=await fetch(`${Le}/partners/updatePartner/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update partner");return n},FV=async e=>{const t=Ke();t["Content-Type"]&&delete t["Content-Type"];const r=await fetch(`${Le}/partners/deletePartner/${e}`,{method:"DELETE",headers:t});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to delete partner")}},d$=async(e,t=1,r=10)=>{const n=await fetch(`${Le}/partners/getStudentsByPartnerId/${e}?page=${t}&pageSize=${r}`,{method:"GET",headers:Ke()}),a=await n.json();if(!n.ok)throw new Error(a.message||"Failed to fetch students by partner");return a},OV=async e=>{const t=await fetch(`${Le}/donors/createDonor`,{method:"POST",headers:Ke(),body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to create donor");return r},PV=async(e=1,t=10)=>{const r=await fetch(`${Le}/donors/getDonors?page=${e}&pageSize=${t}`,{method:"GET",headers:Ke()}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to fetch donors");return n},LV=async e=>{const t=await fetch(`${Le}/donors/getDonorById/${e}`,{method:"GET",headers:Ke()}),r=await t.json();if(!t.ok)throw new Error(r.message||"Failed to fetch donor");return r},zV=async(e,t)=>{const r=await fetch(`${Le}/donors/updateDonor/${e}`,{method:"PUT",headers:Ke(),body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to update donor");return n},BV=async e=>{const t=Ke();t["Content-Type"]&&delete t["Content-Type"];const r=await fetch(`${Le}/donors/deleteDonor/${e}`,{method:"DELETE",headers:t});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to delete donor")}},UV=async(e,t=1,r=10)=>{const n=await fetch(`${Le}/donors/getStudentsByDonorId/${e}?page=${t}&pageSize=${r}`,{method:"GET",headers:Ke()}),a=await n.json();if(!n.ok)throw new Error(a.message||"Failed to fetch students by donor");return a},Pfe=Object.freeze(Object.defineProperty({__proto__:null,API_MAP:to,apiRequest:$6,bulkUpdateStudents:aV,bulkUploadQuestions:xV,bulkUploadStudents:L6,cancelScheduledInterview:TV,createCampusApi:vV,createCast:Y6,createDonor:OV,createPartner:RV,createQuestion:iV,createQuestionSet:BN,createQuestionSetMappings:cV,createReligion:eV,createRole:B6,createSchool:NV,createSlotBookingTimes:Q6,createStudent:a$,createStudentExamSubmission:sV,deleteCampusApi:wV,deleteCast:Z6,deleteDonor:BV,deleteInterviewSlot:EV,deletePartner:FV,deleteQuestionFromSet:hV,deleteQuestionSet:fV,deleteQuestionbyId:lV,deleteReligion:nV,deleteRole:W6,deleteSchool:_V,deleteStudent:z6,deleteUser:P6,downloadQuestionSetPDF:gV,getAllCasts:Vb,getAllDonors:rV,getAllInterviewSchedules:AV,getAllQualification:qb,getAllQuestionSets:N_,getAllReligions:Hb,getAllRolesNew:JA,getAllSchools:S_,getAllSlots:$V,getAllStages:s$,getAllStates:zg,getAllStatus:n$,getAllStatuses:i$,getAllUsers:D6,getAuthHeaders:Ke,getAuthToken:A6,getBlocksByDistrict:Kb,getCampusById:yV,getCampusesApi:Gb,getCompleteStudentData:r$,getCurrentUser:YA,getDistrictsByState:Hh,getDonorById:LV,getDonors:PV,getFilterStudent:Wl,getMyAvailableSlots:CV,getPartnerById:DV,getPartners:c$,getQuestions:oV,getQuestionsBySetType:Yv,getRandomQuestions:dV,getScheduledInterviews:q1,getSlotByDate:b_,getStatusesByStageId:kV,getStudentById:XE,getStudentDataByEmail:t$,getStudents:w_,getStudentsByDonorId:UV,getStudentsByPartnerId:d$,getUserProfileImage:M6,loginWithGoogle:R6,logoutUser:QE,onboardUser:F6,scheduleInterview:l$,searchStudentsApi:o$,searchUsers:H1,sendBulkOfferLetters:jV,setDefaultOnlineQuestionSet:mV,submitCulturalFit:G6,submitFinalDecision:e$,submitLearningRound:V6,submitScreeningRound:ZA,updateCampusApi:bV,updateCast:J6,updateCulturalFit:K6,updateDonor:zV,updateLearningRound:H6,updatePartner:MV,updateQuestion:uV,updateQuestionSet:pV,updateReligion:tV,updateRole:U6,updateScheduledInterview:IV,updateSchool:SV,updateScreeningRound:q6,updateSlot:X6,updateStudent:Nm,updateUser:O6,uploadProfileImage:u$},Symbol.toStringTag,{value:"Module"})),ut=e=>{var s,i,o;if(!e)return"An unexpected error occurred.";if(typeof e=="string")return e;let t=((i=(s=e.response)==null?void 0:s.data)==null?void 0:i.message)||e.message||"Something went wrong.";const r=(o=e.response)==null?void 0:o.status;if(r===400)return t.toLowerCase().includes("validation")?"Some information seems incorrect. Please review and try again.":`Request Issue: ${t}`;if(r===401)return"Session expired. Please log in again.";if(r===403)return"Access Denied. You do not have permission to perform this action.";if(r===404)return"We couldnt find the requested information.";if(r===500)return"Server Error. Something went wrong on our end. Please try again later.";if(r===502)return"Connection Error. The server is temporarily unreachable. Please try again in a moment.";if(r===503)return"Service Unavailable. The server is temporarily busy. Please try again in a few moments.";if(t.toLowerCase().includes("network error")||t.toLowerCase().includes("failed to fetch"))return"Network Error. Please check your internet connection and try again.";const n={"operation completed":"The operation finished, but check for any warnings.","constraint check failed":"This action cannot be completed because it conflicts with other data (e.g., duplicates).","foreign key constraint":"This item is currently formatted or being used elsewhere and cannot be modified/deleted.","unique constraint":"This item already exists. Please try a different name or value."},a=t.toLowerCase();for(const[u,d]of Object.entries(n))if(a.includes(u))return d;return t},Lfe="654022633429-fv4rgcs654a0f9r0464tl6o8jvjk3dco.apps.googleusercontent.com",Do=e=>{const t=Rn(),[r,n]=w.useState({user:null,loading:!0,isAuthenticated:!1}),{toast:a}=Wt(),s=(e==null?void 0:e.skipAutoNavigation)||!1;w.useEffect(()=>{const p=()=>{if(document.querySelector('script[src="https://accounts.google.com/gsi/client"]')){window.google&&f();return}const g=document.createElement("script");g.src="https://accounts.google.com/gsi/client",g.async=!0,g.defer=!0,document.head.appendChild(g),g.onload=()=>{f()},g.onerror=()=>{console.error("Failed to load Google OAuth script"),n({user:null,loading:!1,isAuthenticated:!1})}},f=()=>{if(window.google)try{window.google.accounts.id.initialize({client_id:Lfe,callback:o,auto_select:!1,cancel_on_tap_outside:!0}),i()}catch(g){console.error("Error initializing Google OAuth:",g),n({user:null,loading:!1,isAuthenticated:!1})}};p()},[]);const i=()=>{const p=localStorage.getItem("user"),f=sessionStorage.getItem("authToken");if(p&&f)try{const g=JSON.parse(p),m={id:g.id.toString(),email:g.email,name:g.name,avatar:g.profile_pic||"",provider:"google",role_id:g.user_role_id,role:g.role,role_name:g.role_name,profile_pic:g.profile_pic};n({user:m,isAuthenticated:!0,loading:!1})}catch(g){console.error("Error parsing stored user:",g),localStorage.removeItem("user"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),n({user:null,loading:!1,isAuthenticated:!1})}else n({user:null,loading:!1,isAuthenticated:!1})},o=async p=>{try{n(y=>({...y,loading:!0}));const f=JSON.parse(atob(p.credential.split(".")[1])),g=p.credential;sessionStorage.setItem("google_credential",g);const m={iss:f.iss,aud:f.aud,sub:f.sub,email:f.email,email_verified:f.email_verified||!0,name:f.name,iat:f.iat,exp:f.exp,picture:f.picture},x=await R6(m);if(x.success&&x.data){const{user:y,token:v}=x.data;v&&v!=="undefined"&&sessionStorage.setItem("authToken",v),localStorage.setItem("user",JSON.stringify(y)),y.role_name&&localStorage.setItem("userRole",JSON.stringify(y.role_name));const b={id:y.id.toString(),email:y.email,name:y.name,avatar:y.profile_pic||f.picture||"",provider:"google",role_id:y.user_role_id,role_name:y.role_name,profile_pic:y.profile_pic};n({user:b,loading:!1,isAuthenticated:!0}),s||(y.role_name==="ADMIN"||y.role_name==="USER"?(localStorage.setItem("userRole",JSON.stringify(y.role_name)),t("/"),a({title:" Welcome!",description:`Successfully signed in as ${y.name}`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})):(localStorage.setItem("userRole",JSON.stringify("student")),t("/students"),a({title:" No Role Assigned",description:"No role assigned. Please contact admin to assign a role.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"})))}else throw new Error(x.message||"Login failed")}catch(f){console.error("Login error:",f),n({user:null,loading:!1,isAuthenticated:!1}),a({title:" Sign In Failed",description:ut(f),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},u=()=>{if(window.google)try{window.google.accounts.id.disableAutoSelect()}catch(p){console.error("Error disabling Google auto select:",p)}localStorage.removeItem("authToken"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),localStorage.removeItem("googleUser"),localStorage.removeItem("roleAccess"),n({user:null,loading:!1,isAuthenticated:!1}),a({title:" Signed Out",description:"You have been successfully signed out.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})},d=w.useCallback(p=>{if(window.google)try{const f=document.getElementById(p);f&&window.google.accounts.id.renderButton(f,{theme:"outline",size:"large",text:"continue_with",shape:"rectangular",width:250})}catch(f){console.error("Error rendering Google button:",f)}},[]),c=()=>{var p,f;return((f=(p=r.user)==null?void 0:p.role)==null?void 0:f.name)||null};return{...r,signOut:u,renderGoogleSignInButton:d,getUserRole:c,hasRole:p=>{const f=c();return f?f.toLowerCase()===p.toLowerCase():!1}}},Ay=10,WV=()=>{var Z;const[e,t]=w.useState([]),[r,n]=w.useState([]),[a,s]=w.useState(!1),[i,o]=w.useState(1),[u,d]=w.useState(1),[c,h]=w.useState(0),[p,f]=w.useState(""),[g,m]=w.useState([]),[x,y]=w.useState(!1),[v,b]=w.useState(""),[N,S]=w.useState(""),[_,C]=w.useState(""),[k,I]=w.useState(""),{toast:T}=Wt(),[j,E]=w.useState({open:!1,userId:null,userName:""}),[O,M]=w.useState({open:!1,data:null}),[W,q]=w.useState({open:!1,email:"",name:"",phone:"",username:"",selectedRoleId:"",editId:null,user_role_id:void 0}),P=async(Q=i)=>{s(!0);try{const U=await D6(Q,Ay),F=(U==null?void 0:U.users)||[],te=(U==null?void 0:U.total)||0;t(F),h(te),d(Math.ceil(te/Ay))}catch(U){console.error("Error fetching users:",U),t([])}finally{s(!1)}},A=async()=>{try{const Q=await JA();n(Q)}catch(Q){console.error("Error fetching roles:",Q),n([])}};w.useEffect(()=>{p.trim()||P(i)},[i,p]),w.useEffect(()=>{A()},[]),w.useEffect(()=>{if(!p.trim()){m([]),y(!1);return}const Q=setTimeout(async()=>{try{y(!0);const U=await H1(p.trim());m(U||[])}catch(U){console.error("Error searching users:",U),m([])}finally{y(!1)}},500);return()=>clearTimeout(Q)},[p]),w.useEffect(()=>{o(1)},[p]);const L=async Q=>{var fe,Me;Q.preventDefault();const U=W.name.trim();if(!/^[A-Za-z\s'-]+$/.test(U)){S("Name can only contain letters, spaces."),T({title:" Invalid Name",description:"Name can only contain letters, spaces, apostrophes, and hyphens.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(S(""),!/^\d{10}$/.test(W.phone.trim())){b("Phone number must be exactly 10 digits"),T({title:" Invalid Phone",description:"Phone number must be exactly 10 digits.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}b("");const F=W.email.trim();if(!F){C("Email is required"),T({title:" Email Required",description:"Please enter an email address.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(F)){C("Please enter a valid email address"),T({title:" Invalid Email",description:"Please enter a valid email address.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}C("");const pe=W.username.trim();if(pe&&!/^[A-Za-z0-9_]+$/.test(pe)){I("Username can only contain letters, numbers, and underscores"),T({title:" Invalid Username",description:"Username can only contain letters, numbers, and underscores.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(I(""),!W.selectedRoleId){T({title:" Role Required",description:"Please select a role for the user.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const ve={name:U,mobile:W.phone.trim(),email:F,mail_id:F,user_role_id:parseInt(W.selectedRoleId)};if(pe&&(ve.user_name=pe),W.editId){M({open:!0,data:ve});return}try{await F6(ve),p.trim()&&(f(""),m([])),o(1),T({title:" User Created",description:`Successfully created user ${ve.name}`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),$()}catch(je){console.error("Error saving user:",je),((je==null?void 0:je.error)||((Me=(fe=je==null?void 0:je.response)==null?void 0:fe.data)==null?void 0:Me.error)||(je==null?void 0:je.message)||"Failed to create user.").toLowerCase().includes("already exists")?(C("User with this email already exists"),T({title:" User Already Exists",description:"This email is already registered. Please use a different email.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"})):T({title:" Unable to Create User",description:ut(je),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},z=()=>q({open:!0,email:"",name:"",phone:"",username:"",selectedRoleId:"",editId:null}),$=()=>q({open:!1,email:"",name:"",phone:"",username:"",selectedRoleId:"",editId:null}),V=(Q,U)=>{E({open:!0,userId:Q,userName:U})},B=async()=>{if(j.userId)try{if(await P6(j.userId.toString()),p.trim()){const Q=await H1(p.trim());m(Q||[])}else await P(i);T({title:" User Deleted",description:"User has been successfully deleted.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),E({open:!1,userId:null,userName:""})}catch(Q){console.error("Error deleting user:",Q),T({title:" Unable to Delete User",description:ut(Q),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),E({open:!1,userId:null,userName:""})}},Y=async()=>{var Q,U,F,te,pe,ve;if(!(!O.data||!W.editId))try{if(await O6(W.editId.toString(),O.data),p.trim()){const fe=await H1(p.trim());m(fe||[])}else await P(i);T({title:" User Updated",description:`Successfully updated ${O.data.name}`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),M({open:!1,data:null}),$()}catch(fe){console.error("Error updating user:",fe),fe!=null&&fe.error||(U=(Q=fe==null?void 0:fe.response)==null?void 0:Q.data)!=null&&U.error||(te=(F=fe==null?void 0:fe.response)==null?void 0:F.data)!=null&&te.message||(pe=fe==null?void 0:fe.data)!=null&&pe.error||(ve=fe==null?void 0:fe.data)!=null&&ve.message||fe!=null&&fe.message,T({title:" Unable to Update User",description:ut(fe),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),M({open:!1,data:null})}},re=Q=>{const U=r.find(F=>F.id===Q);return U?U.name:`Role ${Q}`},ae=p.trim()?g:e,K=p.trim()?ae.slice((i-1)*Ay,i*Ay):e,J=p.trim()?Math.ceil(ae.length/Ay):u;return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("div",{className:"md:pl-64",children:l.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:l.jsx(yo,{className:"h-6 w-6 text-orange-600"})}),"User Management"]}),l.jsx("p",{className:"text-gray-600 mt-1",children:p?`${ae.length} users found (search)`:"Manage system users and their roles"})]}),l.jsxs("button",{onClick:z,className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2.5 rounded-lg flex items-center gap-2 transition-colors duration-200 shadow-sm hover:shadow-md",children:[l.jsx(Wn,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Add User"}),l.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),l.jsxs("div",{className:"mt-4 relative",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Ja,{className:"h-4 w-4 text-gray-400"})}),l.jsx("input",{type:"text",placeholder:"Search users by name, email, or username...",value:p,onChange:Q=>f(Q.target.value),className:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-orange-500 focus:border-orange-500"}),p&&l.jsx("button",{onClick:()=>f(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:l.jsx(wa,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[l.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(yo,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),l.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:p.trim()?ae.length:c})]})]})}),l.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(O1,{className:"h-5 w-5 text-green-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Roles"}),l.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:r.length})]})]})}),l.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:l.jsx(Ja,{className:"h-5 w-5 text-orange-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Search Results"}),l.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:ae.length})]})]})})]}),a||x?l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12",children:l.jsxs("div",{className:"flex flex-col items-center justify-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"}),l.jsx("div",{className:"text-lg text-gray-600 mt-4",children:x?"Searching users...":"Loading users..."})]})}):l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[l.jsx("div",{className:"hidden md:block overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"User"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Contact"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Username"}),l.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Role"}),l.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(Q=>l.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"h-10 w-10 bg-orange-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-orange-600 font-semibold text-sm",children:Q.name.charAt(0).toUpperCase()})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:Q.name}),l.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[l.jsx(uh,{className:"h-3 w-3"}),Q.email]})]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-1",children:[l.jsx(wE,{className:"h-3 w-3"}),Q.mobile||"-"]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("div",{className:"text-sm text-gray-900",children:Q.user_name||"-"})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[l.jsx(O1,{className:"h-3 w-3 mr-1"}),re(Q.user_role_id)]})}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx("button",{onClick:()=>{var U;return q({open:!0,name:Q.name,email:Q.email,username:Q.user_name||"",phone:Q.mobile||"",selectedRoleId:((U=Q.user_role_id)==null?void 0:U.toString())||"",editId:Q.id})},className:"p-2 text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded-lg transition-colors duration-200",title:"Edit User",children:l.jsx(ru,{size:16})}),l.jsx("button",{onClick:()=>V(Q.id,Q.name),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Delete User",children:l.jsx(ka,{size:16})})]})})]},Q.id))})]})}),l.jsx("div",{className:"md:hidden divide-y divide-gray-200",children:K.map(Q=>l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[l.jsx("div",{className:"h-12 w-12 bg-orange-100 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-orange-600 font-semibold",children:Q.name.charAt(0).toUpperCase()})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:Q.name}),l.jsxs("p",{className:"text-sm text-gray-500 truncate flex items-center gap-1",children:[l.jsx(uh,{className:"h-3 w-3"}),Q.email]}),l.jsxs("div",{className:"mt-1 flex items-center gap-4 text-xs text-gray-500",children:[Q.mobile&&l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(wE,{className:"h-3 w-3"}),Q.mobile]}),l.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[l.jsx(O1,{className:"h-3 w-3 mr-1"}),re(Q.user_role_id)]})]})]})]}),l.jsxs("div",{className:"flex gap-2 ml-2",children:[l.jsx("button",{onClick:()=>{var U;return q({open:!0,name:Q.name,email:Q.email,username:Q.user_name||"",phone:Q.mobile||"",selectedRoleId:((U=Q.user_role_id)==null?void 0:U.toString())||"",editId:Q.id})},className:"p-2 text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded-lg transition-colors duration-200",children:l.jsx(ru,{size:16})}),l.jsx("button",{onClick:()=>V(Q.id,Q.name),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-200",children:l.jsx(ka,{size:16})})]})]})},Q.id))}),ae.length===0&&l.jsxs("div",{className:"p-12 text-center",children:[l.jsx(yo,{className:"mx-auto h-12 w-12 text-gray-400"}),l.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No users found"}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:p?"Try adjusting your search criteria.":"Get started by adding a new user."})]})]}),J>1&&l.jsx("div",{className:"flex justify-center mt-6",children:l.jsx("nav",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>o(Q=>Math.max(1,Q-1)),disabled:i===1,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${i===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-orange-50 hover:text-orange-600"}`,children:"Previous"}),l.jsx("div",{className:"flex gap-1 mx-2",children:[...Array(J)].map((Q,U)=>l.jsx("button",{onClick:()=>o(U+1),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${i===U+1?"bg-orange-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-orange-50 hover:text-orange-600"}`,children:U+1},U))}),l.jsx("button",{onClick:()=>o(Q=>Math.min(J,Q+1)),disabled:i===J,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${i===J?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-orange-50 hover:text-orange-600"}`,children:"Next"})]})})}),W.open&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:W.editId?"Edit User":"Add New User"}),l.jsx("button",{onClick:$,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:l.jsx(wa,{className:"h-5 w-5 text-gray-500"})})]}),l.jsxs("form",{onSubmit:L,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),l.jsx("input",{type:"text",required:!0,value:W.name,onChange:Q=>{const F=Q.target.value.replace(/[0-9]/g,"");q(te=>({...te,name:F})),S("")},className:`w-full px-3 py-2.5 border rounded-lg focus:ring-2 transition-colors duration-200 ${N?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-orange-500 focus:border-orange-500"}`,placeholder:"Enter full name"}),N&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:N})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),l.jsx("input",{type:"email",required:!0,value:W.email,onChange:Q=>{const U=Q.target.value;q(te=>({...te,email:U})),U?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(U)?C(""):C("Please enter a valid email address"):C("Email is required")},onBlur:()=>{const Q=W.email.trim();Q?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Q)?C(""):C("Please enter a valid email address"):C("Email is required")},disabled:!!W.editId,className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter email address"}),_&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:_})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),l.jsx("input",{type:"tel",required:!0,value:W.phone,onChange:Q=>{const U=Q.target.value;/^\d{0,10}$/.test(U)&&(q(F=>({...F,phone:U})),b(""))},onKeyPress:Q=>{/[0-9]/.test(Q.key)||Q.preventDefault()},className:`w-full px-3 py-2.5 border rounded-lg focus:ring-2 transition-colors duration-200 ${v?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-orange-500 focus:border-orange-500"}`,placeholder:"Enter 10-digit phone number",maxLength:10}),v&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:v})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),l.jsx("input",{type:"text",value:W.username,onChange:Q=>{const U=Q.target.value;q(F=>({...F,username:U})),U&&!/^[A-Za-z0-9_]+$/.test(U)?I("Username can only contain letters, numbers, and underscores"):I("")},onBlur:()=>{const Q=W.username.trim();Q&&!/^[A-Za-z0-9_]+$/.test(Q)?I("Username can only contain letters, numbers, and underscores"):I("")},className:`w-full px-3 py-2.5 border rounded-lg focus:ring-2 transition-colors duration-200 ${k?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-orange-500 focus:border-orange-500"}`,placeholder:"Enter username (optional)"}),k&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:k})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),l.jsxs("select",{required:!0,value:W.selectedRoleId,onChange:Q=>q(U=>({...U,selectedRoleId:Q.target.value})),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200",children:[l.jsx("option",{value:"",disabled:!0,children:"Select a role"}),r.map(Q=>l.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),l.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-4 border-t border-gray-200",children:[l.jsx("button",{type:"button",onClick:$,className:"px-4 py-2.5 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-4 py-2.5 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors duration-200 shadow-sm hover:shadow-md",children:W.editId?"Update User":"Create User"})]})]})]})}),j.open&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Confirm Delete"}),l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to delete"," ",l.jsx("strong",{children:j.userName}),"? This action cannot be retrieved."]})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:()=>E({open:!1,userId:null,userName:""}),className:"px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),l.jsx("button",{onClick:B,className:"px-4 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:"Delete"})]})]})}),O.open&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Confirm Update"}),l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to update"," ",l.jsx("strong",{children:(Z=O.data)==null?void 0:Z.name}),"?"]})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:()=>M({open:!1,data:null}),className:"px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),l.jsx("button",{onClick:Y,className:"px-4 py-2.5 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors duration-200",children:"Update"})]})]})})]})})})]})},Et=w.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ue("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Et.displayName="Card";const Pt=w.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ue("flex flex-col space-y-1.5 p-6",e),...t}));Pt.displayName="CardHeader";const Lt=w.forwardRef(({className:e,...t},r)=>l.jsx("h3",{ref:r,className:Ue("text-2xl font-semibold leading-none tracking-tight",e),...t}));Lt.displayName="CardTitle";const xi=w.forwardRef(({className:e,...t},r)=>l.jsx("p",{ref:r,className:Ue("text-sm text-muted-foreground",e),...t}));xi.displayName="CardDescription";const jt=w.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ue("p-6 pt-0",e),...t}));jt.displayName="CardContent";const zfe=w.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ue("flex items-center p-6 pt-0",e),...t}));zfe.displayName="CardFooter";const Bfe=Mb("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Kn({className:e,variant:t,...r}){return l.jsx("div",{className:Ue(Bfe({variant:t}),e),...r})}var Ufe=w.createContext(void 0);function Bg(e){const t=w.useContext(Ufe);return e||t||"ltr"}var k2="rovingFocusGroup.onEntryFocus",Wfe={bubbles:!1,cancelable:!0},Qb="RovingFocusGroup",[YE,VV,Vfe]=t_(Qb),[Hfe,Ug]=Ia(Qb,[Vfe]),[qfe,Gfe]=Hfe(Qb),HV=w.forwardRef((e,t)=>l.jsx(YE.Provider,{scope:e.__scopeRovingFocusGroup,children:l.jsx(YE.Slot,{scope:e.__scopeRovingFocusGroup,children:l.jsx(Kfe,{...e,ref:t})})}));HV.displayName=Qb;var Kfe=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:u,onEntryFocus:d,preventScrollOnEntryFocus:c=!1,...h}=e,p=w.useRef(null),f=Bt(t,p),g=Bg(s),[m,x]=So({prop:i,defaultProp:o??null,onChange:u,caller:Qb}),[y,v]=w.useState(!1),b=$n(d),N=VV(r),S=w.useRef(!1),[_,C]=w.useState(0);return w.useEffect(()=>{const k=p.current;if(k)return k.addEventListener(k2,b),()=>k.removeEventListener(k2,b)},[b]),l.jsx(qfe,{scope:r,orientation:n,dir:g,loop:a,currentTabStopId:m,onItemFocus:w.useCallback(k=>x(k),[x]),onItemShiftTab:w.useCallback(()=>v(!0),[]),onFocusableItemAdd:w.useCallback(()=>C(k=>k+1),[]),onFocusableItemRemove:w.useCallback(()=>C(k=>k-1),[]),children:l.jsx(at.div,{tabIndex:y||_===0?-1:0,"data-orientation":n,...h,ref:f,style:{outline:"none",...e.style},onMouseDown:ze(e.onMouseDown,()=>{S.current=!0}),onFocus:ze(e.onFocus,k=>{const I=!S.current;if(k.target===k.currentTarget&&I&&!y){const T=new CustomEvent(k2,Wfe);if(k.currentTarget.dispatchEvent(T),!T.defaultPrevented){const j=N().filter(q=>q.focusable),E=j.find(q=>q.active),O=j.find(q=>q.id===m),W=[E,O,...j].filter(Boolean).map(q=>q.ref.current);KV(W,c)}}S.current=!1}),onBlur:ze(e.onBlur,()=>v(!1))})})}),qV="RovingFocusGroupItem",GV=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:s,children:i,...o}=e,u=_a(),d=s||u,c=Gfe(qV,r),h=c.currentTabStopId===d,p=VV(r),{onFocusableItemAdd:f,onFocusableItemRemove:g,currentTabStopId:m}=c;return w.useEffect(()=>{if(n)return f(),()=>g()},[n,f,g]),l.jsx(YE.ItemSlot,{scope:r,id:d,focusable:n,active:a,children:l.jsx(at.span,{tabIndex:h?0:-1,"data-orientation":c.orientation,...o,ref:t,onMouseDown:ze(e.onMouseDown,x=>{n?c.onItemFocus(d):x.preventDefault()}),onFocus:ze(e.onFocus,()=>c.onItemFocus(d)),onKeyDown:ze(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){c.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const y=Yfe(x,c.orientation,c.dir);if(y!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let b=p().filter(N=>N.focusable).map(N=>N.ref.current);if(y==="last")b.reverse();else if(y==="prev"||y==="next"){y==="prev"&&b.reverse();const N=b.indexOf(x.currentTarget);b=c.loop?Jfe(b,N+1):b.slice(N+1)}setTimeout(()=>KV(b))}}),children:typeof i=="function"?i({isCurrentTabStop:h,hasTabStop:m!=null}):i})})});GV.displayName=qV;var Qfe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Xfe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Yfe(e,t,r){const n=Xfe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Qfe[n]}function KV(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function Jfe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var h$=HV,p$=GV,__="Tabs",[Zfe,jot]=Ia(__,[Ug]),QV=Ug(),[eme,f$]=Zfe(__),XV=w.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:s,orientation:i="horizontal",dir:o,activationMode:u="automatic",...d}=e,c=Bg(o),[h,p]=So({prop:n,onChange:a,defaultProp:s??"",caller:__});return l.jsx(eme,{scope:r,baseId:_a(),value:h,onValueChange:p,orientation:i,dir:c,activationMode:u,children:l.jsx(at.div,{dir:c,"data-orientation":i,...d,ref:t})})});XV.displayName=__;var YV="TabsList",JV=w.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,s=f$(YV,r),i=QV(r);return l.jsx(h$,{asChild:!0,...i,orientation:s.orientation,dir:s.dir,loop:n,children:l.jsx(at.div,{role:"tablist","aria-orientation":s.orientation,...a,ref:t})})});JV.displayName=YV;var ZV="TabsTrigger",eH=w.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...s}=e,i=f$(ZV,r),o=QV(r),u=nH(i.baseId,n),d=aH(i.baseId,n),c=n===i.value;return l.jsx(p$,{asChild:!0,...o,focusable:!a,active:c,children:l.jsx(at.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":d,"data-state":c?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:u,...s,ref:t,onMouseDown:ze(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?i.onValueChange(n):h.preventDefault()}),onKeyDown:ze(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&i.onValueChange(n)}),onFocus:ze(e.onFocus,()=>{const h=i.activationMode!=="manual";!c&&!a&&h&&i.onValueChange(n)})})})});eH.displayName=ZV;var tH="TabsContent",rH=w.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:s,...i}=e,o=f$(tH,r),u=nH(o.baseId,n),d=aH(o.baseId,n),c=n===o.value,h=w.useRef(c);return w.useEffect(()=>{const p=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(p)},[]),l.jsx(fa,{present:a||c,children:({present:p})=>l.jsx(at.div,{"data-state":c?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":u,hidden:!p,id:d,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:p&&s})})});rH.displayName=tH;function nH(e,t){return`${e}-trigger-${t}`}function aH(e,t){return`${e}-content-${t}`}var tme=XV,sH=JV,iH=eH,oH=rH;const k_=tme,Xb=w.forwardRef(({className:e,...t},r)=>l.jsx(sH,{ref:r,className:Ue("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Xb.displayName=sH.displayName;const Pi=w.forwardRef(({className:e,...t},r)=>l.jsx(iH,{ref:r,className:Ue("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Pi.displayName=iH.displayName;const Li=w.forwardRef(({className:e,...t},r)=>l.jsx(oH,{ref:r,className:Ue("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Li.displayName=oH.displayName;function JE(e,[t,r]){return Math.min(r,Math.max(t,e))}var C2=0;function C_(){w.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??YL()),document.body.insertAdjacentElement("beforeend",e[1]??YL()),C2++,()=>{C2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),C2--}},[])}function YL(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var I2="focusScope.autoFocusOnMount",E2="focusScope.autoFocusOnUnmount",JL={bubbles:!1,cancelable:!0},rme="FocusScope",Yb=w.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:s,...i}=e,[o,u]=w.useState(null),d=$n(a),c=$n(s),h=w.useRef(null),p=Bt(t,m=>u(m)),f=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let m=function(b){if(f.paused||!o)return;const N=b.target;o.contains(N)?h.current=N:Eu(h.current,{select:!0})},x=function(b){if(f.paused||!o)return;const N=b.relatedTarget;N!==null&&(o.contains(N)||Eu(h.current,{select:!0}))},y=function(b){if(document.activeElement===document.body)for(const S of b)S.removedNodes.length>0&&Eu(o)};document.addEventListener("focusin",m),document.addEventListener("focusout",x);const v=new MutationObserver(y);return o&&v.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",x),v.disconnect()}}},[n,o,f.paused]),w.useEffect(()=>{if(o){e3.add(f);const m=document.activeElement;if(!o.contains(m)){const y=new CustomEvent(I2,JL);o.addEventListener(I2,d),o.dispatchEvent(y),y.defaultPrevented||(nme(lme(lH(o)),{select:!0}),document.activeElement===m&&Eu(o))}return()=>{o.removeEventListener(I2,d),setTimeout(()=>{const y=new CustomEvent(E2,JL);o.addEventListener(E2,c),o.dispatchEvent(y),y.defaultPrevented||Eu(m??document.body,{select:!0}),o.removeEventListener(E2,c),e3.remove(f)},0)}}},[o,d,c,f]);const g=w.useCallback(m=>{if(!r&&!n||f.paused)return;const x=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,y=document.activeElement;if(x&&y){const v=m.currentTarget,[b,N]=ame(v);b&&N?!m.shiftKey&&y===N?(m.preventDefault(),r&&Eu(b,{select:!0})):m.shiftKey&&y===b&&(m.preventDefault(),r&&Eu(N,{select:!0})):y===v&&m.preventDefault()}},[r,n,f.paused]);return l.jsx(at.div,{tabIndex:-1,...i,ref:p,onKeyDown:g})});Yb.displayName=rme;function nme(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Eu(n,{select:t}),document.activeElement!==r)return}function ame(e){const t=lH(e),r=ZL(t,e),n=ZL(t.reverse(),e);return[r,n]}function lH(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function ZL(e,t){for(const r of e)if(!sme(r,{upTo:t}))return r}function sme(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function ime(e){return e instanceof HTMLInputElement&&"select"in e}function Eu(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&ime(e)&&t&&e.select()}}var e3=ome();function ome(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=t3(e,t),e.unshift(t)},remove(t){var r;e=t3(e,t),(r=e[0])==null||r.resume()}}}function t3(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function lme(e){return e.filter(t=>t.tagName!=="A")}function m$(e){const t=w.useRef({value:e,previous:e});return w.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var ume=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Af=new WeakMap,Jw=new WeakMap,Zw={},T2=0,uH=function(e){return e&&(e.host||uH(e.parentNode))},cme=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=uH(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},dme=function(e,t,r,n){var a=cme(t,Array.isArray(e)?e:[e]);Zw[r]||(Zw[r]=new WeakMap);var s=Zw[r],i=[],o=new Set,u=new Set(a),d=function(h){!h||o.has(h)||(o.add(h),d(h.parentNode))};a.forEach(d);var c=function(h){!h||u.has(h)||Array.prototype.forEach.call(h.children,function(p){if(o.has(p))c(p);else try{var f=p.getAttribute(n),g=f!==null&&f!=="false",m=(Af.get(p)||0)+1,x=(s.get(p)||0)+1;Af.set(p,m),s.set(p,x),i.push(p),m===1&&g&&Jw.set(p,!0),x===1&&p.setAttribute(r,"true"),g||p.setAttribute(n,"true")}catch(y){console.error("aria-hidden: cannot operate on ",p,y)}})};return c(t),o.clear(),T2++,function(){i.forEach(function(h){var p=Af.get(h)-1,f=s.get(h)-1;Af.set(h,p),s.set(h,f),p||(Jw.has(h)||h.removeAttribute(n),Jw.delete(h)),f||h.removeAttribute(r)}),T2--,T2||(Af=new WeakMap,Af=new WeakMap,Jw=new WeakMap,Zw={})}},I_=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=ume(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),dme(n,a,r,"aria-hidden")):function(){return null}},Zo=function(){return Zo=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Zo.apply(this,arguments)};function cH(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function hme(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var G1="right-scroll-bar-position",K1="width-before-scroll-bar",pme="with-scroll-bars-hidden",fme="--removed-body-scroll-bar-size";function j2(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function mme(e,t){var r=w.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var gme=typeof window<"u"?w.useLayoutEffect:w.useEffect,r3=new WeakMap;function xme(e,t){var r=mme(null,function(n){return e.forEach(function(a){return j2(a,n)})});return gme(function(){var n=r3.get(r);if(n){var a=new Set(n),s=new Set(e),i=r.current;a.forEach(function(o){s.has(o)||j2(o,null)}),s.forEach(function(o){a.has(o)||j2(o,i)})}r3.set(r,e)},[e]),r}function yme(e){return e}function vme(e,t){t===void 0&&(t=yme);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var i=t(s,n);return r.push(i),function(){r=r.filter(function(o){return o!==i})}},assignSyncMedium:function(s){for(n=!0;r.length;){var i=r;r=[],i.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var i=[];if(r.length){var o=r;r=[],o.forEach(s),i=r}var u=function(){var c=i;i=[],c.forEach(s)},d=function(){return Promise.resolve().then(u)};d(),r={push:function(c){i.push(c),d()},filter:function(c){return i=i.filter(c),r}}}};return a}function bme(e){e===void 0&&(e={});var t=vme(null);return t.options=Zo({async:!0,ssr:!1},e),t}var dH=function(e){var t=e.sideCar,r=cH(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,Zo({},r))};dH.isSideCarExport=!0;function wme(e,t){return e.useMedium(t),dH}var hH=bme(),A2=function(){},E_=w.forwardRef(function(e,t){var r=w.useRef(null),n=w.useState({onScrollCapture:A2,onWheelCapture:A2,onTouchMoveCapture:A2}),a=n[0],s=n[1],i=e.forwardProps,o=e.children,u=e.className,d=e.removeScrollBar,c=e.enabled,h=e.shards,p=e.sideCar,f=e.noRelative,g=e.noIsolation,m=e.inert,x=e.allowPinchZoom,y=e.as,v=y===void 0?"div":y,b=e.gapMode,N=cH(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=p,_=xme([r,t]),C=Zo(Zo({},N),a);return w.createElement(w.Fragment,null,c&&w.createElement(S,{sideCar:hH,removeScrollBar:d,shards:h,noRelative:f,noIsolation:g,inert:m,setCallbacks:s,allowPinchZoom:!!x,lockRef:r,gapMode:b}),i?w.cloneElement(w.Children.only(o),Zo(Zo({},C),{ref:_})):w.createElement(v,Zo({},C,{className:u,ref:_}),o))});E_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};E_.classNames={fullWidth:K1,zeroRight:G1};var Nme=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Sme(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Nme();return t&&e.setAttribute("nonce",t),e}function _me(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function kme(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Cme=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Sme())&&(_me(t,r),kme(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Ime=function(){var e=Cme();return function(t,r){w.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},pH=function(){var e=Ime(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},Eme={left:0,top:0,right:0,gap:0},$2=function(e){return parseInt(e||"",10)||0},Tme=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[$2(r),$2(n),$2(a)]},jme=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Eme;var t=Tme(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Ame=pH(),Sm="data-scroll-locked",$me=function(e,t,r,n){var a=e.left,s=e.top,i=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(pme,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(Sm,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(G1,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(K1,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(G1," .").concat(G1,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(K1," .").concat(K1,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Sm,`] {
    `).concat(fme,": ").concat(o,`px;
  }
`)},n3=function(){var e=parseInt(document.body.getAttribute(Sm)||"0",10);return isFinite(e)?e:0},Rme=function(){w.useEffect(function(){return document.body.setAttribute(Sm,(n3()+1).toString()),function(){var e=n3()-1;e<=0?document.body.removeAttribute(Sm):document.body.setAttribute(Sm,e.toString())}},[])},Dme=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;Rme();var s=w.useMemo(function(){return jme(a)},[a]);return w.createElement(Ame,{styles:$me(s,!t,a,r?"":"!important")})},ZE=!1;if(typeof window<"u")try{var e1=Object.defineProperty({},"passive",{get:function(){return ZE=!0,!0}});window.addEventListener("test",e1,e1),window.removeEventListener("test",e1,e1)}catch{ZE=!1}var $f=ZE?{passive:!1}:!1,Mme=function(e){return e.tagName==="TEXTAREA"},fH=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Mme(e)&&r[t]==="visible")},Fme=function(e){return fH(e,"overflowY")},Ome=function(e){return fH(e,"overflowX")},a3=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=mH(e,n);if(a){var s=gH(e,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Pme=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Lme=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},mH=function(e,t){return e==="v"?Fme(t):Ome(t)},gH=function(e,t){return e==="v"?Pme(t):Lme(t)},zme=function(e,t){return e==="h"&&t==="rtl"?-1:1},Bme=function(e,t,r,n,a){var s=zme(e,window.getComputedStyle(t).direction),i=s*n,o=r.target,u=t.contains(o),d=!1,c=i>0,h=0,p=0;do{if(!o)break;var f=gH(e,o),g=f[0],m=f[1],x=f[2],y=m-x-s*g;(g||y)&&mH(e,o)&&(h+=y,p+=g);var v=o.parentNode;o=v&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE?v.host:v}while(!u&&o!==document.body||u&&(t.contains(o)||t===o));return(c&&Math.abs(h)<1||!c&&Math.abs(p)<1)&&(d=!0),d},t1=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},s3=function(e){return[e.deltaX,e.deltaY]},i3=function(e){return e&&"current"in e?e.current:e},Ume=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Wme=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Vme=0,Rf=[];function Hme(e){var t=w.useRef([]),r=w.useRef([0,0]),n=w.useRef(),a=w.useState(Vme++)[0],s=w.useState(pH)[0],i=w.useRef(e);w.useEffect(function(){i.current=e},[e]),w.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=hme([e.lockRef.current],(e.shards||[]).map(i3),!0).filter(Boolean);return m.forEach(function(x){return x.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=w.useCallback(function(m,x){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var y=t1(m),v=r.current,b="deltaX"in m?m.deltaX:v[0]-y[0],N="deltaY"in m?m.deltaY:v[1]-y[1],S,_=m.target,C=Math.abs(b)>Math.abs(N)?"h":"v";if("touches"in m&&C==="h"&&_.type==="range")return!1;var k=a3(C,_);if(!k)return!0;if(k?S=C:(S=C==="v"?"h":"v",k=a3(C,_)),!k)return!1;if(!n.current&&"changedTouches"in m&&(b||N)&&(n.current=S),!S)return!0;var I=n.current||S;return Bme(I,x,m,I==="h"?b:N)},[]),u=w.useCallback(function(m){var x=m;if(!(!Rf.length||Rf[Rf.length-1]!==s)){var y="deltaY"in x?s3(x):t1(x),v=t.current.filter(function(S){return S.name===x.type&&(S.target===x.target||x.target===S.shadowParent)&&Ume(S.delta,y)})[0];if(v&&v.should){x.cancelable&&x.preventDefault();return}if(!v){var b=(i.current.shards||[]).map(i3).filter(Boolean).filter(function(S){return S.contains(x.target)}),N=b.length>0?o(x,b[0]):!i.current.noIsolation;N&&x.cancelable&&x.preventDefault()}}},[]),d=w.useCallback(function(m,x,y,v){var b={name:m,delta:x,target:y,should:v,shadowParent:qme(y)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(N){return N!==b})},1)},[]),c=w.useCallback(function(m){r.current=t1(m),n.current=void 0},[]),h=w.useCallback(function(m){d(m.type,s3(m),m.target,o(m,e.lockRef.current))},[]),p=w.useCallback(function(m){d(m.type,t1(m),m.target,o(m,e.lockRef.current))},[]);w.useEffect(function(){return Rf.push(s),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:p}),document.addEventListener("wheel",u,$f),document.addEventListener("touchmove",u,$f),document.addEventListener("touchstart",c,$f),function(){Rf=Rf.filter(function(m){return m!==s}),document.removeEventListener("wheel",u,$f),document.removeEventListener("touchmove",u,$f),document.removeEventListener("touchstart",c,$f)}},[]);var f=e.removeScrollBar,g=e.inert;return w.createElement(w.Fragment,null,g?w.createElement(s,{styles:Wme(a)}):null,f?w.createElement(Dme,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function qme(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Gme=wme(hH,Hme);var Jb=w.forwardRef(function(e,t){return w.createElement(E_,Zo({},e,{ref:t,sideCar:Gme}))});Jb.classNames=E_.classNames;var Kme=[" ","Enter","ArrowUp","ArrowDown"],Qme=[" ","Enter"],mh="Select",[T_,j_,Xme]=t_(mh),[Wg,Aot]=Ia(mh,[Xme,Vc]),A_=Vc(),[Yme,Hc]=Wg(mh),[Jme,Zme]=Wg(mh),xH=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:s,value:i,defaultValue:o,onValueChange:u,dir:d,name:c,autoComplete:h,disabled:p,required:f,form:g}=e,m=A_(t),[x,y]=w.useState(null),[v,b]=w.useState(null),[N,S]=w.useState(!1),_=Bg(d),[C,k]=So({prop:n,defaultProp:a??!1,onChange:s,caller:mh}),[I,T]=So({prop:i,defaultProp:o,onChange:u,caller:mh}),j=w.useRef(null),E=x?g||!!x.closest("form"):!0,[O,M]=w.useState(new Set),W=Array.from(O).map(q=>q.props.value).join(";");return l.jsx(o_,{...m,children:l.jsxs(Yme,{required:f,scope:t,trigger:x,onTriggerChange:y,valueNode:v,onValueNodeChange:b,valueNodeHasChildren:N,onValueNodeHasChildrenChange:S,contentId:_a(),value:I,onValueChange:T,open:C,onOpenChange:k,dir:_,triggerPointerDownPosRef:j,disabled:p,children:[l.jsx(T_.Provider,{scope:t,children:l.jsx(Jme,{scope:e.__scopeSelect,onNativeOptionAdd:w.useCallback(q=>{M(P=>new Set(P).add(q))},[]),onNativeOptionRemove:w.useCallback(q=>{M(P=>{const A=new Set(P);return A.delete(q),A})},[]),children:r})}),E?l.jsxs(BH,{"aria-hidden":!0,required:f,tabIndex:-1,name:c,autoComplete:h,value:I,onChange:q=>T(q.target.value),disabled:p,form:g,children:[I===void 0?l.jsx("option",{value:""}):null,Array.from(O)]},W):null]})})};xH.displayName=mh;var yH="SelectTrigger",vH=w.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,s=A_(r),i=Hc(yH,r),o=i.disabled||n,u=Bt(t,i.onTriggerChange),d=j_(r),c=w.useRef("touch"),[h,p,f]=WH(m=>{const x=d().filter(b=>!b.disabled),y=x.find(b=>b.value===i.value),v=VH(x,m,y);v!==void 0&&i.onValueChange(v.value)}),g=m=>{o||(i.onOpenChange(!0),f()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return l.jsx(Lb,{asChild:!0,...s,children:l.jsx(at.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":UH(i.value)?"":void 0,...a,ref:u,onClick:ze(a.onClick,m=>{m.currentTarget.focus(),c.current!=="mouse"&&g(m)}),onPointerDown:ze(a.onPointerDown,m=>{c.current=m.pointerType;const x=m.target;x.hasPointerCapture(m.pointerId)&&x.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(g(m),m.preventDefault())}),onKeyDown:ze(a.onKeyDown,m=>{const x=h.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&p(m.key),!(x&&m.key===" ")&&Kme.includes(m.key)&&(g(),m.preventDefault())})})})});vH.displayName=yH;var bH="SelectValue",wH=w.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:s,placeholder:i="",...o}=e,u=Hc(bH,r),{onValueNodeHasChildrenChange:d}=u,c=s!==void 0,h=Bt(t,u.onValueNodeChange);return Un(()=>{d(c)},[d,c]),l.jsx(at.span,{...o,ref:h,style:{pointerEvents:"none"},children:UH(u.value)?l.jsx(l.Fragment,{children:i}):s})});wH.displayName=bH;var ege="SelectIcon",NH=w.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return l.jsx(at.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});NH.displayName=ege;var tge="SelectPortal",SH=e=>l.jsx(Tg,{asChild:!0,...e});SH.displayName=tge;var gh="SelectContent",_H=w.forwardRef((e,t)=>{const r=Hc(gh,e.__scopeSelect),[n,a]=w.useState();if(Un(()=>{a(new DocumentFragment)},[]),!r.open){const s=n;return s?Wh.createPortal(l.jsx(kH,{scope:e.__scopeSelect,children:l.jsx(T_.Slot,{scope:e.__scopeSelect,children:l.jsx("div",{children:e.children})})}),s):null}return l.jsx(CH,{...e,ref:t})});_H.displayName=gh;var so=10,[kH,qc]=Wg(gh),rge="SelectContentImpl",nge=Nc("SelectContent.RemoveScroll"),CH=w.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:s,onPointerDownOutside:i,side:o,sideOffset:u,align:d,alignOffset:c,arrowPadding:h,collisionBoundary:p,collisionPadding:f,sticky:g,hideWhenDetached:m,avoidCollisions:x,...y}=e,v=Hc(gh,r),[b,N]=w.useState(null),[S,_]=w.useState(null),C=Bt(t,K=>N(K)),[k,I]=w.useState(null),[T,j]=w.useState(null),E=j_(r),[O,M]=w.useState(!1),W=w.useRef(!1);w.useEffect(()=>{if(b)return I_(b)},[b]),C_();const q=w.useCallback(K=>{const[J,...Z]=E().map(F=>F.ref.current),[Q]=Z.slice(-1),U=document.activeElement;for(const F of K)if(F===U||(F==null||F.scrollIntoView({block:"nearest"}),F===J&&S&&(S.scrollTop=0),F===Q&&S&&(S.scrollTop=S.scrollHeight),F==null||F.focus(),document.activeElement!==U))return},[E,S]),P=w.useCallback(()=>q([k,b]),[q,k,b]);w.useEffect(()=>{O&&P()},[O,P]);const{onOpenChange:A,triggerPointerDownPosRef:L}=v;w.useEffect(()=>{if(b){let K={x:0,y:0};const J=Q=>{var U,F;K={x:Math.abs(Math.round(Q.pageX)-(((U=L.current)==null?void 0:U.x)??0)),y:Math.abs(Math.round(Q.pageY)-(((F=L.current)==null?void 0:F.y)??0))}},Z=Q=>{K.x<=10&&K.y<=10?Q.preventDefault():b.contains(Q.target)||A(!1),document.removeEventListener("pointermove",J),L.current=null};return L.current!==null&&(document.addEventListener("pointermove",J),document.addEventListener("pointerup",Z,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",J),document.removeEventListener("pointerup",Z,{capture:!0})}}},[b,A,L]),w.useEffect(()=>{const K=()=>A(!1);return window.addEventListener("blur",K),window.addEventListener("resize",K),()=>{window.removeEventListener("blur",K),window.removeEventListener("resize",K)}},[A]);const[z,$]=WH(K=>{const J=E().filter(U=>!U.disabled),Z=J.find(U=>U.ref.current===document.activeElement),Q=VH(J,K,Z);Q&&setTimeout(()=>Q.ref.current.focus())}),V=w.useCallback((K,J,Z)=>{const Q=!W.current&&!Z;(v.value!==void 0&&v.value===J||Q)&&(I(K),Q&&(W.current=!0))},[v.value]),B=w.useCallback(()=>b==null?void 0:b.focus(),[b]),Y=w.useCallback((K,J,Z)=>{const Q=!W.current&&!Z;(v.value!==void 0&&v.value===J||Q)&&j(K)},[v.value]),re=n==="popper"?eT:IH,ae=re===eT?{side:o,sideOffset:u,align:d,alignOffset:c,arrowPadding:h,collisionBoundary:p,collisionPadding:f,sticky:g,hideWhenDetached:m,avoidCollisions:x}:{};return l.jsx(kH,{scope:r,content:b,viewport:S,onViewportChange:_,itemRefCallback:V,selectedItem:k,onItemLeave:B,itemTextRefCallback:Y,focusSelectedItem:P,selectedItemText:T,position:n,isPositioned:O,searchRef:z,children:l.jsx(Jb,{as:nge,allowPinchZoom:!0,children:l.jsx(Yb,{asChild:!0,trapped:v.open,onMountAutoFocus:K=>{K.preventDefault()},onUnmountAutoFocus:ze(a,K=>{var J;(J=v.trigger)==null||J.focus({preventScroll:!0}),K.preventDefault()}),children:l.jsx(Vh,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:K=>K.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:l.jsx(re,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:K=>K.preventDefault(),...y,...ae,onPlaced:()=>M(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:ze(y.onKeyDown,K=>{const J=K.ctrlKey||K.altKey||K.metaKey;if(K.key==="Tab"&&K.preventDefault(),!J&&K.key.length===1&&$(K.key),["ArrowUp","ArrowDown","Home","End"].includes(K.key)){let Q=E().filter(U=>!U.disabled).map(U=>U.ref.current);if(["ArrowUp","End"].includes(K.key)&&(Q=Q.slice().reverse()),["ArrowUp","ArrowDown"].includes(K.key)){const U=K.target,F=Q.indexOf(U);Q=Q.slice(F+1)}setTimeout(()=>q(Q)),K.preventDefault()}})})})})})})});CH.displayName=rge;var age="SelectItemAlignedPosition",IH=w.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,s=Hc(gh,r),i=qc(gh,r),[o,u]=w.useState(null),[d,c]=w.useState(null),h=Bt(t,C=>c(C)),p=j_(r),f=w.useRef(!1),g=w.useRef(!0),{viewport:m,selectedItem:x,selectedItemText:y,focusSelectedItem:v}=i,b=w.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&d&&m&&x&&y){const C=s.trigger.getBoundingClientRect(),k=d.getBoundingClientRect(),I=s.valueNode.getBoundingClientRect(),T=y.getBoundingClientRect();if(s.dir!=="rtl"){const U=T.left-k.left,F=I.left-U,te=C.left-F,pe=C.width+te,ve=Math.max(pe,k.width),fe=window.innerWidth-so,Me=JE(F,[so,Math.max(so,fe-ve)]);o.style.minWidth=pe+"px",o.style.left=Me+"px"}else{const U=k.right-T.right,F=window.innerWidth-I.right-U,te=window.innerWidth-C.right-F,pe=C.width+te,ve=Math.max(pe,k.width),fe=window.innerWidth-so,Me=JE(F,[so,Math.max(so,fe-ve)]);o.style.minWidth=pe+"px",o.style.right=Me+"px"}const j=p(),E=window.innerHeight-so*2,O=m.scrollHeight,M=window.getComputedStyle(d),W=parseInt(M.borderTopWidth,10),q=parseInt(M.paddingTop,10),P=parseInt(M.borderBottomWidth,10),A=parseInt(M.paddingBottom,10),L=W+q+O+A+P,z=Math.min(x.offsetHeight*5,L),$=window.getComputedStyle(m),V=parseInt($.paddingTop,10),B=parseInt($.paddingBottom,10),Y=C.top+C.height/2-so,re=E-Y,ae=x.offsetHeight/2,K=x.offsetTop+ae,J=W+q+K,Z=L-J;if(J<=Y){const U=j.length>0&&x===j[j.length-1].ref.current;o.style.bottom="0px";const F=d.clientHeight-m.offsetTop-m.offsetHeight,te=Math.max(re,ae+(U?B:0)+F+P),pe=J+te;o.style.height=pe+"px"}else{const U=j.length>0&&x===j[0].ref.current;o.style.top="0px";const te=Math.max(Y,W+m.offsetTop+(U?V:0)+ae)+Z;o.style.height=te+"px",m.scrollTop=J-Y+m.offsetTop}o.style.margin=`${so}px 0`,o.style.minHeight=z+"px",o.style.maxHeight=E+"px",n==null||n(),requestAnimationFrame(()=>f.current=!0)}},[p,s.trigger,s.valueNode,o,d,m,x,y,s.dir,n]);Un(()=>b(),[b]);const[N,S]=w.useState();Un(()=>{d&&S(window.getComputedStyle(d).zIndex)},[d]);const _=w.useCallback(C=>{C&&g.current===!0&&(b(),v==null||v(),g.current=!1)},[b,v]);return l.jsx(ige,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:f,onScrollButtonChange:_,children:l.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:l.jsx(at.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});IH.displayName=age;var sge="SelectPopperPosition",eT=w.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=so,...s}=e,i=A_(r);return l.jsx(l_,{...i,...s,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});eT.displayName=sge;var[ige,g$]=Wg(gh,{}),tT="SelectViewport",EH=w.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,s=qc(tT,r),i=g$(tT,r),o=Bt(t,s.onViewportChange),u=w.useRef(0);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),l.jsx(T_.Slot,{scope:r,children:l.jsx(at.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ze(a.onScroll,d=>{const c=d.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:p}=i;if(p!=null&&p.current&&h){const f=Math.abs(u.current-c.scrollTop);if(f>0){const g=window.innerHeight-so*2,m=parseFloat(h.style.minHeight),x=parseFloat(h.style.height),y=Math.max(m,x);if(y<g){const v=y+f,b=Math.min(g,v),N=v-b;h.style.height=b+"px",h.style.bottom==="0px"&&(c.scrollTop=N>0?N:0,h.style.justifyContent="flex-end")}}}u.current=c.scrollTop})})})]})});EH.displayName=tT;var TH="SelectGroup",[oge,lge]=Wg(TH),uge=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=_a();return l.jsx(oge,{scope:r,id:a,children:l.jsx(at.div,{role:"group","aria-labelledby":a,...n,ref:t})})});uge.displayName=TH;var jH="SelectLabel",AH=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=lge(jH,r);return l.jsx(at.div,{id:a.id,...n,ref:t})});AH.displayName=jH;var UN="SelectItem",[cge,$H]=Wg(UN),RH=w.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:s,...i}=e,o=Hc(UN,r),u=qc(UN,r),d=o.value===n,[c,h]=w.useState(s??""),[p,f]=w.useState(!1),g=Bt(t,v=>{var b;return(b=u.itemRefCallback)==null?void 0:b.call(u,v,n,a)}),m=_a(),x=w.useRef("touch"),y=()=>{a||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return l.jsx(cge,{scope:r,value:n,disabled:a,textId:m,isSelected:d,onItemTextChange:w.useCallback(v=>{h(b=>b||((v==null?void 0:v.textContent)??"").trim())},[]),children:l.jsx(T_.ItemSlot,{scope:r,value:n,disabled:a,textValue:c,children:l.jsx(at.div,{role:"option","aria-labelledby":m,"data-highlighted":p?"":void 0,"aria-selected":d&&p,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:g,onFocus:ze(i.onFocus,()=>f(!0)),onBlur:ze(i.onBlur,()=>f(!1)),onClick:ze(i.onClick,()=>{x.current!=="mouse"&&y()}),onPointerUp:ze(i.onPointerUp,()=>{x.current==="mouse"&&y()}),onPointerDown:ze(i.onPointerDown,v=>{x.current=v.pointerType}),onPointerMove:ze(i.onPointerMove,v=>{var b;x.current=v.pointerType,a?(b=u.onItemLeave)==null||b.call(u):x.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ze(i.onPointerLeave,v=>{var b;v.currentTarget===document.activeElement&&((b=u.onItemLeave)==null||b.call(u))}),onKeyDown:ze(i.onKeyDown,v=>{var N;((N=u.searchRef)==null?void 0:N.current)!==""&&v.key===" "||(Qme.includes(v.key)&&y(),v.key===" "&&v.preventDefault())})})})})});RH.displayName=UN;var Xy="SelectItemText",DH=w.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...s}=e,i=Hc(Xy,r),o=qc(Xy,r),u=$H(Xy,r),d=Zme(Xy,r),[c,h]=w.useState(null),p=Bt(t,y=>h(y),u.onItemTextChange,y=>{var v;return(v=o.itemTextRefCallback)==null?void 0:v.call(o,y,u.value,u.disabled)}),f=c==null?void 0:c.textContent,g=w.useMemo(()=>l.jsx("option",{value:u.value,disabled:u.disabled,children:f},u.value),[u.disabled,u.value,f]),{onNativeOptionAdd:m,onNativeOptionRemove:x}=d;return Un(()=>(m(g),()=>x(g)),[m,x,g]),l.jsxs(l.Fragment,{children:[l.jsx(at.span,{id:u.textId,...s,ref:p}),u.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Wh.createPortal(s.children,i.valueNode):null]})});DH.displayName=Xy;var MH="SelectItemIndicator",FH=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return $H(MH,r).isSelected?l.jsx(at.span,{"aria-hidden":!0,...n,ref:t}):null});FH.displayName=MH;var rT="SelectScrollUpButton",OH=w.forwardRef((e,t)=>{const r=qc(rT,e.__scopeSelect),n=g$(rT,e.__scopeSelect),[a,s]=w.useState(!1),i=Bt(t,n.onScrollButtonChange);return Un(()=>{if(r.viewport&&r.isPositioned){let o=function(){const d=u.scrollTop>0;s(d)};const u=r.viewport;return o(),u.addEventListener("scroll",o),()=>u.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?l.jsx(LH,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:u}=r;o&&u&&(o.scrollTop=o.scrollTop-u.offsetHeight)}}):null});OH.displayName=rT;var nT="SelectScrollDownButton",PH=w.forwardRef((e,t)=>{const r=qc(nT,e.__scopeSelect),n=g$(nT,e.__scopeSelect),[a,s]=w.useState(!1),i=Bt(t,n.onScrollButtonChange);return Un(()=>{if(r.viewport&&r.isPositioned){let o=function(){const d=u.scrollHeight-u.clientHeight,c=Math.ceil(u.scrollTop)<d;s(c)};const u=r.viewport;return o(),u.addEventListener("scroll",o),()=>u.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?l.jsx(LH,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:u}=r;o&&u&&(o.scrollTop=o.scrollTop+u.offsetHeight)}}):null});PH.displayName=nT;var LH=w.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,s=qc("SelectScrollButton",r),i=w.useRef(null),o=j_(r),u=w.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return w.useEffect(()=>()=>u(),[u]),Un(()=>{var c;const d=o().find(h=>h.ref.current===document.activeElement);(c=d==null?void 0:d.ref.current)==null||c.scrollIntoView({block:"nearest"})},[o]),l.jsx(at.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ze(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:ze(a.onPointerMove,()=>{var d;(d=s.onItemLeave)==null||d.call(s),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:ze(a.onPointerLeave,()=>{u()})})}),dge="SelectSeparator",zH=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return l.jsx(at.div,{"aria-hidden":!0,...n,ref:t})});zH.displayName=dge;var aT="SelectArrow",hge=w.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=A_(r),s=Hc(aT,r),i=qc(aT,r);return s.open&&i.position==="popper"?l.jsx(u_,{...a,...n,ref:t}):null});hge.displayName=aT;var pge="SelectBubbleInput",BH=w.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const a=w.useRef(null),s=Bt(n,a),i=m$(t);return w.useEffect(()=>{const o=a.current;if(!o)return;const u=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(u,"value").set;if(i!==t&&c){const h=new Event("change",{bubbles:!0});c.call(o,t),o.dispatchEvent(h)}},[i,t]),l.jsx(at.select,{...r,style:{...jU,...r.style},ref:s,defaultValue:t})});BH.displayName=pge;function UH(e){return e===""||e===void 0}function WH(e){const t=$n(e),r=w.useRef(""),n=w.useRef(0),a=w.useCallback(i=>{const o=r.current+i;t(o),function u(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>u(""),1e3))}(o)},[t]),s=w.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return w.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,s]}function VH(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=fge(e,Math.max(s,0));a.length===1&&(i=i.filter(d=>d!==r));const u=i.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return u!==r?u:void 0}function fge(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var mge=xH,HH=vH,gge=wH,xge=NH,yge=SH,qH=_H,vge=EH,GH=AH,KH=RH,bge=DH,wge=FH,QH=OH,XH=PH,YH=zH;const Gr=mge,Kr=gge,Fr=w.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(HH,{ref:n,className:Ue("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed [&>span]:line-clamp-1",e),...r,children:[t,l.jsx(xge,{asChild:!0,children:l.jsx(TA,{className:"h-4 w-4 opacity-50"})})]}));Fr.displayName=HH.displayName;const JH=w.forwardRef(({className:e,...t},r)=>l.jsx(QH,{ref:r,className:Ue("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(ple,{className:"h-4 w-4"})}));JH.displayName=QH.displayName;const ZH=w.forwardRef(({className:e,...t},r)=>l.jsx(XH,{ref:r,className:Ue("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(TA,{className:"h-4 w-4"})}));ZH.displayName=XH.displayName;const Or=w.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>l.jsx(yge,{children:l.jsxs(qH,{ref:a,className:Ue("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[l.jsx(JH,{}),l.jsx(vge,{className:Ue("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),l.jsx(ZH,{})]})}));Or.displayName=qH.displayName;const Nge=w.forwardRef(({className:e,...t},r)=>l.jsx(GH,{ref:r,className:Ue("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Nge.displayName=GH.displayName;const gt=w.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(KH,{ref:n,className:Ue("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(wge,{children:l.jsx(Fb,{className:"h-4 w-4"})})}),l.jsx(bge,{children:t})]}));gt.displayName=KH.displayName;const Sge=w.forwardRef(({className:e,...t},r)=>l.jsx(YH,{ref:r,className:Ue("-mx-1 my-1 h-px bg-muted",e),...t}));Sge.displayName=YH.displayName;const Ve=w.forwardRef(({className:e,type:t,...r},n)=>l.jsx("input",{type:t,className:Ue("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Ve.displayName="Input";const yi=w.forwardRef(({className:e,...t},r)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:r,className:Ue("w-full caption-bottom text-sm min-w-max",e),...t})}));yi.displayName="Table";const vi=w.forwardRef(({className:e,...t},r)=>l.jsx("thead",{ref:r,className:Ue("[&_tr]:border-b",e),...t}));vi.displayName="TableHeader";const bi=w.forwardRef(({className:e,...t},r)=>l.jsx("tbody",{ref:r,className:Ue("[&_tr:last-child]:border-0",e),...t}));bi.displayName="TableBody";const _ge=w.forwardRef(({className:e,...t},r)=>l.jsx("tfoot",{ref:r,className:Ue("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));_ge.displayName="TableFooter";const or=w.forwardRef(({className:e,...t},r)=>l.jsx("tr",{ref:r,className:Ue("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));or.displayName="TableRow";const ct=w.forwardRef(({className:e,...t},r)=>l.jsx("th",{ref:r,className:Ue("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));ct.displayName="TableHead";const Xe=w.forwardRef(({className:e,...t},r)=>l.jsx("td",{ref:r,className:Ue("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Xe.displayName="TableCell";const kge=w.forwardRef(({className:e,...t},r)=>l.jsx("caption",{ref:r,className:Ue("mt-4 text-sm text-muted-foreground",e),...t}));kge.displayName="TableCaption";var $_="Dialog",[eq,tq]=Ia($_),[Cge,Mo]=eq($_),rq=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:s,modal:i=!0}=e,o=w.useRef(null),u=w.useRef(null),[d,c]=So({prop:n,defaultProp:a??!1,onChange:s,caller:$_});return l.jsx(Cge,{scope:t,triggerRef:o,contentRef:u,contentId:_a(),titleId:_a(),descriptionId:_a(),open:d,onOpenChange:c,onOpenToggle:w.useCallback(()=>c(h=>!h),[c]),modal:i,children:r})};rq.displayName=$_;var nq="DialogTrigger",aq=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Mo(nq,r),s=Bt(t,a.triggerRef);return l.jsx(at.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":v$(a.open),...n,ref:s,onClick:ze(e.onClick,a.onOpenToggle)})});aq.displayName=nq;var x$="DialogPortal",[Ige,sq]=eq(x$,{forceMount:void 0}),iq=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,s=Mo(x$,t);return l.jsx(Ige,{scope:t,forceMount:r,children:w.Children.map(n,i=>l.jsx(fa,{present:r||s.open,children:l.jsx(Tg,{asChild:!0,container:a,children:i})}))})};iq.displayName=x$;var WN="DialogOverlay",oq=w.forwardRef((e,t)=>{const r=sq(WN,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=Mo(WN,e.__scopeDialog);return s.modal?l.jsx(fa,{present:n||s.open,children:l.jsx(Tge,{...a,ref:t})}):null});oq.displayName=WN;var Ege=Nc("DialogOverlay.RemoveScroll"),Tge=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Mo(WN,r);return l.jsx(Jb,{as:Ege,allowPinchZoom:!0,shards:[a.contentRef],children:l.jsx(at.div,{"data-state":v$(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),xh="DialogContent",lq=w.forwardRef((e,t)=>{const r=sq(xh,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=Mo(xh,e.__scopeDialog);return l.jsx(fa,{present:n||s.open,children:s.modal?l.jsx(jge,{...a,ref:t}):l.jsx(Age,{...a,ref:t})})});lq.displayName=xh;var jge=w.forwardRef((e,t)=>{const r=Mo(xh,e.__scopeDialog),n=w.useRef(null),a=Bt(t,r.contentRef,n);return w.useEffect(()=>{const s=n.current;if(s)return I_(s)},[]),l.jsx(uq,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ze(e.onCloseAutoFocus,s=>{var i;s.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ze(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&s.preventDefault()}),onFocusOutside:ze(e.onFocusOutside,s=>s.preventDefault())})}),Age=w.forwardRef((e,t)=>{const r=Mo(xh,e.__scopeDialog),n=w.useRef(!1),a=w.useRef(!1);return l.jsx(uq,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:s=>{var u,d;(u=e.onInteractOutside)==null||u.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((d=r.triggerRef.current)==null?void 0:d.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),uq=w.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:s,...i}=e,o=Mo(xh,r),u=w.useRef(null),d=Bt(t,u);return C_(),l.jsxs(l.Fragment,{children:[l.jsx(Yb,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:s,children:l.jsx(Vh,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":v$(o.open),...i,ref:d,onDismiss:()=>o.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(Rge,{titleId:o.titleId}),l.jsx(Mge,{contentRef:u,descriptionId:o.descriptionId})]})]})}),y$="DialogTitle",cq=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Mo(y$,r);return l.jsx(at.h2,{id:a.titleId,...n,ref:t})});cq.displayName=y$;var dq="DialogDescription",hq=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Mo(dq,r);return l.jsx(at.p,{id:a.descriptionId,...n,ref:t})});hq.displayName=dq;var pq="DialogClose",fq=w.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Mo(pq,r);return l.jsx(at.button,{type:"button",...n,ref:t,onClick:ze(e.onClick,()=>a.onOpenChange(!1))})});fq.displayName=pq;function v$(e){return e?"open":"closed"}var mq="DialogTitleWarning",[$ge,gq]=Yie(mq,{contentName:xh,titleName:y$,docsSlug:"dialog"}),Rge=({titleId:e})=>{const t=gq(mq),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return w.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Dge="DialogDescriptionWarning",Mge=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${gq(Dge).contentName}}.`;return w.useEffect(()=>{var s;const a=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},b$=rq,xq=aq,w$=iq,R_=oq,D_=lq,N$=cq,S$=hq,_$=fq;const Wr=b$,Fge=xq,Oge=w$,yq=w.forwardRef(({className:e,...t},r)=>l.jsx(R_,{ref:r,className:Ue("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));yq.displayName=R_.displayName;const Vr=w.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(Oge,{children:[l.jsx(yq,{}),l.jsxs(D_,{ref:n,className:Ue("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,l.jsxs(_$,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[l.jsx(wa,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Vr.displayName=D_.displayName;const Hr=({className:e,...t})=>l.jsx("div",{className:Ue("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Hr.displayName="DialogHeader";const fo=({className:e,...t})=>l.jsx("div",{className:Ue("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});fo.displayName="DialogFooter";const qr=w.forwardRef(({className:e,...t},r)=>l.jsx(N$,{ref:r,className:Ue("text-lg font-semibold leading-none tracking-tight",e),...t}));qr.displayName=N$.displayName;const yh=w.forwardRef(({className:e,...t},r)=>l.jsx(S$,{ref:r,className:Ue("text-sm text-muted-foreground",e),...t}));yh.displayName=S$.displayName;var vq="AlertDialog",[Pge,$ot]=Ia(vq,[tq]),uu=tq(),bq=e=>{const{__scopeAlertDialog:t,...r}=e,n=uu(t);return l.jsx(b$,{...n,...r,modal:!0})};bq.displayName=vq;var Lge="AlertDialogTrigger",zge=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=uu(r);return l.jsx(xq,{...a,...n,ref:t})});zge.displayName=Lge;var Bge="AlertDialogPortal",wq=e=>{const{__scopeAlertDialog:t,...r}=e,n=uu(t);return l.jsx(w$,{...n,...r})};wq.displayName=Bge;var Uge="AlertDialogOverlay",Nq=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=uu(r);return l.jsx(R_,{...a,...n,ref:t})});Nq.displayName=Uge;var _m="AlertDialogContent",[Wge,Vge]=Pge(_m),Hge=CU("AlertDialogContent"),Sq=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,s=uu(r),i=w.useRef(null),o=Bt(t,i),u=w.useRef(null);return l.jsx($ge,{contentName:_m,titleName:_q,docsSlug:"alert-dialog",children:l.jsx(Wge,{scope:r,cancelRef:u,children:l.jsxs(D_,{role:"alertdialog",...s,...a,ref:o,onOpenAutoFocus:ze(a.onOpenAutoFocus,d=>{var c;d.preventDefault(),(c=u.current)==null||c.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[l.jsx(Hge,{children:n}),l.jsx(Gge,{contentRef:i})]})})})});Sq.displayName=_m;var _q="AlertDialogTitle",kq=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=uu(r);return l.jsx(N$,{...a,...n,ref:t})});kq.displayName=_q;var Cq="AlertDialogDescription",Iq=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=uu(r);return l.jsx(S$,{...a,...n,ref:t})});Iq.displayName=Cq;var qge="AlertDialogAction",Eq=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=uu(r);return l.jsx(_$,{...a,...n,ref:t})});Eq.displayName=qge;var Tq="AlertDialogCancel",jq=w.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=Vge(Tq,r),s=uu(r),i=Bt(t,a);return l.jsx(_$,{...s,...n,ref:i})});jq.displayName=Tq;var Gge=({contentRef:e})=>{const t=`\`${_m}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${_m}\` by passing a \`${Cq}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${_m}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return w.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Kge=bq,Qge=wq,Aq=Nq,$q=Sq,Rq=Eq,Dq=jq,Mq=kq,Fq=Iq;const Jv=Mb("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),le=w.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},s)=>{const i=n?Zie:"button";return l.jsx(i,{className:Ue(Jv({variant:t,size:r,className:e})),ref:s,...a})});le.displayName="Button";const k$=Kge,Xge=Qge,Oq=w.forwardRef(({className:e,...t},r)=>l.jsx(Aq,{className:Ue("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Oq.displayName=Aq.displayName;const M_=w.forwardRef(({className:e,...t},r)=>l.jsxs(Xge,{children:[l.jsx(Oq,{}),l.jsx($q,{ref:r,className:Ue("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));M_.displayName=$q.displayName;const F_=({className:e,...t})=>l.jsx("div",{className:Ue("flex flex-col space-y-2 text-center sm:text-left",e),...t});F_.displayName="AlertDialogHeader";const O_=({className:e,...t})=>l.jsx("div",{className:Ue("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});O_.displayName="AlertDialogFooter";const P_=w.forwardRef(({className:e,...t},r)=>l.jsx(Mq,{ref:r,className:Ue("text-lg font-semibold",e),...t}));P_.displayName=Mq.displayName;const L_=w.forwardRef(({className:e,...t},r)=>l.jsx(Fq,{ref:r,className:Ue("text-sm text-muted-foreground",e),...t}));L_.displayName=Fq.displayName;const z_=w.forwardRef(({className:e,...t},r)=>l.jsx(Rq,{ref:r,className:Ue(Jv(),e),...t}));z_.displayName=Rq.displayName;const B_=w.forwardRef(({className:e,...t},r)=>l.jsx(Dq,{ref:r,className:Ue(Jv({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));B_.displayName=Dq.displayName;var Yge="Label",Pq=w.forwardRef((e,t)=>l.jsx(at.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Pq.displayName=Yge;var Lq=Pq;const Jge=Mb("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ee=w.forwardRef(({className:e,...t},r)=>l.jsx(Lq,{ref:r,className:Ue(Jge(),e),...t}));Ee.displayName=Lq.displayName;const Zge="modulepreload",exe=function(e){return"/Admission-Dashboard/"+e},o3={},Vg=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(u=>{if(u=exe(u),u in o3)return;o3[u]=!0;const d=u.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Zge,d||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),d)return new Promise((p,f)=>{h.addEventListener("load",p),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},txe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Vg(async()=>{const{default:n}=await Promise.resolve().then(()=>Hg);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class C$ extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class rxe extends C${constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class l3 extends C${constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class u3 extends C${constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var sT;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(sT||(sT={}));var nxe=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};class axe{constructor(t,{headers:r={},customFetch:n,region:a=sT.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=txe(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return nxe(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:u}=r;u||(u=this.region);const d=new URL(`${this.url}/${t}`);u&&u!=="any"&&(o["x-region"]=u,d.searchParams.set("forceFunctionRegion",u));let c;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=i):typeof i=="string"?(o["Content-Type"]="text/plain",c=i):typeof FormData<"u"&&i instanceof FormData?c=i:(o["Content-Type"]="application/json",c=JSON.stringify(i)));const h=yield this.fetch(d.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:c}).catch(m=>{throw new rxe(m)}),p=h.headers.get("x-relay-error");if(p&&p==="true")throw new l3(h);if(!h.ok)throw new u3(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return f==="application/json"?g=yield h.json():f==="application/octet-stream"?g=yield h.blob():f==="text/event-stream"?g=h:f==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof u3||a instanceof l3?a.context:void 0}}})}}var Ps={},I$={},U_={},Zb={},W_={},V_={},sxe=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},eg=sxe();const ixe=eg.fetch,zq=eg.fetch.bind(eg),Bq=eg.Headers,oxe=eg.Request,lxe=eg.Response,Hg=Object.freeze(Object.defineProperty({__proto__:null,Headers:Bq,Request:oxe,Response:lxe,default:zq,fetch:ixe},Symbol.toStringTag,{value:"Module"})),uxe=yne(Hg);var H_={};Object.defineProperty(H_,"__esModule",{value:!0});let cxe=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};H_.default=cxe;var Uq=mi&&mi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(V_,"__esModule",{value:!0});const dxe=Uq(uxe),hxe=Uq(H_);let pxe=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=dxe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,u;let d=null,c=null,h=null,p=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const y=await s.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=y:c=JSON.parse(y))}const m=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),x=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(d={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,p=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const m=await s.text();try{d=JSON.parse(m),Array.isArray(d)&&s.status===404&&(c=[],d=null,p=200,f="OK")}catch{s.status===404&&m===""?(p=204,f="No Content"):d={message:m}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,p=200,f="OK"),d&&this.shouldThrowOnError)throw new hxe.default(d)}return{error:d,data:c,count:h,status:p,statusText:f}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,u;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=s==null?void 0:s.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};V_.default=pxe;var fxe=mi&&mi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(W_,"__esModule",{value:!0});const mxe=fxe(V_);let gxe=class extends mxe.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const u=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${d}"; options=${u};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};W_.default=gxe;var xxe=mi&&mi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zb,"__esModule",{value:!0});const yxe=xxe(W_);let vxe=class extends yxe.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Zb.default=vxe;var bxe=mi&&mi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(U_,"__esModule",{value:!0});const $y=bxe(Zb);let wxe=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new $y.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const i=t.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(i.length>0){const o=[...new Set(i)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new $y.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const u=t.reduce((d,c)=>d.concat(Object.keys(c)),[]);if(u.length>0){const d=[...new Set(u)].map(c=>`"${c}"`);this.url.searchParams.set("columns",d.join(","))}}return new $y.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new $y.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new $y.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};U_.default=wxe;var q_={},G_={};Object.defineProperty(G_,"__esModule",{value:!0});G_.version=void 0;G_.version="0.0.0-automated";Object.defineProperty(q_,"__esModule",{value:!0});q_.DEFAULT_HEADERS=void 0;const Nxe=G_;q_.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Nxe.version}`};var Wq=mi&&mi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(I$,"__esModule",{value:!0});const Sxe=Wq(U_),_xe=Wq(Zb),kxe=q_;let Cxe=class Vq{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},kxe.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new Sxe.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Vq(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let u;n||a?(i=n?"HEAD":"GET",Object.entries(r).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{o.searchParams.append(c,h)})):(i="POST",u=r);const d=Object.assign({},this.headers);return s&&(d.Prefer=`count=${s}`),new _xe.default({method:i,url:o,headers:d,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};I$.default=Cxe;var qg=mi&&mi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ps,"__esModule",{value:!0});Ps.PostgrestError=Ps.PostgrestBuilder=Ps.PostgrestTransformBuilder=Ps.PostgrestFilterBuilder=Ps.PostgrestQueryBuilder=Ps.PostgrestClient=void 0;const Hq=qg(I$);Ps.PostgrestClient=Hq.default;const qq=qg(U_);Ps.PostgrestQueryBuilder=qq.default;const Gq=qg(Zb);Ps.PostgrestFilterBuilder=Gq.default;const Kq=qg(W_);Ps.PostgrestTransformBuilder=Kq.default;const Qq=qg(V_);Ps.PostgrestBuilder=Qq.default;const Xq=qg(H_);Ps.PostgrestError=Xq.default;var Ixe=Ps.default={PostgrestClient:Hq.default,PostgrestQueryBuilder:qq.default,PostgrestFilterBuilder:Gq.default,PostgrestTransformBuilder:Kq.default,PostgrestBuilder:Qq.default,PostgrestError:Xq.default};const{PostgrestClient:Exe,PostgrestQueryBuilder:Pot,PostgrestFilterBuilder:Lot,PostgrestTransformBuilder:zot,PostgrestBuilder:Bot,PostgrestError:Uot}=Ixe;function Txe(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const jxe=Txe(),Axe="2.11.15",$xe=`realtime-js/${Axe}`,Rxe="1.0.0",Yq=1e4,Dxe=1e3;var bv;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(bv||(bv={}));var Ua;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ua||(Ua={}));var co;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(co||(co={}));var iT;(function(e){e.websocket="websocket"})(iT||(iT={}));var Cd;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Cd||(Cd={}));class Mxe{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const u=n.decode(t.slice(i,i+s));i=i+s;const d=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:u,payload:d}}}class Jq{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var en;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(en||(en={}));const c3=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=Fxe(i,e,t,a),s),{})},Fxe=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?Zq(s,i):oT(i)},Zq=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return zxe(t,r)}switch(e){case en.bool:return Oxe(t);case en.float4:case en.float8:case en.int2:case en.int4:case en.int8:case en.numeric:case en.oid:return Pxe(t);case en.json:case en.jsonb:return Lxe(t);case en.timestamp:return Bxe(t);case en.abstime:case en.date:case en.daterange:case en.int4range:case en.int8range:case en.money:case en.reltime:case en.text:case en.time:case en.timestamptz:case en.timetz:case en.tsrange:case en.tstzrange:return oT(t);default:return oT(t)}},oT=e=>e,Oxe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Pxe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Lxe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},zxe=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>Zq(t,o))}return e},Bxe=e=>typeof e=="string"?e.replace(" ","T"):e,eG=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class R2{constructor(t,r,n={},a=Yq){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var d3;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(d3||(d3={}));class wv{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=wv.syncState(this.state,a,s,i),this.pendingDiffs.forEach(u=>{this.state=wv.syncDiff(this.state,u,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=wv.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},u={};return this.map(s,(d,c)=>{i[d]||(u[d]=c)}),this.map(i,(d,c)=>{const h=s[d];if(h){const p=c.map(x=>x.presence_ref),f=h.map(x=>x.presence_ref),g=c.filter(x=>f.indexOf(x.presence_ref)<0),m=h.filter(x=>p.indexOf(x.presence_ref)<0);g.length>0&&(o[d]=g),m.length>0&&(u[d]=m)}else o[d]=c}),this.syncDiff(s,{joins:o,leaves:u},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,u)=>{var d;const c=(d=t[o])!==null&&d!==void 0?d:[];if(t[o]=this.cloneDeep(u),c.length>0){const h=t[o].map(f=>f.presence_ref),p=c.filter(f=>h.indexOf(f.presence_ref)<0);t[o].unshift(...p)}n(o,c,u)}),this.map(i,(o,u)=>{let d=t[o];if(!d)return;const c=u.map(h=>h.presence_ref);d=d.filter(h=>c.indexOf(h.presence_ref)<0),t[o]=d,a(o,d,u),d.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var h3;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(h3||(h3={}));var p3;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(p3||(p3={}));var Rl;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Rl||(Rl={}));class E${constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ua.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new R2(this,co.join,this.params,this.timeout),this.rejoinTimer=new Jq(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ua.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ua.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ua.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ua.errored,this.rejoinTimer.scheduleTimeout())}),this._on(co.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new wv(this),this.broadcastEndpointURL=eG(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Ua.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(c=>t==null?void 0:t(Rl.CHANNEL_ERROR,c)),this._onClose(()=>t==null?void 0:t(Rl.CLOSED));const u={},d={broadcast:s,presence:i,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(c=>c.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){t==null||t(Rl.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,f=(h=p==null?void 0:p.length)!==null&&h!==void 0?h:0,g=[];for(let m=0;m<f;m++){const x=p[m],{filter:{event:y,schema:v,table:b,filter:N}}=x,S=c&&c[m];if(S&&S.event===y&&S.schema===v&&S.table===b&&S.filter===N)g.push(Object.assign(Object.assign({},x),{id:S.id}));else{this.unsubscribe(),this.state=Ua.errored,t==null||t(Rl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Rl.SUBSCRIBED);return}}).receive("error",c=>{this.state=Ua.errored,t==null||t(Rl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Rl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,u;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ua.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(co.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new R2(this,co.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new R2(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:u,leave:d,join:c}=co;if(n&&[o,u,d,c].indexOf(i)>=0&&n!==this._joinRef())return;let p=this._onMessage(i,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(f=>{var g,m,x;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=f.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(f=>f.callback(p,n)):(s=this.bindings[i])===null||s===void 0||s.filter(f=>{var g,m,x,y,v,b;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in f){const N=f.id,S=(g=f.filter)===null||g===void 0?void 0:g.event;return N&&((m=r.ids)===null||m===void 0?void 0:m.includes(N))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const N=(v=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return N==="*"||N===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===i}).map(f=>{if(typeof p=="object"&&"ids"in p){const g=p.data,{schema:m,table:x,commit_timestamp:y,type:v,errors:b}=g;p=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:y,eventType:v,new:{},old:{},errors:b}),this._getPayloadRecords(g))}f.callback(p,n)})}_isClosed(){return this.state===Ua.closed}_isJoined(){return this.state===Ua.joined}_isJoining(){return this.state===Ua.joining}_isLeaving(){return this.state===Ua.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&E$.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(co.close,{},t)}_onError(t){this._on(co.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ua.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=c3(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=c3(t.columns,t.old_record)),r}}const f3=()=>{},Uxe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Wxe{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Yq,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=f3,this.ref=0,this.logger=f3,this.conn=null,this.sendBuffer=[],this.serializer=new Mxe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>Vg(async()=>{const{default:u}=await Promise.resolve().then(()=>Hg);return{default:u}},void 0).then(({default:u})=>u(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${t}/${iT.websocket}`,this.httpEndpoint=eG(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,i)=>i(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Jq(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=jxe),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Rxe}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case bv.connecting:return Cd.Connecting;case bv.open:return Cd.Open;case bv.closing:return Cd.Closing;default:return Cd.Closed}}isConnected(){return this.connectionState()===Cd.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new E$(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:$xe};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(co.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(Dxe,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:s,ref:i}=r;n==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${a} ${i&&"("+i+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(co.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Uxe],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class T$ extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ga(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Vxe extends T${constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class lT extends T${constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Hxe=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};const tG=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Vg(async()=>{const{default:n}=await Promise.resolve().then(()=>Hg);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},qxe=()=>Hxe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Vg(()=>Promise.resolve().then(()=>Hg),void 0)).Response:Response}),uT=e=>{if(Array.isArray(e))return e.map(r=>uT(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=uT(n)}),t};var qh=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};const D2=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Gxe=(e,t,r)=>qh(void 0,void 0,void 0,function*(){const n=yield qxe();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new Vxe(D2(a),e.status||500))}).catch(a=>{t(new lT(D2(a),a))}):t(new lT(D2(e),e))}),Kxe=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function e0(e,t,r,n,a,s){return qh(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,Kxe(t,n,a,s)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>Gxe(u,o,n))})})}function VN(e,t,r,n){return qh(this,void 0,void 0,function*(){return e0(e,"GET",t,r,n)})}function Mu(e,t,r,n,a){return qh(this,void 0,void 0,function*(){return e0(e,"POST",t,n,a,r)})}function Qxe(e,t,r,n,a){return qh(this,void 0,void 0,function*(){return e0(e,"PUT",t,n,a,r)})}function Xxe(e,t,r,n){return qh(this,void 0,void 0,function*(){return e0(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function rG(e,t,r,n,a){return qh(this,void 0,void 0,function*(){return e0(e,"DELETE",t,n,a,r)})}var Es=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};const Yxe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},m3={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Jxe{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=tG(a)}uploadOrUpdate(t,r,n,a){return Es(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},m3),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,u&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const d=this._removeEmptyFolders(r),c=this._getFinalPath(d),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:t,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),p=yield h.json();return h.ok?{data:{path:d,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(s){if(ga(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Es(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Es(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let u;const d=Object.assign({upsert:m3.upsert},a),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",d.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",d.cacheControl)):(u=n,c["cache-control"]=`max-age=${d.cacheControl}`,c["content-type"]=d.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:c}),p=yield h.json();return h.ok?{data:{path:s,fullPath:p.Key},error:null}:{data:null,error:p}}catch(u){if(ga(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return Es(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Mu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new T$("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(ga(n))return{data:null,error:n};throw n}})}update(t,r,n){return Es(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Es(this,void 0,void 0,function*(){try{return{data:yield Mu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(ga(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Es(this,void 0,void 0,function*(){try{return{data:{path:(yield Mu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(ga(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Es(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Mu(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(ga(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Es(this,void 0,void 0,function*(){try{const a=yield Mu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(ga(a))return{data:null,error:a};throw a}})}download(t,r){return Es(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield VN(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(ga(o))return{data:null,error:o};throw o}})}info(t){return Es(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield VN(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:uT(n),error:null}}catch(n){if(ga(n))return{data:null,error:n};throw n}})}exists(t){return Es(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Xxe(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ga(n)&&n instanceof lT){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&a.push(u);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${d}`)}}}remove(t){return Es(this,void 0,void 0,function*(){try{return{data:yield rG(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(ga(r))return{data:null,error:r};throw r}})}list(t,r,n){return Es(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Yxe),r),{prefix:t||""});return{data:yield Mu(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(ga(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Zxe="2.7.1",eye={"X-Client-Info":`storage-js/${Zxe}`};var Df=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};class tye{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},eye),r),this.fetch=tG(n)}listBuckets(){return Df(this,void 0,void 0,function*(){try{return{data:yield VN(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ga(t))return{data:null,error:t};throw t}})}getBucket(t){return Df(this,void 0,void 0,function*(){try{return{data:yield VN(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(ga(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Df(this,void 0,void 0,function*(){try{return{data:yield Mu(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ga(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Df(this,void 0,void 0,function*(){try{return{data:yield Qxe(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ga(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Df(this,void 0,void 0,function*(){try{return{data:yield Mu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(ga(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Df(this,void 0,void 0,function*(){try{return{data:yield rG(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(ga(r))return{data:null,error:r};throw r}})}}class rye extends tye{constructor(t,r={},n){super(t,r,n)}from(t){return new Jxe(this.url,this.headers,t,this.fetch)}}const nye="2.51.0";let Yy="";typeof Deno<"u"?Yy="deno":typeof document<"u"?Yy="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yy="react-native":Yy="node";const aye={"X-Client-Info":`supabase-js-${Yy}/${nye}`},sye={headers:aye},iye={schema:"public"},oye={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lye={};var uye=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};const cye=e=>{let t;return e?t=e:typeof fetch>"u"?t=zq:t=fetch,(...r)=>t(...r)},dye=()=>typeof Headers>"u"?Bq:Headers,hye=(e,t,r)=>{const n=cye(r),a=dye();return(s,i)=>uye(void 0,void 0,void 0,function*(){var o;const u=(o=yield t())!==null&&o!==void 0?o:e;let d=new a(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${u}`),n(s,Object.assign(Object.assign({},i),{headers:d}))})};var pye=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};function fye(e){return e.endsWith("/")?e:e+"/"}function mye(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:u,auth:d,realtime:c,global:h}=t,p={db:Object.assign(Object.assign({},u),a),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},c),i),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>pye(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const nG="2.71.0",Hf=30*1e3,cT=3,M2=cT*Hf,gye="http://localhost:9999",xye="supabase.auth.token",yye={"X-Client-Info":`gotrue-js/${nG}`},dT="X-Supabase-Api-Version",aG={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vye=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,bye=10*60*1e3;class j$ extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Xt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class wye extends j${constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Nye(e){return Xt(e)&&e.name==="AuthApiError"}class sG extends j${constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Gc extends j${constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Tu extends Gc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Sye(e){return Xt(e)&&e.name==="AuthSessionMissingError"}class r1 extends Gc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class n1 extends Gc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class a1 extends Gc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _ye(e){return Xt(e)&&e.name==="AuthImplicitGrantRedirectError"}class g3 extends Gc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class hT extends Gc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function F2(e){return Xt(e)&&e.name==="AuthRetryableFetchError"}class x3 extends Gc{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class pT extends Gc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const HN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),y3=` 	
\r=`.split(""),kye=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<y3.length;t+=1)e[y3[t].charCodeAt(0)]=-2;for(let t=0;t<HN.length;t+=1)e[HN[t].charCodeAt(0)]=t;return e})();function v3(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(HN[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(HN[n]),t.queuedBits-=6}}function iG(e,t,r){const n=kye[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function b3(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{Eye(i,n,r)};for(let i=0;i<e.length;i+=1)iG(e.charCodeAt(i),a,s);return t.join("")}function Cye(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Iye(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}Cye(n,t)}}function Eye(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Tye(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)iG(e.charCodeAt(a),r,n);return new Uint8Array(t)}function jye(e){const t=[];return Iye(e,r=>t.push(r)),new Uint8Array(t)}function Aye(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>v3(a,r,n)),v3(null,r,n),t.join("")}function $ye(e){return Math.round(Date.now()/1e3)+e}function Rye(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ro=()=>typeof window<"u"&&typeof document<"u",md={tested:!1,writable:!1},oG=()=>{if(!ro())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(md.tested)return md.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),md.tested=!0,md.writable=!0}catch{md.tested=!0,md.writable=!1}return md.writable};function Dye(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const lG=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Vg(async()=>{const{default:n}=await Promise.resolve().then(()=>Hg);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Mye=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",qf=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},gd=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Su=async(e,t)=>{await e.removeItem(t)};class K_{constructor(){this.promise=new K_.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}K_.promiseConstructor=Promise;function O2(e){const t=e.split(".");if(t.length!==3)throw new pT("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!vye.test(t[n]))throw new pT("JWT not in base64url format");return{header:JSON.parse(b3(t[0])),payload:JSON.parse(b3(t[1])),signature:Tye(t[2]),raw:{header:t[0],payload:t[1]}}}async function Fye(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Oye(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function Pye(e){return("0"+e.toString(16)).substr(-2)}function Lye(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,Pye).join("")}async function zye(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function Bye(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await zye(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mf(e,t,r=!1){const n=Lye();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await qf(e,`${t}-code-verifier`,a);const s=await Bye(n);return[s,n===s?"plain":"s256"]}const Uye=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Wye(e){const t=e.headers.get(dT);if(!t||!t.match(Uye))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Vye(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Hye(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const qye=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ff(e){if(!qye.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function P2(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var Gye=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const wd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Kye=[502,503,504];async function w3(e){var t;if(!Mye(e))throw new hT(wd(e),0);if(Kye.includes(e.status))throw new hT(wd(e),e.status);let r;try{r=await e.json()}catch(s){throw new sG(wd(s),s)}let n;const a=Wye(e);if(a&&a.getTime()>=aG["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new x3(wd(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Tu}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new x3(wd(r),e.status,r.weak_password.reasons);throw new wye(wd(r),e.status||500,n)}const Qye=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function dr(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[dT]||(s[dT]=aG["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await Xye(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function Xye(e,t,r,n,a,s){const i=Qye(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(u){throw console.error(u),new hT(wd(u),0)}if(o.ok||await w3(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await w3(u)}}function Al(e){var t;let r=null;eve(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=$ye(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function N3(e){const t=Al(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Bu(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Yye(e){return{data:e,error:null}}function Jye(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=Gye(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},u=Object.assign({},i);return{data:{properties:o,user:u},error:null}}function Zye(e){return e}function eve(e){return e.access_token&&e.refresh_token&&e.expires_in}const L2=["global","local","others"];var tve=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class rve{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=lG(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=L2[0]){if(L2.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${L2.join(", ")}`);try{return await dr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Xt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await dr(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Bu})}catch(n){if(Xt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=tve(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await dr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Jye,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Xt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await dr(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Bu})}catch(r){if(Xt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,u;try{const d={nextPage:null,lastPage:0,total:0},c=await dr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:Zye});if(c.error)throw c.error;const h=await c.json(),p=(i=c.headers.get("x-total-count"))!==null&&i!==void 0?i:0,f=(u=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return f.length>0&&(f.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=m}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Xt(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Ff(t);try{return await dr(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Bu})}catch(r){if(Xt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ff(t);try{return await dr(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Bu})}catch(n){if(Xt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Ff(t);try{return await dr(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Bu})}catch(n){if(Xt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ff(t.userId);try{const{data:r,error:n}=await dr(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ff(t.userId),Ff(t.id);try{return{data:await dr(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}}}function S3(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function nve(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Of={debug:!!(globalThis&&oG()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class uG extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ave extends uG{}async function sve(e,t,r){Of.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Of.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Of.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Of.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Of.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ave(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Of.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}nve();const ive={url:gye,storageKey:xye,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:yye,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function _3(e,t,r){return await r()}const Pf={};class Zv{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Zv.nextInstanceID,Zv.nextInstanceID+=1,this.instanceID>0&&ro()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},ive),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new rve({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=lG(a.fetch),this.lock=a.lock||_3,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ro()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=sve:this.lock=_3,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:oG()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=S3(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=S3(this.memoryStorage)),ro()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Pf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Pf[this.storageKey]=Object.assign(Object.assign({},Pf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Pf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Pf[this.storageKey]=Object.assign(Object.assign({},Pf[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${nG}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Dye(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),ro()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),_ye(s)){const u=(t=s.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Xt(r)?{error:r}:{error:new sG("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await dr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Al}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const u=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(s){if(Xt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:c,password:h,options:p}=t;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await Mf(this.storage,this.storageKey)),s=await dr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:c,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:f,code_challenge_method:g},xform:Al})}else if("phone"in t){const{phone:c,password:h,options:p}=t;s=await dr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Al})}else throw new n1("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const u=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(s){if(Xt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await dr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:N3})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await dr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:N3})}else throw new n1("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new r1}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Xt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,u,d,c,h,p,f;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:x,wallet:y,statement:v,options:b}=t;let N;if(ro())if(typeof y=="object")N=y;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))N=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=y}const S=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in N&&N.signIn){const _=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),v?{statement:v}:null));let C;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")C=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)C=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)g=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),m=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${S.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(n=b==null?void 0:b.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=b==null?void 0:b.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((u=b==null?void 0:b.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(c=b==null?void 0:b.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const _=await N.signMessage(new TextEncoder().encode(g),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=_}}try{const{data:x,error:y}=await dr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Aye(m)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Al});if(y)throw y;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new r1}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:y})}catch(x){if(Xt(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await gd(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await dr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Al});if(await Su(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new r1}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Xt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await dr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Al}),{data:u,error:d}=o;return d?{data:{user:null,session:null},error:d}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new r1}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:d})}catch(r){if(Xt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:u}=t;let d=null,c=null;this.flowType==="pkce"&&([d,c]=await Mf(this.storage,this.storageKey));const{error:h}=await dr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:d,code_challenge_method:c},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:u}=t,{data:d,error:c}=await dr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=u==null?void 0:u.data)!==null&&a!==void 0?a:{},create_user:(s=u==null?void 0:u.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:c}}throw new n1("You must provide either an email or phone number.")}catch(o){if(Xt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await dr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Al});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,d=i.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(a){if(Xt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Mf(this.storage,this.storageKey)),await dr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:Yye})}catch(s){if(Xt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Tu;const{error:a}=await dr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Xt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await dr(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await dr(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new n1("You must provide either an email or phone number and a type")}catch(r){if(Xt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await gd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<M2:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await gd(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=P2()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,d,c)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,d,c))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await dr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Bu}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Tu}:await dr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Bu})})}catch(r){if(Xt(r))return Sye(r)&&(await this._removeSession(),await Su(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Tu;const i=a.session;let o=null,u=null;this.flowType==="pkce"&&t.email!=null&&([o,u]=await Mf(this.storage,this.storageKey));const{data:d,error:c}=await dr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:u}),jwt:i.access_token,xform:Bu});if(c)throw c;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Xt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Tu;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=O2(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:u}=await this._getUser(t.access_token);if(u)throw u;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Xt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Tu;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Xt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!ro())throw new a1("No browser detected.");if(t.error||t.error_description||t.error_code)throw new a1(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new g3("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new a1("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new g3("No code detected.");const{data:v,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:u,token_type:d}=t;if(!s||!o||!i||!d)throw new a1("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let p=c+h;u&&(p=parseInt(u));const f=p-c;f*1e3<=Hf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=p-h;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,p,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,p,c);const{data:m,error:x}=await this._getUser(s);if(x)throw x;const y={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:h,expires_at:p,refresh_token:i,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(Xt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await gd(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(Nye(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Su(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Rye(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Mf(this.storage,this.storageKey,!0));try{return await dr(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Xt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,u,d,c;const{data:h,error:p}=s;if(p)throw p;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await dr(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&c!==void 0?c:void 0})});if(a)throw a;return ro()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Xt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await dr(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Oye(async a=>(a>0&&await Fye(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await dr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Al})),(a,s)=>{const i=200*Math.pow(2,a);return s&&F2(s)&&Date.now()+i-n<Hf})}catch(n){if(this._debug(r,"error",n),Xt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ro()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await gd(this.storage,this.storageKey);if(a&&this.userStorage){let i=await gd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await qf(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:P2()}else if(a&&!a.user&&!a.user){const i=await gd(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await Su(this.storage,this.storageKey+"-user"),await qf(this.storage,this.storageKey,a)):a.user=P2()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<M2;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${M2}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),F2(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Tu;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new K_;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Tu;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Xt(s)){const i={session:null,error:s};return F2(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(u){s.push(u)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await qf(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=structuredClone(a);await qf(this.storage,this.storageKey,s)}else{const a=structuredClone(r);await qf(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Su(this.storage,this.storageKey),await Su(this.storage,this.storageKey+"-code-verifier"),await Su(this.storage,this.storageKey+"-user"),this.userStorage&&await Su(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ro()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Hf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Hf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Hf}ms, refresh threshold is ${cT} ticks`),a<=cT&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof uG)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ro()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Mf(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await dr(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:d}=await dr(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((a=u==null?void 0:u.totp)===null||a===void 0)&&a.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await dr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await dr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=O2(a.access_token);let o=null;i.aal&&(o=i.aal);let u=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const c=i.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+bye>a)return n;const{data:s,error:i}=await dr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};n=f.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:u}}=O2(n);r!=null&&r.allowExpired||Vye(s.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:s,header:a,signature:i},error:null}}const c=Hye(a.alg),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,i,jye(`${o}.${u}`)))throw new pT("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Xt(n))return{data:null,error:n};throw n}}}Zv.nextInstanceID=0;const ove=Zv;class lve extends ove{constructor(t){super(t)}}var uve=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(c){try{d(n.next(c))}catch(h){i(h)}}function u(c){try{d(n.throw(c))}catch(h){i(h)}}function d(c){c.done?s(c.value):a(c.value).then(o,u)}d((n=n.apply(e,t||[])).next())})};class cve{constructor(t,r,n){var a,s,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=fye(t),u=new URL(o);this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const d=`sb-${u.hostname.split(".")[0]}-auth-token`,c={db:iye,realtime:lye,auth:Object.assign(Object.assign({},oye),{storageKey:d}),global:sye},h=mye(n??{},c);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=hye(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Exe(new URL("rest/v1",u).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new axe(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new rye(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return uve(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:i,lock:o,debug:u},d,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lve({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:i,lock:o,debug:u,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Wxe(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const dve=(e,t,r)=>new cve(e,t,r),hve="https://prqzcsajwpipfeqnqhlf.supabase.co",pve="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBycXpjc2Fqd3BpcGZlcW5xaGxmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwMDExNjksImV4cCI6MjA2NzU3NzE2OX0.vb18DnFwvqxCxVIF32FDsB8jY5sJ8iOZEEtrgNELGQQ",Sr=dve(hve,pve),fve={contact:[],screening:[{value:"pending",label:"Pending"},{value:"pass",label:"Pass"},{value:"fail",label:"Fail"}],interviews:[{value:"pending",label:"Pending"},{value:"booked",label:"Booked"},{value:"rescheduled",label:"Rescheduled"},{value:"lr_qualified",label:"LR Qualified"},{value:"lr_failed",label:"LR Failed"},{value:"offer_pending",label:"Offer Pending"},{value:"cfr_failed",label:"CFR Failed"}],decision:[{value:"offer_pending",label:"Offer Pending"},{value:"offer_sent",label:"Offer Sent"},{value:"offer_rejected",label:"Offer Rejected"},{value:"offer_accepted",label:"Offer Accepted"}]};function mve({applicant:e,isOpen:t,onClose:r,onSuccess:n}){const[a,s]=w.useState({name:"",mobile_no:"",whatsapp_number:"",city:"",stage:"contact",status:"none",campus:"none"}),[i,o]=w.useState(a),[u,d]=w.useState([]),[c,h]=w.useState(!1),[p,f]=w.useState(!1),[g,m]=w.useState(null),{toast:x}=Wt();w.useEffect(()=>{if(e&&t){const C={name:e.name||"",mobile_no:e.mobile_no||"",whatsapp_number:e.whatsapp_number||"",city:e.city||"",stage:e.stage||"contact",status:e.status||"none",campus:e.campus||"none"};s(C),o(C),f(!1),g&&(clearTimeout(g),m(null))}},[e,t]),w.useEffect(()=>{t&&y()},[t]);const y=async()=>{try{const{data:C,error:k}=await Sr.from("campus_options").select("*").eq("is_active",!0).order("name");if(k)throw k;d(C||[])}catch(C){console.error("Error fetching campus options:",C)}},v=(C,k)=>{s(I=>({...I,[C]:k}))},b=C=>{s(k=>({...k,stage:C,status:C==="contact"?"none":"pending"}))},N=async()=>{if(e){h(!0);try{const{error:C}=await Sr.from("admission_dashboard").update({name:a.name||null,mobile_no:a.mobile_no,whatsapp_number:a.whatsapp_number||null,city:a.city||null,stage:a.stage,status:a.status==="none"?null:a.status,campus:a.campus==="none"?null:a.campus,last_updated:new Date().toISOString()}).eq("id",e.id);if(C)throw C;x({title:" Applicant Updated",description:"Applicant updated successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),f(!0);const k=setTimeout(()=>{f(!1),m(null)},5e3);m(k),n(),r()}catch(C){console.error("Error updating applicant:",C),x({title:" Unable to Update Applicant",description:ut(C),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{h(!1)}}},S=async()=>{if(e)try{const{error:C}=await Sr.from("admission_dashboard").update({name:i.name||null,mobile_no:i.mobile_no,whatsapp_number:i.whatsapp_number||null,city:i.city||null,stage:i.stage,status:i.status==="none"?null:i.status,campus:i.campus==="none"?null:i.campus,last_updated:new Date().toISOString()}).eq("id",e.id);if(C)throw C;x({title:" Changes Reverted",description:"Changes have been reverted successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),f(!1),g&&(clearTimeout(g),m(null)),n()}catch(C){console.error("Error undoing changes:",C),x({title:" Unable to Undo Changes",description:ut(C),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},_=fve[a.stage]||[];return l.jsxs(l.Fragment,{children:[l.jsx(Wr,{open:t,onOpenChange:r,children:l.jsxs(Vr,{className:"max-w-md",children:[l.jsx(Hr,{children:l.jsxs(qr,{children:["Quick Edit - ",(e==null?void 0:e.name)||"Applicant"]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"name",children:"Name"}),l.jsx(Ve,{id:"name",value:a.name,onChange:C=>v("name",C.target.value),placeholder:"Enter name"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"mobile",children:"Mobile Number"}),l.jsx(Ve,{id:"mobile",value:a.mobile_no,onChange:C=>v("mobile_no",C.target.value),placeholder:"Enter mobile number",required:!0})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"whatsapp",children:"WhatsApp Number"}),l.jsx(Ve,{id:"whatsapp",value:a.whatsapp_number,onChange:C=>v("whatsapp_number",C.target.value),placeholder:"Enter WhatsApp number"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"city",children:"City"}),l.jsx(Ve,{id:"city",value:a.city,onChange:C=>v("city",C.target.value),placeholder:"Enter city"})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Stage"}),l.jsxs(Gr,{value:a.stage,onValueChange:b,children:[l.jsx(Fr,{children:l.jsx(Kr,{})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"contact",children:"Contact"}),l.jsx(gt,{value:"screening",children:"Screening"}),l.jsx(gt,{value:"interviews",children:"Interviews"}),l.jsx(gt,{value:"decision",children:"Decision"})]})]})]}),_.length>0&&l.jsxs("div",{children:[l.jsx(Ee,{children:"Status"}),l.jsxs(Gr,{value:a.status,onValueChange:C=>v("status",C),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select status"})}),l.jsx(Or,{children:_.map(C=>l.jsx(gt,{value:C.value,children:C.label},C.value))})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Campus"}),l.jsxs(Gr,{value:a.campus,onValueChange:C=>v("campus",C),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select campus"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"none",children:"Not assigned"}),u.map(C=>l.jsx(gt,{value:C.name,children:C.name},C.id))]})]})]})]}),l.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[l.jsx(le,{variant:"outline",onClick:r,children:"Cancel"}),l.jsx(le,{onClick:N,disabled:c,children:c?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Ag,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})}),p&&l.jsxs("div",{className:"fixed bottom-4 right-4 bg-card border border-border rounded-lg shadow-lg p-4 flex items-center space-x-3 z-50",children:[l.jsx("span",{className:"text-sm",children:"Changes saved successfully"}),l.jsxs(le,{variant:"outline",size:"sm",onClick:S,children:[l.jsx(Nue,{className:"w-4 h-4 mr-1"}),"Undo"]}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>f(!1),children:l.jsx(wa,{className:"w-4 h-4"})})]})]})}var k3=1,gve=.9,xve=.8,yve=.17,z2=.1,B2=.999,vve=.9999,bve=.99,wve=/[\\\/_+.#"@\[\(\{&]/,Nve=/[\\\/_+.#"@\[\(\{&]/g,Sve=/[\s-]/,cG=/[\s-]/g;function fT(e,t,r,n,a,s,i){if(s===t.length)return a===e.length?k3:bve;var o=`${a},${s}`;if(i[o]!==void 0)return i[o];for(var u=n.charAt(s),d=r.indexOf(u,a),c=0,h,p,f,g;d>=0;)h=fT(e,t,r,n,d+1,s+1,i),h>c&&(d===a?h*=k3:wve.test(e.charAt(d-1))?(h*=xve,f=e.slice(a,d-1).match(Nve),f&&a>0&&(h*=Math.pow(B2,f.length))):Sve.test(e.charAt(d-1))?(h*=gve,g=e.slice(a,d-1).match(cG),g&&a>0&&(h*=Math.pow(B2,g.length))):(h*=yve,a>0&&(h*=Math.pow(B2,d-a))),e.charAt(d)!==t.charAt(s)&&(h*=vve)),(h<z2&&r.charAt(d-1)===n.charAt(s+1)||n.charAt(s+1)===n.charAt(s)&&r.charAt(d-1)!==n.charAt(s))&&(p=fT(e,t,r,n,d+1,s+2,i),p*z2>h&&(h=p*z2)),h>c&&(c=h),d=r.indexOf(u,d+1);return i[o]=c,c}function C3(e){return e.toLowerCase().replace(cG," ")}function _ve(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,fT(e,t,C3(e),C3(t),0,0,{})}var Ry='[cmdk-group=""]',U2='[cmdk-group-items=""]',kve='[cmdk-group-heading=""]',dG='[cmdk-item=""]',I3=`${dG}:not([aria-disabled="true"])`,mT="cmdk-item-select",Gf="data-value",Cve=(e,t,r)=>_ve(e,t,r),hG=w.createContext(void 0),t0=()=>w.useContext(hG),pG=w.createContext(void 0),A$=()=>w.useContext(pG),fG=w.createContext(void 0),mG=w.forwardRef((e,t)=>{let r=Kf(()=>{var V,B;return{search:"",value:(B=(V=e.value)!=null?V:e.defaultValue)!=null?B:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),n=Kf(()=>new Set),a=Kf(()=>new Map),s=Kf(()=>new Map),i=Kf(()=>new Set),o=gG(e),{label:u,children:d,value:c,onValueChange:h,filter:p,shouldFilter:f,loop:g,disablePointerSelection:m=!1,vimBindings:x=!0,...y}=e,v=_a(),b=_a(),N=_a(),S=w.useRef(null),_=Ove();vh(()=>{if(c!==void 0){let V=c.trim();r.current.value=V,C.emit()}},[c]),vh(()=>{_(6,O)},[]);let C=w.useMemo(()=>({subscribe:V=>(i.current.add(V),()=>i.current.delete(V)),snapshot:()=>r.current,setState:(V,B,Y)=>{var re,ae,K,J;if(!Object.is(r.current[V],B)){if(r.current[V]=B,V==="search")E(),T(),_(1,j);else if(V==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Z=document.getElementById(N);Z?Z.focus():(re=document.getElementById(v))==null||re.focus()}if(_(7,()=>{var Z;r.current.selectedItemId=(Z=M())==null?void 0:Z.id,C.emit()}),Y||_(5,O),((ae=o.current)==null?void 0:ae.value)!==void 0){let Z=B??"";(J=(K=o.current).onValueChange)==null||J.call(K,Z);return}}C.emit()}},emit:()=>{i.current.forEach(V=>V())}}),[]),k=w.useMemo(()=>({value:(V,B,Y)=>{var re;B!==((re=s.current.get(V))==null?void 0:re.value)&&(s.current.set(V,{value:B,keywords:Y}),r.current.filtered.items.set(V,I(B,Y)),_(2,()=>{T(),C.emit()}))},item:(V,B)=>(n.current.add(V),B&&(a.current.has(B)?a.current.get(B).add(V):a.current.set(B,new Set([V]))),_(3,()=>{E(),T(),r.current.value||j(),C.emit()}),()=>{s.current.delete(V),n.current.delete(V),r.current.filtered.items.delete(V);let Y=M();_(4,()=>{E(),(Y==null?void 0:Y.getAttribute("id"))===V&&j(),C.emit()})}),group:V=>(a.current.has(V)||a.current.set(V,new Set),()=>{s.current.delete(V),a.current.delete(V)}),filter:()=>o.current.shouldFilter,label:u||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:v,inputId:N,labelId:b,listInnerRef:S}),[]);function I(V,B){var Y,re;let ae=(re=(Y=o.current)==null?void 0:Y.filter)!=null?re:Cve;return V?ae(V,r.current.search,B):0}function T(){if(!r.current.search||o.current.shouldFilter===!1)return;let V=r.current.filtered.items,B=[];r.current.filtered.groups.forEach(re=>{let ae=a.current.get(re),K=0;ae.forEach(J=>{let Z=V.get(J);K=Math.max(Z,K)}),B.push([re,K])});let Y=S.current;W().sort((re,ae)=>{var K,J;let Z=re.getAttribute("id"),Q=ae.getAttribute("id");return((K=V.get(Q))!=null?K:0)-((J=V.get(Z))!=null?J:0)}).forEach(re=>{let ae=re.closest(U2);ae?ae.appendChild(re.parentElement===ae?re:re.closest(`${U2} > *`)):Y.appendChild(re.parentElement===Y?re:re.closest(`${U2} > *`))}),B.sort((re,ae)=>ae[1]-re[1]).forEach(re=>{var ae;let K=(ae=S.current)==null?void 0:ae.querySelector(`${Ry}[${Gf}="${encodeURIComponent(re[0])}"]`);K==null||K.parentElement.appendChild(K)})}function j(){let V=W().find(Y=>Y.getAttribute("aria-disabled")!=="true"),B=V==null?void 0:V.getAttribute(Gf);C.setState("value",B||void 0)}function E(){var V,B,Y,re;if(!r.current.search||o.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let ae=0;for(let K of n.current){let J=(B=(V=s.current.get(K))==null?void 0:V.value)!=null?B:"",Z=(re=(Y=s.current.get(K))==null?void 0:Y.keywords)!=null?re:[],Q=I(J,Z);r.current.filtered.items.set(K,Q),Q>0&&ae++}for(let[K,J]of a.current)for(let Z of J)if(r.current.filtered.items.get(Z)>0){r.current.filtered.groups.add(K);break}r.current.filtered.count=ae}function O(){var V,B,Y;let re=M();re&&(((V=re.parentElement)==null?void 0:V.firstChild)===re&&((Y=(B=re.closest(Ry))==null?void 0:B.querySelector(kve))==null||Y.scrollIntoView({block:"nearest"})),re.scrollIntoView({block:"nearest"}))}function M(){var V;return(V=S.current)==null?void 0:V.querySelector(`${dG}[aria-selected="true"]`)}function W(){var V;return Array.from(((V=S.current)==null?void 0:V.querySelectorAll(I3))||[])}function q(V){let B=W()[V];B&&C.setState("value",B.getAttribute(Gf))}function P(V){var B;let Y=M(),re=W(),ae=re.findIndex(J=>J===Y),K=re[ae+V];(B=o.current)!=null&&B.loop&&(K=ae+V<0?re[re.length-1]:ae+V===re.length?re[0]:re[ae+V]),K&&C.setState("value",K.getAttribute(Gf))}function A(V){let B=M(),Y=B==null?void 0:B.closest(Ry),re;for(;Y&&!re;)Y=V>0?Mve(Y,Ry):Fve(Y,Ry),re=Y==null?void 0:Y.querySelector(I3);re?C.setState("value",re.getAttribute(Gf)):P(V)}let L=()=>q(W().length-1),z=V=>{V.preventDefault(),V.metaKey?L():V.altKey?A(1):P(1)},$=V=>{V.preventDefault(),V.metaKey?q(0):V.altKey?A(-1):P(-1)};return w.createElement(at.div,{ref:t,tabIndex:-1,...y,"cmdk-root":"",onKeyDown:V=>{var B;(B=y.onKeyDown)==null||B.call(y,V);let Y=V.nativeEvent.isComposing||V.keyCode===229;if(!(V.defaultPrevented||Y))switch(V.key){case"n":case"j":{x&&V.ctrlKey&&z(V);break}case"ArrowDown":{z(V);break}case"p":case"k":{x&&V.ctrlKey&&$(V);break}case"ArrowUp":{$(V);break}case"Home":{V.preventDefault(),q(0);break}case"End":{V.preventDefault(),L();break}case"Enter":{V.preventDefault();let re=M();if(re){let ae=new Event(mT);re.dispatchEvent(ae)}}}}},w.createElement("label",{"cmdk-label":"",htmlFor:k.inputId,id:k.labelId,style:Lve},u),Q_(e,V=>w.createElement(pG.Provider,{value:C},w.createElement(hG.Provider,{value:k},V))))}),Ive=w.forwardRef((e,t)=>{var r,n;let a=_a(),s=w.useRef(null),i=w.useContext(fG),o=t0(),u=gG(e),d=(n=(r=u.current)==null?void 0:r.forceMount)!=null?n:i==null?void 0:i.forceMount;vh(()=>{if(!d)return o.item(a,i==null?void 0:i.id)},[d]);let c=xG(a,s,[e.value,e.children,s],e.keywords),h=A$(),p=kc(_=>_.value&&_.value===c.current),f=kc(_=>d||o.filter()===!1?!0:_.search?_.filtered.items.get(a)>0:!0);w.useEffect(()=>{let _=s.current;if(!(!_||e.disabled))return _.addEventListener(mT,g),()=>_.removeEventListener(mT,g)},[f,e.onSelect,e.disabled]);function g(){var _,C;m(),(C=(_=u.current).onSelect)==null||C.call(_,c.current)}function m(){h.setState("value",c.current,!0)}if(!f)return null;let{disabled:x,value:y,onSelect:v,forceMount:b,keywords:N,...S}=e;return w.createElement(at.div,{ref:tu(s,t),...S,id:a,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!p,"data-disabled":!!x,"data-selected":!!p,onPointerMove:x||o.getDisablePointerSelection()?void 0:m,onClick:x?void 0:g},e.children)}),Eve=w.forwardRef((e,t)=>{let{heading:r,children:n,forceMount:a,...s}=e,i=_a(),o=w.useRef(null),u=w.useRef(null),d=_a(),c=t0(),h=kc(f=>a||c.filter()===!1?!0:f.search?f.filtered.groups.has(i):!0);vh(()=>c.group(i),[]),xG(i,o,[e.value,e.heading,u]);let p=w.useMemo(()=>({id:i,forceMount:a}),[a]);return w.createElement(at.div,{ref:tu(o,t),...s,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&w.createElement("div",{ref:u,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),Q_(e,f=>w.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},w.createElement(fG.Provider,{value:p},f))))}),Tve=w.forwardRef((e,t)=>{let{alwaysRender:r,...n}=e,a=w.useRef(null),s=kc(i=>!i.search);return!r&&!s?null:w.createElement(at.div,{ref:tu(a,t),...n,"cmdk-separator":"",role:"separator"})}),jve=w.forwardRef((e,t)=>{let{onValueChange:r,...n}=e,a=e.value!=null,s=A$(),i=kc(d=>d.search),o=kc(d=>d.selectedItemId),u=t0();return w.useEffect(()=>{e.value!=null&&s.setState("search",e.value)},[e.value]),w.createElement(at.input,{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":u.listId,"aria-labelledby":u.labelId,"aria-activedescendant":o,id:u.inputId,type:"text",value:a?e.value:i,onChange:d=>{a||s.setState("search",d.target.value),r==null||r(d.target.value)}})}),Ave=w.forwardRef((e,t)=>{let{children:r,label:n="Suggestions",...a}=e,s=w.useRef(null),i=w.useRef(null),o=kc(d=>d.selectedItemId),u=t0();return w.useEffect(()=>{if(i.current&&s.current){let d=i.current,c=s.current,h,p=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let f=d.offsetHeight;c.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return p.observe(d),()=>{cancelAnimationFrame(h),p.unobserve(d)}}},[]),w.createElement(at.div,{ref:tu(s,t),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":n,id:u.listId},Q_(e,d=>w.createElement("div",{ref:tu(i,u.listInnerRef),"cmdk-list-sizer":""},d)))}),$ve=w.forwardRef((e,t)=>{let{open:r,onOpenChange:n,overlayClassName:a,contentClassName:s,container:i,...o}=e;return w.createElement(b$,{open:r,onOpenChange:n},w.createElement(w$,{container:i},w.createElement(R_,{"cmdk-overlay":"",className:a}),w.createElement(D_,{"aria-label":e.label,"cmdk-dialog":"",className:s},w.createElement(mG,{ref:t,...o}))))}),Rve=w.forwardRef((e,t)=>kc(r=>r.filtered.count===0)?w.createElement(at.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Dve=w.forwardRef((e,t)=>{let{progress:r,children:n,label:a="Loading...",...s}=e;return w.createElement(at.div,{ref:t,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Q_(e,i=>w.createElement("div",{"aria-hidden":!0},i)))}),ei=Object.assign(mG,{List:Ave,Item:Ive,Input:jve,Group:Eve,Separator:Tve,Dialog:$ve,Empty:Rve,Loading:Dve});function Mve(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function Fve(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function gG(e){let t=w.useRef(e);return vh(()=>{t.current=e}),t}var vh=typeof window>"u"?w.useEffect:w.useLayoutEffect;function Kf(e){let t=w.useRef();return t.current===void 0&&(t.current=e()),t}function kc(e){let t=A$(),r=()=>e(t.snapshot());return w.useSyncExternalStore(t.subscribe,r,r)}function xG(e,t,r,n=[]){let a=w.useRef(),s=t0();return vh(()=>{var i;let o=(()=>{var d;for(let c of r){if(typeof c=="string")return c.trim();if(typeof c=="object"&&"current"in c)return c.current?(d=c.current.textContent)==null?void 0:d.trim():a.current}})(),u=n.map(d=>d.trim());s.value(e,o,u),(i=t.current)==null||i.setAttribute(Gf,o),a.current=o}),a}var Ove=()=>{let[e,t]=w.useState(),r=Kf(()=>new Map);return vh(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,a)=>{r.current.set(n,a),t({})}};function Pve(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Q_({asChild:e,children:t},r){return e&&w.isValidElement(t)?w.cloneElement(Pve(t),{ref:t.ref},r(t.props.children)):r(t)}var Lve={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const $$=w.forwardRef(({className:e,...t},r)=>l.jsx(ei,{ref:r,className:Ue("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));$$.displayName=ei.displayName;const R$=w.forwardRef(({className:e,...t},r)=>l.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[l.jsx(Ja,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),l.jsx(ei.Input,{ref:r,className:Ue("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));R$.displayName=ei.Input.displayName;const D$=w.forwardRef(({className:e,...t},r)=>l.jsx(ei.List,{ref:r,className:Ue("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));D$.displayName=ei.List.displayName;const M$=w.forwardRef((e,t)=>l.jsx(ei.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));M$.displayName=ei.Empty.displayName;const F$=w.forwardRef(({className:e,...t},r)=>l.jsx(ei.Group,{ref:r,className:Ue("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));F$.displayName=ei.Group.displayName;const zve=w.forwardRef(({className:e,...t},r)=>l.jsx(ei.Separator,{ref:r,className:Ue("-mx-1 h-px bg-border",e),...t}));zve.displayName=ei.Separator.displayName;const O$=w.forwardRef(({className:e,...t},r)=>l.jsx(ei.Item,{ref:r,className:Ue("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));O$.displayName=ei.Item.displayName;var X_="Popover",[yG,Wot]=Ia(X_,[Vc]),r0=Vc(),[Bve,Kc]=yG(X_),vG=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:s,modal:i=!1}=e,o=r0(t),u=w.useRef(null),[d,c]=w.useState(!1),[h,p]=So({prop:n,defaultProp:a??!1,onChange:s,caller:X_});return l.jsx(o_,{...o,children:l.jsx(Bve,{scope:t,contentId:_a(),triggerRef:u,open:h,onOpenChange:p,onOpenToggle:w.useCallback(()=>p(f=>!f),[p]),hasCustomAnchor:d,onCustomAnchorAdd:w.useCallback(()=>c(!0),[]),onCustomAnchorRemove:w.useCallback(()=>c(!1),[]),modal:i,children:r})})};vG.displayName=X_;var bG="PopoverAnchor",Uve=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Kc(bG,r),s=r0(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=a;return w.useEffect(()=>(i(),()=>o()),[i,o]),l.jsx(Lb,{...s,...n,ref:t})});Uve.displayName=bG;var wG="PopoverTrigger",NG=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Kc(wG,r),s=r0(r),i=Bt(t,a.triggerRef),o=l.jsx(at.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":IG(a.open),...n,ref:i,onClick:ze(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:l.jsx(Lb,{asChild:!0,...s,children:o})});NG.displayName=wG;var P$="PopoverPortal",[Wve,Vve]=yG(P$,{forceMount:void 0}),SG=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,s=Kc(P$,t);return l.jsx(Wve,{scope:t,forceMount:r,children:l.jsx(fa,{present:r||s.open,children:l.jsx(Tg,{asChild:!0,container:a,children:n})})})};SG.displayName=P$;var tg="PopoverContent",_G=w.forwardRef((e,t)=>{const r=Vve(tg,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,s=Kc(tg,e.__scopePopover);return l.jsx(fa,{present:n||s.open,children:s.modal?l.jsx(qve,{...a,ref:t}):l.jsx(Gve,{...a,ref:t})})});_G.displayName=tg;var Hve=Nc("PopoverContent.RemoveScroll"),qve=w.forwardRef((e,t)=>{const r=Kc(tg,e.__scopePopover),n=w.useRef(null),a=Bt(t,n),s=w.useRef(!1);return w.useEffect(()=>{const i=n.current;if(i)return I_(i)},[]),l.jsx(Jb,{as:Hve,allowPinchZoom:!0,children:l.jsx(kG,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ze(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),s.current||(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ze(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,u=o.button===0&&o.ctrlKey===!0,d=o.button===2||u;s.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:ze(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Gve=w.forwardRef((e,t)=>{const r=Kc(tg,e.__scopePopover),n=w.useRef(!1),a=w.useRef(!1);return l.jsx(kG,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:s=>{var u,d;(u=e.onInteractOutside)==null||u.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((d=r.triggerRef.current)==null?void 0:d.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),kG=w.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:c,...h}=e,p=Kc(tg,r),f=r0(r);return C_(),l.jsx(Yb,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:s,children:l.jsx(Vh,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:c,onEscapeKeyDown:o,onPointerDownOutside:u,onFocusOutside:d,onDismiss:()=>p.onOpenChange(!1),children:l.jsx(l_,{"data-state":IG(p.open),role:"dialog",id:p.contentId,...f,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),CG="PopoverClose",Kve=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Kc(CG,r);return l.jsx(at.button,{type:"button",...n,ref:t,onClick:ze(e.onClick,()=>a.onOpenChange(!1))})});Kve.displayName=CG;var Qve="PopoverArrow",Xve=w.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=r0(r);return l.jsx(u_,{...a,...n,ref:t})});Xve.displayName=Qve;function IG(e){return e?"open":"closed"}var Yve=vG,Jve=NG,Zve=SG,EG=_G;const km=Yve,Cm=Jve,Jd=w.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>l.jsx(Zve,{children:l.jsx(EG,{ref:a,align:t,sideOffset:r,className:Ue("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Jd.displayName=EG.displayName;const sr=w.memo(function({options:t,value:r,onValueChange:n,placeholder:a="Select option...",searchPlaceholder:s="Search...",emptyText:i="No option found.",disabled:o=!1,className:u}){const[d,c]=w.useState(!1),[h,p]=w.useState(""),f=w.useMemo(()=>t.find(y=>y.value===r),[t,r]),g=w.useMemo(()=>{if(!h)return t;const y=h.toLowerCase();return t.filter(v=>v.label.toLowerCase().includes(y))},[t,h]),m=w.useCallback(y=>{n(y===r?"":y),c(!1),p("")},[r,n]),x=w.useCallback(y=>{c(y),y||p("")},[]);return l.jsxs(km,{open:d,onOpenChange:x,children:[l.jsx(Cm,{asChild:!0,children:l.jsxs(le,{variant:"outline",role:"combobox","aria-expanded":d,className:Ue("w-full justify-between h-8 border-0 shadow-none hover:bg-muted/50 focus:ring-1 focus:ring-ring",!r&&"text-muted-foreground",o&&"opacity-50 cursor-not-allowed",u),disabled:o,children:[l.jsx("span",{className:"truncate",children:f?f.label:a}),l.jsx(tW,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Jd,{className:"w-[300px] p-0",align:"start",children:l.jsxs($$,{shouldFilter:!1,children:[l.jsx(R$,{placeholder:s,value:h,onValueChange:p,className:"h-9"}),l.jsxs(D$,{className:"max-h-[300px] overflow-y-auto overflow-x-hidden",style:{overscrollBehavior:"contain"},onWheel:y=>{y.stopPropagation()},children:[l.jsx(M$,{children:i}),l.jsx(F$,{className:"overflow-visible",children:g.map(y=>l.jsxs(O$,{value:y.value,keywords:[y.label],onSelect:m,className:"cursor-pointer",children:[l.jsx(Fb,{className:Ue("mr-2 h-4 w-4",r===y.value?"opacity-100":"opacity-0")}),y.label]},y.value))})]})]})})]})});function ebe(e){return e?e.map(t=>({id:t.id!==void 0?String(t.id):String(t.value??""),name:t.name??t.label??String(t.value??"")})).filter(t=>t.id!==""):[]}function Ir({applicant:e,field:t,displayValue:r,value:n,onUpdate:a,showPencil:s=!1,options:i,showActionButtons:o=!0,disabled:u,renderInput:d,tooltipMessage:c,placeholder:h="Select option"}){const[p,f]=w.useState(null),[g,m]=w.useState(n??r??""),[x,y]=w.useState(!1),{toast:v}=Wt(),b=w.useMemo(()=>ebe(i),[i]);w.useEffect(()=>{m(n??r??"")},[n,r]);const N=(j,E,O)=>{f({id:j,field:E}),m(O??n??r??"")},S=async()=>{if(!(e!=null&&e.id)){console.error("Applicant ID is missing in EditableCell:",e),v({title:" Unable to Update",description:"Cannot update: Student ID is missing",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"});return}if((t==="phone_number"||t==="whatsapp_number")&&g&&!/^\d{10}$/.test(g)){v({title:" Invalid Mobile Number",description:"Mobile number must be exactly 10 digits",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(t==="pin_code"&&g&&!/^\d{6}$/.test(g)){v({title:" Invalid Pincode",description:"Pincode must be exactly 6 digits",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(t==="email"&&g&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)){v({title:" Invalid Email",description:"Please enter a valid email address",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!(!p||x)){y(!0);try{const j=String(t).endsWith("_id"),E={};j?E[t]=g===""||g==="none"?null:Number(g):E[t]=g??"",await Nm(e.id,E),v({title:" Field Updated",description:"Field updated successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),f(null),a&&a(E[t])}catch(j){console.error("Error updating field:",j),v({title:" Unable to Update Field",description:ut(j),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{y(!1)}}},_=()=>{f(null),m("")},C=w.useCallback(async j=>{if(!(e!=null&&e.id)){console.error("Applicant ID is missing in EditableCell:",e),v({title:" Unable to Update",description:"Cannot update: Student ID is missing",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"});return}if(!x){y(!0);try{const E=String(t).endsWith("_id"),O={};if(t==="state"||t==="district"||t==="block")if(j==="none"||j==="")O[t]=null;else{const M=b.find(W=>W.id===j);O[t]=M?M.name:j}else j==="none"||j===""?O[t]=null:E?O[t]=Number(j):O[t]=j;await Nm(e.id,O),v({title:" Field Updated",description:"Field updated successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),m(O[t]),a&&a(j)}catch(E){console.error("Error updating field:",E),v({title:" Unable to Update Field",description:ut(E),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{y(!1)}}},[e,t,x,a,v,b]),k=(p==null?void 0:p.id)===e.id&&(p==null?void 0:p.field)===t,I=b.length>0,T=()=>{if(n!=null)return String(n);if(r&&b.length>0){const j=b.find(E=>E.name.toLowerCase()===String(r).toLowerCase());if(j)return j.id}return"none"};if(w.useMemo(()=>b.length>10?b.map(j=>({value:j.id,label:j.name})):null,[b]),I){const j=T(),E=t==="offer_letter_status"&&j!=="none"&&j!==null&&j!==void 0,O=["state","district","block"];if(b.length>10||O.includes(t)){const W=b.map(q=>({value:q.id,label:q.name}));return l.jsx(sr,{options:W,value:j==="none"?"":j,onValueChange:q=>!u&&C(q||"none"),placeholder:h||"Select option...",searchPlaceholder:"Search...",emptyText:"No option found.",disabled:x||u,className:u?"!opacity-100 !cursor-default":""})}return l.jsxs(Gr,{value:j,onValueChange:W=>!u&&C(W),disabled:x||u,children:[l.jsx(Fr,{className:`h-8 border-0 shadow-none hover:bg-muted/50 focus:ring-1 focus:ring-ring ${u?"!opacity-100 !cursor-default [&>svg]:hidden":""}`,style:u?{opacity:1}:{},children:l.jsx(Kr,{placeholder:h})}),l.jsxs(Or,{children:[!E&&l.jsx(gt,{value:"none",children:l.jsx("span",{className:"text-muted-foreground",children:"Select"})}),b.map(W=>l.jsx(gt,{value:W.id,children:W.name},W.id))]})]})}return k?l.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[d?l.jsx("div",{className:"flex-1 min-w-0",children:d({value:g,onChange:m})}):l.jsx(Ve,{type:t==="phone_number"||t==="whatsapp_number"||t==="pin_code"?"tel":"text",value:g??"",onChange:j=>{const E=j.target.value;if(t==="first_name"||t==="middle_name"||t==="last_name")m(E.replace(/[0-9]/g,""));else if(t==="phone_number"||t==="whatsapp_number"||t==="pin_code"){const O=t==="pin_code"?6:10;/^\d*$/.test(E)&&E.length<=O&&m(E)}else m(E)},onKeyDown:j=>{j.key==="Enter"&&S(),j.key==="Escape"&&_()},className:"h-7 text-xs flex-1  min-w-0",autoFocus:!0,disabled:x||u,maxLength:t==="pin_code"?6:t==="phone_number"||t==="whatsapp_number"?10:void 0,inputMode:t==="phone_number"||t==="whatsapp_number"||t==="pin_code"?"numeric":"text"}),o&&l.jsxs("div",{className:"flex gap-2 mt-1",children:[l.jsx(le,{size:"sm",onClick:S,className:"h-6 px-2",disabled:x||u,children:x?"...":""}),l.jsx(le,{size:"sm",variant:"outline",onClick:_,className:"h-6 px-2",disabled:x,children:""})]})]}):l.jsxs("div",{className:`p-1 rounded min-h-[24px] flex items-center gap-2 group overflow-hidden ${u?"cursor-default opacity-70":"cursor-pointer hover:bg-muted/50"}`,onClick:()=>{!u&&!x&&N(e.id,t,n??r)},title:u&&c?c:u?"Editing disabled":"Click to edit",children:[l.jsx("span",{className:"flex-1 whitespace-pre-wrap break-words text-sm max-w-full",children:x?"Updating...":r||l.jsx("span",{className:"text-muted-foreground italic",children:"Not provided"})}),s&&!x&&l.jsx(ru,{className:"h-3 w-3 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}function TG(){const[e,t]=w.useState(null),[r,n]=w.useState(!0);w.useEffect(()=>{try{const i=localStorage.getItem("user");if(i){const o=JSON.parse(i);t(o)}else console.log("No user found in localStorage")}catch(i){console.error("Error parsing user from localStorage:",i)}finally{n(!1)}},[]);const a=w.useMemo(()=>(e==null?void 0:e.user_role_id)===1,[e==null?void 0:e.user_role_id]);return{hasEditAccess:a,user:e,isLoading:r,canEdit:()=>a}}function tbe(e,t,r){if(t.some(a=>["question_set_id","obtained_marks","is_passed","school_id","exam_centre","date_of_test"].includes(a.name))){const a=e.status??e.status_name??void 0,s={question_set_id:e.question_set_id||null,obtained_marks:e.obtained_marks===""?null:e.obtained_marks,school_id:e.school_id||null,exam_centre:e.exam_centre||null,date_of_test:e.date_of_test||null,status:a};return e.id?s:{student_id:r,...s}}return"learning_round_status"in e?e.id?{learning_round_status:e.learning_round_status,comments:e.comments}:{student_id:r,learning_round_status:e.learning_round_status,comments:e.comments}:"cultural_fit_status"in e?e.id?{cultural_fit_status:e.cultural_fit_status,comments:e.comments}:{student_id:r,cultural_fit_status:e.cultural_fit_status,comments:e.comments}:{...e,student_id:r}}const E3=(e,t)=>e.id?t.filter(r=>!!(["status","school_id"].includes(r.name)||["learning_round_status","comments"].includes(r.name)||["cultural_fit_status","comments"].includes(r.name))):t,rbe=({row:e,field:t,isEditable:r,updateRow:n})=>{var s;const a=!r||t.disabled;return t.type==="select"?l.jsxs(Gr,{value:e[t.name]||"CLEAR_SELECTION",onValueChange:i=>{const o=i==="CLEAR_SELECTION"?"":i;n(t.name,o)},disabled:a,children:[l.jsx(Fr,{className:`w-full min-w-full text-sm whitespace-normal h-auto ${a?"cursor-not-allowed opacity-50 pointer-events-none":""}`,children:l.jsx(Kr,{placeholder:`Select ${t.label}`})}),l.jsxs(Or,{className:"max-w-full w-full",children:[l.jsx(gt,{value:"CLEAR_SELECTION",children:l.jsx("span",{className:"text-gray-400",children:"Selection"})}),(s=t.options)==null?void 0:s.filter(i=>i.value!=="").map(i=>l.jsx(gt,{value:i.value,children:i.label},i.value))]})]}):t.type==="component"&&t.component?l.jsx(t.component,{row:e,updateRow:(i,o)=>n(i,o),disabled:a,className:a?"cursor-not-allowed opacity-50 pointer-events-none":""}):t.name==="comments"||t.name==="note"||t.name==="notes"?l.jsx("textarea",{value:e[t.name]||"",onChange:i=>n(t.name,i.target.value),disabled:a,className:`border rounded px-2 py-1 w-full min-w-full min-h-[80px] resize-y ${a?"cursor-not-allowed opacity-50":""}`,placeholder:`Enter ${t.label||t.name}...`}):t.type==="number"?l.jsx(Ve,{type:"number",value:e[t.name]||"",onChange:i=>{const o=i.target.value;(o===""||!isNaN(Number(o))&&Number(o)>=0)&&n(t.name,o)},onKeyDown:i=>{(i.key==="-"||i.key==="e"||i.key==="E"||i.key==="+")&&i.preventDefault()},disabled:a,className:`w-full min-w-full ${a?"cursor-not-allowed opacity-50":""}`,placeholder:"0",min:"0"}):l.jsx(Ve,{value:e[t.name],onChange:i=>n(t.name,i.target.value),disabled:a,className:`w-full min-w-full ${a?"cursor-not-allowed opacity-50":""}`})};function W2({title:e,initialData:t,fields:r,studentId:n,submitApi:a,updateApi:s,onSave:i,disabled:o,disabledReason:u}){const[d,c]=w.useState(t.map(v=>({...v}))),{toast:h}=Wt();w.useEffect(()=>{const v=d.map(_=>_.id).filter(Boolean).sort(),b=t.map(_=>_.id).filter(Boolean).sort(),N=JSON.stringify(v)!==JSON.stringify(b),S=t.some(_=>{const C=d.find(T=>T.id===_.id);if(!C)return!1;const k=_.audit_info||{},I=C.audit_info||{};return k.updated_at!==I.updated_at||k.last_updated_by!==I.last_updated_by});(N||d.length===0||S)&&c(t.map(_=>({..._})))},[t]);const p=w.useMemo(()=>d.map(v=>new Set(E3(v,r).map(b=>b.name))),[d,r]),f=(v,b,N)=>{c(S=>{const _=[...S];return _[v]={..._[v],[b]:N},_})},g=()=>{const v={};r.forEach(b=>v[b.name]=""),c(b=>[...b,{...v,isEditing:!0}])},m=(v,b)=>{c(N=>{const S=[...N];return S[v].isEditing=b,S})},x=async v=>{const b=d[v],N=E3(b,r);if(!b.id){const _=b.status,C=r.some(k=>["question_set_id","obtained_marks","is_passed","school_id","exam_centre","date_of_test"].includes(k.name));for(const k of N){const I=b[k.name],T=!I||I.toString().trim()==="";if(!(C&&(k.name==="status"||k.name==="school_id"))&&!(k.name==="school_id"&&_==="Screening Test Fail")&&k.name!=="audit_info"&&_!=="Created Student Without Exam"){if(C&&k.name==="obtained_marks"){const j=Number(b.obtained_marks);if(j>36){h({title:" Validation Error",description:"Obtained marks cannot exceed 36",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(j<0){h({title:" Validation Error",description:"Obtained marks cannot be negative",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}}if(T){h({title:" Validation Error",description:`Please fill the field: ${k.label}`,variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}}}}const S=tbe(b,r,n);try{let _;if(b.id){const k=await s(b.id,S);_=typeof k.json=="function"?await k.json():k,h({title:" Updated Successfully",description:"Row updated successfully.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}else{const k=await a(S);_=typeof k.json=="function"?await k.json():k,h({title:" Created Successfully",description:"Row created successfully.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}const C={...b,..._,isEditing:!1};c(k=>{const I=[...k];return I[v]=C,I}),i&&setTimeout(()=>{i()},0)}catch(_){console.error("Save failed",_),h({title:" Unable to Save",description:ut(_),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},y=(v,b)=>{if(b.name==="audit_info"){const N=v[b.name];if(!N||typeof N!="object")return"";const S=I=>{if(!I)return"";try{return new Date(I).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return I}},_=S(N.created_at),C=S(N.updated_at),k=N.last_updated_by||"";return l.jsxs("div",{className:"text-xs leading-tight",children:[l.jsxs("div",{className:"mb-0.5",children:[l.jsx("span",{className:"font-semibold",children:"Created:"})," ",_]}),l.jsxs("div",{className:"mb-0.5",children:[l.jsx("span",{className:"font-semibold",children:"Updated:"})," ",C]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"By:"})," ",k]})]})}if(b.name==="created_at"||b.name==="updated_at"){if(!v[b.name])return"";try{return new Date(v[b.name]).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return v[b.name]}}if(b.name==="last_updated_by")return v[b.name]||"";if(b.options){const N=b.options.find(S=>S.value===v[b.name]);return N?N.label:v[b.name]||""}return v[b.name]||""};return l.jsxs("div",{className:"space-y-3 border rounded-lg p-4 max-h-[60vh] overflow-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("h3",{className:"text-base font-semibold",children:e}),o?l.jsx(cm,{children:l.jsxs(Gy,{children:[l.jsx(Ky,{asChild:!0,children:l.jsx("div",{className:"inline-block",children:l.jsxs(le,{size:"sm",variant:"outline",onClick:g,disabled:!0,className:"opacity-50 cursor-not-allowed",children:[l.jsx(Wn,{className:"h-4 w-4 mr-1"})," Add Row"]})})}),l.jsx(dm,{children:l.jsx("p",{children:u||"Action disabled"})})]})}):l.jsxs(le,{size:"sm",variant:"outline",onClick:g,children:[l.jsx(Wn,{className:"h-4 w-4 mr-1"})," Add Row"]})]}),l.jsx("div",{className:"overflow-x-auto w-full max-h-[48vh] overflow-auto",children:l.jsxs("table",{className:"w-full min-w-full border-collapse text-sm table-auto",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-100 text-left font-medium text-gray-700",children:[r.map(v=>l.jsx("th",{className:"px-3 py-2 border-b whitespace-nowrap",children:v.label},v.name)),l.jsx("th",{className:"px-3 py-2 border-b text-right whitespace-nowrap",children:"Actions"})]})}),l.jsx("tbody",{children:d.map((v,b)=>l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[r.map(N=>{const S=["created_at","updated_at","last_updated_by","audit_info"].includes(N.name),_=N.name==="status"||N.name.includes("status"),C=N.name==="comments"||N.name==="note"||N.name==="notes",k=v.isEditing&&p[b].has(N.name)&&!S;return l.jsx("td",{className:`px-3 py-2 align-top ${C?"whitespace-pre-wrap break-words w-full min-w-[250px] max-w-[400px]":N.name==="audit_info"?"w-auto min-w-[280px] max-w-[320px]":S?"w-auto min-w-[200px]":_?"w-auto min-w-[250px] max-w-[300px]":"w-auto"}`,children:!k&&(N.type==="readonly"||S)?l.jsx("div",{className:`p-2 rounded w-full break-words ${S?"bg-gray-50":"bg-gray-100"}`,children:y(v,N)}):!k&&(N.name==="comments"||N.name==="note"||N.name==="notes")?l.jsx("div",{className:"p-2 rounded bg-gray-50 whitespace-pre-wrap break-words max-w-[400px]",children:v[N.name]||""}):l.jsx(rbe,{row:v,field:N,isEditable:k,updateRow:(I,T)=>f(b,I,T)})},N.name)}),l.jsx("td",{className:"px-3 py-2 text-right whitespace-nowrap",children:v.isEditing?l.jsx(le,{size:"icon",variant:"ghost",className:"text-green-600 hover:bg-green-50",onClick:()=>x(b),children:l.jsx(Ag,{className:"h-4 w-4"})}):l.jsx(le,{size:"icon",variant:"ghost",className:"text-blue-600 hover:bg-blue-50",onClick:()=>m(b,!0),children:l.jsx(ru,{className:"h-4 w-4"})})})]},b))})]})})]})}function Y_({applicant:e,isOpen:t,onClose:r,castList:n=[],qualificationList:a=[],currentstatusList:s=[],schoolList:i=[],campusList:o=[],questionSetList:u=[],stageList:d=[],partnerList:c=[],donorList:h=[],stateList:p=[]}){var xe,Ie,Oe,vt,$t,cr,tt,me,Ce,rt,ee,be,nt,Te,Ge,wt,Dt,Xr,In,Rr,an,xr,bn,yr,_t,kr,La,Is,Yi,yu,fw,mw,vy,gw,If,xw,yw,vw,_l,Ef,bw,ww,Nw;const{toast:f}=Wt(),{hasEditAccess:g}=TG(),[m,x]=w.useState(e),[y,v]=w.useState(!1),[b,N]=w.useState(0),[S,_]=w.useState(""),[C,k]=w.useState([]),[I,T]=w.useState([]),[j,E]=w.useState(null),[O,M]=w.useState(null),[W,q]=w.useState(!1),[P,A]=w.useState(!1),L=w.useRef(null),z=w.useRef(null),[$,V]=w.useState({state:!1,district:!1,block:!1}),B=w.useMemo(()=>(n||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.cast_name}}),[n]),Y=w.useMemo(()=>(a||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.qualification_name}}),[a]),re=w.useMemo(()=>(s||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.current_status_name}}),[s]),ae=w.useMemo(()=>(i||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.school_name}}),[i]),K=w.useMemo(()=>(o||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.campus_name}}),[o]),J=w.useMemo(()=>(u||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.name}}),[u]),Z=w.useMemo(()=>(d||[]).map(ke=>({id:ke.id,name:ke.stage_name||ke.name})),[d]),Q=w.useMemo(()=>(c||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.partner_name}}),[c]),U=w.useMemo(()=>(h||[]).map(ke=>{var $e;return{value:($e=ke.id)==null?void 0:$e.toString(),label:ke.donor_name}}),[h]),F=w.useMemo(()=>p||[],[p]),[te,pe]=w.useState(!1),[ve,fe]=w.useState(!1),[Me,je]=w.useState(null),Qe=ke=>{if(!ke)return null;if(F.find(Ct=>Ct.value===ke))return ke;const Nt=F.find(Ct=>Ct.label.toUpperCase()===ke.toUpperCase());return Nt?Nt.value:ke},ft=ke=>{if(!ke)return null;if(C.find(Ct=>Ct.value===ke))return ke;const Nt=C.find(Ct=>Ct.label.toUpperCase()===ke.toUpperCase());return Nt?Nt.value:ke};w.useEffect(()=>{if(e!=null&&e.id){if(x(e),e.state){const ke=Qe(e.state);E(ke)}if(e.district){const ke=ft(e.district);M(ke)}}},[e]),w.useEffect(()=>{t&&(e!=null&&e.id)&&(async()=>{try{const $e=await XE(e.id);let Nt=$e;if($e&&typeof $e=="object"&&"data"in $e&&(Nt=$e.data),Nt!=null&&Nt.id){if(x(Nt),Nt.state){const Ct=Qe(Nt.state);E(Ct)}if(Nt.district){const Ct=ft(Nt.district);M(Ct)}}}catch{}})()},[t,e==null?void 0:e.id,b]),w.useEffect(()=>{var $e,Nt;const ke=((Nt=($e=m==null?void 0:m.final_decisions)==null?void 0:$e[0])==null?void 0:Nt.joining_date)||(m==null?void 0:m.joining_date)||"";_(ke?ke.split("T")[0]:"")},[m]),w.useEffect(()=>{if(!j){k([]),T([]),L.current=null;return}if(L.current===j)return;L.current=j,(async()=>{q(!0);try{const $e=await Hh(j),Ct=(($e==null?void 0:$e.data)||$e||[]).map(ta=>({value:ta.district_code,label:ta.district_name}));k(Ct)}catch{k([])}finally{q(!1)}})()},[j]),w.useEffect(()=>{if(!O){T([]),z.current=null;return}if(z.current===O)return;z.current=O,(async()=>{A(!0);try{const $e=await Kb(O),Ct=(($e==null?void 0:$e.data)||$e||[]).map(ta=>({value:String(ta.id),label:ta.block_name}));T(Ct)}catch{T([])}finally{A(!1)}})()},[O]);const Ot=async ke=>{if(ke==="Offer Sent"){je(ke),fe(!0);return}await Fe("offer_letter_status",ke)},yt=async()=>{Me&&await Fe("offer_letter_status",Me),fe(!1),je(null)},De=()=>{fe(!1),je(null)},Fe=async(ke,$e)=>{var Nt;if(m!=null&&m.id){if(ke==="offer_letter_status"&&!(m!=null&&m.campus_id)){f({title:"Alert",description:"Please select a Campus first before setting Offer Letter Status.",variant:"destructive"});return}try{const Ct=((Nt=m==null?void 0:m.final_decisions)==null?void 0:Nt[0])||{};let ta=S;!ta&&Ct.joining_date&&(ta=Ct.joining_date.split("T")[0]);const Ta={student_id:m.id,id:Ct.id,offer_letter_status:Ct.offer_letter_status??null,onboarded_status:Ct.onboarded_status??null,final_notes:Ct.final_notes??null,joining_date:ta||null,stage_id:Ct.stage_id??null};ke==="joining_date"?Ta.joining_date=$e!==""?$e:null:Ta[ke]=$e;const kl=Ta.offer_letter_status,pd=Ta.onboarded_status,ja=Z.find(vu=>vu.name==="Final Decision"),ri=Z.find(vu=>vu.name==="Onboarded");let fd=Ta.stage_id;kl!=null&&pd!=null?fd=(ri==null?void 0:ri.id)||5:kl!=null&&pd==null?fd=(ja==null?void 0:ja.id)||4:pd!=null&&(fd=(ri==null?void 0:ri.id)||5),Ta.stage_id=fd,await e$(Ta),x(vu=>({...vu,final_decisions:[{...Ct,[ke]:$e,joining_date:ke==="joining_date"?$e:ta,stage_id:fd}]})),ke==="joining_date"&&_($e),f({title:"Success",description:"Final decision updated successfully."})}catch(Ct){console.error("Failed to update final decision",Ct),f({title:" Unable to Update Final Decision",description:ut(Ct),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}}},et=()=>{v(!1),N(ke=>ke+1)},Ae=async()=>{if(m!=null&&m.id)try{const ke=await XE(m.id);let $e=ke;ke&&typeof ke=="object"&&"data"in ke&&($e=ke.data),$e!=null&&$e.id&&x($e)}catch{}},He=(ke,$e,Nt="")=>{if(!$e)return Nt;const Ct=ke.find(ta=>ta.value===($e==null?void 0:$e.toString()));return(Ct==null?void 0:Ct.label)||($e==null?void 0:$e.toString())||Nt},st=(ke,$e)=>{if(!$e)return null;const Nt=ke.find(Ct=>Ct.label===$e);return(Nt==null?void 0:Nt.value)||null},kt=async ke=>{var Nt;E(ke),M(null),k([]),T([]);const $e=((Nt=F.find(Ct=>Ct.value===ke))==null?void 0:Nt.label)||ke;m!=null&&m.id&&await Nm(m.id,{state:$e,district:null,block:null}),await Ae()},Vt=async ke=>{var Nt;M(ke),T([]);const $e=((Nt=C.find(Ct=>Ct.value===ke))==null?void 0:Nt.label)||ke;m!=null&&m.id&&await Nm(m.id,{district:$e,block:null}),await Ae()},ur=async ke=>{var $e;if(m!=null&&m.id)try{const Nt=(($e=I.find(Ct=>Ct.value===ke))==null?void 0:$e.label)||ke;await Nm(m.id,{block:Nt}),await Ae(),f({title:" Block Updated",description:"Block has been updated successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(Nt){console.error("Failed to update block:",Nt),f({title:" Unable to Update Block",description:ut(Nt),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}};(xe=m==null?void 0:m.exam_sessions)==null||xe[0];const we=[{name:"status",label:"Status",type:"select",options:[{value:"Screening Test Pass",label:"Screening Test Pass"},{value:"Screening Test Fail",label:"Screening Test Fail"},{value:"Created Student Without Exam",label:"Created Student Without Exam"}]},{name:"question_set_id",label:"Set Name *",type:"select",options:J},{name:"obtained_marks",label:"Obtained Marks * (Max: 36)",type:"component",component:({row:ke,updateRow:$e,disabled:Nt})=>l.jsx("div",{className:"w-full",children:l.jsx("input",{type:"number",value:(ke==null?void 0:ke.obtained_marks)||"",onChange:ta=>{const Ta=ta.target.value,kl=Number(Ta);(Ta===""||kl>=0&&kl<=36)&&($e==null||$e("obtained_marks",Ta))},className:`border p-1 rounded w-full ${Nt?"cursor-not-allowed opacity-50":""}`,disabled:!!Nt,min:"0",max:36,placeholder:"0-36"})})},{name:"school_id",label:"Qualifying School",type:"select",options:ae},{name:"exam_centre",label:"Exam Centre *",type:"readonly"},{name:"date_of_test",label:"Date of Testing *",type:"component",component:({row:ke,updateRow:$e,disabled:Nt})=>{const Ct=new Date().toISOString().split("T")[0];return l.jsx("input",{type:"date",value:(ke==null?void 0:ke.date_of_test)||"",onChange:ta=>$e==null?void 0:$e("date_of_test",ta.target.value),className:"border p-1 rounded w-full",disabled:!!Nt,max:Ct})}},{name:"audit_info",label:"Audit Info",type:"readonly"}],wr=w.useMemo(()=>{var ke;return((ke=m==null?void 0:m.exam_sessions)==null?void 0:ke.map($e=>{var Nt,Ct;return{id:$e.id,status:$e.status??m.status??"",question_set_id:((Nt=$e.question_set_id)==null?void 0:Nt.toString())||"",obtained_marks:$e.obtained_marks!==null&&$e.obtained_marks!==void 0?$e.obtained_marks.toString():"",school_id:$e.school_id!==null&&$e.school_id!==void 0?$e.school_id.toString():"",exam_centre:$e.exam_centre||"",date_of_test:((Ct=$e.date_of_test)==null?void 0:Ct.split("T")[0])||"",audit_info:{created_at:$e.created_at||"",updated_at:$e.updated_at||"",last_updated_by:$e.last_updated_by||""}}}))||[]},[m]),nr=w.useMemo(()=>((m==null?void 0:m.interview_learner_round)||[]).map(ke=>({...ke,audit_info:{created_at:ke.created_at||"",updated_at:ke.updated_at||"",last_updated_by:ke.last_updated_by||""}})),[m]),Zt=w.useMemo(()=>((m==null?void 0:m.interview_cultural_fit_round)||[]).map(ke=>({...ke,audit_info:{created_at:ke.created_at||"",updated_at:ke.updated_at||"",last_updated_by:ke.last_updated_by||""}})),[m]);if(!e||!m)return null;const _r=((Ie=to==null?void 0:to.screening)==null?void 0:Ie.submit)??(async ke=>{throw new Error("screening submit API not available")}),Cs=((Oe=to==null?void 0:to.screening)==null?void 0:Oe.update)??(async(ke,$e)=>{throw new Error("screening update API not available")}),vn=(ke,$e)=>{const Ct=((ke==null?void 0:ke.exam_sessions)||[]).some(ja=>{const ri=(ja==null?void 0:ja.status)||"";return ri.toLowerCase().includes("pass")||ri==="Created Student Without Exam"}),Ta=((ke==null?void 0:ke.interview_learner_round)||[]).some(ja=>((ja==null?void 0:ja.learning_round_status)||"").toLowerCase().includes("pass")),pd=((ke==null?void 0:ke.interview_cultural_fit_round)||[]).some(ja=>((ja==null?void 0:ja.cultural_fit_status)||"").toLowerCase().includes("pass"));return $e==="LR"?!Ct:$e==="CFR"?!Ct||!Ta:$e==="OFFER"?!Ct||!Ta||!pd:!1};return l.jsxs(l.Fragment,{children:[l.jsx(Wr,{open:t,onOpenChange:r,children:l.jsxs(Vr,{className:"max-w-[95vw] sm:max-w-[90vw] md:max-w-6xl max-h-[90vh] overflow-y-auto p-4 sm:p-6",children:[l.jsxs(Hr,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0",children:[l.jsx(qr,{className:"text-lg sm:text-xl",children:"Applicant Details"}),l.jsx("div",{className:"flex items-center gap-2"})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Personal Information"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"First Name"}),l.jsx(Ir,{applicant:m,field:"first_name",displayValue:(m==null?void 0:m.first_name)||"",onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Middle Name"}),l.jsx(Ir,{applicant:m,field:"middle_name",displayValue:(m==null?void 0:m.middle_name)||"",onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Name"}),l.jsx(Ir,{applicant:m,field:"last_name",displayValue:(m==null?void 0:m.last_name)||"",onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),l.jsx(Ir,{applicant:m,field:"email",displayValue:m.email||"",onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Mobile Number"}),l.jsx(Ir,{applicant:m,field:"phone_number",displayValue:m.phone_number,onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"WhatsApp Number"}),l.jsx(Ir,{applicant:m,field:"whatsapp_number",displayValue:m.whatsapp_number||"",onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),l.jsx(Ir,{applicant:m,field:"gender",displayValue:m.gender||"",options:[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"other",label:"Other"}],onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Cast"}),l.jsx(Ir,{applicant:m,field:"cast_id",value:m.cast_id,displayValue:He(B,m.cast_id),onUpdate:Ae,options:B,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Qualification"}),l.jsx(Ir,{applicant:m,field:"qualification_id",value:m.qualification_id,displayValue:He(Y,m.qualification_id),onUpdate:Ae,options:Y,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Current Work"}),l.jsx(Ir,{applicant:m,field:"current_status_id",displayValue:((vt=re.find(ke=>{var $e;return ke.value===(($e=m.current_status_id)==null?void 0:$e.toString())}))==null?void 0:vt.label)||"",onUpdate:Ae,options:re,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"State"}),l.jsx(Ir,{applicant:m,field:"state",displayValue:m.state,value:st(F,m.state)||"",onUpdate:kt,options:F,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"District"}),l.jsx(Ir,{applicant:m,field:"district",displayValue:m.district||"",value:st(C,m.district)||"",onUpdate:Vt,options:C,disabled:!g||!j||W,placeholder:j?"Select district":"Select state first"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Block"}),l.jsx(Ir,{applicant:m,field:"block",displayValue:m.block||"",value:st(I,m.block)||"",onUpdate:ur,options:I,disabled:!g||!O||P,placeholder:O?"Select block":"Select district first"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Pincode"}),l.jsx(Ir,{applicant:m,field:"pin_code",displayValue:m.pin_code||"",onUpdate:Ae,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Partner"}),l.jsx(Ir,{applicant:m,field:"partner_id",value:m.partner_id,displayValue:He(Q,m.partner_id),onUpdate:Ae,options:Q,disabled:!g})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Donor"}),l.jsx(Ir,{applicant:m,field:"donor_id",value:m.donor_id,displayValue:He(U,m.donor_id),onUpdate:Ae,options:U,disabled:!g})]})]})]}),l.jsxs("div",{className:"space-y-3 pt-4",children:[l.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Timestamps for Personal Details"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Created At"}),l.jsx("p",{className:"text-sm",children:m.created_at?new Date(m.created_at).toLocaleString():"Not available"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Last Updated At"}),l.jsx("p",{className:"text-sm",children:m.updated_at?new Date(m.updated_at).toLocaleString():"Not available"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Last Updated By"}),l.jsx("p",{className:"text-sm",children:m.last_updated_by?m.last_updated_by:"Not available"})]})]})]})]}),l.jsx(W2,{title:"Screening Round",studentId:m.id,initialData:wr,fields:we,submitApi:_r,updateApi:Cs,onSave:Ae}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:[l.jsx("div",{className:"col-span-full w-full",children:l.jsx(W2,{title:"Learning Round",studentId:m.id,initialData:nr,fields:[{name:"learning_round_status",label:"Status *",type:"select",disabled:vn(m,"LR"),options:[{value:"Learner Round Pass",label:"Learner Round Pass"},{value:"Learner Round Fail",label:"Learner Round Fail"},{value:"Reschedule",label:"Reschedule"},{value:"No Show",label:"No Show"}]},{name:"comments",label:"Comments *",type:"text",disabled:vn(m,"LR")},{name:"audit_info",label:"Audit Info",type:"readonly"}],submitApi:to.learning.submit,updateApi:to.learning.update,onSave:Ae,disabled:vn(m,"LR"),disabledReason:" Student need to pass Screening Round"})}),l.jsx("div",{className:"col-span-full w-full",children:l.jsx(W2,{title:"Cultural Fit Round",studentId:m.id,initialData:Zt,fields:[{name:"cultural_fit_status",label:"Status *",type:"select",disabled:vn(m,"CFR"),options:[{value:"Cultural Fit Interview Pass",label:"Cultural Fit Interview Pass"},{value:"Cultural Fit Interview Fail",label:"Cultural Fit Interview Fail"},{value:"Reschedule",label:"Reschedule"},{value:"No Show",label:"No Show"}]},{name:"comments",label:"Comments *",type:"text",disabled:vn(m,"LR")},{name:"audit_info",label:"Audit Info",type:"readonly"}],submitApi:to.cultural.submit,updateApi:to.cultural.update,onSave:Ae,disabled:vn(m,"CFR"),disabledReason:"Student need to pass Learning Round"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Offer & Final Status"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"text-sm font-medium text-muted-foreground",children:["Campus ",l.jsx("span",{className:"text-red-500",children:"*"})]}),vn(m,"OFFER")&&!m.campus_id?l.jsx(cm,{children:l.jsxs(Gy,{children:[l.jsx(Ky,{asChild:!0,children:l.jsx("div",{children:l.jsx(Ir,{applicant:m,field:"campus_id",value:m.campus_id,displayValue:He(K,m.campus_id),onUpdate:Ae,options:K,disabled:!0})})}),l.jsx(dm,{children:l.jsx("p",{children:"All rounds should be passed"})})]})}):l.jsx("div",{className:!m.campus_id&&((cr=($t=m.final_decisions)==null?void 0:$t[0])!=null&&cr.offer_letter_status||(me=(tt=m.final_decisions)==null?void 0:tt[0])!=null&&me.onboarded_status)?"border-2 border-red-500 rounded":"",children:l.jsx(Ir,{applicant:m,field:"campus_id",value:m.campus_id,displayValue:He(K,m.campus_id),onUpdate:Ae,options:K,disabled:!g})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Offer Letter Status"}),vn(m,"OFFER")&&!((rt=(Ce=m.final_decisions)==null?void 0:Ce[0])!=null&&rt.offer_letter_status)?l.jsx(cm,{children:l.jsxs(Gy,{children:[l.jsx(Ky,{asChild:!0,children:l.jsx("div",{children:l.jsx(Ir,{applicant:m,field:"offer_letter_status",value:(be=(ee=m.final_decisions)==null?void 0:ee[0])==null?void 0:be.offer_letter_status,displayValue:((Te=(nt=m.final_decisions)==null?void 0:nt[0])==null?void 0:Te.offer_letter_status)||"",options:[{value:"Offer Pending",label:"Offer Pending"},{value:"Offer Sent",label:"Offer Sent"},{value:"Offer Accepted",label:"Offer Accepted"},{value:"Offer Declined",label:"Offer Declined"},{value:"Waitlisted",label:"Waitlisted"},{value:"Selected but not joined",label:"Selected but not joined"}],disabled:!0,onUpdate:async ke=>{await Ot(ke)}})})}),l.jsx(dm,{children:l.jsx("p",{children:"All rounds should be passed"})})]})}):l.jsx(Ir,{applicant:m,field:"offer_letter_status",value:(wt=(Ge=m.final_decisions)==null?void 0:Ge[0])==null?void 0:wt.offer_letter_status,displayValue:((Xr=(Dt=m.final_decisions)==null?void 0:Dt[0])==null?void 0:Xr.offer_letter_status)||"",options:[{value:"Offer Pending",label:"Offer Pending"},{value:"Offer Sent",label:"Offer Sent"},{value:"Offer Accepted",label:"Offer Accepted"},{value:"Offer Declined",label:"Offer Declined"},{value:"Waitlisted",label:"Waitlisted"},{value:"Selected but not joined",label:"Selected but not joined"}],disabled:!g,onUpdate:async ke=>{if(await Ot(ke),!m.campus_id){f({title:" Campus Required",description:"Please select a campus before proceeding with the offer letter status",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}await Fe("offer_letter_status",ke)}})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Onboarded Status"}),vn(m,"OFFER")&&!((Rr=(In=m.final_decisions)==null?void 0:In[0])!=null&&Rr.onboarded_status)?l.jsx(cm,{children:l.jsxs(Gy,{children:[l.jsx(Ky,{asChild:!0,children:l.jsx("div",{children:l.jsx(Ir,{applicant:m,field:"onboarded_status",value:(xr=(an=m.final_decisions)==null?void 0:an[0])==null?void 0:xr.onboarded_status,displayValue:((yr=(bn=m.final_decisions)==null?void 0:bn[0])==null?void 0:yr.onboarded_status)||"",options:[{value:"Onboarded",label:"Onboarded"}],disabled:!0,onUpdate:async ke=>{await Fe("onboarded_status",ke)}})})}),l.jsx(dm,{children:l.jsx("p",{children:"All rounds should be passed"})})]})}):l.jsx(Ir,{applicant:m,field:"onboarded_status",value:(kr=(_t=m.final_decisions)==null?void 0:_t[0])==null?void 0:kr.onboarded_status,displayValue:((Is=(La=m.final_decisions)==null?void 0:La[0])==null?void 0:Is.onboarded_status)||"",options:[{value:"Onboarded",label:"Onboarded"}],disabled:!g,onUpdate:async ke=>{if(!m.campus_id){f({title:" Campus Required",description:"Please select a campus before onboarding",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}await Fe("onboarded_status",ke)}})]})]}),l.jsxs("div",{className:"w-full",children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Joining Date"}),vn(m,"OFFER")&&!((yu=(Yi=m.final_decisions)==null?void 0:Yi[0])!=null&&yu.joining_date)?l.jsx(cm,{children:l.jsxs(Gy,{children:[l.jsx(Ky,{asChild:!0,children:l.jsx("div",{children:l.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full cursor-not-allowed opacity-60",value:"",disabled:!0})})}),l.jsx(dm,{children:l.jsx("p",{children:"All rounds should be passed"})})]})}):l.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full text-sm sm:text-base",value:S||((vy=(mw=(fw=m.final_decisions)==null?void 0:fw[0])==null?void 0:mw.joining_date)==null?void 0:vy.split("T")[0])||"",disabled:!g,onChange:async ke=>{const $e=ke.target.value;_($e);try{await Fe("joining_date",$e||null),x(Nt=>{var Ct;return{...Nt,final_decisions:[{...((Ct=Nt.final_decisions)==null?void 0:Ct[0])||{},joining_date:$e}]}})}catch{}}})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"w-full",children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Final Note"}),l.jsx(Ir,{applicant:m,field:"final_notes",value:((If=(gw=m.final_decisions)==null?void 0:gw[0])==null?void 0:If.final_notes)||"",displayValue:((yw=(xw=m.final_decisions)==null?void 0:xw[0])==null?void 0:yw.final_notes)||"No final note",renderInput:({value:ke,onChange:$e})=>l.jsx("textarea",{value:ke,onChange:Nt=>$e(Nt.target.value),rows:4,className:"border rounded px-2 py-1 w-full resize-y",placeholder:"Enter final notes here..."}),onUpdate:async ke=>{await Fe("final_notes",ke)}})]}),l.jsxs("div",{className:"space-y-3 pt-4",children:[l.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Timestamps for Offer Letter"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Created At"}),l.jsx("p",{className:"text-sm mt-1",children:(_l=(vw=m.final_decisions)==null?void 0:vw[0])!=null&&_l.created_at?new Date(m.final_decisions[0].created_at).toLocaleString():"Not available"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated At"}),l.jsx("p",{className:"text-sm mt-1",children:(bw=(Ef=m.final_decisions)==null?void 0:Ef[0])!=null&&bw.updated_at?new Date(m.final_decisions[0].updated_at).toLocaleString():"Not available"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated By"}),l.jsx("p",{className:"text-sm mt-1",children:((Nw=(ww=m.final_decisions)==null?void 0:ww[0])==null?void 0:Nw.last_status_updated_by)||"Not available"})]})]})]})]})]})]})}),y&&l.jsx(mve,{applicant:m,isOpen:y,onClose:()=>v(!1),onSuccess:et}),l.jsx(k$,{open:ve,onOpenChange:fe,children:l.jsxs(M_,{children:[l.jsxs(F_,{children:[l.jsx(P_,{children:"Confirm Offer Sent"}),l.jsx(L_,{children:`Are you sure you want to mark this offer as "Offer Sent"? This action will update the applicant's offer letter status.`})]}),l.jsxs(O_,{children:[l.jsx(B_,{onClick:De,children:"Cancel"}),l.jsx(z_,{onClick:yt,children:"Confirm"})]})]})})]})}function jG(){const[e,t]=w.useState("interviews"),[r,n]=w.useState([]),[a,s]=w.useState([]),[i,o]=w.useState(!1),[u,d]=w.useState(!1),[c,h]=w.useState(null),[p,f]=w.useState(!1),[g,m]=w.useState(""),[x,y]=w.useState(""),[v,b]=w.useState(""),[N,S]=w.useState(""),[_,C]=w.useState(""),[k,I]=w.useState(""),[T,j]=w.useState(1),[E,O]=w.useState(1),[M,W]=w.useState(1),[q,P]=w.useState(0),[A,L]=w.useState(1),[z,$]=w.useState(0),[V,B]=w.useState(10);w.useEffect(()=>{if(e!=="interviews")return;const Z=setTimeout(()=>{Y()},500);return()=>clearTimeout(Z)},[e,T,x,g,v,V]),w.useEffect(()=>{if(e!=="slots")return;const Z=setTimeout(()=>{re()},500);return()=>clearTimeout(Z)},[e,E,_,N,k,V]);const Y=async()=>{try{o(!0);const Z=await AV({page:T,pageSize:V,slot_type:v&&v!=="all"?v:void 0,date:x||void 0,search:g||void 0});Z.success&&Z.data?(n(Z.data||[]),W(Z.totalPages||1),P(Z.total||0)):(n([]),W(1),P(0))}catch(Z){console.error("Error fetching interviews:",Z),n([]),W(1),P(0)}finally{o(!1)}},re=async()=>{try{d(!0);const Z=await $V({page:E,pageSize:V,slot_type:k&&k!=="all"?k:void 0,date:_||void 0,search:N||void 0});Z.success&&Z.data?(s(Z.data||[]),L(Z.totalPages||1),$(Z.total||0)):(s([]),L(1),$(0))}catch(Z){console.error("Error fetching slots:",Z),s([]),L(1),$(0)}finally{d(!1)}},ae=Z=>{let Q="bg-gray-500",U=Z;switch(Z==null?void 0:Z.toLowerCase()){case"scheduled":Q="bg-green-500",U="Scheduled";break;case"rescheduled":Q="bg-orange-500",U="Rescheduled";break;case"active":Q="bg-blue-500",U="Active";break;case"completed":Q="bg-green-500",U="Completed";break;case"booked":Q="bg-green-500",U="Booked";break;case"available":Q="bg-orange-500",U="Available";break;case"expired":Q="bg-gray-500",U="Expired";break;case"cancelled":case"canceled":Q="bg-red-500",U="Cancelled";break}return l.jsx(Kn,{className:`${Q} text-white hover:${Q}`,children:U})},K=Z=>Z?new Date(Z).toLocaleDateString():"N/A",J=Z=>Z?Z.includes("T")?new Date(Z).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Z:"N/A";return l.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[l.jsx(dn,{}),l.jsx("div",{className:"flex-1 md:ml-64 min-w-0",children:l.jsxs("div",{className:"p-6 md:p-8",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin View"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Overview of all scheduled interviews and created slots"})]}),l.jsxs(k_,{defaultValue:"interviews",className:"w-full",onValueChange:t,children:[l.jsxs(Xb,{className:"grid w-full max-w-md grid-cols-2",children:[l.jsx(Pi,{value:"interviews",className:"data-[state=active]:bg-orange-500 data-[state=active]:text-white",children:"Scheduled Interviews"}),l.jsx(Pi,{value:"slots",className:"data-[state=active]:bg-orange-500 data-[state=active]:text-white",children:"Created Slots"})]}),l.jsx(Li,{value:"interviews",className:"mt-6",children:l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsxs(Lt,{className:"flex items-center gap-2 mb-4",children:[l.jsx($a,{className:"w-5 h-5"}),"All Scheduled Interviews"]}),l.jsxs("div",{className:"flex gap-3 items-center flex-wrap",children:[l.jsx("div",{className:"w-[300px]",children:l.jsx(Ve,{placeholder:"Search by name, email, interviewer...",value:g,onChange:Z=>m(Z.target.value),className:"w-full"})}),l.jsx("div",{className:"w-40",children:l.jsxs(Gr,{value:v,onValueChange:b,children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Slot Type"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"all",children:"All Types"}),l.jsx(gt,{value:"LR",children:"LR (Learning Round)"}),l.jsx(gt,{value:"CFR",children:"CFR (Culture Fit)"})]})]})}),l.jsx("div",{className:"w-48",children:l.jsx(Ve,{type:"date",value:x,onChange:Z=>y(Z.target.value),placeholder:"Filter by date"})})]})]}),l.jsxs(jt,{children:[i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):r.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(pn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"No scheduled interviews found"})]}):l.jsx("div",{className:"border rounded-lg overflow-auto max-h-[600px] w-full",children:l.jsxs(yi,{children:[l.jsx(vi,{className:"sticky top-0 bg-gray-50 z-10",children:l.jsxs(or,{className:"bg-gray-50",children:[l.jsx(ct,{className:"font-semibold min-w-[200px]",children:"Applicant"}),l.jsx(ct,{className:"font-semibold min-w-[200px]",children:"Interviewer"}),l.jsx(ct,{className:"font-semibold min-w-[150px]",children:"Title"}),l.jsx(ct,{className:"font-semibold min-w-[120px]",children:"Date"}),l.jsx(ct,{className:"font-semibold min-w-[150px]",children:"Time"}),l.jsx(ct,{className:"font-semibold min-w-[120px]",children:"Status"}),l.jsx(ct,{className:"font-semibold min-w-[100px]",children:"Meeting Link"})]})}),l.jsx(bi,{children:r.map(Z=>{var Q;return l.jsxs(or,{className:"hover:bg-orange-50 transition-colors",children:[l.jsx(Xe,{className:"min-w-[200px]",children:l.jsxs("div",{className:"cursor-pointer hover:bg-gray-100 p-2 rounded-md transition-colors group",onClick:()=>{Z.student_id&&(h({id:Z.student_id}),f(!0))},children:[l.jsx("div",{className:"font-medium text-black-600 group-hover:text-black-800 flex items-center gap-2",children:Z.student_name||"Unknown"}),l.jsx("div",{className:"text-xs text-gray-500",children:Z.student_email||"N/A"})]})}),l.jsx(Xe,{className:"min-w-[200px]",children:l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:Z.interviewer_name||"Not Assigned"}),l.jsx("div",{className:"text-xs text-gray-500",children:Z.interviewer_email||"N/A"})]})}),l.jsx(Xe,{className:"whitespace-nowrap min-w-[150px]",children:l.jsx("span",{className:"font-medium",children:Z.title||"No Title"})}),l.jsx(Xe,{className:"whitespace-nowrap text-sm min-w-[120px]",children:K(Z.slot_date)}),l.jsxs(Xe,{className:"whitespace-nowrap text-sm min-w-[150px]",children:[J(Z.start_time)," - ",J(Z.end_time)]}),l.jsx(Xe,{className:"whitespace-nowrap min-w-[120px]",children:ae(Z.status)}),l.jsx(Xe,{className:"whitespace-nowrap min-w-[100px]",children:Z.meeting_link?((Q=Z.status)==null?void 0:Q.toLowerCase())==="cancelled"?l.jsxs("span",{className:"flex items-center gap-1 text-gray-400 text-sm cursor-not-allowed",children:[l.jsx(vv,{className:"w-4 h-4"}),l.jsx("span",{children:"Cancelled"})]}):l.jsxs("a",{href:Z.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-orange-600 hover:underline",children:[l.jsx(vv,{className:"w-4 h-4"}),l.jsx("span",{children:"Join"})]}):l.jsx("span",{className:"text-gray-400 text-sm",children:"No Link"})})]},Z.id)})})]})}),q>0&&l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(T-1)*V+1,"  ",Math.min(T*V,q)," of ",q]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Rows:"}),l.jsxs("select",{value:V,onChange:Z=>{B(Number(Z.target.value)),j(1)},className:"border rounded px-2 py-1 bg-white text-sm",children:[l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:20,children:"20"}),l.jsx("option",{value:50,children:"50"}),l.jsx("option",{value:100,children:"100"})]})]}),l.jsx("button",{onClick:()=>j(Z=>Math.max(1,Z-1)),disabled:T===1,className:"px-3 py-1 rounded border bg-white disabled:opacity-50",children:"Previous"}),l.jsxs("span",{className:"px-3 py-1 text-sm",children:["Page ",T," of ",M]}),l.jsx("button",{onClick:()=>j(Z=>Math.min(M,Z+1)),disabled:T===M,className:"px-3 py-1 rounded border bg-white disabled:opacity-50",children:"Next"})]})]})]})]})}),l.jsx(Li,{value:"slots",className:"mt-6",children:l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsxs(Lt,{className:"flex items-center gap-2 mb-4",children:[l.jsx(Ya,{className:"w-5 h-5"}),"All Created Slots"]}),l.jsxs("div",{className:"flex gap-3 items-center flex-wrap",children:[l.jsx("div",{className:"w-[300px]",children:l.jsx(Ve,{placeholder:"Search by creator name or email...",value:N,onChange:Z=>S(Z.target.value),className:"w-full"})}),l.jsx("div",{className:"w-40",children:l.jsxs(Gr,{value:k,onValueChange:I,children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Slot Type"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"all",children:"All Types"}),l.jsx(gt,{value:"LR",children:"LR (Learning Round)"}),l.jsx(gt,{value:"CFR",children:"CFR (Culture Fit)"})]})]})}),l.jsx("div",{className:"w-48",children:l.jsx(Ve,{type:"date",value:_,onChange:Z=>C(Z.target.value),placeholder:"Select Date"})})]})]}),l.jsxs(jt,{children:[u?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):a.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(pn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"No slots found"})]}):l.jsx("div",{className:"border rounded-lg overflow-auto max-h-[600px]",children:l.jsxs(yi,{children:[l.jsx(vi,{className:"sticky top-0 bg-gray-50 z-10",children:l.jsxs(or,{className:"bg-gray-50",children:[l.jsx(ct,{className:"font-semibold min-w-[200px]",children:"Created By"}),l.jsx(ct,{className:"font-semibold min-w-[120px]",children:"Slot type"}),l.jsx(ct,{className:"font-semibold min-w-[120px]",children:"Date"}),l.jsx(ct,{className:"font-semibold min-w-[150px]",children:"Time"}),l.jsx(ct,{className:"font-semibold min-w-[120px]",children:"Status"})]})}),l.jsx(bi,{children:a.map(Z=>l.jsxs(or,{className:"hover:bg-orange-50 transition-colors",children:[l.jsx(Xe,{className:"min-w-[200px]",children:l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:Z.user_name||`User #${Z.created_by}`}),l.jsx("div",{className:"text-xs text-gray-500",children:Z.user_email})]})}),l.jsx(Xe,{className:"min-w-[120px]",children:l.jsx(Kn,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:Z.slot_type||"Not Specified"})}),l.jsx(Xe,{className:"font-medium whitespace-nowrap min-w-[120px]",children:K(Z.date)}),l.jsxs(Xe,{className:"text-sm whitespace-nowrap min-w-[150px]",children:[J(Z.start_time)," - ",J(Z.end_time)]}),l.jsx(Xe,{className:"min-w-[120px]",children:ae(Z.status||"Available")})]},Z.id))})]})}),z>0&&l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(E-1)*V+1,"  ",Math.min(E*V,z)," of ",z]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Rows:"}),l.jsxs("select",{value:V,onChange:Z=>{B(Number(Z.target.value)),O(1)},className:"border rounded px-2 py-1 bg-white text-sm",children:[l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:20,children:"20"}),l.jsx("option",{value:50,children:"50"}),l.jsx("option",{value:100,children:"100"})]})]}),l.jsx("button",{onClick:()=>O(Z=>Math.max(1,Z-1)),disabled:E===1,className:"px-3 py-1 rounded border bg-white disabled:opacity-50",children:"Previous"}),l.jsxs("span",{className:"px-3 py-1 text-sm",children:["Page ",E," of ",A]}),l.jsx("button",{onClick:()=>O(Z=>Math.min(A,Z+1)),disabled:E===A,className:"px-3 py-1 rounded border bg-white disabled:opacity-50",children:"Next"})]})]})]})]})})]})]})}),l.jsx(Y_,{applicant:c,isOpen:p,onClose:()=>f(!1)})]})}const AG=w.createContext(void 0),nbe=({children:e})=>{const[t,r]=w.useState(0),n=w.useCallback(()=>{r(a=>a+1)},[]);return l.jsx(AG.Provider,{value:{refreshTrigger:t,triggerRefresh:n},children:e})},$G=()=>{const e=w.useContext(AG);if(e===void 0)throw new Error("useDashboardRefresh must be used within a DashboardRefreshProvider");return e};let T3=null;function abe(){const[e,t]=w.useState({totalApplicants:0,activeApplications:0,interviewsScheduled:0,successfullyOnboarded:0}),[r,n]=w.useState(!0),{user:a}=Do(),{refreshTrigger:s}=$G(),i=async()=>{try{if(n(!0),!a){console.warn("No active session, skipping metrics fetch");return}let u=T3;u||(u=await s$(),T3=u);const d=u.find(v=>v.stage_name==="Final Decision"),c=u.find(v=>v.stage_name==="Onboarded"),h=d==null?void 0:d.id,p=c==null?void 0:c.id,f=await w_(1,10),g=(f==null?void 0:f.totalCount)||0;let m=0;if(h){const v=await Wl({stage_id:h,stage_status:"Offer Sent"});m=(v==null?void 0:v.length)||0}let x=0;if(p){const v=await Wl({stage_id:p,stage_status:"Onboarded"});x=(v==null?void 0:v.length)||0}t({totalApplicants:g,activeApplications:m,interviewsScheduled:0,successfullyOnboarded:x})}catch(u){console.error("Error calculating metrics:",u)}finally{n(!1)}};w.useEffect(()=>{i()},[a,s]);const o=[{title:"Total Applicants",value:r?"...":e.totalApplicants.toLocaleString(),icon:ch,color:"text-primary",bgColor:"bg-primary/10"},{title:"Offer Letter Sent",value:r?"...":e.activeApplications.toLocaleString(),icon:Ya,color:"text-status-pending",bgColor:"bg-status-pending/10"},{title:"Successfully Onboarded",value:r?"...":e.successfullyOnboarded.toLocaleString(),icon:Xd,color:"text-status-active",bgColor:"bg-status-active/10"}];return l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(u=>l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:u.title}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:u.value})]}),l.jsx("div",{className:`w-12 h-12 ${u.bgColor} rounded-lg flex items-center justify-center`,children:l.jsx(u.icon,{className:`w-6 h-6 ${u.color}`})})]})},u.title))})}const ps=w.forwardRef(({className:e,...t},r)=>l.jsx("textarea",{className:Ue("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));ps.displayName="Textarea";const Ts=(...e)=>e.filter(Boolean).join(" ");function sbe({isOpen:e,onClose:t,onSuccess:r,schoolList:n,currentstatusList:a,religionList:s,questionSetList:i,qualificationList:o,castList:u,partnerList:d,donorList:c,stateList:h}){const[p,f]=w.useState(!1),[g,m]=w.useState("basic"),{toast:x}=Wt(),[y,v]=w.useState({}),[b,N]=w.useState([]),[S,_]=w.useState([]),[C,k]=w.useState(""),[I,T]=w.useState(""),[j,E]=w.useState(!1),[O,M]=w.useState(!1),[W,q]=w.useState(""),[P,A]=w.useState({district:!1,block:!1}),[L,z]=w.useState(null),[$,V]=w.useState({image_url:"",first_name:"",middle_name:"",last_name:"",phone_number:"",whatsapp_number:"",email:"",dob:"",city:"",block:"",blockCode:"",state:"",stateCode:"",district:"",districtCode:"",pin_code:"",cast_id:"",gender:"",qualification_id:"",current_status_id:"",religion_id:"",partner_id:"",donor_id:"",qualifying_school_id:"",school_medium:"",status:"",is_passed:!1,question_set_id:"",total_marks:36,obtained_marks:"",exam_centre:"",date_of_test:"",communication_notes:""}),B=()=>{V({image_url:"",first_name:"",middle_name:"",last_name:"",phone_number:"",whatsapp_number:"",email:"",dob:"",city:"",block:"",blockCode:"",state:"",stateCode:"",district:"",districtCode:"",pin_code:"",cast_id:"",gender:"",qualification_id:"",current_status_id:"",qualifying_school_id:"",religion_id:"",partner_id:"",donor_id:"",status:"",is_passed:!1,question_set_id:"",total_marks:0,obtained_marks:"",exam_centre:"",date_of_test:"",communication_notes:"",school_medium:""}),k(""),T(""),q(""),N([]),_([]),m("basic"),v({}),z(null)};w.useEffect(()=>{if($.question_set_id&&i.length>0){const F=i.find(te=>te.id===Number($.question_set_id));F&&V(te=>({...te,total_marks:F.maximumMarks}))}},[$.question_set_id,i]);const Y=(F,te)=>{if((F==="first_name"||F==="middle_name"||F==="last_name")&&typeof te=="string"){const pe=te.replace(/[0-9]/g,"");V(ve=>({...ve,[F]:pe}))}else if(F==="pin_code"&&typeof te=="string"){const ve=te.replace(/\D/g,"").slice(0,6);V(fe=>({...fe,[F]:ve}))}else V(pe=>({...pe,[F]:te}));y[F]&&v(pe=>{const ve={...pe};return delete ve[F],ve})};w.useEffect(()=>{if(!C){N([]),_([]),V(te=>({...te,district:"",block:""}));return}(async()=>{var te;E(!0);try{const pe=await Hh(C),fe=((pe==null?void 0:pe.data)||pe||[]).map(je=>({value:je.district_code,label:je.district_name}));N(fe);const Me=((te=h.find(je=>je.value===C))==null?void 0:te.label)||C;V(je=>({...je,district:"",districtCode:"",block:"",blockCode:"",state:Me,stateCode:C}))}catch{N([])}finally{E(!1)}})()},[C]),w.useEffect(()=>{if(!I){_([]),q(""),V(te=>({...te,block:"",blockCode:""}));return}(async()=>{var te;M(!0);try{const pe=await Kb(I),fe=((pe==null?void 0:pe.data)||pe||[]).map(je=>({value:String(je.id),label:je.block_name}));_(fe),q("");const Me=((te=b.find(je=>je.value===I))==null?void 0:te.label)||I;V(je=>({...je,district:Me,districtCode:I,block:"",blockCode:""}))}catch{_([])}finally{M(!1)}})()},[I]);const re=async F=>{var pe;const te=(pe=F.target.files)==null?void 0:pe[0];if(te)try{x({title:"Uploading...",description:"Please wait while we upload the image...",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});const ve=await u$(te);V(Me=>({...Me,image_url:ve.url}));const fe=new FileReader;fe.onloadend=()=>{z(fe.result)},fe.readAsDataURL(te),x({title:" Image Uploaded",description:"Profile image uploaded successfully!",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(ve){console.error("Error uploading image:",ve),x({title:" Upload Failed",description:ut(ve),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),F.target.value=""}},ae=()=>{const F={};return $.image_url||(F.image_url="Profile image is required"),$.first_name.trim()||(F.first_name="First name is required"),$.phone_number.trim()?/^\d{10}$/.test($.phone_number)||(F.phone_number="Mobile number must be 10 digits"):F.phone_number="Mobile number is required",$.whatsapp_number.trim()?/^\d{10}$/.test($.whatsapp_number)||(F.whatsapp_number="WhatsApp number must be 10 digits"):F.whatsapp_number="WhatsApp number is required",$.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test($.email)||(F.email="Please enter a valid email address"):F.email="Email is required",$.gender||(F.gender="Gender is required"),$.dob?new Date($.dob)>=new Date&&(F.dob="Date of birth cannot be today or in the future"):F.dob="Date of birth is required",C||(F.state="State is required"),b.length>0&&!I&&(F.district="District is required"),S.length>0&&!$.block&&(F.block="Block is required"),$.pin_code.trim()?$.pin_code.length!==6&&(F.pin_code="PIN Code must be 6 digits"):F.pin_code="PIN Code is required",$.cast_id||(F.cast_id="Caste is required"),$.qualification_id||(F.qualification_id="Qualification is required"),$.current_status_id||(F.current_status_id="Current work is required"),$.religion_id||(F.religion_id="Religion is required"),$.communication_notes.trim()||(F.communication_notes="Communication notes are required"),$.question_set_id||(F.question_set_id="Question set is required"),(!$.exam_centre||!$.exam_centre.trim())&&(F.exam_centre="Exam centre is required"),$.date_of_test||(F.date_of_test="Date of test is required"),!$.obtained_marks||$.obtained_marks===""?F.obtained_marks="Obtained marks is required":Number($.obtained_marks)<0?F.obtained_marks="Obtained marks cannot be negative":$.total_marks&&Number($.obtained_marks)>Number($.total_marks)&&(F.obtained_marks="Obtained marks cannot exceed total marks"),v(F),F},K=async()=>{var te,pe,ve,fe,Me,je,Qe,ft,Ot,yt,De,Fe,et,Ae,He,st,kt,Vt;const F=ae();if(Object.keys(F).length>0){const ur=Object.keys(F).some(we=>["question_set_id","exam_centre","date_of_test","obtained_marks"].includes(we));x({title:" Required Fields Missing",description:ur?"Please complete all required screening fields":"Please fill all required fields",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}f(!0);try{const ur={image_url:$.image_url||null,first_name:$.first_name,middle_name:$.middle_name,last_name:$.last_name,gender:$.gender||null,dob:$.dob||null,email:$.email||null,phone_number:$.phone_number,whatsapp_number:$.whatsapp_number||null,state:$.state||null,city:$.city||null,district:$.district||null,block:$.block||null,pin_code:$.pin_code||null,cast_id:$.cast_id?Number($.cast_id):null,qualification_id:$.qualification_id?Number($.qualification_id):null,current_status_id:$.current_status_id?Number($.current_status_id):null,religion_id:$.religion_id?Number($.religion_id):null,partner_id:$.partner_id?Number($.partner_id):null,donor_id:$.donor_id?Number($.donor_id):null,school_medium:$.school_medium||null,communication_notes:$.communication_notes||""},we=await a$(ur),wr=((te=we==null?void 0:we.data)==null?void 0:te.id)||(we==null?void 0:we.id);if(wr&&($.status||$.question_set_id)){const Zt={student_id:wr,status:$.status||null,question_set_id:$.question_set_id?Number($.question_set_id):null,obtained_marks:$.obtained_marks?Number($.obtained_marks):null,school_id:$.qualifying_school_id?Number($.qualifying_school_id):null,exam_centre:$.exam_centre||null,date_of_test:$.date_of_test||null},_r=await ZA(Zt)}const nr={id:wr,name:(((pe=we==null?void 0:we.data)==null?void 0:pe.first_name)||(we==null?void 0:we.first_name)||"")+((ve=we==null?void 0:we.data)!=null&&ve.middle_name||we!=null&&we.middle_name?` ${((fe=we==null?void 0:we.data)==null?void 0:fe.middle_name)||(we==null?void 0:we.middle_name)}`:"")+((Me=we==null?void 0:we.data)!=null&&Me.last_name||we!=null&&we.last_name?` ${((je=we==null?void 0:we.data)==null?void 0:je.last_name)||(we==null?void 0:we.last_name)}`:""),mobile_no:((Qe=we==null?void 0:we.data)==null?void 0:Qe.phone_number)||(we==null?void 0:we.phone_number),whatsapp_number:((ft=we==null?void 0:we.data)==null?void 0:ft.whatsapp_number)||(we==null?void 0:we.whatsapp_number),email:((Ot=we==null?void 0:we.data)==null?void 0:Ot.email)||(we==null?void 0:we.email),city:((yt=we==null?void 0:we.data)==null?void 0:yt.city)||(we==null?void 0:we.city),school_id:((De=we==null?void 0:we.data)==null?void 0:De.school_id)||(we==null?void 0:we.school_id),school:((Fe=n==null?void 0:n.find(Zt=>{var _r;return Zt.id===(((_r=we==null?void 0:we.data)==null?void 0:_r.school_id)||(we==null?void 0:we.school_id))}))==null?void 0:Fe.school_name)||"",gender:((et=we==null?void 0:we.data)==null?void 0:et.gender)||(we==null?void 0:we.gender),qualification_id:((Ae=we==null?void 0:we.data)==null?void 0:Ae.qualification_id)||(we==null?void 0:we.qualification_id),qualification:((He=o==null?void 0:o.find(Zt=>{var _r;return Zt.id===(((_r=we==null?void 0:we.data)==null?void 0:_r.qualification_id)||(we==null?void 0:we.qualification_id))}))==null?void 0:He.qualification_name)||"",current_status_id:((st=we==null?void 0:we.data)==null?void 0:st.current_status_id)||(we==null?void 0:we.current_status_id),current_work:((kt=a==null?void 0:a.find(Zt=>{var _r;return Zt.id===(((_r=we==null?void 0:we.data)==null?void 0:_r.current_status_id)||(we==null?void 0:we.current_status_id))}))==null?void 0:kt.current_status_name)||"",status:$.status,obtained_marks:$.obtained_marks,question_set_id:$.question_set_id,exam_centre:$.exam_centre,date_of_test:$.date_of_test,communication_notes:((Vt=we==null?void 0:we.data)==null?void 0:Vt.communication_notes)||(we==null?void 0:we.communication_notes)};if(!we||we.status>=400)throw new Error((we==null?void 0:we.message)||"Failed to create student");x({title:" Applicant Created Successfully",description:"The applicant has been added to the system",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),r==null||r(we==null?void 0:we.data),B(),t()}catch(ur){x({title:" Unable to Create Applicant",description:ut(ur),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{f(!1)}},J=F=>({basic:yo,screening:xo})[F]||jA,Z=F=>{switch(F){case"basic":return $.image_url&&$.first_name&&$.phone_number&&$.whatsapp_number&&$.gender&&$.dob&&$.email&&C&&I&&$.block&&$.pin_code&&$.cast_id&&$.qualification_id&&$.current_status_id&&$.religion_id&&$.communication_notes;case"screening":return!!$.status;default:return!1}},Q=()=>{const F=new Date;return F.setFullYear(F.getFullYear()-16),F.setMonth(F.getMonth()-6),F.toISOString().split("T")[0]},U=()=>{B(),t()};return l.jsx(Wr,{open:e,onOpenChange:U,children:l.jsxs(Vr,{className:"w-[95vw] max-w-5xl h-[95vh] max-h-[95vh] overflow-hidden flex flex-col p-0 sm:p-6",children:[l.jsxs(Hr,{className:"pb-4 sm:pb-6 px-4 sm:px-0 pt-4 sm:pt-0 flex-shrink-0",children:[l.jsx(qr,{className:"text-xl sm:text-2xl font-bold text-center",children:"Add New Applicant"}),l.jsx("div",{className:"flex justify-center mt-3 sm:mt-4",children:l.jsx("div",{className:"flex item-center space-x-4 sm:space-x-6 justify-between",children:["basic","screening"].map((F,te,pe)=>{const ve=J(F),fe=Z(F),Me=g===F;return l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:Ts("flex items-center justify-center w-8 h-8 sm:w-8 sm:h-8 rounded-full border-2 transition-colors",Me||fe?"bg-orange-500 border-orange-500 text-white":"border-gray-300 text-gray-400"),children:fe?l.jsx($N,{className:"w-3 h-3 sm:w-4 sm:h-4"}):l.jsx(ve,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),te<pe.length-1&&l.jsx("div",{className:Ts("w-6 sm:w-12 h-0.5 mx-1 sm:mx-2",fe?"bg-orange-400":"bg-orange-300")})]},F)})})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-4 sm:px-0",children:l.jsxs(k_,{value:g,onValueChange:m,className:"w-full",children:[l.jsxs(Xb,{className:"flex w-full justify-between mb-4 sm:mb-8 h-auto",children:[l.jsxs(Pi,{value:"basic",className:"flex-1 flex flex-col sm:flex-row items-center space-y-1 sm:space-y-0 sm:space-x-2 p-2 sm:p-3",children:[l.jsx(yo,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs sm:text-sm",children:"Basic"})]}),l.jsxs(Pi,{value:"screening",className:"flex-1 flex flex-col sm:flex-row items-center space-y-1 sm:space-y-0 sm:space-x-2 p-2 sm:p-3",children:[l.jsx(xo,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs sm:text-sm",children:"Screening"})]})]}),l.jsxs(Li,{value:"basic",className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-indigo-50 p-4 sm:p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center"}),l.jsxs("div",{className:"flex flex-col items-center mb-6",children:[l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:Ts("w-24 h-24 sm:w-32 sm:h-32 rounded-full border-4 shadow-lg overflow-hidden bg-gray-100 flex items-center justify-center",y.image_url?"border-red-500":"border-white"),children:L?l.jsx("img",{src:L,alt:"Profile",className:"w-full h-full object-cover"}):l.jsx(yo,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400"})}),l.jsxs("label",{htmlFor:"profile-image",className:"absolute bottom-0 right-0 bg-orange-500 hover:bg-orange-600 text-white p-2 rounded-full shadow-md cursor-pointer transition-colors",children:[l.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 flex items-center justify-center",children:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-full h-full",children:[l.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),l.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),l.jsx("input",{id:"profile-image",type:"file",accept:"image/*",onChange:re,className:"hidden"})]})]}),y.image_url&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center mt-2",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.image_url]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"first_name",className:"text-sm font-medium",children:"First Name *"}),l.jsx(Ve,{id:"first_name",value:$.first_name,onChange:F=>Y("first_name",F.target.value),placeholder:"Enter first name",className:y.first_name?"border-red-500":""}),y.first_name&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.first_name]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"middle_name",className:"text-sm font-medium",children:"Middle Name"}),l.jsx(Ve,{id:"middle_name",value:$.middle_name,onChange:F=>Y("middle_name",F.target.value),placeholder:"Enter middle name"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"last_name",className:"text-sm font-medium",children:"Last Name"}),l.jsx(Ve,{id:"last_name",value:$.last_name,onChange:F=>Y("last_name",F.target.value),placeholder:"Enter last name",className:y.last_name?"border-red-500":""})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"mobile",className:"text-sm font-medium",children:"Phone Number *"}),l.jsx(Ve,{id:"mobile",type:"tel",value:$.phone_number,onChange:F=>{const te=F.target.value.replace(/\D/g,"");Y("phone_number",te.slice(0,10))},placeholder:"Enter 10-digit phone number",maxLength:10,inputMode:"numeric",pattern:"[0-9]*",className:y.phone_number?"border-red-500":""}),y.phone_number&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.phone_number]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"whatsapp",className:"text-sm font-medium",children:"WhatsApp Number *"}),l.jsx(Ve,{id:"whatsapp",type:"tel",value:$.whatsapp_number,onChange:F=>{const te=F.target.value.replace(/\D/g,"");Y("whatsapp_number",te.slice(0,10))},placeholder:"Enter WhatsApp number",maxLength:10,inputMode:"numeric",pattern:"[0-9]*",className:y.whatsapp_number?"border-red-500":""}),y.whatsapp_number&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.whatsapp_number]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"email",className:"text-sm font-medium",children:"Email *"}),l.jsx(Ve,{id:"email",type:"email",value:$.email,onChange:F=>Y("email",F.target.value),placeholder:"Enter email address",className:y.email?"border-red-500":""}),y.email&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.email]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"dob",className:"text-sm font-medium",children:"Date of Birth *"}),l.jsx(Ve,{id:"dob",type:"date",value:$.dob,max:Q(),onChange:F=>Y("dob",F.target.value),className:y.dob?"border-red-500":""}),y.dob&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.dob]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"gender",className:"text-sm font-medium",children:"Gender *"}),l.jsx(sr,{options:[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"other",label:"Other"}],value:$.gender,onValueChange:F=>Y("gender",F),placeholder:"Select gender",searchPlaceholder:"Search gender...",emptyText:"No gender found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.gender&&"border-red-500")}),y.gender&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.gender]})]})]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-emerald-50 p-4 sm:p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Location Details"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"state",className:"text-sm font-medium",children:"State *"}),l.jsx(sr,{options:h,value:C,onValueChange:F=>{(I||$.block)&&(A({district:!!I,block:!!$.block}),setTimeout(()=>{A({district:!1,block:!1})},3e3)),k(F),T(""),_([])},placeholder:"Select state",searchPlaceholder:"Search state...",emptyText:"No state found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.state&&"border-red-500")}),y.state&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.state]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"district",className:"text-sm font-medium",children:["District",b.length>0&&l.jsx("span",{className:"text-red-500",children:" *"})]}),l.jsx(sr,{options:b,value:I,onValueChange:F=>{W&&(A({district:!1,block:!0}),setTimeout(()=>{A({district:!1,block:!1})},3e3)),T(F),V(te=>({...te,block:""}))},placeholder:j?"Loading districts...":C?"Select district":"Select state first",searchPlaceholder:"Search district...",emptyText:"No district found.",disabled:!C||j,className:Ts("h-10 border shadow-sm hover:bg-accent",P.district&&"border-red-500",y.district&&"border-red-500")}),y.district&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.district]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"block",className:"text-sm font-medium",children:["Block",S.length>0&&l.jsx("span",{className:"text-red-500",children:" *"})]}),l.jsx(sr,{options:S,value:W,onValueChange:F=>{var pe;q(F);const te=((pe=S.find(ve=>ve.value===F))==null?void 0:pe.label)||F;V(ve=>({...ve,block:te,blockCode:F}))},placeholder:O?"Loading blocks...":I?S.length===0?"No blocks available":"Select block":"Select district first",searchPlaceholder:"Search block...",emptyText:"No block found.",disabled:!I||O,className:Ts("h-10 border shadow-sm hover:bg-accent",(P.block||y.block)&&"border-red-500")}),y.block&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.block]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"pin_code",className:"text-sm font-medium",children:"PIN Code *"}),l.jsx(Ve,{type:"text",id:"pin_code",value:$.pin_code,onChange:F=>Y("pin_code",F.target.value),placeholder:"Enter PIN code",maxLength:6,pattern:"[0-9]{6}",inputMode:"numeric",className:y.pin_code?"border-red-500":""}),y.pin_code&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.pin_code]})]})]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-pink-50 p-4 sm:p-6 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Additional Information"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"caste_id",className:"text-sm font-medium",children:"Caste *"}),l.jsx(sr,{options:(u==null?void 0:u.map(F=>({value:String(F.id),label:F.cast_name})))||[],value:$.cast_id?String($.cast_id):"",onValueChange:F=>Y("cast_id",F==="none"?"":F),placeholder:"Select caste",searchPlaceholder:"Search caste...",emptyText:"No caste found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.cast_id&&"border-red-500")}),y.cast_id&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.cast_id]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"qualification_id",className:"text-sm font-medium",children:"Qualification *"}),l.jsx(sr,{options:(o==null?void 0:o.map(F=>({value:String(F.id),label:F.qualification_name})))||[],value:$.qualification_id?String($.qualification_id):"",onValueChange:F=>Y("qualification_id",F==="none"?"":F),placeholder:"Select qualification",searchPlaceholder:"Search qualification...",emptyText:"No qualification found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.qualification_id&&"border-red-500")}),y.qualification_id&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.qualification_id]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"current_work",className:"text-sm font-medium",children:"Current Work *"}),l.jsx(sr,{options:(a==null?void 0:a.map(F=>({value:String(F.id),label:F.current_status_name})))||[],value:$.current_status_id?String($.current_status_id):"",onValueChange:F=>Y("current_status_id",F==="none"?"":F),placeholder:"Select current work",searchPlaceholder:"Search current work...",emptyText:"No current work found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.current_status_id&&"border-red-500")}),y.current_status_id&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.current_status_id]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"religion_id",className:"text-sm font-medium",children:"Religion *"}),l.jsx(sr,{options:(s==null?void 0:s.map(F=>({value:String(F.id),label:F.religion_name})))||[],value:$.religion_id?String($.religion_id):"",onValueChange:F=>Y("religion_id",F==="none"?"":F),placeholder:"Select religion",searchPlaceholder:"Search religion...",emptyText:"No religion found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.religion_id&&"border-red-500")}),y.religion_id&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.religion_id]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"partner_id",className:"text-sm font-medium",children:"Partner"}),l.jsx(sr,{options:(d==null?void 0:d.map(F=>({value:String(F.id),label:F.partner_name})))||[],value:$.partner_id?String($.partner_id):"",onValueChange:F=>Y("partner_id",F==="none"?"":F),placeholder:"Select partner",searchPlaceholder:"Search partner...",emptyText:"No partner found.",className:"h-10 border shadow-sm hover:bg-accent"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"donor_id",className:"text-sm font-medium",children:"Donor"}),l.jsx(sr,{options:(c==null?void 0:c.map(F=>({value:String(F.id),label:F.donor_name})))||[],value:$.donor_id?String($.donor_id):"",onValueChange:F=>Y("donor_id",F==="none"?"":F),placeholder:"Select donor",searchPlaceholder:"Search donor...",emptyText:"No donor found.",className:"h-10 border shadow-sm hover:bg-accent"})]})]}),l.jsxs("div",{className:"space-y-2 mt-4",children:[l.jsx(Ee,{htmlFor:"communication_notes",className:"text-sm font-medium",children:"Communication Notes *"}),l.jsx(ps,{id:"communication_notes",value:$.communication_notes,onChange:F=>Y("communication_notes",F.target.value),placeholder:"Enter communication notes",rows:3,className:y.communication_notes?"resize-none border-red-500":"resize-none"}),y.communication_notes&&l.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[l.jsx(pn,{className:"w-3 h-3 mr-1"}),y.communication_notes]})]})]})]}),l.jsx(Li,{value:"screening",className:"space-y-4 sm:space-y-6",children:l.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 p-4 sm:p-6 rounded-lg",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(xo,{className:"w-5 h-5 mr-2 text-orange-600"}),"Screening Details"]}),l.jsxs("p",{className:"text-sm text-gray-600 mb-4 bg-blue-50 border-l-4 border-blue-400 p-3 rounded",children:[l.jsx(pn,{className:"w-4 h-4 inline mr-1 text-blue-600"}),l.jsx("strong",{children:"Note:"})," For screening students, if you enter marks, the screening status and school will be automatically updated based on the obtained marks."]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"screening_status",className:"text-sm font-medium",children:"Screening Status"}),l.jsx(sr,{options:[{value:"Screening Test Pass",label:"Screening Test Pass"},{value:"Screening Test Fail",label:"Screening Test Fail"},{value:"Created Student Without Exam",label:"Created Student Without Exam"}],value:$.status,onValueChange:F=>Y("status",F==="none"?"":F),placeholder:"Select screening status",searchPlaceholder:"Search status...",emptyText:"No status found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.status&&"border-red-500")}),y.status&&l.jsx("p",{className:"text-xs text-red-500",children:y.status})]})}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"question_set_id",className:"text-sm font-medium",children:"Question Set *"}),l.jsx(sr,{options:(i==null?void 0:i.map(F=>({value:String(F.id),label:F.name})))||[],value:$.question_set_id?String($.question_set_id):"",onValueChange:F=>Y("question_set_id",F==="none"?"":F),placeholder:"Select question set",searchPlaceholder:"Search question set...",emptyText:"No question set found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.question_set_id&&"border-red-500")}),y.question_set_id&&l.jsx("p",{className:"text-xs text-red-500",children:y.question_set_id})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"exam_centre",className:"text-sm font-medium",children:"Exam Centre *"}),l.jsx(Ve,{id:"exam_centre",value:$.exam_centre,onChange:F=>Y("exam_centre",F.target.value),placeholder:"Enter exam centre",className:y.exam_centre?"border-red-500":""}),y.exam_centre&&l.jsx("p",{className:"text-xs text-red-500",children:y.exam_centre})]}),l.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[l.jsx(Ee,{htmlFor:"date_of_test",className:"text-sm font-medium",children:"Date of Testing *"}),l.jsx(Ve,{id:"date_of_test",type:"date",value:$.date_of_test,max:new Date().toISOString().split("T")[0],onChange:F=>Y("date_of_test",F.target.value),className:y.date_of_test?"border-red-500":""}),y.date_of_test&&l.jsx("p",{className:"text-xs text-red-500",children:y.date_of_test})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"total_marks",className:"text-sm font-medium",children:"Total Marks"}),l.jsx(Ve,{id:"total_marks",type:"number",value:$.total_marks,onChange:F=>Y("total_marks",F.target.value),placeholder:"Enter total marks",disabled:!0}),$.question_set_id&&l.jsx("p",{className:"text-xs text-gray-500",children:"Auto-filled from selected question set"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"obtained_marks",className:"text-sm font-medium",children:"Obtained Marks *"}),l.jsx(Ve,{id:"obtained_marks",type:"number",value:$.obtained_marks,onChange:F=>{const te=F.target.value,pe=Number(te),ve=Number($.total_marks);te===""||pe>=0&&pe<=ve?(Y("obtained_marks",te),y.obtained_marks&&pe<=ve&&v(fe=>{const Me={...fe};return delete Me.obtained_marks,Me})):pe>ve&&v(fe=>({...fe,obtained_marks:`Obtained marks cannot exceed total marks (${ve})`}))},placeholder:"Enter obtained marks",min:"0",max:$.total_marks||void 0,className:y.obtained_marks?"border-red-500":""}),y.obtained_marks&&l.jsx("p",{className:"text-xs text-red-500",children:y.obtained_marks}),$.total_marks>0&&l.jsxs("p",{className:"text-xs text-gray-500",children:["Maximum marks: ",$.total_marks]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"qualifying_school_id",className:"text-sm font-medium",children:"Qualifying School"}),l.jsx(sr,{options:(n==null?void 0:n.map(F=>({value:String(F.id),label:F.school_name})))||[],value:$.qualifying_school_id?String($.qualifying_school_id):"",onValueChange:F=>Y("qualifying_school_id",F==="none"?"":F),placeholder:"Select qualifying school",searchPlaceholder:"Search school...",emptyText:"No school found.",className:Ts("h-10 border shadow-sm hover:bg-accent",y.qualifying_school_id&&"border-red-500")}),y.qualifying_school_id&&l.jsx("p",{className:"text-xs text-red-500",children:y.qualifying_school_id})]})]})]})})]})}),l.jsxs("div",{className:"flex-shrink-0 flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 p-4 sm:pt-4 border-t bg-white",children:[l.jsx(le,{variant:"outline",onClick:U,className:"w-full sm:w-auto",disabled:p,children:"Cancel"}),l.jsx(le,{onClick:K,disabled:p,className:"w-full sm:w-auto",children:p?l.jsxs(l.Fragment,{children:[l.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save Applicant"})]})]})})}var J_="Checkbox",[ibe,Vot]=Ia(J_),[obe,L$]=ibe(J_);function lbe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:s,form:i,name:o,onCheckedChange:u,required:d,value:c="on",internal_do_not_use_render:h}=e,[p,f]=So({prop:r,defaultProp:a??!1,onChange:u,caller:J_}),[g,m]=w.useState(null),[x,y]=w.useState(null),v=w.useRef(!1),b=g?!!i||!!g.closest("form"):!0,N={checked:p,disabled:s,setChecked:f,control:g,setControl:m,name:o,form:i,value:c,hasConsumerStoppedPropagationRef:v,required:d,defaultChecked:gc(a)?!1:a,isFormControl:b,bubbleInput:x,setBubbleInput:y};return l.jsx(obe,{scope:t,...N,children:ube(h)?h(N):n})}var RG="CheckboxTrigger",DG=w.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},a)=>{const{control:s,value:i,disabled:o,checked:u,required:d,setControl:c,setChecked:h,hasConsumerStoppedPropagationRef:p,isFormControl:f,bubbleInput:g}=L$(RG,e),m=Bt(a,c),x=w.useRef(u);return w.useEffect(()=>{const y=s==null?void 0:s.form;if(y){const v=()=>h(x.current);return y.addEventListener("reset",v),()=>y.removeEventListener("reset",v)}},[s,h]),l.jsx(at.button,{type:"button",role:"checkbox","aria-checked":gc(u)?"mixed":u,"aria-required":d,"data-state":LG(u),"data-disabled":o?"":void 0,disabled:o,value:i,...n,ref:m,onKeyDown:ze(t,y=>{y.key==="Enter"&&y.preventDefault()}),onClick:ze(r,y=>{h(v=>gc(v)?!0:!v),g&&f&&(p.current=y.isPropagationStopped(),p.current||y.stopPropagation())})})});DG.displayName=RG;var z$=w.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:s,required:i,disabled:o,value:u,onCheckedChange:d,form:c,...h}=e;return l.jsx(lbe,{__scopeCheckbox:r,checked:a,defaultChecked:s,disabled:o,required:i,onCheckedChange:d,name:n,form:c,value:u,internal_do_not_use_render:({isFormControl:p})=>l.jsxs(l.Fragment,{children:[l.jsx(DG,{...h,ref:t,__scopeCheckbox:r}),p&&l.jsx(PG,{__scopeCheckbox:r})]})})});z$.displayName=J_;var MG="CheckboxIndicator",FG=w.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,s=L$(MG,r);return l.jsx(fa,{present:n||gc(s.checked)||s.checked===!0,children:l.jsx(at.span,{"data-state":LG(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});FG.displayName=MG;var OG="CheckboxBubbleInput",PG=w.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:s,defaultChecked:i,required:o,disabled:u,name:d,value:c,form:h,bubbleInput:p,setBubbleInput:f}=L$(OG,e),g=Bt(r,f),m=m$(s),x=zA(n);w.useEffect(()=>{const v=p;if(!v)return;const b=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(b,"checked").set,_=!a.current;if(m!==s&&S){const C=new Event("click",{bubbles:_});v.indeterminate=gc(s),S.call(v,gc(s)?!1:s),v.dispatchEvent(C)}},[p,m,s,a]);const y=w.useRef(gc(s)?!1:s);return l.jsx(at.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??y.current,required:o,disabled:u,name:d,value:c,form:h,...t,tabIndex:-1,ref:g,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});PG.displayName=OG;function ube(e){return typeof e=="function"}function gc(e){return e==="indeterminate"}function LG(e){return gc(e)?"indeterminate":e?"checked":"unchecked"}const Gg=w.forwardRef(({className:e,...t},r)=>l.jsx(z$,{ref:r,className:Ue("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:l.jsx(FG,{className:Ue("flex items-center justify-center text-current"),children:l.jsx(Fb,{className:"h-4 w-4"})})}));Gg.displayName=z$.displayName;function rg(e){"@babel/helpers - typeof";return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(e)}function Ca(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function At(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function lr(e){At(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||rg(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function cs(e,t){At(2,arguments);var r=lr(e),n=Ca(t);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function Co(e,t){At(2,arguments);var r=lr(e),n=Ca(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var a=r.getDate(),s=new Date(r.getTime());s.setMonth(r.getMonth()+n+1,0);var i=s.getDate();return a>=i?s:(r.setFullYear(s.getFullYear(),s.getMonth(),a),r)}function cbe(e,t){At(2,arguments);var r=lr(e).getTime(),n=Ca(t);return new Date(r+n)}var dbe={};function Qc(){return dbe}function dl(e,t){var r,n,a,s,i,o,u,d;At(1,arguments);var c=Qc(),h=Ca((r=(n=(a=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&a!==void 0?a:c.weekStartsOn)!==null&&n!==void 0?n:(u=c.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=lr(e),f=p.getDay(),g=(f<h?7:0)+f-h;return p.setDate(p.getDate()-g),p.setHours(0,0,0,0),p}function bh(e){return At(1,arguments),dl(e,{weekStartsOn:1})}function hbe(e){At(1,arguments);var t=lr(e),r=t.getFullYear(),n=new Date(0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);var a=bh(n),s=new Date(0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);var i=bh(s);return t.getTime()>=a.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function pbe(e){At(1,arguments);var t=hbe(e),r=new Date(0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);var n=bh(r);return n}function eb(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function ng(e){At(1,arguments);var t=lr(e);return t.setHours(0,0,0,0),t}var fbe=864e5;function Vl(e,t){At(2,arguments);var r=ng(e),n=ng(t),a=r.getTime()-eb(r),s=n.getTime()-eb(n);return Math.round((a-s)/fbe)}function gT(e,t){At(2,arguments);var r=Ca(t),n=r*7;return cs(e,n)}function mbe(e,t){At(2,arguments);var r=Ca(t);return Co(e,r*12)}function gbe(e){At(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(rg(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var a=lr(n);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}function xbe(e){At(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(rg(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var a=lr(n);(r===void 0||r>a||isNaN(a.getDate()))&&(r=a)}),r||new Date(NaN)}function Bs(e,t){At(2,arguments);var r=ng(e),n=ng(t);return r.getTime()===n.getTime()}function B$(e){return At(1,arguments),e instanceof Date||rg(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ybe(e){if(At(1,arguments),!B$(e)&&typeof e!="number")return!1;var t=lr(e);return!isNaN(Number(t))}function tb(e,t){At(2,arguments);var r=lr(e),n=lr(t),a=r.getFullYear()-n.getFullYear(),s=r.getMonth()-n.getMonth();return a*12+s}var vbe=6048e5;function bbe(e,t,r){At(2,arguments);var n=dl(e,r),a=dl(t,r),s=n.getTime()-eb(n),i=a.getTime()-eb(a);return Math.round((s-i)/vbe)}function U$(e){At(1,arguments);var t=lr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Ks(e){At(1,arguments);var t=lr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function wbe(e){At(1,arguments);var t=lr(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function W$(e,t){var r,n,a,s,i,o,u,d;At(1,arguments);var c=Qc(),h=Ca((r=(n=(a=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&a!==void 0?a:c.weekStartsOn)!==null&&n!==void 0?n:(u=c.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=lr(e),f=p.getDay(),g=(f<h?-7:0)+6-(f-h);return p.setDate(p.getDate()+g),p.setHours(23,59,59,999),p}function zG(e){return At(1,arguments),W$(e,{weekStartsOn:1})}function Nbe(e,t){At(2,arguments);var r=Ca(t);return cbe(e,-r)}var Sbe=864e5;function _be(e){At(1,arguments);var t=lr(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),a=r-n;return Math.floor(a/Sbe)+1}function qN(e){At(1,arguments);var t=1,r=lr(e),n=r.getUTCDay(),a=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-a),r.setUTCHours(0,0,0,0),r}function BG(e){At(1,arguments);var t=lr(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var a=qN(n),s=new Date(0);s.setUTCFullYear(r,0,4),s.setUTCHours(0,0,0,0);var i=qN(s);return t.getTime()>=a.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function kbe(e){At(1,arguments);var t=BG(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=qN(r);return n}var Cbe=6048e5;function Ibe(e){At(1,arguments);var t=lr(e),r=qN(t).getTime()-kbe(t).getTime();return Math.round(r/Cbe)+1}function GN(e,t){var r,n,a,s,i,o,u,d;At(1,arguments);var c=Qc(),h=Ca((r=(n=(a=(s=t==null?void 0:t.weekStartsOn)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&a!==void 0?a:c.weekStartsOn)!==null&&n!==void 0?n:(u=c.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=lr(e),f=p.getUTCDay(),g=(f<h?7:0)+f-h;return p.setUTCDate(p.getUTCDate()-g),p.setUTCHours(0,0,0,0),p}function UG(e,t){var r,n,a,s,i,o,u,d;At(1,arguments);var c=lr(e),h=c.getUTCFullYear(),p=Qc(),f=Ca((r=(n=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:p.firstWeekContainsDate)!==null&&n!==void 0?n:(u=p.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var g=new Date(0);g.setUTCFullYear(h+1,0,f),g.setUTCHours(0,0,0,0);var m=GN(g,t),x=new Date(0);x.setUTCFullYear(h,0,f),x.setUTCHours(0,0,0,0);var y=GN(x,t);return c.getTime()>=m.getTime()?h+1:c.getTime()>=y.getTime()?h:h-1}function Ebe(e,t){var r,n,a,s,i,o,u,d;At(1,arguments);var c=Qc(),h=Ca((r=(n=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:c.firstWeekContainsDate)!==null&&n!==void 0?n:(u=c.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),p=UG(e,t),f=new Date(0);f.setUTCFullYear(p,0,h),f.setUTCHours(0,0,0,0);var g=GN(f,t);return g}var Tbe=6048e5;function jbe(e,t){At(1,arguments);var r=lr(e),n=GN(r,t).getTime()-Ebe(r,t).getTime();return Math.round(n/Tbe)+1}function Dr(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var _u={y:function(t,r){var n=t.getUTCFullYear(),a=n>0?n:1-n;return Dr(r==="yy"?a%100:a,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):Dr(n+1,2)},d:function(t,r){return Dr(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return Dr(t.getUTCHours()%12||12,r.length)},H:function(t,r){return Dr(t.getUTCHours(),r.length)},m:function(t,r){return Dr(t.getUTCMinutes(),r.length)},s:function(t,r){return Dr(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,a=t.getUTCMilliseconds(),s=Math.floor(a*Math.pow(10,n-3));return Dr(s,r.length)}},Lf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Abe={G:function(t,r,n){var a=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});case"GGGG":default:return n.era(a,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var a=t.getUTCFullYear(),s=a>0?a:1-a;return n.ordinalNumber(s,{unit:"year"})}return _u.y(t,r)},Y:function(t,r,n,a){var s=UG(t,a),i=s>0?s:1-s;if(r==="YY"){var o=i%100;return Dr(o,2)}return r==="Yo"?n.ordinalNumber(i,{unit:"year"}):Dr(i,r.length)},R:function(t,r){var n=BG(t);return Dr(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return Dr(n,r.length)},Q:function(t,r,n){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(a);case"QQ":return Dr(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,r,n){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(a);case"qq":return Dr(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,r,n){var a=t.getUTCMonth();switch(r){case"M":case"MM":return _u.M(t,r);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(t,r,n){var a=t.getUTCMonth();switch(r){case"L":return String(a+1);case"LL":return Dr(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(t,r,n,a){var s=jbe(t,a);return r==="wo"?n.ordinalNumber(s,{unit:"week"}):Dr(s,r.length)},I:function(t,r,n){var a=Ibe(t);return r==="Io"?n.ordinalNumber(a,{unit:"week"}):Dr(a,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):_u.d(t,r)},D:function(t,r,n){var a=_be(t);return r==="Do"?n.ordinalNumber(a,{unit:"dayOfYear"}):Dr(a,r.length)},E:function(t,r,n){var a=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});case"EEEE":default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(t,r,n,a){var s=t.getUTCDay(),i=(s-a.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return Dr(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,r,n,a){var s=t.getUTCDay(),i=(s-a.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return Dr(i,r.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,r,n){var a=t.getUTCDay(),s=a===0?7:a;switch(r){case"i":return String(s);case"ii":return Dr(s,r.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});case"iiii":default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(t,r,n){var a=t.getUTCHours(),s=a/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,r,n){var a=t.getUTCHours(),s;switch(a===12?s=Lf.noon:a===0?s=Lf.midnight:s=a/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,r,n){var a=t.getUTCHours(),s;switch(a>=17?s=Lf.evening:a>=12?s=Lf.afternoon:a>=4?s=Lf.morning:s=Lf.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var a=t.getUTCHours()%12;return a===0&&(a=12),n.ordinalNumber(a,{unit:"hour"})}return _u.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):_u.H(t,r)},K:function(t,r,n){var a=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(a,{unit:"hour"}):Dr(a,r.length)},k:function(t,r,n){var a=t.getUTCHours();return a===0&&(a=24),r==="ko"?n.ordinalNumber(a,{unit:"hour"}):Dr(a,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):_u.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):_u.s(t,r)},S:function(t,r){return _u.S(t,r)},X:function(t,r,n,a){var s=a._originalDate||t,i=s.getTimezoneOffset();if(i===0)return"Z";switch(r){case"X":return A3(i);case"XXXX":case"XX":return Nd(i);case"XXXXX":case"XXX":default:return Nd(i,":")}},x:function(t,r,n,a){var s=a._originalDate||t,i=s.getTimezoneOffset();switch(r){case"x":return A3(i);case"xxxx":case"xx":return Nd(i);case"xxxxx":case"xxx":default:return Nd(i,":")}},O:function(t,r,n,a){var s=a._originalDate||t,i=s.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+j3(i,":");case"OOOO":default:return"GMT"+Nd(i,":")}},z:function(t,r,n,a){var s=a._originalDate||t,i=s.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+j3(i,":");case"zzzz":default:return"GMT"+Nd(i,":")}},t:function(t,r,n,a){var s=a._originalDate||t,i=Math.floor(s.getTime()/1e3);return Dr(i,r.length)},T:function(t,r,n,a){var s=a._originalDate||t,i=s.getTime();return Dr(i,r.length)}};function j3(e,t){var r=e>0?"-":"+",n=Math.abs(e),a=Math.floor(n/60),s=n%60;if(s===0)return r+String(a);var i=t;return r+String(a)+i+Dr(s,2)}function A3(e,t){if(e%60===0){var r=e>0?"-":"+";return r+Dr(Math.abs(e)/60,2)}return Nd(e,t)}function Nd(e,t){var r=t||"",n=e>0?"-":"+",a=Math.abs(e),s=Dr(Math.floor(a/60),2),i=Dr(a%60,2);return n+s+r+i}var $3=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},WG=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},$be=function(t,r){var n=t.match(/(P+)(p+)?/)||[],a=n[1],s=n[2];if(!s)return $3(t,r);var i;switch(a){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",$3(a,r)).replace("{{time}}",WG(s,r))},Rbe={p:WG,P:$be},Dbe=["D","DD"],Mbe=["YY","YYYY"];function Fbe(e){return Dbe.indexOf(e)!==-1}function Obe(e){return Mbe.indexOf(e)!==-1}function R3(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Pbe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Lbe=function(t,r,n){var a,s=Pbe[t];return typeof s=="string"?a=s:r===1?a=s.one:a=s.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a};function V2(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var zbe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Bbe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Ube={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Wbe={date:V2({formats:zbe,defaultWidth:"full"}),time:V2({formats:Bbe,defaultWidth:"full"}),dateTime:V2({formats:Ube,defaultWidth:"full"})},Vbe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Hbe=function(t,r,n,a){return Vbe[t]};function Dy(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",a;if(n==="formatting"&&e.formattingValues){var s=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):s;a=e.formattingValues[i]||e.formattingValues[s]}else{var o=e.defaultWidth,u=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[u]||e.values[o]}var d=e.argumentCallback?e.argumentCallback(t):t;return a[d]}}var qbe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Gbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Kbe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Qbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Xbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ybe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Jbe=function(t,r){var n=Number(t),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Zbe={ordinalNumber:Jbe,era:Dy({values:qbe,defaultWidth:"wide"}),quarter:Dy({values:Gbe,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Dy({values:Kbe,defaultWidth:"wide"}),day:Dy({values:Qbe,defaultWidth:"wide"}),dayPeriod:Dy({values:Xbe,defaultWidth:"wide",formattingValues:Ybe,defaultFormattingWidth:"wide"})};function My(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;var i=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(o)?t0e(o,function(h){return h.test(i)}):e0e(o,function(h){return h.test(i)}),d;d=e.valueCallback?e.valueCallback(u):u,d=r.valueCallback?r.valueCallback(d):d;var c=t.slice(i.length);return{value:d,rest:c}}}function e0e(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function t0e(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function r0e(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var a=n[0],s=t.match(e.parsePattern);if(!s)return null;var i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;var o=t.slice(a.length);return{value:i,rest:o}}}var n0e=/^(\d+)(th|st|nd|rd)?/i,a0e=/\d+/i,s0e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},i0e={any:[/^b/i,/^(a|c)/i]},o0e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},l0e={any:[/1/i,/2/i,/3/i,/4/i]},u0e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},c0e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},d0e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},h0e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},p0e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},f0e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},m0e={ordinalNumber:r0e({matchPattern:n0e,parsePattern:a0e,valueCallback:function(t){return parseInt(t,10)}}),era:My({matchPatterns:s0e,defaultMatchWidth:"wide",parsePatterns:i0e,defaultParseWidth:"any"}),quarter:My({matchPatterns:o0e,defaultMatchWidth:"wide",parsePatterns:l0e,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:My({matchPatterns:u0e,defaultMatchWidth:"wide",parsePatterns:c0e,defaultParseWidth:"any"}),day:My({matchPatterns:d0e,defaultMatchWidth:"wide",parsePatterns:h0e,defaultParseWidth:"any"}),dayPeriod:My({matchPatterns:p0e,defaultMatchWidth:"any",parsePatterns:f0e,defaultParseWidth:"any"})},VG={code:"en-US",formatDistance:Lbe,formatLong:Wbe,formatRelative:Hbe,localize:Zbe,match:m0e,options:{weekStartsOn:0,firstWeekContainsDate:1}},g0e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,x0e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,y0e=/^'([^]*?)'?$/,v0e=/''/g,b0e=/[a-zA-Z]/;function Nn(e,t,r){var n,a,s,i,o,u,d,c,h,p,f,g,m,x,y,v,b,N;At(2,arguments);var S=String(t),_=Qc(),C=(n=(a=r==null?void 0:r.locale)!==null&&a!==void 0?a:_.locale)!==null&&n!==void 0?n:VG,k=Ca((s=(i=(o=(u=r==null?void 0:r.firstWeekContainsDate)!==null&&u!==void 0?u:r==null||(d=r.locale)===null||d===void 0||(c=d.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&o!==void 0?o:_.firstWeekContainsDate)!==null&&i!==void 0?i:(h=_.locale)===null||h===void 0||(p=h.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(k>=1&&k<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var I=Ca((f=(g=(m=(x=r==null?void 0:r.weekStartsOn)!==null&&x!==void 0?x:r==null||(y=r.locale)===null||y===void 0||(v=y.options)===null||v===void 0?void 0:v.weekStartsOn)!==null&&m!==void 0?m:_.weekStartsOn)!==null&&g!==void 0?g:(b=_.locale)===null||b===void 0||(N=b.options)===null||N===void 0?void 0:N.weekStartsOn)!==null&&f!==void 0?f:0);if(!(I>=0&&I<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!C.localize)throw new RangeError("locale must contain localize property");if(!C.formatLong)throw new RangeError("locale must contain formatLong property");var T=lr(e);if(!ybe(T))throw new RangeError("Invalid time value");var j=eb(T),E=Nbe(T,j),O={firstWeekContainsDate:k,weekStartsOn:I,locale:C,_originalDate:T},M=S.match(x0e).map(function(W){var q=W[0];if(q==="p"||q==="P"){var P=Rbe[q];return P(W,C.formatLong)}return W}).join("").match(g0e).map(function(W){if(W==="''")return"'";var q=W[0];if(q==="'")return w0e(W);var P=Abe[q];if(P)return!(r!=null&&r.useAdditionalWeekYearTokens)&&Obe(W)&&R3(W,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&Fbe(W)&&R3(W,t,String(e)),P(E,W,C.localize,O);if(q.match(b0e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+q+"`");return W}).join("");return M}function w0e(e){var t=e.match(y0e);return t?t[1].replace(v0e,"'"):e}function N0e(e){At(1,arguments);var t=lr(e),r=t.getFullYear(),n=t.getMonth(),a=new Date(0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}var S0e=6048e5;function _0e(e){At(1,arguments);var t=lr(e),r=bh(t).getTime()-pbe(t).getTime();return Math.round(r/S0e)+1}function k0e(e){At(1,arguments);var t=lr(e),r=t.getTime();return r}function C0e(e){return At(1,arguments),Math.floor(k0e(e)/1e3)}function I0e(e,t){var r,n,a,s,i,o,u,d;At(1,arguments);var c=lr(e),h=c.getFullYear(),p=Qc(),f=Ca((r=(n=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:p.firstWeekContainsDate)!==null&&n!==void 0?n:(u=p.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var g=new Date(0);g.setFullYear(h+1,0,f),g.setHours(0,0,0,0);var m=dl(g,t),x=new Date(0);x.setFullYear(h,0,f),x.setHours(0,0,0,0);var y=dl(x,t);return c.getTime()>=m.getTime()?h+1:c.getTime()>=y.getTime()?h:h-1}function E0e(e,t){var r,n,a,s,i,o,u,d;At(1,arguments);var c=Qc(),h=Ca((r=(n=(a=(s=t==null?void 0:t.firstWeekContainsDate)!==null&&s!==void 0?s:t==null||(i=t.locale)===null||i===void 0||(o=i.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&a!==void 0?a:c.firstWeekContainsDate)!==null&&n!==void 0?n:(u=c.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),p=I0e(e,t),f=new Date(0);f.setFullYear(p,0,h),f.setHours(0,0,0,0);var g=dl(f,t);return g}var T0e=6048e5;function j0e(e,t){At(1,arguments);var r=lr(e),n=dl(r,t).getTime()-E0e(r,t).getTime();return Math.round(n/T0e)+1}function A0e(e){At(1,arguments);var t=lr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function $0e(e,t){return At(1,arguments),bbe(A0e(e),Ks(e),t)+1}function xT(e,t){At(2,arguments);var r=lr(e),n=lr(t);return r.getTime()>n.getTime()}function HG(e,t){At(2,arguments);var r=lr(e),n=lr(t);return r.getTime()<n.getTime()}function V$(e,t){At(2,arguments);var r=lr(e),n=lr(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function R0e(e,t){At(2,arguments);var r=lr(e),n=lr(t);return r.getFullYear()===n.getFullYear()}function H2(e,t){At(2,arguments);var r=Ca(t);return cs(e,-r)}function q2(e,t){At(2,arguments);var r=lr(e),n=Ca(t),a=r.getFullYear(),s=r.getDate(),i=new Date(0);i.setFullYear(a,n,15),i.setHours(0,0,0,0);var o=N0e(i);return r.setMonth(n,Math.min(s,o)),r}function D3(e,t){At(2,arguments);var r=lr(e),n=Ca(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(n),r)}var Ft=function(){return Ft=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ft.apply(this,arguments)};function D0e(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function qG(e,t,r){for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function n0(e){return e.mode==="multiple"}function a0(e){return e.mode==="range"}function Z_(e){return e.mode==="single"}var M0e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function F0e(e,t){return Nn(e,"LLLL y",t)}function O0e(e,t){return Nn(e,"d",t)}function P0e(e,t){return Nn(e,"LLLL",t)}function L0e(e){return"".concat(e)}function z0e(e,t){return Nn(e,"cccccc",t)}function B0e(e,t){return Nn(e,"yyyy",t)}var U0e=Object.freeze({__proto__:null,formatCaption:F0e,formatDay:O0e,formatMonthCaption:P0e,formatWeekNumber:L0e,formatWeekdayName:z0e,formatYearCaption:B0e}),W0e=function(e,t,r){return Nn(e,"do MMMM (EEEE)",r)},V0e=function(){return"Month: "},H0e=function(){return"Go to next month"},q0e=function(){return"Go to previous month"},G0e=function(e,t){return Nn(e,"cccc",t)},K0e=function(e){return"Week n. ".concat(e)},Q0e=function(){return"Year: "},X0e=Object.freeze({__proto__:null,labelDay:W0e,labelMonthDropdown:V0e,labelNext:H0e,labelPrevious:q0e,labelWeekNumber:K0e,labelWeekday:G0e,labelYearDropdown:Q0e});function Y0e(){var e="buttons",t=M0e,r=VG,n={},a={},s=1,i={},o=new Date;return{captionLayout:e,classNames:t,formatters:U0e,labels:X0e,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:s,styles:i,today:o,mode:"default"}}function J0e(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,s=e.fromDate,i=e.toDate;return n?s=Ks(n):t&&(s=new Date(t,0,1)),a?i=U$(a):r&&(i=new Date(r,11,31)),{fromDate:s?ng(s):void 0,toDate:i?ng(i):void 0}}var GG=w.createContext(void 0);function Z0e(e){var t,r=e.initialProps,n=Y0e(),a=J0e(r),s=a.fromDate,i=a.toDate,o=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;o!=="buttons"&&(!s||!i)&&(o="buttons");var u;(Z_(r)||n0(r)||a0(r))&&(u=r.onSelect);var d=Ft(Ft(Ft({},n),r),{captionLayout:o,classNames:Ft(Ft({},n.classNames),r.classNames),components:Ft({},r.components),formatters:Ft(Ft({},n.formatters),r.formatters),fromDate:s,labels:Ft(Ft({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:Ft(Ft({},n.modifiers),r.modifiers),modifiersClassNames:Ft(Ft({},n.modifiersClassNames),r.modifiersClassNames),onSelect:u,styles:Ft(Ft({},n.styles),r.styles),toDate:i});return l.jsx(GG.Provider,{value:d,children:e.children})}function nn(){var e=w.useContext(GG);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function KG(e){var t=nn(),r=t.locale,n=t.classNames,a=t.styles,s=t.formatters.formatCaption;return l.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:r})})}function ewe(e){return l.jsx("svg",Ft({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:l.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function QG(e){var t,r,n=e.onChange,a=e.value,s=e.children,i=e.caption,o=e.className,u=e.style,d=nn(),c=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:ewe;return l.jsxs("div",{className:o,style:u,children:[l.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),l.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:a,onChange:n,children:s}),l.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[i,l.jsx(c,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function twe(e){var t,r=nn(),n=r.fromDate,a=r.toDate,s=r.styles,i=r.locale,o=r.formatters.formatMonthCaption,u=r.classNames,d=r.components,c=r.labels.labelMonthDropdown;if(!n)return l.jsx(l.Fragment,{});if(!a)return l.jsx(l.Fragment,{});var h=[];if(R0e(n,a))for(var p=Ks(n),f=n.getMonth();f<=a.getMonth();f++)h.push(q2(p,f));else for(var p=Ks(new Date),f=0;f<=11;f++)h.push(q2(p,f));var g=function(x){var y=Number(x.target.value),v=q2(Ks(e.displayMonth),y);e.onChange(v)},m=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:QG;return l.jsx(m,{name:"months","aria-label":c(),className:u.dropdown_month,style:s.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:o(e.displayMonth,{locale:i}),children:h.map(function(x){return l.jsx("option",{value:x.getMonth(),children:o(x,{locale:i})},x.getMonth())})})}function rwe(e){var t,r=e.displayMonth,n=nn(),a=n.fromDate,s=n.toDate,i=n.locale,o=n.styles,u=n.classNames,d=n.components,c=n.formatters.formatYearCaption,h=n.labels.labelYearDropdown,p=[];if(!a)return l.jsx(l.Fragment,{});if(!s)return l.jsx(l.Fragment,{});for(var f=a.getFullYear(),g=s.getFullYear(),m=f;m<=g;m++)p.push(D3(wbe(new Date),m));var x=function(v){var b=D3(Ks(r),Number(v.target.value));e.onChange(b)},y=(t=d==null?void 0:d.Dropdown)!==null&&t!==void 0?t:QG;return l.jsx(y,{name:"years","aria-label":h(),className:u.dropdown_year,style:o.dropdown_year,onChange:x,value:r.getFullYear(),caption:c(r,{locale:i}),children:p.map(function(v){return l.jsx("option",{value:v.getFullYear(),children:c(v,{locale:i})},v.getFullYear())})})}function nwe(e,t){var r=w.useState(e),n=r[0],a=r[1],s=t===void 0?n:t;return[s,a]}function awe(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,s=e.toDate,i=e.fromDate,o=e.numberOfMonths,u=o===void 0?1:o;if(s&&tb(s,a)<0){var d=-1*(u-1);a=Co(s,d)}return i&&tb(a,i)<0&&(a=i),Ks(a)}function swe(){var e=nn(),t=awe(e),r=nwe(t,e.month),n=r[0],a=r[1],s=function(i){var o;if(!e.disableNavigation){var u=Ks(i);a(u),(o=e.onMonthChange)===null||o===void 0||o.call(e,u)}};return[n,s]}function iwe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=Ks(e),s=Ks(Co(a,n)),i=tb(s,a),o=[],u=0;u<i;u++){var d=Co(a,u);o.push(d)}return r&&(o=o.reverse()),o}function owe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=n?s:1,o=Ks(e);if(!r)return Co(o,i);var u=tb(r,e);if(!(u<s))return Co(o,i)}}function lwe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=n?s:1,o=Ks(e);if(!r)return Co(o,-i);var u=tb(o,r);if(!(u<=0))return Co(o,-i)}}var XG=w.createContext(void 0);function uwe(e){var t=nn(),r=swe(),n=r[0],a=r[1],s=iwe(n,t),i=owe(n,t),o=lwe(n,t),u=function(h){return s.some(function(p){return V$(h,p)})},d=function(h,p){u(h)||(p&&HG(h,p)?a(Co(h,1+t.numberOfMonths*-1)):a(h))},c={currentMonth:n,displayMonths:s,goToMonth:a,goToDate:d,previousMonth:o,nextMonth:i,isDateDisplayed:u};return l.jsx(XG.Provider,{value:c,children:e.children})}function s0(){var e=w.useContext(XG);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function M3(e){var t,r=nn(),n=r.classNames,a=r.styles,s=r.components,i=s0().goToMonth,o=function(c){i(Co(c,e.displayIndex?-e.displayIndex:0))},u=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:KG,d=l.jsx(u,{id:e.id,displayMonth:e.displayMonth});return l.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[l.jsx("div",{className:n.vhidden,children:d}),l.jsx(twe,{onChange:o,displayMonth:e.displayMonth}),l.jsx(rwe,{onChange:o,displayMonth:e.displayMonth})]})}function cwe(e){return l.jsx("svg",Ft({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:l.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function dwe(e){return l.jsx("svg",Ft({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:l.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var KN=w.forwardRef(function(e,t){var r=nn(),n=r.classNames,a=r.styles,s=[n.button_reset,n.button];e.className&&s.push(e.className);var i=s.join(" "),o=Ft(Ft({},a.button_reset),a.button);return e.style&&Object.assign(o,e.style),l.jsx("button",Ft({},e,{ref:t,type:"button",className:i,style:o}))});function hwe(e){var t,r,n=nn(),a=n.dir,s=n.locale,i=n.classNames,o=n.styles,u=n.labels,d=u.labelPrevious,c=u.labelNext,h=n.components;if(!e.nextMonth&&!e.previousMonth)return l.jsx(l.Fragment,{});var p=d(e.previousMonth,{locale:s}),f=[i.nav_button,i.nav_button_previous].join(" "),g=c(e.nextMonth,{locale:s}),m=[i.nav_button,i.nav_button_next].join(" "),x=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:dwe,y=(r=h==null?void 0:h.IconLeft)!==null&&r!==void 0?r:cwe;return l.jsxs("div",{className:i.nav,style:o.nav,children:[!e.hidePrevious&&l.jsx(KN,{name:"previous-month","aria-label":p,className:f,style:o.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?l.jsx(x,{className:i.nav_icon,style:o.nav_icon}):l.jsx(y,{className:i.nav_icon,style:o.nav_icon})}),!e.hideNext&&l.jsx(KN,{name:"next-month","aria-label":g,className:m,style:o.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?l.jsx(y,{className:i.nav_icon,style:o.nav_icon}):l.jsx(x,{className:i.nav_icon,style:o.nav_icon})})]})}function F3(e){var t=nn().numberOfMonths,r=s0(),n=r.previousMonth,a=r.nextMonth,s=r.goToMonth,i=r.displayMonths,o=i.findIndex(function(g){return V$(e.displayMonth,g)}),u=o===0,d=o===i.length-1,c=t>1&&(u||!d),h=t>1&&(d||!u),p=function(){n&&s(n)},f=function(){a&&s(a)};return l.jsx(hwe,{displayMonth:e.displayMonth,hideNext:c,hidePrevious:h,nextMonth:a,previousMonth:n,onPreviousClick:p,onNextClick:f})}function pwe(e){var t,r=nn(),n=r.classNames,a=r.disableNavigation,s=r.styles,i=r.captionLayout,o=r.components,u=(t=o==null?void 0:o.CaptionLabel)!==null&&t!==void 0?t:KG,d;return a?d=l.jsx(u,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?d=l.jsx(M3,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?d=l.jsxs(l.Fragment,{children:[l.jsx(M3,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),l.jsx(F3,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=l.jsxs(l.Fragment,{children:[l.jsx(u,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),l.jsx(F3,{displayMonth:e.displayMonth,id:e.id})]}),l.jsx("div",{className:n.caption,style:s.caption,children:d})}function fwe(e){var t=nn(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?l.jsx("tfoot",{className:a,style:n.tfoot,children:l.jsx("tr",{children:l.jsx("td",{colSpan:8,children:r})})}):l.jsx(l.Fragment,{})}function mwe(e,t,r){for(var n=r?bh(new Date):dl(new Date,{locale:e,weekStartsOn:t}),a=[],s=0;s<7;s++){var i=cs(n,s);a.push(i)}return a}function gwe(){var e=nn(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,s=e.weekStartsOn,i=e.ISOWeek,o=e.formatters.formatWeekdayName,u=e.labels.labelWeekday,d=mwe(a,s,i);return l.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&l.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(c,h){return l.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":u(c,{locale:a}),children:o(c,{locale:a})},h)})]})}function xwe(){var e,t=nn(),r=t.classNames,n=t.styles,a=t.components,s=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:gwe;return l.jsx("thead",{style:n.head,className:r.head,children:l.jsx(s,{})})}function ywe(e){var t=nn(),r=t.locale,n=t.formatters.formatDay;return l.jsx(l.Fragment,{children:n(e.date,{locale:r})})}var H$=w.createContext(void 0);function vwe(e){if(!n0(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return l.jsx(H$.Provider,{value:t,children:e.children})}return l.jsx(bwe,{initialProps:e.initialProps,children:e.children})}function bwe(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,s=t.max,i=function(d,c,h){var p,f;(p=t.onDayClick)===null||p===void 0||p.call(t,d,c,h);var g=!!(c.selected&&a&&(n==null?void 0:n.length)===a);if(!g){var m=!!(!c.selected&&s&&(n==null?void 0:n.length)===s);if(!m){var x=n?qG([],n):[];if(c.selected){var y=x.findIndex(function(v){return Bs(d,v)});x.splice(y,1)}else x.push(d);(f=t.onSelect)===null||f===void 0||f.call(t,x,d,c,h)}}},o={disabled:[]};n&&o.disabled.push(function(d){var c=s&&n.length>s-1,h=n.some(function(p){return Bs(p,d)});return!!(c&&!h)});var u={selected:n,onDayClick:i,modifiers:o};return l.jsx(H$.Provider,{value:u,children:r})}function q$(){var e=w.useContext(H$);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function wwe(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Bs(a,e)&&Bs(n,e)?void 0:Bs(a,e)?{from:a,to:void 0}:Bs(n,e)?void 0:xT(n,e)?{from:e,to:a}:{from:n,to:e}:a?xT(e,a)?{from:a,to:e}:{from:e,to:a}:n?HG(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var G$=w.createContext(void 0);function Nwe(e){if(!a0(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return l.jsx(G$.Provider,{value:t,children:e.children})}return l.jsx(Swe,{initialProps:e.initialProps,children:e.children})}function Swe(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},s=a.from,i=a.to,o=t.min,u=t.max,d=function(f,g,m){var x,y;(x=t.onDayClick)===null||x===void 0||x.call(t,f,g,m);var v=wwe(f,n);(y=t.onSelect)===null||y===void 0||y.call(t,v,f,g,m)},c={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(c.range_start=[s],i?(c.range_end=[i],Bs(s,i)||(c.range_middle=[{after:s,before:i}])):c.range_end=[s]):i&&(c.range_start=[i],c.range_end=[i]),o&&(s&&!i&&c.disabled.push({after:H2(s,o-1),before:cs(s,o-1)}),s&&i&&c.disabled.push({after:s,before:cs(s,o-1)}),!s&&i&&c.disabled.push({after:H2(i,o-1),before:cs(i,o-1)})),u){if(s&&!i&&(c.disabled.push({before:cs(s,-u+1)}),c.disabled.push({after:cs(s,u-1)})),s&&i){var h=Vl(i,s)+1,p=u-h;c.disabled.push({before:H2(s,p)}),c.disabled.push({after:cs(i,p)})}!s&&i&&(c.disabled.push({before:cs(i,-u+1)}),c.disabled.push({after:cs(i,u-1)}))}return l.jsx(G$.Provider,{value:{selected:n,onDayClick:d,modifiers:c},children:r})}function K$(){var e=w.useContext(G$);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Q1(e){return Array.isArray(e)?qG([],e):e!==void 0?[e]:[]}function _we(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=Q1(a)}),t}var Io;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Io||(Io={}));var kwe=Io.Selected,El=Io.Disabled,Cwe=Io.Hidden,Iwe=Io.Today,G2=Io.RangeEnd,K2=Io.RangeMiddle,Q2=Io.RangeStart,Ewe=Io.Outside;function Twe(e,t,r){var n,a=(n={},n[kwe]=Q1(e.selected),n[El]=Q1(e.disabled),n[Cwe]=Q1(e.hidden),n[Iwe]=[e.today],n[G2]=[],n[K2]=[],n[Q2]=[],n[Ewe]=[],n);return e.fromDate&&a[El].push({before:e.fromDate}),e.toDate&&a[El].push({after:e.toDate}),n0(e)?a[El]=a[El].concat(t.modifiers[El]):a0(e)&&(a[El]=a[El].concat(r.modifiers[El]),a[Q2]=r.modifiers[Q2],a[K2]=r.modifiers[K2],a[G2]=r.modifiers[G2]),a}var YG=w.createContext(void 0);function jwe(e){var t=nn(),r=q$(),n=K$(),a=Twe(t,r,n),s=_we(t.modifiers),i=Ft(Ft({},a),s);return l.jsx(YG.Provider,{value:i,children:e.children})}function JG(){var e=w.useContext(YG);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Awe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function $we(e){return!!(e&&typeof e=="object"&&"from"in e)}function Rwe(e){return!!(e&&typeof e=="object"&&"after"in e)}function Dwe(e){return!!(e&&typeof e=="object"&&"before"in e)}function Mwe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Fwe(e,t){var r,n=t.from,a=t.to;if(n&&a){var s=Vl(a,n)<0;s&&(r=[a,n],n=r[0],a=r[1]);var i=Vl(e,n)>=0&&Vl(a,e)>=0;return i}return a?Bs(a,e):n?Bs(n,e):!1}function Owe(e){return B$(e)}function Pwe(e){return Array.isArray(e)&&e.every(B$)}function Lwe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(Owe(r))return Bs(e,r);if(Pwe(r))return r.includes(e);if($we(r))return Fwe(e,r);if(Mwe(r))return r.dayOfWeek.includes(e.getDay());if(Awe(r)){var n=Vl(r.before,e),a=Vl(r.after,e),s=n>0,i=a<0,o=xT(r.before,r.after);return o?i&&s:s||i}return Rwe(r)?Vl(e,r.after)>0:Dwe(r)?Vl(r.before,e)>0:typeof r=="function"?r(e):!1})}function Q$(e,t,r){var n=Object.keys(t).reduce(function(s,i){var o=t[i];return Lwe(e,o)&&s.push(i),s},[]),a={};return n.forEach(function(s){return a[s]=!0}),r&&!V$(e,r)&&(a.outside=!0),a}function zwe(e,t){for(var r=Ks(e[0]),n=U$(e[e.length-1]),a,s,i=r;i<=n;){var o=Q$(i,t),u=!o.disabled&&!o.hidden;if(!u){i=cs(i,1);continue}if(o.selected)return i;o.today&&!s&&(s=i),a||(a=i),i=cs(i,1)}return s||a}var Bwe=365;function ZG(e,t){var r=t.moveBy,n=t.direction,a=t.context,s=t.modifiers,i=t.retry,o=i===void 0?{count:0,lastFocused:e}:i,u=a.weekStartsOn,d=a.fromDate,c=a.toDate,h=a.locale,p={day:cs,week:gT,month:Co,year:mbe,startOfWeek:function(x){return a.ISOWeek?bh(x):dl(x,{locale:h,weekStartsOn:u})},endOfWeek:function(x){return a.ISOWeek?zG(x):W$(x,{locale:h,weekStartsOn:u})}},f=p[r](e,n==="after"?1:-1);n==="before"&&d?f=gbe([d,f]):n==="after"&&c&&(f=xbe([c,f]));var g=!0;if(s){var m=Q$(f,s);g=!m.disabled&&!m.hidden}return g?f:o.count>Bwe?o.lastFocused:ZG(f,{moveBy:r,direction:n,context:a,modifiers:s,retry:Ft(Ft({},o),{count:o.count+1})})}var e8=w.createContext(void 0);function Uwe(e){var t=s0(),r=JG(),n=w.useState(),a=n[0],s=n[1],i=w.useState(),o=i[0],u=i[1],d=zwe(t.displayMonths,r),c=a??(o&&t.isDateDisplayed(o))?o:d,h=function(){u(a),s(void 0)},p=function(x){s(x)},f=nn(),g=function(x,y){if(a){var v=ZG(a,{moveBy:x,direction:y,context:f,modifiers:r});Bs(a,v)||(t.goToDate(v,a),p(v))}},m={focusedDay:a,focusTarget:c,blur:h,focus:p,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return l.jsx(e8.Provider,{value:m,children:e.children})}function X$(){var e=w.useContext(e8);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Wwe(e,t){var r=JG(),n=Q$(e,r,t);return n}var Y$=w.createContext(void 0);function Vwe(e){if(!Z_(e.initialProps)){var t={selected:void 0};return l.jsx(Y$.Provider,{value:t,children:e.children})}return l.jsx(Hwe,{initialProps:e.initialProps,children:e.children})}function Hwe(e){var t=e.initialProps,r=e.children,n=function(s,i,o){var u,d,c;if((u=t.onDayClick)===null||u===void 0||u.call(t,s,i,o),i.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,s,i,o);return}(c=t.onSelect)===null||c===void 0||c.call(t,s,s,i,o)},a={selected:t.selected,onDayClick:n};return l.jsx(Y$.Provider,{value:a,children:r})}function t8(){var e=w.useContext(Y$);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function qwe(e,t){var r=nn(),n=t8(),a=q$(),s=K$(),i=X$(),o=i.focusDayAfter,u=i.focusDayBefore,d=i.focusWeekAfter,c=i.focusWeekBefore,h=i.blur,p=i.focus,f=i.focusMonthBefore,g=i.focusMonthAfter,m=i.focusYearBefore,x=i.focusYearAfter,y=i.focusStartOfWeek,v=i.focusEndOfWeek,b=function(P){var A,L,z,$;Z_(r)?(A=n.onDayClick)===null||A===void 0||A.call(n,e,t,P):n0(r)?(L=a.onDayClick)===null||L===void 0||L.call(a,e,t,P):a0(r)?(z=s.onDayClick)===null||z===void 0||z.call(s,e,t,P):($=r.onDayClick)===null||$===void 0||$.call(r,e,t,P)},N=function(P){var A;p(e),(A=r.onDayFocus)===null||A===void 0||A.call(r,e,t,P)},S=function(P){var A;h(),(A=r.onDayBlur)===null||A===void 0||A.call(r,e,t,P)},_=function(P){var A;(A=r.onDayMouseEnter)===null||A===void 0||A.call(r,e,t,P)},C=function(P){var A;(A=r.onDayMouseLeave)===null||A===void 0||A.call(r,e,t,P)},k=function(P){var A;(A=r.onDayPointerEnter)===null||A===void 0||A.call(r,e,t,P)},I=function(P){var A;(A=r.onDayPointerLeave)===null||A===void 0||A.call(r,e,t,P)},T=function(P){var A;(A=r.onDayTouchCancel)===null||A===void 0||A.call(r,e,t,P)},j=function(P){var A;(A=r.onDayTouchEnd)===null||A===void 0||A.call(r,e,t,P)},E=function(P){var A;(A=r.onDayTouchMove)===null||A===void 0||A.call(r,e,t,P)},O=function(P){var A;(A=r.onDayTouchStart)===null||A===void 0||A.call(r,e,t,P)},M=function(P){var A;(A=r.onDayKeyUp)===null||A===void 0||A.call(r,e,t,P)},W=function(P){var A;switch(P.key){case"ArrowLeft":P.preventDefault(),P.stopPropagation(),r.dir==="rtl"?o():u();break;case"ArrowRight":P.preventDefault(),P.stopPropagation(),r.dir==="rtl"?u():o();break;case"ArrowDown":P.preventDefault(),P.stopPropagation(),d();break;case"ArrowUp":P.preventDefault(),P.stopPropagation(),c();break;case"PageUp":P.preventDefault(),P.stopPropagation(),P.shiftKey?m():f();break;case"PageDown":P.preventDefault(),P.stopPropagation(),P.shiftKey?x():g();break;case"Home":P.preventDefault(),P.stopPropagation(),y();break;case"End":P.preventDefault(),P.stopPropagation(),v();break}(A=r.onDayKeyDown)===null||A===void 0||A.call(r,e,t,P)},q={onClick:b,onFocus:N,onBlur:S,onKeyDown:W,onKeyUp:M,onMouseEnter:_,onMouseLeave:C,onPointerEnter:k,onPointerLeave:I,onTouchCancel:T,onTouchEnd:j,onTouchMove:E,onTouchStart:O};return q}function Gwe(){var e=nn(),t=t8(),r=q$(),n=K$(),a=Z_(e)?t.selected:n0(e)?r.selected:a0(e)?n.selected:void 0;return a}function Kwe(e){return Object.values(Io).includes(e)}function Qwe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(Kwe(n)){var s=e.classNames["day_".concat(n)];s&&r.push(s)}}),r}function Xwe(e,t){var r=Ft({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=Ft(Ft({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function Ywe(e,t,r){var n,a,s,i=nn(),o=X$(),u=Wwe(e,t),d=qwe(e,u),c=Gwe(),h=!!(i.onDayClick||i.mode!=="default");w.useEffect(function(){var _;u.outside||o.focusedDay&&h&&Bs(o.focusedDay,e)&&((_=r.current)===null||_===void 0||_.focus())},[o.focusedDay,e,r,h,u.outside]);var p=Qwe(i,u).join(" "),f=Xwe(i,u),g=!!(u.outside&&!i.showOutsideDays||u.hidden),m=(s=(a=i.components)===null||a===void 0?void 0:a.DayContent)!==null&&s!==void 0?s:ywe,x=l.jsx(m,{date:e,displayMonth:t,activeModifiers:u}),y={style:f,className:p,children:x,role:"gridcell"},v=o.focusTarget&&Bs(o.focusTarget,e)&&!u.outside,b=o.focusedDay&&Bs(o.focusedDay,e),N=Ft(Ft(Ft({},y),(n={disabled:u.disabled,role:"gridcell"},n["aria-selected"]=u.selected,n.tabIndex=b||v?0:-1,n)),d),S={isButton:h,isHidden:g,activeModifiers:u,selectedDays:c,buttonProps:N,divProps:y};return S}function Jwe(e){var t=w.useRef(null),r=Ywe(e.date,e.displayMonth,t);return r.isHidden?l.jsx("div",{role:"gridcell"}):r.isButton?l.jsx(KN,Ft({name:"day",ref:t},r.buttonProps)):l.jsx("div",Ft({},r.divProps))}function Zwe(e){var t=e.number,r=e.dates,n=nn(),a=n.onWeekNumberClick,s=n.styles,i=n.classNames,o=n.locale,u=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,c=d(Number(t),{locale:o});if(!a)return l.jsx("span",{className:i.weeknumber,style:s.weeknumber,children:c});var h=u(Number(t),{locale:o}),p=function(f){a(t,r,f)};return l.jsx(KN,{name:"week-number","aria-label":h,className:i.weeknumber,style:s.weeknumber,onClick:p,children:c})}function e1e(e){var t,r,n=nn(),a=n.styles,s=n.classNames,i=n.showWeekNumber,o=n.components,u=(t=o==null?void 0:o.Day)!==null&&t!==void 0?t:Jwe,d=(r=o==null?void 0:o.WeekNumber)!==null&&r!==void 0?r:Zwe,c;return i&&(c=l.jsx("td",{className:s.cell,style:a.cell,children:l.jsx(d,{number:e.weekNumber,dates:e.dates})})),l.jsxs("tr",{className:s.row,style:a.row,children:[c,e.dates.map(function(h){return l.jsx("td",{className:s.cell,style:a.cell,role:"presentation",children:l.jsx(u,{displayMonth:e.displayMonth,date:h})},C0e(h))})]})}function O3(e,t,r){for(var n=r!=null&&r.ISOWeek?zG(t):W$(t,r),a=r!=null&&r.ISOWeek?bh(e):dl(e,r),s=Vl(n,a),i=[],o=0;o<=s;o++)i.push(cs(a,o));var u=i.reduce(function(d,c){var h=r!=null&&r.ISOWeek?_0e(c):j0e(c,r),p=d.find(function(f){return f.weekNumber===h});return p?(p.dates.push(c),d):(d.push({weekNumber:h,dates:[c]}),d)},[]);return u}function t1e(e,t){var r=O3(Ks(e),U$(e),t);if(t!=null&&t.useFixedWeeks){var n=$0e(e,t);if(n<6){var a=r[r.length-1],s=a.dates[a.dates.length-1],i=gT(s,6-n),o=O3(gT(s,1),i,t);r.push.apply(r,o)}}return r}function r1e(e){var t,r,n,a=nn(),s=a.locale,i=a.classNames,o=a.styles,u=a.hideHead,d=a.fixedWeeks,c=a.components,h=a.weekStartsOn,p=a.firstWeekContainsDate,f=a.ISOWeek,g=t1e(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:f,locale:s,weekStartsOn:h,firstWeekContainsDate:p}),m=(t=c==null?void 0:c.Head)!==null&&t!==void 0?t:xwe,x=(r=c==null?void 0:c.Row)!==null&&r!==void 0?r:e1e,y=(n=c==null?void 0:c.Footer)!==null&&n!==void 0?n:fwe;return l.jsxs("table",{id:e.id,className:i.table,style:o.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!u&&l.jsx(m,{}),l.jsx("tbody",{className:i.tbody,style:o.tbody,children:g.map(function(v){return l.jsx(x,{displayMonth:e.displayMonth,dates:v.dates,weekNumber:v.weekNumber},v.weekNumber)})}),l.jsx(y,{displayMonth:e.displayMonth})]})}function n1e(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var a1e=n1e()?w.useLayoutEffect:w.useEffect,X2=!1,s1e=0;function P3(){return"react-day-picker-".concat(++s1e)}function i1e(e){var t,r=e??(X2?P3():null),n=w.useState(r),a=n[0],s=n[1];return a1e(function(){a===null&&s(P3())},[]),w.useEffect(function(){X2===!1&&(X2=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function o1e(e){var t,r,n=nn(),a=n.dir,s=n.classNames,i=n.styles,o=n.components,u=s0().displayMonths,d=i1e(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),c=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,h=[s.month],p=i.month,f=e.displayIndex===0,g=e.displayIndex===u.length-1,m=!f&&!g;a==="rtl"&&(t=[f,g],g=t[0],f=t[1]),f&&(h.push(s.caption_start),p=Ft(Ft({},p),i.caption_start)),g&&(h.push(s.caption_end),p=Ft(Ft({},p),i.caption_end)),m&&(h.push(s.caption_between),p=Ft(Ft({},p),i.caption_between));var x=(r=o==null?void 0:o.Caption)!==null&&r!==void 0?r:pwe;return l.jsxs("div",{className:h.join(" "),style:p,children:[l.jsx(x,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),l.jsx(r1e,{id:c,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function l1e(e){var t=nn(),r=t.classNames,n=t.styles;return l.jsx("div",{className:r.months,style:n.months,children:e.children})}function u1e(e){var t,r,n=e.initialProps,a=nn(),s=X$(),i=s0(),o=w.useState(!1),u=o[0],d=o[1];w.useEffect(function(){a.initialFocus&&s.focusTarget&&(u||(s.focus(s.focusTarget),d(!0)))},[a.initialFocus,u,s.focus,s.focusTarget,s]);var c=[a.classNames.root,a.className];a.numberOfMonths>1&&c.push(a.classNames.multiple_months),a.showWeekNumber&&c.push(a.classNames.with_weeknumber);var h=Ft(Ft({},a.styles.root),a.style),p=Object.keys(n).filter(function(g){return g.startsWith("data-")}).reduce(function(g,m){var x;return Ft(Ft({},g),(x={},x[m]=n[m],x))},{}),f=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:l1e;return l.jsx("div",Ft({className:c.join(" "),style:h,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},p,{children:l.jsx(f,{children:i.displayMonths.map(function(g,m){return l.jsx(o1e,{displayIndex:m,displayMonth:g},m)})})}))}function c1e(e){var t=e.children,r=D0e(e,["children"]);return l.jsx(Z0e,{initialProps:r,children:l.jsx(uwe,{children:l.jsx(Vwe,{initialProps:r,children:l.jsx(vwe,{initialProps:r,children:l.jsx(Nwe,{initialProps:r,children:l.jsx(jwe,{children:l.jsx(Uwe,{children:t})})})})})})})}function d1e(e){return l.jsx(c1e,Ft({},e,{children:l.jsx(u1e,{initialProps:e})}))}function rb({className:e,classNames:t,showOutsideDays:r=!0,...n}){return l.jsx(d1e,{showOutsideDays:r,className:Ue("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ue(Jv({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ue(Jv({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>l.jsx(cle,{className:"h-4 w-4"}),IconRight:({...a})=>l.jsx(eW,{className:"h-4 w-4"})},...n})}rb.displayName="Calendar";const Ln={states:null,campuses:null,schools:null,religions:null,qualifications:null,statuses:null,districts:new Map},h1e=async()=>{if(Ln.states)return Ln.states;try{const e=await zg();let t=[];Array.isArray(e)?t=e:e.data&&Array.isArray(e.data)?t=e.data:e.states&&Array.isArray(e.states)&&(t=e.states);const r=t.map(n=>({id:n.id||n.state_id||n.code,name:n.name||n.state_name||"Unknown State",state_code:n.state_code||n.code}));return Ln.states=r,r}catch{return[]}},p1e=async e=>{if(Ln.districts.has(e))return Ln.districts.get(e);try{const t=await Hh(e);let r=[];Array.isArray(t)?r=t:t.data&&Array.isArray(t.data)?r=t.data:t.districts&&Array.isArray(t.districts)&&(r=t.districts);const n=r.map(a=>({id:a.id||a.district_id||a.code,name:a.name||a.district_name||"Unknown District",district_code:a.district_code||a.code,state_code:a.state_code||e}));return Ln.districts.set(e,n),n}catch{return[]}},f1e=async()=>{if(Ln.campuses)return Ln.campuses;try{const e=await Gb();return Ln.campuses=e,e}catch{return[]}},m1e=async()=>{if(Ln.schools)return Ln.schools;try{const e=await S_();return Ln.schools=e,e}catch{return[]}},g1e=async()=>{if(Ln.religions)return Ln.religions;try{const e=await Hb();return Ln.religions=e,e}catch{return[]}},x1e=async()=>{if(Ln.qualifications)return Ln.qualifications;try{const e=await qb();return Ln.qualifications=e,e}catch{return[]}},y1e=async()=>{if(Ln.statuses)return Ln.statuses;try{const e=await i$();return Ln.statuses=e,e}catch{return[]}},J$=(e,t,r=[])=>{if(!e||e.length===0)return[];const n=[t,...r],a=new Set;return e.forEach(s=>{if(!(!s||typeof s!="object"))for(const i of n){const o=s[i];if(o&&typeof o=="string"&&o.trim()!==""){a.add(o.trim());break}}}),Array.from(a).sort()},v1e=e=>J$(e,"partner",["partner_name","partnerName","partner_organization"]),b1e=e=>J$(e,"district",["city","district_name","city_name","location"]),w1e=e=>J$(e,"state",["state_name","current_state"]);function r8({isOpen:e,onClose:t,onApplyFilters:r,currentFilters:n,students:a,campusList:s=[],schoolList:i=[],religionList:o=[],qualificationList:u=[],currentstatusList:d=[],stageList:c=[]}){var z,$,V,B,Y,re,ae,K,J,Z,Q;const[h,p]=w.useState(n),[f,g]=w.useState({partners:[],districts:[],schools:[],religions:[],qualifications:[],currentStatuses:[],campuses:[],stages:[]}),[m,x]=w.useState([]),[y,v]=w.useState([]),[b,N]=w.useState([]),[S,_]=w.useState({states:!1,districts:!1,general:!1}),{toast:C}=Wt(),k=w.useRef(!1),I=w.useRef(e);w.useRef({}),w.useEffect(()=>{(async()=>{if(!h.stage_id||h.stage==="all"||h.stage.toLowerCase()==="sourcing"){N([]),p(F=>({...F,stage_status:"all"}));return}try{_(pe=>({...pe,general:!0}));const F=await kV(h.stage_id),te=(F==null?void 0:F.data)||F||[];N(te)}catch(F){console.error("Error fetching stage statuses:",F),N([]),C({title:" Unable to Load Data",description:"Failed to load stage statuses. Please try again.",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{_(F=>({...F,general:!1}))}})()},[h.stage_id,h.stage,C]);const T=w.useCallback(async(U,F=!0)=>{if(F&&p(te=>({...te,state:U==="all"?void 0:U,district:[]})),U==="all"){v([]);return}_(te=>({...te,districts:!0}));try{const te=m.find(fe=>fe.name===U),pe=(te==null?void 0:te.state_code)||(te==null?void 0:te.id);let ve=[];pe&&pe!==U?ve=await p1e(pe):ve=f.districts.map(Me=>({id:Me,name:Me})),v(ve)}catch{v([])}finally{_(te=>({...te,districts:!1}))}},[m,f.districts]);w.useEffect(()=>{(async()=>{if(!e){k.current=!1;return}if(!(I.current===e&&k.current)){I.current=e,_(F=>({...F,general:!0})),p(n);try{const F=[],te=[];F.push(h1e()),te.push("states"),s.length===0&&(F.push(f1e()),te.push("campuses")),i.length===0&&(F.push(m1e()),te.push("schools")),o.length===0&&(F.push(g1e()),te.push("religions")),u.length===0&&(F.push(x1e()),te.push("qualifications")),d.length===0&&(F.push(y1e()),te.push("statuses"));const pe=await Promise.all(F),ve={};te.forEach((Ae,He)=>{ve[Ae]=pe[He]});const fe=s.length>0?s:ve.campuses||[],Me=i.length>0?i:ve.schools||[],je=o.length>0?o:ve.religions||[],Qe=u.length>0?u:ve.qualifications||[],ft=d.length>0?d:ve.statuses||[],Ot=ve.states||[],yt=v1e(a),De=b1e(a),Fe=w1e(a),et=[...Ot];Fe.forEach(Ae=>{const He=/^[A-Z]{2,3}$/.test(Ae),st=et.find(kt=>kt.name===Ae||kt.state_code===Ae||kt.id===Ae);!He&&!st&&et.push({id:Ae,name:Ae})}),g({partners:yt,districts:De,schools:Me,religions:je,qualifications:Qe,currentStatuses:ft,campuses:fe,stages:c.length>0?c:[]}),x(et),n.state&&n.state!=="all"&&await T(n.state,!1),k.current=!0}catch(F){C({title:" Unable to Load Data",description:ut(F),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{_(F=>({...F,general:!1}))}}})()},[e]);const j=()=>{p({stage:"all",stage_id:void 0,stage_status:"all",examMode:"all",interviewMode:"all",partner:[],district:[],school:[],religion:[],qualification:[],currentStatus:[],state:void 0,dateRange:{type:"applicant"}}),v([])},E=()=>{if(h.dateRange.from&&!h.dateRange.to){C({title:" Incomplete Date Range",description:"Please select an end date to complete the date range.",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(h.dateRange.to&&!h.dateRange.from){C({title:" Incomplete Date Range",description:"Please select a start date before selecting an end date.",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(h.dateRange.from&&h.dateRange.to&&h.dateRange.from>h.dateRange.to){C({title:" Invalid Date Range",description:"End date cannot be before start date.",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(h.stage&&h.stage!=="all"&&b.length>0&&!(Array.isArray(h.stage_status)?h.stage_status.length>0:h.stage_status&&h.stage_status!=="all")){C({title:" Stage Status Required",description:`Please select at least one stage status for ${h.stage} stage.`,variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const U={...h};h.stage&&h.stage.toLowerCase()==="sourcing"&&(U.stage_status="all"),delete U.status,r(U),t(),C({title:" Filters Applied",description:"Your filters have been successfully applied.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})},O=(U,F="name",te="Item")=>{if(!U)return`${te}`;if(typeof U=="string")return U;const pe=[F,"name","title","label","school_name","religion_name","current_status_name","qualification_name","campus_name","district_name"];for(const ve of pe)if(U[ve]&&typeof U[ve]=="string")return U[ve];return U.id?`${te} ${U.id}`:`${te}`},M=(U,F="id")=>U?typeof U=="string"?U:U[F]?String(U[F]):U.stage_id?String(U.stage_id):U.id?String(U.id):U.value?String(U.value):String(U):"",W=U=>{p(F=>{const pe=(Array.isArray(F.stage_status)?F.stage_status:F.stage_status&&F.stage_status!=="all"?[F.stage_status]:[]).filter(ve=>ve!==U);return pe.length===0&&b.length>0?{...F,stage:"all",stage_id:void 0,stage_status:"all"}:{...F,stage_status:pe.length>0?pe:"all"}})},q=U=>{p(F=>{switch(U){case"stage":return{...F,stage:"all",stage_id:void 0,stage_status:"all"};case"stage_status":return{...F,stage_status:"all"};case"state":return v([]),{...F,state:void 0,district:[]};case"district":return{...F,district:[]};case"partner":case"campus":return{...F,partner:[]};case"school":return{...F,school:[]};case"religion":return{...F,religion:[]};case"qualification":return{...F,qualification:[]};case"currentStatus":return{...F,currentStatus:[]};case"dateRange":case"daterange":return{...F,dateRange:{type:F.dateRange.type}};default:return F}})},P=[];if(h.stage&&h.stage!=="all"&&P.push({key:"stage",label:`Stage: ${h.stage}`,onRemove:()=>q("stage")}),(Array.isArray(h.stage_status)?h.stage_status:h.stage_status&&h.stage_status!=="all"?[h.stage_status]:[]).forEach(U=>{P.push({key:`stage_status-${U}`,label:`Status: ${U}`,onRemove:()=>W(U)})}),h.state&&P.push({key:"state",label:`State: ${h.state}`}),(z=h.district)!=null&&z.length&&P.push({key:"district",label:`District: ${h.district[0]}`}),($=h.partner)!=null&&$.length){const U=f.campuses.find(te=>String(te.id)===String(h.partner[0])),F=(U==null?void 0:U.campus_name)||(U==null?void 0:U.name)||h.partner[0];P.push({key:"partner",label:`Campus: ${F}`})}if((V=h.school)!=null&&V.length){const U=f.schools.find(te=>String(te.id)===String(h.school[0])),F=(U==null?void 0:U.school_name)||(U==null?void 0:U.name)||h.school[0];P.push({key:"school",label:`School: ${F}`})}if((B=h.qualification)!=null&&B.length){const U=f.qualifications.find(te=>String(te.id)===String(h.qualification[0])),F=(U==null?void 0:U.qualification_name)||(U==null?void 0:U.name)||h.qualification[0];P.push({key:"qualification",label:`Qualification: ${F}`})}if((Y=h.currentStatus)!=null&&Y.length){const U=f.currentStatuses.find(te=>String(te.id)===String(h.currentStatus[0])),F=(U==null?void 0:U.current_status_name)||(U==null?void 0:U.name)||h.currentStatus[0];P.push({key:"currentStatus",label:`Current: ${F}`})}if(h.dateRange.from||h.dateRange.to){const U=h.dateRange.from?Nn(h.dateRange.from,"PP"):"",F=h.dateRange.to?Nn(h.dateRange.to,"PP"):"";P.push({key:"dateRange",label:`${h.dateRange.type}: ${U}${U&&F?" - ":""}${F}`})}return l.jsx(Wr,{open:e,onOpenChange:t,children:l.jsxs(Vr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto mx-4",children:[l.jsx(Hr,{className:"flex-shrink-0 pb-4",children:l.jsxs(qr,{className:"flex items-center gap-2 text-lg",children:[l.jsx(Ob,{className:"w-5 h-5"}),"Advanced Filters",S.general&&l.jsx("span",{className:"text-sm text-muted-foreground",children:"(Loading...)"})]})}),P.length>0&&l.jsx("div",{className:"px-4",children:l.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:P.map(U=>l.jsxs(le,{size:"sm",variant:"ghost",className:"rounded-full py-1.5 px-2 flex items-center gap-2 border h-auto whitespace-nowrap min-w-fit",onClick:()=>{if(U.onRemove)U.onRemove();else{const F=U.key.split("-")[0];q(F)}},children:[l.jsx("span",{className:"text-sm inline-block",children:U.label}),l.jsx(wa,{className:"w-3 h-3 flex-shrink-0"})]},U.key))})}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-muted/30 rounded-lg",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"font-semibold text-sm",children:"Stage"}),l.jsxs(Gr,{value:h.stage_id?String(h.stage_id):"all",onValueChange:U=>{if(U==="all"){p(te=>({...te,stage:"all",stage_id:void 0,stage_status:"all"}));return}const F=f.stages.find(te=>String(te.stage_id)===String(U)||String(te.id)===String(U));if(F){const te=F.stage_name||F.name||String(U),pe=F.stage_id||F.id;p(ve=>({...ve,stage:te,stage_id:Number(pe),stage_status:"all"}))}},children:[l.jsx(Fr,{className:"w-full",children:l.jsx(Kr,{placeholder:"Select stage",className:"truncate"})}),l.jsxs(Or,{className:"z-50",children:[l.jsx(gt,{value:"all",children:"All Stages"}),f.stages.map(U=>{const F=U.stage_id||U.id,te=U.stage_name||U.name||`Stage ${F}`;return l.jsx(gt,{value:String(F),children:te},F)})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("h3",{className:"font-semibold text-sm",children:["Stage Status",h.stage&&h.stage!=="all"&&b.length>0&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsxs(km,{children:[l.jsx(Cm,{asChild:!0,children:l.jsxs(le,{variant:"outline",role:"combobox",disabled:!h.stage||h.stage==="all"||b.length===0||S.general,className:Ue("w-full justify-between h-10",(!h.stage||h.stage==="all")&&"text-muted-foreground",h.stage&&h.stage!=="all"&&b.length>0&&(!h.stage_status||Array.isArray(h.stage_status)&&h.stage_status.length===0||h.stage_status==="all")?"border-red-300":""),children:[l.jsx("span",{className:"truncate",children:!h.stage||h.stage==="all"?"Select stage first":S.general?"Loading statuses...":b.length===0?"No statuses available - Stage can be applied":Array.isArray(h.stage_status)&&h.stage_status.length>0?`${h.stage_status.length} selected`:"Select statuses (required)"}),l.jsx(tW,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Jd,{className:"w-[300px] p-0",align:"start",children:l.jsxs($$,{children:[l.jsx(R$,{placeholder:"Search statuses..."}),l.jsxs(D$,{className:"max-h-[200px]",children:[l.jsx(M$,{children:"No status found."}),l.jsx(F$,{children:b.map(U=>{const F=U.status_name||U.name,te=Array.isArray(h.stage_status)?h.stage_status.includes(F):h.stage_status===F;return l.jsx(O$,{value:F,onSelect:()=>{p(pe=>{const ve=Array.isArray(pe.stage_status)?pe.stage_status:pe.stage_status&&pe.stage_status!=="all"?[pe.stage_status]:[];let fe;return te?fe=ve.filter(Me=>Me!==F):fe=[...ve,F],{...pe,stage_status:fe.length>0?fe:"all"}})},className:"cursor-pointer",children:l.jsxs("div",{className:"flex items-center w-full",children:[l.jsx(Gg,{checked:te,className:"mr-2",onCheckedChange:()=>{}}),l.jsx("span",{className:"flex-1",children:F}),te&&l.jsx(Fb,{className:"ml-auto h-4 w-4"})]})},U.id||F)})})]})]})})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-muted/30 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm mb-2",children:"State"}),l.jsx(sr,{options:[{value:"all",label:"All States"},...m.map(U=>({value:U.name,label:U.name}))],value:h.state||"all",onValueChange:T,placeholder:"Select State",searchPlaceholder:"Search state...",emptyText:"No state found.",disabled:S.general}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:S.general&&" - Loading..."})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm mb-2",children:"District"}),l.jsx(sr,{options:[{value:"all",label:"All Districts"},...y.map(U=>({value:U.name,label:U.name}))],value:((re=h.district)==null?void 0:re[0])||"all",onValueChange:U=>p(F=>({...F,district:U==="all"?[]:[U]})),placeholder:!h.state||h.state==="all"?"Select state first":S.districts?"Loading districts...":"Select district",searchPlaceholder:"Search district...",emptyText:"No district found.",disabled:!h.state||h.state==="all"||S.districts}),l.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Select state first",S.districts&&" - Loading..."]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Campus"}),l.jsx(sr,{options:[{value:"all",label:"All Campuses"},...f.campuses.map(U=>({value:M(U),label:O(U,"campus_name","Campus")}))],value:((ae=h.partner)==null?void 0:ae[0])||"all",onValueChange:U=>{p(U==="all"?F=>({...F,partner:[]}):F=>({...F,partner:[U]}))},placeholder:S.general?"Loading...":"Select campus",searchPlaceholder:"Search campus...",emptyText:"No campus found.",disabled:S.general}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-muted/30 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Qualifying School"}),l.jsx(sr,{options:[{value:"all",label:"All Schools"},...f.schools.map(U=>({value:M(U),label:O(U,"school_name","School")}))],value:((K=h.school)==null?void 0:K[0])||"all",onValueChange:U=>p(F=>({...F,school:U==="all"?[]:[U]})),placeholder:S.general?"Loading...":"Select school",searchPlaceholder:"Search school...",emptyText:"No school found.",disabled:S.general}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1"})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Qualification"}),l.jsx(sr,{options:[{value:"all",label:"All Qualifications"},...f.qualifications.map(U=>({value:M(U),label:O(U,"qualification_name","Qualification")}))],value:((J=h.qualification)==null?void 0:J[0])||"all",onValueChange:U=>p(F=>({...F,qualification:U==="all"?[]:[U]})),placeholder:S.general?"Loading...":"Select qualification",searchPlaceholder:"Search qualification...",emptyText:"No qualification found.",disabled:S.general,className:`${!((Z=h.qualification)!=null&&Z.length)||h.qualification[0]==="all"?"border-red-300":""}`})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Current Status"}),l.jsx(sr,{options:[{value:"all",label:"All Statuses"},...f.currentStatuses.map(U=>({value:M(U),label:O(U,"current_status_name","Status")}))],value:((Q=h.currentStatus)==null?void 0:Q[0])||"all",onValueChange:U=>p(F=>({...F,currentStatus:U==="all"?[]:[U]})),placeholder:S.general?"Loading...":"Select status",searchPlaceholder:"Search status...",emptyText:"No status found.",disabled:S.general}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1"})]})]}),l.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"font-semibold text-sm",children:"Date Range"}),(h.dateRange.from||h.dateRange.to)&&l.jsxs(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>{p(U=>({...U,dateRange:{...U.dateRange,from:void 0,to:void 0}}))},className:"h-7 text-xs",children:[l.jsx(wa,{className:"w-3 h-3 mr-1"}),"Clear Dates"]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{className:"text-sm",children:"Date Type"}),l.jsxs(Gr,{value:h.dateRange.type,onValueChange:U=>p(F=>({...F,dateRange:{...F.dateRange,type:U}})),children:[l.jsx(Fr,{className:"w-full",children:l.jsx(Kr,{})}),l.jsx(Or,{className:"z-50",children:l.jsx(gt,{value:"applicant",children:"Applicant Creation Date"})})]})]}),l.jsxs("div",{children:[l.jsxs(Ee,{className:"text-sm",children:["From",h.dateRange.from&&!h.dateRange.to&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsxs(km,{modal:!0,children:[l.jsx(Cm,{asChild:!0,children:l.jsxs(le,{variant:"outline",className:`w-full justify-start ${h.dateRange.from&&!h.dateRange.to?"border-red-300":""}`,children:[l.jsx($a,{className:"mr-2 h-3 w-3"}),h.dateRange.from?Nn(h.dateRange.from,"PP"):"Pick start date"]})}),l.jsx(Jd,{className:"w-auto p-0 z-[60]",align:"start",children:l.jsx(rb,{mode:"single",selected:h.dateRange.from,onSelect:U=>{p(F=>({...F,dateRange:{...F.dateRange,from:U,to:U}}))},initialFocus:!0})})]}),h.dateRange.from&&!h.dateRange.to&&l.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please select end date"})]}),l.jsxs("div",{children:[l.jsxs(Ee,{className:"text-sm",children:["To",h.dateRange.to&&!h.dateRange.from&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsxs(km,{modal:!0,children:[l.jsx(Cm,{asChild:!0,children:l.jsxs(le,{variant:"outline",className:`w-full justify-start ${h.dateRange.to&&!h.dateRange.from?"border-red-300":""}`,disabled:!h.dateRange.from,children:[l.jsx($a,{className:"mr-2 h-3 w-3"}),h.dateRange.to?Nn(h.dateRange.to,"PP"):h.dateRange.from?"Pick end date":"Select start first"]})}),l.jsx(Jd,{className:"w-auto p-0 z-[60]",align:"start",children:l.jsx(rb,{mode:"single",selected:h.dateRange.to,onSelect:U=>{p(F=>({...F,dateRange:{...F.dateRange,to:U}}))},disabled:U=>h.dateRange.from?U<=h.dateRange.from:!0,initialFocus:!0})})]}),!h.dateRange.from&&l.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select start date first"}),h.dateRange.to&&!h.dateRange.from&&l.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Please select start date"})]})]})]})]}),l.jsxs("div",{className:"flex justify-between pt-4 border-t mt-4",children:[l.jsx(le,{variant:"outline",onClick:j,size:"sm",disabled:S.general,children:"Reset All"}),l.jsxs("div",{className:"space-x-2",children:[l.jsx(le,{variant:"outline",onClick:t,size:"sm",disabled:S.general,children:"Cancel"}),l.jsx(le,{onClick:E,size:"sm",className:"bg-primary text-primary-foreground",disabled:S.general,children:"Apply Filters"})]})]})]})})}function N1e({selectedApplicants:e,isOpen:t,onClose:r,onSuccess:n,campusList:a=[],stateList:s=[],castList:i=[],qualificationList:o=[],currentstatusList:u=[]}){const[d,c]=w.useState({stageId:"no_change",statusId:"no_change",campusId:"no_change",state:"no_change",district:"no_change",block:"no_change",city:"",castId:"no_change",qualificationId:"no_change",currentWorkId:"no_change",offerLetterStatus:"no_change",onboardedStatus:"no_change",joiningDate:"",finalNotes:""}),[h,p]=w.useState([]),[f,g]=w.useState([]),[m,x]=w.useState(!1),{toast:y}=Wt(),[v,b]=w.useState([]),[N,S]=w.useState([]),[_,C]=w.useState([]),[k,I]=w.useState([]),[T,j]=w.useState([]),[E,O]=w.useState([]);w.useEffect(()=>{if(t){if(a.length>0?g(a):M(),s.length>0){const z=s.map($=>({value:$.state_code,label:$.state_name}));b(z)}else W();i.length>0&&I(i.map(z=>({value:String(z.id),label:z.cast_name||z.name||`#${z.id}`}))),o.length>0&&j(o.map(z=>({value:String(z.id),label:z.qualification_name||z.name||`#${z.id}`}))),u.length>0&&O(u.map(z=>({value:String(z.id),label:z.current_status_name||z.name||`#${z.id}`}))),(i.length===0||o.length===0||u.length===0)&&q()}},[t,a,s,i,o,u]);const M=async()=>{try{const z=await Gb();g(z)}catch(z){console.error("Error fetching campuses:",z)}},W=async()=>{try{const z=await zg(),$=((z==null?void 0:z.data)||z||[]).map(V=>({value:V.state_code,label:V.state_name}));b($)}catch(z){console.error("Error fetching states:",z),b([])}},q=async()=>{try{const[z,$,V]=await Promise.all([Vb().catch(()=>[]),qb().catch(()=>[]),n$().catch(()=>[])]);I((z||[]).map(B=>({value:String(B.id),label:B.cast_name||B.name||`#${B.id}`}))),j(($||[]).map(B=>({value:String(B.id),label:B.qualification_name||B.name||`#${B.id}`}))),O((V||[]).map(B=>({value:String(B.id),label:B.current_status_name||B.name||`#${B.id}`})))}catch(z){console.error("Error fetching dropdowns:",z)}},P=async z=>{if(c($=>({...$,state:z,district:"no_change",block:"no_change"})),S([]),C([]),z!=="no_change")try{const $=await Hh(z),V=(($==null?void 0:$.data)||$||[]).map(B=>({value:B.district_code,label:B.district_name}));S(V)}catch($){console.error("Error fetching districts:",$),S([])}},A=async z=>{if(c($=>({...$,district:z,block:"no_change"})),C([]),z!=="no_change")try{const $=await Kb(z),V=(($==null?void 0:$.data)||$||[]).map(B=>({value:String(B.id),label:B.block_name}));C(V)}catch($){console.error("Error fetching blocks:",$),C([])}},L=async()=>{var V,B,Y;if(d.stageId==="no_change"&&d.campusId==="no_change"&&d.state==="no_change"&&d.district==="no_change"&&d.block==="no_change"&&d.castId==="no_change"&&d.qualificationId==="no_change"&&d.currentWorkId==="no_change"&&d.offerLetterStatus==="no_change"&&d.onboardedStatus==="no_change"&&!d.joiningDate&&!d.finalNotes){y({title:" No Fields Selected",description:"Please select at least one field to update.",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const $={student_ids:e.map(re=>Number(re))};if(d.campusId!=="no_change"&&($.campus_id=d.campusId==="unassigned"?null:Number(d.campusId)),d.state!=="no_change"){const re=((V=v.find(ae=>ae.value===d.state))==null?void 0:V.label)||d.state;$.state=re}if(d.district!=="no_change"){const re=((B=N.find(ae=>ae.value===d.district))==null?void 0:B.label)||d.district;$.district=re}if(d.block!=="no_change"){const re=((Y=_.find(ae=>ae.value===d.block))==null?void 0:Y.label)||d.block;$.block=re}d.castId!=="no_change"&&($.cast_id=Number(d.castId)),d.qualificationId!=="no_change"&&($.qualification_id=Number(d.qualificationId)),d.currentWorkId!=="no_change"&&($.current_status_id=Number(d.currentWorkId)),x(!0);try{if(await aV($),d.finalNotes||d.offerLetterStatus!=="no_change"||d.onboardedStatus!=="no_change"||d.joiningDate){const re=e.map(ae=>{const K={student_id:Number(ae)};return d.finalNotes&&(K.final_notes=d.finalNotes),d.offerLetterStatus!=="no_change"&&(K.offer_letter_status=d.offerLetterStatus),d.onboardedStatus!=="no_change"&&(K.onboarded_status=d.onboardedStatus),d.joiningDate&&(K.joining_date=d.joiningDate),e$(K)});await Promise.all(re)}y({title:" Bulk Update Successful",description:`Successfully updated ${e.length} applicant${e.length>1?"s":""}.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),n(),r(),c({stageId:"no_change",statusId:"no_change",campusId:"no_change",state:"no_change",district:"no_change",block:"no_change",city:"",castId:"no_change",qualificationId:"no_change",currentWorkId:"no_change",offerLetterStatus:"no_change",onboardedStatus:"no_change",joiningDate:"",finalNotes:""})}catch(re){console.error("Bulk update failure:",re),y({title:" Unable to Update",description:ut(re),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{x(!1)}};return l.jsx(Wr,{open:t,onOpenChange:r,children:l.jsxs(Vr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx(Hr,{children:l.jsxs(qr,{className:"flex items-center gap-2",children:[l.jsx(ch,{className:"w-5 h-5"}),"Bulk Update - ",e.length," Applicant(s)"]})}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-800",children:["Update selected fields for ",e.length," ",'applicant(s). Fields set to "No change" will remain unchanged.']})}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-700 border-b pb-2",children:"Campus Assignment"}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Campus"}),l.jsx(sr,{options:[{value:"no_change",label:"No change"},{value:"unassigned",label:"Not assigned"},...f.map(z=>({value:String(z.id),label:z.campus_name}))],value:d.campusId,onValueChange:z=>c($=>({...$,campusId:z})),placeholder:"Select campus",searchPlaceholder:"Search campus...",emptyText:"No campus found."})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-700 border-b pb-2",children:"Location Details"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{children:"State"}),l.jsx(sr,{options:[{value:"no_change",label:"No change"},...v.map(z=>({value:z.value,label:z.label}))],value:d.state,onValueChange:z=>P(z),placeholder:"Select state",searchPlaceholder:"Search state...",emptyText:"No state found."})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"District"}),l.jsx(sr,{options:[{value:"no_change",label:"No change"},...N.map(z=>({value:z.value,label:z.label}))],value:d.district,onValueChange:z=>A(z),placeholder:d.state==="no_change"||!d.state?"Select state first":N.length===0?"No districts available":"Select district",searchPlaceholder:"Search district...",emptyText:"No district found.",disabled:!d.state||d.state==="no_change"})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Block"}),l.jsx(sr,{options:[{value:"no_change",label:"No change"},..._.map(z=>({value:z.value,label:z.label}))],value:d.block,onValueChange:z=>{c($=>({...$,block:z}))},placeholder:d.district==="no_change"||!d.district?"Select district first":_.length===0?"No blocks available":"Select block",searchPlaceholder:"Search block...",emptyText:"No block found.",disabled:!d.district||d.district==="no_change"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-700 border-b pb-2",children:"Personal Information"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{children:"Caste"}),l.jsx(sr,{options:[{value:"no_change",label:"No change"},...k.map(z=>({value:z.value,label:z.label}))],value:d.castId,onValueChange:z=>c($=>({...$,castId:z})),placeholder:"Select caste",searchPlaceholder:"Search caste...",emptyText:"No caste found."})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Qualification"}),l.jsx(sr,{options:[{value:"no_change",label:"No change"},...T.map(z=>({value:z.value,label:z.label}))],value:d.qualificationId,onValueChange:z=>c($=>({...$,qualificationId:z})),placeholder:"Select qualification",searchPlaceholder:"Search qualification...",emptyText:"No qualification found."})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Current Work"}),l.jsx(sr,{options:[{value:"no_change",label:"No change"},...E.map(z=>({value:z.value,label:z.label}))],value:d.currentWorkId,onValueChange:z=>c($=>({...$,currentWorkId:z})),placeholder:"Select current work",searchPlaceholder:"Search current work...",emptyText:"No current work found."})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-700 border-b pb-2",children:"Onboarding Status"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{children:"Offer Letter Status"}),l.jsxs(Gr,{value:d.offerLetterStatus,onValueChange:z=>c($=>({...$,offerLetterStatus:z})),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select offer status"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"no_change",children:"No change"}),l.jsx(gt,{value:"Offer Pending",children:"Offer Pending"}),l.jsx(gt,{value:"Offer Accepted",children:"Offer Accepted"}),l.jsx(gt,{value:"Offer Declined",children:"Offer Declined"}),l.jsx(gt,{value:"Waitlisted",children:"Waitlisted"})]})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Onboarded Status"}),l.jsxs(Gr,{value:d.onboardedStatus,onValueChange:z=>c($=>({...$,onboardedStatus:z})),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select onboarded status"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"no_change",children:"No change"}),l.jsx(gt,{value:"Onboarded",children:"Onboarded"})]})]})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Joining Date"}),l.jsx(Ve,{type:"date",value:d.joiningDate,onChange:z=>c($=>({...$,joiningDate:z.target.value}))})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Final Notes"}),l.jsx(ps,{value:d.finalNotes,onChange:z=>c($=>({...$,finalNotes:z.target.value})),rows:3,placeholder:"Add any additional notes (optional)"})]})]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[l.jsx(le,{variant:"outline",onClick:r,disabled:m,children:"Cancel"}),l.jsx(le,{onClick:L,disabled:m,children:m?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating..."]}):`Update ${e.length} Applicant(s)`})]})]})]})})}var n8={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(mi,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,s=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,o={},u=0,d={};function c(k){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(I){var T=S(I);T.chunkSize=parseInt(T.chunkSize),I.step||I.chunk||(T.chunkSize=null),this._handle=new m(T),(this._handle.streamer=this)._config=T}).call(this,k),this.parseChunk=function(I,T){var j=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<j){let O=this._config.newline;O||(E=this._config.quoteChar||'"',O=this._handle.guessLineEndings(I,E)),I=[...I.split(O).slice(j)].join(O)}this.isFirstChunk&&C(this._config.beforeFirstChunk)&&(E=this._config.beforeFirstChunk(I))!==void 0&&(I=E),this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+I,E=(this._partialLine="",this._handle.parse(j,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(I=E.meta.cursor,j=(this._finished||(this._partialLine=j.substring(I-this._baseIndex),this._baseIndex=I),E&&E.data&&(this._rowCount+=E.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)n.postMessage({results:E,workerId:d.WORKER_ID,finished:j});else if(C(this._config.chunk)&&!T){if(this._config.chunk(E,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=E=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(E.data),this._completeResults.errors=this._completeResults.errors.concat(E.errors),this._completeResults.meta=E.meta),this._completed||!j||!C(this._config.complete)||E&&E.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),j||E&&E.meta.paused||this._nextChunk(),E}this._halted=!0},this._sendError=function(I){C(this._config.error)?this._config.error(I):i&&this._config.error&&n.postMessage({workerId:d.WORKER_ID,error:I,finished:!1})}}function h(k){var I;(k=k||{}).chunkSize||(k.chunkSize=d.RemoteChunkSize),c.call(this,k),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(T){this._input=T,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(I=new XMLHttpRequest,this._config.withCredentials&&(I.withCredentials=this._config.withCredentials),s||(I.onload=_(this._chunkLoaded,this),I.onerror=_(this._chunkError,this)),I.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var T,j=this._config.downloadRequestHeaders;for(T in j)I.setRequestHeader(T,j[T])}var E;this._config.chunkSize&&(E=this._start+this._config.chunkSize-1,I.setRequestHeader("Range","bytes="+this._start+"-"+E));try{I.send(this._config.downloadRequestBody)}catch(O){this._chunkError(O.message)}s&&I.status===0&&this._chunkError()}},this._chunkLoaded=function(){I.readyState===4&&(I.status<200||400<=I.status?this._chunkError():(this._start+=this._config.chunkSize||I.responseText.length,this._finished=!this._config.chunkSize||this._start>=(T=>(T=T.getResponseHeader("Content-Range"))!==null?parseInt(T.substring(T.lastIndexOf("/")+1)):-1)(I),this.parseChunk(I.responseText)))},this._chunkError=function(T){T=I.statusText||T,this._sendError(new Error(T))}}function p(k){(k=k||{}).chunkSize||(k.chunkSize=d.LocalChunkSize),c.call(this,k);var I,T,j=typeof FileReader<"u";this.stream=function(E){this._input=E,T=E.slice||E.webkitSlice||E.mozSlice,j?((I=new FileReader).onload=_(this._chunkLoaded,this),I.onerror=_(this._chunkError,this)):I=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var E=this._input,O=(this._config.chunkSize&&(O=Math.min(this._start+this._config.chunkSize,this._input.size),E=T.call(E,this._start,O)),I.readAsText(E,this._config.encoding));j||this._chunkLoaded({target:{result:O}})},this._chunkLoaded=function(E){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(E.target.result)},this._chunkError=function(){this._sendError(I.error)}}function f(k){var I;c.call(this,k=k||{}),this.stream=function(T){return I=T,this._nextChunk()},this._nextChunk=function(){var T,j;if(!this._finished)return T=this._config.chunkSize,I=T?(j=I.substring(0,T),I.substring(T)):(j=I,""),this._finished=!I,this.parseChunk(j)}}function g(k){c.call(this,k=k||{});var I=[],T=!0,j=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(E){this._input=E,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){j&&I.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),I.length?this.parseChunk(I.shift()):T=!0},this._streamData=_(function(E){try{I.push(typeof E=="string"?E:E.toString(this._config.encoding)),T&&(T=!1,this._checkIsFinished(),this.parseChunk(I.shift()))}catch(O){this._streamError(O)}},this),this._streamError=_(function(E){this._streamCleanUp(),this._sendError(E)},this),this._streamEnd=_(function(){this._streamCleanUp(),j=!0,this._streamData("")},this),this._streamCleanUp=_(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(k){var I,T,j,E,O=Math.pow(2,53),M=-O,W=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,q=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,P=this,A=0,L=0,z=!1,$=!1,V=[],B={data:[],errors:[],meta:{}};function Y(J){return k.skipEmptyLines==="greedy"?J.join("").trim()==="":J.length===1&&J[0].length===0}function re(){if(B&&j&&(K("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),j=!1),k.skipEmptyLines&&(B.data=B.data.filter(function(F){return!Y(F)})),ae()){let F=function(te,pe){C(k.transformHeader)&&(te=k.transformHeader(te,pe)),V.push(te)};var U=F;if(B)if(Array.isArray(B.data[0])){for(var J=0;ae()&&J<B.data.length;J++)B.data[J].forEach(F);B.data.splice(0,1)}else B.data.forEach(F)}function Z(F,te){for(var pe=k.header?{}:[],ve=0;ve<F.length;ve++){var fe=ve,Me=F[ve],Me=((je,Qe)=>(ft=>(k.dynamicTypingFunction&&k.dynamicTyping[ft]===void 0&&(k.dynamicTyping[ft]=k.dynamicTypingFunction(ft)),(k.dynamicTyping[ft]||k.dynamicTyping)===!0))(je)?Qe==="true"||Qe==="TRUE"||Qe!=="false"&&Qe!=="FALSE"&&((ft=>{if(W.test(ft)&&(ft=parseFloat(ft),M<ft&&ft<O))return 1})(Qe)?parseFloat(Qe):q.test(Qe)?new Date(Qe):Qe===""?null:Qe):Qe)(fe=k.header?ve>=V.length?"__parsed_extra":V[ve]:fe,Me=k.transform?k.transform(Me,fe):Me);fe==="__parsed_extra"?(pe[fe]=pe[fe]||[],pe[fe].push(Me)):pe[fe]=Me}return k.header&&(ve>V.length?K("FieldMismatch","TooManyFields","Too many fields: expected "+V.length+" fields but parsed "+ve,L+te):ve<V.length&&K("FieldMismatch","TooFewFields","Too few fields: expected "+V.length+" fields but parsed "+ve,L+te)),pe}var Q;B&&(k.header||k.dynamicTyping||k.transform)&&(Q=1,!B.data.length||Array.isArray(B.data[0])?(B.data=B.data.map(Z),Q=B.data.length):B.data=Z(B.data,0),k.header&&B.meta&&(B.meta.fields=V),L+=Q)}function ae(){return k.header&&V.length===0}function K(J,Z,Q,U){J={type:J,code:Z,message:Q},U!==void 0&&(J.row=U),B.errors.push(J)}C(k.step)&&(E=k.step,k.step=function(J){B=J,ae()?re():(re(),B.data.length!==0&&(A+=J.data.length,k.preview&&A>k.preview?T.abort():(B.data=B.data[0],E(B,P))))}),this.parse=function(J,Z,Q){var U=k.quoteChar||'"',U=(k.newline||(k.newline=this.guessLineEndings(J,U)),j=!1,k.delimiter?C(k.delimiter)&&(k.delimiter=k.delimiter(J),B.meta.delimiter=k.delimiter):((U=((F,te,pe,ve,fe)=>{var Me,je,Qe,ft;fe=fe||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Ot=0;Ot<fe.length;Ot++){for(var yt,De=fe[Ot],Fe=0,et=0,Ae=0,He=(Qe=void 0,new y({comments:ve,delimiter:De,newline:te,preview:10}).parse(F)),st=0;st<He.data.length;st++)pe&&Y(He.data[st])?Ae++:(yt=He.data[st].length,et+=yt,Qe===void 0?Qe=yt:0<yt&&(Fe+=Math.abs(yt-Qe),Qe=yt));0<He.data.length&&(et/=He.data.length-Ae),(je===void 0||Fe<=je)&&(ft===void 0||ft<et)&&1.99<et&&(je=Fe,Me=De,ft=et)}return{successful:!!(k.delimiter=Me),bestDelimiter:Me}})(J,k.newline,k.skipEmptyLines,k.comments,k.delimitersToGuess)).successful?k.delimiter=U.bestDelimiter:(j=!0,k.delimiter=d.DefaultDelimiter),B.meta.delimiter=k.delimiter),S(k));return k.preview&&k.header&&U.preview++,I=J,T=new y(U),B=T.parse(I,Z,Q),re(),z?{meta:{paused:!0}}:B||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,T.abort(),I=C(k.chunk)?"":I.substring(T.getCharIndex())},this.resume=function(){P.streamer._halted?(z=!1,P.streamer.parseChunk(I,!0)):setTimeout(P.resume,3)},this.aborted=function(){return $},this.abort=function(){$=!0,T.abort(),B.meta.aborted=!0,C(k.complete)&&k.complete(B),I=""},this.guessLineEndings=function(F,U){F=F.substring(0,1048576);var U=new RegExp(x(U)+"([^]*?)"+x(U),"gm"),Q=(F=F.replace(U,"")).split("\r"),U=F.split(`
`),F=1<U.length&&U[0].length<Q[0].length;if(Q.length===1||F)return`
`;for(var te=0,pe=0;pe<Q.length;pe++)Q[pe][0]===`
`&&te++;return te>=Q.length/2?`\r
`:"\r"}}function x(k){return k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(k){var I=(k=k||{}).delimiter,T=k.newline,j=k.comments,E=k.step,O=k.preview,M=k.fastMode,W=null,q=!1,P=k.quoteChar==null?'"':k.quoteChar,A=P;if(k.escapeChar!==void 0&&(A=k.escapeChar),(typeof I!="string"||-1<d.BAD_DELIMITERS.indexOf(I))&&(I=","),j===I)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<d.BAD_DELIMITERS.indexOf(j))&&(j=!1),T!==`
`&&T!=="\r"&&T!==`\r
`&&(T=`
`);var L=0,z=!1;this.parse=function($,V,B){if(typeof $!="string")throw new Error("Input must be a string");var Y=$.length,re=I.length,ae=T.length,K=j.length,J=C(E),Z=[],Q=[],U=[],F=L=0;if(!$)return Fe();if(M||M!==!1&&$.indexOf(P)===-1){for(var te=$.split(T),pe=0;pe<te.length;pe++){if(U=te[pe],L+=U.length,pe!==te.length-1)L+=T.length;else if(B)return Fe();if(!j||U.substring(0,K)!==j){if(J){if(Z=[],ft(U.split(I)),et(),z)return Fe()}else ft(U.split(I));if(O&&O<=pe)return Z=Z.slice(0,O),Fe(!0)}}return Fe()}for(var ve=$.indexOf(I,L),fe=$.indexOf(T,L),Me=new RegExp(x(A)+x(P),"g"),je=$.indexOf(P,L);;)if($[L]===P)for(je=L,L++;;){if((je=$.indexOf(P,je+1))===-1)return B||Q.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Z.length,index:L}),yt();if(je===Y-1)return yt($.substring(L,je).replace(Me,P));if(P===A&&$[je+1]===A)je++;else if(P===A||je===0||$[je-1]!==A){ve!==-1&&ve<je+1&&(ve=$.indexOf(I,je+1));var Qe=Ot((fe=fe!==-1&&fe<je+1?$.indexOf(T,je+1):fe)===-1?ve:Math.min(ve,fe));if($.substr(je+1+Qe,re)===I){U.push($.substring(L,je).replace(Me,P)),$[L=je+1+Qe+re]!==P&&(je=$.indexOf(P,L)),ve=$.indexOf(I,L),fe=$.indexOf(T,L);break}if(Qe=Ot(fe),$.substring(je+1+Qe,je+1+Qe+ae)===T){if(U.push($.substring(L,je).replace(Me,P)),De(je+1+Qe+ae),ve=$.indexOf(I,L),je=$.indexOf(P,L),J&&(et(),z))return Fe();if(O&&Z.length>=O)return Fe(!0);break}Q.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Z.length,index:L}),je++}}else if(j&&U.length===0&&$.substring(L,L+K)===j){if(fe===-1)return Fe();L=fe+ae,fe=$.indexOf(T,L),ve=$.indexOf(I,L)}else if(ve!==-1&&(ve<fe||fe===-1))U.push($.substring(L,ve)),L=ve+re,ve=$.indexOf(I,L);else{if(fe===-1)break;if(U.push($.substring(L,fe)),De(fe+ae),J&&(et(),z))return Fe();if(O&&Z.length>=O)return Fe(!0)}return yt();function ft(Ae){Z.push(Ae),F=L}function Ot(Ae){var He=0;return He=Ae!==-1&&(Ae=$.substring(je+1,Ae))&&Ae.trim()===""?Ae.length:He}function yt(Ae){return B||(Ae===void 0&&(Ae=$.substring(L)),U.push(Ae),L=Y,ft(U),J&&et()),Fe()}function De(Ae){L=Ae,ft(U),U=[],fe=$.indexOf(T,L)}function Fe(Ae){if(k.header&&!V&&Z.length&&!q){var He=Z[0],st=Object.create(null),kt=new Set(He);let Vt=!1;for(let ur=0;ur<He.length;ur++){let we=He[ur];if(st[we=C(k.transformHeader)?k.transformHeader(we,ur):we]){let wr,nr=st[we];for(;wr=we+"_"+nr,nr++,kt.has(wr););kt.add(wr),He[ur]=wr,st[we]++,Vt=!0,(W=W===null?{}:W)[wr]=we}else st[we]=1,He[ur]=we;kt.add(we)}Vt&&console.warn("Duplicate headers found and renamed."),q=!0}return{data:Z,errors:Q,meta:{delimiter:I,linebreak:T,aborted:z,truncated:!!Ae,cursor:F+(V||0),renamedHeaders:W}}}function et(){E(Fe()),Z=[],Q=[]}},this.abort=function(){z=!0},this.getCharIndex=function(){return L}}function v(k){var I=k.data,T=o[I.workerId],j=!1;if(I.error)T.userError(I.error,I.file);else if(I.results&&I.results.data){var E={abort:function(){j=!0,b(I.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:N,resume:N};if(C(T.userStep)){for(var O=0;O<I.results.data.length&&(T.userStep({data:I.results.data[O],errors:I.results.errors,meta:I.results.meta},E),!j);O++);delete I.results}else C(T.userChunk)&&(T.userChunk(I.results,E,I.file),delete I.results)}I.finished&&!j&&b(I.workerId,I.results)}function b(k,I){var T=o[k];C(T.userComplete)&&T.userComplete(I),T.terminate(),delete o[k]}function N(){throw new Error("Not implemented.")}function S(k){if(typeof k!="object"||k===null)return k;var I,T=Array.isArray(k)?[]:{};for(I in k)T[I]=S(k[I]);return T}function _(k,I){return function(){k.apply(I,arguments)}}function C(k){return typeof k=="function"}return d.parse=function(k,I){var T=(I=I||{}).dynamicTyping||!1;if(C(T)&&(I.dynamicTypingFunction=T,T={}),I.dynamicTyping=T,I.transform=!!C(I.transform)&&I.transform,!I.worker||!d.WORKERS_SUPPORTED)return T=null,d.NODE_STREAM_INPUT,typeof k=="string"?(k=(j=>j.charCodeAt(0)!==65279?j:j.slice(1))(k),T=new(I.download?h:f)(I)):k.readable===!0&&C(k.read)&&C(k.on)?T=new g(I):(n.File&&k instanceof File||k instanceof Object)&&(T=new p(I)),T.stream(k);(T=(()=>{var j;return!!d.WORKERS_SUPPORTED&&(j=(()=>{var E=n.URL||n.webkitURL||null,O=r.toString();return d.BLOB_URL||(d.BLOB_URL=E.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",O,")();"],{type:"text/javascript"})))})(),(j=new n.Worker(j)).onmessage=v,j.id=u++,o[j.id]=j)})()).userStep=I.step,T.userChunk=I.chunk,T.userComplete=I.complete,T.userError=I.error,I.step=C(I.step),I.chunk=C(I.chunk),I.complete=C(I.complete),I.error=C(I.error),delete I.worker,T.postMessage({input:k,config:I,workerId:T.id})},d.unparse=function(k,I){var T=!1,j=!0,E=",",O=`\r
`,M='"',W=M+M,q=!1,P=null,A=!1,L=((()=>{if(typeof I=="object"){if(typeof I.delimiter!="string"||d.BAD_DELIMITERS.filter(function(V){return I.delimiter.indexOf(V)!==-1}).length||(E=I.delimiter),typeof I.quotes!="boolean"&&typeof I.quotes!="function"&&!Array.isArray(I.quotes)||(T=I.quotes),typeof I.skipEmptyLines!="boolean"&&typeof I.skipEmptyLines!="string"||(q=I.skipEmptyLines),typeof I.newline=="string"&&(O=I.newline),typeof I.quoteChar=="string"&&(M=I.quoteChar),typeof I.header=="boolean"&&(j=I.header),Array.isArray(I.columns)){if(I.columns.length===0)throw new Error("Option columns is empty");P=I.columns}I.escapeChar!==void 0&&(W=I.escapeChar+M),I.escapeFormulae instanceof RegExp?A=I.escapeFormulae:typeof I.escapeFormulae=="boolean"&&I.escapeFormulae&&(A=/^[=+\-@\t\r].*$/)}})(),new RegExp(x(M),"g"));if(typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(k)){if(!k.length||Array.isArray(k[0]))return z(null,k,q);if(typeof k[0]=="object")return z(P||Object.keys(k[0]),k,q)}else if(typeof k=="object")return typeof k.data=="string"&&(k.data=JSON.parse(k.data)),Array.isArray(k.data)&&(k.fields||(k.fields=k.meta&&k.meta.fields||P),k.fields||(k.fields=Array.isArray(k.data[0])?k.fields:typeof k.data[0]=="object"?Object.keys(k.data[0]):[]),Array.isArray(k.data[0])||typeof k.data[0]=="object"||(k.data=[k.data])),z(k.fields||[],k.data||[],q);throw new Error("Unable to serialize unrecognized input");function z(V,B,Y){var re="",ae=(typeof V=="string"&&(V=JSON.parse(V)),typeof B=="string"&&(B=JSON.parse(B)),Array.isArray(V)&&0<V.length),K=!Array.isArray(B[0]);if(ae&&j){for(var J=0;J<V.length;J++)0<J&&(re+=E),re+=$(V[J],J);0<B.length&&(re+=O)}for(var Z=0;Z<B.length;Z++){var Q=(ae?V:B[Z]).length,U=!1,F=ae?Object.keys(B[Z]).length===0:B[Z].length===0;if(Y&&!ae&&(U=Y==="greedy"?B[Z].join("").trim()==="":B[Z].length===1&&B[Z][0].length===0),Y==="greedy"&&ae){for(var te=[],pe=0;pe<Q;pe++){var ve=K?V[pe]:pe;te.push(B[Z][ve])}U=te.join("").trim()===""}if(!U){for(var fe=0;fe<Q;fe++){0<fe&&!F&&(re+=E);var Me=ae&&K?V[fe]:fe;re+=$(B[Z][Me],fe)}Z<B.length-1&&(!Y||0<Q&&!F)&&(re+=O)}}return re}function $(V,B){var Y,re;return V==null?"":V.constructor===Date?JSON.stringify(V).slice(1,25):(re=!1,A&&typeof V=="string"&&A.test(V)&&(V="'"+V,re=!0),Y=V.toString().replace(L,W),(re=re||T===!0||typeof T=="function"&&T(V,B)||Array.isArray(T)&&T[B]||((ae,K)=>{for(var J=0;J<K.length;J++)if(-1<ae.indexOf(K[J]))return!0;return!1})(Y,d.BAD_DELIMITERS)||-1<Y.indexOf(E)||Y.charAt(0)===" "||Y.charAt(Y.length-1)===" ")?M+Y+M:Y)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!s&&!!n.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=y,d.ParserHandle=m,d.NetworkStreamer=h,d.FileStreamer=p,d.StringStreamer=f,d.ReadableStreamStreamer=g,n.jQuery&&((a=n.jQuery).fn.parse=function(k){var I=k.config||{},T=[];return this.each(function(O){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var M=0;M<this.files.length;M++)T.push({file:this.files[M],inputElem:this,instanceConfig:a.extend({},I)})}),j(),this;function j(){if(T.length===0)C(k.complete)&&k.complete();else{var O,M,W,q,P=T[0];if(C(k.before)){var A=k.before(P.file,P.inputElem);if(typeof A=="object"){if(A.action==="abort")return O="AbortError",M=P.file,W=P.inputElem,q=A.reason,void(C(k.error)&&k.error({name:O},M,W,q));if(A.action==="skip")return void E();typeof A.config=="object"&&(P.instanceConfig=a.extend(P.instanceConfig,A.config))}else if(A==="skip")return void E()}var L=P.instanceConfig.complete;P.instanceConfig.complete=function(z){C(L)&&L(z,P.file,P.inputElem),E()},d.parse(P.file,P.instanceConfig)}}function E(){T.splice(0,1),j()}}),i&&(n.onmessage=function(k){k=k.data,d.WORKER_ID===void 0&&k&&(d.WORKER_ID=k.workerId),typeof k.input=="string"?n.postMessage({workerId:d.WORKER_ID,results:d.parse(k.input,k.config),finished:!0}):(n.File&&k.input instanceof File||k.input instanceof Object)&&(k=d.parse(k.input,k.config))&&n.postMessage({workerId:d.WORKER_ID,results:k,finished:!0})}),(h.prototype=Object.create(c.prototype)).constructor=h,(p.prototype=Object.create(c.prototype)).constructor=p,(f.prototype=Object.create(f.prototype)).constructor=f,(g.prototype=Object.create(c.prototype)).constructor=g,d})})(n8);var S1e=n8.exports;const a8=Cj(S1e);var Z$="Progress",eR=100,[_1e,Hot]=Ia(Z$),[k1e,C1e]=_1e(Z$),s8=w.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:s=I1e,...i}=e;(a||a===0)&&!L3(a)&&console.error(E1e(`${a}`,"Progress"));const o=L3(a)?a:eR;n!==null&&!z3(n,o)&&console.error(T1e(`${n}`,"Progress"));const u=z3(n,o)?n:null,d=QN(u)?s(u,o):void 0;return l.jsx(k1e,{scope:r,value:u,max:o,children:l.jsx(at.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":QN(u)?u:void 0,"aria-valuetext":d,role:"progressbar","data-state":l8(u,o),"data-value":u??void 0,"data-max":o,...i,ref:t})})});s8.displayName=Z$;var i8="ProgressIndicator",o8=w.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,a=C1e(i8,r);return l.jsx(at.div,{"data-state":l8(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});o8.displayName=i8;function I1e(e,t){return`${Math.round(e/t*100)}%`}function l8(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function QN(e){return typeof e=="number"}function L3(e){return QN(e)&&!isNaN(e)&&e>0}function z3(e,t){return QN(e)&&!isNaN(e)&&e<=t&&e>=0}function E1e(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${eR}\`.`}function T1e(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${eR} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var u8=s8,j1e=o8;const tR=w.forwardRef(({className:e,value:t,...r},n)=>l.jsx(u8,{ref:n,className:Ue("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:l.jsx(j1e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));tR.displayName=u8.displayName;const A1e=({isOpen:e,onClose:t,onSuccess:r})=>{const[n,a]=w.useState(null),[s,i]=w.useState([]),[o,u]=w.useState(null),[d,c]=w.useState(!1),[h,p]=w.useState(0),[f,g]=w.useState(!1),[m,x]=w.useState(0),{toast:y}=Wt();w.useEffect(()=>{e&&(a(null),i([]),u(null),g(!1),p(0),x(0),c(!1))},[e]);const v=C=>{u(null),g(!1),p(0),x(0);const k=C.target.files&&C.target.files[0];k&&k.type==="text/csv"?a(k):(a(null),u("Please select a valid CSV file."))},b=async()=>{if(!n){u("Please select a CSV file.");return}u(null),g(!1),p(0),c(!0);try{await L6(n),a8.parse(n,{header:!0,skipEmptyLines:!0,dynamicTyping:!1,complete:C=>{i(C.data),S(C.data)},error:C=>{u("Something went wrong while uploading your CSV file. Please check it and try again."),c(!1)}})}catch(C){console.error("Upload failed:",C),u(C&&"Something went wrong while uploading your CSV file. Please check it and try again."),c(!1)}},N=C=>{if(!C||C.trim()==="")return null;const k=C.trim();if(k.includes("/")){const T=k.split("/");if(T.length===2){const j=parseFloat(T[0]),E=parseFloat(T[1]);if(!isNaN(j)&&!isNaN(E)&&E!==0)return j/E}}const I=parseFloat(k);return isNaN(I)?null:I},S=async C=>{try{c(!0);const k=C.map((I,T)=>{var E,O,M,W;return{mobile_no:((E=I["Mobile No."])==null?void 0:E.toString())||"",unique_number:((O=I["Unique Number"])==null?void 0:O.toString())||null,name:I.Name||null,city:I.City||null,block:I.Block||null,caste:I.Caste||null,gender:I.Gender||null,qualification:I.Qualification||null,current_work:I["Current Work"]||null,qualifying_school:I["Qualifying SOP/SOB"]||null,whatsapp_number:((M=I["WA NO."])==null?void 0:M.toString())||null,set_name:I.Set||null,exam_centre:I["Offline Exam Centre"]||null,date_of_testing:I["Date of Testing"]||null,final_marks:N((W=I["Final Marks"])==null?void 0:W.toString()),final_notes:I["Final Notes"]||null,triptis_notes:I["Triptis Notes"]||null}});p(k.length),g(!0),y({title:" Import Successful",description:`Successfully imported ${k.length} applicant${k.length>1?"s":""}!`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),r(),t()}catch(k){console.error("Import error:",k),u(k instanceof Error?k.message:"Unknown error occurred")}finally{c(!1)}},_=(C="full")=>{if(C==="update"){const q=[["Email","QuestionSetName","ExamCentre","DateOfTest","ObtainedMarks","ExamStatus","ExamLastUpdatedByEmail","LearningRoundStatus","LearningRoundComments","LearningRoundLastUpdatedByEmail","CulturalFitStatus","CulturalFitComments","CulturalFitLastUpdatedByEmail","OfferLetterStatus","OnboardedStatus","FinalNotes","JoiningDate","OfferLetterSentByEmail","FinalStatusUpdatedByEmail"],["student@example.com","A","Jaipur Center","2025-11-15","28","Screening Test Pass","interviewer1@example.com","Learner Round Pass","Excellent problem-solving and logical thinking","interviewer1@example.com","Cultural Fit Interview Pass","Strong values alignment and team player","interviewer2@example.com","Offer Sent","Onboarded","Selected for January 2025 batch","2025-01-15","abc@navgurukul.org","abc@navgurukul.org"]].map(z=>z.map($=>`"${$}"`).join(",")).join(`
`),P=new Blob([q],{type:"text/csv;charset=utf-8;"}),A=document.createElement("a"),L=URL.createObjectURL(P);A.setAttribute("href",L),A.setAttribute("download","student_sessions_update_template.csv"),A.style.visibility="hidden",document.body.appendChild(A),A.click(),document.body.removeChild(A),y({title:" Template Downloaded",description:"Student Sessions Update template has been downloaded successfully!",variant:"default",className:"border-green-500 bg-green-50 text-green-900"});return}const T=[["FirstName","MiddleName","LastName","Gender","DOB","Email","PhoneNumber","WhatsappNumber","State","City","District","Block","PinCode","Qualification","CurrentStatus","PercentageIn10th","MathMarksIn10th","PercentageIn12th","MathMarksIn12th","Cast","Religion","School","Campus","CommunicationNotes","QuestionSetName","ExamCentre","DateOfTest","ObtainedMarks","ExamStatus","ExamLastUpdatedByEmail","LearningRoundStatus","LearningRoundComments","LearningRoundLastUpdatedByEmail","CulturalFitStatus","CulturalFitComments","CulturalFitLastUpdatedByEmail","OfferLetterStatus","OnboardedStatus","FinalNotes","JoiningDate","OfferLetterSentByEmail","FinalStatusUpdatedByEmail"],["xyz","Kumar","Singh","Male","2005-01-15","A@example.com","1234567890","1234567890","Rajasthan","Jaipur","Jaipur","Mansarovar","302020","12th Pass","Student","85.5","90","78.5","85","General","Hindu","SOB","Kishanganj","Called on 01-Dec-2025","A","Jaipur Center","2025-11-15","28","Screening Test Pass","interviewer1@example.com","Learner Round Pass","Excellent problem-solving and logical thinking","interviewer1@example.com","Cultural Fit Interview Pass","Strong values alignment and team player","interviewer2@example.com","Offer Sent","Onboarded","Selected for January 2025 batch","2025-01-15","abc@navgurukul.org","abc@navgurukul.org"]].map(M=>M.map(W=>`"${W}"`).join(",")).join(`
`),j=new Blob([T],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a"),O=URL.createObjectURL(j);E.setAttribute("href",O),E.setAttribute("download","applicants_import_template.csv"),E.style.visibility="hidden",document.body.appendChild(E),E.click(),document.body.removeChild(E),y({title:" Template Downloaded",description:"CSV template has been downloaded successfully!",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})};return l.jsx(Wr,{open:e,onOpenChange:t,children:l.jsxs(Vr,{className:"sm:max-w-[525px]",children:[l.jsxs(Hr,{children:[l.jsx(qr,{children:"Import Applicants from CSV"}),l.jsx(yh,{children:'Choose a template and upload your CSV file. Use "Full Student Data" to create new students or "Sessions Update" to update screening exam/interview rounds for existing students.'})]}),l.jsxs("div",{className:"grid gap-4 py-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{className:"text-sm font-medium",children:"Download Template:"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[l.jsxs(le,{onClick:()=>_("full"),variant:"outline",className:"flex items-center gap-2 text-xs sm:text-sm",type:"button",children:[l.jsx(Fi,{className:"h-4 w-4"}),"Full Student Data"]}),l.jsxs(le,{onClick:()=>_("update"),variant:"outline",className:"flex items-center gap-2 text-xs sm:text-sm",type:"button",children:[l.jsx(Fi,{className:"h-4 w-4"}),"Sessions Update"]})]}),l.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",l.jsx("strong",{children:"Full Student Data:"})," Create new students with complete information",l.jsx("br",{})," ",l.jsx("strong",{children:"Sessions Update:"})," Update existing students' stages and offer letter updates based on their email addresses."]})]}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("span",{className:"w-full border-t"})}),l.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:l.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or upload your file"})})]}),l.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[l.jsx(Ee,{htmlFor:"file",className:"text-right",children:"CSV File"}),l.jsx(Ve,{type:"file",id:"file",className:"col-span-3",accept:".csv",onChange:v})]}),o&&l.jsxs("div",{className:"flex items-center text-sm text-destructive",children:[l.jsx(pn,{className:"mr-2 h-4 w-4"}),o]}),d&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Processing CSV data..."}),l.jsx(tR,{value:m})]}),f&&l.jsxs("div",{className:"flex items-center text-sm text-green-500",children:[l.jsx(Xd,{className:"mr-2 h-4 w-4"}),"Successfully imported ",h," applicants!"]})]}),l.jsxs(le,{onClick:b,disabled:!n||d,className:"flex items-center gap-2",children:[d&&l.jsx(ya,{className:"animate-spin h-4 w-4"}),d?"Importing...":"Import"]})]})})};function $1e(e,t){return w.useReducer((r,n)=>t[r][n]??r,e)}var rR="ScrollArea",[c8,qot]=Ia(rR),[R1e,Gi]=c8(rR),d8=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:s=600,...i}=e,[o,u]=w.useState(null),[d,c]=w.useState(null),[h,p]=w.useState(null),[f,g]=w.useState(null),[m,x]=w.useState(null),[y,v]=w.useState(0),[b,N]=w.useState(0),[S,_]=w.useState(!1),[C,k]=w.useState(!1),I=Bt(t,j=>u(j)),T=Bg(a);return l.jsx(R1e,{scope:r,type:n,dir:T,scrollHideDelay:s,scrollArea:o,viewport:d,onViewportChange:c,content:h,onContentChange:p,scrollbarX:f,onScrollbarXChange:g,scrollbarXEnabled:S,onScrollbarXEnabledChange:_,scrollbarY:m,onScrollbarYChange:x,scrollbarYEnabled:C,onScrollbarYEnabledChange:k,onCornerWidthChange:v,onCornerHeightChange:N,children:l.jsx(at.div,{dir:T,...i,ref:I,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});d8.displayName=rR;var h8="ScrollAreaViewport",p8=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:n,nonce:a,...s}=e,i=Gi(h8,r),o=w.useRef(null),u=Bt(t,o,i.onViewportChange);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),l.jsx(at.div,{"data-radix-scroll-area-viewport":"",...s,ref:u,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...e.style},children:l.jsx("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});p8.displayName=h8;var vl="ScrollAreaScrollbar",nR=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Gi(vl,e.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:i}=a,o=e.orientation==="horizontal";return w.useEffect(()=>(o?s(!0):i(!0),()=>{o?s(!1):i(!1)}),[o,s,i]),a.type==="hover"?l.jsx(D1e,{...n,ref:t,forceMount:r}):a.type==="scroll"?l.jsx(M1e,{...n,ref:t,forceMount:r}):a.type==="auto"?l.jsx(f8,{...n,ref:t,forceMount:r}):a.type==="always"?l.jsx(aR,{...n,ref:t}):null});nR.displayName=vl;var D1e=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Gi(vl,e.__scopeScrollArea),[s,i]=w.useState(!1);return w.useEffect(()=>{const o=a.scrollArea;let u=0;if(o){const d=()=>{window.clearTimeout(u),i(!0)},c=()=>{u=window.setTimeout(()=>i(!1),a.scrollHideDelay)};return o.addEventListener("pointerenter",d),o.addEventListener("pointerleave",c),()=>{window.clearTimeout(u),o.removeEventListener("pointerenter",d),o.removeEventListener("pointerleave",c)}}},[a.scrollArea,a.scrollHideDelay]),l.jsx(fa,{present:r||s,children:l.jsx(f8,{"data-state":s?"visible":"hidden",...n,ref:t})})}),M1e=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Gi(vl,e.__scopeScrollArea),s=e.orientation==="horizontal",i=tk(()=>u("SCROLL_END"),100),[o,u]=$1e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return w.useEffect(()=>{if(o==="idle"){const d=window.setTimeout(()=>u("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(d)}},[o,a.scrollHideDelay,u]),w.useEffect(()=>{const d=a.viewport,c=s?"scrollLeft":"scrollTop";if(d){let h=d[c];const p=()=>{const f=d[c];h!==f&&(u("SCROLL"),i()),h=f};return d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}},[a.viewport,s,u,i]),l.jsx(fa,{present:r||o!=="hidden",children:l.jsx(aR,{"data-state":o==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:ze(e.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:ze(e.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),f8=w.forwardRef((e,t)=>{const r=Gi(vl,e.__scopeScrollArea),{forceMount:n,...a}=e,[s,i]=w.useState(!1),o=e.orientation==="horizontal",u=tk(()=>{if(r.viewport){const d=r.viewport.offsetWidth<r.viewport.scrollWidth,c=r.viewport.offsetHeight<r.viewport.scrollHeight;i(o?d:c)}},10);return ag(r.viewport,u),ag(r.content,u),l.jsx(fa,{present:n||s,children:l.jsx(aR,{"data-state":s?"visible":"hidden",...a,ref:t})})}),aR=w.forwardRef((e,t)=>{const{orientation:r="vertical",...n}=e,a=Gi(vl,e.__scopeScrollArea),s=w.useRef(null),i=w.useRef(0),[o,u]=w.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=v8(o.viewport,o.content),c={...n,sizes:o,onSizesChange:u,hasThumb:d>0&&d<1,onThumbChange:p=>s.current=p,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:p=>i.current=p};function h(p,f){return B1e(p,i.current,o,f)}return r==="horizontal"?l.jsx(F1e,{...c,ref:t,onThumbPositionChange:()=>{if(a.viewport&&s.current){const p=a.viewport.scrollLeft,f=B3(p,o,a.dir);s.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollLeft=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollLeft=h(p,a.dir))}}):r==="vertical"?l.jsx(O1e,{...c,ref:t,onThumbPositionChange:()=>{if(a.viewport&&s.current){const p=a.viewport.scrollTop,f=B3(p,o);s.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollTop=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollTop=h(p))}}):null}),F1e=w.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...a}=e,s=Gi(vl,e.__scopeScrollArea),[i,o]=w.useState(),u=w.useRef(null),d=Bt(t,u,s.onScrollbarXChange);return w.useEffect(()=>{u.current&&o(getComputedStyle(u.current))},[u]),l.jsx(g8,{"data-orientation":"horizontal",...a,ref:d,sizes:r,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ek(r)+"px",...e.style},onThumbPointerDown:c=>e.onThumbPointerDown(c.x),onDragScroll:c=>e.onDragScroll(c.x),onWheelScroll:(c,h)=>{if(s.viewport){const p=s.viewport.scrollLeft+c.deltaX;e.onWheelScroll(p),w8(p,h)&&c.preventDefault()}},onResize:()=>{u.current&&s.viewport&&i&&n({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:YN(i.paddingLeft),paddingEnd:YN(i.paddingRight)}})}})}),O1e=w.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...a}=e,s=Gi(vl,e.__scopeScrollArea),[i,o]=w.useState(),u=w.useRef(null),d=Bt(t,u,s.onScrollbarYChange);return w.useEffect(()=>{u.current&&o(getComputedStyle(u.current))},[u]),l.jsx(g8,{"data-orientation":"vertical",...a,ref:d,sizes:r,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ek(r)+"px",...e.style},onThumbPointerDown:c=>e.onThumbPointerDown(c.y),onDragScroll:c=>e.onDragScroll(c.y),onWheelScroll:(c,h)=>{if(s.viewport){const p=s.viewport.scrollTop+c.deltaY;e.onWheelScroll(p),w8(p,h)&&c.preventDefault()}},onResize:()=>{u.current&&s.viewport&&i&&n({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:YN(i.paddingTop),paddingEnd:YN(i.paddingBottom)}})}})}),[P1e,m8]=c8(vl),g8=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:s,onThumbPointerUp:i,onThumbPointerDown:o,onThumbPositionChange:u,onDragScroll:d,onWheelScroll:c,onResize:h,...p}=e,f=Gi(vl,r),[g,m]=w.useState(null),x=Bt(t,I=>m(I)),y=w.useRef(null),v=w.useRef(""),b=f.viewport,N=n.content-n.viewport,S=$n(c),_=$n(u),C=tk(h,10);function k(I){if(y.current){const T=I.clientX-y.current.left,j=I.clientY-y.current.top;d({x:T,y:j})}}return w.useEffect(()=>{const I=T=>{const j=T.target;(g==null?void 0:g.contains(j))&&S(T,N)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[b,g,N,S]),w.useEffect(_,[n,_]),ag(g,C),ag(f.content,C),l.jsx(P1e,{scope:r,scrollbar:g,hasThumb:a,onThumbChange:$n(s),onThumbPointerUp:$n(i),onThumbPositionChange:_,onThumbPointerDown:$n(o),children:l.jsx(at.div,{...p,ref:x,style:{position:"absolute",...p.style},onPointerDown:ze(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),y.current=g.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),k(I))}),onPointerMove:ze(e.onPointerMove,k),onPointerUp:ze(e.onPointerUp,I=>{const T=I.target;T.hasPointerCapture(I.pointerId)&&T.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=v.current,f.viewport&&(f.viewport.style.scrollBehavior=""),y.current=null})})})}),XN="ScrollAreaThumb",x8=w.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=m8(XN,e.__scopeScrollArea);return l.jsx(fa,{present:r||a.hasThumb,children:l.jsx(L1e,{ref:t,...n})})}),L1e=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:n,...a}=e,s=Gi(XN,r),i=m8(XN,r),{onThumbPositionChange:o}=i,u=Bt(t,h=>i.onThumbChange(h)),d=w.useRef(void 0),c=tk(()=>{d.current&&(d.current(),d.current=void 0)},100);return w.useEffect(()=>{const h=s.viewport;if(h){const p=()=>{if(c(),!d.current){const f=U1e(h,o);d.current=f,o()}};return o(),h.addEventListener("scroll",p),()=>h.removeEventListener("scroll",p)}},[s.viewport,c,o]),l.jsx(at.div,{"data-state":i.hasThumb?"visible":"hidden",...a,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:ze(e.onPointerDownCapture,h=>{const f=h.target.getBoundingClientRect(),g=h.clientX-f.left,m=h.clientY-f.top;i.onThumbPointerDown({x:g,y:m})}),onPointerUp:ze(e.onPointerUp,i.onThumbPointerUp)})});x8.displayName=XN;var sR="ScrollAreaCorner",y8=w.forwardRef((e,t)=>{const r=Gi(sR,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?l.jsx(z1e,{...e,ref:t}):null});y8.displayName=sR;var z1e=w.forwardRef((e,t)=>{const{__scopeScrollArea:r,...n}=e,a=Gi(sR,r),[s,i]=w.useState(0),[o,u]=w.useState(0),d=!!(s&&o);return ag(a.scrollbarX,()=>{var h;const c=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(c),u(c)}),ag(a.scrollbarY,()=>{var h;const c=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(c),i(c)}),d?l.jsx(at.div,{...n,ref:t,style:{width:s,height:o,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function YN(e){return e?parseInt(e,10):0}function v8(e,t){const r=e/t;return isNaN(r)?0:r}function ek(e){const t=v8(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function B1e(e,t,r,n="ltr"){const a=ek(r),s=a/2,i=t||s,o=a-i,u=r.scrollbar.paddingStart+i,d=r.scrollbar.size-r.scrollbar.paddingEnd-o,c=r.content-r.viewport,h=n==="ltr"?[0,c]:[c*-1,0];return b8([u,d],h)(e)}function B3(e,t,r="ltr"){const n=ek(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=t.scrollbar.size-a,i=t.content-t.viewport,o=s-n,u=r==="ltr"?[0,i]:[i*-1,0],d=JE(e,u);return b8([0,i],[0,o])(d)}function b8(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function w8(e,t){return e>0&&e<t}var U1e=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function a(){const s={left:e.scrollLeft,top:e.scrollTop},i=r.left!==s.left,o=r.top!==s.top;(i||o)&&t(),r=s,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function tk(e,t){const r=$n(e),n=w.useRef(0);return w.useEffect(()=>()=>window.clearTimeout(n.current),[]),w.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function ag(e,t){const r=$n(t);Un(()=>{let n=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(n),a.unobserve(e)}}},[e,r])}var N8=d8,W1e=p8,V1e=y8;const iR=w.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(N8,{ref:n,className:Ue("relative overflow-hidden",e),...r,children:[l.jsx(W1e,{className:"h-full w-full rounded-[inherit]",children:t}),l.jsx(S8,{}),l.jsx(V1e,{})]}));iR.displayName=N8.displayName;const S8=w.forwardRef(({className:e,orientation:t="vertical",...r},n)=>l.jsx(nR,{ref:n,orientation:t,className:Ue("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:l.jsx(x8,{className:"relative flex-1 rounded-full bg-border"})}));S8.displayName=nR.displayName;function H1e({isOpen:e,onClose:t,results:r}){if(!r)return null;const{summary:n,categorized:a}=r,s=n.sent>0&&n.failed===0,i=n.failed>0;return l.jsx(Wr,{open:e,onOpenChange:t,children:l.jsxs(Vr,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[l.jsx(Hr,{children:l.jsx(qr,{className:"flex items-center gap-2 text-xl",children:s?l.jsxs(l.Fragment,{children:[l.jsx($N,{className:"w-6 h-6 text-green-500"}),"All Offer Letters Sent Successfully"]}):i?l.jsxs(l.Fragment,{children:[l.jsx(pn,{className:"w-6 h-6 text-amber-500"}),"Offer Letter Status"]}):l.jsxs(l.Fragment,{children:[l.jsx(Md,{className:"w-6 h-6 text-red-500"}),"Failed to Send Offer Letters"]})})}),l.jsx("div",{className:"space-y-4 flex-1 overflow-hidden",children:l.jsx(iR,{className:"flex-1 pr-4",children:l.jsxs("div",{className:"space-y-4",children:[a.sent.length>0&&l.jsxs("div",{className:"border rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-green-600 mb-2 flex items-center gap-2",children:[l.jsx($N,{className:"w-4 h-4"}),"Successfully Sent (",a.sent.length,")"]}),l.jsx("ul",{className:"space-y-1 text-sm",children:a.sent.map((o,u)=>l.jsxs("li",{className:"text-muted-foreground",children:[" ",o.displayName,o.email&&l.jsxs("span",{className:"text-xs ml-2 text-muted-foreground",children:["(",o.email,")"]})]},u))})]}),a.noEmail.length>0&&l.jsxs("div",{className:"border border-amber-200 bg-amber-50 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-amber-700 mb-2 flex items-center gap-2",children:[l.jsx(Md,{className:"w-4 h-4"}),"No Email Address (",a.noEmail.length,")"]}),l.jsx("ul",{className:"space-y-1 text-sm",children:a.noEmail.map((o,u)=>l.jsxs("li",{className:"text-amber-700",children:[" ",o.displayName,o.email&&l.jsxs("span",{className:"text-xs ml-2",children:["(",o.email,")"]})]},u))})]}),a.alreadySent.length>0&&l.jsxs("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-blue-700 mb-2 flex items-center gap-2",children:[l.jsx(pn,{className:"w-4 h-4"}),"Already Sent (",a.alreadySent.length,")"]}),l.jsx("ul",{className:"space-y-1 text-sm",children:a.alreadySent.map((o,u)=>l.jsxs("li",{className:"text-blue-700",children:[" ",o.displayName,o.email&&l.jsxs("span",{className:"text-xs ml-2",children:["(",o.email,")"]})]},u))})]}),a.alreadyOnboarded.length>0&&l.jsxs("div",{className:"border border-purple-200 bg-purple-50 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-purple-700 mb-2 flex items-center gap-2",children:[l.jsx(pn,{className:"w-4 h-4"}),"Already Onboarded (",a.alreadyOnboarded.length,")"]}),l.jsx("ul",{className:"space-y-1 text-sm",children:a.alreadyOnboarded.map((o,u)=>l.jsxs("li",{className:"text-purple-700",children:[" ",o.displayName,o.email&&l.jsxs("span",{className:"text-xs ml-2",children:["(",o.email,")"]})]},u))})]}),a.notFound.length>0&&l.jsxs("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-red-700 mb-2 flex items-center gap-2",children:[l.jsx(Md,{className:"w-4 h-4"}),"Student Not Found (",a.notFound.length,")"]}),l.jsx("ul",{className:"space-y-1 text-sm",children:a.notFound.map((o,u)=>l.jsxs("li",{className:"text-red-700",children:[" ",o.displayName,o.email&&l.jsxs("span",{className:"text-xs ml-2",children:["(",o.email,")"]})]},u))})]}),a.otherErrors.length>0&&l.jsxs("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-red-700 mb-2 flex items-center gap-2",children:[l.jsx(Md,{className:"w-4 h-4"}),"Other Errors (",a.otherErrors.length,")"]}),l.jsx("ul",{className:"space-y-2 text-sm",children:a.otherErrors.map((o,u)=>l.jsxs("li",{className:"text-red-700",children:[" ",o.displayName,o.email&&l.jsxs("span",{className:"text-xs ml-2",children:["(",o.email,")"]}),l.jsx("br",{}),l.jsx("span",{className:"text-xs text-red-600 ml-3",children:o.errorMessage})]},u))})]})]})})}),l.jsx("div",{className:"flex justify-center pt-4",children:l.jsx(le,{onClick:t,className:"px-8",children:"Okay"})})]})})}const q1e=(e,t)=>{const[r,n]=w.useState([]),[a,s]=w.useState([]),[i,o]=w.useState([]),[u,d]=w.useState([]),[c,h]=w.useState([]),[p,f]=w.useState([]),[g,m]=w.useState([]),[x,y]=w.useState([]),[v,b]=w.useState([]),[N,S]=w.useState([]),[_,C]=w.useState([]),{data:k,isLoading:I,isFetching:T,refetch:j}=Og({queryKey:["students",e,t],queryFn:()=>w_(e,t),staleTime:3e4}),E=(k==null?void 0:k.data)||[],O=(k==null?void 0:k.totalCount)||0,M=(k==null?void 0:k.totalPages)||Math.max(1,Math.ceil(O/t));return w.useEffect(()=>{(async()=>{try{const[q,P,A,L,z,$,V,B,Y,re,ae]=await Promise.all([Gb(),S_(),Hb(),qb(),Vb(),c$(),rV(),zg(),s$(),i$(),N_()]);n(q||[]),s(P||[]),h(A||[]),m(L||[]),y(z||[]),b($||[]),S(V||[]),d(Y||[]),o(re||[]),f(ae||[]);const J=((B==null?void 0:B.data)||B||[]).map(Z=>({value:Z.state_code,label:Z.state_name}));C(J)}catch(q){console.error("Failed to fetch options:",q)}})()},[]),{students:E,totalStudents:O,totalPagesFromAPI:M,isStudentsLoading:I,isStudentsFetching:T,refetchStudents:j,campusList:r,schoolList:a,currentstatusList:i,stageList:u,religionList:c,questionSetList:p,qualificationList:g,castList:x,partnerList:v,donorList:N,stateList:_}},G1e=(e,t,r,n,a,s)=>{const[i,o]=w.useState(""),[u,d]=w.useState({stage:"all",stage_status:"all",examMode:"all",interviewMode:"all",partner:[],district:[],market:[],school:[],religion:[],qualification:[],currentStatus:[],state:void 0,gender:void 0,dateRange:{type:"applicant",from:void 0,to:void 0}}),[c,h]=w.useState([]),[p,f]=w.useState(!1),[g,m]=w.useState([]),[x,y]=w.useState(!1),[v,b]=w.useState(!1),{toast:N}=Wt();w.useEffect(()=>{const _=setTimeout(async()=>{if(!i.trim()){h([]);return}b(!1),m([]);try{f(!0);const C=await o$(i.trim());h(C||[])}catch(C){console.error("Search error:",C),N({title:" Unable to Search",description:ut(C),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{f(!1)}},500);return()=>clearTimeout(_)},[i,N]);const S=w.useMemo(()=>{let _;return i.trim()?_=c:v?_=g:_=e,_.map(C=>{const k=r.find(O=>O.id===C.school_id),I=t.find(O=>O.id===C.campus_id),T=n.find(O=>O.id===C.current_status_id),j=a.find(O=>O.id===C.religion_id),E=s.find(O=>O.id===C.question_set_id);return{...C,name:`${C.first_name||""} ${C.middle_name||""} ${C.last_name||""}`.trim(),school_name:C.school_name||(k?k.school_name:"N/A"),campus_name:C.campus_name||(I?I.campus_name:"N/A"),current_status_name:C.current_status_name||(T?T.current_status_name:"N/A"),religion_name:C.religion_name||(j?j.religion_name:"N/A"),question_set_name:C.question_set_name||(E?E.name:"N/A"),maximumMarks:E?E.maximumMarks:0,stage_name:C.stage_name||"N/A"}})},[i,c,v,g,e,r,t,n,a,s]);return{searchTerm:i,setSearchTerm:o,filters:u,setFilters:d,searchResults:c,setSearchResults:h,isSearching:p,filteredStudents:g,setFilteredStudents:m,isFiltering:x,setIsFiltering:y,hasActiveFilters:v,setHasActiveFilters:b,filteredApplicants:S}},K1e=({selectedRowsCount:e,onBulkUpdate:t,onSendOfferLetters:r,onBulkDelete:n})=>e===0?null:l.jsxs("div",{className:"flex items-center gap-2 mr-4",children:[l.jsxs(Kn,{variant:"secondary",children:[e," selected"]}),l.jsxs(le,{variant:"outline",size:"sm",onClick:t,children:[l.jsx(xl,{className:"h-4 w-4 mr-2"}),"Bulk Update"]}),l.jsxs(le,{variant:"outline",size:"sm",onClick:r,children:[l.jsx(uh,{className:"h-4 w-4 mr-2"}),"Send Offer Letters"]}),l.jsxs(le,{variant:"outline",size:"sm",onClick:n,children:[l.jsx(ka,{className:"h-4 w-4 mr-2"}),"Delete"]})]});var yT=["Enter"," "],Q1e=["ArrowDown","PageUp","Home"],_8=["ArrowUp","PageDown","End"],X1e=[...Q1e,..._8],Y1e={ltr:[...yT,"ArrowRight"],rtl:[...yT,"ArrowLeft"]},J1e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},i0="Menu",[nb,Z1e,eNe]=t_(i0),[Gh,k8]=Ia(i0,[eNe,Vc,Ug]),rk=Vc(),C8=Ug(),[tNe,Kh]=Gh(i0),[rNe,o0]=Gh(i0),I8=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:s,modal:i=!0}=e,o=rk(t),[u,d]=w.useState(null),c=w.useRef(!1),h=$n(s),p=Bg(a);return w.useEffect(()=>{const f=()=>{c.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>c.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),l.jsx(o_,{...o,children:l.jsx(tNe,{scope:t,open:r,onOpenChange:h,content:u,onContentChange:d,children:l.jsx(rNe,{scope:t,onClose:w.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:c,dir:p,modal:i,children:n})})})};I8.displayName=i0;var nNe="MenuAnchor",oR=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=rk(r);return l.jsx(Lb,{...a,...n,ref:t})});oR.displayName=nNe;var lR="MenuPortal",[aNe,E8]=Gh(lR,{forceMount:void 0}),T8=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,s=Kh(lR,t);return l.jsx(aNe,{scope:t,forceMount:r,children:l.jsx(fa,{present:r||s.open,children:l.jsx(Tg,{asChild:!0,container:a,children:n})})})};T8.displayName=lR;var Ui="MenuContent",[sNe,uR]=Gh(Ui),j8=w.forwardRef((e,t)=>{const r=E8(Ui,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,s=Kh(Ui,e.__scopeMenu),i=o0(Ui,e.__scopeMenu);return l.jsx(nb.Provider,{scope:e.__scopeMenu,children:l.jsx(fa,{present:n||s.open,children:l.jsx(nb.Slot,{scope:e.__scopeMenu,children:i.modal?l.jsx(iNe,{...a,ref:t}):l.jsx(oNe,{...a,ref:t})})})})}),iNe=w.forwardRef((e,t)=>{const r=Kh(Ui,e.__scopeMenu),n=w.useRef(null),a=Bt(t,n);return w.useEffect(()=>{const s=n.current;if(s)return I_(s)},[]),l.jsx(cR,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:ze(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),oNe=w.forwardRef((e,t)=>{const r=Kh(Ui,e.__scopeMenu);return l.jsx(cR,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),lNe=Nc("MenuContent.ScrollLock"),cR=w.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEntryFocus:u,onEscapeKeyDown:d,onPointerDownOutside:c,onFocusOutside:h,onInteractOutside:p,onDismiss:f,disableOutsideScroll:g,...m}=e,x=Kh(Ui,r),y=o0(Ui,r),v=rk(r),b=C8(r),N=Z1e(r),[S,_]=w.useState(null),C=w.useRef(null),k=Bt(t,C,x.onContentChange),I=w.useRef(0),T=w.useRef(""),j=w.useRef(0),E=w.useRef(null),O=w.useRef("right"),M=w.useRef(0),W=g?Jb:w.Fragment,q=g?{as:lNe,allowPinchZoom:!0}:void 0,P=L=>{var K,J;const z=T.current+L,$=N().filter(Z=>!Z.disabled),V=document.activeElement,B=(K=$.find(Z=>Z.ref.current===V))==null?void 0:K.textValue,Y=$.map(Z=>Z.textValue),re=bNe(Y,z,B),ae=(J=$.find(Z=>Z.textValue===re))==null?void 0:J.ref.current;(function Z(Q){T.current=Q,window.clearTimeout(I.current),Q!==""&&(I.current=window.setTimeout(()=>Z(""),1e3))})(z),ae&&setTimeout(()=>ae.focus())};w.useEffect(()=>()=>window.clearTimeout(I.current),[]),C_();const A=w.useCallback(L=>{var $,V;return O.current===(($=E.current)==null?void 0:$.side)&&NNe(L,(V=E.current)==null?void 0:V.area)},[]);return l.jsx(sNe,{scope:r,searchRef:T,onItemEnter:w.useCallback(L=>{A(L)&&L.preventDefault()},[A]),onItemLeave:w.useCallback(L=>{var z;A(L)||((z=C.current)==null||z.focus(),_(null))},[A]),onTriggerLeave:w.useCallback(L=>{A(L)&&L.preventDefault()},[A]),pointerGraceTimerRef:j,onPointerGraceIntentChange:w.useCallback(L=>{E.current=L},[]),children:l.jsx(W,{...q,children:l.jsx(Yb,{asChild:!0,trapped:a,onMountAutoFocus:ze(s,L=>{var z;L.preventDefault(),(z=C.current)==null||z.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:l.jsx(Vh,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:d,onPointerDownOutside:c,onFocusOutside:h,onInteractOutside:p,onDismiss:f,children:l.jsx(h$,{asChild:!0,...b,dir:y.dir,orientation:"vertical",loop:n,currentTabStopId:S,onCurrentTabStopIdChange:_,onEntryFocus:ze(u,L=>{y.isUsingKeyboardRef.current||L.preventDefault()}),preventScrollOnEntryFocus:!0,children:l.jsx(l_,{role:"menu","aria-orientation":"vertical","data-state":q8(x.open),"data-radix-menu-content":"",dir:y.dir,...v,...m,ref:k,style:{outline:"none",...m.style},onKeyDown:ze(m.onKeyDown,L=>{const $=L.target.closest("[data-radix-menu-content]")===L.currentTarget,V=L.ctrlKey||L.altKey||L.metaKey,B=L.key.length===1;$&&(L.key==="Tab"&&L.preventDefault(),!V&&B&&P(L.key));const Y=C.current;if(L.target!==Y||!X1e.includes(L.key))return;L.preventDefault();const ae=N().filter(K=>!K.disabled).map(K=>K.ref.current);_8.includes(L.key)&&ae.reverse(),yNe(ae)}),onBlur:ze(e.onBlur,L=>{L.currentTarget.contains(L.target)||(window.clearTimeout(I.current),T.current="")}),onPointerMove:ze(e.onPointerMove,ab(L=>{const z=L.target,$=M.current!==L.clientX;if(L.currentTarget.contains(z)&&$){const V=L.clientX>M.current?"right":"left";O.current=V,M.current=L.clientX}}))})})})})})})});j8.displayName=Ui;var uNe="MenuGroup",dR=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(at.div,{role:"group",...n,ref:t})});dR.displayName=uNe;var cNe="MenuLabel",A8=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(at.div,{...n,ref:t})});A8.displayName=cNe;var JN="MenuItem",U3="menu.itemSelect",nk=w.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,s=w.useRef(null),i=o0(JN,e.__scopeMenu),o=uR(JN,e.__scopeMenu),u=Bt(t,s),d=w.useRef(!1),c=()=>{const h=s.current;if(!r&&h){const p=new CustomEvent(U3,{bubbles:!0,cancelable:!0});h.addEventListener(U3,f=>n==null?void 0:n(f),{once:!0}),_A(h,p),p.defaultPrevented?d.current=!1:i.onClose()}};return l.jsx($8,{...a,ref:u,disabled:r,onClick:ze(e.onClick,c),onPointerDown:h=>{var p;(p=e.onPointerDown)==null||p.call(e,h),d.current=!0},onPointerUp:ze(e.onPointerUp,h=>{var p;d.current||(p=h.currentTarget)==null||p.click()}),onKeyDown:ze(e.onKeyDown,h=>{const p=o.searchRef.current!=="";r||p&&h.key===" "||yT.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});nk.displayName=JN;var $8=w.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...s}=e,i=uR(JN,r),o=C8(r),u=w.useRef(null),d=Bt(t,u),[c,h]=w.useState(!1),[p,f]=w.useState("");return w.useEffect(()=>{const g=u.current;g&&f((g.textContent??"").trim())},[s.children]),l.jsx(nb.ItemSlot,{scope:r,disabled:n,textValue:a??p,children:l.jsx(p$,{asChild:!0,...o,focusable:!n,children:l.jsx(at.div,{role:"menuitem","data-highlighted":c?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...s,ref:d,onPointerMove:ze(e.onPointerMove,ab(g=>{n?i.onItemLeave(g):(i.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ze(e.onPointerLeave,ab(g=>i.onItemLeave(g))),onFocus:ze(e.onFocus,()=>h(!0)),onBlur:ze(e.onBlur,()=>h(!1))})})})}),dNe="MenuCheckboxItem",R8=w.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return l.jsx(P8,{scope:e.__scopeMenu,checked:r,children:l.jsx(nk,{role:"menuitemcheckbox","aria-checked":ZN(r)?"mixed":r,...a,ref:t,"data-state":pR(r),onSelect:ze(a.onSelect,()=>n==null?void 0:n(ZN(r)?!0:!r),{checkForDefaultPrevented:!1})})})});R8.displayName=dNe;var D8="MenuRadioGroup",[hNe,pNe]=Gh(D8,{value:void 0,onValueChange:()=>{}}),M8=w.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,s=$n(n);return l.jsx(hNe,{scope:e.__scopeMenu,value:r,onValueChange:s,children:l.jsx(dR,{...a,ref:t})})});M8.displayName=D8;var F8="MenuRadioItem",O8=w.forwardRef((e,t)=>{const{value:r,...n}=e,a=pNe(F8,e.__scopeMenu),s=r===a.value;return l.jsx(P8,{scope:e.__scopeMenu,checked:s,children:l.jsx(nk,{role:"menuitemradio","aria-checked":s,...n,ref:t,"data-state":pR(s),onSelect:ze(n.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,r)},{checkForDefaultPrevented:!1})})})});O8.displayName=F8;var hR="MenuItemIndicator",[P8,fNe]=Gh(hR,{checked:!1}),L8=w.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,s=fNe(hR,r);return l.jsx(fa,{present:n||ZN(s.checked)||s.checked===!0,children:l.jsx(at.span,{...a,ref:t,"data-state":pR(s.checked)})})});L8.displayName=hR;var mNe="MenuSeparator",z8=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(at.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});z8.displayName=mNe;var gNe="MenuArrow",B8=w.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=rk(r);return l.jsx(u_,{...a,...n,ref:t})});B8.displayName=gNe;var xNe="MenuSub",[Got,U8]=Gh(xNe),Jy="MenuSubTrigger",W8=w.forwardRef((e,t)=>{const r=Kh(Jy,e.__scopeMenu),n=o0(Jy,e.__scopeMenu),a=U8(Jy,e.__scopeMenu),s=uR(Jy,e.__scopeMenu),i=w.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:u}=s,d={__scopeMenu:e.__scopeMenu},c=w.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return w.useEffect(()=>c,[c]),w.useEffect(()=>{const h=o.current;return()=>{window.clearTimeout(h),u(null)}},[o,u]),l.jsx(oR,{asChild:!0,...d,children:l.jsx($8,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":q8(r.open),...e,ref:tu(t,a.onTriggerChange),onClick:h=>{var p;(p=e.onClick)==null||p.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:ze(e.onPointerMove,ab(h=>{s.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!r.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),c()},100))})),onPointerLeave:ze(e.onPointerLeave,ab(h=>{var f,g;c();const p=(f=r.content)==null?void 0:f.getBoundingClientRect();if(p){const m=(g=r.content)==null?void 0:g.dataset.side,x=m==="right",y=x?-5:5,v=p[x?"left":"right"],b=p[x?"right":"left"];s.onPointerGraceIntentChange({area:[{x:h.clientX+y,y:h.clientY},{x:v,y:p.top},{x:b,y:p.top},{x:b,y:p.bottom},{x:v,y:p.bottom}],side:m}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(h),h.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ze(e.onKeyDown,h=>{var f;const p=s.searchRef.current!=="";e.disabled||p&&h.key===" "||Y1e[n.dir].includes(h.key)&&(r.onOpenChange(!0),(f=r.content)==null||f.focus(),h.preventDefault())})})})});W8.displayName=Jy;var V8="MenuSubContent",H8=w.forwardRef((e,t)=>{const r=E8(Ui,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,s=Kh(Ui,e.__scopeMenu),i=o0(Ui,e.__scopeMenu),o=U8(V8,e.__scopeMenu),u=w.useRef(null),d=Bt(t,u);return l.jsx(nb.Provider,{scope:e.__scopeMenu,children:l.jsx(fa,{present:n||s.open,children:l.jsx(nb.Slot,{scope:e.__scopeMenu,children:l.jsx(cR,{id:o.contentId,"aria-labelledby":o.triggerId,...a,ref:d,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:c=>{var h;i.isUsingKeyboardRef.current&&((h=u.current)==null||h.focus()),c.preventDefault()},onCloseAutoFocus:c=>c.preventDefault(),onFocusOutside:ze(e.onFocusOutside,c=>{c.target!==o.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ze(e.onEscapeKeyDown,c=>{i.onClose(),c.preventDefault()}),onKeyDown:ze(e.onKeyDown,c=>{var f;const h=c.currentTarget.contains(c.target),p=J1e[i.dir].includes(c.key);h&&p&&(s.onOpenChange(!1),(f=o.trigger)==null||f.focus(),c.preventDefault())})})})})})});H8.displayName=V8;function q8(e){return e?"open":"closed"}function ZN(e){return e==="indeterminate"}function pR(e){return ZN(e)?"indeterminate":e?"checked":"unchecked"}function yNe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function vNe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function bNe(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=vNe(e,Math.max(s,0));a.length===1&&(i=i.filter(d=>d!==r));const u=i.find(d=>d.toLowerCase().startsWith(a.toLowerCase()));return u!==r?u:void 0}function wNe(e,t){const{x:r,y:n}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],u=t[i],d=o.x,c=o.y,h=u.x,p=u.y;c>n!=p>n&&r<(h-d)*(n-c)/(p-c)+d&&(a=!a)}return a}function NNe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return wNe(r,t)}function ab(e){return t=>t.pointerType==="mouse"?e(t):void 0}var SNe=I8,_Ne=oR,kNe=T8,CNe=j8,INe=dR,ENe=A8,TNe=nk,jNe=R8,ANe=M8,$Ne=O8,RNe=L8,DNe=z8,MNe=B8,FNe=W8,ONe=H8,ak="DropdownMenu",[PNe,Kot]=Ia(ak,[k8]),ks=k8(),[LNe,G8]=PNe(ak),K8=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,u=ks(t),d=w.useRef(null),[c,h]=So({prop:a,defaultProp:s??!1,onChange:i,caller:ak});return l.jsx(LNe,{scope:t,triggerId:_a(),triggerRef:d,contentId:_a(),open:c,onOpenChange:h,onOpenToggle:w.useCallback(()=>h(p=>!p),[h]),modal:o,children:l.jsx(SNe,{...u,open:c,onOpenChange:h,dir:n,modal:o,children:r})})};K8.displayName=ak;var Q8="DropdownMenuTrigger",X8=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,s=G8(Q8,r),i=ks(r);return l.jsx(_Ne,{asChild:!0,...i,children:l.jsx(at.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:tu(t,s.triggerRef),onPointerDown:ze(e.onPointerDown,o=>{!n&&o.button===0&&o.ctrlKey===!1&&(s.onOpenToggle(),s.open||o.preventDefault())}),onKeyDown:ze(e.onKeyDown,o=>{n||(["Enter"," "].includes(o.key)&&s.onOpenToggle(),o.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});X8.displayName=Q8;var zNe="DropdownMenuPortal",Y8=e=>{const{__scopeDropdownMenu:t,...r}=e,n=ks(t);return l.jsx(kNe,{...n,...r})};Y8.displayName=zNe;var J8="DropdownMenuContent",Z8=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=G8(J8,r),s=ks(r),i=w.useRef(!1);return l.jsx(CNe,{id:a.contentId,"aria-labelledby":a.triggerId,...s,...n,ref:t,onCloseAutoFocus:ze(e.onCloseAutoFocus,o=>{var u;i.current||(u=a.triggerRef.current)==null||u.focus(),i.current=!1,o.preventDefault()}),onInteractOutside:ze(e.onInteractOutside,o=>{const u=o.detail.originalEvent,d=u.button===0&&u.ctrlKey===!0,c=u.button===2||d;(!a.modal||c)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Z8.displayName=J8;var BNe="DropdownMenuGroup",UNe=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(INe,{...a,...n,ref:t})});UNe.displayName=BNe;var WNe="DropdownMenuLabel",e9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(ENe,{...a,...n,ref:t})});e9.displayName=WNe;var VNe="DropdownMenuItem",t9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(TNe,{...a,...n,ref:t})});t9.displayName=VNe;var HNe="DropdownMenuCheckboxItem",r9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(jNe,{...a,...n,ref:t})});r9.displayName=HNe;var qNe="DropdownMenuRadioGroup",GNe=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(ANe,{...a,...n,ref:t})});GNe.displayName=qNe;var KNe="DropdownMenuRadioItem",n9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx($Ne,{...a,...n,ref:t})});n9.displayName=KNe;var QNe="DropdownMenuItemIndicator",a9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(RNe,{...a,...n,ref:t})});a9.displayName=QNe;var XNe="DropdownMenuSeparator",s9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(DNe,{...a,...n,ref:t})});s9.displayName=XNe;var YNe="DropdownMenuArrow",JNe=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(MNe,{...a,...n,ref:t})});JNe.displayName=YNe;var ZNe="DropdownMenuSubTrigger",i9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(FNe,{...a,...n,ref:t})});i9.displayName=ZNe;var eSe="DropdownMenuSubContent",o9=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=ks(r);return l.jsx(ONe,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});o9.displayName=eSe;var tSe=K8,rSe=X8,nSe=Y8,l9=Z8,u9=e9,c9=t9,d9=r9,h9=n9,p9=a9,f9=s9,m9=i9,g9=o9;const sk=tSe,ik=rSe,aSe=w.forwardRef(({className:e,inset:t,children:r,...n},a)=>l.jsxs(m9,{ref:a,className:Ue("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,l.jsx(eW,{className:"ml-auto h-4 w-4"})]}));aSe.displayName=m9.displayName;const sSe=w.forwardRef(({className:e,...t},r)=>l.jsx(g9,{ref:r,className:Ue("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));sSe.displayName=g9.displayName;const l0=w.forwardRef(({className:e,sideOffset:t=4,...r},n)=>l.jsx(nSe,{children:l.jsx(l9,{ref:n,sideOffset:t,className:Ue("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));l0.displayName=l9.displayName;const zi=w.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(c9,{ref:n,className:Ue("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));zi.displayName=c9.displayName;const iSe=w.forwardRef(({className:e,children:t,checked:r,...n},a)=>l.jsxs(d9,{ref:a,className:Ue("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(p9,{children:l.jsx(Fb,{className:"h-4 w-4"})})}),t]}));iSe.displayName=d9.displayName;const oSe=w.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(h9,{ref:n,className:Ue("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(p9,{children:l.jsx(jA,{className:"h-2 w-2 fill-current"})})}),t]}));oSe.displayName=h9.displayName;const fR=w.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(u9,{ref:n,className:Ue("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));fR.displayName=u9.displayName;const mR=w.forwardRef(({className:e,...t},r)=>l.jsx(f9,{ref:r,className:Ue("-mx-1 my-1 h-px bg-muted",e),...t}));mR.displayName=f9.displayName;const lSe=({onCSVImport:e,onExportCSV:t,onShowFilters:r,onAddApplicant:n,isExporting:a=!1,hasActiveFilters:s=!1,searchTerm:i="",filteredCount:o=0,selectedCount:u=0})=>{const d=s||i.trim().length>0,c=u>0,h=d||c;return l.jsxs(l.Fragment,{children:[l.jsxs(le,{onClick:e,variant:"outline",size:"sm",children:[l.jsx($g,{className:"h-4 w-4 mr-2"}),"Import CSV"]}),h?l.jsxs(sk,{children:[l.jsx(ik,{asChild:!0,children:l.jsx(le,{variant:"outline",size:"sm",disabled:a,children:a?l.jsxs(l.Fragment,{children:[l.jsx(ya,{className:"h-4 w-4 mr-2 animate-spin"}),"Exporting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Export CSV",l.jsx(TA,{className:"h-4 w-4 ml-2"})]})})}),l.jsxs(l0,{align:"end",children:[l.jsxs(zi,{onClick:()=>t("all"),children:[l.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Export All Data"]}),d&&l.jsxs(zi,{onClick:()=>t("filtered"),children:[l.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Export ",i.trim()?"Search":"Filtered"," Results (",o,")"]}),c&&l.jsxs(zi,{onClick:()=>t("selected"),children:[l.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Export Selected (",u,")"]})]})]}):l.jsx(le,{onClick:()=>t("all"),variant:"outline",size:"sm",disabled:a,children:a?l.jsxs(l.Fragment,{children:[l.jsx(ya,{className:"h-4 w-4 mr-2 animate-spin"}),"Exporting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Export CSV"]})}),l.jsxs(le,{onClick:r,variant:"outline",size:"sm",children:[l.jsx(Ob,{className:"h-4 w-4 mr-2"}),"Filters"]}),l.jsxs(le,{onClick:n,size:"sm",children:[l.jsx(Wn,{className:"h-4 w-4 mr-2"}),"Add Applicant"]})]})};var x9={exports:{}},y9={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sg=w;function uSe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cSe=typeof Object.is=="function"?Object.is:uSe,dSe=sg.useState,hSe=sg.useEffect,pSe=sg.useLayoutEffect,fSe=sg.useDebugValue;function mSe(e,t){var r=t(),n=dSe({inst:{value:r,getSnapshot:t}}),a=n[0].inst,s=n[1];return pSe(function(){a.value=r,a.getSnapshot=t,Y2(a)&&s({inst:a})},[e,r,t]),hSe(function(){return Y2(a)&&s({inst:a}),e(function(){Y2(a)&&s({inst:a})})},[e]),fSe(r),r}function Y2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!cSe(e,r)}catch{return!0}}function gSe(e,t){return t()}var xSe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?gSe:mSe;y9.useSyncExternalStore=sg.useSyncExternalStore!==void 0?sg.useSyncExternalStore:xSe;x9.exports=y9;var ySe=x9.exports;function vSe(){return ySe.useSyncExternalStore(bSe,()=>!0,()=>!1)}function bSe(){return()=>{}}var gR="Avatar",[wSe,Qot]=Ia(gR),[NSe,v9]=wSe(gR),b9=w.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[a,s]=w.useState("idle");return l.jsx(NSe,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:s,children:l.jsx(at.span,{...n,ref:t})})});b9.displayName=gR;var w9="AvatarImage",N9=w.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...s}=e,i=v9(w9,r),o=SSe(n,s),u=$n(d=>{a(d),i.onImageLoadingStatusChange(d)});return Un(()=>{o!=="idle"&&u(o)},[o,u]),o==="loaded"?l.jsx(at.img,{...s,ref:t,src:n}):null});N9.displayName=w9;var S9="AvatarFallback",_9=w.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...a}=e,s=v9(S9,r),[i,o]=w.useState(n===void 0);return w.useEffect(()=>{if(n!==void 0){const u=window.setTimeout(()=>o(!0),n);return()=>window.clearTimeout(u)}},[n]),i&&s.imageLoadingStatus!=="loaded"?l.jsx(at.span,{...a,ref:t}):null});_9.displayName=S9;function W3(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function SSe(e,{referrerPolicy:t,crossOrigin:r}){const n=vSe(),a=w.useRef(null),s=n?(a.current||(a.current=new window.Image),a.current):null,[i,o]=w.useState(()=>W3(s,e));return Un(()=>{o(W3(s,e))},[s,e]),Un(()=>{const u=h=>()=>{o(h)};if(!s)return;const d=u("loaded"),c=u("error");return s.addEventListener("load",d),s.addEventListener("error",c),t&&(s.referrerPolicy=t),typeof r=="string"&&(s.crossOrigin=r),()=>{s.removeEventListener("load",d),s.removeEventListener("error",c)}},[s,r,t]),i}var k9=b9,C9=N9,I9=_9;const E9=w.forwardRef(({className:e,...t},r)=>l.jsx(k9,{ref:r,className:Ue("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));E9.displayName=k9.displayName;const T9=w.forwardRef(({className:e,...t},r)=>l.jsx(C9,{ref:r,className:Ue("aspect-square h-full w-full",e),...t}));T9.displayName=C9.displayName;const j9=w.forwardRef(({className:e,...t},r)=>l.jsx(I9,{ref:r,className:Ue("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));j9.displayName=I9.displayName;const _Se=({applicant:e,isSelected:t,onSelect:r,onUpdate:n,onViewDetails:a,onViewComments:s,onCampusChange:i,campusList:o,schoolList:u,religionList:d,currentstatusList:c,questionSetList:h})=>{const[p,f]=w.useState(!1),{hasEditAccess:g}=TG(),m=[e.first_name,e.middle_name,e.last_name].filter(Boolean).join(" ")||e.name||"No name",x=y=>y.split(" ").map(v=>v.charAt(0)).join("").toUpperCase().slice(0,2);return l.jsxs(or,{children:[l.jsx(Xe,{className:"sticky left-0 z-30 bg-white w-12 px-2",children:l.jsx(Gg,{checked:t,onCheckedChange:()=>r(e.id),"aria-label":`Select ${m}`})}),l.jsx(Xe,{className:"w-12 px-2",children:l.jsxs(E9,{className:"h-8 w-8 cursor-pointer hover:ring-2 hover:ring-orange-500 transition-all",onClick:()=>f(!0),children:[l.jsx(T9,{src:e.image_url||e.image,alt:m}),l.jsx(j9,{className:"text-xs",children:x(m)})]})}),l.jsx(Xe,{className:"sticky left-10  bg-white z-20 min-w-[150px] max-w-[180px] px-2",children:l.jsx("div",{className:"truncate",children:l.jsx(Ir,{applicant:e,field:"first_name",displayValue:m,onUpdate:n,disabled:!0})})}),l.jsx(Xe,{className:"min-w-[120px] max-w-[220px] px-2",children:l.jsx("div",{className:"truncate",children:l.jsx(Ir,{applicant:e,field:"email",displayValue:e.email||"No Email",onUpdate:n,showPencil:g,showActionButtons:!1,disabled:!g})})}),l.jsx(Xe,{className:"min-w-[110px] max-w-[130px] px-2",children:l.jsx("div",{className:"truncate",children:l.jsx(Ir,{applicant:e,field:"phone_number",displayValue:e.phone_number||e.mobile_no||"No phone",onUpdate:n,showPencil:g,showActionButtons:!1,disabled:!g})})}),l.jsx(Xe,{className:"min-w-[110px] max-w-[130px] px-2",children:l.jsx("div",{className:"truncate",children:l.jsx(Ir,{applicant:e,field:"whatsapp_number",displayValue:e.whatsapp_number||"No WhatsApp",onUpdate:n,showPencil:g,showActionButtons:!1,disabled:!g})})}),l.jsx(Xe,{className:"min-w-[80px] max-w-[100px] px-2",children:l.jsx("div",{className:"truncate",children:l.jsx(Ir,{applicant:e,field:"gender",displayValue:e.gender||"No Set",options:[{id:"male",name:"Male"},{id:"female",name:"Female"},{id:"other",name:"Other"}],onUpdate:n,showPencil:!1,showActionButtons:!1,disabled:!g})})}),l.jsx(Xe,{className:"min-w-[120px] max-w-[150px] px-2",children:l.jsx("div",{className:"truncate",children:l.jsx(Ir,{applicant:e,field:"campus_id",displayValue:e.campus_name||"N/A",value:e.campus_id,onUpdate:n,options:o.map(y=>({id:y.id,name:y.campus_name})),showPencil:!1,showActionButtons:!1,disabled:!g,tooltipMessage:"Current stage update by student details"})})}),l.jsx(Xe,{className:"min-w-[100px] max-w-[120px] px-2",children:l.jsx("div",{className:"truncate",children:l.jsx(Ir,{applicant:e,field:"stage_name",displayValue:e.stage_name||"N/A",value:e.stage_name,onUpdate:n,showPencil:!1,showActionButtons:!1,disabled:!0,tooltipMessage:"Current stage update by student details"})})}),l.jsx(Xe,{className:"w-16 px-2",children:l.jsxs(sk,{children:[l.jsx(ik,{asChild:!0,children:l.jsx(le,{variant:"ghost",size:"sm",children:l.jsx(Ele,{className:"h-4 w-4"})})}),l.jsx(l0,{align:"end",side:"bottom",sideOffset:5,className:"bg-background border border-border shadow-lg z-50",children:l.jsx(zi,{onClick:()=>a(e),children:"View Details"})})]})}),l.jsx(Wr,{open:p,onOpenChange:f,children:l.jsxs(Vr,{className:"max-w-md",children:[l.jsx(Hr,{children:l.jsx(qr,{children:m})}),l.jsx("div",{className:"flex justify-center items-center p-4",children:e.image_url||e.image?l.jsx("img",{src:e.image_url||e.image,alt:m,className:"max-w-full max-h-[500px] rounded-lg object-contain"}):l.jsx("div",{className:"w-48 h-48 bg-gray-200 rounded-lg flex items-center justify-center",children:l.jsx("span",{className:"text-4xl text-gray-400",children:x(m)})})})]})})]},e.id)},kSe=({selectedRows:e,filteredApplicants:t,handleSelectAllRows:r})=>l.jsx(vi,{className:"sticky top-0 bg-background z-10 border-b",children:l.jsxs(or,{children:[l.jsx(ct,{className:"sticky left-0 bg-background z-10 w-12 px-2",children:l.jsx(Gg,{checked:t.length>0&&e.length===t.length,onCheckedChange:r,"aria-label":"Select all applicants"})}),l.jsx(ct,{className:"font-bold w-12 px-3",children:"Image"}),l.jsx(ct,{className:"sticky left-12 bg-background z-10 min-w-[150px] px-3",children:"Full Name"}),l.jsx(ct,{className:"font-bold min-w-[120px] max-w-[220px] px-3",children:"Email"}),l.jsx(ct,{className:"font-bold min-w-[110px] max-w-[130px] px-3",children:"Phone Number"}),l.jsx(ct,{className:"font-bold min-w-[140px] max-w-[180px] px-3",children:"WhatsApp Number"}),l.jsx(ct,{className:"font-bold min-w-[80px] max-w-[100px] px-3",children:"Gender"}),l.jsx(ct,{className:"font-bold min-w-[120px] max-w-[150px] px-3",children:"Campus"}),l.jsx(ct,{className:"font-bold min-w-[120px] max-w-[150px] px-3",children:"Current Stage"}),l.jsx(ct,{className:"w-16 font-bold px-3",children:"Actions"})]})}),CSe=({currentPage:e,setCurrentPage:t,itemsPerPage:r,setItemsPerPage:n,totalPages:a,showingStart:s,showingEnd:i,currentTotalCount:o,totalStudents:u,searchTerm:d,hasActiveFilters:c})=>l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",s,"  ",i," of ",o]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Rows:"}),l.jsxs("select",{value:r,onChange:h=>{const p=Number(h.target.value);n(p),t(1)},className:"border rounded px-2 py-1 bg-white text-sm",children:[l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:20,children:"20"}),l.jsx("option",{value:50,children:"50"}),l.jsx("option",{value:80,children:"80"}),l.jsx("option",{value:100,children:"100"})]})]}),l.jsx("button",{onClick:()=>t(h=>Math.max(h-1,1)),disabled:e===1,className:"px-3 py-1 rounded border bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),l.jsxs("span",{className:"px-3 py-1 text-sm",children:["Page ",e," of ",a]}),l.jsx("button",{onClick:()=>t(h=>Math.min(h+1,a)),disabled:e===a,className:"px-3 py-1 rounded border bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),ISe=({searchTerm:e,setSearchTerm:t})=>l.jsxs("div",{className:"relative",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),l.jsx(Ve,{type:"search",placeholder:"Search applicants...",className:"pl-10",value:e,onChange:r=>t(r.target.value)})]}),ESe=async e=>{const{questionSetList:t,filteredData:r=[],selectedData:n=[],exportType:a="all",toast:s}=e;let i=[];try{let g=[];a==="selected"&&n.length>0?(g=n,s({title:"Preparing Export",description:`Exporting ${n.length} selected applicants...`})):a==="filtered"&&r.length>0?(g=r,s({title:"Preparing Export",description:`Exporting ${r.length} filtered/searched applicants...`})):(s({title:"Preparing Export",description:"Fetching all applicants..."}),g=(await w_(1,1e5)).data||[]),i=g.map(m=>{const x=t.find(y=>y.id===m.question_set_id);return{...m,mobile_no:m.mobile_no||m.phone_number||"",name:`${m.first_name||""} ${m.middle_name||""} ${m.last_name||""}`.trim(),question_set_name:x?x.name:"N/A",maximumMarks:x?x.maximumMarks:0}})}catch(g){throw console.error("Error fetching all students for export:",g),s({title:"Export Error",description:(g==null?void 0:g.message)||"Failed to fetch all students for export.",variant:"destructive"}),g}if(!i.length){s({title:"No Data",description:"No applicants to export",variant:"destructive"});return}const o=["FirstName","MiddleName","LastName","Gender","DOB","Email","PhoneNumber","WhatsappNumber","State","City","District","Block","PinCode","Qualification","CurrentStatus","Cast","Religion","School","Campus","CommunicationNotes","QuestionSetName","ExamCentre","DateOfTest","ObtainedMarks","ExamStatus","ExamLastUpdatedByEmail","LearningRoundStatus","LearningRoundComments","LearningRoundLastUpdatedByEmail","CulturalFitStatus","CulturalFitComments","CulturalFitLastUpdatedByEmail","OfferLetterStatus","OnboardedStatus","FinalNotes","JoiningDate","OfferLetterSentByEmail","FinalStatusUpdatedByEmail"],u=g=>{if(g==null)return"";const m=String(g).trim();return m.includes("	")||m.includes(",")||m.includes('"')||m.includes(`
`)?`"${m.replace(/"/g,'""')}"`:m},d=g=>{if(!g)return"";try{const m=new Date(g);if(isNaN(m.getTime()))return g;const x=String(m.getDate()).padStart(2,"0"),y=String(m.getMonth()+1).padStart(2,"0"),v=m.getFullYear();return`${x}-${y}-${v}`}catch{return g}},c=[o.join(","),...i.map(g=>{const m=g.exam_sessions||[],x=g.interview_learner_round||[],y=g.interview_cultural_fit_round||[],v=g.final_decisions||[],b=m.length>0?m[m.length-1]:{},N=x.length>0?x[x.length-1]:{},S=y.length>0?y[y.length-1]:{},_=v.length>0?v[v.length-1]:{};let C=g.question_set_name||g.set_name||"";if(b.question_set_id){const I=t.find(T=>T.id===b.question_set_id);I&&(C=I.name)}return[u(g.first_name),u(g.middle_name),u(g.last_name),u(g.gender),u(g.dob),u(g.email),u(g.phone_number),u(g.whatsapp_number),u(g.state_name||g.state||""),u(g.city||g.city_name||""),u(g.district_name||g.district||""),u(g.block_name||g.block||""),u(g.pin_code||g.pincode||""),u(g.qualification_name||g.qualification||""),u(g.current_status_name||g.current_work),u(g.cast_name||g.caste),u(g.religion_name||g.religion),u(g.school_name),u(g.campus_name),u(g.communication_notes),u(C),u(b.exam_centre||g.exam_centre||""),d(b.date_of_test||g.date_of_test),u(b.obtained_marks||g.obtained_marks||""),u(b.status||g.exam_status||g.status||""),u(b.last_updated_by||g.exam_last_updated_by||""),u(N.learning_round_status||g.lr_status||""),u(N.comments||g.lr_comments||""),u(N.last_updated_by||g.lr_last_updated_by||""),u(S.cultural_fit_status||g.cfr_status),u(S.comments||g.cfr_comments),u(S.last_updated_by||g.cfr_last_updated_by),u(_.offer_letter_status||g.offer_letter_status),u(_.onboarded_status||g.onboarded_status||g.joining_status),u(_.final_notes||g.final_notes),d(_.joining_date||g.joining_date),u(_.offer_letter_sent_by||g.offer_letter_sent_by),u(_.last_status_updated_by||g.last_status_updated_by)].join(",")})].join(`
`),h=new Blob([c],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a"),f=URL.createObjectURL(h);p.setAttribute("href",f),p.setAttribute("download",`applicants_${new Date().toISOString().split("T")[0]}.csv`),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p),s({title:" Export Complete",description:`Exported ${i.length} applicants with all details to CSV. Please wait a moment before trying again..`,duration:5e3})},A9=()=>{const[e,t]=w.useState(!1),[r,n]=w.useState(!1),[a,s]=w.useState(!1),[i,o]=w.useState(!1),[u,d]=w.useState(!1),[c,h]=w.useState(null),[p,f]=w.useState(null),[g,m]=w.useState(null),[x,y]=w.useState(!1),[v,b]=w.useState(!1),[N,S]=w.useState(!1),[_,C]=w.useState([]),[k,I]=w.useState(1),[T,j]=w.useState(10),{toast:E}=Wt(),{triggerRefresh:O}=$G(),{students:M,totalStudents:W,totalPagesFromAPI:q,isStudentsFetching:P,refetchStudents:A,campusList:L,schoolList:z,currentstatusList:$,stageList:V,religionList:B,questionSetList:Y,qualificationList:re,castList:ae,partnerList:K,donorList:J,stateList:Z}=q1e(k,T),Q=w.useMemo(()=>M.map(ee=>{const be=z.find(Dt=>Dt.id===ee.school_id),nt=L.find(Dt=>Dt.id===ee.campus_id),Te=$.find(Dt=>Dt.id===ee.current_status_id),Ge=B.find(Dt=>Dt.id===ee.religion_id),wt=Y.find(Dt=>Dt.id===ee.question_set_id);return{...ee,mobile_no:ee.mobile_no||ee.phone_number||"",name:`${ee.first_name||""} ${ee.middle_name||""} ${ee.last_name||""}`.trim(),school_name:be?be.school_name:"N/A",campus_name:nt?nt.campus_name:"N/A",current_status_name:Te?Te.current_status_name:"N/A",religion_name:Ge?Ge.religion_name:"N/A",question_set_name:wt?wt.name:"N/A",maximumMarks:wt?wt.maximumMarks:0}}),[M,z,L,$,B,Y]),{searchTerm:U,setSearchTerm:F,filters:te,setFilters:pe,searchResults:ve,setSearchResults:fe,isSearching:Me,filteredStudents:je,setFilteredStudents:Qe,isFiltering:ft,setIsFiltering:Ot,hasActiveFilters:yt,setHasActiveFilters:De,filteredApplicants:Fe}=G1e(Q,L,z,$,B,Y);w.useEffect(()=>{(U.trim()||yt)&&I(1)},[U,yt]),w.useEffect(()=>{C([])},[U,yt]);const[et,Ae]=w.useState(!1);w.useEffect(()=>{!U.trim()&&!yt&&Ae(!0)},[k,T]),w.useEffect(()=>{!P&&et?(Ae(!1),S(!1)):P&&et&&S(!0)},[P,et]);const He=w.useCallback(ee=>{C(be=>be.includes(ee)?be.filter(nt=>nt!==ee):[...be,ee])},[]),st=w.useCallback(()=>{C(ee=>ee.length===Fe.length?[]:Fe.map(be=>be.id))},[Fe]),kt=w.useCallback(async()=>{if(O(),U.trim())try{const ee=await o$(U.trim());fe(ee||[])}catch(ee){console.error("Error refreshing search results:",ee)}else if(yt&&te)try{const ee=we(te);console.log("Refreshing filtered data with params:",ee);const be=await Wl(ee);Qe(be||[])}catch(ee){console.error("Error refreshing filtered data:",ee),E({title:" Unable to Refresh Data",description:ut(ee),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}else I(1),A()},[U,yt,te,A,E,O]),Vt=async()=>{if(!_.length){E({title:" No Selection",description:"Please select applicants to delete",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{await Promise.all(_.map(ee=>z6(ee))),E({title:" Applicants Deleted",description:"Successfully deleted selected applicants",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),C([]),kt()}catch(ee){console.error("Error deleting applicants:",ee),E({title:" Unable to Delete Applicants",description:ut(ee),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},ur=async()=>{if(_.length===0){E({title:" No Selection",description:"Please select at least one student to send offer letters",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{const ee=_.map(Te=>Number(Te)),be=await jV(ee);if(!be)throw new Error("No response from server");const nt={sent:[],alreadySent:[],noEmail:[],alreadyOnboarded:[],notFound:[],otherErrors:[]};be.results&&Array.isArray(be.results)&&be.results.forEach(Te=>{const Ge=Te.student_name||Te.name||`Student #${Te.student_id||"Unknown"}`,wt=(Te.error||Te.message||"").toLowerCase(),Dt={...Te,displayName:Ge,errorMessage:Te.error||Te.message||"Unknown error"};Te.success?nt.sent.push(Dt):wt.includes("email")||wt.includes("e-mail")||wt.includes("does not have an email")?nt.noEmail.push(Dt):wt.includes("already sent")||wt.includes("already has offer letter")?nt.alreadySent.push(Dt):wt.includes("onboarded")||wt.includes("onboard")?nt.alreadyOnboarded.push(Dt):wt.includes("not found")||wt.includes("does not exist")?nt.notFound.push(Dt):nt.otherErrors.push(Dt)}),h({summary:be.summary,categorized:nt}),d(!0),kt(),C([])}catch(ee){console.error("Error sending bulk offer letters:",ee);let be="Failed to send offer letters. Please try again.";ee!=null&&ee.message?be=ee.message:ee!=null&&ee.toString&&typeof ee.toString=="function"&&(be=ee.toString()),(be.toLowerCase().includes("fetch")||be.toLowerCase().includes("network"))&&(be="Network error. Please check your connection and try again."),E({title:" Unable to Send Offer Letters",description:ut(ee),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},we=ee=>{var nt,Te,Ge,wt,Dt,Xr,In;console.log("Transforming filters to API params:",ee);const be={};if((nt=ee.dateRange)!=null&&nt.from&&((Te=ee.dateRange)!=null&&Te.to)){const Rr=an=>{const xr=new Date(an),bn=xr.getFullYear(),yr=String(xr.getMonth()+1).padStart(2,"0"),_t=String(xr.getDate()).padStart(2,"0");return`${bn}-${yr}-${_t}`};ee.dateRange.type==="application"||ee.dateRange.type==="applicant"?(be.created_at_from=Rr(ee.dateRange.from),be.created_at_to=Rr(ee.dateRange.to)):ee.dateRange.type==="lastUpdate"?(be.updated_at_from=Rr(ee.dateRange.from),be.updated_at_to=Rr(ee.dateRange.to)):ee.dateRange.type==="interview"&&(be.interview_date_from=Rr(ee.dateRange.from),be.interview_date_to=Rr(ee.dateRange.to))}return ee.stage_id&&(be.stage_id=ee.stage_id),ee.stage_status&&ee.stage_status!=="all"&&(be.stage_status=ee.stage_status),(Ge=ee.qualification)!=null&&Ge.length&&ee.qualification[0]!=="all"&&(be.qualification_id=ee.qualification[0]),(wt=ee.partner)!=null&&wt.length&&ee.partner[0]!=="all"&&(be.campus_id=ee.partner[0]),(Dt=ee.school)!=null&&Dt.length&&ee.school[0]!=="all"&&(be.school_id=ee.school[0]),(Xr=ee.currentStatus)!=null&&Xr.length&&ee.currentStatus[0]!=="all"&&(be.current_status_id=ee.currentStatus[0]),ee.state&&ee.state!=="all"&&(be.state=ee.state),(In=ee.district)!=null&&In.length&&ee.district[0]!=="all"&&(be.district=ee.district[0]),ee.gender&&ee.gender!=="all"&&(be.gender=ee.gender),be},wr=ee=>{var nt,Te;if(ee==null||ee==="")return null;if(typeof ee=="string"&&/\D/.test(ee))return ee;const be=Number(ee);if(!Number.isNaN(be)){const Ge=L.find(wt=>Number(wt.id)===be);if(Ge)return Ge.campus_name||Ge.name||String(ee);if(be>=0&&be<L.length)return((nt=L[be])==null?void 0:nt.campus_name)||((Te=L[be])==null?void 0:Te.name)||String(ee)}return String(ee)},nr=ee=>{var nt,Te;if(ee==null||ee==="")return null;if(typeof ee=="string"&&/\D/.test(ee))return ee;const be=Number(ee);if(!Number.isNaN(be)){const Ge=z.find(wt=>Number(wt.id)===be);if(Ge)return Ge.school_name||Ge.name||String(ee);if(be>=0&&be<z.length)return((nt=z[be])==null?void 0:nt.school_name)||((Te=z[be])==null?void 0:Te.name)||String(ee)}return String(ee)},Zt=ee=>{var nt;if(ee==null||ee==="")return null;if(typeof ee=="string"&&/\D/.test(ee))return ee;const be=Number(ee);if(!Number.isNaN(be)){const Te=Y.find(Ge=>Number(Ge.id)===be);if(Te)return Te.name||String(ee);if(be>=0&&be<Y.length)return((nt=Y[be])==null?void 0:nt.name)||String(ee)}return String(ee)},_r=ee=>{var nt,Te;if(ee==null||ee==="")return null;if(typeof ee=="string"&&/\D/.test(ee))return ee;const be=Number(ee);if(!Number.isNaN(be)){const Ge=$.find(wt=>Number(wt.id)===be);if(Ge)return Ge.current_status_name||Ge.name||String(ee);if(be>=0&&be<$.length)return((nt=$[be])==null?void 0:nt.current_status_name)||((Te=$[be])==null?void 0:Te.name)||String(ee)}return String(ee)},Cs=w.useMemo(()=>{var wt,Dt,Xr,In,Rr,an,xr,bn;const ee=[],be=te.stage_id??te.stage;if(be&&be!=="all"){const yr=V.find(kr=>kr.id===be),_t=(yr==null?void 0:yr.stage_name)||(yr==null?void 0:yr.name)||be||"Stage";ee.push({key:`stage-${be}`,label:`Stage: ${_t}`,onRemove:()=>Oe("stage")})}const Te=te.stage_status;if((Array.isArray(Te)?Te:Te&&Te!=="all"?[Te]:[]).forEach(yr=>{ee.push({key:`stage_status-${yr}`,label:`Status: ${yr}`,onRemove:()=>Ie(yr)})}),(wt=te.partner)!=null&&wt.length&&te.partner.filter(_t=>_t!=="all").forEach(_t=>{const kr=L.find(Is=>Number(Is.id)===Number(_t)),La=(kr==null?void 0:kr.campus_name)||wr(_t)||_t;ee.push({key:`partner-${_t}`,label:`Campus: ${La}`})}),(Dt=te.school)!=null&&Dt.length&&te.school.filter(_t=>_t!=="all").forEach(_t=>{const kr=z.find(Is=>Number(Is.id)===Number(_t)),La=(kr==null?void 0:kr.school_name)||nr(_t)||_t;ee.push({key:`school-${_t}`,label:`School: ${La}`})}),(Xr=te.currentStatus)!=null&&Xr.length&&te.currentStatus.filter(_t=>_t!=="all").forEach(_t=>{const kr=$.find(Is=>Number(Is.id)===Number(_t)),La=(kr==null?void 0:kr.current_status_name)||_r(_t)||_t;ee.push({key:`currentStatus-${_t}`,label:`Current Status: ${La}`})}),(In=te.qualification)!=null&&In.length&&te.qualification.filter(_t=>_t!=="all").forEach(_t=>{let kr=_t;const La=re.find(Yi=>String(Yi.id)===String(_t)||Yi.qualification_name===_t||Yi.name===_t),Is=Y.find(Yi=>String(Yi.id)===String(_t)||Yi.name===_t);La?kr=La.qualification_name||La.name||_t:Is?kr=Is.name||Is.qualification_name||_t:kr=Zt(_t)||_t,ee.push({key:`qualification-${_t}`,label:`Qualification: ${kr}`})}),(Rr=te.religion)!=null&&Rr.length&&te.religion.filter(_t=>_t!=="all").forEach(_t=>{const kr=B.find(La=>La.id===_t);ee.push({key:`religion-${_t}`,label:`Religion: ${(kr==null?void 0:kr.religion_name)||_t}`})}),te.state&&te.state!=="all"&&ee.push({key:`state-${te.state}`,label:`State: ${te.state}`}),(an=te.district)!=null&&an.length&&te.district.filter(_t=>_t!=="all").forEach(_t=>ee.push({key:`district-${_t}`,label:`District: ${_t}`})),te.gender&&te.gender!=="all"&&ee.push({key:`gender-${te.gender}`,label:`Gender: ${te.gender}`}),(xr=te.dateRange)!=null&&xr.from&&((bn=te.dateRange)!=null&&bn.to)){const yr=new Date(te.dateRange.from).toLocaleDateString(),_t=new Date(te.dateRange.to).toLocaleDateString(),kr=te.dateRange.type||"date";ee.push({key:`daterange-${yr}-${_t}`,label:`${kr} ${yr}  ${_t}`})}return ee},[te,L,z,$,Y,B,V]),vn=async ee=>{var nt,Te,Ge,wt,Dt,Xr,In;if(console.log("Applying filters:",ee),pe(ee),!(ee.stage_id&&ee.stage_id!==void 0||ee.stage_status&&ee.stage_status!=="all"||((nt=ee.qualification)==null?void 0:nt.length)&&ee.qualification[0]!=="all"||((Te=ee.school)==null?void 0:Te.length)&&ee.school[0]!=="all"||((Ge=ee.currentStatus)==null?void 0:Ge.length)&&ee.currentStatus[0]!=="all"||((wt=ee.partner)==null?void 0:wt.length)&&ee.partner[0]!=="all"||ee.state&&ee.state!=="all"||((Dt=ee.district)==null?void 0:Dt.length)&&ee.district[0]!=="all"||ee.gender&&ee.gender!=="all"||((Xr=ee.dateRange)==null?void 0:Xr.from)&&((In=ee.dateRange)==null?void 0:In.to))){De(!1),Qe([]),I(1);return}F(""),fe([]);try{Ot(!0),De(!0);const Rr=we(ee),an=await Wl(Rr);Qe(an||[]),I(1),E({title:" Filters Applied",description:`Found ${(an==null?void 0:an.length)||0} applicants matching your criteria`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(Rr){console.error("Error applying filters:",Rr),E({title:" Unable to Apply Filters",description:ut(Rr),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),Qe([])}finally{Ot(!1)}},xe=()=>{pe({stage:"all",stage_status:"all",examMode:"all",interviewMode:"all",partner:[],district:[],market:[],school:[],religion:[],qualification:[],currentStatus:[],state:void 0,gender:void 0,dateRange:{type:"applicant",from:void 0,to:void 0}}),De(!1),Qe([]),I(1),E({title:" Filters Cleared",description:"All filters have been removed. Showing all applicants.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})},Ie=async ee=>{var wt,Dt,Xr,In,Rr,an,xr;const nt=(Array.isArray(te.stage_status)?te.stage_status:te.stage_status&&te.stage_status!=="all"?[te.stage_status]:[]).filter(bn=>bn!==ee);let Te;if(nt.length===0?Te={...te,stage:"all",stage_id:void 0,stage_status:"all"}:Te={...te,stage_status:nt},pe(Te),!(Te.stage_id&&Te.stage_id!==void 0||Te.stage_status&&Te.stage_status!=="all"||((wt=Te.qualification)==null?void 0:wt.length)&&Te.qualification[0]!=="all"||((Dt=Te.school)==null?void 0:Dt.length)&&Te.school[0]!=="all"||((Xr=Te.currentStatus)==null?void 0:Xr.length)&&Te.currentStatus[0]!=="all"||((In=Te.partner)==null?void 0:In.length)&&Te.partner[0]!=="all"||Te.state&&Te.state!=="all"||((Rr=Te.district)==null?void 0:Rr.length)&&Te.district[0]!=="all"||Te.gender&&Te.gender!=="all"||((an=Te.dateRange)==null?void 0:an.from)&&((xr=Te.dateRange)==null?void 0:xr.to)))De(!1),Qe([]),I(1),E({title:" Filter Removed",description:"All filters cleared. Showing all applicants.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"});else try{Ot(!0);const bn=we(Te),yr=await Wl(bn);Qe(yr||[]),I(1),E({title:" Filter Removed",description:`Found ${(yr==null?void 0:yr.length)||0} applicants matching your criteria`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(bn){console.error("Error re-applying filters:",bn),E({title:" Unable to Update Filters",description:ut(bn),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),Qe([])}finally{Ot(!1)}},Oe=async ee=>{var Te,Ge,wt,Dt,Xr,In,Rr;let be={...te};switch(ee){case"stage":be.stage="all",be.stage_id=void 0,be.stage_status="all";break;case"stage_status":be.stage_status="all";break;case"state":be.state=void 0,be.district=[];break;case"district":be.district=[];break;case"partner":case"campus":be.partner=[];break;case"school":be.school=[];break;case"religion":be.religion=[];break;case"qualification":be.qualification=[];break;case"currentStatus":be.currentStatus=[];break;case"gender":be.gender=void 0;break;case"dateRange":case"daterange":be.dateRange={type:be.dateRange.type,from:void 0,to:void 0};break;default:return}if(pe(be),!(be.stage_id&&be.stage_id!==void 0||be.stage_status&&be.stage_status!=="all"||((Te=be.qualification)==null?void 0:Te.length)&&be.qualification[0]!=="all"||((Ge=be.school)==null?void 0:Ge.length)&&be.school[0]!=="all"||((wt=be.currentStatus)==null?void 0:wt.length)&&be.currentStatus[0]!=="all"||((Dt=be.partner)==null?void 0:Dt.length)&&be.partner[0]!=="all"||be.state&&be.state!=="all"||((Xr=be.district)==null?void 0:Xr.length)&&be.district[0]!=="all"||be.gender&&be.gender!=="all"||((In=be.dateRange)==null?void 0:In.from)&&((Rr=be.dateRange)==null?void 0:Rr.to)))De(!1),Qe([]),I(1),E({title:" Filter Removed",description:"All filters cleared. Showing all applicants.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"});else try{Ot(!0);const an=we(be),xr=await Wl(an);Qe(xr||[]),I(1),E({title:" Filter Removed",description:`Found ${(xr==null?void 0:xr.length)||0} applicants matching your criteria`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(an){console.error("Error re-applying filters:",an),E({title:" Unable to Update Filters",description:ut(an),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),Qe([])}finally{Ot(!1)}},vt=async(ee="all")=>{if(v){E({title:" Export in Progress",description:"Please wait for the current export to complete",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(ee==="selected"&&_.length===0){E({title:" No Selection",description:"Please select applicants to export",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{b(!0);let be=[];ee==="selected"&&(be=Fe.filter(nt=>_.includes(nt.id))),await ESe({questionSetList:Y,filteredData:Fe,selectedData:be,exportType:ee,toast:E})}catch(be){console.error("Export failed:",be)}finally{b(!1)}},cr=U.trim()?ve.length:yt?je.length:W,tt=w.useMemo(()=>U.trim()||yt?Math.max(1,Math.ceil(cr/T)):q,[U,yt,cr,T,q]),me=w.useMemo(()=>{if(U.trim()||yt){const ee=(k-1)*T,be=ee+T;return Fe.slice(ee,be)}return Fe},[U,yt,Fe,k,T]),Ce=me.length===0?0:(k-1)*T+1,rt=Math.min(k*T,cr);return l.jsxs(Et,{className:"h-full flex flex-col",children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 md:gap-0",children:[l.jsxs("div",{className:"flex flex-col mr-10",children:[l.jsx(Lt,{children:"Applicants"}),l.jsx(xi,{className:"text-sm text-muted-foreground",children:U?`${Fe.length} applicants found (search)`:yt?`${Fe.length} applicants found (filtered)`:`${W} total applicants`})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 md:mt-0",children:[l.jsx(K1e,{selectedRowsCount:_.length,onBulkUpdate:()=>s(!0),onSendOfferLetters:ur,onBulkDelete:()=>y(!0)}),l.jsx(lSe,{onCSVImport:()=>o(!0),onExportCSV:vt,onShowFilters:()=>n(!0),onAddApplicant:()=>t(!0),isExporting:v,hasActiveFilters:yt,searchTerm:U,filteredCount:Fe.length,selectedCount:_.length}),yt&&l.jsxs("button",{onClick:xe,className:"flex items-center text-destructive hover:text-destructive/80 text-sm",children:[l.jsx(wa,{className:"w-4 h-4 mr-1"}),"Clear Filters"]})]})]})}),l.jsxs(jt,{className:"flex-1 flex flex-col",children:[l.jsxs("div",{className:"mb-4 space-y-2",children:[Cs.length>0&&l.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:Cs.map(ee=>l.jsxs(le,{size:"sm",variant:"secondary",className:"rounded-full py-1.5 px-3 h-auto flex items-center gap-2 text-xs whitespace-nowrap max-w-none",onClick:()=>{if(ee.onRemove)ee.onRemove();else{const be=ee.key.split("-")[0];Oe(be)}},children:[l.jsx("span",{className:"inline-block",children:ee.label}),l.jsx(wa,{className:"w-3 h-3 flex-shrink-0"})]},ee.key))}),l.jsx(ISe,{searchTerm:U,setSearchTerm:F})]}),l.jsx("div",{className:"flex-1 border rounded-md overflow-hidden relative",children:l.jsx("div",{className:"h-full overflow-auto",children:l.jsxs(yi,{children:[l.jsx(kSe,{selectedRows:_,filteredApplicants:Fe,handleSelectAllRows:st}),l.jsx(bi,{children:Me||ft||N?l.jsx(or,{children:l.jsx(Xe,{colSpan:13,className:"text-center py-12",children:l.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[l.jsx(ya,{className:"h-8 w-8 animate-spin text-primary"}),l.jsx("span",{className:"text-sm text-muted-foreground",children:Me?"Searching applicants...":ft?"Applying filters...":"Loading data..."})]})})}):me.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:13,className:"text-center text-muted-foreground py-6",children:"No applicants found."})}):me.map(ee=>l.jsx(_Se,{applicant:ee,isSelected:_.includes(ee.id),onSelect:He,onUpdate:kt,onViewDetails:f,onViewComments:m,onCampusChange:kt,schoolList:z,campusList:L,religionList:B,currentstatusList:$,questionSetList:Y},ee.id))})]})})}),l.jsx(CSe,{currentPage:k,setCurrentPage:I,itemsPerPage:T,setItemsPerPage:j,totalPages:tt,showingStart:Ce,showingEnd:rt,currentTotalCount:cr,totalStudents:W,searchTerm:U,hasActiveFilters:yt})]}),l.jsx(sbe,{isOpen:e,onClose:()=>t(!1),onSuccess:kt,schoolList:z,currentstatusList:$,religionList:B,questionSetList:Y,qualificationList:re,castList:ae,partnerList:K,donorList:J,stateList:Z}),l.jsx(A1e,{isOpen:i,onClose:()=>o(!1),onSuccess:kt}),l.jsx(r8,{isOpen:r,onClose:()=>n(!1),onApplyFilters:vn,currentFilters:te,students:M,campusList:L,schoolList:z,religionList:B,currentstatusList:$,stageList:V}),l.jsx(N1e,{isOpen:a,onClose:()=>s(!1),selectedApplicants:_,onSuccess:kt,campusList:L,stateList:Z,castList:ae,qualificationList:re,currentstatusList:$}),l.jsx(Y_,{applicant:p,isOpen:!!p,onClose:()=>{f(null),kt()},castList:ae,qualificationList:re,currentstatusList:$,schoolList:z,campusList:L,questionSetList:Y,stageList:V,partnerList:K,donorList:J,stateList:Z}),l.jsx(k$,{open:x,onOpenChange:y,children:l.jsxs(M_,{children:[l.jsxs(F_,{children:[l.jsx(P_,{children:"Confirm Deletion"}),l.jsxs(L_,{children:["Are you sure you want to delete ",_.length," applicant",_.length>1?"s":"","? This action cannot be undone."]})]}),l.jsxs(O_,{children:[l.jsx(B_,{children:"Cancel"}),l.jsx(z_,{className:"bg-destructive text-white hover:bg-destructive/90",onClick:async()=>{y(!1),await Vt()},children:"Delete"})]})]})}),l.jsx(H1e,{isOpen:u,onClose:()=>d(!1),results:c})]})},$9=()=>l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx(nbe,{children:l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Admissions Dashboard"}),l.jsx("p",{className:"text-muted-foreground",children:"Track and manage applicant progress through Navgurukul's admission process"})]}),l.jsx("div",{className:"mb-8",children:l.jsx(abe,{})}),l.jsx(A9,{})]})})})]}),R9=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(""),[i,o]=w.useState(1),[u,d]=w.useState(10),[c,h]=w.useState(0),[p,f]=w.useState(0),{toast:g}=Wt(),m=Rn(),[x,y]=w.useState(!1),[v,b]=w.useState(!1),[N,S]=w.useState(null),[_,C]=w.useState({donor_name:"",donor_email:"",donor_phone:"",donor_address:"",donor_city:"",donor_state:"",donor_country:""});w.useEffect(()=>{k()},[i,u]);const k=async()=>{var M,W,q;n(!0);try{const P=await PV(i,u),A=((M=P==null?void 0:P.data)==null?void 0:M.data)||[],L=((W=P==null?void 0:P.data)==null?void 0:W.total)||0,z=((q=P==null?void 0:P.data)==null?void 0:q.totalPages)||0;t(A),h(L),f(z)}catch(P){console.error("Error loading donors:",P),g({title:" Unable to Load Donors",description:ut(P),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{n(!1)}},I=async M=>{if(M.preventDefault(),!_.donor_name.trim()||!_.donor_email.trim()||!_.donor_phone.toString().trim()||!_.donor_address.trim()||!_.donor_city.trim()||!_.donor_state.trim()||!_.donor_country.trim()){g({title:" Required Fields Missing",description:"All fields are required",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(_.donor_phone.length!==10){g({title:" Invalid Phone Number",description:"Phone number must be exactly 10 digits",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{await OV({donor_name:_.donor_name,donor_email:_.donor_email,donor_phone:_.donor_phone,donor_address:_.donor_address,donor_city:_.donor_city,donor_state:_.donor_state,donor_country:_.donor_country}),g({title:" Donor Created",description:"Donor created successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),y(!1),C({donor_name:"",donor_email:"",donor_phone:"",donor_address:"",donor_city:"",donor_state:"",donor_country:""}),k()}catch(W){g({title:" Unable to Create Donor",description:ut(W),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},T=M=>{S(M),C({donor_name:M.donor_name,donor_email:M.donor_email||"",donor_phone:M.donor_phone?String(M.donor_phone):"",donor_address:M.donor_address||"",donor_city:M.donor_city||"",donor_state:M.donor_state||"",donor_country:M.donor_country||""}),b(!0)},j=async M=>{if(M.preventDefault(),!N||!_.donor_name.trim()||!_.donor_email.trim()||!_.donor_phone.toString().trim()||!_.donor_address.trim()||!_.donor_city.trim()||!_.donor_state.trim()||!_.donor_country.trim()){g({title:" Required Fields Missing",description:"All fields are required",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(_.donor_phone.length!==10){g({title:" Invalid Phone Number",description:"Phone number must be exactly 10 digits",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{await zV(N.id,{donor_name:_.donor_name,donor_email:_.donor_email,donor_phone:_.donor_phone,donor_address:_.donor_address,donor_city:_.donor_city,donor_state:_.donor_state,donor_country:_.donor_country}),g({title:" Donor Updated",description:"Donor updated successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),b(!1),S(null),k()}catch(W){g({title:" Unable to Update Donor",description:ut(W),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},E=async M=>{if(confirm("Are you sure you want to delete this donor?"))try{await BV(M),g({title:" Donor Deleted",description:"Donor deleted successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),k()}catch(W){g({title:" Unable to Delete Donor",description:ut(W),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},O=e.filter(M=>a===""||(M.donor_name||"").toLowerCase().includes(a.toLowerCase()));return w.useEffect(()=>{i!==1&&o(1)},[a,u]),l.jsxs("div",{className:"min-h-screen bg-muted/40 flex",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 flex-1 p-6 overflow-y-auto h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Donors"}),l.jsx("p",{className:"text-muted-foreground",children:"Manage donor partnerships and related students."})]})}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:l.jsxs(Et,{className:"shadow-sm",children:[l.jsxs(Pt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Lt,{className:"text-sm font-medium",children:"Total Donors"}),l.jsx(aW,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsx(jt,{children:l.jsx("div",{className:"text-2xl font-bold",children:c})})]})})]}),l.jsxs(Et,{className:"shadow-md border-border/60",children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 md:gap-0",children:[l.jsxs("div",{className:"flex flex-col mr-10",children:[l.jsx(Lt,{children:"All Donors"}),l.jsxs("p",{className:"text-sm text-muted-foreground",children:[O.length," ",O.length===1?"donor":"donors"," ",a?"(filtered)":"total"]})]}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-2 md:mt-0",children:l.jsxs(le,{onClick:()=>{C({donor_name:"",donor_email:"",donor_phone:"",donor_address:"",donor_city:"",donor_state:"",donor_country:""}),y(!0)},children:[l.jsx(Wn,{className:"mr-2 h-4 w-4"})," Add Donor"]})})]})}),l.jsxs(jt,{children:[l.jsx("div",{className:"mb-4",children:l.jsxs("div",{className:"relative w-full",children:[l.jsx(Ja,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l.jsx(Ve,{type:"search",placeholder:"Search donors...",className:"pl-9",value:a,onChange:M=>s(M.target.value)})]})}),l.jsxs(yi,{children:[l.jsx(vi,{children:l.jsxs(or,{children:[l.jsx(ct,{children:"Donor Name"}),l.jsx(ct,{children:"Email"}),l.jsx(ct,{children:"Phone"}),l.jsx(ct,{children:"Address"}),l.jsx(ct,{children:"City"}),l.jsx(ct,{children:"State"}),l.jsx(ct,{children:"Country"}),l.jsx(ct,{className:"text-right",children:"Actions"})]})}),l.jsx(bi,{children:r?l.jsx(or,{children:l.jsx(Xe,{colSpan:8,className:"h-24 text-center",children:"Loading..."})}):O.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:8,className:"h-24 text-center text-muted-foreground",children:"No donors found."})}):O.map(M=>l.jsxs(or,{children:[l.jsx(Xe,{children:l.jsx("span",{className:"font-medium cursor-pointer hover:underline hover:text-primary",onClick:()=>m(`/donors/${M.id}/students`),children:M.donor_name||M.name||"Unknown"})}),l.jsx(Xe,{children:M.donor_email||"-"}),l.jsx(Xe,{children:M.donor_phone||"-"}),l.jsx(Xe,{children:M.donor_address||"-"}),l.jsx(Xe,{children:M.donor_city||"-"}),l.jsx(Xe,{children:M.donor_state||"-"}),l.jsx(Xe,{children:M.donor_country||"-"}),l.jsx(Xe,{className:"text-right",children:l.jsxs(sk,{children:[l.jsx(ik,{asChild:!0,children:l.jsx(le,{variant:"ghost",className:"h-8 w-8 p-0",children:l.jsx(rW,{className:"h-4 w-4"})})}),l.jsxs(l0,{align:"end",children:[l.jsx(fR,{children:"Actions"}),l.jsxs(zi,{onClick:()=>T(M),children:[l.jsx(ru,{className:"mr-2 h-4 w-4"})," Edit"]}),l.jsxs(zi,{onClick:()=>m(`/donors/${M.id}/students`),children:[l.jsx(jg,{className:"mr-2 h-4 w-4"})," View Students"]}),l.jsx(mR,{}),l.jsxs(zi,{className:"text-destructive",onClick:()=>E(M.id),children:[l.jsx(ka,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},M.id))})]}),!r&&c>0&&l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-2 pt-4 pb-2",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",l.jsx("span",{className:"font-medium",children:(i-1)*u+1})," - ",l.jsx("span",{className:"font-medium",children:Math.min(i*u,c)})," of ",l.jsx("span",{className:"font-medium",children:c})," donors"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ee,{className:"text-sm text-muted-foreground whitespace-nowrap",children:"Rows per page:"}),l.jsxs("select",{value:u,onChange:M=>d(Number(M.target.value)),className:"border rounded px-2 py-1 text-sm",children:[l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:50,children:"50"}),l.jsx("option",{value:100,children:"100"})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:()=>o(1),disabled:i===1,children:"First"}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>o(M=>Math.max(1,M-1)),disabled:i===1,children:"Previous"}),l.jsxs("span",{className:"text-sm text-muted-foreground px-2",children:["Page ",l.jsx("span",{className:"font-medium",children:i})," of ",l.jsx("span",{className:"font-medium",children:p})]}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>o(M=>Math.min(p,M+1)),disabled:i===p,children:"Next"}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>o(p),disabled:i===p,children:"Last"})]})]})]})]})]})}),l.jsx(Wr,{open:x,onOpenChange:y,children:l.jsxs(Vr,{children:[l.jsxs(Hr,{children:[l.jsx(qr,{children:"Add New Donor"}),l.jsx(yh,{children:"Create a new donor partner."})]}),l.jsxs("form",{onSubmit:I,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"name",children:["Donor Name ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"name",value:_.donor_name,onChange:M=>C({..._,donor_name:M.target.value}),placeholder:"e.g. Accenture",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"email",children:["Email ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"email",type:"email",value:_.donor_email,onChange:M=>C({..._,donor_email:M.target.value}),placeholder:"donor@example.com",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"phone",children:["Phone ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"phone",type:"text",value:_.donor_phone,onChange:M=>{const W=M.target.value.replace(/\D/g,"").slice(0,10);C({..._,donor_phone:W})},placeholder:"10 digit number",required:!0})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"address",children:["Address ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"address",value:_.donor_address,onChange:M=>C({..._,donor_address:M.target.value}),placeholder:"Street address",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"city",children:["City ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"city",value:_.donor_city,onChange:M=>C({..._,donor_city:M.target.value}),placeholder:"City",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"state",children:["State ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"state",value:_.donor_state,onChange:M=>C({..._,donor_state:M.target.value}),placeholder:"State",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"country",children:["Country ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"country",value:_.donor_country,onChange:M=>C({..._,donor_country:M.target.value}),placeholder:"Country",required:!0})]})]}),l.jsxs(fo,{children:[l.jsx(le,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancel"}),l.jsx(le,{type:"submit",children:"Create Donor"})]})]})]})}),l.jsx(Wr,{open:v,onOpenChange:b,children:l.jsxs(Vr,{children:[l.jsxs(Hr,{children:[l.jsx(qr,{children:"Edit Donor"}),l.jsx(yh,{children:"Update donor details."})]}),l.jsxs("form",{onSubmit:j,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"edit-name",children:["Donor Name ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-name",value:_.donor_name,onChange:M=>C({..._,donor_name:M.target.value}),required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"edit-email",children:["Email ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-email",type:"email",value:_.donor_email,onChange:M=>C({..._,donor_email:M.target.value}),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"edit-phone",children:["Phone ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-phone",type:"text",value:_.donor_phone,onChange:M=>{const W=M.target.value.replace(/\D/g,"").slice(0,10);C({..._,donor_phone:W})},placeholder:"10 digit number",required:!0})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"edit-address",children:["Address ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-address",value:_.donor_address,onChange:M=>C({..._,donor_address:M.target.value}),required:!0})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"edit-city",children:["City ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-city",value:_.donor_city,onChange:M=>C({..._,donor_city:M.target.value}),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"edit-state",children:["State ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-state",value:_.donor_state,onChange:M=>C({..._,donor_state:M.target.value}),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"edit-country",children:["Country ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-country",value:_.donor_country,onChange:M=>C({..._,donor_country:M.target.value}),required:!0})]})]}),l.jsxs(fo,{children:[l.jsx(le,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Cancel"}),l.jsx(le,{type:"submit",children:"Update Donor"})]})]})]})})]})};var xR="Radio",[TSe,D9]=Ia(xR),[jSe,ASe]=TSe(xR),M9=w.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:s,disabled:i,value:o="on",onCheck:u,form:d,...c}=e,[h,p]=w.useState(null),f=Bt(t,x=>p(x)),g=w.useRef(!1),m=h?d||!!h.closest("form"):!0;return l.jsxs(jSe,{scope:r,checked:a,disabled:i,children:[l.jsx(at.button,{type:"button",role:"radio","aria-checked":a,"data-state":L9(a),"data-disabled":i?"":void 0,disabled:i,value:o,...c,ref:f,onClick:ze(e.onClick,x=>{a||u==null||u(),m&&(g.current=x.isPropagationStopped(),g.current||x.stopPropagation())})}),m&&l.jsx(P9,{control:h,bubbles:!g.current,name:n,value:o,checked:a,required:s,disabled:i,form:d,style:{transform:"translateX(-100%)"}})]})});M9.displayName=xR;var F9="RadioIndicator",O9=w.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...a}=e,s=ASe(F9,r);return l.jsx(fa,{present:n||s.checked,children:l.jsx(at.span,{"data-state":L9(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t})})});O9.displayName=F9;var $Se="RadioBubbleInput",P9=w.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:n=!0,...a},s)=>{const i=w.useRef(null),o=Bt(i,s),u=m$(r),d=zA(t);return w.useEffect(()=>{const c=i.current;if(!c)return;const h=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(h,"checked").set;if(u!==r&&f){const g=new Event("click",{bubbles:n});f.call(c,r),c.dispatchEvent(g)}},[u,r,n]),l.jsx(at.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...a.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});P9.displayName=$Se;function L9(e){return e?"checked":"unchecked"}var RSe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ok="RadioGroup",[DSe,Xot]=Ia(ok,[Ug,D9]),z9=Ug(),B9=D9(),[MSe,FSe]=DSe(ok),U9=w.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:s,required:i=!1,disabled:o=!1,orientation:u,dir:d,loop:c=!0,onValueChange:h,...p}=e,f=z9(r),g=Bg(d),[m,x]=So({prop:s,defaultProp:a??null,onChange:h,caller:ok});return l.jsx(MSe,{scope:r,name:n,required:i,disabled:o,value:m,onValueChange:x,children:l.jsx(h$,{asChild:!0,...f,orientation:u,dir:g,loop:c,children:l.jsx(at.div,{role:"radiogroup","aria-required":i,"aria-orientation":u,"data-disabled":o?"":void 0,dir:g,...p,ref:t})})})});U9.displayName=ok;var W9="RadioGroupItem",V9=w.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...a}=e,s=FSe(W9,r),i=s.disabled||n,o=z9(r),u=B9(r),d=w.useRef(null),c=Bt(t,d),h=s.value===a.value,p=w.useRef(!1);return w.useEffect(()=>{const f=m=>{RSe.includes(m.key)&&(p.current=!0)},g=()=>p.current=!1;return document.addEventListener("keydown",f),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",g)}},[]),l.jsx(p$,{asChild:!0,...o,focusable:!i,active:h,children:l.jsx(M9,{disabled:i,required:s.required,checked:h,...u,...a,name:s.name,ref:c,onCheck:()=>s.onValueChange(a.value),onKeyDown:ze(f=>{f.key==="Enter"&&f.preventDefault()}),onFocus:ze(a.onFocus,()=>{var f;p.current&&((f=d.current)==null||f.click())})})})});V9.displayName=W9;var OSe="RadioGroupIndicator",H9=w.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,a=B9(r);return l.jsx(O9,{...a,...n,ref:t})});H9.displayName=OSe;var q9=U9,G9=V9,PSe=H9;const sb=w.forwardRef(({className:e,...t},r)=>l.jsx(q9,{className:Ue("grid gap-2",e),...t,ref:r}));sb.displayName=q9.displayName;const Zd=w.forwardRef(({className:e,...t},r)=>l.jsx(G9,{ref:r,className:Ue("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:l.jsx(PSe,{className:"flex items-center justify-center",children:l.jsx(jA,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Zd.displayName=G9.displayName;const zf=10,Fy={name:"",emails:[""],slug:"",districts:[""],state:""},K9=()=>{const e=Rn(),{toast:t}=Wt(),[r,n]=w.useState([]),[a,s]=w.useState(!0),[i,o]=w.useState(!1),[u,d]=w.useState(!1),[c,h]=w.useState(null),[p,f]=w.useState(1),[g,m]=w.useState({open:!1,idx:null,form:Fy}),[x,y]=w.useState(""),[v,b]=w.useState(!1),[N,S]=w.useState({district:"",slug:"",emailDomain:""}),[_,C]=w.useState({open:!1,form:Fy}),[k,I]=w.useState([]),[T,j]=w.useState(!1),[E,O]=w.useState(1),[M,W]=w.useState(0),[q,P]=w.useState([]),[A,L]=w.useState([]),[z,$]=w.useState([]),[V,B]=w.useState(""),[Y,re]=w.useState(!1),[ae,K]=w.useState([]),[J,Z]=w.useState({name:"",description:"",nameType:"random",isRandom:!0}),Q=async()=>{s(!0);try{const xe=await c$();let Ie=[];Array.isArray(xe)?Ie=xe:xe&&Array.isArray(xe.data)&&(Ie=xe.data),Ie=Ie.map(Oe=>({...Oe,districts:Array.isArray(Oe.districts)?Oe.districts:typeof Oe.districts=="string"?Oe.districts.split(",").map(vt=>vt.trim()):[]})),n(Ie),s(!1)}catch(xe){t({title:" Unable to Load Partners",description:ut(xe),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),s(!1)}};w.useEffect(()=>{Q(),U()},[]);const U=async()=>{try{const xe=await zg();let Ie=[];Array.isArray(xe)?Ie=xe:xe&&Array.isArray(xe.data)?Ie=xe.data:xe&&xe.data&&Array.isArray(xe.data.data)&&(Ie=xe.data.data),P(Ie)}catch(xe){console.error("Failed to load states:",xe),t({title:" Unable to Load States",description:ut(xe),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},F=async xe=>{try{const Ie=await Hh(xe);let Oe=[];Array.isArray(Ie)?Oe=Ie:Ie&&Array.isArray(Ie.data)?Oe=Ie.data:Ie&&Ie.data&&Array.isArray(Ie.data.data)&&(Oe=Ie.data.data),L(Oe)}catch(Ie){console.error("Failed to load districts:",Ie),t({title:" Unable to Load Districts",description:ut(Ie),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),L([])}},te=r.filter(xe=>{var cr,tt,me,Ce,rt;const Ie=!x.trim()||((cr=xe.partner_name)==null?void 0:cr.toLowerCase().includes(x.toLowerCase()))||((tt=xe.email)==null?void 0:tt.toLowerCase().includes(x.toLowerCase()))||((me=xe.slug)==null?void 0:me.toLowerCase().includes(x.toLowerCase())),Oe=N.district?(xe.districts||[]).some(ee=>ee.toLowerCase().includes(N.district.toLowerCase())):!0,vt=N.slug?(Ce=xe.slug)==null?void 0:Ce.toLowerCase().includes(N.slug.toLowerCase()):!0,$t=N.emailDomain?(rt=xe.email)==null?void 0:rt.toLowerCase().endsWith(N.emailDomain.toLowerCase()):!0;return Ie&&Oe&&vt&&$t});qe.useEffect(()=>{f(1)},[x,N]);const pe=te.slice((p-1)*zf,p*zf),ve=Math.ceil(te.length/zf),fe=r.length,Me=new Set(r.flatMap(xe=>xe.districts||[])).size,je=r.reduce((xe,Ie)=>xe+(Ie.student_count||0),0),Qe=()=>{const xe=["Name","Email","Slug","Districts","Meraki Link"],Ie=pe.map(tt=>[tt.partner_name,tt.email,tt.slug,(tt.districts||[]).join("; "),tt.meraki_link||"-"]),Oe=[xe,...Ie].map(tt=>tt.map(me=>`"${me??""}"`).join(",")).join(`
`),vt=new Blob([Oe],{type:"text/csv;charset=utf-8;"}),$t=URL.createObjectURL(vt),cr=document.createElement("a");cr.href=$t,cr.setAttribute("download","partners.csv"),document.body.appendChild(cr),cr.click(),document.body.removeChild(cr),URL.revokeObjectURL($t),t({title:" CSV Downloaded",description:"CSV file downloaded successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})},ft=xe=>{n(Ie=>{const Oe=[...Ie];return Oe[xe]={...Oe[xe],meraki_link:"https://play.google.com/store/apps/details?id=org.merakilearn"},Oe})},Ot=xe=>{const Ie=pe[xe],Oe=r.findIndex(vt=>vt.id===Ie.id);m({open:!0,idx:Oe,form:{name:Ie.partner_name||"",emails:Ie.email?[Ie.email]:[""],slug:Ie.slug||"",districts:Ie.districts&&Ie.districts.length>0?[...Ie.districts]:[""],state:Ie.state||""}}),Ie.state&&F(Ie.state)},yt=()=>{m({open:!1,idx:null,form:Fy})},De=(xe,Ie)=>{m(Oe=>{const vt={...Oe.form,[xe]:Ie};return xe==="state"&&Ie&&(F(Ie),vt.districts=[""]),{...Oe,form:vt}})},Fe=(xe,Ie,Oe)=>{m(vt=>({...vt,form:{...vt.form,[xe]:vt.form[xe].map(($t,cr)=>cr===Ie?Oe:$t)}}))},et=xe=>{m(Ie=>({...Ie,form:{...Ie.form,[xe]:[...Ie.form[xe],""]}}))},Ae=(xe,Ie)=>{m(Oe=>({...Oe,form:{...Oe.form,[xe]:Oe.form[xe].filter((vt,$t)=>$t!==Ie)}}))},He=async xe=>{xe.preventDefault();const Ie=g.idx;if(Ie==null||Ie<0)return;const Oe=g.form.emails.some(Ce=>Ce.trim()!==""),vt=g.form.districts.some(Ce=>Ce.trim()!==""),$t=[];if(g.form.name.trim()||$t.push("Partner Name"),g.form.slug.trim()||$t.push("Slug"),Oe||$t.push("Email"),g.form.state.trim()||$t.push("State"),vt||$t.push("District"),$t.length>0){t({title:" Missing Required Fields",description:`Please fill in: ${$t.join(", ")}`,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const cr=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,tt=g.form.emails.find(Ce=>Ce.trim()!==""&&!cr.test(Ce.trim()));if(tt){t({title:" Invalid Email Format",description:`"${tt}" is not a valid email address. Please use format: example@domain.com`,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const me=r[Ie];if(!(!me||!me.id))try{await MV(me.id,{partner_name:g.form.name,slug:g.form.slug,email:g.form.emails[0],state:g.form.state,districts:g.form.districts.filter(Ce=>Ce.trim()!=="").join(",")}),t({title:" Partner Updated",description:"Partner details updated successfully.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),yt(),Q()}catch(Ce){t({title:" Unable to Update Partner",description:ut(Ce),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},st=()=>C({open:!0,form:Fy}),kt=()=>C({open:!1,form:Fy}),Vt=(xe,Ie)=>{C(Oe=>{const vt={...Oe.form,[xe]:Ie};return xe==="name"&&(vt.slug=Ie.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")),xe==="state"&&Ie&&(F(Ie),vt.districts=[""]),{...Oe,form:vt}})},ur=(xe,Ie,Oe)=>{C(vt=>({...vt,form:{...vt.form,[xe]:vt.form[xe].map(($t,cr)=>cr===Ie?Oe:$t)}}))},we=xe=>{C(Ie=>({...Ie,form:{...Ie.form,[xe]:[...Ie.form[xe],""]}}))},wr=(xe,Ie)=>{C(Oe=>({...Oe,form:{...Oe.form,[xe]:Oe.form[xe].filter((vt,$t)=>$t!==Ie)}}))},nr=async xe=>{xe.preventDefault();const Ie=_.form.emails.some(tt=>tt.trim()!==""),Oe=_.form.districts.some(tt=>tt.trim()!==""),vt=[];if(_.form.name.trim()||vt.push("Partner Name"),_.form.slug.trim()||vt.push("Slug"),Ie||vt.push("Email"),_.form.state.trim()||vt.push("State"),Oe||vt.push("District"),vt.length>0){t({title:" Missing Required Fields",description:`Please fill in: ${vt.join(", ")}`,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const $t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,cr=_.form.emails.find(tt=>tt.trim()!==""&&!$t.test(tt.trim()));if(cr){t({title:" Invalid Email Format",description:`"${cr}" is not a valid email address. Please use format: example@domain.com`,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{const tt=_.form.districts.filter(me=>me.trim()!=="").join(",");await RV({partner_name:_.form.name,slug:_.form.slug,email:_.form.emails[0],state:_.form.state,districts:tt}),t({title:" Partner Added",description:"Partner added successfully!",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),kt(),Q()}catch(tt){t({title:" Unable to Create Partner",description:ut(tt),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},Zt=async(xe,Ie=1)=>{j(!0);try{const Oe=await d$(xe,Ie,10);let vt=[],$t=0;Oe&&Oe.data&&Array.isArray(Oe.data)?(vt=Oe.data,$t=Oe.total||Oe.count||Oe.data.length):Array.isArray(Oe)?(vt=Oe,$t=Oe.length):Oe&&Oe.students&&Array.isArray(Oe.students)&&(vt=Oe.students,$t=Oe.total||Oe.students.length),I(vt),W($t),j(!1)}catch(Oe){console.error("Failed to fetch students",Oe),t({title:" Unable to Load Students",description:ut(Oe),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),I([]),j(!1)}},_r=async xe=>{h(xe),o(!0),O(1),Zt(xe.id,1);try{const Ie=await N_();console.log("All Sets:",Ie);const Oe=Ie.filter(vt=>{const $t=vt.partnerId&&vt.partnerId==xe.id||vt.partner_id&&vt.partner_id==xe.id,cr=vt.description&&vt.description.toLowerCase().includes(xe.partner_name.toLowerCase());return $t||cr});console.log("Filtered Sets:",Oe),K(Oe)}catch(Ie){console.error("Failed to load assessments:",Ie),t({title:" Unable to Load Assessments",description:ut(Ie),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},Cs=async xe=>{h(xe),d(!0),B("")},vn=async xe=>{if(confirm("Are you sure you want to delete this partner?"))try{await FV(xe),t({title:" Partner Deleted",description:"Partner deleted successfully.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),Q()}catch(Ie){t({title:" Unable to Delete Partner",description:ut(Ie),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}};return l.jsxs("div",{className:"min-h-screen bg-muted/40 flex",children:[l.jsx(dn,{}),l.jsxs("main",{className:"md:ml-64 flex-1 p-6 overflow-y-auto h-screen",children:[l.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Partners"}),l.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage network partners, track performance, and create assessments."})]})}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs(Et,{className:"shadow-sm",children:[l.jsxs(Pt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Lt,{className:"text-sm font-medium",children:"Total Partners"}),l.jsx(ch,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(jt,{children:[l.jsx("div",{className:"text-2xl font-bold",children:fe}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"+2 from last month"})]})]}),l.jsxs(Et,{className:"shadow-sm",children:[l.jsxs(Pt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Lt,{className:"text-sm font-medium",children:"Active Districts"}),l.jsx(iW,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(jt,{children:[l.jsx("div",{className:"text-2xl font-bold",children:Me}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Across the country"})]})]}),l.jsxs(Et,{className:"shadow-sm",children:[l.jsxs(Pt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Lt,{className:"text-sm font-medium",children:"Total Students"}),l.jsx(ch,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(jt,{children:[l.jsx("div",{className:"text-2xl font-bold",children:je||"-"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered via partners"})]})]}),l.jsxs(Et,{className:"shadow-sm",children:[l.jsxs(Pt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Lt,{className:"text-sm font-medium",children:"Assessments"}),l.jsx(xo,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(jt,{children:[l.jsx("div",{className:"text-2xl font-bold",children:"128"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Completed this week"})]})]})]})]}),l.jsxs(Et,{className:"shadow-sm border-border/60",children:[l.jsx(Pt,{className:"pb-3",children:l.jsxs("div",{className:"flex flex-row justify-between items-center",children:[l.jsx(Lt,{className:"text-base font-medium",children:"Filters & Search"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(le,{variant:"outline",onClick:Qe,size:"sm",children:[l.jsx(Fi,{className:"w-4 h-4 mr-2"}),"Export"]}),l.jsxs(le,{variant:"outline",onClick:()=>b(!0),size:"sm",children:[l.jsx(Ob,{className:"w-4 h-4 mr-2"}),"Advanced Filters"]}),Object.values(N).some(Boolean)&&l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>S({district:"",slug:"",emailDomain:""}),children:"Clear"}),l.jsxs(le,{onClick:st,size:"sm",className:"bg-primary text-primary-foreground",children:[l.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Partner"]})]})]})}),l.jsx(jt,{children:l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsxs("div",{className:"relative flex-1",children:[l.jsx(Ja,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l.jsx(Ve,{type:"search",placeholder:"Search by name, email, or slug...",className:"pl-9 bg-background",value:x,onChange:xe=>y(xe.target.value)})]})})})]}),l.jsxs(Et,{className:"shadow-md border-border/60 overflow-hidden",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(yi,{children:[l.jsx(vi,{className:"bg-muted/50",children:l.jsxs(or,{children:[l.jsx(ct,{className:"w-[250px]",children:"Partner Details"}),l.jsx(ct,{children:"Contact"}),l.jsx(ct,{children:"Districts"}),l.jsx(ct,{children:"Slug"}),l.jsx(ct,{children:"View Assessment"}),l.jsx(ct,{children:"Create Assessment"}),l.jsx(ct,{className:"text-right",children:"Actions"})]})}),l.jsx(bi,{children:a?l.jsx(or,{children:l.jsx(Xe,{colSpan:8,className:"h-24 text-center",children:l.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[l.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}),"Loading data..."]})})}):pe.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:8,className:"h-32 text-center text-muted-foreground",children:"No partners found matching your criteria."})}):pe.map((xe,Ie)=>l.jsxs(or,{className:"hover:bg-muted/20 transition-colors",children:[l.jsx(Xe,{children:l.jsx("div",{className:"flex flex-col",children:l.jsx("span",{className:"font-semibold text-foreground cursor-pointer hover:text-primary hover:underline",onClick:()=>e(`/partners/${xe.id}/students`),children:xe.partner_name})})}),l.jsx(Xe,{children:l.jsx("div",{className:"flex items-center gap-2 text-sm text-foreground",children:xe.email||"-"})}),l.jsx(Xe,{children:l.jsxs("div",{className:"flex flex-wrap gap-1",children:[(xe.districts||[]).map((Oe,vt)=>l.jsx(Kn,{variant:"secondary",className:"text-[10px] px-1 py-0",children:Oe},vt)),(!xe.districts||xe.districts.length===0)&&l.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})]})}),l.jsx(Xe,{children:l.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded border",children:xe.slug||"N/A"})}),l.jsx(Xe,{children:l.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>_r(xe),className:"h-8 px-2 text-primary hover:text-primary/80",children:[l.jsx(jg,{className:"mr-2 h-4 w-4"})," View"]})}),l.jsx(Xe,{children:l.jsxs(le,{variant:"ghost",size:"sm",onClick:()=>Cs(xe),className:"h-8 px-2 text-primary hover:text-primary/80",children:[l.jsx(xo,{className:"mr-2 h-4 w-4"})," Create"]})}),l.jsx(Xe,{className:"text-right",children:l.jsxs(sk,{children:[l.jsx(ik,{asChild:!0,children:l.jsxs(le,{variant:"ghost",className:"h-8 w-8 p-0",children:[l.jsx("span",{className:"sr-only",children:"Open menu"}),l.jsx(rW,{className:"h-4 w-4"})]})}),l.jsxs(l0,{align:"end",children:[l.jsx(fR,{children:"Actions"}),l.jsxs(zi,{onClick:()=>Ot(Ie),children:[l.jsx(ru,{className:"mr-2 h-4 w-4"})," Edit Details"]}),l.jsx(mR,{}),l.jsxs(zi,{className:"text-destructive focus:text-destructive",onClick:()=>vn(xe.id),children:[l.jsx(ka,{className:"mr-2 h-4 w-4"})," Delete Partner"]}),xe.meraki_link?l.jsxs(zi,{onClick:()=>{navigator.clipboard.writeText(xe.meraki_link),t({title:" Link Copied",description:"Link copied to clipboard.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})},children:[l.jsx(hL,{className:"mr-2 h-4 w-4"})," Copy Meraki Link"]}):l.jsxs(zi,{onClick:()=>ft((p-1)*zf+Ie),children:[l.jsx(hL,{className:"mr-2 h-4 w-4"})," Generate Link"]})]})]})})]},xe.id))})]})}),l.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-t bg-muted/20",children:[l.jsxs("div",{className:"text-xs text-muted-foreground",children:["Showing ",l.jsx("strong",{children:(p-1)*zf+1})," to ",l.jsx("strong",{children:Math.min(p*zf,te.length)})," of ",l.jsx("strong",{children:te.length})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:()=>f(xe=>Math.max(1,xe-1)),disabled:p===1,className:"h-8",children:"Previous"}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>f(xe=>Math.min(ve,xe+1)),disabled:p===ve,className:"h-8",children:"Next"})]})]})]})]}),l.jsx(Wr,{open:_.open,onOpenChange:xe=>!xe&&kt(),children:l.jsxs(Vr,{className:"max-w-lg",children:[l.jsxs(Hr,{children:[l.jsx(qr,{children:"Add New Partner"}),l.jsx(yh,{children:"Enter the details of the new partner organization."})]}),l.jsxs("form",{onSubmit:nr,children:[l.jsxs("div",{className:"grid gap-4 py-4 max-h-[60vh] overflow-y-auto px-1",children:[l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{htmlFor:"name",children:["Partner Name ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"name",value:_.form.name,onChange:xe=>Vt("name",xe.target.value),placeholder:"e.g. NavGurukul",required:!0})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{children:["Emails ",l.jsx("span",{className:"text-destructive",children:"*"})]}),_.form.emails.map((xe,Ie)=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Ve,{type:"email",value:xe,onChange:Oe=>ur("emails",Ie,Oe.target.value),placeholder:"contact@example.com",required:!0}),_.form.emails.length>1&&l.jsx(le,{type:"button",variant:"ghost",size:"icon",onClick:()=>wr("emails",Ie),children:l.jsx(wa,{className:"h-4 w-4"})})]},Ie))]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{htmlFor:"slug",children:["Slug ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"slug",value:_.form.slug,onChange:xe=>Vt("slug",xe.target.value),placeholder:"unique-slug-id",required:!0}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Auto-generated from name. Must be unique."})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{htmlFor:"state",children:["State ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(sr,{options:q.map(xe=>({value:xe.state_code,label:xe.state_name})),value:_.form.state,onValueChange:xe=>Vt("state",xe),placeholder:"Select a state",searchPlaceholder:"Search states...",emptyText:"No state found.",className:"w-full"})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{children:["Districts ",l.jsx("span",{className:"text-destructive",children:"*"})]}),_.form.districts.map((xe,Ie)=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx(sr,{options:A.map(Oe=>({value:Oe.district_code,label:Oe.district_name})),value:xe,onValueChange:Oe=>ur("districts",Ie,Oe),placeholder:_.form.state?A.length===0?"Loading districts...":"Select district":"Select state first",searchPlaceholder:"Search districts...",emptyText:"No district found.",disabled:!_.form.state||A.length===0,className:"flex-1"}),_.form.districts.length>1&&l.jsx(le,{type:"button",variant:"ghost",size:"icon",onClick:()=>wr("districts",Ie),children:l.jsx(wa,{className:"h-4 w-4"})})]},Ie)),l.jsx(le,{variant:"link",size:"sm",onClick:()=>we("districts"),className:"justify-start px-0 text-primary",children:"+ Add another district"})]})]}),l.jsxs(fo,{children:[l.jsx(le,{type:"button",variant:"outline",onClick:kt,children:"Cancel"}),l.jsx(le,{type:"submit",children:"Add Partner"})]})]})]})}),l.jsx(Wr,{open:g.open,onOpenChange:xe=>!xe&&yt(),children:l.jsxs(Vr,{className:"max-w-lg",children:[l.jsx(Hr,{children:l.jsx(qr,{children:"Edit Partner"})}),l.jsxs("form",{onSubmit:He,children:[l.jsxs("div",{className:"grid gap-4 py-4 max-h-[60vh] overflow-y-auto px-1",children:[l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{htmlFor:"edit-name",children:["Partner Name ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-name",value:g.form.name,onChange:xe=>De("name",xe.target.value),required:!0})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{children:["Emails ",l.jsx("span",{className:"text-destructive",children:"*"})]}),g.form.emails.map((xe,Ie)=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Ve,{type:"email",value:xe,onChange:Oe=>Fe("emails",Ie,Oe.target.value),placeholder:"contact@example.com",required:!0}),g.form.emails.length>1&&l.jsx(le,{type:"button",variant:"ghost",size:"icon",onClick:()=>Ae("emails",Ie),children:l.jsx(wa,{className:"h-4 w-4"})})]},Ie))]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{htmlFor:"edit-slug",children:["Slug ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(Ve,{id:"edit-slug",value:g.form.slug,onChange:xe=>De("slug",xe.target.value),required:!0})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{htmlFor:"edit-state",children:["State ",l.jsx("span",{className:"text-destructive",children:"*"})]}),l.jsx(sr,{options:q.map(xe=>({value:xe.state_code,label:xe.state_name})),value:g.form.state,onValueChange:xe=>De("state",xe),placeholder:"Select a state",searchPlaceholder:"Search states...",emptyText:"No state found.",className:"w-full"})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsxs(Ee,{children:["Districts ",l.jsx("span",{className:"text-destructive",children:"*"})]}),g.form.districts.map((xe,Ie)=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx(sr,{options:A.map(Oe=>({value:Oe.district_code,label:Oe.district_name})),value:xe,onValueChange:Oe=>Fe("districts",Ie,Oe),placeholder:g.form.state?A.length===0?"Loading districts...":"Select district":"Select state first",searchPlaceholder:"Search districts...",emptyText:"No district found.",disabled:!g.form.state||A.length===0,className:"flex-1"}),g.form.districts.length>1&&l.jsx(le,{type:"button",variant:"ghost",size:"icon",onClick:()=>Ae("districts",Ie),children:l.jsx(wa,{className:"h-4 w-4"})})]},Ie)),l.jsx(le,{type:"button",variant:"link",size:"sm",onClick:()=>et("districts"),className:"justify-start px-0 text-primary",children:"+ Add another district"})]})]}),l.jsxs(fo,{children:[l.jsx(le,{type:"button",variant:"outline",onClick:yt,children:"Cancel"}),l.jsx(le,{type:"submit",children:"Save Changes"})]})]})]})}),l.jsx(Wr,{open:v,onOpenChange:b,children:l.jsxs(Vr,{children:[l.jsx(Hr,{children:l.jsx(qr,{children:"Filter Partners"})}),l.jsxs("div",{className:"grid gap-4 py-4",children:[l.jsxs("div",{className:"grid gap-2",children:[l.jsx(Ee,{children:"District"}),l.jsx(Ve,{value:N.district,onChange:xe=>S(Ie=>({...Ie,district:xe.target.value})),placeholder:"Filter by district"})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsx(Ee,{children:"Slug"}),l.jsx(Ve,{value:N.slug,onChange:xe=>S(Ie=>({...Ie,slug:xe.target.value})),placeholder:"Filter by slug"})]}),l.jsxs("div",{className:"grid gap-2",children:[l.jsx(Ee,{children:"Email Domain"}),l.jsx(Ve,{value:N.emailDomain,onChange:xe=>S(Ie=>({...Ie,emailDomain:xe.target.value})),placeholder:"e.g. gmail.com"})]})]}),l.jsxs(fo,{children:[l.jsx(le,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),l.jsx(le,{onClick:()=>b(!1),children:"Apply Filters"})]})]})}),l.jsx(Wr,{open:i,onOpenChange:o,children:l.jsxs(Vr,{className:"max-w-4xl max-h-[85vh] flex flex-col",children:[l.jsxs(Hr,{children:[l.jsxs(qr,{children:["Details for ",c==null?void 0:c.partner_name]}),l.jsx(yh,{children:"View students and assessments associated with this partner."})]}),l.jsx("div",{className:"flex-1 overflow-auto py-4 space-y-6",children:l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center gap-2",children:[l.jsx(xo,{className:"h-5 w-5"})," Created Assessments"]}),l.jsx("div",{className:"border rounded-md overflow-hidden",children:l.jsxs(yi,{children:[l.jsx(vi,{className:"bg-muted/50",children:l.jsxs(or,{children:[l.jsx(ct,{children:"Assessment Name"}),l.jsx(ct,{children:"Description"}),l.jsx(ct,{children:"Created At"})]})}),l.jsx(bi,{children:ae.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:3,className:"text-center text-muted-foreground h-20",children:"No assessments created for this partner yet."})}):ae.map(xe=>l.jsxs(or,{children:[l.jsx(Xe,{className:"font-medium",children:xe.name}),l.jsx(Xe,{children:xe.description}),l.jsx(Xe,{children:xe.created_at?new Date(xe.created_at).toLocaleDateString():"-"})]},xe.id))})]})})]})})]})}),l.jsx(Wr,{open:u,onOpenChange:xe=>{d(xe),xe&&Z({name:"",description:"",nameType:"random",isRandom:!0})},children:l.jsxs(Vr,{className:"sm:max-w-md",children:[l.jsx(Hr,{children:l.jsxs(qr,{children:["Create Assessment for ",c==null?void 0:c.partner_name]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{className:"mb-2 block",children:"Set Generation Method"}),l.jsx(sb,{value:J.nameType,onValueChange:xe=>{Z(Ie=>({...Ie,nameType:xe,isRandom:xe==="random"}))},className:"flex items-center gap-4 mb-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zd,{value:"random",id:"r-random"}),l.jsx(Ee,{htmlFor:"r-random",children:"Random"})]})})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"assessmentName",children:"Assessment Name"}),l.jsx(Ve,{id:"assessmentName",value:J.name,onChange:xe=>Z(Ie=>({...Ie,name:xe.target.value})),placeholder:"Enter assessment name"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"assessmentDesc",children:"Description"}),l.jsx(ps,{id:"assessmentDesc",value:J.description,onChange:xe=>Z(Ie=>({...Ie,description:xe.target.value})),placeholder:"Enter description (optional)"})]})]}),l.jsxs(fo,{children:[l.jsx(le,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),l.jsx(le,{onClick:async()=>{if(!J.name.trim()){t({title:" Assessment Name Required",description:"Please enter an assessment name",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{const xe={name:J.name,description:J.description||`Created for partner: ${c==null?void 0:c.partner_name}`,partnerId:c!=null&&c.id?parseInt(c.id):void 0,partner_name:c==null?void 0:c.partner_name,isRandom:!0};console.log("Creating Random Assessment Payload:",xe),await BN(xe),t({title:" Assessment Created",description:`Assessment "${J.name}" created for ${c==null?void 0:c.partner_name}`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),d(!1),Z({name:"",description:"",nameType:"random",isRandom:!0})}catch(xe){t({title:" Unable to Create Assessment",description:ut(xe),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},children:"Create"})]})]})})]})]})},Q9=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(!1),[i,o]=w.useState(null),[u,d]=w.useState(""),[c,h]=w.useState(1),p=10,[f,g]=w.useState(!1),[m,x]=w.useState(!1),[y,v]=w.useState(!1),[b,N]=w.useState(""),[S,_]=w.useState(""),[C,k]=w.useState(null),I=async(z=!1)=>{z&&n(!0);try{const $=await Gb();console.log("campus Data",$),t($)}catch($){o($ instanceof Error?$.message:"An unknown error occurred")}finally{z&&n(!1)}};w.useEffect(()=>{I(!0)},[]);const T=e.filter(z=>z.campus_name.toLowerCase().includes(u.toLowerCase())),j=Math.ceil(T.length/p),E=c*p,O=E-p,M=T.slice(O,E),W=()=>{c<j&&h(z=>z+1)},q=()=>{c>1&&h(z=>z-1)},P=async z=>{if(z.preventDefault(),e.some(V=>V.campus_name.toLowerCase()===b.toLowerCase().trim())){ds({title:" Duplicate Campus",description:"This campus name already exists. Please use a different name.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}s(!0);try{await vV(b),g(!1),N(""),ds({title:" Campus Added Successfully",description:`"${b}" has been added.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),await I(!1),h(1)}catch(V){ds({title:" Unable to Add Campus",description:ut(V),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{s(!1)}},A=async(z,$)=>{const V=e.find(Y=>Y.id===z),B=(V==null?void 0:V.campus_name)||"";s(!0);try{await bV(z,$),x(!1),k(null),ds({title:" Campus Updated",description:`Campus name updated from "${B}" to "${$}".`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),await I(!1)}catch(Y){ds({title:" Unable to Update Campus",description:ut(Y),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{s(!1)}},L=async(z,$)=>{var V,B,Y;s(!0);try{await wV(z),v(!1),k(null),ds({title:" Campus Deleted",description:`"${$}" has been deleted.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),await I(!1),h(1)}catch(re){const ae=((V=re==null?void 0:re.data)==null?void 0:V.message)||((Y=(B=re==null?void 0:re.response)==null?void 0:B.data)==null?void 0:Y.message)||(re==null?void 0:re.message)||"An unexpected error occurred.",J=ae.toLowerCase().includes("associated with")||ae.toLowerCase().includes("student records");ds({title:J?" Unable to Delete Campus":" Unable to Delete Campus",description:ae,variant:J?"default":"destructive",className:J?"border-orange-500 bg-orange-50 text-orange-900":"border-red-500 bg-red-50 text-red-900"})}finally{s(!1)}};return l.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[l.jsx(dn,{}),l.jsx("main",{className:"flex-1 p-4 md:p-8 pt-20 md:pt-8 md:ml-64",children:l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[l.jsxs("div",{children:[l.jsx(Lt,{className:"text-2xl",children:"Campuses Name"}),l.jsx(xi,{children:"A list of all the campuses."})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full md:w-auto",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(Ja,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l.jsx(Ve,{type:"search",placeholder:"Search campus...",className:"pl-8 w-full",value:u,onChange:z=>{d(z.target.value),h(1)}})]}),l.jsxs(le,{onClick:()=>g(!0),children:[l.jsx(Wn,{className:"mr-2 h-4 w-4"})," Add Campus"]})]})]})}),l.jsx(jt,{children:r?l.jsx("p",{children:"Loading..."}):i?l.jsx("p",{className:"text-red-500",children:i}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(yi,{children:[l.jsx(vi,{children:l.jsxs(or,{children:[l.jsx(ct,{children:"S.No"}),l.jsx(ct,{children:"Campus Name"}),l.jsx(ct,{className:"text-right",children:"Actions"})]})}),l.jsx(bi,{children:M.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:3,className:"text-center",children:"No campuses found."})}):M.map((z,$)=>l.jsxs(or,{children:[l.jsx(Xe,{children:O+$+1}),l.jsx(Xe,{className:"font-medium",children:l.jsx(SU,{to:`/campus/${z.id}`,className:"text-primary hover:underline",children:z.campus_name})}),l.jsxs(Xe,{className:"text-right space-x-2",children:[l.jsx(le,{variant:"ghost",size:"icon",className:"text-blue-600",onClick:()=>{k(z),_(z.campus_name),x(!0)},children:l.jsx(ru,{className:"w-4 h-4"})}),l.jsx(le,{variant:"ghost",size:"icon",className:"text-red-600",onClick:()=>{k(z),v(!0)},children:l.jsx(ka,{className:"w-4 h-4"})})]})]},z.id))})]})}),l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4 gap-2",children:[l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",T.length===0?0:O+1," "," ",Math.min(E,T.length)," of"," ",T.length]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:q,disabled:c===1,children:"Previous"}),l.jsx(le,{variant:"outline",size:"sm",onClick:W,disabled:c===j||j===0,children:"Next"})]})]})]})})]})}),f&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:l.jsxs("form",{onSubmit:P,className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[l.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Add Campus"}),l.jsx("input",{type:"text",placeholder:"Enter campus name",className:"border border-orange-300 px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:b,onChange:z=>N(z.target.value),required:!0}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded",onClick:()=>g(!1),children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded",children:"Add"})]})]})}),m&&C&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:l.jsxs("form",{onSubmit:z=>{z.preventDefault(),C&&A(C.id,S)},className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[l.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Update Campus"}),l.jsx("input",{type:"text",placeholder:"Enter campus name",className:"border border-orange-300 px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:S,onChange:z=>_(z.target.value),required:!0}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded",onClick:()=>{x(!1),k(null)},children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded",disabled:a,children:a?"Updating...":"Update"})]})]})}),y&&C&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-red-200",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-600 mb-4",children:"Confirm Deletion"}),l.jsxs("p",{children:["Are you sure you want to delete"," ",l.jsx("strong",{children:C.campus_name}),"?"]}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded",onClick:()=>{v(!1),k(null)},children:"Cancel"}),l.jsx("button",{className:"px-4 py-2 bg-red-600 text-white rounded",onClick:()=>{L(C.id,C.campus_name),v(!1),k(null)},children:"Delete"})]})]})})]})},X9=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(null),[i,o]=w.useState(""),[u,d]=w.useState(1),c=10,[h,p]=w.useState(!1),[f,g]=w.useState(!1),[m,x]=w.useState(!1),[y,v]=w.useState(""),[b,N]=w.useState(""),[S,_]=w.useState(null),C=A=>{var z,$;if((z=A==null?void 0:A.data)!=null&&z.message)return A.data.message;const L=((A==null?void 0:A.message)||"").toLowerCase();return L.includes("duplicate")||L.includes("already exists")?"This school name already exists. Please use a different name.":L.includes("network")||L.includes("fetch")?"Network error. Please check your connection and try again.":(($=A==null?void 0:A.data)==null?void 0:$.message)||"An error occurred. Please try again."};w.useEffect(()=>{(async()=>{n(!0),s(null);try{const L=await S_();t(L)}catch(L){s(L instanceof Error?L.message:"An unexpected error occurred while adding the schools")}finally{n(!1)}})()},[]);const k=e.filter(A=>(A.school_name||"").toLowerCase().includes(i.toLowerCase())),I=Math.ceil(k.length/c),T=u*c,j=T-c,E=k.slice(j,T),O=()=>{u<I&&d(A=>A+1)},M=()=>{u>1&&d(A=>A-1)},W=async A=>{var z;if(A.preventDefault(),e.some($=>$.school_name.toLowerCase()===y.toLowerCase().trim())){ds({title:" Duplicate School",description:"This school name already exists. Please use a different name.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{const $=await NV(y),V={id:$.id||((z=$.data)==null?void 0:z.id)||Date.now(),school_name:y};t(B=>[...B,V]),v(""),p(!1),ds({title:" School Added",description:`"${y}" has been added to the list.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch($){C($),ds({title:" Unable to Add School",description:ut($),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},q=async(A,L)=>{const z=e.find(V=>V.id===A),$=(z==null?void 0:z.school_name)||"";try{await SV(A,L),t(V=>V.map(B=>B.id===A?{...B,school_name:L}:B)),ds({title:" School Updated",description:`School name updated from "${$}" to "${L}".`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(V){C(V),ds({title:" Unable to Update School",description:ut(V),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},P=async(A,L)=>{var z,$,V;try{await _V(A),t(B=>B.filter(Y=>Y.id!==A)),ds({title:" School Deleted",description:`"${L}" has been removed.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(B){const Y=((z=B==null?void 0:B.data)==null?void 0:z.message)||((V=($=B==null?void 0:B.response)==null?void 0:$.data)==null?void 0:V.message)||(B==null?void 0:B.message)||C(B),re=Y&&(Y.toLowerCase().includes("existing student records")||Y.toLowerCase().includes("students before deletion")||Y.toLowerCase().includes("reassign or remove"));ds({title:re?" Cannot Delete School":" Unable to Delete School",description:ut(B),variant:re?"default":"destructive",className:re?"border-orange-500 bg-orange-50 text-orange-900":"border-red-500 bg-red-50 text-red-900"})}};return l.jsxs("div",{className:"flex flex-col md:flex-row min-h-screen bg-gray-50",children:[l.jsx(dn,{}),l.jsx("main",{className:"flex-1 p-4 md:p-8 pt-20 md:pt-8 md:ml-64",children:l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[l.jsxs("div",{children:[l.jsx(Lt,{className:"text-2xl",children:"Schools"}),l.jsx(xi,{children:"A list of all the schools."})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full md:w-auto",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(Ja,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l.jsx(Ve,{type:"search",placeholder:"Search school...",className:"pl-8 w-full",value:i,onChange:A=>{o(A.target.value),d(1)}})]}),l.jsxs(le,{onClick:()=>p(!0),children:[l.jsx(Wn,{className:"mr-2 h-4 w-4"})," Add School"]})]})]})}),l.jsx(jt,{children:r?l.jsx("p",{children:"Loading..."}):a?l.jsx("p",{className:"text-red-500",children:a}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(yi,{children:[l.jsx(vi,{children:l.jsxs(or,{children:[l.jsx(ct,{children:"S.No"}),l.jsx(ct,{children:"School Name"}),l.jsx(ct,{className:"text-right",children:"Actions"})]})}),l.jsx(bi,{children:E.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:4,className:"text-center",children:"No schools found."})}):E.map((A,L)=>l.jsxs(or,{children:[l.jsx(Xe,{children:j+L+1}),l.jsx(Xe,{className:"font-medium text-orange-600",children:A.school_name||"N/A"}),l.jsxs(Xe,{className:"text-right space-x-2",children:[l.jsx(le,{variant:"ghost",size:"icon",className:"text-blue-600",onClick:()=>{_(A),N(A.school_name),g(!0)},children:l.jsx(ru,{className:"w-4 h-4"})}),l.jsx(le,{variant:"ghost",size:"icon",className:"text-red-600",onClick:()=>{_(A),x(!0)},children:l.jsx(ka,{className:"w-4 h-4"})})]})]},A.id))})]})}),l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4 gap-2",children:[l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",k.length===0?0:j+1," ",Math.min(T,k.length)," of"," ",k.length]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:M,disabled:u===1,children:"Previous"}),l.jsx(le,{variant:"outline",size:"sm",onClick:O,disabled:u===I||I===0,children:"Next"})]})]})]})})]})}),h&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:l.jsxs("form",{onSubmit:W,className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[l.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Add School"}),l.jsx("input",{type:"text",placeholder:"Enter school name",className:"border border-orange-300 px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:y,onChange:A=>v(A.target.value),required:!0}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",onClick:()=>p(!1),children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors",children:"Add"})]})]})}),f&&S&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-orange-200",children:[l.jsx("h2",{className:"text-lg font-semibold mb-4 text-orange-700",children:"Update School"}),l.jsx("input",{type:"text",placeholder:"Enter school name",className:"border border-orange-300 px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",value:b,onChange:A=>N(A.target.value),required:!0}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",onClick:()=>{g(!1),_(null)},children:"Cancel"}),l.jsx("button",{className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors",onClick:()=>{S&&(q(S.id,b),g(!1),_(null))},children:"Update"})]})]})}),m&&S&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg border border-red-200",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-600 mb-4",children:"Confirm Deletion"}),l.jsxs("p",{children:["Are you sure you want to delete"," ",l.jsx("strong",{children:S.school_name}),"?"]}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",onClick:()=>{x(!1),_(null)},children:"Cancel"}),l.jsx("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",onClick:()=>{P(S.id,S.school_name),x(!1),_(null)},children:"Delete"})]})]})})]})};function Y9({status:e}){const t=r=>r!=null&&r.includes("Pass")||r==="Offer Accepted"||r==="Onboarded"||r==="Created Student Without Exam"?"bg-green-500/10 text-green-700 border-green-500/20":r!=null&&r.includes("Fail")||r==="Offer Declined"||r==="Duplicate"||r==="Unreachable"||r==="Became Disinterested"||r==="No Show"||r==="Selected but not joined"?"bg-red-500/10 text-red-700 border-red-500/20":r!=null&&r.includes("Pending")||r==="Offer Sent"||r==="Reschedule"||r==="Waitlisted"||r==="Enrollment Key Generated"||r==="Basic Details Entered"||r==="Pending Booking"?"bg-yellow-500/10 text-yellow-700 border-yellow-500/20":"bg-gray-500/10 text-gray-700 border-gray-500/20";return l.jsx("span",{className:Ue("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border",t(e)),children:e||"No Status"})}const J9=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(""),{toast:i}=Wt(),o=Rn();w.useEffect(()=>{d()},[]);const u=()=>{o("/schedule")},d=async()=>{try{n(!0);const f=await q1();t(f||[])}catch(f){console.error("Error fetching interview data:",f),i({title:" Unable to Load Interview Data",description:ut(f),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),t([])}finally{n(!1)}},c=async f=>{try{if(n(!0),s(f),f){const g=await q1(f);t(g||[])}else{const g=await q1();t(g||[])}}catch(g){console.error("Error fetching interviews by date:",g),i({title:" Unable to Load Interviews",description:ut(g),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),t([])}finally{n(!1)}},h=f=>{if(!f)return"N/A";try{let g;if(f.includes(":")&&!f.includes("T")){const m=new Date,[x,y]=f.split(":");g=new Date(m.getFullYear(),m.getMonth(),m.getDate(),parseInt(x),parseInt(y))}else g=new Date(f);return isNaN(g.getTime())?f:g.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(g){return console.error("Error formatting time:",f,g),f}},p=f=>{if(!f)return"N/A";try{const g=new Date(f);return isNaN(g.getTime())?f:g.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(g){return console.error("Error formatting date:",f,g),f}};return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Interviews"}),l.jsx("p",{className:"text-muted-foreground",children:"Manage interview schedules and feedback"})]}),l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border",children:[l.jsx("div",{className:"p-6 border-b border-border",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[l.jsxs("h2",{className:"text-xl font-semibold text-foreground",children:["Interview Records",a&&l.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:["(Filtered by: ",p(a),")"]})]}),l.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[l.jsxs("div",{className:"flex items-center gap-2",children:["Select Date",l.jsx("input",{type:"date",value:a,onChange:f=>c(f.target.value),className:"px-3 py-2 border border-border rounded-lg bg-background text-foreground"}),a&&l.jsx(le,{variant:"outline",size:"sm",onClick:()=>c(""),children:"Clear"})]}),l.jsxs(le,{className:"bg-gradient-primary hover:bg-primary/90 text-white",onClick:u,children:[l.jsx($a,{className:"w-4 h-4 mr-2"}),"Manage Available Slots"]})]})]})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-muted/30",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant Name"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Email"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Title"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Date"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Start Time"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"End Time"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),l.jsx("tbody",{children:r?l.jsx("tr",{children:l.jsx("td",{colSpan:8,className:"p-4 text-center text-muted-foreground",children:"Loading interviews..."})}):e.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:8,className:"p-4 text-center text-muted-foreground",children:a?"No interviews found for selected date":"No interview records found"})}):e.map(f=>l.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[l.jsx("td",{className:"p-4",children:l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("span",{className:"font-medium text-foreground",children:f.student_name||`Student #${f.student_id}`})})}),l.jsx("td",{className:"p-4",children:l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("span",{className:"text-sm text-foreground",children:f.student_email||"N/A"})})}),l.jsx("td",{className:"p-4",children:l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("span",{className:"text-sm text-foreground",children:f.title||"Interview"})})}),l.jsx("td",{className:"p-4",children:l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("span",{className:"text-sm text-foreground",children:p(f.date||f.start_time)})})}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ya,{className:"w-4 h-4 text-muted-foreground"}),l.jsx("span",{className:"text-sm text-foreground",children:h(f.start_time)})]})}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ya,{className:"w-4 h-4 text-muted-foreground"}),l.jsx("span",{className:"text-sm text-foreground",children:h(f.end_time)})]})}),l.jsx("td",{className:"p-4",children:l.jsx(Y9,{status:f.status})}),l.jsx("td",{className:"p-4",children:l.jsx(le,{className:"bg-orange-500 hover:bg-orange-600 text-white",size:"sm",onClick:()=>f.meeting_link&&window.open(f.meeting_link,"_blank"),disabled:!f.meeting_link,children:"Join Meeting"})})]},f.id))})]})})]})]})})]})};var LSe="Separator",V3="horizontal",zSe=["horizontal","vertical"],Z9=w.forwardRef((e,t)=>{const{decorative:r,orientation:n=V3,...a}=e,s=BSe(n)?n:V3,o=r?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return l.jsx(at.div,{"data-orientation":s,...o,...a,ref:t})});Z9.displayName=LSe;function BSe(e){return zSe.includes(e)}var e7=Z9;const t7=w.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},a)=>l.jsx(e7,{ref:a,decorative:r,orientation:t,className:Ue("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));t7.displayName=e7.displayName;function USe({questionType:e,options:t,correctAnswer:r,onOptionsChange:n,onCorrectAnswerChange:a}){const[s,i]=w.useState(t||{english:["","","",""],hindi:["","","",""],marathi:["","","",""]}),[o,u]=w.useState(r||0);w.useEffect(()=>{t&&i(t),typeof r=="number"&&u(r)},[t,r]);const d=(m,x,y)=>{const v={...s,[m]:[...s[m]]};v[m][x]=y,i(v),n(v)},c=()=>{const m={english:[...s.english,""],hindi:[...s.hindi,""],marathi:[...s.marathi,""]};i(m),n(m)},h=m=>{if(s.english.length<=2)return;const x={english:s.english.filter((y,v)=>v!==m),hindi:s.hindi.filter((y,v)=>v!==m),marathi:s.marathi.filter((y,v)=>v!==m)};i(x),n(x),o>=x.english.length&&(u(0),a(0))},p=m=>{u(m),a(m)},f=m=>{a(m==="true"?1:0)},g=m=>{a(m)};return e==="MCQ"?l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Multiple Choice Options"})}),l.jsxs(jt,{className:"space-y-4",children:[l.jsx(sb,{value:o.toString(),onValueChange:m=>p(parseInt(m)),children:s.english.map((m,x)=>l.jsxs("div",{className:"flex gap-2 items-center",children:[l.jsx(Zd,{value:x.toString()}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 flex-1",children:[l.jsx(Ve,{value:s.english[x],onChange:y=>d("english",x,y.target.value),placeholder:`EN Option ${x+1}`}),l.jsx(Ve,{value:s.hindi[x],onChange:y=>d("hindi",x,y.target.value),placeholder:`HI Option ${x+1}`}),l.jsx(Ve,{value:s.marathi[x],onChange:y=>d("marathi",x,y.target.value),placeholder:`MR Option ${x+1}`})]}),s.english.length>2&&l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h(x),children:l.jsx(ka,{className:"w-4 h-4"})})]},x))}),l.jsxs(le,{type:"button",variant:"outline",onClick:c,children:[l.jsx(Wn,{className:"w-4 h-4 mr-2"})," Add Option"]})]})]}):e==="true_false"?l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"True/False Answer"})}),l.jsx(jt,{children:l.jsxs(sb,{value:r===1?"true":"false",onValueChange:f,children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zd,{value:"true"}),l.jsx(Ee,{children:"True"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zd,{value:"false"}),l.jsx(Ee,{children:"False"})]})]})})]}):e==="short_answer"||e==="fill_in_blank"?l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Expected Answer"})}),l.jsx(jt,{children:l.jsx(Ve,{value:r||"",onChange:m=>g(m.target.value),placeholder:"Enter the expected answer"})})]}):e==="long_answer"?l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Sample Answer / Grading Criteria"})}),l.jsx(jt,{children:l.jsx(ps,{value:r||"",onChange:m=>g(m.target.value),placeholder:"Provide a sample answer or grading criteria",rows:4})})]}):e==="coding"?l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Expected Solution"})}),l.jsx(jt,{children:l.jsx(ps,{value:r||"",onChange:m=>g(m.target.value),placeholder:"Provide the expected code solution",rows:6,className:"font-mono"})})]}):null}function WSe({question:e,onSave:t,onCancel:r,setSelectedQuestion:n,difficultyLevels:a}){const{toast:s}=Wt(),[i,o]=w.useState({question_type:"MCQ",difficulty_level:"",points:0,question_text:{english:"",hindi:"",marathi:""},options:{english:["","","",""],hindi:["","","",""],marathi:["","","",""]},correct_answer:0,explanation:""});w.useEffect(()=>{var p,f;if(!e){n(null);return}const h=a.find(g=>g.id===e.difficulty_level);o({question_type:e.question_type??"MCQ",difficulty_level:((p=e.difficulty_level)==null?void 0:p.toString())??"",points:(h==null?void 0:h.points)??0,question_text:{english:e.english_text??"",hindi:e.hindi_text??"",marathi:e.marathi_text??""},options:{english:e.english_options??["","","",""],hindi:e.hindi_options??["","","",""],marathi:e.marathi_options??["","","",""]},correct_answer:((f=e.answer_key)==null?void 0:f[0])??0,explanation:e.explanation??""})},[e,a]);const u=(h,p)=>o(f=>({...f,[h]:p})),d=(h,p)=>o(f=>({...f,question_text:{...f.question_text,[h]:p}})),c=h=>{if(h.preventDefault(),!i.question_type){s({title:" Required field",description:"Select a question type",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!i.difficulty_level){s({title:" Required field",description:"Select difficulty level",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!i.question_text.english.trim()){s({title:" Required field",description:"Please enter the question text in English, Hindi, and Marathi",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!i.question_text.hindi.trim()){s({title:" Required field",description:"Enter question text in Hindi and Marathi",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!i.question_text.marathi.trim()){s({title:" Required field",description:"Enter question text in Marathi",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(i.question_type==="MCQ"){const{english:f,hindi:g,marathi:m}=i.options;if(f.some(y=>!y.trim())||g.some(y=>!y.trim())||m.some(y=>!y.trim())){s({title:" Required field",description:"All MCQ options must be filled in all languages",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(i.correct_answer===null||i.correct_answer===void 0){s({title:" Required field",description:"Select the correct answer",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}}const p={difficulty_level:i.difficulty_level,question_type:i.question_type,english_text:i.question_text.english,hindi_text:i.question_text.hindi,marathi_text:i.question_text.marathi,english_options:i.options.english,hindi_options:i.options.hindi,marathi_options:i.options.marathi,answer_key:[i.correct_answer],explanation:i.explanation};t(p)};return l.jsxs("form",{onSubmit:c,className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{children:"Question Type"}),l.jsxs(Gr,{value:i.question_type,onValueChange:h=>u("question_type",h),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select type"})}),l.jsx(Or,{children:l.jsx(gt,{value:"MCQ",children:"Multiple Choice"})})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Difficulty"}),l.jsxs(Gr,{value:i.difficulty_level,onValueChange:h=>{u("difficulty_level",h);const p=a.find(f=>f.id.toString()===h);p&&u("points",p.points)},children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select difficulty"})}),l.jsx(Or,{children:a.map(h=>l.jsx(gt,{value:h.id.toString(),children:h.name},h.id))})]})]})]}),l.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.jsxs("div",{children:[l.jsx(Ee,{children:"Points"}),l.jsx(Ve,{type:"number",min:1,value:i.points,disabled:!0})]})}),l.jsx(t7,{}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{children:"Question Text (English)"}),l.jsx(ps,{value:i.question_text.english,onChange:h=>d("english",h.target.value),placeholder:"Enter question text in English"})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Question Text (Hindi)"}),l.jsx(ps,{value:i.question_text.hindi,onChange:h=>d("hindi",h.target.value),placeholder:"Enter question text in Hindi"})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Question Text (Marathi)"}),l.jsx(ps,{value:i.question_text.marathi,onChange:h=>d("marathi",h.target.value),placeholder:"Enter question text in Marathi"})]})]}),i.question_type==="MCQ"&&l.jsx(USe,{questionType:i.question_type,options:i.options,correctAnswer:i.correct_answer,onOptionsChange:h=>u("options",h),onCorrectAnswerChange:h=>u("correct_answer",h)}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Explanation (Optional)"}),l.jsx(ps,{value:i.explanation,onChange:h=>u("explanation",h.target.value),placeholder:"Provide an explanation for the correct answer...",rows:3})]}),l.jsxs("div",{className:"flex items-center justify-end gap-4",children:[e&&l.jsxs(le,{type:"button",variant:"outline",onClick:r,children:[l.jsx(wa,{className:"w-4 h-4 mr-2"})," Cancel"]}),l.jsxs(le,{type:"submit",children:[l.jsx(Ag,{className:"w-4 h-4 mr-2"}),e?"Update Question":"Create Question"]})]})]})}function VSe({questions:e,loading:t,onEdit:r,onArchive:n,onDelete:a}){const s=o=>o<=1?{label:"Easy",color:"bg-green-100 text-green-800"}:o===2?{label:"Medium",color:"bg-yellow-100 text-yellow-800"}:{label:"Hard",color:"bg-red-100 text-red-800"},i=o=>({MCQ:"Multiple Choice",TrueFalse:"True/False",ShortAnswer:"Short Answer",LongAnswer:"Long Answer",Coding:"Coding",FillInBlank:"Fill in Blank"})[o]||o;return t?l.jsx("div",{className:"space-y-4",children:[...Array(5)].map((o,u)=>l.jsx(Et,{children:l.jsx(jt,{className:"p-4",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),l.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})})},u))}):e.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-muted-foreground",children:"No questions found"})}):l.jsx("div",{className:"space-y-4",children:e.map(o=>{const u=s(o.difficulty_level);return l.jsx(Et,{children:l.jsx(jt,{className:"p-4",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(Kn,{className:u.color,children:u.label}),l.jsx(Kn,{variant:"outline",children:i(o.question_type)}),o.points&&l.jsxs(Kn,{variant:"outline",children:[o.points," pts"]})]}),l.jsx("h3",{className:"font-medium text-sm mb-2",children:l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"EN:"})," ",o.english_text]}),l.jsxs("div",{children:[l.jsx("strong",{children:"HI:"})," ",o.hindi_text]}),l.jsxs("div",{children:[l.jsx("strong",{children:"MR:"})," ",o.marathi_text]})]})}),l.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[l.jsxs("span",{children:["Created:"," ",Nn(new Date(o.created_at),"MMM dd, yyyy")]}),o.version_number&&l.jsxs("span",{children:["Version: ",o.version_number]})]})]}),l.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>r(o),title:"Edit",children:l.jsx(xl,{className:"w-4 h-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>a(o.id),title:"Delete Permanently",className:"text-red-600 hover:text-red-700",children:l.jsx(ka,{className:"w-4 h-4"})})]})]})})},o.id)})})}const HSe=Mb("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),r7=w.forwardRef(({className:e,variant:t,...r},n)=>l.jsx("div",{ref:n,role:"alert",className:Ue(HSe({variant:t}),e),...r}));r7.displayName="Alert";const qSe=w.forwardRef(({className:e,...t},r)=>l.jsx("h5",{ref:r,className:Ue("mb-1 font-medium leading-none tracking-tight",e),...t}));qSe.displayName="AlertTitle";const n7=w.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ue("text-sm [&_p]:leading-relaxed",e),...t}));n7.displayName="AlertDescription";function GSe({onImportComplete:e}){const[t,r]=w.useState(""),[n,a]=w.useState([]),[s,i]=w.useState("idle"),[o,u]=w.useState(0),[d,c]=w.useState({success:0,errors:0,duplicates:0}),[h,p]=w.useState([]),{toast:f}=Wt(),{user:g}=Do(),m=()=>{const N=["difficulty_level,question_type,english_text,hindi_text,marathi_text,english_options,hindi_options,marathi_options,answer_key,topic",'1,MCQ,"What is 2+2?","2+2  ?","2+2  ?","[""2"",""3"",""4"",""5""]","["""","""","""",""""]","["""","""","""",""""]","[2]",1','2,MCQ,"Capital of India?","  ?"," ?","[""Mumbai"",""Delhi"",""Kolkata"",""Chennai""]","["""","""","""",""""]","["""","""","""",""""]","[1]",1','3,MCQ,"How many sides in hexagon?","   ?","  ?","[""5"",""6"",""7"",""8""]","["""","""","""",""""]","["""","""","""",""""]","[1]",1'].join(`
`),S=new Blob([N],{type:"text/csv"}),_=window.URL.createObjectURL(S),C=document.createElement("a");C.href=_,C.download="multi_language_question_template.csv",C.click(),window.URL.revokeObjectURL(_)},x=()=>{if(!t.trim()){f({title:" No Data",description:"Please paste CSV data or upload a file",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}i("parsing"),a8.parse(t,{header:!0,skipEmptyLines:!0,complete:N=>{if(N.errors.length>0){p(N.errors.map(C=>C.message)),i("error");return}const S=[],_=[];N.data.forEach((C,k)=>{try{if(!C.english_text||!C.question_type||!C.answer_key){_.push(`Row ${k+1}: Missing required fields (english_text, question_type, answer_key)`);return}const I=["MCQ","TF","SA","multiple_choice","true_false","short_answer"];if(!I.includes(C.question_type)){_.push(`Row ${k+1}: Invalid question_type. Must be one of: ${I.join(", ")}`);return}let T=[],j=[],E=[],O=null;try{C.english_options&&C.english_options.trim()&&(T=JSON.parse(C.english_options)),C.hindi_options&&C.hindi_options.trim()&&(j=JSON.parse(C.hindi_options)),C.marathi_options&&C.marathi_options.trim()&&(E=JSON.parse(C.marathi_options)),O=JSON.parse(C.answer_key)}catch{_.push(`Row ${k+1}: Invalid JSON format in options or answer_key`);return}const W={MCQ:"multiple_choice",TF:"true_false",SA:"short_answer"}[C.question_type]||C.question_type,q={1:"easy",2:"medium",3:"hard",easy:"easy",medium:"medium",hard:"hard"},P={english_text:C.english_text,hindi_text:C.hindi_text||"",marathi_text:C.marathi_text||"",question_text:C.english_text,question_type:W,english_options:T,hindi_options:j,marathi_options:E,options:T.map((A,L)=>({id:(L+1).toString(),text:A})),correct_answer:O,answer_key:O,explanation:"",difficulty_level:q[C.difficulty_level]||"medium",language:"multi",points:1,tags:[],time_limit_seconds:30,topic:C.topic||"1",status:!0};S.push(P)}catch(I){_.push(`Row ${k+1}: ${I.message}`)}}),_.length>0?(p(_),i("error")):(a(S),i("parsed"),f({title:" CSV Parsed Successfully",description:`Found ${S.length} valid questions`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}))},error:N=>{p([N.message]),i("error")}})},y=async()=>{var N,S,_,C,k,I,T,j,E,O;if(!t.trim()){f({title:" No Data",description:"Please parse CSV data first",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(i("importing"),u(0),!(g!=null&&g.id)){f({title:" Authentication Error",description:"You must be logged in to import questions",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"}),i("error");return}try{const M=setInterval(()=>{u(q=>q>=90?(clearInterval(M),90):q+10)},200),W=await xV(t);clearInterval(M),u(100),c({success:((N=W.data)==null?void 0:N.success)||W.success||n.length,errors:((_=(S=W.data)==null?void 0:S.errors)==null?void 0:_.length)||((C=W.errors)==null?void 0:C.length)||0,duplicates:((k=W.data)==null?void 0:k.duplicates)||W.duplicates||0}),((T=(I=W.data)==null?void 0:I.errors)!=null&&T.length||(j=W.errors)!=null&&j.length)&&p(((E=W.data)==null?void 0:E.errors)||W.errors||[]),i("complete"),f({title:" Import Complete",description:`Successfully imported ${((O=W.data)==null?void 0:O.success)||W.success||n.length} questions.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),e()}catch(M){console.error("Import error:",M);const W=ut(M);p([W]),i("error"),f({title:" Import Failed",description:W,variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},v=N=>{var C;const S=(C=N.target.files)==null?void 0:C[0];if(!S)return;if(S.type!=="text/csv"&&!S.name.endsWith(".csv")){f({title:" Invalid File",description:"Please upload a CSV file",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const _=new FileReader;_.onload=k=>{var I;typeof((I=k.target)==null?void 0:I.result)=="string"&&r(k.target.result)},_.readAsText(S)},b=()=>{r(""),a([]),i("idle"),u(0),c({success:0,errors:0,duplicates:0}),p([])};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs(r7,{children:[l.jsx(pn,{className:"h-4 w-4"}),l.jsx(n7,{children:"Import questions in bulk using CSV. Supports English/Hindi/Marathi text and options. Follow the template format."})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs(le,{variant:"outline",onClick:m,children:[l.jsx(Fi,{className:"w-4 h-4 mr-2"})," Download Template"]}),l.jsxs("div",{children:[l.jsx("input",{type:"file",accept:".csv",onChange:v,className:"hidden",id:"csv-upload"}),l.jsxs(le,{variant:"outline",onClick:()=>{var N;return(N=document.getElementById("csv-upload"))==null?void 0:N.click()},children:[l.jsx($g,{className:"w-4 h-4 mr-2"})," Upload CSV File"]})]}),s!=="idle"&&l.jsx(le,{variant:"outline",onClick:b,children:"Reset"})]}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"CSV Data"})}),l.jsxs(jt,{children:[l.jsx(ps,{value:t,onChange:N=>r(N.target.value),placeholder:"Paste CSV data or upload a file...",rows:10,className:"font-mono text-sm"}),l.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[l.jsx(le,{onClick:x,disabled:!t.trim()||s==="parsing",children:s==="parsing"?"Parsing...":"Parse CSV Data"}),s==="parsed"&&l.jsxs(le,{onClick:y,children:["Import ",n.length," Questions"]})]}),s==="parsed"&&l.jsx("div",{className:"mt-4",children:l.jsxs(Kn,{variant:"secondary",children:[n.length," questions ready for import"]})})]})]}),s==="importing"&&l.jsx(Et,{children:l.jsx(jt,{className:"p-6",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium",children:"Importing questions..."}),l.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(o),"%"]})]}),l.jsx(tR,{value:o,className:"w-full"})]})})}),s==="complete"&&l.jsx(Et,{children:l.jsxs(jt,{className:"p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Xd,{className:"w-5 h-5 text-green-600"}),l.jsx("h3",{className:"font-medium",children:"Import Complete"})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.success}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Successful"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:d.duplicates}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Duplicates"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.errors}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Errors"})]})]})]})}),h.length>0&&l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{className:"text-red-600",children:"Import Errors"})}),l.jsx(jt,{children:l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:h.map((N,S)=>l.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:N},S))})})]})]})}function KSe({filters:e,onFiltersChange:t,difficultyLevels:r}){const n=(s,i)=>{t({...e,[s]:i})},a=()=>{t({status:"All",difficulty_level:"All",question_type:"All",topic:""})};return l.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"font-medium",children:"Filters"}),l.jsx(le,{variant:"ghost",size:"sm",onClick:a,children:"Clear All"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{children:"Difficulty"}),l.jsxs(Gr,{value:e.difficulty_level||"All",onValueChange:s=>n("difficulty_level",s),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"All levels"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"All",children:"All"}),r.map(s=>l.jsx(gt,{value:s.id.toString(),children:s.name},s.id))]})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{children:"Question Type"}),l.jsxs(Gr,{value:e.question_type||"All",onValueChange:s=>n("question_type",s),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"All types"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"All",children:"All"}),l.jsx(gt,{value:"MCQ",children:"Multiple Choice"})]})]})]})]})]})}const QSe="https://dev-new-admissions.navgurukul.org/api/v1",XSe=()=>{try{return localStorage.getItem("authToken")}catch(e){return console.error("Error accessing localStorage:",e),null}},YSe=()=>{const e=XSe();return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}},Oy=async(e,t={},r=8e3)=>{const n=new AbortController,a=setTimeout(()=>n.abort(),r),s=`${QSe}${e}`;try{const i=await fetch(s,{...t,signal:n.signal,headers:YSe()});if(clearTimeout(a),!i.ok){const o=await i.json().catch(()=>({}));throw new Error(o.message||`HTTP error! status: ${i.status}`)}return await i.json()}catch(i){throw clearTimeout(a),i.name==="AbortError"?new Error("Request timed out"):i}},JSe={async createDifficultyLevel(e){try{const t=H3.validateDifficultyLevel(e);if(t.length>0)throw new Error(t.join(", "));return await Oy("/difficulty-levels/createDifficultyLevels",{method:"POST",body:JSON.stringify(e)})}catch(t){throw console.error("Create difficulty level error:",t),new Error(t.message||"Failed to create difficulty level")}},async getDifficultyLevels(){try{return await Oy("/difficulty-levels/getDifficultyLevels")}catch(e){throw console.error("Get difficulty levels error:",e),new Error(e.message||"Failed to fetch difficulty levels")}},async getDifficultyLevelById(e){try{return await Oy(`/difficulty-levels/getDifficultyLevelsById/${e}`)}catch(t){throw console.error("Get difficulty level by ID error:",t),new Error(t.message||"Failed to fetch difficulty level")}},async updateDifficultyLevel(e,t){try{if(t.name){const r=H3.validateDifficultyLevel({name:t.name,description:t.description||""});if(r.length>0)throw new Error(r.join(", "))}return await Oy(`/difficulty-levels/updateDifficultyLevels/${e}`,{method:"PUT",body:JSON.stringify(t)})}catch(r){throw console.error("Update difficulty level error:",r),new Error(r.message||"Failed to update difficulty level")}},async deleteDifficultyLevel(e){try{await Oy(`/difficulty-levels/deleteDifficultyLevels/${e}`,{method:"DELETE"})}catch(t){throw console.error("Delete difficulty level error:",t),new Error(t.message||"Failed to delete difficulty level")}},async getActiveDifficultyLevels(){try{return(await this.getDifficultyLevels()).filter(t=>t.status)}catch(e){throw console.error("Get active difficulty levels error:",e),new Error(e.message||"Failed to fetch active difficulty levels")}},async toggleDifficultyLevelStatus(e,t){return this.updateDifficultyLevel(e,{status:!t})}},H3={validateDifficultyLevelName:e=>e.length>=2&&e.length<=50,getDifficultyColor(e){return{easy:"bg-green-100 text-green-800 border-green-200",medium:"bg-yellow-100 text-yellow-800 border-yellow-200",hard:"bg-red-100 text-red-800 border-red-200",beginner:"bg-blue-100 text-blue-800 border-blue-200",intermediate:"bg-orange-100 text-orange-800 border-orange-200",advanced:"bg-purple-100 text-purple-800 border-purple-200",expert:"bg-gray-100 text-gray-800 border-gray-200"}[e.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-200"},getDifficultyLabel(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},validateDifficultyLevel(e){const t=[];return!e.name||e.name.trim().length===0?t.push("Name is required"):this.validateDifficultyLevelName(e.name)||t.push("Name must be between 2-50 characters"),e.description&&e.description.length>500&&t.push("Description must be less than 500 characters"),t}};function ZSe(e={},t=""){const[r,n]=w.useState([]),[a,s]=w.useState(!0),[i,o]=w.useState([]),{toast:u}=Wt();w.useEffect(()=>{(async()=>{var y;try{const v=await JSe.getDifficultyLevels(),b=Array.isArray((y=v.data)==null?void 0:y.data)?v.data.data.map(N=>({id:N.id,name:N.name,points:N.marks??0})):[];o(b)}catch(v){console.error("Failed to fetch difficulty levels:",v),o([])}})()},[]);const d=x=>{const y=i.find(v=>v.id===Number(x)||v.name.toLowerCase()===String(x).toLowerCase());return y?y.name.toLowerCase():"unknown"},c=async()=>{try{s(!0);const y=(await oV()).filter(v=>{var N;const b=d(v.difficulty_level);return!(e.difficulty_level&&e.difficulty_level!=="All"&&String(v.difficulty_level)!==String(e.difficulty_level)||e.question_type&&e.question_type!=="All"&&v.question_type!==e.question_type||t&&!((N=v.english_text)!=null&&N.toLowerCase().includes(t.toLowerCase())))});n(y)}catch(x){console.error("Error fetching questions:",x),u({title:" Unable to Load Questions",description:ut(x),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{s(!1)}},h=async x=>{try{await iV(x),await c()}catch(y){throw u({title:" Unable to Create Question",description:ut(y),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),y}},p=async(x,y)=>{try{await uV(x,y),await c()}catch(v){throw u({title:" Unable to Update Question",description:ut(v),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),v}},f=async x=>{try{await lV(Number(x)),await c()}catch(y){throw u({title:" Unable to Delete Question",description:ut(y),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),y}},g=async x=>{await c()},m=async x=>{await c()};return w.useEffect(()=>{c()},[e,t]),{questions:r,loading:a,createQuestion:h,updateQuestion:p,deleteQuestion:f,archiveQuestion:g,restoreQuestion:m,refetch:c,difficultyLevels:i,getDifficultyLabel:d}}const yR=({isOpen:e,onClose:t,onConfirm:r,title:n,description:a,confirmText:s="Delete",cancelText:i="Cancel",isLoading:o=!1})=>l.jsx(k$,{open:e,onOpenChange:t,children:l.jsxs(M_,{children:[l.jsxs(F_,{children:[l.jsx(P_,{children:n}),l.jsx(L_,{className:"whitespace-pre-line",children:a})]}),l.jsxs(O_,{children:[l.jsx(B_,{disabled:o,children:i}),l.jsx(z_,{onClick:r,disabled:o,className:"bg-destructive hover:bg-destructive/90",children:o?"Deleting...":s})]})]})});function e_e({activeSet:e,onClose:t,onSave:r,difficultyLevel:n}){const{toast:a}=Wt(),[s,i]=w.useState([]),[o,u]=w.useState(e.questions||[]),[d,c]=w.useState(""),[h,p]=w.useState(null),[f,g]=w.useState(!1);w.useEffect(()=>{if(!(e!=null&&e.name))return;(async()=>{g(!0);try{const _=await Yv(e.name),C=await Yv("Remaining"),k=[..._.data||[],...C.data||[]];i(k),u(e.questions||[])}catch(_){console.error("Failed to fetch questions:",_)}finally{g(!1)}})()},[e]);const m=S=>{u(_=>{var j;if(_.find(E=>E.id===S.id))return _.filter(E=>E.id!==S.id);if(_.length>=18)return a({title:" Maximum Questions Reached",description:"You cannot select more than 18 questions.",variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"}),_;const k=_.reduce((E,O)=>{var q;const M=(q=x[O.difficulty_level])==null?void 0:q.name.toLowerCase();return E+(M==="easy"?1:M==="medium"?2:M==="hard"?3:0)},0),I=(j=x[S.difficulty_level])==null?void 0:j.name.toLowerCase();return k+(I==="easy"?1:I==="medium"?2:I==="hard"?3:0)>36?(a({title:" Maximum Marks Exceeded",description:`Adding this question would exceed 36 marks. Current: ${k} marks.`,variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"}),_):[..._,S]})},x=Array.isArray(n)?n.reduce((S,_)=>(S[_.id]=_,S),{}):{},y=S=>{var C;switch((((C=x[S])==null?void 0:C.name)||"Unknown").toLowerCase()){case"easy":return"bg-green-100 text-green-700";case"medium":return"bg-yellow-100 text-yellow-700";case"hard":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-600"}},v=w.useMemo(()=>s.filter(S=>{const _=S.english_text.toLowerCase().includes(d.toLowerCase())||S.hindi_text.toLowerCase().includes(d.toLowerCase())||S.marathi_text.toLowerCase().includes(d.toLowerCase()),C=h===null||S.difficulty_level===h;return _&&C}),[s,d,h]),b=()=>{const S=o.filter(I=>{var T;return((T=x[I.difficulty_level])==null?void 0:T.name.toLowerCase())==="easy"}).length,_=o.filter(I=>{var T;return((T=x[I.difficulty_level])==null?void 0:T.name.toLowerCase())==="medium"}).length,C=o.filter(I=>{var T;return((T=x[I.difficulty_level])==null?void 0:T.name.toLowerCase())==="hard"}).length;if(S!==5){const I=5-S;a({title:" Easy Questions Required",description:S<5?`You have ${S} Easy question${S!==1?"s":""}. Please select ${I} more Easy question${I>1?"s":""}.`:`You have ${S} Easy questions. Please remove ${Math.abs(I)} Easy question${Math.abs(I)>1?"s":""}.`,variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(_!==8){const I=8-_;a({title:" Medium Questions Required",description:_<8?`You have ${_} Medium question${_!==1?"s":""}. Please select ${I} more Medium question${I>1?"s":""}.`:`You have ${_} Medium questions. Please remove ${Math.abs(I)} Medium question${Math.abs(I)>1?"s":""}.`,variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(C!==5){const I=5-C;a({title:" Hard Questions Required",description:C<5?`You have ${C} Hard question${C!==1?"s":""}. Please select ${I} more Hard question${I>1?"s":""}.`:`You have ${C} Hard questions. Please remove ${Math.abs(I)} Hard question${Math.abs(I)>1?"s":""}.`,variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const k=o.length;if(k<18){const I=18-k;a({title:" Minimum Questions Required",description:`You have selected ${k} question${k!==1?"s":""}. Please select ${I} more question${I>1?"s":""} to reach minimum of 18.`,variant:"destructive",className:"border-orange-500 bg-orange-50 text-orange-900"});return}r(o),t()},N=w.useMemo(()=>{const S=o.filter(j=>{var E;return((E=x[j.difficulty_level])==null?void 0:E.name.toLowerCase())==="easy"}),_=o.filter(j=>{var E;return((E=x[j.difficulty_level])==null?void 0:E.name.toLowerCase())==="medium"}),C=o.filter(j=>{var E;return((E=x[j.difficulty_level])==null?void 0:E.name.toLowerCase())==="hard"}),k=S.length*1,I=_.length*2,T=C.length*3;return{total:o.length,easy:S.length,medium:_.length,hard:C.length,totalMarks:k+I+T,easyMarks:k,mediumMarks:I,hardMarks:T}},[o,x]);return l.jsx(Wr,{open:!0,onOpenChange:t,children:l.jsxs(Vr,{className:"max-w-2xl",children:[l.jsx(Hr,{children:l.jsxs(qr,{children:["Choose Questions for"," ",l.jsx("span",{className:"font-semibold",children:e.name})]})}),l.jsxs("div",{className:"flex gap-2 mb-3",children:[l.jsx("input",{type:"text",placeholder:"Search questions...",value:d,onChange:S=>c(S.target.value),className:"flex-1 border rounded px-2 py-1"}),l.jsxs("select",{value:h??"",onChange:S=>p(S.target.value?Number(S.target.value):null),className:"border rounded px-2 py-1",children:[l.jsx("option",{value:"",children:"All Difficulties"}),Array.isArray(n)&&n.map(S=>l.jsx("option",{value:S.id,children:S.name},S.id))]})]}),l.jsxs("div",{className:"flex justify-between items-stretch gap-3 mb-3",children:[l.jsxs("div",{className:"flex items-center gap-3 text-xs bg-gray-50 border border-gray-300 rounded-lg px-4 py-2",children:[l.jsxs("span",{className:`${N.easy===5?"text-green-600 font-semibold":"text-red-600"}`,children:["Easy: ",N.easy," / 5"]}),l.jsxs("span",{className:`${N.medium===8?"text-green-600 font-semibold":"text-red-600"}`,children:["Medium: ",N.medium," / 8"]}),l.jsxs("span",{className:`${N.hard===5?"text-green-600 font-semibold":"text-red-600"}`,children:["Hard: ",N.hard," / 5"]})]}),l.jsx("div",{className:"flex items-center bg-blue-50 border border-blue-200 rounded-lg px-4 py-2 w-auto",children:l.jsxs("div",{className:"text-base font-bold text-green-700",children:["Total Marks: ",N.totalMarks]})})]}),l.jsx("div",{className:"max-h-[400px] overflow-y-auto space-y-2 mt-3",children:f?l.jsx("div",{className:"text-center py-4",children:"Loading questions..."}):v.length===0?l.jsx("div",{className:"text-center py-4",children:"No questions found."}):v.map(S=>{const _=x[S.difficulty_level];return l.jsxs("div",{className:"flex items-start gap-3 p-2 border rounded hover:bg-gray-50",children:[l.jsx(Gg,{checked:o.some(C=>C.id===S.id),onCheckedChange:()=>m(S)}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${y(_==null?void 0:_.id)}`,children:(_==null?void 0:_.name)||"Unknown"}),l.jsx("div",{className:"text-sm flex-1",children:S.english_text}),l.jsx("div",{className:"text-sm flex-1",children:S.hindi_text}),l.jsx("div",{className:"text-sm flex-1",children:S.marathi_text})]},S.id)})}),l.jsxs(fo,{className:"mt-4",children:[l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsxs("div",{className:"text-sm font-semibold text-gray-800",children:["Total Selected: ",N.total]}),l.jsx("div",{className:"text-xs text-orange-600 font-medium",children:" Required: 18 questions (5 Easy + 8 Medium + 5 Hard)"})]}),l.jsx(le,{onClick:b,children:"Save"}),l.jsx(le,{variant:"outline",onClick:t,children:"Cancel"})]})]})})}function t_e({allQuestions:e,difficultyLevels:t}){const{toast:r}=Wt(),[n,a]=w.useState([]),[s,i]=w.useState(null),[o,u]=w.useState(!1),[d,c]=w.useState(null),[h,p]=w.useState({name:"",description:"",nameType:"random",isRandom:!0}),[f,g]=w.useState(null),[m,x]=w.useState(!1),[y,v]=w.useState({selectedSet:"",language:"English"}),[b,N]=w.useState(!1),[S,_]=w.useState(null),C=async(A=!0)=>{const L=await N_(),z=A?await Promise.all(L.map(async $=>{try{const V=await Yv($.name);return{id:$.id,name:$.name,description:$.description,limit:$.maximumMarks,questions:V.data||[],active:$.status,is_default_online_set:$.is_default_online_set,created_at:$.created_at,updated_at:$.updated_at}}catch{return{id:$.id,name:$.name,description:$.description,limit:$.maximumMarks,questions:[],active:$.status,is_default_online_set:$.is_default_online_set,created_at:$.created_at,updated_at:$.updated_at}}})):L.map($=>({id:$.id,name:$.name,description:$.description,limit:$.maximumMarks,questions:[],active:$.status,is_default_online_set:$.is_default_online_set,created_at:$.created_at,updated_at:$.updated_at}));a(z)};w.useEffect(()=>{C(!1)},[]);const k=async A=>{try{const L=n.find($=>$.id===A);if(!L)return;const z=await Yv(L.name);a($=>$.map(V=>V.id===A?{...V,questions:(z==null?void 0:z.data)||[]}:V))}catch(L){console.warn(`Error loading questions for set ${A}:`,L)}},I=async(A,L)=>{try{if(L.id===-1&&f){const B={name:f.name,description:f.description,isRandom:!1,questions:A.map(Y=>({question_id:Y.id,difficulty_level:Y.difficulty_level}))};await BN(B),r({title:" Set Created Successfully",description:`"${f.name}" has been created with ${A.length} questions.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),i(null),g(null),await C(!1);return}const z=L.questions||[],$=A.filter(B=>!z.some(Y=>Y.id===B.id)),V=z.filter(B=>!A.some(Y=>Y.id===B.id));if($.length>0){const B=$.map(Y=>({question_set_id:L.id,question_id:Y.id,difficulty_level:Y.difficulty_level}));await cV(B)}V.length>0&&await Promise.all(V.map(B=>hV(B.id))),a(B=>B.map(Y=>Y.id===L.id?{...Y,questions:A}:Y)),r({title:" Questions Added Successfully",description:`Added: ${$.length}`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(z){r({title:" Failed to Update Questions",description:z.message||"An error occurred while updating questions. Please try again.",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},T=()=>{c(null),p({name:"",description:"",nameType:"random",isRandom:!0}),u(!0)},j=A=>{c(A),p({name:A.name,description:A.description||"",nameType:"custom",isRandom:!1}),u(!0)},E=async()=>{let A=h.name;if(h.nameType==="custom"&&!h.name.trim()){r({title:" Required Field Missing",description:"Please enter a set name",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{const L={name:A,description:h.description,isRandom:h.isRandom};if(d)await pV(d.id,L),r({title:" Set Updated Successfully",description:`"${A}" has been updated successfully.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),u(!1),await C(!1);else{if(h.nameType==="custom"){u(!1),g({name:A,description:h.description}),i({id:-1,name:A,limit:0,questions:[],active:!0,isNewCustom:!0});return}const z=await BN(L);r({title:" Set Created Successfully",description:`"${A}" has been added.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),u(!1),await C(!1)}}catch{r({title:"Oops!",description:"There was a small issue while processing your request. Please try again.",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},O=A=>{_(A),N(!0)},M=async()=>{if(S)try{await fV(S.id),a(A=>A.filter(L=>L.id!==S.id)),r({title:" Set Deleted Successfully",description:`"${(S==null?void 0:S.name)||"Set"}" has been removed.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),await C(!1),N(!1),_(null)}catch(A){r({title:" Failed to Delete Set",description:A.message||"Unable to delete the set. It may contain questions or be in use.",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},W=n.find(A=>A.is_default_online_set),q=async()=>{if(!y.selectedSet){r({title:" Required Field Missing",description:"Please select a question set",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{const A=n.find(V=>V.name===y.selectedSet);if(!A)throw new Error("Selected set not found");r({title:" Generating PDF...",description:"Please wait while we generate the PDF",variant:"default",className:"border-blue-500 bg-blue-50 text-blue-900"});const L=await gV(A.id,y.language),z=window.URL.createObjectURL(L),$=document.createElement("a");$.href=z,$.download=`${y.selectedSet}_${y.language}.pdf`,document.body.appendChild($),$.click(),document.body.removeChild($),window.URL.revokeObjectURL(z),r({title:" PDF Downloaded",description:`${y.selectedSet} in ${y.language} has been downloaded`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),x(!1)}catch(A){r({title:" Download Failed",description:A.message||"Unable to download PDF. Please try again.",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},P=()=>{v({selectedSet:"",language:"English"}),x(!0)};return l.jsxs("div",{className:"flex flex-col h-[600px]",children:[l.jsxs("div",{className:"flex justify-end items-center gap-3 mb-4",children:[l.jsxs(le,{onClick:T,variant:"outline",children:[l.jsx(Wn,{className:"h-4 w-4 mr-2"}),"Add Set"]}),l.jsxs(le,{onClick:P,variant:"outline",children:[l.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Download PDF"]}),W&&l.jsxs("div",{className:"flex items-center gap-2 border border-green-300 rounded-md px-3 py-1.5 bg-green-50",children:[l.jsx("span",{className:"text-sm font-medium text-green-700",children:"Default Set:"}),l.jsx("span",{className:"text-sm font-semibold text-green-800",children:W.name})]})]}),l.jsxs("div",{className:"flex-1 overflow-auto space-y-4 scrollbar-hide [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[n.length===0&&l.jsx("p",{className:"text-gray-500 text-sm",children:'No question sets found. Click "Add Set" to create one.'}),n.map(A=>l.jsxs(Et,{className:"relative",children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[l.jsx(Lt,{className:"text-base font-semibold",children:A.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(le,{variant:"ghost",size:"icon",onClick:()=>j(A),title:"Edit set",children:l.jsx(xl,{className:"h-4 w-4 text-black-500"})}),l.jsx(le,{variant:"ghost",size:"icon",onClick:()=>O(A),title:"Delete set",children:l.jsx(ka,{className:"h-4 w-4 text-red-500"})})]})]})}),l.jsxs(jt,{className:"space-y-3",children:[l.jsxs("p",{className:"text-sm font-medium text-gray-600",children:["Youve selected ",l.jsx("strong",{children:A.questions.length})," question",A.questions.length!==1&&"s","."]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs(le,{variant:"outline",size:"sm",onClick:async()=>{await k(A.id),i(A)},children:[l.jsx(qle,{className:"h-4 w-4 mr-2"}),"Pick Questions"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Gg,{id:`default-${A.id}`,checked:A.is_default_online_set||!1,className:"rounded-none data-[state=checked]:bg-primary data-[state=checked]:border-primary",onCheckedChange:async L=>{if(L)try{await mV(A.id),a(z=>z.map($=>({...$,is_default_online_set:$.id===A.id}))),r({title:" Default Set Updated",description:`"${A.name}" is now the default online test set.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(z){r({title:" Failed to Set Default",description:z.message||"Unable to set default online test set. Please try again.",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}}}),l.jsx(Ee,{htmlFor:`default-${A.id}`,className:"text-xs cursor-pointer whitespace-nowrap",children:"Mark Default"})]})]})]})]},A.id))]}),s&&l.jsx(e_e,{activeSet:n.find(A=>A.id===s.id)||s,onClose:()=>i(null),difficultyLevel:t,onSave:A=>I(A,s)}),l.jsx(Wr,{open:o,onOpenChange:u,children:l.jsxs(Vr,{children:[l.jsx(Hr,{children:l.jsx(qr,{children:d?"Edit Question Set":"Create Question Set"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{className:"mb-2 block",children:"Set Generation Method"}),l.jsxs(sb,{value:h.nameType,onValueChange:A=>{const L=A==="random",z=L?`Set ${n.length+1}`:"";p({...h,nameType:A,name:z,isRandom:L})},className:"flex items-center gap-4 mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zd,{value:"random",id:"r-random"}),l.jsx(Ee,{htmlFor:"r-random",children:"Random"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zd,{value:"custom",id:"r-custom"}),l.jsx(Ee,{htmlFor:"r-custom",children:"Custom Name"})]})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"name",children:"Set Name"}),l.jsx(Ve,{id:"name",value:h.name,onChange:A=>p({...h,name:A.target.value}),placeholder:"Enter Set name"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"description",children:"Description"}),l.jsx(ps,{id:"description",value:h.description,onChange:A=>p({...h,description:A.target.value}),placeholder:"Brief description of this question set",rows:3})]})]}),l.jsxs(fo,{children:[l.jsx(le,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),l.jsx(le,{onClick:E,children:d?"Update":h.nameType==="custom"?"Next":"Create"})]})]})}),l.jsx(Wr,{open:m,onOpenChange:x,children:l.jsxs(Vr,{children:[l.jsx(Hr,{children:l.jsx(qr,{children:"Download Question Set PDF"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"set-select",children:"Select Question Set"}),l.jsxs(Gr,{value:y.selectedSet,onValueChange:A=>v({...y,selectedSet:A}),children:[l.jsx(Fr,{id:"set-select",children:l.jsx(Kr,{placeholder:"Choose a question set"})}),l.jsx(Or,{children:n.map(A=>l.jsx(gt,{value:A.name,children:A.name},A.id))})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"language-select",children:"Language"}),l.jsxs(Gr,{value:y.language,onValueChange:A=>v({...y,language:A}),children:[l.jsx(Fr,{id:"language-select",children:l.jsx(Kr,{})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"English",children:"English"}),l.jsx(gt,{value:"Marathi",children:"Marathi"}),l.jsx(gt,{value:"Hindi",children:"Hindi"})]})]})]})]}),l.jsxs(fo,{children:[l.jsx(le,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),l.jsxs(le,{onClick:q,children:[l.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Download"]})]})]})}),l.jsx(yR,{isOpen:b,onClose:()=>{N(!1),_(null)},onConfirm:M,title:"Delete Question Set",description:`Are you sure you want to delete "${(S==null?void 0:S.name)||"this set"}"?

This action cannot be revert. All questions in this set will be removed from the set.`,confirmText:"Delete",cancelText:"Cancel"})]})}function a7(){const[e,t]=w.useState("list"),[r,n]=w.useState(null),[a,s]=w.useState(""),[i,o]=w.useState({status:"All",difficulty_level:"All",question_type:"All",topic:""}),[u,d]=w.useState(!1),[c,h]=w.useState(!1),[p,f]=w.useState(null),{toast:g}=Wt(),{questions:m,loading:x,createQuestion:y,updateQuestion:v,deleteQuestion:b,archiveQuestion:N,difficultyLevels:S,refetch:_}=ZSe(i,a);w.useEffect(()=>{},[m]);const C=()=>{_(),g({title:" Import Successful",description:"Questions have been imported and list is refreshed.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),t("list")},k=()=>{n(null),t("editor")},I=M=>{n(M),t("editor")},T=async M=>{try{r?(await v(r.id,M),g({title:" Question Updated",description:"The question has been successfully updated.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})):(await y(M),g({title:" Question Created",description:"The question has been successfully created.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})),t("list"),n(null)}catch(W){g({title:"Unable to complete action",description:ut(W),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},j=async M=>{try{await N(M),g({title:" Question Archived",description:"The question has been archived successfully.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(W){g({title:"Unable to complete action",description:ut(W),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},E=async M=>{try{await b(M),g({title:" Question Deleted",description:"The question has been permanently deleted.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),h(!1),f(null)}catch(W){g({title:"Unable to complete action",description:ut(W),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},O=M=>{f(M),h(!0)};return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsxs("main",{className:"md:ml-64 p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 ",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Question Repository"}),l.jsx("p",{className:"text-muted-foreground",children:"Manage and organize assessment questions for admissions screening"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(le,{variant:"outline",onClick:()=>t("import"),className:"flex items-center gap-2",children:[l.jsx($g,{className:"w-4 h-4"}),"Bulk Import"]}),l.jsxs(le,{onClick:k,className:"flex items-center gap-2",children:[l.jsx(Wn,{className:"w-4 h-4"}),"New Question"]})]})]}),l.jsxs(k_,{value:e,onValueChange:t,className:"space-y-6",children:[l.jsxs(Xb,{className:"grid w-full grid-cols-4 my-6",children:[l.jsx(Pi,{value:"list",children:"Questions"}),l.jsx(Pi,{value:"editor",children:"Editor"}),l.jsx(Pi,{value:"sets",children:"Sets"}),l.jsx(Pi,{value:"import",children:"Import"})]}),l.jsx(Li,{value:"list",className:"space-y-4",children:l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs(Lt,{className:"flex items-center justify-between",children:["Question Library",l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),l.jsx(Ve,{placeholder:"Search questions...",value:a,onChange:M=>s(M.target.value),className:"pl-10 w-64"})]}),l.jsxs(le,{variant:"outline",size:"sm",onClick:()=>d(!u),className:"flex items-center gap-2",children:[l.jsx(Ob,{className:"w-4 h-4"}),"Filters"]})]})]})}),l.jsxs(jt,{className:"flex flex-col h-[620px]",children:[u&&l.jsx("div",{className:"mb-6",children:l.jsx(KSe,{difficultyLevels:S,filters:i,onFiltersChange:o})}),l.jsx("div",{className:"flex-1 overflow-auto",children:l.jsx(VSe,{questions:m,loading:x,onEdit:M=>{I(M),t("editor")},onArchive:j,onDelete:O})})]})]})}),l.jsx(Li,{value:"editor",children:l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:r?"Edit Question":"Create New Question"})}),l.jsx(jt,{children:l.jsx(WSe,{difficultyLevels:S,question:r,onSave:T,setSelectedQuestion:n,onCancel:()=>{t("list"),n(null)}})})]})}),l.jsx(Li,{value:"sets",children:l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Question Sets"})}),l.jsx(jt,{children:l.jsx(t_e,{allQuestions:m,difficultyLevels:S})})]})}),l.jsx(Li,{value:"import",children:l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Bulk Import Questions"})}),l.jsx(jt,{children:l.jsx(GSe,{onImportComplete:C})})]})})]})]}),l.jsx(yR,{isOpen:c,onClose:()=>{h(!1),f(null)},onConfirm:()=>E(p),title:"Delete Question",description:"Are you sure you want to permanently delete this question? This action cannot be revert.",confirmText:"Delete",cancelText:"Cancel"})]})}const s7=[{name:"User Management",href:"/admin",icon:O1,component:WV,allowedRoles:[1]},{name:"Dashboard",href:"/",icon:Ule,component:$9,allowedRoles:[1,2]},{name:"Donor",href:"/donor",icon:aW,component:R9,allowedRoles:[1]},{name:"Partner",href:"/partners",icon:ch,component:K9,allowedRoles:[1]},{name:"Campus",href:"/campus",icon:zle,component:Q9,allowedRoles:[1]},{name:"School",href:"/school",icon:nW,component:X9,allowedRoles:[1]},{name:"All Interviews",href:"/admin-view",icon:jg,component:jG,allowedRoles:[1]},{name:"My Interviews",href:"/interviews",icon:bE,component:J9,allowedRoles:[1,2]},{name:"Question Repository",href:"/questions",icon:ZU,component:a7,allowedRoles:[1]}];function dn(){const{user:e,signOut:t}=Do(),[r,n]=w.useState(null),[a,s]=w.useState(!1),i=_s(),o=M6(),u=YA();w.useEffect(()=>{const x=localStorage.getItem("userInfo");x&&n(JSON.parse(x))},[e]);const d=x=>x.split("@")[0].slice(0,2).toUpperCase(),c=()=>(u==null?void 0:u.name)||(e==null?void 0:e.name)||(r==null?void 0:r.name)||"User",h=()=>(u==null?void 0:u.email)||(e==null?void 0:e.email)||(r==null?void 0:r.email)||"No email",p=()=>o||(e==null?void 0:e.avatar)||(r==null?void 0:r.avatar),f=(u==null?void 0:u.user_role_id)||(e==null?void 0:e.role_id)||2,g=async()=>{try{e&&t(),QE(),window.location.href="/Admission-Dashboard/students/login"}catch(x){console.error("Logout error:",x),QE(),window.location.href="/students/login"}},m=x=>x==="/interviews"?i.pathname==="/interviews"||i.pathname==="/schedule":i.pathname===x;return l.jsxs(l.Fragment,{children:[a&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>s(!1)}),l.jsx("div",{className:"md:hidden fixed top-4 left-4 z-50",children:l.jsx("button",{onClick:()=>s(!a),className:"p-2 bg-white rounded-lg shadow-lg hover:bg-gray-50 transition-colors",children:l.jsx(aue,{className:"w-6 h-6 text-gray-700"})})}),l.jsxs("div",{className:Ue("fixed top-0 left-0 h-full w-64 bg-gradient-sidebar z-50 flex flex-col border-r border-sidebar-medium transition-transform duration-300 ease-in-out","md:translate-x-0 md:rounded-none md:shadow-none",a?"translate-x-0":"-translate-x-full"),children:[l.jsx("div",{className:"md:hidden absolute top-4 right-4",children:l.jsx("button",{onClick:()=>s(!1),className:"p-1 bg-white/20 rounded-full hover:bg-white/30 transition-colors",children:l.jsx(wa,{className:"w-5 h-5 text-white"})})}),l.jsx("div",{className:"p-6 border-b border-sidebar-medium",children:l.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[p()?l.jsx("img",{src:p(),alt:"User avatar",className:"w-16 h-16 rounded-full object-cover border-2 border-white/20",onError:x=>{x.currentTarget.style.display="none";const y=x.currentTarget.nextElementSibling;y&&(y.style.display="flex")}}):null,l.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center",style:{display:p()?"none":"flex"},children:l.jsx("span",{className:"text-white text-xl font-semibold",children:h()?d(h()):"U"})}),l.jsx("div",{children:l.jsx("h3",{className:"text-lg font-semibold text-sidebar-text",children:c()})})]})}),l.jsx("nav",{className:"px-4 py-6 space-y-1 flex-1",children:s7.filter(x=>x.allowedRoles.includes(f)).map(x=>l.jsxs(_U,{to:x.href,className:()=>Ue("block p-2 rounded",m(x.href)?"bg-gray-600 text-white":"text-gray-300 hover:bg-gray-700"),onClick:y=>{if(i.pathname===x.href){y.preventDefault();return}s(!1)},children:[l.jsx(x.icon,{className:"inline mr-2"}),x.name]},x.href))}),l.jsx("div",{className:"p-4 border-t border-sidebar-medium space-y-2",children:l.jsxs("button",{onClick:g,className:"w-full flex items-center px-3 py-2.5 text-sm font-medium text-sidebar-text-muted hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-all duration-200",children:[l.jsx(sW,{className:"mr-3 h-5 w-5"}),"Sign Out"]})})]})]})}const r_e=()=>l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"All Applicants"}),l.jsx("p",{className:"text-muted-foreground",children:"Complete view of all applicants across all admission stages"})]}),l.jsx(A9,{})]})})]}),hm=e=>{const[t,r]=e.split(":").map(Number);return t*60+r},i7=(e,t,r,n)=>{const a=hm(e),s=hm(t),i=hm(r),o=hm(n);return a<o&&i<s},jn=e=>{const[t,r]=e.split(":"),n=parseInt(t),a=n>=12?"PM":"AM";return`${n===0?12:n>12?n-12:n}:${r} ${a}`},eS=e=>e==="LR"?"Learning Round":e==="CFR"?"Cultural Fit Round":e,o7=async(e,t,r,n,a)=>{try{const s=Nn(e,"yyyy-MM-dd"),o=["LR","CFR"].map(c=>b_(s,c).catch(()=>[])),d=(await Promise.all(o)).flatMap(c=>Array.isArray(c)?c:(c==null?void 0:c.data)||[]);for(const c of d){if(a&&c.id===a)continue;const h=eS(c.slot_type),p=eS(n),f=Nn(e,"MMM dd, yyyy"),g=c.slot_type===n;if(g&&c.start_time===t&&c.end_time===r)return{valid:!1,message:a?`A ${h} slot already exists at this exact time (${jn(t)} - ${jn(r)}) on ${f}. Please choose a different time.`:`This ${h} slot (${jn(t)} - ${jn(r)}) already exists on ${f}. Please choose a different time.`};if(i7(t,r,c.start_time,c.end_time))return{valid:!1,message:g?`Time conflict! Your ${p} slot (${jn(t)} - ${jn(r)}) overlaps with an existing ${h} slot (${jn(c.start_time)} - ${jn(c.end_time)}) on ${f}.`:`Time conflict! Your ${p} slot (${jn(t)} - ${jn(r)}) overlaps with an existing ${h} slot (${jn(c.start_time)} - ${jn(c.end_time)}) on ${f}. Slots of different types cannot overlap.`}}return{valid:!0}}catch(s){return console.error("Error validating slots:",s),{valid:!0}}},tS=e=>/^([01]\d|2[0-3]):([0-5]\d)$/.test(e),l7=(e,t)=>{const r=hm(e),n=hm(t),a=n-r;if(r>=n)return{valid:!1,message:`Start time (${jn(e)}) must be earlier than end time (${jn(t)}).`};const s=15;if(a<s)return{valid:!1,message:`Interview slot duration must be at least ${s} minutes. Current duration: ${a} minutes (${jn(e)} - ${jn(t)}).`};const i=240;return a>i?{valid:!1,message:`Interview slot duration cannot exceed ${i/60} hours. Current duration: ${Math.round(a/60*10)/10} hours.`}:{valid:!0}};function n_e({isOpen:e,onClose:t,onSuccess:r}){const[n,a]=w.useState([{date:void 0,startTime:"",endTime:"",slot_type:""}]),[s,i]=w.useState(!1),[o,u]=w.useState({}),[d,c]=w.useState({}),{toast:h}=Wt(),p=async(N,S)=>{const _=Nn(N,"yyyy-MM-dd"),C=`${_}_${S}`;if(d[C])return d[C];try{const k=await b_(_,S),I=Array.isArray(k)?k:(k==null?void 0:k.data)||[];return c(T=>({...T,[C]:I})),I}catch(k){return console.error("Error fetching existing slots:",k),[]}},f=async(N,S,_,C)=>(await p(N,C),o7(N,S,_,C)),g=N=>{for(let S=0;S<N.length;S++){const _=N[S];if(!(!_.date||!_.startTime||!_.endTime||!_.slot_type))for(let C=S+1;C<N.length;C++){const k=N[C];if(!k.date||!k.startTime||!k.endTime||!k.slot_type)continue;if(Nn(_.date,"yyyy-MM-dd")===Nn(k.date,"yyyy-MM-dd")){const T=_.slot_type===k.slot_type,j=eS(_.slot_type),E=eS(k.slot_type),O=Nn(_.date,"MMM dd, yyyy");if(T&&_.startTime===k.startTime&&_.endTime===k.endTime)return{valid:!1,message:`Duplicate found! Slot #${S+1} and Slot #${C+1} have the same ${j} time (${jn(_.startTime)} - ${jn(_.endTime)}) on ${O}.`};if(i7(_.startTime,_.endTime,k.startTime,k.endTime))return{valid:!1,message:`Time conflict between your slots! Slot #${S+1} (${j}: ${jn(_.startTime)} - ${jn(_.endTime)}) overlaps with Slot #${C+1} (${E}: ${jn(k.startTime)} - ${jn(k.endTime)}) on ${O}.`}}}}return{valid:!0}},m=()=>{a([...n,{date:void 0,startTime:"",endTime:"",slot_type:""}])},x=N=>{if(n.length>1){const S=n.filter((_,C)=>C!==N);a(S)}},y=(N,S,_)=>{const C=[...n];C[N][S]=_,a(C)},v=async N=>{if(N.preventDefault(),n.some(k=>!k.date)){h({title:" Missing Date",description:"Please select a date for all slots before submitting.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(n.some(k=>!k.startTime||!k.endTime||!k.slot_type)){h({title:" Incomplete Information",description:"Please fill in all required fields: slot type, start time, and end time.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}for(let k=0;k<n.length;k++){const{startTime:I,endTime:T}=n[k];if(!tS(I)||!tS(T)){h({title:" Invalid Time Format",description:`Slot #${k+1}: Please enter valid times in HH:mm format (e.g., 14:30).`,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const j=l7(I,T);if(!j.valid){h({title:" Invalid Time Range",description:`Slot #${k+1}: ${j.message}`,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}}const C=g(n);if(!C.valid){h({title:" Slot Conflict",description:C.message,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}h({title:"Validating Slots...",description:"Checking for conflicts with existing schedules...",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});try{const k=new Map;n.forEach(T=>{const E=`${Nn(T.date,"yyyy-MM-dd")}_${T.slot_type}`;k.has(E)||k.set(E,{date:T.date,slotType:T.slot_type})});const I=Array.from(k.values()).map(({date:T,slotType:j})=>p(T,j));await Promise.all(I);for(let T=0;T<n.length;T++){const j=n[T],E=await f(j.date,j.startTime,j.endTime,j.slot_type);if(!E.valid){h({title:" Cannot Add Slot",description:E.message,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}}}catch(k){console.error("Error validating slots:",k),h({title:" Validation Failed",description:ut(k),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"});return}try{i(!0);const k=n.map(I=>({date:Nn(I.date,"yyyy-MM-dd"),start_time:I.startTime,end_time:I.endTime,slot_type:I.slot_type,created_at:new Date().toISOString()}));await Q6(k),h({title:" Slots Added Successfully",description:`${n.length} interview slot${n.length>1?"s have":" has"} been added to the schedule.`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),r(),b()}catch(k){console.error("Error adding slots:",k),h({title:" Unable to Add Slots",description:ut(k),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{i(!1)}},b=()=>{a([{date:void 0,startTime:"",endTime:"",slot_type:""}]),u({}),c({}),t()};return l.jsx(Wr,{open:e,onOpenChange:b,children:l.jsxs(Vr,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[l.jsx(Hr,{children:l.jsxs(qr,{className:"flex items-center gap-2",children:[l.jsx($a,{className:"w-5 h-5"}),"Add Interview Slots"]})}),l.jsxs("form",{onSubmit:v,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(Ee,{children:"Time Slots"}),l.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:m,className:"flex items-center gap-2",children:[l.jsx(Wn,{className:"w-4 h-4"}),"Add Slot"]})]}),n.map((N,S)=>l.jsxs("div",{className:"p-4 border border-border rounded-lg space-y-3",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{children:"Select Date"}),l.jsxs(km,{open:o[S],onOpenChange:_=>u(C=>({...C,[S]:_})),children:[l.jsx(Cm,{asChild:!0,children:l.jsxs(le,{variant:"outline",className:Ue("w-full justify-start text-left font-normal",!N.date&&"text-muted-foreground"),children:[l.jsx($a,{className:"mr-2 h-4 w-4"}),N.date?Nn(N.date,"PPP"):l.jsx("span",{children:"Pick a date"})]})}),l.jsx(Jd,{className:"w-auto p-0",align:"start",children:l.jsx(rb,{mode:"single",selected:N.date,onSelect:_=>{_&&(y(S,"date",_),u(C=>({...C,[S]:!1})))},initialFocus:!0,disabled:_=>_<new Date})})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"text-sm font-medium",children:["Slot ",S+1]}),n.length>1&&l.jsx(le,{type:"button",variant:"ghost",size:"sm",onClick:()=>x(S),className:"text-destructive hover:text-destructive",children:l.jsx(wa,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:`slot-type-${S}`,children:"Slot Type"}),l.jsxs(Gr,{value:N.slot_type,onValueChange:_=>y(S,"slot_type",_),children:[l.jsx(Fr,{id:`slot-type-${S}`,children:l.jsx(Kr,{placeholder:"Select slot type"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"LR",children:"Learning Round (LR)"}),l.jsx(gt,{value:"CFR",children:"Cultural Fit Round (CFR)"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:`start-${S}`,className:"flex items-center gap-2",children:[l.jsx(Ya,{className:"w-4 h-4"}),"Start Time"]}),l.jsx(Ve,{id:`start-${S}`,type:"time",value:N.startTime,onChange:_=>y(S,"startTime",_.target.value),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:`end-${S}`,className:"flex items-center gap-2",children:[l.jsx(Ya,{className:"w-4 h-4"}),"End Time"]}),l.jsx(Ve,{id:`end-${S}`,type:"time",value:N.endTime,onChange:_=>y(S,"endTime",_.target.value),required:!0})]})]})]},S))]}),l.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[l.jsx(le,{type:"button",variant:"outline",onClick:b,disabled:s,children:"Cancel"}),l.jsx(le,{type:"submit",disabled:s,className:"bg-gradient-primary hover:bg-primary/90 text-white",children:s?"Adding Slots...":`Add ${n.length} Slot${n.length>1?"s":""}`})]})]})]})})}function a_e({isOpen:e,onClose:t,onSuccess:r,slotData:n}){const[a,s]=w.useState(void 0),[i,o]=w.useState(""),[u,d]=w.useState(""),[c,h]=w.useState(!1),[p,f]=w.useState(""),{toast:g}=Wt();w.useEffect(()=>{n&&e&&(s(new Date(n.date)),o(n.start_time),d(n.end_time),f(n.slot_type||""))},[n,e]);const m=async y=>{if(y.preventDefault(),!a){g({title:" Missing Date",description:"Please select a date before saving.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!i||!u){g({title:" Incomplete Information",description:"Please fill in both start time and end time.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!p){g({title:" Missing Slot Type",description:"Please select a slot type (LR or CFR).",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}if(!tS(i)||!tS(u)){g({title:" Invalid Time Format",description:"Please enter valid times in HH:mm format (e.g., 14:30).",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}const v=l7(i,u);if(!v.valid){g({title:" Invalid Time Range",description:v.message,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}g({title:"Validating Changes...",description:"Checking for conflicts with existing schedules...",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});const b=await o7(a,i,u,p,n.id);if(!b.valid){g({title:" Cannot Update Slot",description:b.message,variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}try{h(!0);const N={date:Nn(a,"yyyy-MM-dd"),start_time:i,end_time:u,slot_type:p};await X6(n.id,N),g({title:" Slot Updated Successfully",description:"The interview slot has been updated in the schedule.",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),r(),x()}catch(N){console.error("Error updating slot:",N),g({title:" Unable to Update Slot",description:ut(N),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{h(!1)}},x=()=>{s(void 0),o(""),d(""),f(""),t()};return l.jsx(Wr,{open:e,onOpenChange:x,children:l.jsxs(Vr,{className:"max-w-md",children:[l.jsx(Hr,{children:l.jsxs(qr,{className:"flex items-center gap-2",children:[l.jsx($a,{className:"w-5 h-5"}),"Edit Interview Slot"]})}),l.jsxs("form",{onSubmit:m,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{children:"Select Date"}),l.jsxs(km,{children:[l.jsx(Cm,{asChild:!0,children:l.jsxs(le,{variant:"outline",className:Ue("w-full justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[l.jsx($a,{className:"mr-2 h-4 w-4"}),a?Nn(a,"PPP"):l.jsx("span",{children:"Pick a date"})]})}),l.jsx(Jd,{className:"w-auto p-0",align:"start",children:l.jsx(rb,{mode:"single",selected:a,onSelect:s,initialFocus:!0,className:Ue("p-3 pointer-events-auto"),disabled:y=>y<new Date})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"slot-type",children:"Slot Type"}),l.jsxs(Gr,{value:p,onValueChange:f,children:[l.jsx(Fr,{id:"slot-type",children:l.jsx(Kr,{placeholder:"Select slot type"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"LR",children:"Learning Round (LR)"}),l.jsx(gt,{value:"CFR",children:"Cultural Fit Round (CFR)"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"start-time",className:"flex items-center gap-2",children:[l.jsx(Ya,{className:"w-4 h-4"}),"Start Time"]}),l.jsx(Ve,{id:"start-time",type:"time",value:i,onChange:y=>o(y.target.value),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(Ee,{htmlFor:"end-time",className:"flex items-center gap-2",children:[l.jsx(Ya,{className:"w-4 h-4"}),"End Time"]}),l.jsx(Ve,{id:"end-time",type:"time",value:u,onChange:y=>d(y.target.value),required:!0})]})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx(le,{type:"button",variant:"outline",onClick:x,className:"flex-1",disabled:c,children:"Cancel"}),l.jsx(le,{type:"submit",className:"flex-1 bg-gradient-primary hover:bg-primary/90 text-white",disabled:c,children:c?"Updating...":"Update Slot"})]})]})]})})}const s_e="203783247002-amrp0mkp58jna7mhcf368vcn0ilnq7hd.apps.googleusercontent.com",i_e="https://www.googleapis.com/auth/calendar.events";let ql=null,X1=null;const u7=()=>new Promise((e,t)=>{try{if(typeof window>"u"){t(new Error("Window object not available"));return}if(window.google){q3(),e(!0);return}const r=document.createElement("script");r.src="https://accounts.google.com/gsi/client",r.async=!0,r.defer=!0,r.onload=()=>{q3(),e(!0)},r.onerror=n=>{t(new Error("Failed to load Google Identity Services"))},document.head.appendChild(r)}catch(r){t(r)}}),q3=()=>{const e=window.google;if(!e)throw new Error("Google Identity Services not loaded");X1=e.accounts.oauth2.initTokenClient({client_id:s_e,scope:i_e,callback:t=>{if(t.error)throw new Error(t.error);ql=t.access_token}})},c7=async()=>new Promise((e,t)=>{try{if(!X1)throw new Error("Token client not initialized. Please refresh the page.");X1.callback=r=>{if(r.error){console.error("Sign-in error:",r),t(new Error(r.error_description||r.error||"Failed to sign in"));return}ql=r.access_token,e(!0)},X1.requestAccessToken({prompt:"select_account"})}catch(r){console.error("Error during sign-in:",r),t(r)}}),Fu=()=>ql!=null&&ql!=="",d7=async e=>{var t;try{if(!ql)throw new Error("Not authenticated. Please sign in first.");const r=e.attendees||[e.attendeeEmail],n=[...new Set(r.filter(Boolean))],a={summary:e.summary,description:e.description,start:{dateTime:e.startDateTime,timeZone:"Asia/Kolkata"},end:{dateTime:e.endDateTime,timeZone:"Asia/Kolkata"},attendees:n.map(o=>({email:o})),conferenceData:{createRequest:{requestId:`meet-${Date.now()}`,conferenceSolutionKey:{type:"hangoutsMeet"}}},reminders:{useDefault:!1,overrides:[{method:"email",minutes:24*60},{method:"popup",minutes:30}]}},s=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events?conferenceDataVersion=1&sendUpdates=all",{method:"POST",headers:{Authorization:`Bearer ${ql}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){const o=await s.json();throw console.error("Calendar API error:",o),new Error(((t=o.error)==null?void 0:t.message)||"Failed to create calendar event")}const i=await s.json();return{success:!0,eventId:i.id,meetLink:i.hangoutLink,htmlLink:i.htmlLink}}catch(r){throw console.error("Error creating calendar event:",r),r}},G3=async e=>{var t;try{if(!ql)throw new Error("Not authenticated. Please sign in first.");const r=await fetch(`https://www.googleapis.com/calendar/v3/calendars/primary/events/${e}?sendUpdates=all`,{method:"DELETE",headers:{Authorization:`Bearer ${ql}`}});if(!r.ok){const n=await r.json();throw console.error("Calendar API error:",n),new Error(((t=n.error)==null?void 0:t.message)||"Failed to delete calendar event")}return{success:!0}}catch(r){throw console.error("Error deleting calendar event:",r),r}},rS=(e,t)=>`${e}T${t}:00+05:30`,o_e=({isOpen:e,onClose:t,slotData:r,allAvailableSlots:n=[],isDirectScheduleMode:a=!1,onSchedule:s,isLoading:i})=>{const[o,u]=w.useState(""),[d,c]=w.useState(""),[h,p]=w.useState(""),[f,g]=w.useState(""),[m,x]=w.useState(""),[y,v]=w.useState(""),[b,N]=w.useState(null);if(!e)return null;const S=Array.from(new Set(n.filter(j=>!j.is_booked).map(j=>j.date))).sort(),_=y?n.filter(j=>j.date===y&&!j.is_booked):[],C=a?_.find(j=>j.id===b):r,k=async j=>{if(j.preventDefault(),!o||!d||!h||!f){alert("Please fill all required fields");return}if(a&&!b){alert("Please select a date and slot");return}const E=C;if(!E){alert("Please select a valid slot");return}const O=m||E.interviewer_email||"";if(!O){alert("Please enter interviewer email");return}try{await s(E.id,parseInt(o),d,h,O,E.interviewer_name||O,E.date,E.start_time,E.end_time,f),u(""),c(""),p(""),g(""),x(""),v(""),N(null)}catch(M){console.error("Error in handleSubmit:",M)}},I=j=>{const[E,O]=j.split(":"),M=new Date;return M.setHours(parseInt(E),parseInt(O)),M.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},T=j=>new Date(j).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return l.jsx(Wr,{open:e,onOpenChange:t,children:l.jsxs(Vr,{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto rounded-xl bg-white shadow-lg border border-gray-200",children:[l.jsxs(Hr,{className:"pb-4 border-b border-gray-200",children:[l.jsx(qr,{className:"flex items-center justify-between text-lg font-semibold text-gray-900",children:l.jsx("span",{children:"Schedule Interview"})}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create Google Meet link and schedule the interview"})]}),l.jsxs("form",{onSubmit:k,className:"p-6 space-y-6",children:[a&&l.jsxs("div",{className:"bg-blue-50 border border-orange-200 rounded-lg p-5",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[l.jsx($a,{className:"w-5 h-5 mr-2 text-blue-600"}),"Select Date & Slot"]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Date ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:y,onChange:j=>{v(j.target.value),N(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500",required:!0,children:[l.jsx("option",{value:"",children:"Choose a date"}),S.map(j=>l.jsx("option",{value:j,children:T(j)},j))]})]}),y&&l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Time Slot ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:_.map(j=>l.jsxs("div",{onClick:()=>N(j.id),className:`p-3 border-2 rounded-lg cursor-pointer transition-all ${b===j.id?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-orange-300"}`,children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Ya,{className:"w-4 h-4 text-gray-500"}),l.jsxs("span",{className:"font-medium text-sm",children:[I(j.start_time)," -"," ",I(j.end_time)]})]}),j.interviewer_name&&l.jsx("p",{className:"text-xs text-gray-600 ml-6",children:j.interviewer_name})]},j.id))})]})]}),C&&l.jsxs("div",{className:"bg-muted/30 border border-gray-200 rounded-lg p-5",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[l.jsx($a,{className:"w-5 h-5 mr-2 text-orange-600"}),"Selected Slot Details"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx($a,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Date:"}),l.jsx("span",{children:T(C.date)})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ya,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Time:"}),l.jsxs("span",{children:[I(C.start_time)," -"," ",I(C.end_time)]})]}),C.interviewer_name&&l.jsxs("div",{className:"flex items-center gap-2 md:col-span-2",children:[l.jsx(yo,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Interviewer:"}),l.jsx("span",{children:C.interviewer_name})]}),C.interviewer_email&&l.jsxs("div",{className:"flex items-center gap-2 md:col-span-2",children:[l.jsx(uh,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Email:"}),l.jsx("span",{children:C.interviewer_email})]})]})]}),l.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg space-y-4",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center",children:[l.jsx(yo,{className:"w-5 h-5 mr-2 text-orange-600"}),"Student Information"]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student ID ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"number",value:o,onChange:j=>u(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter student ID",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student Name ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:h,onChange:j=>p(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter student full name",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student Email ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"email",value:d,onChange:j=>c(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"student@example.com",required:!0}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Calendar invite will be sent to this email"})]})]}),!(C!=null&&C.interviewer_email)&&l.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg space-y-4",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center",children:[l.jsx(uh,{className:"w-5 h-5 mr-2 text-orange-600"}),"Interviewer Information"]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Interviewer Email ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"email",value:m,onChange:j=>x(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"interviewer@example.com",required:!0})]})]}),l.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg space-y-4",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center",children:[l.jsx(xo,{className:"w-5 h-5 mr-2 text-orange-600"}),"Interview Details"]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Interview Topic ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:f,onChange:j=>g(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"e.g., Technical Interview - Round 1",required:!0})]})]}),l.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-sm text-orange-800",children:[l.jsx("p",{className:"font-medium mb-1",children:"What happens next?"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Google Meet link will be created automatically"}),l.jsx("li",{children:"Calendar invites sent to student & interviewer"}),l.jsx("li",{children:"Interview details saved to database"}),l.jsx("li",{children:"Slot will be marked as booked"})]})]}),l.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[l.jsx(le,{type:"button",variant:"outline",onClick:t,disabled:i,className:"flex-1 py-3",children:"Cancel"}),l.jsx(le,{type:"submit",className:"flex-1 bg-orange-500 hover:orange-600 text-white py-3 font-medium",disabled:i,children:i?l.jsxs(l.Fragment,{children:[l.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Meeting..."]}):l.jsxs(l.Fragment,{children:[l.jsx($a,{className:"w-4 h-4 mr-2"}),"Schedule & Create Meet Link"]})})]})]})]})})},l_e=()=>{const[e,t]=w.useState(!1),[r,n]=w.useState(!1),[a,s]=w.useState(null),{toast:i}=Wt(),[o,u]=w.useState(!1),[d,c]=w.useState(null),[h,p]=w.useState(!1),[f,g]=w.useState(!1),[m,x]=w.useState(!1),[y,v]=w.useState([]),[b,N]=w.useState([]),[S,_]=w.useState(""),[C,k]=w.useState(!1),[I,T]=w.useState(!1),[j,E]=w.useState(null),[O,M]=w.useState(!1);w.useEffect(()=>{(async()=>{try{await u7(),Fu()&&g(!0)}catch(K){console.error("Google API init error:",K)}})()},[]),w.useEffect(()=>{W()},[]);const W=async()=>{var ae;try{k(!0);const K=await CV(),J=Array.isArray(K)?K:((ae=K==null?void 0:K.data)==null?void 0:ae.data)||(K==null?void 0:K.data)||[];N(J),v(J)}catch(K){console.error("Error fetching slots:",K),i({title:" Unable to Load Slots",description:ut(K),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),N([]),v([])}finally{k(!1)}},q=ae=>{const K=ae.target.value;if(_(K),K==="")v(b);else{const J=b.filter(Z=>Z.date===K);v(J)}},P=()=>{_(""),v(b)},A=async(ae,K,J,Z,Q,U,F,te,pe,ve)=>{try{x(!0),Fu()||(i({title:" Google Sign-in Required",description:"Please sign in with Google to create Meet link",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"}),await c7(),g(!0));const fe=rS(F,te),Me=rS(F,pe),je={summary:`${ve} - Interview (Admin Scheduled)`,description:`Interview scheduled by Admin
Student: ${Z} (${J})
Interviewer: ${U} (${Q})
Topic: ${ve}`,startDateTime:fe,endDateTime:Me,attendeeEmail:J,studentName:Z,attendees:[J,Q].filter(Boolean)};i({title:"Creating Meeting...",description:"Generating Google Meet link...",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});const Qe=await d7(je);if(!Qe.meetLink)throw new Error("Failed to create Google Meet link");const ft={student_id:K,slot_id:ae,title:`${ve} - Interview`,description:`Admin scheduled interview for ${Z}. Topic: ${ve}. Interviewer: ${U}`,meeting_link:Qe.meetLink,google_event_id:Qe.eventId,created_by:"Admin"};await l$(ft),i({title:" Interview Scheduled",description:"Interview scheduled and Meet link created successfully!",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),W(),u(!1),c(null),p(!1)}catch(fe){console.error("Admin scheduling error:",fe),i({title:" Unable to Schedule Interview",description:ut(fe),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{x(!1)}},L=ae=>{if(ae.is_booked)return!1;try{const K=new Date(ae.date),J=new Date;return J.setHours(0,0,0,0),K.setHours(0,0,0,0),K>=J}catch{return!1}},z=ae=>{if(!L(ae)){i({title:" Cannot Delete Slot",description:"Cannot delete booked slots or past date slots",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});return}E(ae),T(!0)},$=async()=>{if(j)try{M(!0),await EV(j.id),i({title:" Slot Deleted",description:"Slot deleted successfully",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),W(),T(!1),E(null)}catch(ae){console.error("Error deleting slot:",ae),i({title:" Unable to Delete Slot",description:ut(ae),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{M(!1)}},V=b.filter(ae=>{const K=new Date(ae.date).toDateString(),J=new Date().toDateString();return K===J}),B=V.filter(ae=>!ae.is_booked).length,Y=V.filter(ae=>ae.is_booked).length,re=ae=>{const[K,J]=ae.split(":"),Z=new Date;return Z.setHours(parseInt(K),parseInt(J)),Z.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};return y.reduce((ae,K)=>{const J=K.date;return ae[J]||(ae[J]=[]),ae[J].push(K),ae},{}),l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Interview Schedule"}),l.jsx("p",{className:"text-muted-foreground",children:"Manage interview slots and availability"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Today's Booked"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:Y})]}),l.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:l.jsx($a,{className:"w-6 h-6 text-primary"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Available Today"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:B})]}),l.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:l.jsx(Ya,{className:"w-6 h-6 text-status-pending"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Total Slots"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:b.length})]}),l.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:l.jsx(ch,{className:"w-6 h-6 text-status-active"})})]})})]}),l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border mb-8",children:[l.jsxs("div",{className:"p-6 border-b border-border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Available Slots Management"}),l.jsx("div",{className:"flex gap-3",children:l.jsxs(le,{onClick:()=>t(!0),className:"bg-gradient-primary hover:bg-primary/90 text-white",children:[l.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Slots"]})})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex-1 max-w-xs",children:[l.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Filter by Date"}),l.jsx("input",{type:"date",value:S,onChange:q,className:"w-full p-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),S&&l.jsx(le,{variant:"outline",onClick:P,className:"mt-6",children:"Clear Filter"})]})]}),l.jsx("div",{className:"p-6",children:C?l.jsx("div",{className:"text-center text-muted-foreground py-8",children:"Loading slots..."}):y.length===0?l.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[l.jsx($a,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),l.jsx("p",{className:"text-lg mb-2",children:S?`No slots available for ${new Date(S).toLocaleDateString()}`:"No slots available"}),l.jsx("p",{className:"text-sm",children:'Click "Add Slots" to create new interview slots'})]}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-muted/30 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Date"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Slot Type"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Start Time"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"End Time"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),l.jsx("tbody",{children:y.map(ae=>l.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground",children:new Date(ae.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ae.slot_type==="LR"?"bg-blue-100 text-blue-800":ae.slot_type==="CFR"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:ae.slot_type==="LR"?"Learning Round":ae.slot_type==="CFR"?"Cultural Fit Round":ae.slot_type||"N/A"})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground font-medium",children:re(ae.start_time)})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground font-medium",children:re(ae.end_time)})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ae.is_booked?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:ae.is_booked?"Booked":"Available"})}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",disabled:ae.is_booked,onClick:()=>{s(ae),n(!0)},title:ae.is_booked?"Cannot edit booked slot":"Edit slot",children:l.jsx(xl,{className:"w-3 h-3 mr-1"})}),l.jsx(le,{variant:"destructive",size:"sm",disabled:!L(ae),onClick:()=>z(ae),title:L(ae)?"Delete slot":"Cannot delete booked or past slots",children:l.jsx(ka,{className:"w-3 h-3 mr-1"})})]})})]},ae.id))})]})})})]})]})}),l.jsx(n_e,{isOpen:e,onClose:()=>t(!1),onSuccess:()=>{t(!1),W()}}),l.jsx(a_e,{isOpen:r,onClose:()=>{n(!1),s(null)},onSuccess:()=>{n(!1),s(null),W()},slotData:a}),l.jsx(o_e,{isOpen:o,onClose:()=>{u(!1),c(null),p(!1)},slotData:d,allAvailableSlots:y,isDirectScheduleMode:h,onSchedule:A,isLoading:m}),l.jsx(yR,{isOpen:I,onClose:()=>{T(!1),E(null)},onConfirm:$,title:"Delete Slot",description:j?`Are you sure you want to delete this slot?

Date: ${new Date(j.date).toLocaleDateString()}
Time: ${re(j.start_time)} - ${re(j.end_time)}
            Slot Type: ${j.slot_type}
This action cannot be revert.`:"",confirmText:"Delete Slot",isLoading:O})]})},u_e=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(""),{toast:i}=Wt(),{user:o}=Do(),u=m=>m.filter(x=>x.stage==="contact"||!x.stage),d=async()=>{try{if(n(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:m,error:x}=await Sr.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(x)throw console.error("Supabase error:",x),x;const y=u(m||[]);t(y)}catch(m){console.error("Error fetching applicants:",m),i({title:" Unable to Load Applicants",description:ut(m),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),t([])}finally{n(!1)}};w.useEffect(()=>{d();const m=Sr.channel("sourcing_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},x=>{console.log("Real-time update received:",x),d()}).subscribe();return()=>{console.log("Cleaning up sourcing page subscription"),Sr.removeChannel(m)}},[]);const c=e.filter(m=>{var x,y,v;return(((x=m.name)==null?void 0:x.toLowerCase().includes(a.toLowerCase()))||m.mobile_no.toLowerCase().includes(a.toLowerCase())||((y=m.city)==null?void 0:y.toLowerCase().includes(a.toLowerCase()))||((v=m.unique_number)==null?void 0:v.toLowerCase().includes(a.toLowerCase())))??!1}),h=c.length,p=c.filter(m=>m.whatsapp_number).length,f=c.filter(m=>!m.date_of_testing).length,g=c.filter(m=>m.final_marks!==null).length;return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Sourcing & Outreach"}),l.jsx("p",{className:"text-muted-foreground",children:"Manage initial contact and outreach activities"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Total Contacts"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:h})]}),l.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:l.jsx(pL,{className:"w-6 h-6 text-primary"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Reached Out"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:p})]}),l.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:l.jsx(yE,{className:"w-6 h-6 text-status-active"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Pending Follow-ups"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:f})]}),l.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:l.jsx(Ya,{className:"w-6 h-6 text-status-pending"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Converted to Screening"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:g})]}),l.jsx("div",{className:"w-12 h-12 bg-status-prospect/10 rounded-lg flex items-center justify-center",children:l.jsx(oW,{className:"w-6 h-6 text-status-prospect"})})]})})]}),l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Contact Pipeline"}),l.jsx(le,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Add New Contact"})]}),l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),l.jsx(Ve,{placeholder:"Search by name, phone, or location...",value:a,onChange:m=>s(m.target.value),className:"pl-10 h-9"})]})]}),l.jsx("div",{className:"max-h-96 overflow-y-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-muted/30 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Contact Info"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Location"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),l.jsx("tbody",{children:r?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Loading applicants..."})]})})}):c.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx(pL,{className:"w-8 h-8 opacity-50"}),l.jsx("span",{children:a?"No applicants found matching your search":"No applicants in sourcing stage"})]})})}):c.map(m=>l.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-primary text-sm font-medium",children:m.name?m.name.split(" ").map(x=>x[0]).join(""):"?"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-foreground",children:m.name||"No Name"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:m.mobile_no})]})]})}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"text-sm text-muted-foreground",children:[l.jsx("p",{children:m.whatsapp_number?`WhatsApp: ${m.whatsapp_number}`:"No WhatsApp"}),l.jsx("p",{children:m.mobile_no?`Mobile: ${m.mobile_no}`:"No Mobile"})]})}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(iW,{className:"w-4 h-4 text-muted-foreground"}),l.jsx("span",{className:"text-sm text-foreground",children:m.city?`${m.city}${m.block?`, ${m.block}`:""}`:"Not specified"})]})}),l.jsx("td",{className:"p-4",children:l.jsx(Y9,{status:"pending"})}),l.jsx("td",{className:"p-4",children:l.jsx(le,{variant:"outline",size:"sm",children:"View Details"})})]},m.id))})]})}),l.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",c.length," of ",e.length," ","applicants"]})})]})]})})]})},c_e=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(""),{toast:i}=Wt(),{user:o}=Do(),u=x=>x.filter(y=>y.stage==="screening"),d=async()=>{try{if(n(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:x,error:y}=await Sr.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(y)throw console.error("Supabase error:",y),y;const v=u(x||[]);t(v)}catch(x){console.error("Error fetching applicants:",x),i({title:" Unable to Load Applicants",description:ut(x),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),t([])}finally{n(!1)}};w.useEffect(()=>{d();const x=Sr.channel("screening_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},y=>{console.log("Real-time update received:",y),d()}).subscribe();return()=>{console.log("Cleaning up screening page subscription"),Sr.removeChannel(x)}},[]);const c=e.filter(x=>{var y,v,b;return(((y=x.name)==null?void 0:y.toLowerCase().includes(a.toLowerCase()))||x.mobile_no.toLowerCase().includes(a.toLowerCase())||((v=x.city)==null?void 0:v.toLowerCase().includes(a.toLowerCase()))||((b=x.unique_number)==null?void 0:b.toLowerCase().includes(a.toLowerCase())))??!1}),h=c.length,p=c.filter(x=>{var y;return(y=x.qualifying_school)==null?void 0:y.toLowerCase().includes("programming")}).length,f=c.filter(x=>{var y;return(y=x.qualifying_school)==null?void 0:y.toLowerCase().includes("business")}).length,g=c.length>0?(c.reduce((x,y)=>x+(y.final_marks||0),0)/c.length).toFixed(1):0,m=x=>{var y,v;return x.status==="pass"?(y=x.qualifying_school)!=null&&y.toLowerCase().includes("programming")?"Qualified for SOP":(v=x.qualifying_school)!=null&&v.toLowerCase().includes("business")?"Qualified for SOB":"Pass":x.status||"pending"};return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Screening Tests"}),l.jsx("p",{className:"text-muted-foreground",children:"Monitor online assessment results and qualifications"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Tests Taken"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:h})]}),l.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:l.jsx(yE,{className:"w-6 h-6 text-primary"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Programming Track"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:p})]}),l.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:l.jsx(gue,{className:"w-6 h-6 text-status-active"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Business Track"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:f})]}),l.jsx("div",{className:"w-12 h-12 bg-status-prospect/10 rounded-lg flex items-center justify-center",children:l.jsx(rle,{className:"w-6 h-6 text-status-prospect"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Average Score"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:g})]}),l.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:l.jsx(oW,{className:"w-6 h-6 text-status-pending"})})]})})]}),l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Test Results"}),l.jsx(le,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Export Results"})]}),l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),l.jsx(Ve,{placeholder:"Search by name, phone, or location...",value:a,onChange:x=>s(x.target.value),className:"pl-10 h-9"})]})]}),l.jsx("div",{className:"max-h-96 overflow-y-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-muted/30 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Test Score"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Test Date"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),l.jsx("tbody",{children:r?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Loading applicants..."})]})})}):c.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx(yE,{className:"w-8 h-8 opacity-50"}),l.jsx("span",{children:a?"No applicants found matching your search":"No applicants in screening stage"})]})})}):c.map(x=>l.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-primary text-sm font-medium",children:x.name?x.name.split(" ").map(y=>y[0]).join(""):"?"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-foreground",children:x.name||"No Name"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:x.mobile_no})]})]})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:`text-lg font-bold ${(x.final_marks||0)>=27?"text-status-active":(x.final_marks||0)>=18?"text-status-prospect":"text-status-fail"}`,children:x.final_marks||0})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground font-medium",children:m(x)})}),l.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:x.date_of_testing?new Date(x.date_of_testing).toLocaleDateString():"N/A"}),l.jsx("td",{className:"p-4",children:l.jsx(le,{variant:"outline",size:"sm",children:"View Details"})})]},x.id))})]})}),l.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",c.length," of ",e.length," ","applicants"]})})]})]})})]})},d_e=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(""),{toast:i}=Wt(),{user:o}=Do(),u=x=>x.filter(y=>y.stage==="interviews"),d=async()=>{try{if(n(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:x,error:y}=await Sr.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(y)throw console.error("Supabase error:",y),y;const v=u(x||[]);t(v)}catch(x){console.error("Error fetching applicants:",x),i({title:" Unable to Load Applicants",description:ut(x),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),t([])}finally{n(!1)}};w.useEffect(()=>{d();const x=Sr.channel("interview_rounds_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},y=>{console.log("Real-time update received:",y),d()}).subscribe();return()=>{console.log("Cleaning up interview rounds page subscription"),Sr.removeChannel(x)}},[]);const c=e.filter(x=>{var y,v,b;return(((y=x.name)==null?void 0:y.toLowerCase().includes(a.toLowerCase()))||x.mobile_no.toLowerCase().includes(a.toLowerCase())||((v=x.city)==null?void 0:v.toLowerCase().includes(a.toLowerCase()))||((b=x.unique_number)==null?void 0:b.toLowerCase().includes(a.toLowerCase())))??!1}),h=c.filter(x=>{var y;return(y=x.lr_status)==null?void 0:y.toLowerCase().includes("pass")}).length,p=c.filter(x=>{var y;return(y=x.cfr_status)==null?void 0:y.toLowerCase().includes("pass")}).length,f=c.filter(x=>x.lr_status&&!x.cfr_status).length,g=c.filter(x=>{var y,v;return((y=x.lr_status)==null?void 0:y.toLowerCase().includes("fail"))||((v=x.cfr_status)==null?void 0:v.toLowerCase().includes("fail"))}).length,m=x=>{switch(x){case"booked":return"Booked";case"pending":return"Pending";case"rescheduled":return"Rescheduled";case"lr_qualified":return"LR Qualified";case"lr_failed":return"LR Failed";case"cfr_qualified":return"CFR Qualified";case"cfr_failed":return"CFR Failed";default:return"Pending"}};return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Interview Rounds"}),l.jsx("p",{className:"text-muted-foreground",children:"Track Learning Round and Cultural Fit interview progress"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Learning Round Pass"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:h})]}),l.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:l.jsx(Xd,{className:"w-6 h-6 text-status-active"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Cultural Fit Pass"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:p})]}),l.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:l.jsx(bE,{className:"w-6 h-6 text-status-active"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Pending Interviews"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:f})]}),l.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:l.jsx(Ya,{className:"w-6 h-6 text-status-pending"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Interview Failures"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:g})]}),l.jsx("div",{className:"w-12 h-12 bg-status-fail/10 rounded-lg flex items-center justify-center",children:l.jsx(Md,{className:"w-6 h-6 text-status-fail"})})]})})]}),l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Interview Progress"}),l.jsx(le,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Schedule Next Round"})]}),l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),l.jsx(Ve,{placeholder:"Search by name, phone, or location...",value:a,onChange:x=>s(x.target.value),className:"pl-10 h-9"})]})]}),l.jsx("div",{className:"max-h-96 overflow-y-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-muted/30 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Learning Round"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Cultural Fit Round"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),l.jsx("tbody",{children:r?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Loading applicants..."})]})})}):c.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx(bE,{className:"w-8 h-8 opacity-50"}),l.jsx("span",{children:a?"No applicants found matching your search":"No applicants in interview rounds"})]})})}):c.map(x=>l.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-primary text-sm font-medium",children:x.name?x.name.split(" ").map(y=>y[0]).join(""):"?"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-foreground",children:x.name||"No Name"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:x.mobile_no})]})]})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground font-medium",children:m(x.status)})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground",children:x.lr_status||"Pending"})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground",children:x.cfr_status||"Pending"})}),l.jsx("td",{className:"p-4",children:l.jsx(le,{variant:"outline",size:"sm",children:"View Details"})})]},x.id))})]})}),l.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",c.length," of ",e.length," ","applicants"]})})]})]})})]})},h_e=()=>{const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(""),{toast:i}=Wt(),{user:o}=Do(),u=p=>p.filter(f=>f.stage==="decision"),d=async()=>{try{if(n(!0),!o){console.warn("No active session, skipping data fetch"),t([]);return}const{data:p,error:f}=await Sr.from("admission_dashboard").select("*").order("created_at",{ascending:!1});if(f)throw console.error("Supabase error:",f),f;const g=u(p||[]);t(g)}catch(p){console.error("Error fetching applicants:",p),i({title:" Unable to Load Applicants",description:ut(p),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),t([])}finally{n(!1)}};w.useEffect(()=>{d();const p=Sr.channel("final_decisions_page_changes").on("postgres_changes",{event:"*",schema:"public",table:"admission_dashboard"},f=>{console.log("Real-time update received:",f),d()}).subscribe();return()=>{console.log("Cleaning up final decisions page subscription"),Sr.removeChannel(p)}},[]);const c=e.filter(p=>{var f,g,m;return(((f=p.name)==null?void 0:f.toLowerCase().includes(a.toLowerCase()))||p.mobile_no.toLowerCase().includes(a.toLowerCase())||((g=p.city)==null?void 0:g.toLowerCase().includes(a.toLowerCase()))||((m=p.unique_number)==null?void 0:m.toLowerCase().includes(a.toLowerCase())))??!1}),h=p=>{switch(p){case"offer_pending":return"Offer Letter Pending";case"offer_sent":return"Offer Letter Sent";case"offer_rejected":return"Offer Rejected";case"offer_accepted":return"Offer Accepted";default:return"Pending"}};return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 overflow-auto h-screen",children:l.jsxs("div",{className:"p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Final Decisions"}),l.jsx("p",{className:"text-muted-foreground",children:"Manage offers, acceptances, and onboarding process"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Offers Sent"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:c.filter(p=>p.status==="offer_sent").length})]}),l.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:l.jsx(uh,{className:"w-6 h-6 text-status-pending"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Offers Accepted"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:c.filter(p=>p.status==="offer_accepted").length})]}),l.jsx("div",{className:"w-12 h-12 bg-status-active/10 rounded-lg flex items-center justify-center",children:l.jsx(P1,{className:"w-6 h-6 text-status-active"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Successfully Onboarded"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:c.filter(p=>p.joining_status==="Joined"||p.joining_status==="joined").length})]}),l.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:l.jsx(P1,{className:"w-6 h-6 text-primary"})})]})}),l.jsx("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Pending Responses"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:c.filter(p=>p.status==="offer_sent"&&(!p.joining_status||p.joining_status==="pending")).length})]}),l.jsx("div",{className:"w-12 h-12 bg-status-pending/10 rounded-lg flex items-center justify-center",children:l.jsx(Ya,{className:"w-6 h-6 text-status-pending"})})]})})]}),l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Final Decision Pipeline"}),l.jsx(le,{className:"bg-gradient-primary hover:bg-primary/90 text-white",children:"Send Offer Letters"})]}),l.jsxs("div",{className:"relative max-w-md",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),l.jsx(Ve,{placeholder:"Search by name, phone, or location...",value:a,onChange:p=>s(p.target.value),className:"pl-10 h-9"})]})]}),l.jsx("div",{className:"max-h-96 overflow-y-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-muted/30 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Applicant"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Status"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Allotted School"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Joining Status"}),l.jsx("th",{className:"text-left p-4 font-medium text-muted-foreground text-sm",children:"Actions"})]})}),l.jsx("tbody",{children:r?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Loading applicants..."})]})})}):c.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx(P1,{className:"w-8 h-8 opacity-50"}),l.jsx("span",{children:a?"No applicants found matching your search":"No applicants in final decisions stage"})]})})}):c.map(p=>l.jsxs("tr",{className:"border-b border-border hover:bg-muted/20 transition-colors",children:[l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-primary text-sm font-medium",children:p.name?p.name.split(" ").map(f=>f[0]).join(""):"?"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-foreground",children:p.name||"No Name"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:p.mobile_no})]})]})}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground font-medium",children:h(p.status)})}),l.jsx("td",{className:"p-4 text-sm text-foreground",children:p.allotted_school||"Not Assigned"}),l.jsx("td",{className:"p-4",children:l.jsx("span",{className:"text-sm text-foreground",children:p.joining_status||"Pending"})}),l.jsx("td",{className:"p-4",children:l.jsx(le,{variant:"outline",size:"sm",children:p.status==="offer_sent"&&!p.joining_status?"Send Reminder":"View Details"})})]},p.id))})]})}),l.jsx("div",{className:"px-6 py-4 border-t border-border/50 bg-muted/20",children:l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",c.length," of ",e.length," ","applicants"]})})]})]})})]})},p_e=({content:e,onChange:t})=>{const r=w.useRef(null),n=w.useRef(null),[a,s]=w.useState(null),{toast:i}=Wt();w.useEffect(()=>{r.current&&r.current.innerHTML!==e&&(r.current.innerHTML=e,setTimeout(()=>{o()},100))},[e]);const o=()=>{if(!r.current)return;r.current.querySelectorAll("img").forEach(v=>{var N;const b=v.cloneNode(!0);(N=v.parentNode)==null||N.replaceChild(b,v),b.style.cursor="pointer",b.style.maxWidth="100%",b.style.height="auto",b.style.display="block",b.style.border="2px solid transparent",b.style.transition="all 0.2s ease",b.style.userSelect="none",b.addEventListener("click",S=>{S.preventDefault(),S.stopPropagation(),u(b)}),b.addEventListener("mouseenter",()=>{a!==b&&(b.style.border="2px solid #3b82f6",b.style.transform="scale(1.02)")}),b.addEventListener("mouseleave",()=>{a!==b&&(b.style.border="2px solid transparent",b.style.transform="scale(1)")})})},u=y=>{a&&a!==y&&(a.style.border="2px solid transparent",a.style.boxShadow="none",a.style.transform="scale(1)"),s(y),y.style.border="2px solid #3b82f6",y.style.boxShadow="0 0 10px rgba(59, 130, 246, 0.4)",y.style.transform="scale(1.05)",console.log("Image selected:",y.src),i({title:"Image Selected",description:"Use the controls below to adjust the image."})},d=y=>{var N;if(!a){i({title:"No Image Selected",description:"Please click on an image first to align it.",variant:"destructive"});return}console.log("Aligning image to:",y);const v=document.createElement("div");v.style.width="100%",v.style.margin="10px 0",v.style.clear="both";const b=a.cloneNode(!0);switch(y){case"left":v.style.textAlign="left",b.style.float="left",b.style.marginRight="15px",b.style.marginBottom="10px";break;case"center":v.style.textAlign="center",b.style.float="none",b.style.margin="0 auto 10px auto",b.style.display="block";break;case"right":v.style.textAlign="right",b.style.float="right",b.style.marginLeft="15px",b.style.marginBottom="10px";break}v.appendChild(b),(N=a.parentNode)==null||N.replaceChild(v,a),s(b),p(),i({title:"Image Aligned",description:`Image aligned to ${y}`})},c=y=>{if(!a){i({title:"No Image Selected",description:"Please click on an image first to resize it.",variant:"destructive"});return}console.log("Resizing image to:",y);let v="",b="";switch(y){case"small":v="200px",b="200px";break;case"medium":v="400px",b="400px";break;case"large":v="600px",b="600px";break}a.style.width=v,a.style.maxWidth=b,a.style.height="auto",p(),i({title:"Image Resized",description:`Image resized to ${y}`})},h=(y,v)=>{try{document.execCommand(y,!1,v),p()}catch(b){console.error("Error executing command:",y,b)}},p=()=>{r.current&&(t(r.current.innerHTML),setTimeout(()=>{o()},100))},f=async y=>{var b;const v=(b=y.clipboardData)==null?void 0:b.items;if(v){for(let N=0;N<v.length;N++){const S=v[N];if(S.type.startsWith("image/")){y.preventDefault();const _=S.getAsFile();if(_){console.log("Pasting image from clipboard"),await g(_);return}}}setTimeout(()=>{p()},0)}},g=async y=>{var v,b,N,S;try{if(console.log("Starting image upload:",y.name||"clipboard-image"),!y.type.startsWith("image/")){i({title:"Invalid File",description:"Please select an image file",variant:"destructive"});return}i({title:"Uploading Image",description:"Please wait while your image is being uploaded..."});const _=((v=y.name)==null?void 0:v.split(".").pop())||y.type.split("/")[1]||"png",k=`template-images/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${_}`}`;console.log("Uploading to path:",k);const{error:I}=await Sr.storage.from("offer-pdfs").upload(k,y);if(I)throw console.error("Image upload error:",I),I;const{data:T}=Sr.storage.from("offer-pdfs").getPublicUrl(k);if(T!=null&&T.publicUrl){console.log("Image uploaded successfully:",T.publicUrl),r.current&&r.current.focus();const j=`
          <div style="text-align: center; margin: 15px 0; clear: both;">
            <img src="${T.publicUrl}" 
                 style="max-width: 100%; height: auto; display: block; margin: 0 auto; border: 2px solid transparent; cursor: pointer; transition: all 0.2s ease;" 
                 alt="Uploaded image" />
          </div>
        `;if((b=document.getSelection())!=null&&b.rangeCount){const E=(N=document.getSelection())==null?void 0:N.getRangeAt(0);if(E&&((S=r.current)!=null&&S.contains(E.commonAncestorContainer))){E.deleteContents();const O=document.createElement("div");O.innerHTML=j,E.insertNode(O)}else r.current&&(r.current.innerHTML+=j)}else r.current&&(r.current.innerHTML+=j);p(),i({title:"Image Uploaded Successfully",description:"Click on the image to select and modify its alignment or size."})}}catch(_){console.error("Error uploading image:",_),i({title:"Upload Error",description:"Failed to upload image. Please try again.",variant:"destructive"})}},m=y=>{var b;const v=(b=y.target.files)==null?void 0:b[0];v&&(console.log("File selected via input:",v.name),g(v)),n.current&&(n.current.value="")},x=y=>{y.target.tagName!=="IMG"&&a&&(a.style.border="2px solid transparent",a.style.boxShadow="none",a.style.transform="scale(1)",s(null))};return l.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"border-b bg-muted/50 p-2 flex gap-1 flex-wrap",children:[l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("bold"),type:"button",children:l.jsx(ale,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("italic"),type:"button",children:l.jsx(Ple,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("underline"),type:"button",children:l.jsx(bue,{className:"h-4 w-4"})}),l.jsx("div",{className:"w-px bg-border mx-1"}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("justifyLeft"),type:"button",children:l.jsx(Qoe,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("justifyCenter"),type:"button",children:l.jsx(Goe,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("justifyRight"),type:"button",children:l.jsx(Yoe,{className:"h-4 w-4"})}),l.jsx("div",{className:"w-px bg-border mx-1"}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("insertUnorderedList"),type:"button",children:l.jsx(Xle,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h("insertOrderedList"),type:"button",children:l.jsx(Kle,{className:"h-4 w-4"})}),l.jsx("div",{className:"w-px bg-border mx-1"}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>{var y;return(y=n.current)==null?void 0:y.click()},type:"button",children:l.jsx($g,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>{const y=prompt("Enter link URL:");y&&h("createLink",y)},type:"button",children:l.jsx(Vle,{className:"h-4 w-4"})})]}),a&&l.jsxs("div",{className:"border-b bg-blue-50 p-3",children:[l.jsx("div",{className:"text-sm font-medium text-blue-900 mb-3",children:"Image Controls - Click to Apply"}),l.jsxs("div",{className:"flex gap-3 flex-wrap",children:[l.jsxs("div",{className:"flex gap-1",children:[l.jsx(le,{size:"sm",variant:"outline",onClick:()=>d("left"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:" Left"}),l.jsx(le,{size:"sm",variant:"outline",onClick:()=>d("center"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:" Center"}),l.jsx(le,{size:"sm",variant:"outline",onClick:()=>d("right"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Right "})]}),l.jsx("div",{className:"w-px bg-border mx-1"}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx(le,{size:"sm",variant:"outline",onClick:()=>c("small"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Small"}),l.jsx(le,{size:"sm",variant:"outline",onClick:()=>c("medium"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Medium"}),l.jsx(le,{size:"sm",variant:"outline",onClick:()=>c("large"),type:"button",className:"text-xs px-3 bg-white hover:bg-blue-100",children:"Large"})]})]}),l.jsxs("div",{className:"text-xs text-blue-600 mt-2",children:["Selected image: ",a.alt||"Unnamed image"]})]}),l.jsx("div",{ref:r,contentEditable:!0,className:"min-h-[400px] p-4 focus:outline-none prose max-w-none",onInput:p,onPaste:f,onClick:x,suppressContentEditableWarning:!0,style:{lineHeight:"1.6"}}),l.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:m,className:"hidden"})]})},K3=e=>{switch(e){case"admission_dashboard":return l.jsx(vE,{className:"h-3 w-3"});case"user_input":return l.jsx(yo,{className:"h-3 w-3"});case"system_generated":return l.jsx($a,{className:"h-3 w-3"});default:return l.jsx(xo,{className:"h-3 w-3"})}},f_e=e=>{switch(e){case"admission_dashboard":return"bg-blue-100 text-blue-800";case"user_input":return"bg-green-100 text-green-800";case"system_generated":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},m_e=[{id:"default-1",placeholder_key:"STUDENT_NAME",display_name:"Student Name",description:"Name of the student from admission dashboard",data_source:"admission_dashboard",is_active:!0},{id:"default-2",placeholder_key:"MOBILE_NUMBER",display_name:"Mobile Number",description:"Student mobile number",data_source:"admission_dashboard",is_active:!0},{id:"default-3",placeholder_key:"CAMPUS",display_name:"Campus",description:"Assigned campus",data_source:"admission_dashboard",is_active:!0},{id:"default-4",placeholder_key:"ALLOTTED_SCHOOL",display_name:"Allotted School",description:"School allotted to the student",data_source:"admission_dashboard",is_active:!0},{id:"default-5",placeholder_key:"FINAL_MARKS",display_name:"Final Marks",description:"Final examination marks",data_source:"admission_dashboard",is_active:!0},{id:"default-6",placeholder_key:"INTERVIEW_DATE",display_name:"Interview Date",description:"Scheduled interview date",data_source:"admission_dashboard",is_active:!0}],g_e=({onInsertPlaceholder:e})=>{const[t,r]=w.useState(""),{toast:n}=Wt(),{data:a,isLoading:s}=Og({queryKey:["offer-placeholders"],queryFn:async()=>{const{data:c,error:h}=await Sr.from("offer_placeholders").select("*").eq("is_active",!0).order("display_name");if(h)throw h;return c||[]}}),o=[...m_e,...a||[]].filter(c=>{var h;return c.display_name.toLowerCase().includes(t.toLowerCase())||c.placeholder_key.toLowerCase().includes(t.toLowerCase())||((h=c.description)==null?void 0:h.toLowerCase().includes(t.toLowerCase()))}),u=(c,h)=>{e(c),n({title:"Placeholder Inserted",description:`Added {{${c}}} to the template`})},d=o.reduce((c,h)=>{const p=h.data_source;return c[p]||(c[p]=[]),c[p].push(h),c},{});return s?l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{className:"text-sm",children:"Placeholders"})}),l.jsx(jt,{children:l.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading placeholders..."})})]}):l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[l.jsx(Wn,{className:"h-4 w-4"}),"Insert Placeholders"]})}),l.jsxs(jt,{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Ja,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),l.jsx(Ve,{placeholder:"Search placeholders...",value:t,onChange:c=>r(c.target.value),className:"pl-8 text-sm"})]}),l.jsx("div",{className:"text-xs text-muted-foreground",children:"Click any placeholder below to insert it into your template. Placeholders will be replaced with actual data when sending offers."}),l.jsx(iR,{className:"h-[400px]",children:l.jsx("div",{className:"space-y-3",children:Object.entries(d).map(([c,h])=>l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[K3(c),l.jsx("span",{className:"text-xs font-medium capitalize",children:c.replace("_"," ")}),l.jsx(Kn,{variant:"secondary",className:"text-xs",children:h.length})]}),l.jsx("div",{className:"space-y-1 pl-4",children:h.map(p=>l.jsx("div",{className:"group",children:l.jsx(le,{variant:"ghost",size:"sm",className:"w-full justify-start text-left h-auto p-2 hover:bg-muted/50",onClick:()=>u(p.placeholder_key,p.display_name),children:l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"text-xs font-medium truncate",children:p.display_name}),l.jsx(Kn,{variant:"outline",className:`text-xs ${f_e(p.data_source)}`,children:K3(p.data_source)})]}),l.jsx("div",{className:"text-xs text-muted-foreground font-mono truncate",children:`{{${p.placeholder_key}}}`}),p.description&&l.jsx("div",{className:"text-xs text-muted-foreground mt-1 leading-tight",children:p.description})]})})},p.id))})]},c))})}),l.jsx("div",{className:"pt-2 border-t",children:l.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[l.jsx("div",{className:"font-medium",children:"Available Data Sources:"}),l.jsxs("div",{children:[" ",l.jsx("strong",{children:"Admission Dashboard:"})," Student data from All Applicants"]}),l.jsxs("div",{children:[" ",l.jsx("strong",{children:"User Input:"})," Custom values entered during send"]}),l.jsxs("div",{children:[" ",l.jsx("strong",{children:"System Generated:"})," Auto-generated values"]})]})})]})]})},x_e=({isOpen:e,onClose:t,onDocumentUploaded:r})=>{const[n,a]=w.useState(!1),s=w.useRef(null),{toast:i}=Wt(),o=async()=>window.mammoth?window.mammoth:new Promise((h,p)=>{const f=document.createElement("script");f.src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js",f.onload=()=>{window.mammoth?h(window.mammoth):p(new Error("Mammoth library not loaded properly"))},f.onerror=()=>p(new Error("Failed to load mammoth library")),document.head.appendChild(f)}),u=async h=>{try{const p=await o(),f=await h.arrayBuffer(),g={convertImage:async y=>{try{console.log("Processing embedded image...");const v=await y.read(),b=new Blob([v],{type:y.contentType||"image/png"}),N=y.contentType?y.contentType.split("/")[1]:"png",_=`template-images/${`template-image-${Date.now()}-${Math.random().toString(36).substr(2,9)}.${N}`}`,{error:C}=await Sr.storage.from("offer-pdfs").upload(_,b);if(C)return console.error("Image upload error:",C),{src:""};const{data:k}=Sr.storage.from("offer-pdfs").getPublicUrl(_);return console.log("Image uploaded successfully:",k.publicUrl),{src:k.publicUrl}}catch(v){return console.error("Error processing embedded image:",v),{src:""}}},styleMap:["p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Title'] => h1.title:fresh","p[style-name='Subtitle'] => h2.subtitle:fresh","r[style-name='Strong'] => strong","r[style-name='Emphasis'] => em"],ignoreEmptyParagraphs:!1,includeDefaultStyleMap:!0};console.log("Starting document conversion...");const m=await p.convertToHtml({arrayBuffer:f},g);if(m.messages&&m.messages.length>0){console.log("Conversion messages:",m.messages);const y=m.messages.filter(v=>v.type==="error");y.length>0&&console.error("Conversion errors:",y)}const x=`
        <div style="font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; max-width: 800px; margin: 0 auto;">
          ${m.value}
        </div>
      `;return console.log("Document converted successfully"),x}catch(p){console.error("Document conversion error:",p);try{console.log("Attempting simplified conversion...");const f=await o(),g=await h.arrayBuffer(),m={convertImage:()=>({src:""}),ignoreEmptyParagraphs:!0};return`
          <div style="font-family: Arial, sans-serif; line-height: 1.6; padding: 20px;">
            ${(await f.convertToHtml({arrayBuffer:g},m)).value}
            <p style="color: #666; font-style: italic; margin-top: 20px;">
              Note: Images from the original document were not included in this conversion. 
              You can add images manually using the editor tools.
            </p>
          </div>
        `}catch(f){throw console.error("Fallback conversion also failed:",f),new Error("Document conversion failed. This document may be too complex or corrupted. Please try with a simpler document.")}}},d=async h=>{if(!h.name.toLowerCase().endsWith(".docx")){i({title:"Invalid File Type",description:"Please upload a .docx file.",variant:"destructive"});return}a(!0);try{console.log("Starting file upload for:",h.name);const p=h.name.split(".").pop(),g=`template-docs/${`${Date.now()}-${Math.random().toString(36).substr(2,9)}.${p}`}`,{error:m}=await Sr.storage.from("offer-pdfs").upload(g,h);m&&console.error("File backup upload error:",m),console.log("Converting document to HTML...");const x=await u(h);console.log("Document converted successfully"),r(x),i({title:"Document Converted Successfully",description:"Your document has been converted and loaded into the editor."}),t()}catch(p){console.error("Conversion error:",p),i({title:"Conversion Error",description:p instanceof Error?p.message:"Failed to convert document. Please try again.",variant:"destructive"})}finally{a(!1)}},c=h=>{var f;const p=(f=h.target.files)==null?void 0:f[0];p&&d(p)};return l.jsx(Wr,{open:e,onOpenChange:t,children:l.jsxs(Vr,{className:"max-w-md",children:[l.jsx(Hr,{children:l.jsx(qr,{children:"Upload Document Template"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"text-sm text-muted-foreground",children:"Upload a .docx file to convert it to an editable HTML template."}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ee,{htmlFor:"document-upload",children:"Select Document"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ve,{id:"document-upload",type:"file",accept:".docx",ref:s,onChange:c,disabled:n}),l.jsxs(le,{type:"button",variant:"outline",onClick:()=>{var h;return(h=s.current)==null?void 0:h.click()},disabled:n,children:[n?l.jsx(Zle,{className:"h-4 w-4 animate-spin mr-2"}):l.jsx($g,{className:"h-4 w-4 mr-2"}),"Browse"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg text-sm",children:[l.jsx(xo,{className:"h-4 w-4 text-blue-600"}),l.jsxs("div",{className:"text-blue-800",children:[l.jsx("div",{className:"font-medium",children:"Supported format:"}),l.jsx("div",{children:" .docx files only"}),l.jsx("div",{className:"text-xs mt-1 text-blue-600",children:"Note: Complex documents with many images may take longer to process."})]})]})]})]})})},y_e=({templateId:e,isNew:t,onClose:r})=>{const{toast:n}=Wt(),a=p_(),[s,i]=w.useState(!1),[o,u]=w.useState(!1),[d,c]=w.useState({name:"",template_type:"offer_letter",language:"en",program_type:"",html_content:""}),{data:h,isLoading:p}=Og({queryKey:["offer-template",e],queryFn:async()=>{if(!e)return null;const{data:v,error:b}=await Sr.from("offer_templates").select("*").eq("id",e).single();if(b)throw b;return v},enabled:!!e&&!t});w.useEffect(()=>{h&&c({name:h.name,template_type:h.template_type,language:h.language,program_type:h.program_type||"",html_content:h.html_content})},[h]);const f=B1({mutationFn:async v=>{const b={...v,program_type:v.template_type==="offer_letter"?v.program_type:null};if(t){const{error:N}=await Sr.from("offer_templates").insert([b]);if(N)throw N}else{const{error:N}=await Sr.from("offer_templates").update(b).eq("id",e);if(N)throw N}},onSuccess:()=>{n({title:"Template saved",description:"Template has been successfully saved"}),a.invalidateQueries({queryKey:["offer-templates"]}),r()},onError:v=>{if(console.error("Save error:",v),(v==null?void 0:v.code)==="23505"&&v.message.includes("offer_templates_name_unique")){n({title:"Duplicate Template Name",description:`A template with the name "${d.name}" already exists. Please choose a different name.`,variant:"destructive"});return}n({title:"Error",description:"Failed to save template. Please check all required fields.",variant:"destructive"})}}),g=()=>{if(!d.name.trim()){n({title:"Validation Error",description:"Template name is required",variant:"destructive"});return}if(!d.html_content.trim()){n({title:"Validation Error",description:"Template content is required",variant:"destructive"});return}if(d.template_type==="offer_letter"&&(!d.program_type||!d.program_type.trim())){n({title:"Validation Error",description:"Program type is required for offer letter templates",variant:"destructive"});return}f.mutate(d)},m=v=>{c(b=>({...b,template_type:v,program_type:v==="offer_letter"?b.program_type:""}))},x=v=>{c(b=>({...b,html_content:v}))},y=v=>{c(b=>({...b,html_content:b.html_content+`{{${v}}}`}))};return p&&!t?l.jsx("div",{children:"Loading template..."}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs(le,{variant:"ghost",onClick:r,children:[l.jsx(EA,{className:"h-4 w-4 mr-2"}),"Back to Templates"]})}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(le,{variant:"outline",onClick:()=>u(!0),children:[l.jsx($g,{className:"h-4 w-4 mr-2"}),"Upload Doc"]}),l.jsxs(le,{variant:"outline",onClick:()=>i(!0),children:[l.jsx(jg,{className:"h-4 w-4 mr-2"}),"Preview"]}),l.jsxs(le,{onClick:g,disabled:f.isPending,children:[l.jsx(Ag,{className:"h-4 w-4 mr-2"}),f.isPending?"Saving...":"Save Template"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Template Details"})}),l.jsxs(jt,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"name",children:"Template Name *"}),l.jsx(Ve,{id:"name",value:d.name,onChange:v=>c(b=>({...b,name:v.target.value})),placeholder:"Enter template name"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"template_type",children:"Template Type *"}),l.jsxs(Gr,{value:d.template_type,onValueChange:m,children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select type"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"offer_letter",children:"Offer Letter Only"}),l.jsx(gt,{value:"consent_form",children:"Consent Form Only"}),l.jsx(gt,{value:"checklist",children:"Checklist Only"}),l.jsx(gt,{value:"complete_package",children:"Complete Package (Letter + Consent + Checklist)"})]})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"language",children:"Language *"}),l.jsxs(Gr,{value:d.language,onValueChange:v=>c(b=>({...b,language:v})),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select language"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"en",children:"English"}),l.jsx(gt,{value:"hi",children:"Hindi"})]})]})]}),d.template_type==="offer_letter"&&l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"program_type",children:"Program Type *"}),l.jsxs(Gr,{value:d.program_type,onValueChange:v=>c(b=>({...b,program_type:v})),children:[l.jsx(Fr,{children:l.jsx(Kr,{placeholder:"Select program"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"SOP",children:"School of Programming"}),l.jsx(gt,{value:"SOB",children:"School of Business"})]})]})]})]}),d.template_type==="complete_package"&&l.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Complete Package Template"}),l.jsx("p",{className:"text-sm text-blue-700",children:"This template will send the offer letter, consent form, and checklist together in a single email. Structure your content with clear sections for each document type."}),l.jsxs("div",{className:"mt-3 p-3 bg-white rounded border text-sm",children:[l.jsx("strong",{children:"Suggested Structure:"}),l.jsxs("ul",{className:"mt-2 space-y-1 text-blue-600",children:[l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Section 1:"})," Offer Letter with admission details"]}),l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Section 2:"})," Consent Form for enrollment confirmation"]}),l.jsxs("li",{children:[" ",l.jsx("strong",{children:"Section 3:"})," Checklist of required documents and next steps"]})]})]})]})]})]}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(Lt,{children:"Template Content *"}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[l.jsx(xo,{className:"h-4 w-4"}),l.jsx("span",{children:"Upload .docx files or edit directly"})]})]})}),l.jsxs(jt,{children:[l.jsx("div",{className:"mb-4 p-3 bg-amber-50 rounded-lg border border-amber-200",children:l.jsxs("div",{className:"text-sm text-amber-800",children:[l.jsx("div",{className:"font-medium mb-1",children:"Data Integration:"}),l.jsxs("div",{children:[" Use placeholders like ",l.jsx("code",{children:"{{STUDENT_NAME}}"})," ","to insert data from All Applicants table"]}),l.jsx("div",{children:" Placeholders will be automatically replaced with actual student data when sending offers"}),l.jsx("div",{children:" You can copy/paste images directly into the editor"})]})}),l.jsx(p_e,{content:d.html_content,onChange:v=>c(b=>({...b,html_content:v}))})]})]})]}),l.jsx("div",{className:"lg:col-span-1",children:l.jsx(g_e,{onInsertPlaceholder:y})})]})]}),l.jsx(Wr,{open:s,onOpenChange:i,children:l.jsxs(Vr,{className:"max-w-4xl max-h-[80vh] overflow-auto",children:[l.jsx(Hr,{children:l.jsx(qr,{children:"Template Preview"})}),l.jsx("div",{className:"p-6 border rounded bg-white",dangerouslySetInnerHTML:{__html:d.html_content}})]})}),l.jsx(x_e,{isOpen:o,onClose:()=>u(!1),onDocumentUploaded:x})]})},v_e=({onEditTemplate:e})=>{const{toast:t}=Wt(),{data:r,isLoading:n,refetch:a}=Og({queryKey:["offer-templates"],queryFn:async()=>{const{data:o,error:u}=await Sr.from("offer_templates").select("*").eq("is_active",!0).order("updated_at",{ascending:!1});if(u)throw u;return o}}),s=async o=>{try{const{error:u}=await Sr.from("offer_templates").insert({name:`${o.name} (Copy)`,template_type:o.template_type,language:o.language,program_type:o.program_type,html_content:o.html_content,version_number:1});if(u)throw u;t({title:"Template duplicated",description:"Template has been successfully duplicated"}),a()}catch{t({title:"Error",description:"Failed to duplicate template",variant:"destructive"})}},i=async o=>{try{const{error:u}=await Sr.from("offer_templates").update({is_active:!1}).eq("id",o);if(u)throw u;t({title:"Template deleted",description:"Template has been successfully deleted"}),a()}catch{t({title:"Error",description:"Failed to delete template",variant:"destructive"})}};return n?l.jsx("div",{children:"Loading templates..."}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r==null?void 0:r.map(o=>l.jsxs(Et,{className:"hover:shadow-md transition-shadow",children:[l.jsx(Pt,{className:"pb-3",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx(Lt,{className:"text-lg",children:o.name}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>e(o.id),children:l.jsx(xl,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>s(o),children:l.jsx(Sle,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:l.jsx(ka,{className:"h-4 w-4"})})]})]})}),l.jsx(jt,{children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.jsx(Kn,{variant:"secondary",children:o.template_type}),l.jsx(Kn,{variant:"outline",children:o.language.toUpperCase()}),o.program_type&&l.jsx(Kn,{children:o.program_type})]}),l.jsxs("p",{className:"text-sm text-muted-foreground",children:["Version ",o.version_number]}),l.jsxs("p",{className:"text-xs text-muted-foreground",children:["Updated ",new Date(o.updated_at).toLocaleDateString()]})]})})]},o.id))})},b_e=()=>{const[e,t]=w.useState(""),[r,n]=w.useState("all"),{data:a,isLoading:s,refetch:i}=Og({queryKey:["offer-history",e,r],queryFn:async()=>{let u=Sr.from("offer_history").select(`
          *,
          admission_dashboard(name, mobile_no, campus)
        `).order("created_at",{ascending:!1});r!=="all"&&(u=u.eq("email_status",r));const{data:d,error:c}=await u;if(c)throw c;return d}}),o=u=>{switch(u){case"sent":return"default";case"delivered":return"secondary";case"opened":return"default";case"bounced":return"destructive";case"failed":return"destructive";default:return"outline"}};return s?l.jsx("div",{children:"Loading offer history..."}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-2xl font-bold",children:"Offer History"}),l.jsxs(le,{onClick:()=>i(),variant:"outline",children:[l.jsx(AA,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex gap-4 items-center",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"relative",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),l.jsx(Ve,{placeholder:"Search by applicant name...",value:e,onChange:u=>t(u.target.value),className:"pl-10"})]})}),l.jsxs(Gr,{value:r,onValueChange:n,children:[l.jsx(Fr,{className:"w-[180px]",children:l.jsx(Kr,{placeholder:"Filter by status"})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"all",children:"All Statuses"}),l.jsx(gt,{value:"pending",children:"Pending"}),l.jsx(gt,{value:"sent",children:"Sent"}),l.jsx(gt,{value:"delivered",children:"Delivered"}),l.jsx(gt,{value:"opened",children:"Opened"}),l.jsx(gt,{value:"bounced",children:"Bounced"}),l.jsx(gt,{value:"failed",children:"Failed"})]})]})]})}),l.jsx(jt,{children:l.jsxs(yi,{children:[l.jsx(vi,{children:l.jsxs(or,{children:[l.jsx(ct,{children:"Applicant"}),l.jsx(ct,{children:"Campus"}),l.jsx(ct,{children:"Status"}),l.jsx(ct,{children:"Sent At"}),l.jsx(ct,{children:"Actions"})]})}),l.jsx(bi,{children:a==null?void 0:a.map(u=>{var d,c,h;return l.jsxs(or,{children:[l.jsx(Xe,{children:l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:(d=u.admission_dashboard)==null?void 0:d.name}),l.jsx("p",{className:"text-sm text-muted-foreground",children:(c=u.admission_dashboard)==null?void 0:c.mobile_no})]})}),l.jsx(Xe,{children:(h=u.admission_dashboard)==null?void 0:h.campus}),l.jsx(Xe,{children:l.jsx(Kn,{variant:o(u.email_status),children:u.email_status})}),l.jsx(Xe,{children:u.sent_at?new Date(u.sent_at).toLocaleString():"Not sent"}),l.jsx(Xe,{children:l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{variant:"ghost",size:"sm",children:l.jsx(Fi,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",children:"Resend"})]})})]},u.id)})})]})})]})]})},w_e=()=>{const{toast:e}=Wt(),t=p_(),[r,n]=w.useState(!1),[a,s]=w.useState(null),[i,o]=w.useState({placeholder_key:"",display_name:"",description:"",data_source:"admission_dashboard",field_mapping:"",conditional_logic:""}),{data:u,isLoading:d}=Og({queryKey:["all-placeholders"],queryFn:async()=>{const{data:y,error:v}=await Sr.from("offer_placeholders").select("*").order("display_name");if(v)throw v;return y}}),c=B1({mutationFn:async y=>{const v={...y,field_mapping:y.field_mapping?JSON.parse(y.field_mapping):null,conditional_logic:y.conditional_logic?JSON.parse(y.conditional_logic):null};if(a){const{error:b}=await Sr.from("offer_placeholders").update(v).eq("id",a.id);if(b)throw b}else{const{error:b}=await Sr.from("offer_placeholders").insert([v]);if(b)throw b}},onSuccess:()=>{e({title:"Success",description:`Placeholder ${a?"updated":"created"} successfully`}),t.invalidateQueries({queryKey:["all-placeholders"]}),t.invalidateQueries({queryKey:["offer-placeholders"]}),f()},onError:y=>{console.error("Save error:",y),e({title:"Error",description:"Failed to save placeholder",variant:"destructive"})}}),h=B1({mutationFn:async y=>{const{error:v}=await Sr.from("offer_placeholders").delete().eq("id",y);if(v)throw v},onSuccess:()=>{e({title:"Success",description:"Placeholder deleted successfully"}),t.invalidateQueries({queryKey:["all-placeholders"]}),t.invalidateQueries({queryKey:["offer-placeholders"]})},onError:y=>{console.error("Delete error:",y),e({title:"Error",description:"Failed to delete placeholder",variant:"destructive"})}}),p=B1({mutationFn:async({id:y,is_active:v})=>{const{error:b}=await Sr.from("offer_placeholders").update({is_active:v}).eq("id",y);if(b)throw b},onSuccess:()=>{t.invalidateQueries({queryKey:["all-placeholders"]}),t.invalidateQueries({queryKey:["offer-placeholders"]})}}),f=()=>{o({placeholder_key:"",display_name:"",description:"",data_source:"admission_dashboard",field_mapping:"",conditional_logic:""}),s(null),n(!1)},g=y=>{o({placeholder_key:y.placeholder_key,display_name:y.display_name,description:y.description||"",data_source:y.data_source,field_mapping:y.field_mapping?JSON.stringify(y.field_mapping,null,2):"",conditional_logic:y.conditional_logic?JSON.stringify(y.conditional_logic,null,2):""}),s(y),n(!0)},m=()=>{if(!i.placeholder_key.trim()||!i.display_name.trim()){e({title:"Validation Error",description:"Placeholder key and display name are required",variant:"destructive"});return}if(i.field_mapping)try{JSON.parse(i.field_mapping)}catch{e({title:"Validation Error",description:"Field mapping must be valid JSON",variant:"destructive"});return}if(i.conditional_logic)try{JSON.parse(i.conditional_logic)}catch{e({title:"Validation Error",description:"Conditional logic must be valid JSON",variant:"destructive"});return}c.mutate(i)},x=y=>{y==="allotted_school"?o(v=>({...v,placeholder_key:"ALLOTTED_SCHOOL",display_name:"Allotted School",description:"School assigned based on student performance and preferences",field_mapping:JSON.stringify({source_table:"admission_dashboard",source_field:"allotted_school",default_value:"Not Assigned"},null,2),conditional_logic:JSON.stringify({conditions:[{if:"final_marks >= 18",then:"SOP",description:"Assign School of Programming for high performers"},{if:"final_marks < 18 && final_marks >= 15",then:"SOB",description:"Assign School of Business for average performers"},{else:"General",description:"Default assignment"}]},null,2)})):y==="template_type"&&o(v=>({...v,placeholder_key:"TEMPLATE_TYPE",display_name:"Template Type",description:"Determines which template to use based on student data",field_mapping:JSON.stringify({source_table:"admission_dashboard",logic_based:!0},null,2),conditional_logic:JSON.stringify({template_selection:[{if:"allotted_school === 'SOP'",template:"sop_offer_letter",description:"Use SOP offer letter template"},{if:"allotted_school === 'SOB'",template:"sob_offer_letter",description:"Use SOB offer letter template"}]},null,2)}))};return d?l.jsx("div",{children:"Loading placeholders..."}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Manage Placeholders"}),l.jsxs(le,{onClick:()=>n(!0),children:[l.jsx(Wn,{className:"h-4 w-4 mr-2"}),"Add Placeholder"]})]}),l.jsx("div",{className:"grid gap-4",children:u==null?void 0:u.map(y=>l.jsxs(Et,{children:[l.jsx(Pt,{className:"pb-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(Lt,{className:"text-base",children:y.display_name}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kn,{variant:y.is_active?"default":"secondary",children:y.is_active?"Active":"Inactive"}),y.field_mapping&&l.jsxs(Kn,{variant:"outline",className:"text-xs",children:[l.jsx(vE,{className:"h-3 w-3 mr-1"}),"Mapped"]}),y.conditional_logic&&l.jsxs(Kn,{variant:"outline",className:"text-xs",children:[l.jsx(NE,{className:"h-3 w-3 mr-1"}),"Logic"]}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>g(y),children:l.jsx(xl,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>p.mutate({id:y.id,is_active:!y.is_active}),children:y.is_active?l.jsx(wa,{className:"h-4 w-4"}):l.jsx(Wn,{className:"h-4 w-4"})}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>h.mutate(y.id),children:l.jsx(ka,{className:"h-4 w-4"})})]})]})}),l.jsx(jt,{children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kn,{variant:"outline",children:y.placeholder_key}),l.jsxs("span",{className:"text-sm text-muted-foreground",children:["from ",y.data_source]})]}),y.description&&l.jsx("p",{className:"text-sm text-muted-foreground",children:y.description}),y.field_mapping&&l.jsxs("div",{className:"text-xs bg-blue-50 p-2 rounded",children:[l.jsx("strong",{children:"Field Mapping:"})," ",JSON.stringify(y.field_mapping)]}),y.conditional_logic&&l.jsxs("div",{className:"text-xs bg-green-50 p-2 rounded",children:[l.jsx("strong",{children:"Conditional Logic:"})," ",JSON.stringify(y.conditional_logic)]})]})})]},y.id))}),l.jsx(Wr,{open:r,onOpenChange:f,children:l.jsxs(Vr,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[l.jsx(Hr,{children:l.jsx(qr,{children:a?"Edit Placeholder":"Add New Placeholder"})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex gap-2 mb-4",children:[l.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:()=>x("allotted_school"),children:[l.jsx(vE,{className:"h-4 w-4 mr-1"}),"Allotted School Preset"]}),l.jsxs(le,{type:"button",variant:"outline",size:"sm",onClick:()=>x("template_type"),children:[l.jsx(NE,{className:"h-4 w-4 mr-1"}),"Template Type Preset"]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"placeholder_key",children:"Placeholder Key"}),l.jsx(Ve,{id:"placeholder_key",value:i.placeholder_key,onChange:y=>o(v=>({...v,placeholder_key:y.target.value.toUpperCase().replace(/\s+/g,"_")})),placeholder:"STUDENT_NAME"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"display_name",children:"Display Name"}),l.jsx(Ve,{id:"display_name",value:i.display_name,onChange:y=>o(v=>({...v,display_name:y.target.value})),placeholder:"Student Name"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"data_source",children:"Data Source"}),l.jsxs(Gr,{value:i.data_source,onValueChange:y=>o(v=>({...v,data_source:y})),children:[l.jsx(Fr,{children:l.jsx(Kr,{})}),l.jsxs(Or,{children:[l.jsx(gt,{value:"admission_dashboard",children:"Admission Dashboard"}),l.jsx(gt,{value:"profiles",children:"User Profiles"}),l.jsx(gt,{value:"custom",children:"Custom Value"})]})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"description",children:"Description"}),l.jsx(ps,{id:"description",value:i.description,onChange:y=>o(v=>({...v,description:y.target.value})),placeholder:"Description of what this placeholder represents"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"field_mapping",children:"Field Mapping (JSON)"}),l.jsx(ps,{id:"field_mapping",value:i.field_mapping,onChange:y=>o(v=>({...v,field_mapping:y.target.value})),placeholder:'{"source_table": "admission_dashboard", "source_field": "allotted_school"}',className:"font-mono text-sm",rows:4}),l.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Optional: Define how to map this placeholder to database fields"})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"conditional_logic",children:"Conditional Logic (JSON)"}),l.jsx(ps,{id:"conditional_logic",value:i.conditional_logic,onChange:y=>o(v=>({...v,conditional_logic:y.target.value})),placeholder:'{"conditions": [{"if": "final_marks >= 18", "then": "SOP"}]}',className:"font-mono text-sm",rows:6}),l.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Optional: Define conditional logic for dynamic value assignment"})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(le,{variant:"outline",onClick:f,children:"Cancel"}),l.jsxs(le,{onClick:m,disabled:c.isPending,children:[l.jsx(Ag,{className:"h-4 w-4 mr-2"}),c.isPending?"Saving...":"Save"]})]})]})]})})]})},N_e=()=>{const[e,t]=w.useState("templates"),[r,n]=w.useState(null),[a,s]=w.useState(!1);return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsxs("main",{className:"md:ml-64 p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Offer Letter Module"}),l.jsx("p",{className:"text-muted-foreground",children:"Create, manage, and send personalized admission offer emails with attachments"})]}),l.jsxs(k_,{value:e,onValueChange:t,className:"w-full",children:[l.jsxs(Xb,{className:"grid w-full grid-cols-3 mb-6",children:[l.jsxs(Pi,{value:"templates",className:"flex items-center gap-2",children:[l.jsx(xo,{className:"h-4 w-4"}),"Templates"]}),l.jsxs(Pi,{value:"history",className:"flex items-center gap-2",children:[l.jsx(Fle,{className:"h-4 w-4"}),"Offer History"]}),l.jsxs(Pi,{value:"settings",className:"flex items-center gap-2",children:[l.jsx(NE,{className:"h-4 w-4"}),"Settings"]})]}),l.jsx(Li,{value:"templates",className:"space-y-6",children:!r&&!a?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h2",{className:"text-xl font-semibold",children:"Email Templates"}),l.jsxs(le,{onClick:()=>s(!0),children:[l.jsx(Wn,{className:"h-4 w-4 mr-2"}),"New Template"]})]}),l.jsx(v_e,{onEditTemplate:n})]}):l.jsx(y_e,{templateId:r,isNew:a,onClose:()=>{n(null),s(!1)}})}),l.jsx(Li,{value:"history",className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Offer History"}),l.jsx(b_e,{})]})}),l.jsx(Li,{value:"settings",className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Template Settings"}),l.jsx("p",{className:"text-muted-foreground mb-6",children:"Manage placeholder fields and template configurations"}),l.jsx(w_e,{})]})})]})]})]})},S_e=w.createContext(void 0);function __e({children:e}){const[t,r]=w.useState(null),[n,a]=w.useState(null),[s,i]=w.useState(!0),{toast:o}=Wt(),{user:u,isAuthenticated:d,loading:c,getUserRole:h,hasRole:p,signOut:f}=Do();w.useEffect(()=>{c||(()=>{u&&d?(u.id,u.email,u.name,u.avatar,h(),u.role_id,u.role_name):(r(null),a(null)),i(!1)})()},[u,d,c,h]);const g=async()=>{try{await f(),r(null),a(null),o({title:"Success",description:"You have been logged out successfully.",className:"bg-green-50 border-green-200"})}catch(N){console.error("Logout error:",N),o({title:"Unable to log out",description:ut(N),className:"bg-red-50 border-red-200"})}},m=()=>t,x=h(),b={user:t,session:n,loading:s||c,signOut:g,getUserInfo:m,isAuthenticated:d,userRole:x,hasRole:N=>p(N)};return l.jsx(S_e.Provider,{value:b,children:e})}function En({children:e}){const{user:t,isAuthenticated:r,loading:n}=Do();Rn();const a=_s(),[s,i]=w.useState(null),o=s7.find(d=>d.href===a.pathname),u=o==null?void 0:o.allowedRoles;return w.useEffect(()=>{if(!n){if(!t||!r){i(!1);return}if(u&&!u.includes(t.role_id)){i(!1);return}i(!0)}},[t,r,n,u]),n||s===null?l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s?l.jsx(l.Fragment,{children:e}):l.jsx(Jo,{to:"/students/login",replace:!0})}const k_e=()=>{const{id:e}=Rb(),t=Rn(),{toast:r}=Wt(),[n,a]=w.useState([]),[s,i]=w.useState(null),[o,u]=w.useState(!0),[d,c]=w.useState(1),[h,p]=w.useState(0),[f,g]=w.useState(null),[m,x]=w.useState(!1);w.useEffect(()=>{e&&(v(),y())},[e,d]);const y=async()=>{try{const N=await DV(e);let S=N.data||N;Array.isArray(S)&&(S=S[0]),i(S)}catch(N){console.error("Failed to load partner details",N)}},v=async()=>{var N;u(!0);try{const S=await d$(e,d,50);let _=[],C=0;(N=S==null?void 0:S.data)!=null&&N.data&&Array.isArray(S.data.data)?(_=S.data.data,C=S.data.total||S.total||_.length):S&&S.data&&Array.isArray(S.data)?(_=S.data,C=S.total||_.length):Array.isArray(S)?(_=S,C=S.length):S&&S.students&&Array.isArray(S.students)&&(_=S.students,C=S.total||S.students.length),a(_),p(C)}catch(S){r({title:" Unable to Load Students",description:ut(S),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{u(!1)}},b=N=>{g(N),x(!0)};return l.jsxs("div",{className:"min-h-screen bg-muted/40 flex",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 flex-1 p-6 overflow-y-auto h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx(le,{variant:"outline",size:"icon",onClick:()=>t("/partners"),children:l.jsx(EA,{className:"h-4 w-4"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s?`${s.partner_name||s.name} Students`:"Partner Students"}),l.jsx("p",{className:"text-muted-foreground text-sm",children:"View and manage students associated with this partner"})]})]}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs(Lt,{children:["Student List (",h,")"]})}),l.jsxs(jt,{children:[l.jsxs(yi,{children:[l.jsx(vi,{children:l.jsxs(or,{children:[l.jsx(ct,{children:"Name"}),l.jsx(ct,{children:"Email"}),l.jsx(ct,{children:"Phone"}),l.jsx(ct,{children:"Status"}),l.jsx(ct,{children:"Stage"}),l.jsx(ct,{children:"Score"}),l.jsx(ct,{children:"Actions"})]})}),l.jsx(bi,{children:o?l.jsx(or,{children:l.jsx(Xe,{colSpan:7,className:"h-24 text-center",children:"Loading..."})}):n.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:7,className:"h-24 text-center text-muted-foreground",children:"No students found."})}):n.map((N,S)=>l.jsxs(or,{children:[l.jsx(Xe,{className:"font-medium",children:N.name||`${N.first_name||""} ${N.middle_name||""} ${N.last_name||""}`.trim()||"N/A"}),l.jsx(Xe,{children:N.email||"-"}),l.jsx(Xe,{children:N.mobile||N.phone_number||N.whatsapp_number||"-"}),l.jsx(Xe,{children:l.jsx(Kn,{variant:"secondary",className:"font-normal",children:N.current_status||"N/A"})}),l.jsx(Xe,{children:N.stage||"-"}),l.jsx(Xe,{children:N.total_score||"-"}),l.jsx(Xe,{children:l.jsx(le,{variant:"ghost",size:"icon",onClick:()=>b(N),children:l.jsx(jg,{className:"h-4 w-4"})})})]},N.id||S))})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:()=>c(N=>Math.max(1,N-1)),disabled:d===1,children:"Previous"}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>c(N=>N+1),disabled:n.length<50,children:"Next"})]})]})]})]})}),l.jsx(Y_,{isOpen:m,onClose:()=>x(!1),applicant:f})]})},C_e=()=>{const{id:e}=Rb(),t=Rn(),{toast:r}=Wt(),[n,a]=w.useState([]),[s,i]=w.useState(null),[o,u]=w.useState(!0),[d,c]=w.useState(1),[h,p]=w.useState(0),[f,g]=w.useState(null),[m,x]=w.useState(!1);w.useEffect(()=>{e&&(v(),y())},[e,d]);const y=async()=>{try{const N=await LV(e);let S=N.data||N;Array.isArray(S)&&(S=S[0]),i(S)}catch(N){console.error("Failed to load donor details",N)}},v=async()=>{var N;u(!0);try{const S=await UV(e,d,50);let _=[],C=0;(N=S==null?void 0:S.data)!=null&&N.data&&Array.isArray(S.data.data)?(_=S.data.data,C=S.data.total||S.total||_.length):S&&S.data&&Array.isArray(S.data)?(_=S.data,C=S.total||_.length):Array.isArray(S)?(_=S,C=S.length):S&&S.students&&Array.isArray(S.students)&&(_=S.students,C=S.total||S.students.length),a(_),p(C)}catch(S){r({title:" Unable to Load Students",description:ut(S),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{u(!1)}},b=N=>{g(N),x(!0)};return l.jsxs("div",{className:"min-h-screen bg-muted/40 flex",children:[l.jsx(dn,{}),l.jsx("main",{className:"md:ml-64 flex-1 p-6 overflow-y-auto h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx(le,{variant:"outline",size:"icon",onClick:()=>t("/donor"),children:l.jsx(EA,{className:"h-4 w-4"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s?`${s.donor_name||s.name} Students`:"Donor Students"}),l.jsx("p",{className:"text-muted-foreground text-sm",children:"View and manage students associated with this donor"})]})]}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs(Lt,{children:["Student List (",h,")"]})}),l.jsxs(jt,{children:[l.jsxs(yi,{children:[l.jsx(vi,{children:l.jsxs(or,{children:[l.jsx(ct,{children:"Name"}),l.jsx(ct,{children:"Email"}),l.jsx(ct,{children:"Phone"}),l.jsx(ct,{children:"Status"}),l.jsx(ct,{children:"Stage"}),l.jsx(ct,{children:"Score"}),l.jsx(ct,{children:"Actions"})]})}),l.jsx(bi,{children:o?l.jsx(or,{children:l.jsx(or,{children:l.jsx(Xe,{colSpan:7,className:"h-24 text-center",children:"Loading..."})})}):n.length===0?l.jsx(or,{children:l.jsx(Xe,{colSpan:7,className:"h-24 text-center text-muted-foreground",children:"No students found."})}):n.map((N,S)=>l.jsxs(or,{children:[l.jsx(Xe,{className:"font-medium",children:N.name||`${N.first_name||""} ${N.middle_name||""} ${N.last_name||""}`.trim()||"N/A"}),l.jsx(Xe,{children:N.email||"-"}),l.jsx(Xe,{children:N.mobile||N.phone_number||N.whatsapp_number||"-"}),l.jsx(Xe,{children:l.jsx(Kn,{variant:"secondary",className:"font-normal",children:N.current_status||N.status||"N/A"})}),l.jsx(Xe,{children:N.stage||"-"}),l.jsx(Xe,{children:N.total_score||"-"}),l.jsx(Xe,{children:l.jsx(le,{variant:"ghost",size:"icon",onClick:()=>b(N),children:l.jsx(jg,{className:"h-4 w-4"})})})]},N.id||S))})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:()=>c(N=>Math.max(1,N-1)),disabled:d===1,children:"Previous"}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>c(N=>N+1),disabled:n.length<50,children:"Next"})]})]})]})]})}),l.jsx(Y_,{isOpen:m,onClose:()=>x(!1),applicant:f})]})},I_e=[{key:"overview",label:"Overview"},{key:"student",label:"Student Data"}],E_e=()=>{const{id:e}=Rb(),[t,r]=w.useState("overview"),[n,a]=w.useState([]),[s,i]=w.useState([]),[o,u]=w.useState(!0),[d,c]=w.useState(null),[h,p]=w.useState("");Rn();const[f,g]=w.useState(1),[m,x]=w.useState(10),[y,v]=w.useState(""),[b,N]=w.useState(!1),[S,_]=w.useState({stage:"all",status:"all",examMode:"all",interviewMode:"all",partner:[],district:[],market:[],dateRange:{type:"application"}}),[C,k]=w.useState(!1),[I,T]=w.useState([]);w.useEffect(()=>{if(!e)return;(async()=>{try{const A=await yV(Number(e));A.success&&A.data&&p(A.data.campus_name)}catch(A){console.error("Failed to fetch campus details:",A)}})()},[e]),w.useEffect(()=>{if(!e||C)return;u(!0),c(null),(async()=>{try{const A=await Wl({campus_id:Number(e)});if(i(A||[]),T([]),t==="overview"){const L=new Map;let z=0;A.forEach(V=>{V.school_name?L.set(V.school_name,(L.get(V.school_name)||0)+1):z++});const $=Array.from(L.entries()).map(([V,B])=>({name:V,capacity:B}));z>0&&$.push({name:"Not Allotted Schools",capacity:z}),a($)}}catch(A){console.error("Error fetching students:",A),c("Failed to fetch student data"),i([]),a([])}finally{u(!1)}})()},[e,t,C]);const j=C?I:s,E=j.slice((f-1)*m,f*m),O=Math.ceil(j.length/m),M=j.length===0?0:(f-1)*m+1,W=Math.min(f*m,j.length),q=E.filter(P=>{const A=y.toLowerCase(),L=P.first_name&&P.first_name.toLowerCase().includes(A)||P.last_name&&P.last_name.toLowerCase().includes(A)||P.email&&P.email.toLowerCase().includes(A)||P.phone_number&&P.phone_number.includes(A);let z=!0;return S.stage!=="all"&&P.stage_name!==S.stage&&(z=!1),S.status!=="all"&&P.current_status_name!==S.status&&(z=!1),L&&z});return l.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[l.jsx(dn,{}),l.jsxs("main",{className:"flex-1 p-4 md:p-8 pt-16 md:pt-8 md:ml-64",children:[l.jsxs("h2",{className:"text-3xl font-bold text-center mb-6",children:[h," Campus"]}),l.jsx("div",{className:"flex justify-center mb-6 gap-2",children:I_e.map(P=>l.jsx(le,{variant:t===P.key?"default":"outline",className:t===P.key?"bg-orange-500 text-white":"",onClick:()=>r(P.key),children:P.label},P.key))}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:t==="overview"?"Programs offered":"Student Data"})}),l.jsxs(jt,{children:[t==="overview"&&(o?l.jsx("p",{children:"Loading..."}):d?l.jsx("p",{className:"text-red-500",children:d}):n.length===0?l.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No school data available"}):l.jsxs(yi,{children:[l.jsx(vi,{children:l.jsxs(or,{children:[l.jsx(ct,{children:"S.No"}),l.jsx(ct,{children:"School Name"}),l.jsx(ct,{children:"Number of Students"})]})}),l.jsx(bi,{children:n.map((P,A)=>l.jsxs(or,{children:[l.jsx(Xe,{children:A+1}),l.jsx(Xe,{children:P.name}),l.jsx(Xe,{children:P.capacity})]},A))})]})),t==="student"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 mb-4",children:[l.jsxs("div",{className:"relative flex-1 max-w-md",children:[l.jsx(Ja,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),l.jsx(Ve,{placeholder:"Search by name, email, or mobile...",value:y,onChange:P=>v(P.target.value),className:"pl-10 h-9"})]}),l.jsxs(le,{variant:"outline",size:"sm",className:"h-9",onClick:()=>N(!0),children:[l.jsx(Ob,{className:"w-4 h-4 mr-2"}),"Filter"]})]}),l.jsx(r8,{isOpen:b,onClose:()=>N(!1),onApplyFilters:async P=>{var z,$,V,B,Y;_(P);const A={campus_id:Number(e)};if((z=P.partner)!=null&&z.length&&P.partner[0]!=="all"&&(A.school_id=P.partner[0]),P.stage_id&&(A.stage_id=P.stage_id),($=P.qualification)!=null&&$.length&&P.qualification[0]!=="all"&&(A.qualification_id=P.qualification[0]),(V=P.school)!=null&&V.length&&P.school[0]!=="all"&&(A.school_id=P.school[0]),(B=P.currentStatus)!=null&&B.length&&P.currentStatus[0]!=="all"&&(A.current_status_id=P.currentStatus[0]),P.state&&P.state!=="all"&&(A.state=P.state),(Y=P.district)!=null&&Y.length&&P.district[0]!=="all"&&(A.district=P.district[0]),Object.keys(A).length>1){k(!0),u(!0);try{const re=await Wl(A);T(re||[])}catch(re){console.error("Error fetching filtered students:",re),c("Failed to fetch filtered students")}finally{u(!1)}}else k(!1),T([]);g(1)},currentFilters:S,students:s}),o?l.jsx("p",{children:"Loading students..."}):d?l.jsx("p",{className:"text-red-500",children:d}):q.length===0?l.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No students found"}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:q.map((P,A)=>l.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-soft border border-border",children:[l.jsx("div",{className:"flex items-center justify-between mb-2",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-lg font-bold text-foreground mb-1",children:`${P.first_name||""} ${P.middle_name||""} ${P.last_name||""}`.trim()||"No Name"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:P.email||"No email"})]})}),l.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Number:"})," ",P.phone_number||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"WhatsApp:"})," ",P.whatsapp_number||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Gender:"})," ",P.gender||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"DOB:"})," ",P.dob||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"State:"})," ",P.state||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"District:"})," ",P.district||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Cast:"})," ",P.cast_name||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Religion:"})," ",P.religion_name||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Qualification:"})," ",P.qualification_name||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"School:"})," ",P.school_name||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Stage:"})," ",P.stage_name||P.stage||"N/A"]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-muted-foreground",children:"Current Work:"})," ",P.current_status_name||"N/A"]})]})]},P.id))}),l.jsxs("div",{className:"flex justify-center items-center gap-6 mt-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm",children:"Rows per page:"}),l.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:m,onChange:P=>{x(Number(P.target.value)),g(1)},children:[10,20,50,100].map(P=>l.jsx("option",{value:P,children:P},P))})]}),l.jsxs("span",{className:"text-sm",children:[M,"-",W," of ",j.length]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{className:"px-2 py-1 rounded border border-gray-200 bg-white text-sm disabled:opacity-50",onClick:()=>g(P=>Math.max(1,P-1)),disabled:f===1,"aria-label":"Previous page",children:"<"}),l.jsx("button",{className:"px-2 py-1 rounded border border-gray-200 bg-white text-sm disabled:opacity-50",onClick:()=>g(P=>Math.min(O,P+1)),disabled:f===O,"aria-label":"Next page",children:">"})]})]})]})]})]})]})]})]})},Q3={stageType:"Test",stageName:""},T_e=()=>{const{id:e}=Rb(),[t,r]=w.useState([]),[n,a]=w.useState(""),[s,i]=w.useState(!0),[o,u]=w.useState({open:!1,idx:null,form:Q3}),[d,c]=w.useState({open:!1,idx:null}),[h,p]=w.useState([]),[f,g]=w.useState("");w.useEffect(()=>{e&&fetch(`https://dev-join.navgurukul.org/api/stage/${e}`).then(k=>k.json()).then(k=>{r(k),k.length>0&&a(k[0].name||"School"),i(!1)}).catch(()=>i(!1))},[e]);const m=k=>{const I=t[k];u({open:!0,idx:k,form:{stageType:I.stageType||"Test",stageName:I.stageName||""}})},x=()=>u({open:!1,idx:null,form:Q3}),y=(k,I)=>{u(T=>({...T,form:{...T.form,[k]:I}}))},v=k=>{k.preventDefault(),x()},b=k=>{var I;c({open:!0,idx:k}),p(t.map((T,j)=>j===k)),g(((I=t[k])==null?void 0:I.stageName)||"")},N=()=>c({open:!1,idx:null}),S=k=>{p(I=>I.map((T,j)=>j===k?!T:T))},_=k=>g(k.target.value),C=k=>{k.preventDefault(),N()};return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx(dn,{}),l.jsxs("main",{className:"md:ml-64 flex flex-col items-center justify-center min-h-screen pt-16 md:pt-0",children:[l.jsx("div",{className:"w-full max-w-4xl p-4 md:p-8",children:l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border p-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-center mb-6",children:n}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-border/50",children:[l.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"S.No"}),l.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Type"}),l.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Stage Name"}),l.jsx("th",{className:"text-center py-3 px-4 font-medium text-muted-foreground text-sm",children:"Edit"}),l.jsx("th",{className:"text-center py-3 px-4 font-medium text-muted-foreground text-sm",children:"Manage Transitions"}),l.jsx("th",{className:"text-center py-3 px-4 font-medium text-muted-foreground text-sm",children:"Delete"})]})}),l.jsx("tbody",{children:s?l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Loading stages..."})]})})}):t.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"py-12 text-center text-muted-foreground",children:"No stages found"})}):t.map((k,I)=>l.jsxs("tr",{className:I%2===1?"bg-muted/30":"",children:[l.jsx("td",{className:"py-3 px-4",children:I+1}),l.jsx("td",{className:"py-3 px-4",children:k.stageType}),l.jsx("td",{className:"py-3 px-4",children:k.stageName}),l.jsx("td",{className:"py-3 px-4 text-center",children:l.jsx("button",{className:"hover:text-orange-600",onClick:()=>m(I),children:l.jsx(ru,{size:18})})}),l.jsx("td",{className:"py-3 px-4 text-center",children:l.jsx("button",{className:"text-orange-600 hover:underline",onClick:()=>b(I),children:"Manage Transitions"})}),l.jsx("td",{className:"py-3 px-4 text-center",children:l.jsx("button",{className:"hover:text-red-600",children:l.jsx(ka,{size:18})})})]},k.id))})]})}),l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Rows per page: 10"}),l.jsxs("span",{className:"text-sm text-muted-foreground",children:["1-",t.length," of ",t.length]})]})]})}),l.jsx(Wr,{open:o.open,onOpenChange:k=>!k&&x(),children:l.jsx(Vr,{children:l.jsxs("form",{onSubmit:v,className:"w-full max-w-md",children:[l.jsx(Hr,{children:l.jsx(qr,{className:"text-2xl font-semibold mb-4",children:"Edit Admission Stage"})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-base font-medium mb-2",children:"Stage Type"}),l.jsxs("div",{className:"flex gap-6 mb-2",children:[l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"radio",name:"stageType",value:"Test",checked:o.form.stageType==="Test",onChange:()=>y("stageType","Test")}),"Test"]}),l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"radio",name:"stageType",value:"Interview",checked:o.form.stageType==="Interview",onChange:()=>y("stageType","Interview")}),"Interview"]})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-base font-medium mb-2",children:"Stage Name"}),l.jsx("input",{type:"text",className:"border-2 border-orange-400 rounded px-3 py-2 w-full text-lg",placeholder:"Enter Stage",value:o.form.stageName,onChange:k=>y("stageName",k.target.value),required:!0})]}),l.jsx("button",{type:"submit",className:"w-full bg-orange-500 text-white py-2 rounded font-semibold text-lg shadow mt-2",children:"ADD ADMISSION STAGE"})]})})}),l.jsx(Wr,{open:d.open,onOpenChange:k=>!k&&N(),children:l.jsx(Vr,{children:l.jsxs("form",{onSubmit:C,className:"w-full max-w-lg",children:[l.jsx(Hr,{children:l.jsx(qr,{className:"text-2xl font-semibold mb-4",children:"Manage Transitions"})}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Available Transitions"}),l.jsx("div",{className:"flex flex-col gap-2",children:t.map((k,I)=>l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:!!h[I],onChange:()=>S(I)}),k.stageName]},k.id))})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Preview"}),l.jsx("select",{className:"border rounded px-3 py-2 w-full",value:f,onChange:_,children:t.map((k,I)=>l.jsx("option",{value:k.stageName,children:k.stageName},k.id))})]})]}),l.jsx("button",{type:"submit",className:"mt-6 w-full bg-orange-500 text-white py-2 rounded font-semibold text-lg shadow",children:"SAVE TRANSITION & RETURN"})]})})})]})]})},X3=[{value:1,label:"Female"},{value:2,label:"Male"}],j_e=[{value:!0,label:"Yes"},{value:!1,label:"No"}],A_e=[{value:"CultureFitInterview",label:"CultureFitInterview"},{value:"EnglishInterview",label:"EnglishInterview"},{value:"AlgebraInterview",label:"AlgebraInterview"}];function $_e(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(!1),[i,o]=w.useState({owner:"",gender:"",available:"",stage:"",limit:""}),[u,d]=w.useState([]),[c,h]=w.useState("add"),[p,f]=w.useState(null),[g,m]=w.useState(1),x=10,y=Math.ceil(e.length/x),v=e.slice((g-1)*x,g*x),b=()=>{g>1&&m(g-1)},N=()=>{g<y&&m(g+1)},S=()=>{h("add"),f(null),o({owner:"",gender:"",available:"",stage:"",limit:""}),s(!0)},_=k=>{h("edit"),f(k),o({owner:String(k.user.id),gender:String(k.gender),available:String(k.available),stage:k.type[0]||"",limit:String(k.max_limit)}),s(!0)};w.useEffect(()=>{fetch("https://dev-join.navgurukul.org/api/owner").then(k=>k.json()).then(k=>{t(k.data||[]),n(!1),d((k.data||[]).map(I=>({id:I.user.id,name:I.user.user_name+" ("+I.user.mail_id+")"})))})},[]);const C=(k,I)=>{o(T=>({...T,[k]:I}))};return l.jsxs("div",{className:"min-h-screen bg-background flex",children:[l.jsx(dn,{}),l.jsxs("main",{className:"md:ml-64 flex-1 p-4 md:p-8 pt-16 md:pt-8",children:[l.jsxs("div",{className:"bg-card rounded-xl shadow-soft border border-border",children:[l.jsx("div",{className:"p-6 border-b border-border",children:l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Owners"}),l.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Manage and track owner details"})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(le,{className:"bg-gradient-primary hover:bg-primary/90 text-white h-9",children:"Interview Schedule"}),l.jsx(le,{className:"bg-orange-500 hover:bg-orange-600 text-white rounded-md px-6 py-2 font-semibold shadow h-9",onClick:S,children:"Add Owner"})]})]})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-border/50",children:[l.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Edit"}),l.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Name"}),l.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Gender"}),l.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Available"}),l.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Pending Interviews"}),l.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Interview Types"}),l.jsx("th",{className:"text-left py-4 px-6 font-medium text-muted-foreground text-sm",children:"Assigned Interviews Limit"})]})}),l.jsx("tbody",{children:r?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"py-12 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Loading owners..."})]})})}):v.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"py-12 text-center text-muted-foreground",children:l.jsx("span",{children:"No owners found"})})}):v.map(k=>{var I;return l.jsxs("tr",{className:"border-b border-border/30 hover:bg-muted/30 transition-colors group",children:[l.jsx("td",{className:"py-4 px-6",children:l.jsx("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>_(k),children:l.jsxs("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M12 20h9"}),l.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19.5 3 21l1.5-4L16.5 3.5z"})]})})}),l.jsx("td",{className:"py-4 px-6 font-medium",children:k.user.user_name}),l.jsx("td",{className:"py-4 px-6",children:((I=X3.find(T=>T.value===k.gender))==null?void 0:I.label)||"Other"}),l.jsx("td",{className:"py-4 px-6",children:k.available?"Yes":"No"}),l.jsx("td",{className:"py-4 px-6",children:k.pending_interview_count}),l.jsx("td",{className:"py-4 px-6",children:k.type.map(T=>l.jsx("span",{className:"inline-block bg-orange-100 text-orange-700 rounded px-2 py-1 text-xs font-semibold mr-1 mb-1",children:T},T))}),l.jsx("td",{className:"py-4 px-6",children:k.max_limit})]},k.id)})})]})}),l.jsxs("div",{className:"flex justify-between items-center px-6 py-4",children:[l.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",g," of ",y]}),l.jsxs("div",{className:"space-x-2",children:[l.jsx(le,{variant:"outline",onClick:b,disabled:g===1,children:"Previous"}),l.jsx(le,{variant:"outline",onClick:N,disabled:g===y,children:"Next"})]})]})]}),a&&l.jsx(Wr,{open:a,onOpenChange:s,children:l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-8 w-full max-w-md shadow-lg",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:c==="edit"?"Edit Owner":"Add New Owner"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"owner",children:"Select Owner"}),l.jsxs(Gr,{value:i.owner,onValueChange:k=>C("owner",k),children:[l.jsx(Fr,{id:"owner",className:"mt-1",children:l.jsx(Kr,{placeholder:"Please Select Owner"})}),l.jsx(Or,{children:u.map(k=>l.jsx(gt,{value:String(k.id),children:k.name},k.id))})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"gender",children:"Select Gender"}),l.jsxs(Gr,{value:i.gender,onValueChange:k=>C("gender",k),children:[l.jsx(Fr,{id:"gender",className:"mt-1",children:l.jsx(Kr,{placeholder:"Please select your gender"})}),l.jsx(Or,{children:X3.map(k=>l.jsx(gt,{value:String(k.value),children:k.label},k.value))})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"available",children:"Select Availability"}),l.jsxs(Gr,{value:i.available,onValueChange:k=>C("available",k),children:[l.jsx(Fr,{id:"available",className:"mt-1",children:l.jsx(Kr,{placeholder:"Select Yes/No"})}),l.jsx(Or,{children:j_e.map(k=>l.jsx(gt,{value:String(k.value),children:k.label},String(k.value)))})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"stage",children:"Select Stage"}),l.jsxs(Gr,{value:i.stage,onValueChange:k=>C("stage",k),children:[l.jsx(Fr,{id:"stage",className:"mt-1",children:l.jsx(Kr,{placeholder:"Select Stage"})}),l.jsx(Or,{children:A_e.map(k=>l.jsx(gt,{value:k.value,children:k.label},k.value))})]})]}),l.jsxs("div",{children:[l.jsx(Ee,{htmlFor:"limit",children:"Interview Limit"}),l.jsx(Ve,{id:"limit",type:"number",min:"0",value:i.limit,onChange:k=>C("limit",k.target.value),placeholder:"Ek student kitne interviews le sakta hai."})]}),l.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[l.jsx(le,{variant:"outline",type:"button",onClick:()=>s(!1),children:"Cancel"}),l.jsx(le,{className:"bg-orange-500 text-white",type:"submit",children:c==="edit"?"Update Owner":"Add Owner"})]})]})]})})})]})]})}const R_e=[{name:"User Role",href:"/settings/user-role",icon:P1},{name:"Caste",href:"/settings/caste",icon:ch},{name:"Religion",href:"/settings/religion",icon:ZU},{name:"Qualification",href:"/settings/qualification",icon:nW}];function D_e(){return l.jsx("div",{className:"min-h-screen bg-background",children:l.jsx("main",{className:"md:ml-56  md:px-8 py-3 ",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),l.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your application settings and configurations"})]}),l.jsx("div",{className:"bg-white rounded-lg shadow",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4",children:[l.jsx("div",{className:"lg:col-span-1 border-r border-gray-200",children:l.jsx("nav",{className:"p-6 space-y-2",children:R_e.map(e=>l.jsxs(_U,{to:e.href,className:({isActive:t})=>Ue("flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",t?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[l.jsx(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name))})}),l.jsx("div",{className:"lg:col-span-3 p-6",children:l.jsx(dE,{})})]})})]})})})}function Y3(){const[e,t]=w.useState([]),[r,n]=w.useState(null),[a,s]=w.useState({name:"",description:""}),{toast:i}=Wt();w.useEffect(()=>{(async()=>{try{const p=(await JA()).map(f=>({id:f.id,name:f.name,description:f.description??"",permissions:f.permissions??[]}));t(p),console.log("Fetched roles:",p)}catch(h){console.error("Failed to fetch roles:",h),i({title:"Error",description:"Failed to fetch roles",variant:"destructive"})}})()},[i]);const o=async()=>{if(!a.name.trim())return;if(e.some(h=>h.name.toLowerCase()===a.name.trim().toLowerCase())){i({title:"Duplicate Role",description:`Role "${a.name}" already exists.`,variant:"destructive"});return}try{const h=await B6({name:a.name.trim()}),p={id:h.id,name:h.name};t(f=>[...f,p]),s({name:"",description:""}),i({title:"Role Added",description:`Role "${h.name}" has been created.`})}catch(h){console.error("Failed to create role:",h),i({title:"Error",description:"Failed to create role",variant:"destructive"})}},u=async c=>{try{await W6(String(c)),t(h=>h.filter(p=>p.id!==c)),i({title:"Role Deleted",description:"Role has been deleted successfully."})}catch(h){console.error("Failed to delete role:",h),i({title:"Error",description:"Failed to delete role",variant:"destructive"})}},d=async c=>{try{const h=await U6(Number(c.id),{name:c.name,status:!0});t(p=>p.map(f=>f.id===h.id?{...f,...h}:f)),n(null),i({title:"Role Updated",description:`Role "${h.name}" has been updated successfully.`})}catch(h){console.error("Failed to update role:",h),i({title:"Error",description:h.message||"Failed to update role",variant:"destructive"})}};return l.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[l.jsx(dn,{}),l.jsxs("div",{className:"space-y-6",style:{flex:1},children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Roles"}),l.jsx("p",{className:"text-gray-600",children:"Manage user roles and their permissions"})]}),l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsx(Lt,{children:"Add New Role"}),l.jsx(xi,{children:"Create a new user role with specific permissions"})]}),l.jsxs(jt,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Name"}),l.jsx(Ve,{value:a.name,onChange:c=>s({...a,name:c.target.value}),placeholder:"Enter role name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),l.jsx(Ve,{value:a.description,onChange:c=>s({...a,description:c.target.value}),placeholder:"Enter role description"})]})]}),l.jsxs(le,{onClick:o,className:"mt-4",children:[l.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Role"]})]})]}),l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsx(Lt,{children:"Existing Roles"}),l.jsx(xi,{children:"Manage current user roles"})]}),l.jsx(jt,{children:l.jsx("div",{className:"space-y-4",children:e.map(c=>{var h;return l.jsx("div",{className:"p-4 border rounded-lg space-y-2",children:(r==null?void 0:r.id)===c.id?l.jsxs("div",{className:"space-y-2",children:[l.jsx(Ve,{value:r.name,onChange:p=>n({...r,name:p.target.value}),placeholder:"Role Name"}),l.jsx(Ve,{value:r.description,onChange:p=>n({...r}),placeholder:"Role Description"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(le,{size:"sm",onClick:()=>d(r),children:[l.jsx(Ag,{className:"w-4 h-4 mr-2"}),"Save"]}),l.jsxs(le,{size:"sm",variant:"outline",onClick:()=>n(null),children:[l.jsx(wa,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:c.name}),l.jsx("p",{className:"text-sm text-gray-600",children:c.description}),l.jsx("div",{className:"flex gap-2 mt-2",children:(h=c.permissions)==null?void 0:h.map(p=>l.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:p},p))})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:()=>n({...c}),children:l.jsx(xl,{className:"w-4 h-4"})}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>u(c.id),children:l.jsx(ka,{className:"w-4 h-4"})})]})]})},c.id)})})})]})]})]})}function M_e(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(!1),[i,o]=w.useState(null),[u,d]=w.useState({cast_name:""}),[c,h]=w.useState({cast_name:""}),{toast:p}=Wt();w.useEffect(()=>{f()},[]),w.useEffect(()=>{console.log("Castes state updated:",e),console.log("Castes length:",e.length)},[e]);const f=async()=>{try{n(!0);const v=await Vb();Array.isArray(v)?t(v):v&&Array.isArray(v.data)?t(v.data):v&&Array.isArray(v.castes)?t(v.castes):(t([]),p({title:"Error",description:"Invalid data format received from server",variant:"destructive"}))}catch(v){t([]),p({title:"Error",description:v instanceof Error?v.message:"Failed to fetch castes",variant:"destructive"})}finally{n(!1)}},g=async()=>{if(!u.cast_name.trim()){p({title:"Error",description:"Cast name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.cast_name.toLowerCase()===u.cast_name.toLowerCase())){p({title:"Error",description:"A cast with this name already exists",variant:"destructive"});return}try{s(!0);const v=await Y6({cast_name:u.cast_name});t(Array.isArray(e)?[...e,v]:[v]),d({cast_name:""}),p({title:"Success",description:"Cast created successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to create cast",variant:"destructive"})}finally{s(!1)}},m=v=>{o(v),h({cast_name:v.cast_name})},x=async()=>{if(!i||!c.cast_name.trim()){p({title:"Error",description:"Cast name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.id!==i.id&&v.cast_name.toLowerCase()===c.cast_name.toLowerCase())){p({title:"Error",description:"A cast with this name already exists",variant:"destructive"});return}try{const v=await J6(i.id,{cast_name:c.cast_name});t(Array.isArray(e)?e.map(b=>b.id===i.id?v:b):[v]),o(null),h({cast_name:""}),p({title:"Success",description:"Cast updated successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to update cast",variant:"destructive"})}},y=async v=>{if(confirm("Are you sure you want to delete this cast?"))try{await Z6(v),t(Array.isArray(e)?e.filter(b=>b.id!==v):[]),p({title:"Success",description:"Cast deleted successfully"})}catch(b){p({title:"Error",description:b instanceof Error?b.message:"Failed to delete cast",variant:"destructive"})}};return l.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[l.jsx(dn,{}),l.jsxs("div",{className:"space-y-6",style:{flex:1},children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Caste Management"}),l.jsx("p",{className:"text-gray-600",children:"Manage caste categories and classifications"})]}),l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsx(Lt,{children:"Add New Caste"}),l.jsx(xi,{children:"Create a new caste category"})]}),l.jsx(jt,{children:l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caste Name"}),l.jsx(Ve,{value:u.cast_name,onChange:v=>d({cast_name:v.target.value}),placeholder:"Enter caste name",disabled:a,onKeyDown:v=>{v.key==="Enter"&&u.cast_name.trim()&&!a&&g()}})]}),l.jsx("div",{className:"flex items-end",children:l.jsxs(le,{onClick:g,disabled:a||!u.cast_name.trim(),children:[a?l.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}):l.jsx(Wn,{className:"w-4 h-4 mr-2"}),a?"Creating...":"Add Caste"]})})]})})]}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Lt,{children:"Existing Castes"}),l.jsx(xi,{children:"Manage current caste categories"})]}),l.jsxs(le,{variant:"outline",size:"sm",onClick:f,disabled:r,children:[l.jsx(AA,{className:`w-4 h-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]})}),l.jsx(jt,{children:r?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx(ya,{className:"w-6 h-6 animate-spin mr-2"}),l.jsx("span",{children:"Loading castes..."})]}):!Array.isArray(e)||e.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500",children:"No castes found. Create your first caste above."}):l.jsx("div",{className:"space-y-4",children:e.map(v=>l.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:(i==null?void 0:i.id)===v.id?l.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[l.jsx("div",{className:"flex-1",children:l.jsx(Ve,{value:c.cast_name,onChange:b=>h({cast_name:b.target.value}),placeholder:"Cast name",onKeyDown:b=>{b.key==="Enter"&&c.cast_name.trim()?x():b.key==="Escape"&&(o(null),h({cast_name:""}))}})}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{size:"sm",onClick:x,children:"Save"}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>{o(null),h({cast_name:""})},children:"Cancel"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:v.cast_name}),l.jsx("div",{className:"flex gap-2 mt-2",children:l.jsx("span",{className:`px-2 py-1 text-xs rounded ${v.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status?"Active":"Inactive"})}),v.created_at&&l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created:"," ",new Date(v.created_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:()=>m(v),children:l.jsx(xl,{className:"w-4 h-4"})}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>y(v.id),children:l.jsx(ka,{className:"w-4 h-4"})})]})]})},v.id))})})]})]})]})}function F_e(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[a,s]=w.useState(!1),[i,o]=w.useState(null),[u,d]=w.useState({religion_name:""}),[c,h]=w.useState({religion_name:""}),{toast:p}=Wt();w.useEffect(()=>{f()},[]),w.useEffect(()=>{console.log("Religions state updated:",e),console.log("Religions length:",e.length)},[e]);const f=async()=>{try{n(!0);const v=await Hb();console.log("Fetched religions in component:",v),console.log("Fetched religions type:",typeof v),console.log("Is array?",Array.isArray(v)),Array.isArray(v)?(console.log("Setting religions to array:",v),t(v)):v&&Array.isArray(v.data)?(console.log("Setting religions to fetchedReligions.data:",v.data),t(v.data)):v&&Array.isArray(v.religions)?(console.log("Setting religions to fetchedReligions.religions:",v.religions),t(v.religions)):(console.error("Unexpected API response format:",v),t([]),p({title:"Error",description:"Invalid data format received from server",variant:"destructive"}))}catch(v){console.error("Error fetching religions:",v),t([]),p({title:"Error",description:v instanceof Error?v.message:"Failed to fetch religions",variant:"destructive"})}finally{n(!1)}},g=async()=>{if(!u.religion_name.trim()){p({title:"Error",description:"Religion name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.religion_name.toLowerCase()===u.religion_name.toLowerCase())){p({title:"Error",description:"A religion with this name already exists",variant:"destructive"});return}try{s(!0);const v=await eV({religion_name:u.religion_name});t(Array.isArray(e)?[...e,v]:[v]),d({religion_name:""}),p({title:"Success",description:"Religion created successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to create religion",variant:"destructive"})}finally{s(!1)}},m=v=>{o(v),h({religion_name:v.religion_name})},x=async()=>{if(!i||!c.religion_name.trim()){p({title:"Error",description:"Religion name is required",variant:"destructive"});return}if(Array.isArray(e)&&e.some(v=>v.id!==i.id&&v.religion_name.toLowerCase()===c.religion_name.toLowerCase())){p({title:"Error",description:"A religion with this name already exists",variant:"destructive"});return}try{const v=await tV(i.id.toString(),{religion_name:c.religion_name});t(Array.isArray(e)?e.map(b=>b.id===i.id?v:b):[v]),o(null),h({religion_name:""}),p({title:"Success",description:"Religion updated successfully"})}catch(v){p({title:"Error",description:v instanceof Error?v.message:"Failed to update religion",variant:"destructive"})}},y=async v=>{if(confirm("Are you sure you want to delete this religion?"))try{await nV(v.toString()),t(Array.isArray(e)?e.filter(b=>b.id!==v):[]),p({title:"Success",description:"Religion deleted successfully"})}catch(b){p({title:"Error",description:b instanceof Error?b.message:"Failed to delete religion",variant:"destructive"})}};return l.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[l.jsx(dn,{}),l.jsxs("div",{className:"space-y-6",style:{flex:1},children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Religion Management"}),l.jsx("p",{className:"text-gray-600",children:"Manage religious categories and classifications"})]}),l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsx(Lt,{children:"Add New Religion"}),l.jsx(xi,{children:"Create a new religious category"})]}),l.jsx(jt,{children:l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Religion Name"}),l.jsx(Ve,{value:u.religion_name,onChange:v=>d({religion_name:v.target.value}),placeholder:"Enter religion name",disabled:a,onKeyDown:v=>{v.key==="Enter"&&u.religion_name.trim()&&!a&&g()}})]}),l.jsx("div",{className:"flex items-end",children:l.jsxs(le,{onClick:g,disabled:a||!u.religion_name.trim(),children:[a?l.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}):l.jsx(Wn,{className:"w-4 h-4 mr-2"}),a?"Creating...":"Add Religion"]})})]})})]}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx(Lt,{children:"Existing Religions"}),l.jsx(xi,{children:"Manage current religious categories"})]}),l.jsxs(le,{variant:"outline",size:"sm",onClick:f,disabled:r,children:[l.jsx(AA,{className:`w-4 h-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]})}),l.jsx(jt,{children:r?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx(ya,{className:"w-6 h-6 animate-spin mr-2"}),l.jsx("span",{children:"Loading religions..."})]}):!Array.isArray(e)||e.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500",children:"No religions found. Create your first religion above."}):l.jsx("div",{className:"space-y-4",children:e.map(v=>l.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:(i==null?void 0:i.id)===v.id?l.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[l.jsx("div",{className:"flex-1",children:l.jsx(Ve,{value:c.religion_name,onChange:b=>h({religion_name:b.target.value}),placeholder:"Religion name",onKeyDown:b=>{b.key==="Enter"&&c.religion_name.trim()?x():b.key==="Escape"&&(o(null),h({religion_name:""}))}})}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{size:"sm",onClick:x,children:"Save"}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>{o(null),h({religion_name:""})},children:"Cancel"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:v.religion_name}),l.jsx("div",{className:"flex gap-2 mt-2",children:l.jsx("span",{className:`px-2 py-1 text-xs rounded ${v.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status?"Active":"Inactive"})}),v.created_at&&l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created:"," ",new Date(v.created_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",onClick:()=>m(v),children:l.jsx(xl,{className:"w-4 h-4"})}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>y(v.id),children:l.jsx(ka,{className:"w-4 h-4"})})]})]})},v.id))})})]})]})]})}function O_e(){const[e,t]=w.useState([{id:"1",name:"High School",level:"Secondary",description:"10th standard completion",duration:"2 years"},{id:"2",name:"Higher Secondary",level:"Higher Secondary",description:"12th standard completion",duration:"2 years"},{id:"3",name:"Bachelor's Degree",level:"Undergraduate",description:"Bachelor's degree program",duration:"3-4 years"},{id:"4",name:"Master's Degree",level:"Postgraduate",description:"Master's degree program",duration:"2 years"},{id:"5",name:"PhD",level:"Doctorate",description:"Doctoral program",duration:"3-5 years"}]),[r,n]=w.useState({name:"",level:"",description:"",duration:""}),a=()=>{if(r.name.trim()){const o={id:Date.now().toString(),name:r.name,level:r.level,description:r.description,duration:r.duration};t([...e,o]),n({name:"",level:"",description:"",duration:""})}},s=o=>{t(e.filter(u=>u.id!==o))},i=o=>{switch(o){case"Secondary":return"bg-green-100 text-green-800";case"Higher Secondary":return"bg-blue-100 text-blue-800";case"Undergraduate":return"bg-purple-100 text-purple-800";case"Postgraduate":return"bg-orange-100 text-orange-800";case"Doctorate":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return l.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[l.jsx(dn,{}),l.jsxs("div",{className:"space-y-6",style:{flex:1},children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Qualification Management"}),l.jsx("p",{className:"text-gray-600",children:"Manage educational qualifications and levels"})]}),l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsx(Lt,{children:"Add New Qualification"}),l.jsx(xi,{children:"Create a new educational qualification"})]}),l.jsxs(jt,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Qualification Name"}),l.jsx(Ve,{value:r.name,onChange:o=>n({...r,name:o.target.value}),placeholder:"Enter qualification name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level"}),l.jsx(Ve,{value:r.level,onChange:o=>n({...r,level:o.target.value}),placeholder:"Secondary/Higher Secondary/etc"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration"}),l.jsx(Ve,{value:r.duration,onChange:o=>n({...r,duration:o.target.value}),placeholder:"e.g., 2 years"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),l.jsx(Ve,{value:r.description,onChange:o=>n({...r,description:o.target.value}),placeholder:"Enter description"})]})]}),l.jsxs(le,{onClick:a,className:"mt-4",children:[l.jsx(Wn,{className:"w-4 h-4 mr-2"}),"Add Qualification"]})]})]}),l.jsxs(Et,{children:[l.jsxs(Pt,{children:[l.jsx(Lt,{children:"Existing Qualifications"}),l.jsx(xi,{children:"Manage current educational qualifications"})]}),l.jsx(jt,{children:l.jsx("div",{className:"space-y-4",children:e.map(o=>l.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:o.name}),l.jsx("p",{className:"text-sm text-gray-600",children:o.description}),l.jsxs("div",{className:"flex gap-2 mt-2",children:[l.jsx("span",{className:`px-2 py-1 text-xs rounded ${i(o.level)}`,children:o.level}),l.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-800 rounded",children:o.duration})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(le,{variant:"outline",size:"sm",children:l.jsx(xl,{className:"w-4 h-4"})}),l.jsx(le,{variant:"outline",size:"sm",onClick:()=>s(o.id),children:l.jsx(ka,{className:"w-4 h-4"})})]})]},o.id))})})]})]})]})}const P_e=()=>{const e=Rn(),[t,r]=w.useState("English"),n=()=>{localStorage.setItem("selectedLanguage",t),e("/students/instructions")},a=()=>{localStorage.removeItem("googleUser"),localStorage.removeItem("userInfo"),localStorage.removeItem("roleAccess"),localStorage.removeItem("privileges"),e("/auth")};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"NavGurukul Entrance Test"}),l.jsx("p",{className:"text-gray-600 mb-8",children:"Select Your Language"}),l.jsxs("div",{className:"mb-8",children:[l.jsx("label",{className:"block text-left text-gray-700 font-medium mb-2",children:"Choose your language"}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:t,onChange:s=>r(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg appearance-none bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[l.jsx("option",{value:"English",children:"English"}),l.jsx("option",{value:"Hindi",children:""}),l.jsx("option",{value:"Marathi",children:""}),l.jsx("option",{value:"Gujarati",children:""})]}),l.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),l.jsx("button",{onClick:n,className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-lg transition duration-200",children:"LET'S GO AHEAD"}),l.jsxs("div",{className:"flex justify-center space-x-2 mt-8",children:[l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),l.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),l.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"})]}),l.jsxs("div",{className:"flex justify-between mt-6",children:[l.jsxs("button",{onClick:a,className:"text-gray-600 hover:text-gray-800 flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"BACK"]}),l.jsxs("button",{onClick:n,className:"text-orange-500 hover:text-orange-600 flex items-center",children:["NEXT",l.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})})},Kg=({className:e})=>{const t=Rn(),[r,n]=w.useState(!1),{signOut:a}=Do(),s=()=>{try{a()}catch(i){console.error("Google sign out error:",i)}localStorage.clear(),t("/students/login",{replace:!0})};return l.jsx("div",{className:"fixed top-5 right-5 z-50",children:r?l.jsxs("div",{className:"bg-white shadow-xl rounded-2xl p-4 border border-gray-100 flex flex-col items-center space-y-3 animate-fade-in",children:[l.jsx("p",{className:"text-gray-700 text-sm font-medium",children:"Are you sure you want to log out?"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:s,className:"bg-green-500 text-white px-4 py-1.5 rounded-full text-sm font-medium hover:bg-green-600 transition-all",children:"Yes, Logout"}),l.jsx("button",{onClick:()=>n(!1),className:"bg-gray-200 text-gray-800 px-4 py-1.5 rounded-full text-sm font-medium hover:bg-gray-300 transition-all",children:"Cancel"})]})]}):l.jsxs("button",{onClick:()=>n(!0),className:`flex items-center gap-2 bg-gradient-to-r ${e||"from-green-500 to-green-500"} text-white px-5 py-2 rounded-full shadow-md hover:opacity-90 hover:scale-105 transition-all duration-200`,children:[l.jsx(sW,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium",children:"Logout"})]})})},L_e=()=>{const e=Rn(),t=_s(),r=localStorage.getItem("selectedLanguage")||"english",a=(()=>{switch(r){case"hindi":return{title:"NavGurukul Entrance Test",instructionsIntro:"                ",instructions:["  1          ,           ","                    ","           ","         ,         "],imReady:"  ",back:"",next:""};case"marathi":return{title:"NavGurukul Entrance Test",instructionsIntro:"       .      ",instructions:["  1  .     ,        .","       .      .","       .","      ,           ."],imReady:"  ",back:"",next:""};default:return{title:"NavGurukul Entrance Test",instructionsIntro:"Please read the following important instructions before starting the test. These instruction will come in handy while giving the test.",instructions:["The complete test will be of 1 hour. Please give the test in a quiet place, where you can answer the questions without any disruptions.","While giving the test, keep a notebook and a pen with you. You can use any rough notebook.","While giving the test, answer each question on your phone itself.","You may get the chance of cheating exam, but we believe that you will not cheat."],imReady:"I'M READY",back:"BACK",next:"NEXT"}}})(),s=()=>{var o;localStorage.setItem("instructionsAccepted","true"),e("/students/details/registration",{state:{googleEmail:(o=t.state)==null?void 0:o.googleEmail}})},i=()=>{e("/students")};return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:[l.jsx(Kg,{className:"from-orange-400 to-red-500"}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 text-center mb-4",children:a.title}),l.jsx("p",{className:"text-gray-600 text-center mb-8",children:a.instructionsIntro}),l.jsx("div",{className:"space-y-4 mb-8",children:a.instructions.map((o,u)=>l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("span",{className:"bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:u+1}),l.jsx("p",{className:"text-gray-700",children:o})]},u))}),l.jsx("div",{className:"text-center",children:l.jsx("button",{onClick:s,className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200",children:a.imReady})}),l.jsxs("div",{className:"flex justify-center space-x-2 mt-8",children:[l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),l.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"})]}),l.jsxs("div",{className:"flex justify-between mt-6",children:[l.jsxs("button",{onClick:i,className:"text-gray-600 hover:text-gray-800 flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),a.back]}),l.jsxs("button",{onClick:s,className:"text-orange-500 hover:text-orange-600 flex items-center",children:[a.next,l.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})},h7=w.createContext(void 0),vR=()=>{const e=w.useContext(h7);if(!e)throw new Error("useLanguage must be used within a LanguageProvider");return e},z_e=({children:e})=>{const[t,r]=w.useState("english");return l.jsx(h7.Provider,{value:{selectedLanguage:t,setSelectedLanguage:r},children:e})};var B_e=Object.defineProperty,U_e=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),bR=(e,t)=>{for(var r in t)B_e(e,r,{get:t[r],enumerable:!0})},W_e={};bR(W_e,{Abs:()=>Xg,Acos:()=>Xh,Acosh:()=>Yh,AdadeltaOptimizer:()=>zD,AdagradOptimizer:()=>BD,AdamOptimizer:()=>UD,AdamaxOptimizer:()=>WD,Add:()=>Yc,AddN:()=>Jh,All:()=>Yg,Any:()=>Jg,ArgMax:()=>Zg,ArgMin:()=>ex,Asin:()=>Zh,Asinh:()=>ep,Atan:()=>tp,Atan2:()=>np,Atanh:()=>rp,AvgPool:()=>ap,AvgPool3D:()=>tx,AvgPool3DGrad:()=>h0,AvgPoolGrad:()=>d0,BackendWasm:()=>wre,BatchMatMul:()=>sp,BatchToSpaceND:()=>rx,Bincount:()=>nx,BitwiseAnd:()=>ax,BroadcastArgs:()=>p0,BroadcastTo:()=>I7,Callback:()=>bY,CallbackList:()=>pX,Cast:()=>ip,Ceil:()=>op,ClipByValue:()=>Jc,Complex:()=>hk,ComplexAbs:()=>f0,Concat:()=>sx,Conv2D:()=>lp,Conv2DBackpropFilter:()=>pk,Conv2DBackpropInput:()=>up,Conv3D:()=>cp,Conv3DBackpropFilterV2:()=>ix,Conv3DBackpropInputV2:()=>ox,Cos:()=>dp,Cosh:()=>hp,CropAndResize:()=>ux,Cumprod:()=>lx,Cumsum:()=>pp,CustomCallback:()=>mX,DataStorage:()=>uk,DenseBincount:()=>m0,DepthToSpace:()=>cx,DepthwiseConv2dNative:()=>fp,DepthwiseConv2dNativeBackpropFilter:()=>fk,DepthwiseConv2dNativeBackpropInput:()=>mk,Diag:()=>g0,Dilation2D:()=>mp,Dilation2DBackpropFilter:()=>lg,Dilation2DBackpropInput:()=>og,Draw:()=>gk,ENV:()=>kR,EarlyStopping:()=>wY,Einsum:()=>xk,Elu:()=>xp,EluGrad:()=>dx,Environment:()=>k7,Equal:()=>hx,Erf:()=>yp,Exp:()=>vp,ExpandDims:()=>px,Expm1:()=>bp,FFT:()=>yk,Fill:()=>x0,FlipLeftRight:()=>fx,Floor:()=>wp,FloorDiv:()=>Np,FromPixels:()=>iS,FusedBatchNorm:()=>Sp,FusedConv2D:()=>Nh,FusedDepthwiseConv2D:()=>Sh,GPGPUContext:()=>aN,GatherNd:()=>gx,GatherV2:()=>mx,GraphModel:()=>TF,Greater:()=>xx,GreaterEqual:()=>_p,History:()=>fX,IFFT:()=>vk,Identity:()=>kp,Imag:()=>bk,InputSpec:()=>Pn,IsFinite:()=>Cp,IsInf:()=>Ip,IsNan:()=>Ep,KernelBackend:()=>u0,LRN:()=>$p,LRNGrad:()=>_x,LayerVariable:()=>sX,LayersModel:()=>Kl,LeakyRelu:()=>Tp,Less:()=>yx,LessEqual:()=>vx,LinSpace:()=>bx,Log:()=>jp,Log1p:()=>Ap,LogSoftmax:()=>T7,LogicalAnd:()=>wx,LogicalNot:()=>Nx,LogicalOr:()=>Sx,LogicalXor:()=>E7,LowerBound:()=>Dke,MathBackendCPU:()=>$F,MathBackendWebGL:()=>iO,MatrixBandPart:()=>Mke,Max:()=>Rp,MaxPool:()=>Mp,MaxPool3D:()=>kx,MaxPool3DGrad:()=>v0,MaxPoolGrad:()=>y0,MaxPoolWithArgmax:()=>b0,Maximum:()=>Dp,Mean:()=>Fp,Min:()=>Op,Minimum:()=>Pp,MirrorPad:()=>Lp,Mod:()=>zp,MomentumOptimizer:()=>VD,Multinomial:()=>Cx,Multiply:()=>Bp,Neg:()=>Ix,NonMaxSuppressionV3:()=>Tx,NonMaxSuppressionV4:()=>jx,NonMaxSuppressionV5:()=>Ax,NotEqual:()=>Ex,OP_SCOPE_SUFFIX:()=>jR,OneHot:()=>Up,OnesLike:()=>$x,Optimizer:()=>mu,OptimizerConstructors:()=>PQ,Pack:()=>Rx,PadV2:()=>Wp,Pool:()=>Fke,Pow:()=>Vp,Prelu:()=>Hp,Prod:()=>qp,RMSPropOptimizer:()=>HD,RNN:()=>gu,RaggedGather:()=>wk,RaggedRange:()=>Nk,RaggedTensorToTensor:()=>Sk,Range:()=>w0,Rank:()=>wT,Real:()=>_k,RealDiv:()=>gp,Reciprocal:()=>Gp,Reduction:()=>Ga,Relu:()=>Kp,Relu6:()=>Yp,Reshape:()=>Dx,ResizeBilinear:()=>Xp,ResizeBilinearGrad:()=>Fx,ResizeNearestNeighbor:()=>Qp,ResizeNearestNeighborGrad:()=>Mx,Reverse:()=>Jp,RotateWithOffset:()=>Yx,Round:()=>Zp,Rsqrt:()=>ef,SGDOptimizer:()=>iC,ScatterNd:()=>Ox,SearchSorted:()=>Lx,Select:()=>zx,Selu:()=>tf,Sequential:()=>vC,Sigmoid:()=>sf,Sign:()=>af,Sin:()=>rf,Sinh:()=>nf,Slice:()=>Bx,Softmax:()=>cf,Softplus:()=>of,SpaceToBatchND:()=>Ux,SparseFillEmptyRows:()=>N0,SparseReshape:()=>Vx,SparseSegmentMean:()=>S0,SparseSegmentSum:()=>_0,SparseToDense:()=>Hx,SplitV:()=>Wx,Sqrt:()=>lf,Square:()=>k0,SquaredDifference:()=>df,StaticRegexReplace:()=>C0,Step:()=>ed,StridedSlice:()=>qx,StringNGrams:()=>I0,StringSplit:()=>E0,StringToHashBucketFast:()=>T0,Sub:()=>hf,Sum:()=>uf,SymbolicTensor:()=>jo,Tan:()=>pf,Tanh:()=>ff,Tensor:()=>Jt,TensorBuffer:()=>zn,TensorScatterUpdate:()=>Px,Tile:()=>Zc,TopK:()=>Gx,Transform:()=>Kx,Transpose:()=>Gl,Unique:()=>j0,Unpack:()=>Qx,UnsortedSegmentSum:()=>A0,UpperBound:()=>Oke,Variable:()=>_h,ZerosLike:()=>Xx,_FusedMatMul:()=>wh,abs:()=>Fn,acos:()=>MR,acosh:()=>FR,add:()=>Ne,addN:()=>nK,all:()=>Tk,any:()=>db,argMax:()=>Eh,argMin:()=>OR,asin:()=>PR,asinh:()=>LR,atan:()=>zR,atan2:()=>BR,atanh:()=>UR,avgPool:()=>hu,avgPool3d:()=>VR,backend:()=>AR,backend_util:()=>H,basicLSTMCell:()=>oK,batchNorm:()=>mf,batchNorm2d:()=>HR,batchNorm3d:()=>qR,batchNorm4d:()=>GR,batchToSpaceND:()=>P0,bincount:()=>KR,bitwiseAnd:()=>lK,booleanMaskAsync:()=>YK,broadcastArgs:()=>uK,broadcastTo:()=>eh,broadcast_util:()=>Jx,browser:()=>Y0,buffer:()=>Qt,callbacks:()=>$Le,cast:()=>Pe,ceil:()=>QR,clipByValue:()=>Ma,clone:()=>il,complex:()=>su,concat:()=>zr,concat1d:()=>XR,concat2d:()=>YR,concat3d:()=>JR,concat4d:()=>ZR,constraints:()=>uX,conv1d:()=>jk,conv2d:()=>Za,conv2dTranspose:()=>Ak,conv3d:()=>tD,conv3dTranspose:()=>rD,copyRegisteredKernels:()=>Bke,cos:()=>L0,cosh:()=>$k,cosineWindow:()=>tC,cumprod:()=>fb,cumsum:()=>Rk,customGrad:()=>fl,data:()=>HY,denseBincount:()=>uS,deprecationWarn:()=>W7,depthToSpace:()=>nD,depthwiseConv2d:()=>gf,deregisterOp:()=>MLe,device_util:()=>M0,diag:()=>dK,dilation2d:()=>aD,disableDeprecationWarnings:()=>xCe,dispose:()=>zt,disposeVariables:()=>yCe,div:()=>it,divNoNan:()=>sD,dot:()=>iD,dropout:()=>MD,einsum:()=>Ed,elu:()=>Zx,enableDebugMode:()=>gCe,enableProdMode:()=>mCe,enclosingPowerOfTwo:()=>FD,engine:()=>Ai,ensureShape:()=>pK,env:()=>ge,equal:()=>Xs,erf:()=>Dk,euclideanNorm:()=>uD,exp:()=>Fa,expandDims:()=>la,expm1:()=>cD,eye:()=>Mk,fft:()=>Q0,fill:()=>Qs,findBackend:()=>_Ce,findBackendFactory:()=>kCe,floor:()=>ty,floorDiv:()=>Ek,forceHalfFloat:()=>mee,fused:()=>gg,gather:()=>ry,gatherND:()=>tQ,gather_util:()=>KD,getBackend:()=>V7,getGradient:()=>vT,getKernel:()=>lb,getKernelsForBackend:()=>oS,getThreadsCount:()=>Bat,gpgpu_util:()=>qZ,grad:()=>nEe,grads:()=>aEe,greater:()=>as,greaterEqual:()=>pu,ifft:()=>mg,imag:()=>z0,image:()=>li,inTopKAsync:()=>rQ,initializers:()=>cX,input:()=>TX,io:()=>Na,irfft:()=>Kk,isFinite:()=>dD,isInf:()=>hD,isNaN:()=>pD,keep:()=>Qn,kernel_impls:()=>Nl,layers:()=>dX,leakyRelu:()=>B0,less:()=>dg,lessEqual:()=>rd,linalg:()=>LD,linspace:()=>yK,loadGraphModel:()=>B3e,loadGraphModelSync:()=>U3e,loadLayersModel:()=>IOe,localResponseNormalization:()=>fD,log:()=>Ys,log1p:()=>U0,logSigmoid:()=>mD,logSoftmax:()=>Ok,logSumExp:()=>W0,logicalAnd:()=>qi,logicalNot:()=>V0,logicalOr:()=>Pk,logicalXor:()=>gD,losses:()=>fQ,lowerBound:()=>bK,matMul:()=>Gt,math:()=>kQ,max:()=>fi,maxPool:()=>na,maxPool3d:()=>xD,maxPoolWithArgmax:()=>wK,maximum:()=>wl,mean:()=>mn,memory:()=>ET,meshgrid:()=>NK,metrics:()=>xY,min:()=>cg,minimum:()=>$c,mirrorPad:()=>yD,mod:()=>vD,model:()=>jOe,models:()=>yY,moments:()=>H0,movingAverage:()=>JK,mul:()=>oe,multiRNNCell:()=>SK,multinomial:()=>_K,neg:()=>Jr,nextFrame:()=>QD,norm:()=>ey,notEqual:()=>Ah,oneHot:()=>hg,ones:()=>fs,onesLike:()=>Js,op:()=>ie,outerProduct:()=>kK,pad:()=>Fo,pad1d:()=>CK,pad2d:()=>IK,pad3d:()=>EK,pad4d:()=>TK,pool:()=>bD,pow:()=>pl,prelu:()=>G0,print:()=>DR,prod:()=>wD,profile:()=>vCe,raggedGather:()=>jK,raggedRange:()=>AK,raggedTensorToTensor:()=>$K,rand:()=>RK,randomGamma:()=>OK,randomNormal:()=>zk,randomStandardNormal:()=>PK,randomUniform:()=>nd,randomUniformInt:()=>LK,range:()=>$h,ready:()=>NCe,real:()=>pg,reciprocal:()=>CD,registerBackend:()=>Ik,registerCallbackConstructor:()=>$Oe,registerGradient:()=>j7,registerKernel:()=>$0,registerOp:()=>DLe,regularizers:()=>vY,relu:()=>Tr,relu6:()=>Bk,removeBackend:()=>SCe,reshape:()=>ue,reverse:()=>Si,reverse1d:()=>zK,reverse2d:()=>BK,reverse3d:()=>UK,reverse4d:()=>WK,rfft:()=>X0,round:()=>Uk,rsqrt:()=>Wk,scalar:()=>bt,scatterND:()=>ZK,scatter_util:()=>Yk,searchSorted:()=>Lk,selu:()=>Vk,separableConv2d:()=>ny,sequential:()=>AOe,serialization:()=>Re,setBackend:()=>wCe,setPlatform:()=>CCe,setThreadsCount:()=>zat,setWasmPath:()=>Pat,setWasmPaths:()=>Lat,setWebGLContext:()=>gZ,setdiff1dAsync:()=>VK,shared:()=>RF,sigmoid:()=>Wi,sign:()=>ID,signal:()=>pQ,sin:()=>Hk,sinh:()=>qk,slice:()=>ir,slice1d:()=>K0,slice2d:()=>Gk,slice3d:()=>ay,slice4d:()=>fg,slice_util:()=>Yn,softmax:()=>ad,softplus:()=>xf,spaceToBatchND:()=>q0,sparse:()=>mQ,sparseToDense:()=>eQ,spectral:()=>hQ,split:()=>gs,sqrt:()=>ha,square:()=>Pr,squaredDifference:()=>Qk,squeeze:()=>sd,stack:()=>Bn,step:()=>yf,stridedSlice:()=>ED,string:()=>gQ,sub:()=>Ze,sum:()=>ht,sumOutType:()=>Ck,tan:()=>TD,tanh:()=>Ac,tensor:()=>Qa,tensor1d:()=>Cr,tensor2d:()=>ol,tensor3d:()=>Xk,tensor4d:()=>Rc,tensor5d:()=>HK,tensor6d:()=>qK,tensorScatterUpdate:()=>KK,tensor_util:()=>vo,test_util:()=>DK,tidy:()=>ce,tile:()=>Us,time:()=>bCe,topk:()=>AD,train:()=>_d,transpose:()=>Kt,truncatedNormal:()=>Zk,unique:()=>$D,unregisterGradient:()=>zke,unregisterKernel:()=>Lke,unsortedSegmentSum:()=>eC,unstack:()=>Cn,upcastType:()=>wi,upperBound:()=>QK,util:()=>R,valueAndGrad:()=>sEe,valueAndGrads:()=>iEe,variable:()=>RD,variableGrads:()=>vK,version:()=>Kat,version_converter:()=>V3e,version_core:()=>j$e,version_cpu:()=>Hze,version_layers:()=>yM,version_wasm:()=>Uat,version_webgl:()=>Dqe,webgl:()=>Mqe,webgl_util:()=>mZ,where:()=>da,whereAsync:()=>DD,zeros:()=>gn,zerosLike:()=>hr});var V_e=Object.create,wR=Object.defineProperty,H_e=Object.getOwnPropertyDescriptor,q_e=Object.getOwnPropertyNames,G_e=Object.getPrototypeOf,K_e=Object.prototype.hasOwnProperty,Hn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ut=(e,t)=>{for(var r in t)wR(e,r,{get:t[r],enumerable:!0})},Q_e=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of q_e(t))!K_e.call(e,a)&&a!==r&&wR(e,a,{get:()=>t[a],enumerable:!(n=H_e(t,a))||n.enumerable});return e},Xc=(e,t,r)=>(r=e!=null?V_e(G_e(e)):{},Q_e(!e||!e.__esModule?wR(r,"default",{value:e,enumerable:!0}):r,e)),X_e=Hn((e,t)=>{t.exports=n;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function n(E,O,M){this.low=E|0,this.high=O|0,this.unsigned=!!M}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0});function a(E){return(E&&E.__isLong__)===!0}n.isLong=a;var s={},i={};function o(E,O){var M,W,q;return O?(E>>>=0,(q=0<=E&&E<256)&&(W=i[E],W)?W:(M=d(E,(E|0)<0?-1:0,!0),q&&(i[E]=M),M)):(E|=0,(q=-128<=E&&E<128)&&(W=s[E],W)?W:(M=d(E,E<0?-1:0,!1),q&&(s[E]=M),M))}n.fromInt=o;function u(E,O){if(isNaN(E))return O?N:b;if(O){if(E<0)return N;if(E>=x)return I}else{if(E<=-y)return T;if(E+1>=y)return k}return E<0?u(-E,O).neg():d(E%m|0,E/m|0,O)}n.fromNumber=u;function d(E,O,M){return new n(E,O,M)}n.fromBits=d;var c=Math.pow;function h(E,O,M){if(E.length===0)throw Error("empty string");if(E==="NaN"||E==="Infinity"||E==="+Infinity"||E==="-Infinity")return b;if(typeof O=="number"?(M=O,O=!1):O=!!O,M=M||10,M<2||36<M)throw RangeError("radix");var W;if((W=E.indexOf("-"))>0)throw Error("interior hyphen");if(W===0)return h(E.substring(1),O,M).neg();for(var q=u(c(M,8)),P=b,A=0;A<E.length;A+=8){var L=Math.min(8,E.length-A),z=parseInt(E.substring(A,A+L),M);if(L<8){var $=u(c(M,L));P=P.mul($).add(u(z))}else P=P.mul(q),P=P.add(u(z))}return P.unsigned=O,P}n.fromString=h;function p(E,O){return typeof E=="number"?u(E,O):typeof E=="string"?h(E,O):d(E.low,E.high,typeof O=="boolean"?O:E.unsigned)}n.fromValue=p;var f=65536,g=1<<24,m=f*f,x=m*m,y=x/2,v=o(g),b=o(0);n.ZERO=b;var N=o(0,!0);n.UZERO=N;var S=o(1);n.ONE=S;var _=o(1,!0);n.UONE=_;var C=o(-1);n.NEG_ONE=C;var k=d(-1,2147483647,!1);n.MAX_VALUE=k;var I=d(-1,-1,!0);n.MAX_UNSIGNED_VALUE=I;var T=d(0,-2147483648,!1);n.MIN_VALUE=T;var j=n.prototype;j.toInt=function(){return this.unsigned?this.low>>>0:this.low},j.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},j.toString=function(E){if(E=E||10,E<2||36<E)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(T)){var O=u(E),M=this.div(O),W=M.mul(O).sub(this);return M.toString(E)+W.toInt().toString(E)}else return"-"+this.neg().toString(E);for(var q=u(c(E,6),this.unsigned),P=this,A="";;){var L=P.div(q),z=P.sub(L.mul(q)).toInt()>>>0,$=z.toString(E);if(P=L,P.isZero())return $+A;for(;$.length<6;)$="0"+$;A=""+$+A}},j.getHighBits=function(){return this.high},j.getHighBitsUnsigned=function(){return this.high>>>0},j.getLowBits=function(){return this.low},j.getLowBitsUnsigned=function(){return this.low>>>0},j.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var E=this.high!=0?this.high:this.low,O=31;O>0&&!(E&1<<O);O--);return this.high!=0?O+33:O+1},j.isZero=function(){return this.high===0&&this.low===0},j.eqz=j.isZero,j.isNegative=function(){return!this.unsigned&&this.high<0},j.isPositive=function(){return this.unsigned||this.high>=0},j.isOdd=function(){return(this.low&1)===1},j.isEven=function(){return(this.low&1)===0},j.equals=function(E){return a(E)||(E=p(E)),this.unsigned!==E.unsigned&&this.high>>>31===1&&E.high>>>31===1?!1:this.high===E.high&&this.low===E.low},j.eq=j.equals,j.notEquals=function(E){return!this.eq(E)},j.neq=j.notEquals,j.ne=j.notEquals,j.lessThan=function(E){return this.comp(E)<0},j.lt=j.lessThan,j.lessThanOrEqual=function(E){return this.comp(E)<=0},j.lte=j.lessThanOrEqual,j.le=j.lessThanOrEqual,j.greaterThan=function(E){return this.comp(E)>0},j.gt=j.greaterThan,j.greaterThanOrEqual=function(E){return this.comp(E)>=0},j.gte=j.greaterThanOrEqual,j.ge=j.greaterThanOrEqual,j.compare=function(E){if(a(E)||(E=p(E)),this.eq(E))return 0;var O=this.isNegative(),M=E.isNegative();return O&&!M?-1:!O&&M?1:this.unsigned?E.high>>>0>this.high>>>0||E.high===this.high&&E.low>>>0>this.low>>>0?-1:1:this.sub(E).isNegative()?-1:1},j.comp=j.compare,j.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(S)},j.neg=j.negate,j.add=function(E){a(E)||(E=p(E));var O=this.high>>>16,M=this.high&65535,W=this.low>>>16,q=this.low&65535,P=E.high>>>16,A=E.high&65535,L=E.low>>>16,z=E.low&65535,$=0,V=0,B=0,Y=0;return Y+=q+z,B+=Y>>>16,Y&=65535,B+=W+L,V+=B>>>16,B&=65535,V+=M+A,$+=V>>>16,V&=65535,$+=O+P,$&=65535,d(B<<16|Y,$<<16|V,this.unsigned)},j.subtract=function(E){return a(E)||(E=p(E)),this.add(E.neg())},j.sub=j.subtract,j.multiply=function(E){if(this.isZero())return b;if(a(E)||(E=p(E)),r){var O=r.mul(this.low,this.high,E.low,E.high);return d(O,r.get_high(),this.unsigned)}if(E.isZero())return b;if(this.eq(T))return E.isOdd()?T:b;if(E.eq(T))return this.isOdd()?T:b;if(this.isNegative())return E.isNegative()?this.neg().mul(E.neg()):this.neg().mul(E).neg();if(E.isNegative())return this.mul(E.neg()).neg();if(this.lt(v)&&E.lt(v))return u(this.toNumber()*E.toNumber(),this.unsigned);var M=this.high>>>16,W=this.high&65535,q=this.low>>>16,P=this.low&65535,A=E.high>>>16,L=E.high&65535,z=E.low>>>16,$=E.low&65535,V=0,B=0,Y=0,re=0;return re+=P*$,Y+=re>>>16,re&=65535,Y+=q*$,B+=Y>>>16,Y&=65535,Y+=P*z,B+=Y>>>16,Y&=65535,B+=W*$,V+=B>>>16,B&=65535,B+=q*z,V+=B>>>16,B&=65535,B+=P*L,V+=B>>>16,B&=65535,V+=M*$+W*z+q*L+P*A,V&=65535,d(Y<<16|re,V<<16|B,this.unsigned)},j.mul=j.multiply,j.divide=function(E){if(a(E)||(E=p(E)),E.isZero())throw Error("division by zero");if(r){if(!this.unsigned&&this.high===-2147483648&&E.low===-1&&E.high===-1)return this;var O=(this.unsigned?r.div_u:r.div_s)(this.low,this.high,E.low,E.high);return d(O,r.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?N:b;var M,W,q;if(this.unsigned){if(E.unsigned||(E=E.toUnsigned()),E.gt(this))return N;if(E.gt(this.shru(1)))return _;q=N}else{if(this.eq(T)){if(E.eq(S)||E.eq(C))return T;if(E.eq(T))return S;var P=this.shr(1);return M=P.div(E).shl(1),M.eq(b)?E.isNegative()?S:C:(W=this.sub(E.mul(M)),q=M.add(W.div(E)),q)}else if(E.eq(T))return this.unsigned?N:b;if(this.isNegative())return E.isNegative()?this.neg().div(E.neg()):this.neg().div(E).neg();if(E.isNegative())return this.div(E.neg()).neg();q=b}for(W=this;W.gte(E);){M=Math.max(1,Math.floor(W.toNumber()/E.toNumber()));for(var A=Math.ceil(Math.log(M)/Math.LN2),L=A<=48?1:c(2,A-48),z=u(M),$=z.mul(E);$.isNegative()||$.gt(W);)M-=L,z=u(M,this.unsigned),$=z.mul(E);z.isZero()&&(z=S),q=q.add(z),W=W.sub($)}return q},j.div=j.divide,j.modulo=function(E){if(a(E)||(E=p(E)),r){var O=(this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,E.low,E.high);return d(O,r.get_high(),this.unsigned)}return this.sub(this.div(E).mul(E))},j.mod=j.modulo,j.rem=j.modulo,j.not=function(){return d(~this.low,~this.high,this.unsigned)},j.and=function(E){return a(E)||(E=p(E)),d(this.low&E.low,this.high&E.high,this.unsigned)},j.or=function(E){return a(E)||(E=p(E)),d(this.low|E.low,this.high|E.high,this.unsigned)},j.xor=function(E){return a(E)||(E=p(E)),d(this.low^E.low,this.high^E.high,this.unsigned)},j.shiftLeft=function(E){return a(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?d(this.low<<E,this.high<<E|this.low>>>32-E,this.unsigned):d(0,this.low<<E-32,this.unsigned)},j.shl=j.shiftLeft,j.shiftRight=function(E){return a(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?d(this.low>>>E|this.high<<32-E,this.high>>E,this.unsigned):d(this.high>>E-32,this.high>=0?0:-1,this.unsigned)},j.shr=j.shiftRight,j.shiftRightUnsigned=function(E){if(a(E)&&(E=E.toInt()),E&=63,E===0)return this;var O=this.high;if(E<32){var M=this.low;return d(M>>>E|O<<32-E,O>>>E,this.unsigned)}else return E===32?d(O,0,this.unsigned):d(O>>>E-32,0,this.unsigned)},j.shru=j.shiftRightUnsigned,j.shr_u=j.shiftRightUnsigned,j.toSigned=function(){return this.unsigned?d(this.low,this.high,!1):this},j.toUnsigned=function(){return this.unsigned?this:d(this.low,this.high,!0)},j.toBytes=function(E){return E?this.toBytesLE():this.toBytesBE()},j.toBytesLE=function(){var E=this.high,O=this.low;return[O&255,O>>>8&255,O>>>16&255,O>>>24,E&255,E>>>8&255,E>>>16&255,E>>>24]},j.toBytesBE=function(){var E=this.high,O=this.low;return[E>>>24,E>>>16&255,E>>>8&255,E&255,O>>>24,O>>>16&255,O>>>8&255,O&255]},n.fromBytes=function(E,O,M){return M?n.fromBytesLE(E,O):n.fromBytesBE(E,O)},n.fromBytesLE=function(E,O){return new n(E[0]|E[1]<<8|E[2]<<16|E[3]<<24,E[4]|E[5]<<8|E[6]<<16|E[7]<<24,O)},n.fromBytesBE=function(E,O){return new n(E[4]<<24|E[5]<<16|E[6]<<8|E[7],E[0]<<24|E[1]<<16|E[2]<<8|E[3],O)}}),Y_e=Hn(()=>{}),J_e=Hn(()=>{}),Z_e=Hn((e,t)=>{(function(r,n,a){function s(d){var c=this,h=u();c.next=function(){var p=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=p-(c.c=p|0)},c.c=1,c.s0=h(" "),c.s1=h(" "),c.s2=h(" "),c.s0-=h(d),c.s0<0&&(c.s0+=1),c.s1-=h(d),c.s1<0&&(c.s1+=1),c.s2-=h(d),c.s2<0&&(c.s2+=1),h=null}function i(d,c){return c.c=d.c,c.s0=d.s0,c.s1=d.s1,c.s2=d.s2,c}function o(d,c){var h=new s(d),p=c&&c.state,f=h.next;return f.int32=function(){return h.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&i(p,h),f.state=function(){return i(h,{})}),f}function u(){var d=4022871197,c=function(h){h=String(h);for(var p=0;p<h.length;p++){d+=h.charCodeAt(p);var f=.02519603282416938*d;d=f>>>0,f-=d,f*=d,d=f>>>0,f-=d,d+=f*4294967296}return(d>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:a&&a.amd?a(function(){return o}):this.alea=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),eke=Hn((e,t)=>{(function(r,n,a){function s(u){var d=this,c="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var p=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^p^p>>>8},u===(u|0)?d.x=u:c+=u;for(var h=0;h<c.length+64;h++)d.x^=c.charCodeAt(h)|0,d.next()}function i(u,d){return d.x=u.x,d.y=u.y,d.z=u.z,d.w=u.w,d}function o(u,d){var c=new s(u),h=d&&d.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,g=(c.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=c.next,p.quick=p,h&&(typeof h=="object"&&i(h,c),p.state=function(){return i(c,{})}),p}n&&n.exports?n.exports=o:a&&a.amd?a(function(){return o}):this.xor128=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),tke=Hn((e,t)=>{(function(r,n,a){function s(u){var d=this,c="";d.next=function(){var p=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^(p^p<<1))|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,u===(u|0)?d.x=u:c+=u;for(var h=0;h<c.length+64;h++)d.x^=c.charCodeAt(h)|0,h==c.length&&(d.d=d.x<<10^d.x>>>4),d.next()}function i(u,d){return d.x=u.x,d.y=u.y,d.z=u.z,d.w=u.w,d.v=u.v,d.d=u.d,d}function o(u,d){var c=new s(u),h=d&&d.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,g=(c.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=c.next,p.quick=p,h&&(typeof h=="object"&&i(h,c),p.state=function(){return i(c,{})}),p}n&&n.exports?n.exports=o:a&&a.amd?a(function(){return o}):this.xorwow=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),rke=Hn((e,t)=>{(function(r,n,a){function s(u){var d=this;d.next=function(){var h=d.x,p=d.i,f,g;return f=h[p],f^=f>>>7,g=f^f<<24,f=h[p+1&7],g^=f^f>>>10,f=h[p+3&7],g^=f^f>>>3,f=h[p+4&7],g^=f^f<<7,f=h[p+7&7],f=f^f<<13,g^=f^f<<9,h[p]=g,d.i=p+1&7,g};function c(h,p){var f,g=[];if(p===(p|0))g[0]=p;else for(p=""+p,f=0;f<p.length;++f)g[f&7]=g[f&7]<<15^p.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],h.x=g,h.i=0,f=256;f>0;--f)h.next()}c(d,u)}function i(u,d){return d.x=u.x.slice(),d.i=u.i,d}function o(u,d){u==null&&(u=+new Date);var c=new s(u),h=d&&d.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,g=(c.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=c.next,p.quick=p,h&&(h.x&&i(h,c),p.state=function(){return i(c,{})}),p}n&&n.exports?n.exports=o:a&&a.amd?a(function(){return o}):this.xorshift7=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),nke=Hn((e,t)=>{(function(r,n,a){function s(u){var d=this;d.next=function(){var h=d.w,p=d.X,f=d.i,g,m;return d.w=h=h+1640531527|0,m=p[f+34&127],g=p[f=f+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,m=p[f]=m^g,d.i=f,m+(h^h>>>16)|0};function c(h,p){var f,g,m,x,y,v=[],b=128;for(p===(p|0)?(g=p,p=null):(p=p+"\0",g=0,b=Math.max(b,p.length)),m=0,x=-32;x<b;++x)p&&(g^=p.charCodeAt((x+32)%p.length)),x===0&&(y=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(y=y+1640531527|0,f=v[x&127]^=g+y,m=f==0?m+1:0);for(m>=128&&(v[(p&&p.length||0)&127]=-1),m=127,x=4*128;x>0;--x)g=v[m+34&127],f=v[m=m+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,v[m]=g^f;h.w=y,h.X=v,h.i=m}c(d,u)}function i(u,d){return d.i=u.i,d.w=u.w,d.X=u.X.slice(),d}function o(u,d){u==null&&(u=+new Date);var c=new s(u),h=d&&d.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,g=(c.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=c.next,p.quick=p,h&&(h.X&&i(h,c),p.state=function(){return i(c,{})}),p}n&&n.exports?n.exports=o:a&&a.amd?a(function(){return o}):this.xor4096=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),ake=Hn((e,t)=>{(function(r,n,a){function s(u){var d=this,c="";d.next=function(){var p=d.b,f=d.c,g=d.d,m=d.a;return p=p<<25^p>>>7^f,f=f-g|0,g=g<<24^g>>>8^m,m=m-p|0,d.b=p=p<<20^p>>>12^f,d.c=f=f-g|0,d.d=g<<16^f>>>16^m,d.a=m-p|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,u===Math.floor(u)?(d.a=u/4294967296|0,d.b=u|0):c+=u;for(var h=0;h<c.length+20;h++)d.b^=c.charCodeAt(h)|0,d.next()}function i(u,d){return d.a=u.a,d.b=u.b,d.c=u.c,d.d=u.d,d}function o(u,d){var c=new s(u),h=d&&d.state,p=function(){return(c.next()>>>0)/4294967296};return p.double=function(){do var f=c.next()>>>11,g=(c.next()>>>0)/4294967296,m=(f+g)/(1<<21);while(m===0);return m},p.int32=c.next,p.quick=p,h&&(typeof h=="object"&&i(h,c),p.state=function(){return i(c,{})}),p}n&&n.exports?n.exports=o:a&&a.amd?a(function(){return o}):this.tychei=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),ske=Hn(()=>{}),ike=Hn((e,t)=>{(function(r,n,a){var s=256,i=6,o=52,u="random",d=a.pow(s,i),c=a.pow(2,o),h=c*2,p=s-1,f;function g(S,_,C){var k=[];_=_==!0?{entropy:!0}:_||{};var I=v(y(_.entropy?[S,N(n)]:S??b(),3),k),T=new m(k),j=function(){for(var E=T.g(i),O=d,M=0;E<c;)E=(E+M)*s,O*=s,M=T.g(1);for(;E>=h;)E/=2,O/=2,M>>>=1;return(E+M)/O};return j.int32=function(){return T.g(4)|0},j.quick=function(){return T.g(4)/4294967296},j.double=j,v(N(T.S),n),(_.pass||C||function(E,O,M,W){return W&&(W.S&&x(W,T),E.state=function(){return x(T,{})}),M?(a[u]=E,O):E})(j,I,"global"in _?_.global:this==a,_.state)}function m(S){var _,C=S.length,k=this,I=0,T=k.i=k.j=0,j=k.S=[];for(C||(S=[C++]);I<s;)j[I]=I++;for(I=0;I<s;I++)j[I]=j[T=p&T+S[I%C]+(_=j[I])],j[T]=_;(k.g=function(E){for(var O,M=0,W=k.i,q=k.j,P=k.S;E--;)O=P[W=p&W+1],M=M*s+P[p&(P[W]=P[q=p&q+O])+(P[q]=O)];return k.i=W,k.j=q,M})(s)}function x(S,_){return _.i=S.i,_.j=S.j,_.S=S.S.slice(),_}function y(S,_){var C=[],k=typeof S,I;if(_&&k=="object")for(I in S)try{C.push(y(S[I],_-1))}catch{}return C.length?C:k=="string"?S:S+"\0"}function v(S,_){for(var C=S+"",k,I=0;I<C.length;)_[p&I]=p&(k^=_[p&I]*19)+C.charCodeAt(I++);return N(_)}function b(){try{var S;return f&&(S=f.randomBytes)?S=S(s):(S=new Uint8Array(s),(r.crypto||r.msCrypto).getRandomValues(S)),N(S)}catch{var _=r.navigator,C=_&&_.plugins;return[+new Date,r,C,r.screen,N(n)]}}function N(S){return String.fromCharCode.apply(0,S)}if(v(a.random(),n),typeof t=="object"&&t.exports){t.exports=g;try{f=ske()}catch{}}else typeof define=="function"&&define.amd?define(function(){return g}):a["seed"+u]=g})(typeof self<"u"?self:e,[],Math)}),lk=Hn((e,t)=>{var r=Z_e(),n=eke(),a=tke(),s=rke(),i=nke(),o=ake(),u=ike();u.alea=r,u.xor128=n,u.xorwow=a,u.xorshift7=s,u.xor4096=i,u.tychei=o,t.exports=u}),p7=Hn(()=>{}),NR=Hn(()=>{}),f7=Hn(()=>{}),oke=Hn(()=>{}),lke=Hn(()=>{}),uke=Hn(()=>{}),cke=Hn((e,t)=>{var r=(()=>{var n=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(n=n||__filename),function(a){a=a||{};function s(){return A.buffer!=J&&pe(A.buffer),Z}function i(){return A.buffer!=J&&pe(A.buffer),Q}function o(){return A.buffer!=J&&pe(A.buffer),U}function u(){return A.buffer!=J&&pe(A.buffer),F}function d(){return A.buffer!=J&&pe(A.buffer),te}var c=typeof a<"u"?a:{},h,p;c.ready=new Promise(function(ne,ye){h=ne,p=ye});var f;typeof process<"u"&&process.listeners&&(f={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var g=Object.assign({},c),m=(ne,ye)=>{throw ye},x=typeof window=="object",y=typeof importScripts=="function",v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",b=c.ENVIRONMENT_IS_PTHREAD||!1,N="";function S(ne){return c.locateFile?c.locateFile(ne,N):N+ne}var _,C,k;function I(ne){ne instanceof Ie||W("exiting due to exception: "+ne)}if(v){var T=NR(),j=f7();y?N=j.dirname(N)+"/":N=__dirname+"/",_=(ye,We)=>(ye=nr(ye)?new URL(ye):j.normalize(ye),T.readFileSync(ye,We?void 0:"utf8")),k=ye=>{var We=_(ye,!0);return We.buffer||(We=new Uint8Array(We)),We},C=(ye,We,Tt)=>{ye=nr(ye)?new URL(ye):j.normalize(ye),T.readFile(ye,function(Ht,qt){Ht?Tt(Ht):We(qt.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(ye){if(!(ye instanceof Ie))throw ye}),process.on("unhandledRejection",function(ye){throw ye}),m=(ye,We)=>{if(ft())throw process.exitCode=ye,We;I(We),process.exit(ye)},c.inspect=function(){return"[Emscripten Module object]"};let ne;try{ne=oke()}catch(ye){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),ye}global.Worker=ne.Worker}else(x||y)&&(y?N=self.location.href:typeof document<"u"&&document.currentScript&&(N=document.currentScript.src),typeof n<"u"&&n&&(N=n),N.indexOf("blob:")!==0?N=N.substr(0,N.replace(/[?#].*/,"").lastIndexOf("/")+1):N="",v||(_=ne=>{var ye=new XMLHttpRequest;return ye.open("GET",ne,!1),ye.send(null),ye.responseText},y&&(k=ne=>{var ye=new XMLHttpRequest;return ye.open("GET",ne,!1),ye.responseType="arraybuffer",ye.send(null),new Uint8Array(ye.response)}),C=(ne,ye,We)=>{var Tt=new XMLHttpRequest;Tt.open("GET",ne,!0),Tt.responseType="arraybuffer",Tt.onload=()=>{if(Tt.status==200||Tt.status==0&&Tt.response){ye(Tt.response);return}We()},Tt.onerror=We,Tt.send(null)}));v&&typeof performance>"u"&&(global.performance=lke().performance);var E=console.log.bind(console),O=console.warn.bind(console);v&&(E=ne=>T.writeSync(1,ne+`
`),O=ne=>T.writeSync(2,ne+`
`));var M=c.print||E,W=c.printErr||O;Object.assign(c,g),g=null,c.arguments&&c.arguments,c.thisProgram&&c.thisProgram,c.quit&&(m=c.quit);var q;c.wasmBinary&&(q=c.wasmBinary);var P=c.noExitRuntime||!0;typeof WebAssembly!="object"&&ur("no native wasm support detected");var A,L,z=!1,$;function V(ne,ye){ne||ur(ye)}var B=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Y(ne,ye,We){ye>>>=0;for(var Tt=ye+We,Ht=ye;ne[Ht]&&!(Ht>=Tt);)++Ht;if(Ht-ye>16&&ne.buffer&&B)return B.decode(ne.buffer instanceof SharedArrayBuffer?ne.slice(ye,Ht):ne.subarray(ye,Ht));for(var qt="";ye<Ht;){var ot=ne[ye++];if(!(ot&128)){qt+=String.fromCharCode(ot);continue}var St=ne[ye++]&63;if((ot&224)==192){qt+=String.fromCharCode((ot&31)<<6|St);continue}var hn=ne[ye++]&63;if((ot&240)==224?ot=(ot&15)<<12|St<<6|hn:ot=(ot&7)<<18|St<<12|hn<<6|ne[ye++]&63,ot<65536)qt+=String.fromCharCode(ot);else{var ni=ot-65536;qt+=String.fromCharCode(55296|ni>>10,56320|ni&1023)}}return qt}function re(ne,ye){return ne>>>=0,ne?Y(i(),ne,ye):""}function ae(ne,ye,We,Tt){if(We>>>=0,!(Tt>0))return 0;for(var Ht=We,qt=We+Tt-1,ot=0;ot<ne.length;++ot){var St=ne.charCodeAt(ot);if(St>=55296&&St<=57343){var hn=ne.charCodeAt(++ot);St=65536+((St&1023)<<10)|hn&1023}if(St<=127){if(We>=qt)break;ye[We++>>>0]=St}else if(St<=2047){if(We+1>=qt)break;ye[We++>>>0]=192|St>>6,ye[We++>>>0]=128|St&63}else if(St<=65535){if(We+2>=qt)break;ye[We++>>>0]=224|St>>12,ye[We++>>>0]=128|St>>6&63,ye[We++>>>0]=128|St&63}else{if(We+3>=qt)break;ye[We++>>>0]=240|St>>18,ye[We++>>>0]=128|St>>12&63,ye[We++>>>0]=128|St>>6&63,ye[We++>>>0]=128|St&63}}return ye[We>>>0]=0,We-Ht}function K(ne,ye,We){return ae(ne,i(),ye,We)}var J,Z,Q,U,F,te;b&&(J=c.buffer);function pe(ne){J=ne,c.HEAP8=Z=new Int8Array(ne),c.HEAP16=new Int16Array(ne),c.HEAP32=U=new Int32Array(ne),c.HEAPU8=Q=new Uint8Array(ne),c.HEAPU16=new Uint16Array(ne),c.HEAPU32=F=new Uint32Array(ne),c.HEAPF32=new Float32Array(ne),c.HEAPF64=te=new Float64Array(ne)}var ve=c.INITIAL_MEMORY||16777216;if(b)A=c.wasmMemory,J=c.buffer;else if(c.wasmMemory)A=c.wasmMemory;else if(A=new WebAssembly.Memory({initial:ve/65536,maximum:65536,shared:!0}),!(A.buffer instanceof SharedArrayBuffer))throw W("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&W("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");A&&(J=A.buffer),ve=J.byteLength,pe(J);var fe,Me=[],je=[],Qe=[];function ft(){return P}function Ot(){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)Fe(c.preRun.shift());be(Me)}function yt(){!b&&be(je)}function De(){if(!b){if(c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;)Ae(c.postRun.shift());be(Qe)}}function Fe(ne){Me.unshift(ne)}function et(ne){je.unshift(ne)}function Ae(ne){Qe.unshift(ne)}var He=0,st=null;function kt(ne){He++,c.monitorRunDependencies&&c.monitorRunDependencies(He)}function Vt(ne){if(He--,c.monitorRunDependencies&&c.monitorRunDependencies(He),He==0&&st){var ye=st;st=null,ye()}}function ur(ne){c.onAbort&&c.onAbort(ne),ne="Aborted("+ne+")",W(ne),z=!0,$=1,ne+=". Build with -sASSERTIONS for more info.";var ye=new WebAssembly.RuntimeError(ne);throw p(ye),ye}var we="data:application/octet-stream;base64,";function wr(ne){return ne.startsWith(we)}function nr(ne){return ne.startsWith("file://")}var Zt;Zt="tfjs-backend-wasm-threaded-simd.wasm",wr(Zt)||(Zt=S(Zt));function _r(ne){try{if(ne==Zt&&q)return new Uint8Array(q);if(k)return k(ne);throw"both async and sync fetching of the wasm failed"}catch(ye){ur(ye)}}function Cs(){if(!q&&(x||y)){if(typeof fetch=="function"&&!nr(Zt))return fetch(Zt,{credentials:"same-origin"}).then(function(ne){if(!ne.ok)throw"failed to load wasm binary file at '"+Zt+"'";return ne.arrayBuffer()}).catch(function(){return _r(Zt)});if(C)return new Promise(function(ne,ye){C(Zt,function(We){ne(new Uint8Array(We))},ye)})}return Promise.resolve().then(function(){return _r(Zt)})}function vn(){var ne={env:vu,wasi_snapshot_preview1:vu};function ye(ot,St){var hn=ot.exports;if(c.asm=hn,Xr(c.asm._emscripten_tls_init),fe=c.asm.__indirect_function_table,et(c.asm.__wasm_call_ctors),L=St,!b){var ni=ee.unusedWorkers.length;ee.unusedWorkers.forEach(function(Cl){ee.loadWasmModuleToWorker(Cl,function(){--ni||Vt()})})}}b||kt();function We(ot){ye(ot.instance,ot.module)}function Tt(ot){return Cs().then(function(St){return WebAssembly.instantiate(St,ne)}).then(function(St){return St}).then(ot,function(St){W("failed to asynchronously prepare wasm: "+St),ur(St)})}function Ht(){return!q&&typeof WebAssembly.instantiateStreaming=="function"&&!wr(Zt)&&!nr(Zt)&&!v&&typeof fetch=="function"?fetch(Zt,{credentials:"same-origin"}).then(function(ot){var St=WebAssembly.instantiateStreaming(ot,ne);return St.then(We,function(hn){return W("wasm streaming compile failed: "+hn),W("falling back to ArrayBuffer instantiation"),Tt(We)})}):Tt(We)}if(c.instantiateWasm)try{var qt=c.instantiateWasm(ne,ye);return qt}catch(ot){W("Module.instantiateWasm callback failed with error: "+ot),p(ot)}return Ht().catch(p),{}}var xe={};function Ie(ne){this.name="ExitStatus",this.message="Program terminated with exit("+ne+")",this.status=ne}function Oe(ne){var ye=ee.pthreads[ne];delete ee.pthreads[ne],ye.terminate(),PC(ne),ee.runningWorkers.splice(ee.runningWorkers.indexOf(ye),1),ye.pthread_ptr=0}function vt(ne){var ye=ee.pthreads[ne];ye.postMessage({cmd:"cancel"})}function $t(ne){var ye=ee.pthreads[ne];V(ye),ee.returnWorkerToPool(ye)}function cr(ne){var ye=ee.getNewWorker();if(!ye)return 6;ee.runningWorkers.push(ye),ee.pthreads[ne.pthread_ptr]=ye,ye.pthread_ptr=ne.pthread_ptr;var We={cmd:"run",start_routine:ne.startRoutine,arg:ne.arg,pthread_ptr:ne.pthread_ptr};return ye.runPthread=()=>{v&&ye.ref(),ye.postMessage(We,ne.transferList),delete ye.runPthread},ye.loaded&&ye.runPthread(),0}function tt(ne){if(b)return _l(1,1,ne);$=ne,ft()||(ee.terminateAllThreads(),c.onExit&&c.onExit(ne),z=!0),m(ne,new Ie(ne))}function me(ne,ye){if($=ne,!ye&&b)throw Te(ne),"unwind";tt(ne)}var Ce=me;function rt(ne){if(ne instanceof Ie||ne=="unwind")return $;m(1,ne)}var ee={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){b?ee.initWorker():ee.initMainThread()},initMainThread:function(){for(var ne=8;ne--;)ee.allocateUnusedWorker()},initWorker:function(){P=!1},setExitStatus:function(ne){$=ne},terminateAllThreads:function(){for(var ne of Object.values(ee.pthreads))ee.returnWorkerToPool(ne);for(var ne of ee.unusedWorkers)ne.terminate();ee.unusedWorkers=[]},returnWorkerToPool:function(ne){var ye=ne.pthread_ptr;delete ee.pthreads[ye],ee.unusedWorkers.push(ne),ee.runningWorkers.splice(ee.runningWorkers.indexOf(ne),1),ne.pthread_ptr=0,v&&ne.unref(),PC(ye)},receiveObjectTransfer:function(ne){},threadInitTLS:function(){ee.tlsInitFunctions.forEach(ne=>ne())},loadWasmModuleToWorker:function(ne,ye){ne.onmessage=qt=>{var ot=qt.data,St=ot.cmd;if(ne.pthread_ptr&&(ee.currentProxiedOperationCallerThread=ne.pthread_ptr),ot.targetThread&&ot.targetThread!=Sw()){var hn=ee.pthreads[ot.targetThread];hn?hn.postMessage(ot,ot.transferList):W('Internal error! Worker sent a message "'+St+'" to target pthread '+ot.targetThread+", but that thread no longer exists!"),ee.currentProxiedOperationCallerThread=void 0;return}St==="processProxyingQueue"?kr(ot.queue):St==="spawnThread"?cr(ot):St==="cleanupThread"?$t(ot.thread):St==="killThread"?Oe(ot.thread):St==="cancelThread"?vt(ot.thread):St==="loaded"?(ne.loaded=!0,v&&ne.unref(),ye&&ye(ne),ne.runPthread&&ne.runPthread()):St==="print"?M("Thread "+ot.threadId+": "+ot.text):St==="printErr"?W("Thread "+ot.threadId+": "+ot.text):St==="alert"?alert("Thread "+ot.threadId+": "+ot.text):ot.target==="setimmediate"?ne.postMessage(ot):St==="callHandler"?c[ot.handler](...ot.args):St&&W("worker sent an unknown command "+St),ee.currentProxiedOperationCallerThread=void 0},ne.onerror=qt=>{var ot="worker sent an error!";throw W(ot+" "+qt.filename+":"+qt.lineno+": "+qt.message),qt},v&&(ne.on("message",function(qt){ne.onmessage({data:qt})}),ne.on("error",function(qt){ne.onerror(qt)}),ne.on("detachedExit",function(){}));var We=[],Tt=["onExit","onAbort","print","printErr"];for(var Ht of Tt)c.hasOwnProperty(Ht)&&We.push(Ht);ne.postMessage({cmd:"load",handlers:We,urlOrBlob:c.mainScriptUrlOrBlob||n,wasmMemory:A,wasmModule:L})},allocateUnusedWorker:function(){var ne,ye=S("tfjs-backend-wasm-threaded-simd.worker.js");ne=new Worker(ye),ee.unusedWorkers.push(ne)},getNewWorker:function(){return ee.unusedWorkers.length==0&&(ee.allocateUnusedWorker(),ee.loadWasmModuleToWorker(ee.unusedWorkers[0])),ee.unusedWorkers.pop()}};c.PThread=ee;function be(ne){for(;ne.length>0;)ne.shift()(c)}function nt(){var ne=Sw(),ye=o()[ne+52>>>2],We=o()[ne+56>>>2],Tt=ye-We;OO(ye,Tt),_w(ye)}c.establishStackSpace=nt;function Te(ne){if(b)return _l(2,0,ne);try{Ce(ne)}catch(ye){rt(ye)}}var Ge=[];function wt(ne){var ye=Ge[ne];return ye||(ne>=Ge.length&&(Ge.length=ne+1),Ge[ne]=ye=fe.get(ne)),ye}function Dt(ne,ye){var We=wt(ne)(ye);ft()?ee.setExitStatus(We):FO(We)}c.invokeEntryPoint=Dt;function Xr(ne){ee.tlsInitFunctions.push(ne)}function In(ne){RO(ne,!y,1,!x),ee.threadInitTLS()}function Rr(ne){b?postMessage({cmd:"cleanupThread",thread:ne}):$t(ne)}function an(ne,ye,We,Tt){return b?_l(3,1,ne,ye,We,Tt):xr(ne,ye,We,Tt)}function xr(ne,ye,We,Tt){if(typeof SharedArrayBuffer>"u")return W("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var Ht=[],qt=0;if(b&&(Ht.length===0||qt))return an(ne,ye,We,Tt);var ot={startRoutine:We,pthread_ptr:ne,arg:Tt,transferList:Ht};return b?(ot.cmd="spawnThread",postMessage(ot,Ht),0):cr(ot)}function bn(){return 65536}var yr=!0;function _t(){return yr}function kr(ne){Atomics.store(o(),ne>>2,1),Sw()&&MO(ne),Atomics.compareExchange(o(),ne>>2,1,0)}c.executeNotifiedProxyingQueue=kr;function La(ne,ye,We,Tt){if(ne==ye)setTimeout(()=>kr(Tt));else if(b)postMessage({targetThread:ne,cmd:"processProxyingQueue",queue:Tt});else{var Ht=ee.pthreads[ne];if(!Ht)return;Ht.postMessage({cmd:"processProxyingQueue",queue:Tt})}return 1}function Is(ne,ye,We){return-1}function Yi(){ur("")}function yu(ne){yu.shown||(yu.shown={}),yu.shown[ne]||(yu.shown[ne]=1,v&&(ne="warning: "+ne),W(ne))}function fw(){v||y||yu("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function mw(){return Date.now()}function vy(){return 4294901760}function gw(){return vy()}var If;v?If=()=>{var ne=process.hrtime();return ne[0]*1e3+ne[1]/1e6}:If=()=>performance.timeOrigin+performance.now();function xw(ne,ye,We){i().copyWithin(ne>>>0,ye>>>0,ye+We>>>0)}function yw(){return v?uke().cpus().length:navigator.hardwareConcurrency}function vw(ne){var ye=LC(),We=ne();return _w(ye),We}function _l(ne,ye){var We=arguments.length-2,Tt=arguments;return vw(()=>{for(var Ht=We,qt=kw(Ht*8),ot=qt>>3,St=0;St<We;St++){var hn=Tt[2+St];d()[ot+St>>>0]=hn}return DO(ne,Ht,qt,ye)})}var Ef=[];function bw(ne,ye,We){Ef.length=ye;for(var Tt=We>>3,Ht=0;Ht<ye;Ht++)Ef[Ht]=d()[Tt+Ht>>>0];var qt=ne<0,ot=qt?xe[-ne-1]:fd[ne];return ot.apply(null,Ef)}function ww(ne){try{return A.grow(ne-J.byteLength+65535>>>16),pe(A.buffer),1}catch{}}function Nw(ne){var ye=i().length;if(ne=ne>>>0,ne<=ye)return!1;var We=vy();if(ne>We)return!1;let Tt=(hn,ni)=>hn+(ni-hn%ni)%ni;for(var Ht=1;Ht<=4;Ht*=2){var qt=ye*(1+.2/Ht);qt=Math.min(qt,ne+100663296);var ot=Math.min(We,Tt(Math.max(ne,qt),65536)),St=ww(ot);if(St)return!0}return!1}function ke(){throw"unwind"}function $e(ne){return b?_l(4,1,ne):52}function Nt(ne,ye,We,Tt,Ht){return b?_l(5,1,ne,ye,We,Tt,Ht):70}var Ct=[null,[],[]];function ta(ne,ye){var We=Ct[ne];ye===0||ye===10?((ne===1?M:W)(Y(We,0)),We.length=0):We.push(ye)}function Ta(ne,ye,We,Tt){if(b)return _l(6,1,ne,ye,We,Tt);for(var Ht=0,qt=0;qt<We;qt++){var ot=u()[ye>>>2],St=u()[ye+4>>>2];ye+=8;for(var hn=0;hn<St;hn++)ta(ne,i()[ot+hn>>>0]);Ht+=St}return u()[Tt>>>2]=Ht,0}function kl(ne){var ye=c["_"+ne];return ye}function pd(ne,ye){s().set(ne,ye>>>0)}function ja(ne,ye,We,Tt,Ht){var qt={string:ai=>{var Tf=0;if(ai!=null&&ai!==0){var zO=(ai.length<<2)+1;Tf=kw(zO),K(ai,Tf,zO)}return Tf},array:ai=>{var Tf=kw(ai.length);return pd(ai,Tf),Tf}};function ot(ai){return ye==="string"?re(ai):ye==="boolean"?!!ai:ai}var St=kl(ne),hn=[],ni=0;if(Tt)for(var Cl=0;Cl<Tt.length;Cl++){var LO=qt[We[Cl]];LO?(ni===0&&(ni=LC()),hn[Cl]=LO(Tt[Cl])):hn[Cl]=Tt[Cl]}var zC=St.apply(null,hn);function gne(ai){return ni!==0&&_w(ni),ot(ai)}return zC=gne(zC),zC}function ri(ne,ye,We,Tt){We=We||[];var Ht=We.every(ot=>ot==="number"||ot==="boolean"),qt=ye!=="string";return qt&&Ht&&!Tt?kl(ne):function(){return ja(ne,ye,We,arguments)}}ee.init();var fd=[null,tt,Te,an,$e,Nt,Ta],vu={__emscripten_init_main_thread_js:In,__emscripten_thread_cleanup:Rr,__pthread_create_js:xr,_emscripten_default_pthread_stack_size:bn,_emscripten_get_now_is_monotonic:_t,_emscripten_notify_task_queue:La,_emscripten_set_offscreencanvas_size:Is,abort:Yi,emscripten_check_blocking_allowed:fw,emscripten_date_now:mw,emscripten_get_heap_max:gw,emscripten_get_now:If,emscripten_memcpy_big:xw,emscripten_num_logical_cores:yw,emscripten_receive_on_main_thread_js:bw,emscripten_resize_heap:Nw,emscripten_unwind_to_js_event_loop:ke,exit:Ce,fd_close:$e,fd_seek:Nt,fd_write:Ta,memory:A||c.wasmMemory};vn(),c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.__wasm_call_ctors).apply(null,arguments)},c._init=function(){return(c._init=c.asm.init).apply(null,arguments)},c._init_with_threads_count=function(){return(c._init_with_threads_count=c.asm.init_with_threads_count).apply(null,arguments)},c._get_threads_count=function(){return(c._get_threads_count=c.asm.get_threads_count).apply(null,arguments)},c._register_tensor=function(){return(c._register_tensor=c.asm.register_tensor).apply(null,arguments)},c._dispose_data=function(){return(c._dispose_data=c.asm.dispose_data).apply(null,arguments)},c._dispose=function(){return(c._dispose=c.asm.dispose).apply(null,arguments)},c._Abs=function(){return(c._Abs=c.asm.Abs).apply(null,arguments)},c._Acos=function(){return(c._Acos=c.asm.Acos).apply(null,arguments)},c._Acosh=function(){return(c._Acosh=c.asm.Acosh).apply(null,arguments)},c._Add=function(){return(c._Add=c.asm.Add).apply(null,arguments)},c._AddN=function(){return(c._AddN=c.asm.AddN).apply(null,arguments)},c._All=function(){return(c._All=c.asm.All).apply(null,arguments)},c._Any=function(){return(c._Any=c.asm.Any).apply(null,arguments)},c._ArgMax=function(){return(c._ArgMax=c.asm.ArgMax).apply(null,arguments)},c._ArgMin=function(){return(c._ArgMin=c.asm.ArgMin).apply(null,arguments)},c._Asin=function(){return(c._Asin=c.asm.Asin).apply(null,arguments)},c._Asinh=function(){return(c._Asinh=c.asm.Asinh).apply(null,arguments)},c._Atan=function(){return(c._Atan=c.asm.Atan).apply(null,arguments)},c._Atan2=function(){return(c._Atan2=c.asm.Atan2).apply(null,arguments)},c._Atanh=function(){return(c._Atanh=c.asm.Atanh).apply(null,arguments)},c._AvgPool=function(){return(c._AvgPool=c.asm.AvgPool).apply(null,arguments)},c._AvgPool3D=function(){return(c._AvgPool3D=c.asm.AvgPool3D).apply(null,arguments)},c._AvgPool3DGrad=function(){return(c._AvgPool3DGrad=c.asm.AvgPool3DGrad).apply(null,arguments)},c._AvgPoolGrad=function(){return(c._AvgPoolGrad=c.asm.AvgPoolGrad).apply(null,arguments)},c._BatchMatMul=function(){return(c._BatchMatMul=c.asm.BatchMatMul).apply(null,arguments)},c._Bincount=function(){return(c._Bincount=c.asm.Bincount).apply(null,arguments)},c._BitwiseAnd=function(){return(c._BitwiseAnd=c.asm.BitwiseAnd).apply(null,arguments)},c._Ceil=function(){return(c._Ceil=c.asm.Ceil).apply(null,arguments)},c._ClipByValue=function(){return(c._ClipByValue=c.asm.ClipByValue).apply(null,arguments)},c._Conv2D=function(){return(c._Conv2D=c.asm.Conv2D).apply(null,arguments)},c._Conv2DBackpropInput=function(){return(c._Conv2DBackpropInput=c.asm.Conv2DBackpropInput).apply(null,arguments)},c._Conv3D=function(){return(c._Conv3D=c.asm.Conv3D).apply(null,arguments)},c._Conv3DBackpropFilterV2=function(){return(c._Conv3DBackpropFilterV2=c.asm.Conv3DBackpropFilterV2).apply(null,arguments)},c._Conv3DBackpropInputV2=function(){return(c._Conv3DBackpropInputV2=c.asm.Conv3DBackpropInputV2).apply(null,arguments)},c._Cos=function(){return(c._Cos=c.asm.Cos).apply(null,arguments)},c._Cosh=function(){return(c._Cosh=c.asm.Cosh).apply(null,arguments)},c._CropAndResize=function(){return(c._CropAndResize=c.asm.CropAndResize).apply(null,arguments)},c._Cumprod=function(){return(c._Cumprod=c.asm.Cumprod).apply(null,arguments)},c._Cumsum=function(){return(c._Cumsum=c.asm.Cumsum).apply(null,arguments)},c._DenseBincount=function(){return(c._DenseBincount=c.asm.DenseBincount).apply(null,arguments)},c._DepthToSpace=function(){return(c._DepthToSpace=c.asm.DepthToSpace).apply(null,arguments)},c._DepthwiseConv2dNative=function(){return(c._DepthwiseConv2dNative=c.asm.DepthwiseConv2dNative).apply(null,arguments)},c._Diag=function(){return(c._Diag=c.asm.Diag).apply(null,arguments)},c._Dilation2D=function(){return(c._Dilation2D=c.asm.Dilation2D).apply(null,arguments)},c._Dilation2DBackpropFilter=function(){return(c._Dilation2DBackpropFilter=c.asm.Dilation2DBackpropFilter).apply(null,arguments)},c._Dilation2DBackpropInput=function(){return(c._Dilation2DBackpropInput=c.asm.Dilation2DBackpropInput).apply(null,arguments)},c._Elu=function(){return(c._Elu=c.asm.Elu).apply(null,arguments)},c._EluGrad=function(){return(c._EluGrad=c.asm.EluGrad).apply(null,arguments)},c._Equal=function(){return(c._Equal=c.asm.Equal).apply(null,arguments)},c._Erf=function(){return(c._Erf=c.asm.Erf).apply(null,arguments)},c._Exp=function(){return(c._Exp=c.asm.Exp).apply(null,arguments)},c._Expm1=function(){return(c._Expm1=c.asm.Expm1).apply(null,arguments)},c._FlipLeftRight=function(){return(c._FlipLeftRight=c.asm.FlipLeftRight).apply(null,arguments)},c._Floor=function(){return(c._Floor=c.asm.Floor).apply(null,arguments)},c._FloorDiv=function(){return(c._FloorDiv=c.asm.FloorDiv).apply(null,arguments)},c._FusedBatchNorm=function(){return(c._FusedBatchNorm=c.asm.FusedBatchNorm).apply(null,arguments)},c._FusedConv2D=function(){return(c._FusedConv2D=c.asm.FusedConv2D).apply(null,arguments)},c._FusedDepthwiseConv2D=function(){return(c._FusedDepthwiseConv2D=c.asm.FusedDepthwiseConv2D).apply(null,arguments)},c._Gather=function(){return(c._Gather=c.asm.Gather).apply(null,arguments)},c._GatherNd=function(){return(c._GatherNd=c.asm.GatherNd).apply(null,arguments)},c._Greater=function(){return(c._Greater=c.asm.Greater).apply(null,arguments)},c._GreaterEqual=function(){return(c._GreaterEqual=c.asm.GreaterEqual).apply(null,arguments)},c._IsFinite=function(){return(c._IsFinite=c.asm.IsFinite).apply(null,arguments)},c._IsInf=function(){return(c._IsInf=c.asm.IsInf).apply(null,arguments)},c._IsNan=function(){return(c._IsNan=c.asm.IsNan).apply(null,arguments)},c._LRN=function(){return(c._LRN=c.asm.LRN).apply(null,arguments)},c._LRNGrad=function(){return(c._LRNGrad=c.asm.LRNGrad).apply(null,arguments)},c._LeakyRelu=function(){return(c._LeakyRelu=c.asm.LeakyRelu).apply(null,arguments)},c._Less=function(){return(c._Less=c.asm.Less).apply(null,arguments)},c._LessEqual=function(){return(c._LessEqual=c.asm.LessEqual).apply(null,arguments)},c._LinSpace=function(){return(c._LinSpace=c.asm.LinSpace).apply(null,arguments)},c._Log=function(){return(c._Log=c.asm.Log).apply(null,arguments)},c._Log1p=function(){return(c._Log1p=c.asm.Log1p).apply(null,arguments)},c._LogicalAnd=function(){return(c._LogicalAnd=c.asm.LogicalAnd).apply(null,arguments)},c._LogicalNot=function(){return(c._LogicalNot=c.asm.LogicalNot).apply(null,arguments)},c._LogicalOr=function(){return(c._LogicalOr=c.asm.LogicalOr).apply(null,arguments)},c._LogicalXor=function(){return(c._LogicalXor=c.asm.LogicalXor).apply(null,arguments)},c._Max=function(){return(c._Max=c.asm.Max).apply(null,arguments)},c._MaxPool=function(){return(c._MaxPool=c.asm.MaxPool).apply(null,arguments)},c._MaxPool3D=function(){return(c._MaxPool3D=c.asm.MaxPool3D).apply(null,arguments)},c._MaxPool3DGrad=function(){return(c._MaxPool3DGrad=c.asm.MaxPool3DGrad).apply(null,arguments)},c._MaxPoolGrad=function(){return(c._MaxPoolGrad=c.asm.MaxPoolGrad).apply(null,arguments)},c._MaxPoolWithArgmax=function(){return(c._MaxPoolWithArgmax=c.asm.MaxPoolWithArgmax).apply(null,arguments)},c._Maximum=function(){return(c._Maximum=c.asm.Maximum).apply(null,arguments)},c._Mean=function(){return(c._Mean=c.asm.Mean).apply(null,arguments)},c._Min=function(){return(c._Min=c.asm.Min).apply(null,arguments)},c._Minimum=function(){return(c._Minimum=c.asm.Minimum).apply(null,arguments)},c._MirrorPad=function(){return(c._MirrorPad=c.asm.MirrorPad).apply(null,arguments)},c._Mod=function(){return(c._Mod=c.asm.Mod).apply(null,arguments)},c._Multinomial=function(){return(c._Multinomial=c.asm.Multinomial).apply(null,arguments)},c._Multiply=function(){return(c._Multiply=c.asm.Multiply).apply(null,arguments)},c._Neg=function(){return(c._Neg=c.asm.Neg).apply(null,arguments)},c._NonMaxSuppressionV3=function(){return(c._NonMaxSuppressionV3=c.asm.NonMaxSuppressionV3).apply(null,arguments)},c._NonMaxSuppressionV4=function(){return(c._NonMaxSuppressionV4=c.asm.NonMaxSuppressionV4).apply(null,arguments)},c._NonMaxSuppressionV5=function(){return(c._NonMaxSuppressionV5=c.asm.NonMaxSuppressionV5).apply(null,arguments)},c._NotEqual=function(){return(c._NotEqual=c.asm.NotEqual).apply(null,arguments)},c._OneHot=function(){return(c._OneHot=c.asm.OneHot).apply(null,arguments)},c._PadV2=function(){return(c._PadV2=c.asm.PadV2).apply(null,arguments)},c._Pow=function(){return(c._Pow=c.asm.Pow).apply(null,arguments)},c._Prelu=function(){return(c._Prelu=c.asm.Prelu).apply(null,arguments)},c._Prod=function(){return(c._Prod=c.asm.Prod).apply(null,arguments)},c._RealDiv=function(){return(c._RealDiv=c.asm.RealDiv).apply(null,arguments)},c._Reciprocal=function(){return(c._Reciprocal=c.asm.Reciprocal).apply(null,arguments)},c._Relu=function(){return(c._Relu=c.asm.Relu).apply(null,arguments)},c._Relu6=function(){return(c._Relu6=c.asm.Relu6).apply(null,arguments)},c._ResizeBilinear=function(){return(c._ResizeBilinear=c.asm.ResizeBilinear).apply(null,arguments)},c._ResizeBilinearGrad=function(){return(c._ResizeBilinearGrad=c.asm.ResizeBilinearGrad).apply(null,arguments)},c._ResizeNearestNeighbor=function(){return(c._ResizeNearestNeighbor=c.asm.ResizeNearestNeighbor).apply(null,arguments)},c._ResizeNearestNeighborGrad=function(){return(c._ResizeNearestNeighborGrad=c.asm.ResizeNearestNeighborGrad).apply(null,arguments)},c._Reverse=function(){return(c._Reverse=c.asm.Reverse).apply(null,arguments)},c._RotateWithOffset=function(){return(c._RotateWithOffset=c.asm.RotateWithOffset).apply(null,arguments)},c._Round=function(){return(c._Round=c.asm.Round).apply(null,arguments)},c._Rsqrt=function(){return(c._Rsqrt=c.asm.Rsqrt).apply(null,arguments)},c._ScatterNd=function(){return(c._ScatterNd=c.asm.ScatterNd).apply(null,arguments)},c._SearchSorted=function(){return(c._SearchSorted=c.asm.SearchSorted).apply(null,arguments)},c._SelectV2=function(){return(c._SelectV2=c.asm.SelectV2).apply(null,arguments)},c._Selu=function(){return(c._Selu=c.asm.Selu).apply(null,arguments)},c._Sigmoid=function(){return(c._Sigmoid=c.asm.Sigmoid).apply(null,arguments)},c._Sign=function(){return(c._Sign=c.asm.Sign).apply(null,arguments)},c._Sin=function(){return(c._Sin=c.asm.Sin).apply(null,arguments)},c._Sinh=function(){return(c._Sinh=c.asm.Sinh).apply(null,arguments)},c._Softmax=function(){return(c._Softmax=c.asm.Softmax).apply(null,arguments)},c._Softplus=function(){return(c._Softplus=c.asm.Softplus).apply(null,arguments)},c._SparseFillEmptyRows=function(){return(c._SparseFillEmptyRows=c.asm.SparseFillEmptyRows).apply(null,arguments)},c._SparseReshape=function(){return(c._SparseReshape=c.asm.SparseReshape).apply(null,arguments)},c._SparseSegmentReduction=function(){return(c._SparseSegmentReduction=c.asm.SparseSegmentReduction).apply(null,arguments)},c._SparseToDense=function(){return(c._SparseToDense=c.asm.SparseToDense).apply(null,arguments)},c._Sqrt=function(){return(c._Sqrt=c.asm.Sqrt).apply(null,arguments)},c._Square=function(){return(c._Square=c.asm.Square).apply(null,arguments)},c._SquaredDifference=function(){return(c._SquaredDifference=c.asm.SquaredDifference).apply(null,arguments)},c._Step=function(){return(c._Step=c.asm.Step).apply(null,arguments)},c._StridedSlice=function(){return(c._StridedSlice=c.asm.StridedSlice).apply(null,arguments)},c._Sub=function(){return(c._Sub=c.asm.Sub).apply(null,arguments)},c._Sum=function(){return(c._Sum=c.asm.Sum).apply(null,arguments)},c._Tan=function(){return(c._Tan=c.asm.Tan).apply(null,arguments)},c._Tanh=function(){return(c._Tanh=c.asm.Tanh).apply(null,arguments)},c._TensorScatterUpdate=function(){return(c._TensorScatterUpdate=c.asm.TensorScatterUpdate).apply(null,arguments)},c._Tile=function(){return(c._Tile=c.asm.Tile).apply(null,arguments)},c._TopK=function(){return(c._TopK=c.asm.TopK).apply(null,arguments)},c._Transform=function(){return(c._Transform=c.asm.Transform).apply(null,arguments)},c._Transpose=function(){return(c._Transpose=c.asm.Transpose).apply(null,arguments)},c.__FusedMatMul=function(){return(c.__FusedMatMul=c.asm._FusedMatMul).apply(null,arguments)},c._malloc=function(){return(c._malloc=c.asm.malloc).apply(null,arguments)},c._free=function(){return(c._free=c.asm.free).apply(null,arguments)},c.__emscripten_tls_init=function(){return(c.__emscripten_tls_init=c.asm._emscripten_tls_init).apply(null,arguments)};var Sw=c._pthread_self=function(){return(Sw=c._pthread_self=c.asm.pthread_self).apply(null,arguments)};c.___errno_location=function(){return(c.___errno_location=c.asm.__errno_location).apply(null,arguments)};var RO=c.__emscripten_thread_init=function(){return(RO=c.__emscripten_thread_init=c.asm._emscripten_thread_init).apply(null,arguments)};c.__emscripten_thread_crashed=function(){return(c.__emscripten_thread_crashed=c.asm._emscripten_thread_crashed).apply(null,arguments)},c._emscripten_main_thread_process_queued_calls=function(){return(c._emscripten_main_thread_process_queued_calls=c.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},c._emscripten_main_browser_thread_id=function(){return(c._emscripten_main_browser_thread_id=c.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var DO=c._emscripten_run_in_main_runtime_thread_js=function(){return(DO=c._emscripten_run_in_main_runtime_thread_js=c.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};c._emscripten_dispatch_to_thread_=function(){return(c._emscripten_dispatch_to_thread_=c.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var MO=c.__emscripten_proxy_execute_task_queue=function(){return(MO=c.__emscripten_proxy_execute_task_queue=c.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},PC=c.__emscripten_thread_free_data=function(){return(PC=c.__emscripten_thread_free_data=c.asm._emscripten_thread_free_data).apply(null,arguments)},FO=c.__emscripten_thread_exit=function(){return(FO=c.__emscripten_thread_exit=c.asm._emscripten_thread_exit).apply(null,arguments)},OO=c._emscripten_stack_set_limits=function(){return(OO=c._emscripten_stack_set_limits=c.asm.emscripten_stack_set_limits).apply(null,arguments)},LC=c.stackSave=function(){return(LC=c.stackSave=c.asm.stackSave).apply(null,arguments)},_w=c.stackRestore=function(){return(_w=c.stackRestore=c.asm.stackRestore).apply(null,arguments)},kw=c.stackAlloc=function(){return(kw=c.stackAlloc=c.asm.stackAlloc).apply(null,arguments)};c.dynCall_iijjiiii=function(){return(c.dynCall_iijjiiii=c.asm.dynCall_iijjiiii).apply(null,arguments)},c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.dynCall_jiji).apply(null,arguments)},c.keepRuntimeAlive=ft,c.wasmMemory=A,c.cwrap=ri,c.ExitStatus=Ie,c.PThread=ee;var Cw;st=function ne(){Cw||PO(),Cw||(st=ne)};function PO(ne){if(He>0)return;if(b){h(c),yt(),startWorker(c);return}if(Ot(),He>0)return;function ye(){Cw||(Cw=!0,c.calledRun=!0,!z&&(yt(),h(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),De()))}c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),ye()},1)):ye()}if(c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.pop()();PO();var Iw;f&&(Iw={uncaughtException:process.listeners("uncaughtException").filter(function(ne){return!f.uncaughtException.indexOf(ne)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(ne){return!f.unhandledRejection.indexOf(ne)>-1})});var Ew;if(typeof WasmBackendModule<"u")Ew=WasmBackendModule;else if(typeof a<"u")Ew=a;else throw new Error("Could not find wasm module in post.js");if(Iw){var mne=Ew._dispose;Ew._dispose=function(){mne(),Iw.uncaughtException.forEach(function(ne){process.removeListener("uncaughtException",ne)}),Iw.unhandledRejection.forEach(function(ne){process.removeListener("unhandledRejection",ne)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=r:typeof define=="function"&&define.amd?define([],function(){return r}):typeof e=="object"&&(e.WasmBackendModuleThreadedSimd=r)}),dke=Hn((e,t)=>{t.exports.wasmWorkerContents=`"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"
");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};`}),hke=Hn((e,t)=>{var r=(()=>{var n=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(n=n||__filename),function(a){a=a||{};var s=typeof a<"u"?a:{},i,o;s.ready=new Promise(function(me,Ce){i=me,o=Ce});var u;typeof process<"u"&&process.listeners&&(u={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var d=Object.assign({},s),c=typeof window=="object",h=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",f="";function g(me){return s.locateFile?s.locateFile(me,f):f+me}var m,x,y;if(p){var v=NR(),b=f7();h?f=b.dirname(f)+"/":f=__dirname+"/",m=(me,Ce)=>(me=ve(me)?new URL(me):b.normalize(me),v.readFileSync(me,Ce?void 0:"utf8")),y=me=>{var Ce=m(me,!0);return Ce.buffer||(Ce=new Uint8Array(Ce)),Ce},x=(me,Ce,rt)=>{me=ve(me)?new URL(me):b.normalize(me),v.readFile(me,function(ee,be){ee?rt(ee):Ce(be.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(me){if(!(me instanceof ft))throw me}),process.on("unhandledRejection",function(me){throw me}),s.inspect=function(){return"[Emscripten Module object]"}}else(c||h)&&(h?f=self.location.href:typeof document<"u"&&document.currentScript&&(f=document.currentScript.src),n&&(f=n),f.indexOf("blob:")!==0?f=f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):f="",m=me=>{var Ce=new XMLHttpRequest;return Ce.open("GET",me,!1),Ce.send(null),Ce.responseText},h&&(y=me=>{var Ce=new XMLHttpRequest;return Ce.open("GET",me,!1),Ce.responseType="arraybuffer",Ce.send(null),new Uint8Array(Ce.response)}),x=(me,Ce,rt)=>{var ee=new XMLHttpRequest;ee.open("GET",me,!0),ee.responseType="arraybuffer",ee.onload=()=>{if(ee.status==200||ee.status==0&&ee.response){Ce(ee.response);return}rt()},ee.onerror=rt,ee.send(null)});var N=s.print||console.log.bind(console),S=s.printErr||console.warn.bind(console);Object.assign(s,d),d=null,s.arguments&&s.arguments,s.thisProgram&&s.thisProgram,s.quit&&s.quit;var _;s.wasmBinary&&(_=s.wasmBinary),s.noExitRuntime,typeof WebAssembly!="object"&&F("no native wasm support detected");var C,k=!1,I=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function T(me,Ce,rt){Ce>>>=0;for(var ee=Ce+rt,be=Ce;me[be]&&!(be>=ee);)++be;if(be-Ce>16&&me.buffer&&I)return I.decode(me.subarray(Ce,be));for(var nt="";Ce<be;){var Te=me[Ce++];if(!(Te&128)){nt+=String.fromCharCode(Te);continue}var Ge=me[Ce++]&63;if((Te&224)==192){nt+=String.fromCharCode((Te&31)<<6|Ge);continue}var wt=me[Ce++]&63;if((Te&240)==224?Te=(Te&15)<<12|Ge<<6|wt:Te=(Te&7)<<18|Ge<<12|wt<<6|me[Ce++]&63,Te<65536)nt+=String.fromCharCode(Te);else{var Dt=Te-65536;nt+=String.fromCharCode(55296|Dt>>10,56320|Dt&1023)}}return nt}function j(me,Ce){return me>>>=0,me?T(q,me,Ce):""}function E(me,Ce,rt,ee){if(rt>>>=0,!(ee>0))return 0;for(var be=rt,nt=rt+ee-1,Te=0;Te<me.length;++Te){var Ge=me.charCodeAt(Te);if(Ge>=55296&&Ge<=57343){var wt=me.charCodeAt(++Te);Ge=65536+((Ge&1023)<<10)|wt&1023}if(Ge<=127){if(rt>=nt)break;Ce[rt++>>>0]=Ge}else if(Ge<=2047){if(rt+1>=nt)break;Ce[rt++>>>0]=192|Ge>>6,Ce[rt++>>>0]=128|Ge&63}else if(Ge<=65535){if(rt+2>=nt)break;Ce[rt++>>>0]=224|Ge>>12,Ce[rt++>>>0]=128|Ge>>6&63,Ce[rt++>>>0]=128|Ge&63}else{if(rt+3>=nt)break;Ce[rt++>>>0]=240|Ge>>18,Ce[rt++>>>0]=128|Ge>>12&63,Ce[rt++>>>0]=128|Ge>>6&63,Ce[rt++>>>0]=128|Ge&63}}return Ce[rt>>>0]=0,rt-be}function O(me,Ce,rt){return E(me,q,Ce,rt)}var M,W,q,P;function A(me){M=me,s.HEAP8=W=new Int8Array(me),s.HEAP16=new Int16Array(me),s.HEAP32=new Int32Array(me),s.HEAPU8=q=new Uint8Array(me),s.HEAPU16=new Uint16Array(me),s.HEAPU32=P=new Uint32Array(me),s.HEAPF32=new Float32Array(me),s.HEAPF64=new Float64Array(me)}s.INITIAL_MEMORY;var L=[],z=[],$=[];function V(){if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)re(s.preRun.shift());Ot(L)}function B(){Ot(z)}function Y(){if(s.postRun)for(typeof s.postRun=="function"&&(s.postRun=[s.postRun]);s.postRun.length;)K(s.postRun.shift());Ot($)}function re(me){L.unshift(me)}function ae(me){z.unshift(me)}function K(me){$.unshift(me)}var J=0,Z=null;function Q(me){J++,s.monitorRunDependencies&&s.monitorRunDependencies(J)}function U(me){if(J--,s.monitorRunDependencies&&s.monitorRunDependencies(J),J==0&&Z){var Ce=Z;Z=null,Ce()}}function F(me){s.onAbort&&s.onAbort(me),me="Aborted("+me+")",S(me),k=!0,me+=". Build with -sASSERTIONS for more info.";var Ce=new WebAssembly.RuntimeError(me);throw o(Ce),Ce}var te="data:application/octet-stream;base64,";function pe(me){return me.startsWith(te)}function ve(me){return me.startsWith("file://")}var fe;fe="tfjs-backend-wasm.wasm",pe(fe)||(fe=g(fe));function Me(me){try{if(me==fe&&_)return new Uint8Array(_);if(y)return y(me);throw"both async and sync fetching of the wasm failed"}catch(Ce){F(Ce)}}function je(){if(!_&&(c||h)){if(typeof fetch=="function"&&!ve(fe))return fetch(fe,{credentials:"same-origin"}).then(function(me){if(!me.ok)throw"failed to load wasm binary file at '"+fe+"'";return me.arrayBuffer()}).catch(function(){return Me(fe)});if(x)return new Promise(function(me,Ce){x(fe,function(rt){me(new Uint8Array(rt))},Ce)})}return Promise.resolve().then(function(){return Me(fe)})}function Qe(){var me={env:Cs,wasi_snapshot_preview1:Cs};function Ce(Te,Ge){var wt=Te.exports;s.asm=wt,C=s.asm.memory,A(C.buffer),s.asm.__indirect_function_table,ae(s.asm.__wasm_call_ctors),U()}Q();function rt(Te){Ce(Te.instance)}function ee(Te){return je().then(function(Ge){return WebAssembly.instantiate(Ge,me)}).then(function(Ge){return Ge}).then(Te,function(Ge){S("failed to asynchronously prepare wasm: "+Ge),F(Ge)})}function be(){return!_&&typeof WebAssembly.instantiateStreaming=="function"&&!pe(fe)&&!ve(fe)&&!p&&typeof fetch=="function"?fetch(fe,{credentials:"same-origin"}).then(function(Te){var Ge=WebAssembly.instantiateStreaming(Te,me);return Ge.then(rt,function(wt){return S("wasm streaming compile failed: "+wt),S("falling back to ArrayBuffer instantiation"),ee(rt)})}):ee(rt)}if(s.instantiateWasm)try{var nt=s.instantiateWasm(me,Ce);return nt}catch(Te){S("Module.instantiateWasm callback failed with error: "+Te),o(Te)}return be().catch(o),{}}function ft(me){this.name="ExitStatus",this.message="Program terminated with exit("+me+")",this.status=me}function Ot(me){for(;me.length>0;)me.shift()(s)}function yt(){F("")}function De(){return 4294901760}function Fe(){return De()}function et(me,Ce,rt){q.copyWithin(me>>>0,Ce>>>0,Ce+rt>>>0)}function Ae(me){try{return C.grow(me-M.byteLength+65535>>>16),A(C.buffer),1}catch{}}function He(me){var Ce=q.length;me=me>>>0;var rt=De();if(me>rt)return!1;let ee=(wt,Dt)=>wt+(Dt-wt%Dt)%Dt;for(var be=1;be<=4;be*=2){var nt=Ce*(1+.2/be);nt=Math.min(nt,me+100663296);var Te=Math.min(rt,ee(Math.max(me,nt),65536)),Ge=Ae(Te);if(Ge)return!0}return!1}function st(me){return 52}function kt(me,Ce,rt,ee,be){return 70}var Vt=[null,[],[]];function ur(me,Ce){var rt=Vt[me];Ce===0||Ce===10?((me===1?N:S)(T(rt,0)),rt.length=0):rt.push(Ce)}function we(me,Ce,rt,ee){for(var be=0,nt=0;nt<rt;nt++){var Te=P[Ce>>>2],Ge=P[Ce+4>>>2];Ce+=8;for(var wt=0;wt<Ge;wt++)ur(me,q[Te+wt>>>0]);be+=Ge}return P[ee>>>2]=be,0}function wr(me){var Ce=s["_"+me];return Ce}function nr(me,Ce){W.set(me,Ce>>>0)}function Zt(me,Ce,rt,ee,be){var nt={string:xr=>{var bn=0;if(xr!=null&&xr!==0){var yr=(xr.length<<2)+1;bn=Ie(yr),O(xr,bn,yr)}return bn},array:xr=>{var bn=Ie(xr.length);return nr(xr,bn),bn}};function Te(xr){return Ce==="string"?j(xr):Ce==="boolean"?!!xr:xr}var Ge=wr(me),wt=[],Dt=0;if(ee)for(var Xr=0;Xr<ee.length;Xr++){var In=nt[rt[Xr]];In?(Dt===0&&(Dt=vn()),wt[Xr]=In(ee[Xr])):wt[Xr]=ee[Xr]}var Rr=Ge.apply(null,wt);function an(xr){return Dt!==0&&xe(Dt),Te(xr)}return Rr=an(Rr),Rr}function _r(me,Ce,rt,ee){rt=rt||[];var be=rt.every(Te=>Te==="number"||Te==="boolean"),nt=Ce!=="string";return nt&&be&&!ee?wr(me):function(){return Zt(me,Ce,rt,arguments)}}var Cs={abort:yt,emscripten_get_heap_max:Fe,emscripten_memcpy_big:et,emscripten_resize_heap:He,fd_close:st,fd_seek:kt,fd_write:we};Qe(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},s._init=function(){return(s._init=s.asm.init).apply(null,arguments)},s._init_with_threads_count=function(){return(s._init_with_threads_count=s.asm.init_with_threads_count).apply(null,arguments)},s._get_threads_count=function(){return(s._get_threads_count=s.asm.get_threads_count).apply(null,arguments)},s._register_tensor=function(){return(s._register_tensor=s.asm.register_tensor).apply(null,arguments)},s._dispose_data=function(){return(s._dispose_data=s.asm.dispose_data).apply(null,arguments)},s._dispose=function(){return(s._dispose=s.asm.dispose).apply(null,arguments)},s._Abs=function(){return(s._Abs=s.asm.Abs).apply(null,arguments)},s._Acos=function(){return(s._Acos=s.asm.Acos).apply(null,arguments)},s._Acosh=function(){return(s._Acosh=s.asm.Acosh).apply(null,arguments)},s._Add=function(){return(s._Add=s.asm.Add).apply(null,arguments)},s._AddN=function(){return(s._AddN=s.asm.AddN).apply(null,arguments)},s._All=function(){return(s._All=s.asm.All).apply(null,arguments)},s._Any=function(){return(s._Any=s.asm.Any).apply(null,arguments)},s._ArgMax=function(){return(s._ArgMax=s.asm.ArgMax).apply(null,arguments)},s._ArgMin=function(){return(s._ArgMin=s.asm.ArgMin).apply(null,arguments)},s._Asin=function(){return(s._Asin=s.asm.Asin).apply(null,arguments)},s._Asinh=function(){return(s._Asinh=s.asm.Asinh).apply(null,arguments)},s._Atan=function(){return(s._Atan=s.asm.Atan).apply(null,arguments)},s._Atan2=function(){return(s._Atan2=s.asm.Atan2).apply(null,arguments)},s._Atanh=function(){return(s._Atanh=s.asm.Atanh).apply(null,arguments)},s._AvgPool=function(){return(s._AvgPool=s.asm.AvgPool).apply(null,arguments)},s._AvgPool3D=function(){return(s._AvgPool3D=s.asm.AvgPool3D).apply(null,arguments)},s._AvgPool3DGrad=function(){return(s._AvgPool3DGrad=s.asm.AvgPool3DGrad).apply(null,arguments)},s._AvgPoolGrad=function(){return(s._AvgPoolGrad=s.asm.AvgPoolGrad).apply(null,arguments)},s._BatchMatMul=function(){return(s._BatchMatMul=s.asm.BatchMatMul).apply(null,arguments)},s._Bincount=function(){return(s._Bincount=s.asm.Bincount).apply(null,arguments)},s._BitwiseAnd=function(){return(s._BitwiseAnd=s.asm.BitwiseAnd).apply(null,arguments)},s._Ceil=function(){return(s._Ceil=s.asm.Ceil).apply(null,arguments)},s._ClipByValue=function(){return(s._ClipByValue=s.asm.ClipByValue).apply(null,arguments)},s._Conv2D=function(){return(s._Conv2D=s.asm.Conv2D).apply(null,arguments)},s._Conv2DBackpropInput=function(){return(s._Conv2DBackpropInput=s.asm.Conv2DBackpropInput).apply(null,arguments)},s._Conv3D=function(){return(s._Conv3D=s.asm.Conv3D).apply(null,arguments)},s._Conv3DBackpropFilterV2=function(){return(s._Conv3DBackpropFilterV2=s.asm.Conv3DBackpropFilterV2).apply(null,arguments)},s._Conv3DBackpropInputV2=function(){return(s._Conv3DBackpropInputV2=s.asm.Conv3DBackpropInputV2).apply(null,arguments)},s._Cos=function(){return(s._Cos=s.asm.Cos).apply(null,arguments)},s._Cosh=function(){return(s._Cosh=s.asm.Cosh).apply(null,arguments)},s._CropAndResize=function(){return(s._CropAndResize=s.asm.CropAndResize).apply(null,arguments)},s._Cumprod=function(){return(s._Cumprod=s.asm.Cumprod).apply(null,arguments)},s._Cumsum=function(){return(s._Cumsum=s.asm.Cumsum).apply(null,arguments)},s._DenseBincount=function(){return(s._DenseBincount=s.asm.DenseBincount).apply(null,arguments)},s._DepthToSpace=function(){return(s._DepthToSpace=s.asm.DepthToSpace).apply(null,arguments)},s._DepthwiseConv2dNative=function(){return(s._DepthwiseConv2dNative=s.asm.DepthwiseConv2dNative).apply(null,arguments)},s._Diag=function(){return(s._Diag=s.asm.Diag).apply(null,arguments)},s._Dilation2D=function(){return(s._Dilation2D=s.asm.Dilation2D).apply(null,arguments)},s._Dilation2DBackpropFilter=function(){return(s._Dilation2DBackpropFilter=s.asm.Dilation2DBackpropFilter).apply(null,arguments)},s._Dilation2DBackpropInput=function(){return(s._Dilation2DBackpropInput=s.asm.Dilation2DBackpropInput).apply(null,arguments)},s._Elu=function(){return(s._Elu=s.asm.Elu).apply(null,arguments)},s._EluGrad=function(){return(s._EluGrad=s.asm.EluGrad).apply(null,arguments)},s._Equal=function(){return(s._Equal=s.asm.Equal).apply(null,arguments)},s._Erf=function(){return(s._Erf=s.asm.Erf).apply(null,arguments)},s._Exp=function(){return(s._Exp=s.asm.Exp).apply(null,arguments)},s._Expm1=function(){return(s._Expm1=s.asm.Expm1).apply(null,arguments)},s._FlipLeftRight=function(){return(s._FlipLeftRight=s.asm.FlipLeftRight).apply(null,arguments)},s._Floor=function(){return(s._Floor=s.asm.Floor).apply(null,arguments)},s._FloorDiv=function(){return(s._FloorDiv=s.asm.FloorDiv).apply(null,arguments)},s._FusedBatchNorm=function(){return(s._FusedBatchNorm=s.asm.FusedBatchNorm).apply(null,arguments)},s._FusedConv2D=function(){return(s._FusedConv2D=s.asm.FusedConv2D).apply(null,arguments)},s._FusedDepthwiseConv2D=function(){return(s._FusedDepthwiseConv2D=s.asm.FusedDepthwiseConv2D).apply(null,arguments)},s._Gather=function(){return(s._Gather=s.asm.Gather).apply(null,arguments)},s._GatherNd=function(){return(s._GatherNd=s.asm.GatherNd).apply(null,arguments)},s._Greater=function(){return(s._Greater=s.asm.Greater).apply(null,arguments)},s._GreaterEqual=function(){return(s._GreaterEqual=s.asm.GreaterEqual).apply(null,arguments)},s._IsFinite=function(){return(s._IsFinite=s.asm.IsFinite).apply(null,arguments)},s._IsInf=function(){return(s._IsInf=s.asm.IsInf).apply(null,arguments)},s._IsNan=function(){return(s._IsNan=s.asm.IsNan).apply(null,arguments)},s._LRN=function(){return(s._LRN=s.asm.LRN).apply(null,arguments)},s._LRNGrad=function(){return(s._LRNGrad=s.asm.LRNGrad).apply(null,arguments)},s._LeakyRelu=function(){return(s._LeakyRelu=s.asm.LeakyRelu).apply(null,arguments)},s._Less=function(){return(s._Less=s.asm.Less).apply(null,arguments)},s._LessEqual=function(){return(s._LessEqual=s.asm.LessEqual).apply(null,arguments)},s._LinSpace=function(){return(s._LinSpace=s.asm.LinSpace).apply(null,arguments)},s._Log=function(){return(s._Log=s.asm.Log).apply(null,arguments)},s._Log1p=function(){return(s._Log1p=s.asm.Log1p).apply(null,arguments)},s._LogicalAnd=function(){return(s._LogicalAnd=s.asm.LogicalAnd).apply(null,arguments)},s._LogicalNot=function(){return(s._LogicalNot=s.asm.LogicalNot).apply(null,arguments)},s._LogicalOr=function(){return(s._LogicalOr=s.asm.LogicalOr).apply(null,arguments)},s._LogicalXor=function(){return(s._LogicalXor=s.asm.LogicalXor).apply(null,arguments)},s._Max=function(){return(s._Max=s.asm.Max).apply(null,arguments)},s._MaxPool=function(){return(s._MaxPool=s.asm.MaxPool).apply(null,arguments)},s._MaxPool3D=function(){return(s._MaxPool3D=s.asm.MaxPool3D).apply(null,arguments)},s._MaxPool3DGrad=function(){return(s._MaxPool3DGrad=s.asm.MaxPool3DGrad).apply(null,arguments)},s._MaxPoolGrad=function(){return(s._MaxPoolGrad=s.asm.MaxPoolGrad).apply(null,arguments)},s._MaxPoolWithArgmax=function(){return(s._MaxPoolWithArgmax=s.asm.MaxPoolWithArgmax).apply(null,arguments)},s._Maximum=function(){return(s._Maximum=s.asm.Maximum).apply(null,arguments)},s._Mean=function(){return(s._Mean=s.asm.Mean).apply(null,arguments)},s._Min=function(){return(s._Min=s.asm.Min).apply(null,arguments)},s._Minimum=function(){return(s._Minimum=s.asm.Minimum).apply(null,arguments)},s._MirrorPad=function(){return(s._MirrorPad=s.asm.MirrorPad).apply(null,arguments)},s._Mod=function(){return(s._Mod=s.asm.Mod).apply(null,arguments)},s._Multinomial=function(){return(s._Multinomial=s.asm.Multinomial).apply(null,arguments)},s._Multiply=function(){return(s._Multiply=s.asm.Multiply).apply(null,arguments)},s._Neg=function(){return(s._Neg=s.asm.Neg).apply(null,arguments)},s._NonMaxSuppressionV3=function(){return(s._NonMaxSuppressionV3=s.asm.NonMaxSuppressionV3).apply(null,arguments)},s._NonMaxSuppressionV4=function(){return(s._NonMaxSuppressionV4=s.asm.NonMaxSuppressionV4).apply(null,arguments)},s._NonMaxSuppressionV5=function(){return(s._NonMaxSuppressionV5=s.asm.NonMaxSuppressionV5).apply(null,arguments)},s._NotEqual=function(){return(s._NotEqual=s.asm.NotEqual).apply(null,arguments)},s._OneHot=function(){return(s._OneHot=s.asm.OneHot).apply(null,arguments)},s._PadV2=function(){return(s._PadV2=s.asm.PadV2).apply(null,arguments)},s._Pow=function(){return(s._Pow=s.asm.Pow).apply(null,arguments)},s._Prelu=function(){return(s._Prelu=s.asm.Prelu).apply(null,arguments)},s._Prod=function(){return(s._Prod=s.asm.Prod).apply(null,arguments)},s._RealDiv=function(){return(s._RealDiv=s.asm.RealDiv).apply(null,arguments)},s._Reciprocal=function(){return(s._Reciprocal=s.asm.Reciprocal).apply(null,arguments)},s._Relu=function(){return(s._Relu=s.asm.Relu).apply(null,arguments)},s._Relu6=function(){return(s._Relu6=s.asm.Relu6).apply(null,arguments)},s._ResizeBilinear=function(){return(s._ResizeBilinear=s.asm.ResizeBilinear).apply(null,arguments)},s._ResizeBilinearGrad=function(){return(s._ResizeBilinearGrad=s.asm.ResizeBilinearGrad).apply(null,arguments)},s._ResizeNearestNeighbor=function(){return(s._ResizeNearestNeighbor=s.asm.ResizeNearestNeighbor).apply(null,arguments)},s._ResizeNearestNeighborGrad=function(){return(s._ResizeNearestNeighborGrad=s.asm.ResizeNearestNeighborGrad).apply(null,arguments)},s._Reverse=function(){return(s._Reverse=s.asm.Reverse).apply(null,arguments)},s._RotateWithOffset=function(){return(s._RotateWithOffset=s.asm.RotateWithOffset).apply(null,arguments)},s._Round=function(){return(s._Round=s.asm.Round).apply(null,arguments)},s._Rsqrt=function(){return(s._Rsqrt=s.asm.Rsqrt).apply(null,arguments)},s._ScatterNd=function(){return(s._ScatterNd=s.asm.ScatterNd).apply(null,arguments)},s._SearchSorted=function(){return(s._SearchSorted=s.asm.SearchSorted).apply(null,arguments)},s._SelectV2=function(){return(s._SelectV2=s.asm.SelectV2).apply(null,arguments)},s._Selu=function(){return(s._Selu=s.asm.Selu).apply(null,arguments)},s._Sigmoid=function(){return(s._Sigmoid=s.asm.Sigmoid).apply(null,arguments)},s._Sign=function(){return(s._Sign=s.asm.Sign).apply(null,arguments)},s._Sin=function(){return(s._Sin=s.asm.Sin).apply(null,arguments)},s._Sinh=function(){return(s._Sinh=s.asm.Sinh).apply(null,arguments)},s._Softmax=function(){return(s._Softmax=s.asm.Softmax).apply(null,arguments)},s._Softplus=function(){return(s._Softplus=s.asm.Softplus).apply(null,arguments)},s._SparseFillEmptyRows=function(){return(s._SparseFillEmptyRows=s.asm.SparseFillEmptyRows).apply(null,arguments)},s._SparseReshape=function(){return(s._SparseReshape=s.asm.SparseReshape).apply(null,arguments)},s._SparseSegmentReduction=function(){return(s._SparseSegmentReduction=s.asm.SparseSegmentReduction).apply(null,arguments)},s._SparseToDense=function(){return(s._SparseToDense=s.asm.SparseToDense).apply(null,arguments)},s._Sqrt=function(){return(s._Sqrt=s.asm.Sqrt).apply(null,arguments)},s._Square=function(){return(s._Square=s.asm.Square).apply(null,arguments)},s._SquaredDifference=function(){return(s._SquaredDifference=s.asm.SquaredDifference).apply(null,arguments)},s._Step=function(){return(s._Step=s.asm.Step).apply(null,arguments)},s._StridedSlice=function(){return(s._StridedSlice=s.asm.StridedSlice).apply(null,arguments)},s._Sub=function(){return(s._Sub=s.asm.Sub).apply(null,arguments)},s._Sum=function(){return(s._Sum=s.asm.Sum).apply(null,arguments)},s._Tan=function(){return(s._Tan=s.asm.Tan).apply(null,arguments)},s._Tanh=function(){return(s._Tanh=s.asm.Tanh).apply(null,arguments)},s._TensorScatterUpdate=function(){return(s._TensorScatterUpdate=s.asm.TensorScatterUpdate).apply(null,arguments)},s._Tile=function(){return(s._Tile=s.asm.Tile).apply(null,arguments)},s._TopK=function(){return(s._TopK=s.asm.TopK).apply(null,arguments)},s._Transform=function(){return(s._Transform=s.asm.Transform).apply(null,arguments)},s._Transpose=function(){return(s._Transpose=s.asm.Transpose).apply(null,arguments)},s.__FusedMatMul=function(){return(s.__FusedMatMul=s.asm._FusedMatMul).apply(null,arguments)},s._malloc=function(){return(s._malloc=s.asm.malloc).apply(null,arguments)},s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)};var vn=s.stackSave=function(){return(vn=s.stackSave=s.asm.stackSave).apply(null,arguments)},xe=s.stackRestore=function(){return(xe=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},Ie=s.stackAlloc=function(){return(Ie=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)};s.dynCall_iijjiiii=function(){return(s.dynCall_iijjiiii=s.asm.dynCall_iijjiiii).apply(null,arguments)},s.dynCall_jiji=function(){return(s.dynCall_jiji=s.asm.dynCall_jiji).apply(null,arguments)},s.cwrap=_r;var Oe;Z=function me(){Oe||vt(),Oe||(Z=me)};function vt(me){if(J>0||(V(),J>0))return;function Ce(){Oe||(Oe=!0,s.calledRun=!0,!k&&(B(),i(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),Y()))}s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),Ce()},1)):Ce()}if(s.preInit)for(typeof s.preInit=="function"&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();vt();var $t;u&&($t={uncaughtException:process.listeners("uncaughtException").filter(function(me){return!u.uncaughtException.indexOf(me)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(me){return!u.unhandledRejection.indexOf(me)>-1})});var cr;if(typeof a<"u")cr=a;else if(typeof WasmBackendModuleThreadedSimd<"u")cr=WasmBackendModuleThreadedSimd;else throw new Error("Could not find wasm module in post.js");if($t){var tt=cr._dispose;cr._dispose=function(){tt(),$t.uncaughtException.forEach(function(me){process.removeListener("uncaughtException",me)}),$t.unhandledRejection.forEach(function(me){process.removeListener("unhandledRejection",me)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=r:typeof define=="function"&&define.amd?define([],function(){return r}):typeof e=="object"&&(e.WasmBackendModule=r)}),uk=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},u0=class{refCount(e){return js("refCount")}incRef(e){return js("incRef")}timerAvailable(){return!0}time(e){return js("time")}read(e){return js("read")}readSync(e){return js("readSync")}readToGPU(e,t){return js("readToGPU")}numDataIds(){return js("numDataIds")}disposeData(e,t){return js("disposeData")}write(e,t,r){return js("write")}move(e,t,r,n,a){return js("move")}createTensorFromGPUData(e,t,r){return js("createTensorFromGPUData")}memory(){return js("memory")}floatPrecision(){return js("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return js("dispose")}};function js(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function m7(e){let t=e.length,r=0;for(;t>0;)r=Math.random()*t|0,t--,nS(e,t,r)}function pke(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let r=e.length,n=0;for(;r>0;)n=Math.random()*r|0,r--,nS(e,r,n),nS(t,r,n)}function ib(e,t,r){return Math.max(e,Math.min(t,r))}function fke(e){return e%2===0?e:e+1}function nS(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function mke(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function gke(e,t){let r=Math.random();return t*r+(1-r)*e}function xke(e,t){let r=0;for(let n=0;n<e.length;n++){let a=Number(e[n])-Number(t[n]);r+=a*a}return r}function X(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function rs(e,t,r=""){X(cu(e,t),()=>r+` Shapes ${e} and ${t} must match`)}function Qh(e){X(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ar(e){if(e.length===0)return 1;let t=e[0];for(let r=1;r<e.length;r++)t*=e[r];return t}function yke(e){return e.length===0}function g7(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==null&&t[r]!==null&&e[r]!==t[r])return!1;return!0}function cu(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function ig(e){return e%1===0}function vke(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function bke(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function wke(e){let t=new Uint32Array(e);for(let r=0;r<e;++r)t[r]=r;return m7(t),t}function Nv(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Nke(e,t=a=>0,r,n){return new Promise((a,s)=>{let i=0,o=()=>{if(e()){a();return}i++;let u=t(i);if(r!=null&&i>=r){s();return}n!=null?n(o,u):setTimeout(o,u)};o()})}function Ske(e,t){let r=1,n=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)r*=e[s];else if(e[s]===-1){if(n!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${n} and dim ${s}`);n=s}else if(e[s]<0)throw Error(`Shapes can not be < 0. Found ${e[s]} at dim ${s}`);if(n===-1){if(t>0&&t!==r)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(r===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%r!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${r}`);let a=e.slice();return a[n]=t/r,a}function Ki(e,t){let r=t.length;return e=e==null?t.map((n,a)=>a):[].concat(e),X(e.every(n=>n>=-r&&n<r),()=>`All values in axis param must be in range [-${r}, ${r}) but got axis ${e}`),X(e.every(n=>ig(n)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(n=>n<0?r+n:n)}function x7(e,t){let r=[],n=[],a=t!=null&&Array.isArray(t)&&t.length===0,s=t==null||a?null:Ki(t,e).sort(),i=0;for(let o=0;o<e.length;++o){if(s!=null){if(s[i]===o&&e[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(s[i]==null||s[i]>o)&&e[o]===1&&(r.push(e[o]),n.push(o)),s[i]<=o&&i++}e[o]!==1&&(r.push(e[o]),n.push(o))}return{newShape:r,keptDims:n}}function y7(e,t){return SR(e,t)}function SR(e,t){let r=null;if(e==null||e==="float32")r=new Float32Array(t);else if(e==="int32")r=new Int32Array(t);else if(e==="bool")r=new Uint8Array(t);else if(e==="string")r=new Array(t);else throw new Error(`Unknown data type ${e}`);return r}function v7(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(isNaN(n)||!isFinite(n))throw Error(`A tensor of type ${t} being uploaded contains ${n}.`)}}function b7(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function _ke(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function aS(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function w7(e){if(e==null)return 0;let t=0;return e.forEach(r=>t+=r.length),t}function rc(e){return typeof e=="string"||e instanceof String}function N7(e){return typeof e=="boolean"}function S7(e){return typeof e=="number"}function c0(e){return Array.isArray(e)?c0(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":S7(e)?"float32":rc(e)?"string":N7(e)?"bool":"float32"}function Cc(e){return!!(e&&e.constructor&&e.call&&e.apply)}function sS(e,t){for(let r=t;r<e;++r)if(e%r===0)return r;return e}function Qg(e){let t=e.length;if(t<2)return[];let r=new Array(t-1);r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}function _7(e,t,r,n=!1){let a=new Array;if(t.length===1){let s=t[0]*(n?2:1);for(let i=0;i<s;i++)a[i]=r[e+i]}else{let s=t[0],i=t.slice(1),o=i.reduce((u,d)=>u*d)*(n?2:1);for(let u=0;u<s;u++)a[u]=_7(e+u*o,i,r,n)}return a}function Im(e,t,r=!1){if(e.length===0)return t[0];let n=e.reduce((a,s)=>a*s)*(r?2:1);if(n===0)return[];if(n!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${r?" for a complex tensor":""}.`);return _7(0,e,t,r)}function kke(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function _R(e,t){let r=ck(e,t);for(let n=0;n<r.length;n++)r[n]=1;return r}function ck(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function Cke(e,t){let r=e.reduce((n,a)=>n*a,1);if(t==null||t==="float32")return Im(e,new Float32Array(r));if(t==="int32")return Im(e,new Int32Array(r));if(t==="bool")return Im(e,new Uint8Array(r));throw new Error(`Unknown data type ${t}`)}function ti(e){e.forEach(t=>{X(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function Ike(e,t,r){if(t===0)return 0;if(t===1)return e[0];let n=e[e.length-1];for(let a=0;a<e.length-1;++a)n+=r[a]*e[a];return n}function Eke(e,t,r){if(t===0)return[];if(t===1)return[e];let n=new Array(t);for(let a=0;a<n.length-1;++a)n[a]=Math.floor(e/r[a]),e-=n[a]*r[a];return n[n.length-1]=e,n}function dk(e){return e&&e.then&&typeof e.then=="function"}var J3="tfjsflags",k7=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Tke,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(ge().getBool("IS_TEST")||ge().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){let n=this.urlFlags[e];ge().getBool("IS_TEST")||ge().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${n}.`),this.set(e,n)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(dk(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let e=this.getQueryParams(this.global.location.search);J3 in e&&e[J3].split(",").forEach(t=>{let[r,n]=t.split(":");this.urlFlags[r]=Ake(r,n)})}};function Tke(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(r,...n)=>(jke(t,n[0],n[1]),n.join("="))),t}function jke(e,t,r){e[decodeURIComponent(t)]=decodeURIComponent(r||"")}function Ake(e,t){let r=t.toLowerCase();return r==="true"||r==="false"?r==="true":`${+r}`===r?+r:t}function ge(){return kR}var kR=null;function $ke(e){kR=e}var J2;function C7(){if(J2==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");J2=e}return J2}function Rke(){let e=C7();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function CR(e,t){let r=Rke();if(r.has(e))return r.get(e);{let n=t();return r.set(e,n),r.get(e)}}var Xg="Abs",Xh="Acos",Yh="Acosh",Yc="Add",Jh="AddN",Yg="All",Jg="Any",Zg="ArgMax",ex="ArgMin",Zh="Asin",ep="Asinh",tp="Atan",rp="Atanh",np="Atan2",ap="AvgPool",d0="AvgPoolGrad",tx="AvgPool3D",h0="AvgPool3DGrad",sp="BatchMatMul",rx="BatchToSpaceND",nx="Bincount",ax="BitwiseAnd",I7="BroadcastTo",p0="BroadcastArgs",ip="Cast",op="Ceil",Jc="ClipByValue",hk="Complex",f0="ComplexAbs",sx="Concat",lp="Conv2D",pk="Conv2DBackpropFilter",up="Conv2DBackpropInput",cp="Conv3D",ix="Conv3DBackpropFilterV2",ox="Conv3DBackpropInputV2",dp="Cos",hp="Cosh",lx="Cumprod",pp="Cumsum",ux="CropAndResize",m0="DenseBincount",cx="DepthToSpace",fp="DepthwiseConv2dNative",fk="DepthwiseConv2dNativeBackpropFilter",mk="DepthwiseConv2dNativeBackpropInput",g0="Diag",mp="Dilation2D",og="Dilation2DBackpropInput",lg="Dilation2DBackpropFilter",gk="Draw",gp="RealDiv",xk="Einsum",xp="Elu",dx="EluGrad",yp="Erf",hx="Equal",vp="Exp",px="ExpandDims",bp="Expm1",yk="FFT",x0="Fill",fx="FlipLeftRight",wp="Floor",Np="FloorDiv",Sp="FusedBatchNorm",mx="GatherV2",gx="GatherNd",xx="Greater",_p="GreaterEqual",kp="Identity",vk="IFFT",bk="Imag",Cp="IsFinite",Ip="IsInf",Ep="IsNan",Tp="LeakyRelu",yx="Less",vx="LessEqual",bx="LinSpace",jp="Log",Ap="Log1p",wx="LogicalAnd",Nx="LogicalNot",Sx="LogicalOr",E7="LogicalXor",T7="LogSoftmax",Dke="LowerBound",$p="LRN",_x="LRNGrad",Mke="MatrixBandPart",Rp="Max",Dp="Maximum",Mp="MaxPool",y0="MaxPoolGrad",kx="MaxPool3D",v0="MaxPool3DGrad",b0="MaxPoolWithArgmax",Fp="Mean",Op="Min",Pp="Minimum",Lp="MirrorPad",zp="Mod",Cx="Multinomial",Bp="Multiply",Ix="Neg",Ex="NotEqual",Tx="NonMaxSuppressionV3",jx="NonMaxSuppressionV4",Ax="NonMaxSuppressionV5",$x="OnesLike",Up="OneHot",Rx="Pack",Wp="PadV2",Fke="Pool",Vp="Pow",Hp="Prelu",qp="Prod",wk="RaggedGather",Nk="RaggedRange",Sk="RaggedTensorToTensor",w0="Range",_k="Real",Gp="Reciprocal",Kp="Relu",Dx="Reshape",Qp="ResizeNearestNeighbor",Mx="ResizeNearestNeighborGrad",Xp="ResizeBilinear",Fx="ResizeBilinearGrad",Yp="Relu6",Jp="Reverse",Zp="Round",ef="Rsqrt",Ox="ScatterNd",Px="TensorScatterUpdate",Lx="SearchSorted",zx="Select",tf="Selu",Bx="Slice",rf="Sin",nf="Sinh",af="Sign",sf="Sigmoid",of="Softplus",lf="Sqrt",uf="Sum",Ux="SpaceToBatchND",Wx="SplitV",cf="Softmax",N0="SparseFillEmptyRows",Vx="SparseReshape",S0="SparseSegmentMean",_0="SparseSegmentSum",Hx="SparseToDense",df="SquaredDifference",k0="Square",C0="StaticRegexReplace",qx="StridedSlice",I0="StringNGrams",E0="StringSplit",T0="StringToHashBucketFast",hf="Sub",pf="Tan",ff="Tanh",Zc="Tile",Gx="TopK",Kx="Transform",Gl="Transpose",j0="Unique",Qx="Unpack",A0="UnsortedSegmentSum",Oke="UpperBound",Xx="ZerosLike",ed="Step",iS="FromPixels",Yx="RotateWithOffset",wh="_FusedMatMul",Nh="FusedConv2D",Sh="FusedDepthwiseConv2D";function Uu(...e){ge().getBool("IS_TEST")||ge().getBool("PROD")||console.warn(...e)}function Pke(...e){ge().getBool("IS_TEST")||ge().getBool("PROD")||console.log(...e)}var ug=CR("kernelRegistry",()=>new Map),ob=CR("gradRegistry",()=>new Map);function lb(e,t){let r=IR(e,t);return ug.get(r)}function vT(e){return ob.get(e)}function oS(e){let t=ug.entries(),r=[];for(;;){let{done:n,value:a}=t.next();if(n)break;let[s,i]=a,[o]=s.split("_");o===e&&r.push(i)}return r}function $0(e){let{kernelName:t,backendName:r}=e,n=IR(t,r);ug.has(n)&&Uu(`The kernel '${t}' for backend '${r}' is already registered`),ug.set(n,e)}function j7(e){let{kernelName:t}=e;ob.has(t)&&ge().getBool("DEBUG")&&Uu(`Overriding the gradient for '${t}'`),ob.set(t,e)}function Lke(e,t){let r=IR(e,t);if(!ug.has(r))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);ug.delete(r)}function zke(e){if(!ob.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);ob.delete(e)}function Bke(e,t){oS(e).forEach(r=>{let n=Object.assign({},r,{backendName:t});$0(n)})}function IR(e,t){return`${t}_${e}`}var R={};Ut(R,{arraysEqual:()=>cu,arraysEqualWithNull:()=>g7,assert:()=>X,assertNonNegativeIntegerDimensions:()=>ti,assertNonNull:()=>Qh,assertShapesMatch:()=>rs,bytesFromStringArray:()=>w7,bytesPerElement:()=>aS,checkConversionForErrors:()=>v7,clamp:()=>ib,computeStrides:()=>Qg,convertBackendValuesAndArrayBuffer:()=>kke,createScalarValue:()=>Gke,createShuffledIndices:()=>wke,decodeString:()=>lS,distSquared:()=>xke,encodeString:()=>D0,fetch:()=>Qke,fingerPrint64:()=>qke,flatten:()=>Ic,getArrayFromDType:()=>SR,getTypedArrayFromDType:()=>y7,hasEncodingLoss:()=>_ke,hexToLong:()=>R0,indexToLoc:()=>Eke,inferDtype:()=>c0,inferFromImplicitShape:()=>Ske,isBoolean:()=>N7,isFunction:()=>Cc,isInt:()=>ig,isNumber:()=>S7,isPromise:()=>dk,isScalarShape:()=>yke,isString:()=>rc,isTypedArray:()=>oa,isValidDtype:()=>b7,locToIndex:()=>Ike,makeOnesTypedArray:()=>_R,makeZerosNestedTypedArray:()=>Cke,makeZerosTypedArray:()=>ck,nearestDivisor:()=>sS,nearestLargerEven:()=>fke,now:()=>ub,parseAxisParam:()=>Ki,randUniform:()=>gke,repeatedTry:()=>Nke,rightPad:()=>Nv,shuffle:()=>m7,shuffleCombo:()=>pke,sizeFromShape:()=>Ar,sizeToSquarishShape:()=>bke,squeezeShape:()=>x7,sum:()=>mke,swap:()=>nS,tanh:()=>vke,toNestedArray:()=>Im,toTypedArray:()=>kk});function A7(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var Z3=Xc(X_e()),Id=Z3.default||Z3;function R0(e){return Id.fromString(e,!0,16)}var $7=R0("c3a5c85c97cb3127"),Sd=R0("b492b66fbe98f273"),Ha=R0("9ae16a3b2f90404f");function bT(e){return e.xor(e.shru(47))}function R7(e,t,r){let n=e.slice(t,t+r);return Id.fromBytes(Array.from(n),!0,!0)}function Yr(e,t){return R7(e,t,8)}function e4(e,t){return R7(e,t,4)}function ia(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function xc(e,t,r=R0("9ddfea08eb382d69")){let n=e.xor(t).mul(r);n=n.xor(n.shru(47));let a=t.xor(n).mul(r);return a=a.xor(a.shru(47)),a=a.mul(r),a}function Uke(e,t,r,n,a,s){a=a.add(e),s=ia(s.add(a).add(n),21);let i=a;return a=a.add(t),a=a.add(r),s=s.add(ia(a,44)),[a.add(n),s.add(i)]}function s1(e,t,r,n){return Uke(Yr(e,t),Yr(e,t+8),Yr(e,t+16),Yr(e,t+24),r,n)}function Wke(e,t=e.length){if(t>=8){let r=Ha.add(t*2),n=Yr(e,0).add(Ha),a=Yr(e,t-8),s=ia(a,37).mul(r).add(n),i=ia(n,25).add(a).mul(r);return xc(s,i,r)}if(t>=4){let r=Ha.add(t*2),n=e4(e,0);return xc(n.shl(3).add(t),e4(e,t-4),r)}if(t>0){let r=e[0],n=e[t>>1],a=e[t-1],s=r+(n<<8),i=t+(a<<2);return bT(Ha.mul(s).xor($7.mul(i))).mul(Ha)}return Ha}function Vke(e,t=e.length){let r=Ha.add(t*2),n=Yr(e,0).mul(Sd),a=Yr(e,8),s=Yr(e,t-8).mul(r),i=Yr(e,t-16).mul(Ha);return xc(ia(n.add(a),43).add(ia(s,30)).add(i),n.add(ia(a.add(Ha),18)).add(s),r)}function Hke(e,t=e.length){let r=Ha.add(t*2),n=Yr(e,0).mul(Ha),a=Yr(e,8),s=Yr(e,t-8).mul(r),i=Yr(e,t-16).mul(Ha),o=ia(n.add(a),43).add(ia(s,30)).add(i),u=xc(o,n.add(ia(a.add(Ha),18)).add(s),r),d=Yr(e,16).mul(r),c=Yr(e,24),h=o.add(Yr(e,t-32)).mul(r),p=u.add(Yr(e,t-24)).mul(r);return xc(ia(d.add(c),43).add(ia(h,30)).add(p),d.add(ia(c.add(n),18)).add(h),r)}function qke(e,t=e.length){let r=Id.fromNumber(81,!0);if(t<=32)return t<=16?Wke(e,t):Vke(e,t);if(t<=64)return Hke(e,t);let n=r,a=r.mul(Sd).add(113),s=bT(a.mul(Ha).add(113)).mul(Ha),i=[Id.UZERO,Id.UZERO],o=[Id.UZERO,Id.UZERO];n=n.mul(Ha).add(Yr(e,0));let u=0,d=(t-1>>6)*64,c=d+(t-1&63)-63;do n=ia(n.add(a).add(i[0]).add(Yr(e,u+8)),37).mul(Sd),a=ia(a.add(i[1]).add(Yr(e,u+48)),42).mul(Sd),n=n.xor(o[1]),a=a.add(i[0]).add(Yr(e,u+40)),s=ia(s.add(o[0]),33).mul(Sd),i=s1(e,u,i[1].mul(Sd),n.add(o[0])),o=s1(e,u+32,s.add(o[1]),a.add(Yr(e,u+16))),[s,n]=[n,s],u+=64;while(u!==d);let h=Sd.add(s.and(255).shl(1));return u=c,o[0]=o[0].add(t-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),n=ia(n.add(a).add(i[0]).add(Yr(e,u+8)),37).mul(h),a=ia(a.add(i[1]).add(Yr(e,u+48)),42).mul(h),n=n.xor(o[1].mul(9)),a=a.add(i[0].mul(9).add(Yr(e,u+40))),s=ia(s.add(o[0]),33).mul(h),i=s1(e,u,i[1].mul(h),n.add(o[0])),o=s1(e,u+32,s.add(o[1]),a.add(Yr(e,u+16))),[s,n]=[n,s],xc(xc(i[0],o[0],h).add(bT(a).mul($7)).add(s),xc(i[1],o[1],h).add(n),h)}function Gke(e,t){return t==="string"?D0(e):kk([e],t)}function Kke(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function kk(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Ic(e)),ge().getBool("DEBUG")&&v7(e,t),Kke(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){let r=new Uint8Array(e.length);for(let n=0;n<r.length;++n)Math.round(e[n])!==0&&(r[n]=1);return r}else throw new Error(`Unknown data type ${t}`)}function ub(){return ge().platform.now()}function Qke(e,t){return ge().platform.fetch(e,t)}function D0(e,t="utf-8"){return t=t||"utf-8",ge().platform.encode(e,t)}function lS(e,t="utf-8"){return t=t||"utf-8",ge().platform.decode(e,t)}function oa(e){return ge().platform.isTypedArray!=null?ge().platform.isTypedArray(e):A7(e)}function Ic(e,t=[],r=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||dk(e)||e==null||oa(e)&&r)t.push(e);else if(Array.isArray(e)||oa(e))for(let n=0;n<e.length;++n)Ic(e[n],t,r);else{let n=-1;for(let a of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(a)&&(n=Math.max(n,Number(a)));for(let a=0;a<=n;a++)Ic(e[a],t,r)}return t}var Xke=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new Jke)}profileKernel(e,t,r){let n,a=()=>{n=r()},s,i=ub();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(a);else{a();for(let o of n)o.dataSync();s=Promise.resolve({kernelMs:ub()-i})}if(ge().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<n.length;o++){let u=n[o];u.data().then(d=>{Yke(d,u.dtype,e)})}return{kernelName:e,outputs:n,inputs:t,timeMs:s.then(o=>o.kernelMs),extraInfo:s.then(o=>o.getExtraProfileInfo!=null?o.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:r,timeMs:n,inputs:a,extraInfo:s}=e;r.forEach(i=>{Promise.all([i.data(),n,s]).then(o=>{this.logger.logKernelProfile(t,i,o[0],o[1],a,o[2])})})}};function Yke(e,t,r){if(t!=="float32")return!1;for(let n=0;n<e.length;n++){let a=e[n];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${r}'`),!0}return!1}var Jke=class{logKernelProfile(e,t,r,n,a,s){let i=typeof n=="number"?Nv(`${n}ms`,9):n.error,o=Nv(e,25),u=t.rank,d=t.size,c=Nv(t.shape.toString(),14),h="";for(let p in a){let f=a[p];if(f!=null){let g=f.shape||t.shape,m=g.length;h+=`${p}: ${m}D ${m>0?g:""} `}}console.log(`%c${o}	%c${i}	%c${u}D ${c}	%c${d}	%c${h}	%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function Zke(e,t,r){let n={},a={};for(let u=0;u<t.length;u++)n[t[u].id]=!0;for(let u=0;u<e.length;u++){let d=e[u],c=d.inputs;for(let h in c){let p=c[h],f=!1;for(let g=0;g<t.length;g++)if(n[p.id]){d.outputs.forEach(m=>n[m.id]=!0),f=!0,a[d.id]=!0;break}if(f)break}}let s={};s[r.id]=!0;let i={};for(let u=e.length-1;u>=0;u--){let d=e[u],c=d.inputs;for(let h=0;h<d.outputs.length;h++)if(s[d.outputs[h].id]){for(let p in c)s[c[p].id]=!0,i[d.id]=!0;break}}let o=[];for(let u=0;u<e.length;u++){let d=e[u];if(a[d.id]&&i[d.id]){let c={};for(let p in d.inputs){let f=d.inputs[p];n[f.id]&&(c[p]=f)}let h=Object.assign({},d);h.inputs=c,h.outputs=d.outputs,o.push(h)}}return o}function eCe(e,t,r,n){for(let a=t.length-1;a>=0;a--){let s=t[a],i=[];if(s.outputs.forEach(u=>{let d=e[u.id];d!=null?i.push(d):i.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);let o=s.gradient(i);for(let u in s.inputs){if(!(u in o))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(o)}.`);let d=r(()=>o[u]());if(d.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${d.dtype}'`);let c=s.inputs[u];if(!cu(d.shape,c.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${u}' has shape '${d.shape}', which does not match the shape of the input '${c.shape}'`);if(e[c.id]==null)e[c.id]=d;else{let h=e[c.id];e[c.id]=n(h,d),h.dispose()}}}}var t4=20,Py=3,Z2=7;function tCe(e,t,r,n){let a=Qg(t),s=rCe(e,t,r,a),i=t.length,o=Y1(e,t,r,a,s),u=["Tensor"];return n&&(u.push(`  dtype: ${r}`),u.push(`  rank: ${i}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(o.map(d=>"    "+d).join(`
`)),u.join(`
`)}function rCe(e,t,r,n){let a=Ar(t),s=n[n.length-1],i=new Array(s).fill(0),o=t.length,u=r==="complex64"?ev(e):e;if(o>1)for(let d=0;d<a/s;d++){let c=d*s;for(let h=0;h<s;h++)i[h]=Math.max(i[h],Zy(u[c+h],0,r).length)}return i}function Zy(e,t,r){let n;return Array.isArray(e)?n=`${parseFloat(e[0].toFixed(Z2))} + ${parseFloat(e[1].toFixed(Z2))}j`:rc(e)?n=`'${e}'`:r==="bool"?n=D7(e):n=parseFloat(e.toFixed(Z2)).toString(),Nv(n,t)}function D7(e){return e===0?"false":"true"}function Y1(e,t,r,n,a,s=!0){let i=r==="complex64"?2:1,o=t[0],u=t.length;if(u===0){if(r==="complex64"){let m=ev(e);return[Zy(m[0],0,r)]}return r==="bool"?[D7(e[0])]:[e[0].toString()]}if(u===1){if(o>t4){let m=Py*i,x=Array.from(e.slice(0,m)),y=Array.from(e.slice((o-Py)*i,o*i));return r==="complex64"&&(x=ev(x),y=ev(y)),["["+x.map((v,b)=>Zy(v,a[b],r)).join(", ")+", ..., "+y.map((v,b)=>Zy(v,a[o-Py+b],r)).join(", ")+"]"]}return["["+(r==="complex64"?ev(e):Array.from(e)).map((m,x)=>Zy(m,a[x],r)).join(", ")+"]"]}let d=t.slice(1),c=n.slice(1),h=n[0]*i,p=[];if(o>t4){for(let m=0;m<Py;m++){let x=m*h,y=x+h;p.push(...Y1(e.slice(x,y),d,r,c,a,!1))}p.push("...");for(let m=o-Py;m<o;m++){let x=m*h,y=x+h;p.push(...Y1(e.slice(x,y),d,r,c,a,m===o-1))}}else for(let m=0;m<o;m++){let x=m*h,y=x+h;p.push(...Y1(e.slice(x,y),d,r,c,a,m===o-1))}let f=u===2?",":"";p[0]="["+(o>0?p[0]+f:"");for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+f;let g=`,
`;for(let m=2;m<u;m++)g+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(s?"":g),p}function ev(e){let t=[];for(let r=0;r<e.length;r+=2)t.push([e[r],e[r+1]]);return t}var zn=class{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=Ar(e),r!=null){let n=r.length;X(n===this.size,()=>`Length of values '${n}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||SR(t,this.size),this.strides=Qg(e)}set(e,...t){t.length===0&&(t=[0]),X(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(let n of e){if(n<0||n>=this.shape[t]){let a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}t++}let r=e[e.length-1];for(let n=0;n<e.length-1;++n)r+=this.strides[n]*e[n];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];let t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return po().makeTensor(this.values,this.shape,this.dtype)}},po=null,Qf=null;function nCe(e){po=e}function aCe(e){Qf=e}var Jt=class{constructor(e,t,r,n){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ar(e),this.strides=Qg(e),this.dataId=r,this.id=n,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return Qf.buffer(this.shape,this.dtype,e)}bufferSync(){return Qf.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return Im(this.shape,e,this.dtype==="complex64")}arraySync(){return Im(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();let e=po().read(this.dataId);if(this.dtype==="string"){let t=await e;try{return t.map(r=>lS(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),po().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=po().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>lS(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await po().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),po().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Qf.print(this,e)}clone(){return this.throwIfDisposed(),Qf.clone(this)}toString(e=!1){let t=this.dataSync();return tCe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Qf.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),po().makeVariable(this,e,t,r)}};Object.defineProperty(Jt,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function Se(){return CR("Tensor",()=>Jt)}Se();var _h=class extends Jt{constructor(e,t,r,n){super(e.shape,e.dtype,e.dataId,n),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!cu(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);po().disposeTensor(this),this.dataId=e.dataId,po().incRef(this,null)}dispose(){po().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(_h,Symbol.hasInstance,{value:e=>e instanceof Jt&&e.assign!=null&&e.assign instanceof Function});var vo={};Ut(vo,{assertTypesMatch:()=>O7,getTensorsInContainer:()=>ER,isTensorInList:()=>iCe,makeTypesMatch:()=>yn});var wT;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(wT||(wT={}));var NT;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(NT||(NT={}));var ST;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(ST||(ST={}));var _T;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(_T||(_T={}));var kT;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(kT||(kT={}));var sCe={float32:_T,int32:NT,bool:ST,complex64:kT};function wi(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return sCe[e][t]}function Ck(e){return wi(e,"int32")}function M7(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function F7(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}function yn(e,t){if(e.dtype===t.dtype)return[e,t];let r=wi(e.dtype,t.dtype);return[e.cast(r),t.cast(r)]}function O7(e,t){X(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function iCe(e,t){return t.some(r=>r.id===e.id)}function ER(e){let t=[];return P7(e,t,new Set),t}function P7(e,t,r){if(e==null)return;if(e instanceof Jt){t.push(e);return}if(!oCe(e))return;let n=e;for(let a in n){let s=n[a];r.has(s)||(r.add(s),P7(s,t,r))}}function oCe(e){return Array.isArray(e)||typeof e=="object"}function eI(e){return e.kernelName!=null}var r4=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},TR=class CT{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new r4}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let t=this.getSortedBackends();for(let r=0;r<t.length;r++){let n=t[r];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:t,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){let{asyncInit:r}=this.initializeBackend(t);if(r)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,r,n=1){return t in this.registryFactory?(Uu(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:r,priority:n},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;let{success:r,asyncInit:n}=this.initializeBackend(t);if(!(n?await r:r))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Xke(this.backendInstance),!0}setupRegisteredKernels(){oS(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){oS(t).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[t])})}initializeBackend(t){let r=this.registryFactory[t];if(r==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{let n=r.factory();if(n&&!(n instanceof u0)&&typeof n.then=="function"){let a=++this.pendingBackendInitId,s=n.then(i=>a<this.pendingBackendInitId?!1:(this.registry[t]=i,this.pendingBackendInit=null,!0)).catch(i=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,Uu(`Initialization of backend ${t} failed`),Uu(i.stack||i.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[t]=n,{success:!0,asyncInit:!1}}catch(n){return Uu(`Initialization of backend ${t} failed`),Uu(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,r)=>this.registryFactory[r].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){let t=this.getSortedBackends();for(let r=0;r<t.length;r++){let n=t[r],{success:a,asyncInit:s}=this.initializeBackend(n);if(s||a)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,r){let n=this.state.tensorInfo.get(r),a=n.backend,s=this.readSync(r),i=a.refCount(r);a.disposeData(r,!0),n.backend=t,t.move(r,s,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,r){let n=null;if(r==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");r=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=t}let a;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(a),()=>(a=r(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(t,r,n){t();try{let a=n();return r(),a}catch(a){throw r(),a}}nextTensorId(){return CT.nextTensorId++}nextVariableId(){return CT.nextVariableId++}clone(t){let r=se.runKernel(kp,{x:t}),n={x:t},a=i=>({x:()=>{let o="float32",u={x:i},d={dtype:o};return se.runKernel(ip,u,d)}}),s=[];return this.addTapeNode(this.state.activeScope.name,n,[r],a,s,{}),r}runKernel(t,r,n){if(this.backendName==null&&this.backend,lb(t,this.backendName)==null)throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:r,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,r,n){let a=this.backend.numDataIds(),s=0;n.forEach(u=>{s+=u.dtype==="complex64"?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=a-r-s-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let r,n=[],a=this.isTapeOn(),s=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let u,d=eI(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(eI(t)){let{kernelName:g,inputs:m,attrs:x}=t;this.backendName==null&&this.backend;let y=lb(g,this.backendName);X(y!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),o=()=>{let v=this.backend.numDataIds();u=y.kernelFunc({inputs:m,attrs:x,backend:this.backend});let b=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,v,b);let N=b.map(S=>S.rank!=null?S:this.makeTensorFromTensorInfo(S));if(a){let S=this.getTensorsForGradient(g,m,N);n=this.saveTensorsForBackwardMode(S)}return N}}else{let{forwardFunc:g}=t,m=x=>{a&&(n=x.map(y=>this.keep(this.clone(y))))};o=()=>{let x=this.backend.numDataIds();u=this.tidy(()=>g(this.backend,m));let y=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(d,x,y),y}}let{inputs:c,attrs:h}=t,p=eI(t)?null:t.backwardsFunc,f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?r=o():(f=this.profiler.profileKernel(d,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),r=f.outputs)}),a&&this.addTapeNode(d,c,r,p,n,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:d,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(g=>c[g]!=null?c[g].shape:null),outputShapes:r.map(g=>g.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(u)?r:r[0]}saveTensorsForBackwardMode(t){return t.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(t,r,n){let a=vT(t);if(a!=null){let s=a.inputsToSave||[],i=a.outputsToSave||[],o;a.saveAllInputs?(X(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(r).map(d=>r[d])):o=s.map(d=>r[d]);let u=n.filter((d,c)=>i[c]);return o.concat(u)}return[]}makeTensor(t,r,n,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;let s=t;n==="string"&&rc(t[0])&&(s=t.map(u=>D0(u)));let i=a.write(s,r,n),o=new Jt(r,n,i,this.nextTensorId());if(this.trackTensor(o,a),n==="string"){let u=this.state.tensorInfo.get(i),d=w7(s);this.state.numBytes+=d-u.bytes,u.bytes=d}return o}makeTensorFromDataId(t,r,n,a){n=n||"float32";let s={dataId:t,shape:r,dtype:n};return this.makeTensorFromTensorInfo(s,a)}makeTensorFromTensorInfo(t,r){let{dataId:n,shape:a,dtype:s}=t,i=new Jt(a,s,n,this.nextTensorId());return this.trackTensor(i,r),i}makeVariable(t,r=!0,n,a){n=n||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.cast(a));let s=new _h(t,r,n,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(t,r){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let n=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(n=t.size*aS(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:r||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof _h||this.track(t)}incRef(t,r){this.trackTensor(t,r),this.backend.incRef(t.dataId)}removeDataId(t,r){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===r&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;let r=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=r.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){let n=t.size*aS(t.dtype);this.state.numBytes-=n}r.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,r.backend)}disposeVariables(){for(let t in this.state.registeredVariables){let r=this.state.registeredVariables[t];this.disposeVariable(r)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){let t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;let r=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,r,n,a,s,i){let o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:r,outputs:n,saved:s},u=vT(t);u!=null&&(a=u.gradFunc),a!=null&&(o.gradient=d=>(d=d.map((c,h)=>{if(c==null){let p=n[h],f=ck(p.size,p.dtype);return this.makeTensor(f,p.shape,p.dtype)}return c}),a(d.length>1?d:d[0],s,i))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){let r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(r.name=t),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(t){let r=ER(t),n=new Set(r.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){let i=this.state.activeScope.track[s];!i.kept&&!n.has(i.id)&&i.dispose()}let a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(s=>{!s.kept&&s.scopeId===a.id&&this.track(s)})}gradients(t,r,n,a=!1){if(X(r.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));X(s instanceof Jt,()=>"The result y returned by f() must be a tensor.");let i=Zke(this.state.activeTape,r,s);if(!a&&i.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let o={};o[s.id]=n??lCe(s.shape),eCe(o,i,d=>this.tidy(d),uCe);let u=r.map(d=>o[d.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(d=>{for(let c of d.saved)c.dispose()}),this.state.activeTape=null),{value:s,grads:u}})}customGrad(t){return X(Cc(t),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{X(r.every(o=>o instanceof Jt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n,a={};r.forEach((o,u)=>{a[u]=o});let s=(o,u)=>(n=t(...r,u),X(n.value instanceof Jt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),X(Cc(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(o,u)=>{let d=n.gradFunc(o,u),c=Array.isArray(d)?d:[d];X(c.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),X(c.every(p=>p instanceof Jt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let h={};return c.forEach((p,f)=>{h[f]=()=>p}),h};return this.runKernelFunc({forwardFunc:s,backwardsFunc:i,inputs:a})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,r){return this.state.tensorInfo.get(t).backend.readToGPU(t,r)}async time(t){let r=ub(),n=await this.backend.time(t);return n.wallMs=ub()-r,n}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new r4;for(let t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};TR.nextTensorId=0;TR.nextVariableId=0;function lCe(e){let t=_R(Ar(e),"float32");return se.makeTensor(t,e,"float32")}function L7(){let e=C7();if(e._tfengine==null){let t=new k7(e);e._tfengine=new TR(t)}return $ke(e._tfengine.ENV),nCe(()=>e._tfengine),e._tfengine}var se=L7();function uCe(e,t){let r={a:e,b:t};return se.runKernel(Yc,r)}var M0={};Ut(M0,{isBrowser:()=>z7,isMobile:()=>hCe,mockIsMobile:()=>dCe});function cCe(){return typeof navigator<"u"&&navigator!=null}var IT;function dCe(e){IT=e}function hCe(e){if(IT!==void 0)return IT;if(e||cCe()){if(e||(e=navigator),e.product==="ReactNative")return!0;let t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){let r=e;return r.userAgentData&&r.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function z7(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var ys=ge();ys.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ys.registerFlag("IS_BROWSER",()=>z7());ys.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ys.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ys.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ys.registerFlag("PROD",()=>!1);ys.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ys.getBool("DEBUG"));ys.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ys.registerFlag("IS_TEST",()=>!1);ys.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ys.getBool("DEBUG"));ys.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ys.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ys.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function hl(e,t){let r=e;if(oa(e))return t==="string"?[]:[e.length];if(M7(e)){let a=e.channels||"RGBA";return[e.height,e.width*a.length]}else if(F7(e))return[e.buffer.size/(t==null?4:aS(t))];if(!Array.isArray(e))return[];let n=[];for(;Array.isArray(r)||oa(r)&&t!=="string";)n.push(r.length),r=r[0];return Array.isArray(e)&&ge().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&B7(e,n,[]),n}function B7(e,t,r){if(r=r||[],!Array.isArray(e)&&!oa(e)){X(t.length===0,()=>`Element arr[${r.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}X(t.length>0,()=>`Element arr[${r.join("][")}] should be a primitive, but is an array of ${e.length} elements`),X(e.length===t[0],()=>`Element arr[${r.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);let n=t.slice(1);for(let a=0;a<e.length;++a)B7(e[a],n,r.concat(a))}function n4(e,t,r,n){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${r}' passed to '${n}' must be ${e} tensor, but got ${t} tensor`)}}function G(e,t,r,n="numeric"){if(e instanceof Se())return n4(n,e.dtype,t,r),e;let a=c0(e);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),n4(n,a,t,r),e==null||!oa(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){let o=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${r}' must be a Tensor or TensorLike, but got '${o}'`)}let s=hl(e,a);!oa(e)&&!Array.isArray(e)&&(e=[e]);let i=a!=="string"?kk(e,a):Ic(e,[],!0);return se.makeTensor(i,s,a)}function cb(e,t,r,n="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${r} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((a,s)=>G(a,`${t}[${s}]`,r,n))}var jR="__op";function ie(e){let t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let r=t[0],n=e[r];r.endsWith("_")&&(r=r.substring(0,r.length-1)),r=r+jR;let a=(...s)=>{se.startScope(r);try{let i=n(...s);return dk(i)&&console.error("Cannot return a Promise inside of tidy."),se.endScope(i),i}catch(i){throw se.endScope(null),i}};return Object.defineProperty(a,"name",{value:r,configurable:!0}),a}function pCe(e,t){let r=G(e,"real","complex"),n=G(t,"imag","complex");rs(r.shape,n.shape,`real and imag shapes, ${r.shape} and ${n.shape}, must match in call to tf.complex().`);let a={real:r,imag:n};return se.runKernel(hk,a)}var su=ie({complex_:pCe});function td(e,t,r,n){if(n==null)n=c0(e);else if(n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(F7(e)||M7(e)){if(n!=="float32"&&n!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${n}.`);return se.backend.createTensorFromGPUData(e,t||r,n)}if(!oa(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){ti(t);let a=Ar(t),s=Ar(r);X(a===s,()=>`Based on the provided shape, [${t}], the tensor should have ${a} values but has ${s}`);for(let i=0;i<r.length;++i){let o=r[i],u=i===r.length-1?o!==Ar(t.slice(i)):!0;X(r[i]===t[i]||!u,()=>`Error creating a new Tensor. Inferred shape (${r}) does not match the provided shape (${t}). `)}}return!oa(e)&&!Array.isArray(e)&&(e=[e]),t=t||r,e=n!=="string"?kk(e,n):Ic(e,[],!0),se.makeTensor(e,t,n)}function Qa(e,t,r){let n=hl(e,r);return td(e,t,n,r)}var kh={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},du=class U7{static join(t){return new U7(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(n=>oa(n)?n.buffer:n),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let r=0;for(let n=0;n<t.length;n++){let a=t[n];n!==t.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let s=r+a.byteLength;this.shards.push({buffer:a,start:r,end:s}),r=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,r=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,r=isNaN(Number(r))?0:r,t=Math.max(0,t),r=Math.min(this.byteLength,r),r<=t)return new ArrayBuffer(0);let n=this.findShardForByte(t);if(n===-1)throw new Error(`Could not find start shard for byte ${t}`);let a=r-t,s=new ArrayBuffer(a),i=new Uint8Array(s),o=0;for(let u=n;u<this.shards.length;u++){let d=this.shards[u],c=t+o-d.start,h=o,p=Math.min(r,d.end)-d.start,f=new Uint8Array(d.buffer,c,p-c);if(i.set(f,h),o+=f.length,r<d.end)break}return s}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function r(a){return t<a.start?-1:t>=a.end?1:0}if(r(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let n=fCe(this.shards,r);return n===-1?-1:(this.previousShardIndex=n,this.previousShardIndex)}};function fCe(e,t){let r=0,n=e.length;for(;r<=n;){let a=Math.floor((n-r)/2)+r,s=t(e[a]);if(s===0)return a;s<0?n=a:r=a+1}return-1}function mCe(){ge().set("PROD",!0)}function gCe(){ge().set("DEBUG",!0)}function xCe(){ge().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function W7(e){ge().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function yCe(){se.disposeVariables()}function Ai(){return se}function ET(){return se.memory()}function vCe(e){return se.profile(e)}function ce(e,t){return se.tidy(e,t)}function zt(e){ER(e).forEach(t=>t.dispose())}function Qn(e){return se.keep(e)}function bCe(e){return se.time(e)}function wCe(e){return se.setBackend(e)}function NCe(){return se.ready()}function V7(){return se.backendName}function SCe(e){se.removeBackend(e)}function _Ce(e){return se.findBackend(e)}function kCe(e){return se.findBackendFactory(e)}function Ik(e,t,r=1){return se.registerBackend(e,t,r)}function AR(){return se.backend}function CCe(e,t){ge().setPlatform(e,t)}var Ec=4;async function ICe(e,t){let r=[],n=[],a=Array.isArray(e)?e.map(i=>i.name):Object.keys(e);for(let i=0;i<a.length;++i){let o=a[i],u=Array.isArray(e)?e[i].tensor:e[o];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${u.dtype}`);let d={name:o,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){let c=new Promise(async h=>{let p=await u.bytes(),f=p.reduce((x,y)=>x+y.length,0)+Ec*p.length,g=new Uint8Array(f),m=0;for(let x=0;x<p.length;x++){let y=p[x],v=new Uint8Array(new Uint32Array([y.length]).buffer);g.set(v,m),m+=Ec,g.set(y,m),m+=y.length}h(g)});n.push(c)}else n.push(u.data());t!=null&&(d.group=t),r.push(d)}let s=await Promise.all(n);return{data:jCe(s),specs:r}}function H7(e,t){let r=new du(e),n={},a=0;for(let s of t){let i=ECe(s,(o,u)=>r.slice(a+o,a+u));n[s.name]=q7(s,r.slice(a,a+i)),a+=i}return n}function ECe(e,t){let r=Ar(e.shape),n;if("quantization"in e){let a=e.quantization;n=kh[a.dtype]}else if(e.dtype==="string"){let a=0;for(let s=0;s<r;s++)a+=Ec+new Uint32Array(t(a,a+Ec))[0];return a}else n=kh[e.dtype];return r*n}async function TCe(e,t){let r=Ar(e.shape),n;if("quantization"in e){let a=e.quantization;n=kh[a.dtype]}else if(e.dtype==="string"){let a=0;for(let s=0;s<r;s++)a+=Ec+new Uint32Array(await t(a,a+Ec))[0];return a}else n=kh[e.dtype];return r*n}function q7(e,t){let r=e.name,n=e.dtype,a=e.shape,s=Ar(a),i,o=0;if("quantization"in e){let u=e.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${e.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(n!=="float32")throw new Error(`Weight ${e.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${n}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let d=kh[u.dtype],c=u.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(n==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){i=new Float32Array(c.length);for(let h=0;h<c.length;h++){let p=c[h];i[h]=p*u.scale+u.min}}else if(u.dtype==="float16")i=OCe()(c);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(n==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);i=new Int32Array(c.length);for(let h=0;h<c.length;h++){let p=c[h];i[h]=Math.round(p*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${r}': ${n}`);o+=s*d}else if(n==="string"){let u=Ar(e.shape);i=[];for(let d=0;d<u;d++){let c=new Uint32Array(t.slice(o,o+Ec))[0];o+=Ec;let h=new Uint8Array(t.slice(o,o+c));i.push(h),o+=c}}else{let u=kh[n];if(n==="float32")i=new Float32Array(t);else if(n==="int32")i=new Int32Array(t);else if(n==="bool")i=new Uint8Array(t);else if(n==="complex64"){i=new Float32Array(t);let d=new Float32Array(i.length/2),c=new Float32Array(i.length/2);for(let g=0;g<d.length;g++)d[g]=i[g*2],c[g]=i[g*2+1];let h=Qa(d,a,"float32"),p=Qa(c,a,"float32"),f=su(h,p);return h.dispose(),p.dispose(),f}else throw new Error(`Unsupported dtype in weight '${r}': ${n}`);o+=s*u}return Qa(i,a,n)}async function a4(e,t,r){let n=new Uint8Array(t);for(;n.byteLength<r;){let{done:a,value:s}=await e.read();if(a&&s==null){let o=r-n.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}let i=new Uint8Array(n.length+s.byteLength);i.set(n,0),i.set(new Uint8Array(s),n.length),n=i}return n.buffer}async function G7(e,t){let r={},n=e.getReader(),a=new ArrayBuffer(0);for(let s of t){let i=await TCe(s,async(d,c)=>(a=await a4(n,a,c),a.slice(d,c)));a=await a4(n,a,i);let o=a.slice(0,i);a=a.slice(i);let u=q7(s,o);if(r[s.name]=u,V7()==="webgpu"){let d=AR();"uploadToGPU"in d&&Ar(u.shape)>=ge().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&d.uploadToGPU(u.dataId)}}return r}function jCe(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,r=[];e.forEach(s=>{if(t+=s.byteLength,r.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});let n=new Uint8Array(t),a=0;return r.forEach(s=>{n.set(new Uint8Array(s.buffer),a),a+=s.byteLength}),n.buffer}var $R=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function s4(e){return $R?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function ACe(e){if($R)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),r="";for(let n=0,a=t.length;n<a;n++)r+=String.fromCharCode(t[n]);return btoa(r)}function $Ce(e){if($R){let n=Buffer.from(e,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}let t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;++n)r.set([t.charCodeAt(n)],n);return r.buffer}function RCe(e){return du.join(e)}function i4(e){let t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);let r=e.split(t);return r[r.length-1]}function K7(e,t){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),r}function Q7(e,t,r){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!r)throw new Error("modelJSON has weightsManifest but weightData is null");n.weightSpecs=t,n.weightData=r}return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),n}async function RR(e,t){let r,n;return e.weightsManifest!=null&&([r,n]=await t(e.weightsManifest)),Q7(e,r,n)}function F0(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:s4(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:s4(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new du(e.weightData).byteLength}}function TT(e){let t=[];for(let r of e)t.push(...r.weights);return t}function DCe(){let e=r=>{let n=r<<13,a=0;for(;!(n&8388608);)a-=8388608,n<<=1;return n&=-8388609,a+=947912704,n|a},t=new Uint32Array(2048);t[0]=0;for(let r=1;r<1024;r++)t[r]=e(r);for(let r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}function MCe(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function FCe(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function OCe(){let e=DCe(),t=MCe(),r=FCe();return n=>{let a=new ArrayBuffer(4*n.length),s=new Uint32Array(a);for(let i=0;i<n.length;i++){let o=n[i],u=e[r[o>>10]+(o&1023)]+t[o>>10];s[i]=u}return new Float32Array(a)}}var Ni=class no{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return no.instance==null&&(no.instance=new no),no.instance}static registerSaveRouter(t){no.getInstance().saveRouters.push(t)}static registerLoadRouter(t){no.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return no.getHandlers(t,"save")}static getLoadHandlers(t,r){return no.getHandlers(t,"load",r)}static getHandlers(t,r,n){let a=[];return(r==="load"?no.getInstance().loadRouters:no.getInstance().saveRouters).forEach(s=>{let i=s(t,n);i!==null&&a.push(i)}),a}},PCe=e=>Ni.registerSaveRouter(e),LCe=e=>Ni.registerLoadRouter(e),zCe=e=>Ni.getSaveHandlers(e),BCe=(e,t)=>Ni.getLoadHandlers(e,t),jT="tensorflowjs",AT=1,Od="models_store",nc="model_info_store";function X7(){if(!ge().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function $T(e){let t=e.result;t.createObjectStore(Od,{keyPath:"modelPath"}),t.createObjectStore(nc,{keyPath:"modelPath"})}var Ch=class{constructor(e){if(this.indexedDB=X7(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,n)=>{let a=this.indexedDB.open(jT,AT);a.onupgradeneeded=()=>$T(a),a.onsuccess=()=>{let s=a.result;if(t==null){let i=s.transaction(Od,"readonly"),o=i.objectStore(Od).get(this.modelPath);o.onsuccess=()=>{if(o.result==null)return s.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(o.result.modelArtifacts)},o.onerror=u=>(s.close(),n(o.error)),i.oncomplete=()=>s.close()}else{t.weightData=du.join(t.weightData);let i=F0(t),o=s.transaction(nc,"readwrite"),u=o.objectStore(nc),d;try{d=u.put({modelPath:this.modelPath,modelArtifactsInfo:i})}catch(h){return n(h)}let c;d.onsuccess=()=>{c=s.transaction(Od,"readwrite");let h=c.objectStore(Od),p;try{p=h.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:i})}catch(f){return n(f)}p.onsuccess=()=>r({modelArtifactsInfo:i}),p.onerror=f=>{u=o.objectStore(nc);let g=u.delete(this.modelPath);g.onsuccess=()=>(s.close(),n(p.error)),g.onerror=m=>(s.close(),n(p.error))}},d.onerror=h=>(s.close(),n(d.error)),o.oncomplete=()=>{c==null?s.close():c.oncomplete=()=>s.close()}}},a.onerror=s=>n(a.error)})}};Ch.URL_SCHEME="indexeddb://";var Y7=e=>ge().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ch.URL_SCHEME)?UCe(e.slice(Ch.URL_SCHEME.length)):null;Ni.registerSaveRouter(Y7);Ni.registerLoadRouter(Y7);function UCe(e){return new Ch(e)}function WCe(e){return e.startsWith(Ch.URL_SCHEME)?e.slice(Ch.URL_SCHEME.length):e}var VCe=class{constructor(){this.indexedDB=X7()}async listModels(){return new Promise((e,t)=>{let r=this.indexedDB.open(jT,AT);r.onupgradeneeded=()=>$T(r),r.onsuccess=()=>{let n=r.result,a=n.transaction(nc,"readonly"),s=a.objectStore(nc).getAll();s.onsuccess=()=>{let i={};for(let o of s.result)i[o.modelPath]=o.modelArtifactsInfo;e(i)},s.onerror=i=>(n.close(),t(s.error)),a.oncomplete=()=>n.close()},r.onerror=n=>t(r.error)})}async removeModel(e){return e=WCe(e),new Promise((t,r)=>{let n=this.indexedDB.open(jT,AT);n.onupgradeneeded=()=>$T(n),n.onsuccess=()=>{let a=n.result,s=a.transaction(nc,"readwrite"),i=s.objectStore(nc),o=i.get(e),u;o.onsuccess=()=>{if(o.result==null)return a.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{let d=i.delete(e),c=()=>{u=a.transaction(Od,"readwrite");let h=u.objectStore(Od).delete(e);h.onsuccess=()=>t(o.result.modelArtifactsInfo),h.onerror=p=>r(o.error)};d.onsuccess=c,d.onerror=h=>(c(),a.close(),r(o.error))}},o.onerror=d=>(a.close(),r(o.error)),s.oncomplete=()=>{u==null?a.close():u.oncomplete=()=>a.close()}},n.onerror=a=>r(n.error)})}},zl="/",Xf="tensorflowjs_models",J7="info",HCe="model_topology",qCe="weight_specs",GCe="weight_data",KCe="model_metadata";function Z7(e){return{info:[Xf,e,J7].join(zl),topology:[Xf,e,HCe].join(zl),weightSpecs:[Xf,e,qCe].join(zl),weightData:[Xf,e,GCe].join(zl),modelMetadata:[Xf,e,KCe].join(zl)}}function eK(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function QCe(e){let t=e.split(zl);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(zl)}function XCe(e){return e.startsWith(Ih.URL_SCHEME)?e.slice(Ih.URL_SCHEME.length):e}var Ih=class{constructor(e){if(!ge().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Z7(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),n=F0(e),a=du.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(n)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,ACe(a));let s={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(s)),{modelArtifactsInfo:n}}catch{throw eK(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${n.modelTopologyBytes}, weightSpecsBytes=${n.weightSpecsBytes}, weightDataBytes=${n.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;let n=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(n==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=n;let a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){let i=JSON.parse(a);t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,i.signature!=null&&(t.signature=i.signature),i.userDefinedMetadata!=null&&(t.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(t.modelInitializer=i.modelInitializer),i.initializerSignature!=null&&(t.initializerSignature=i.initializerSignature),i.trainingConfig!=null&&(t.trainingConfig=i.trainingConfig)}let s=this.LS.getItem(this.keys.weightData);if(s==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=$Ce(s),t}};Ih.URL_SCHEME="localstorage://";var tK=e=>ge().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ih.URL_SCHEME)?YCe(e.slice(Ih.URL_SCHEME.length)):null;Ni.registerSaveRouter(tK);Ni.registerLoadRouter(tK);function YCe(e){return new Ih(e)}var JCe=class{constructor(){X(ge().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),X(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=Xf+zl,r=zl+J7;for(let n=0;n<this.LS.length;++n){let a=this.LS.key(n);if(a.startsWith(t)&&a.endsWith(r)){let s=QCe(a);e[s]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=XCe(e);let t=Z7(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);let r=JSON.parse(this.LS.getItem(t.info));return eK(t),r}},Em="://",Tc=class ju{constructor(){this.managers={}}static getInstance(){return ju.instance==null&&(ju.instance=new ju),ju.instance}static registerManager(t,r){X(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(Em)&&(t=t.slice(0,t.indexOf(Em))),X(t.length>0,()=>"scheme must not be an empty string.");let n=ju.getInstance();X(n.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),n.managers[t]=r}static getManager(t){let r=ju.getInstance().managers[t];if(r==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return r}static getSchemes(){return Object.keys(ju.getInstance().managers)}};function J1(e){if(e.indexOf(Em)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Tc.getSchemes().join(",")}`);return{scheme:e.split(Em)[0],path:e.split(Em)[1]}}async function rK(e,t,r=!1){X(e!==t,()=>`Old path and new path are the same: '${e}'`);let n=Ni.getLoadHandlers(e);X(n.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),X(n.length<2,()=>`Copying failed because more than one (${n.length}) load handlers for source URL ${e}.`);let a=n[0],s=Ni.getSaveHandlers(t);X(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),X(s.length<2,()=>`Copying failed because more than one (${n.length}) save handlers for destination URL ${t}.`);let i=s[0],o=J1(e).scheme,u=J1(e).path,d=o===J1(e).scheme,c=await a.load();r&&d&&await Tc.getManager(o).removeModel(u);let h=await i.save(c);return r&&!d&&await Tc.getManager(o).removeModel(u),h.modelArtifactsInfo}async function ZCe(){let e=Tc.getSchemes(),t={};for(let r of e){let n=await Tc.getManager(r).listModels();for(let a in n){let s=r+Em+a;t[s]=n[a]}}return t}async function e2e(e){let t=J1(e);return Tc.getManager(t.scheme).removeModel(t.path)}async function t2e(e,t){return rK(e,t,!1)}async function r2e(e,t){return rK(e,t,!0)}var n2e=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!ge().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();let n=this.functionRefs[r.data.index];n(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return A7(e)}};if(ge().get("IS_BROWSER")){ge().setPlatform("browser",new n2e);try{Tc.registerManager(Ih.URL_SCHEME,new JCe)}catch{}try{Tc.registerManager(Ch.URL_SCHEME,new VCe)}catch{}}var a2e={importFetch:()=>Y_e()},tI,s2e=class{constructor(){this.util=J_e(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return ge().global.fetch!=null?ge().global.fetch(e,t):(tI==null&&(tI=a2e.importFetch()),tI(e,t))}now(){let e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}};ge().get("IS_NODE")&&!ge().get("IS_BROWSER")&&ge().setPlatform("node",new s2e);function Qt(e,t="float32",r){return t=t||"float32",ti(e),new zn(e,t,r)}function i2e(e,t){let r=G(e,"x","cast");if(!b7(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&r.dtype!=="string"||t!=="string"&&r.dtype==="string")throw new Error("Only strings can be casted to strings");let n={x:r},a={dtype:t};return se.runKernel(ip,n,a)}var Pe=ie({cast_:i2e});function o2e(e){let t={x:G(e,"x","clone","string_or_numeric")};return se.runKernel(kp,t)}var il=ie({clone_:o2e});function DR(e,t=!1){console.log(e.toString(t))}L7();var l2e={buffer:Qt,cast:Pe,clone:il,print:DR};aCe(l2e);function u2e(e,t){let r=G(e,"a","add"),n=G(t,"b","add");[r,n]=yn(r,n);let a={a:r,b:n};return se.runKernel(Yc,a)}var Ne=ie({add_:u2e});function c2e(e,t){let r=G(e,"a","floorDiv"),n=G(t,"b","floorDiv");[r,n]=yn(r,n);let a={a:r,b:n};return se.runKernel(Np,a)}var Ek=ie({floorDiv_:c2e});function d2e(e,t){let r=G(e,"a","div"),n=G(t,"b","div");if([r,n]=yn(r,n),r.dtype==="int32"&&n.dtype==="int32")return Ek(r,n);let a={a:r,b:n},s={};return se.runKernel(gp,a,s)}var it=ie({div_:d2e});function h2e(e,t){let r=G(e,"a","mul"),n=G(t,"b","mul");[r,n]=yn(r,n);let a={a:r,b:n};return se.runKernel(Bp,a)}var oe=ie({mul_:h2e});function p2e(e){let t=G(e,"x","abs");if(t.dtype==="complex64"){let r={x:t};return se.runKernel(f0,r)}else{let r={x:t};return se.runKernel(Xg,r)}}var Fn=ie({abs_:p2e});function f2e(e){let t={x:G(e,"x","acos")};return se.runKernel(Xh,t)}var MR=ie({acos_:f2e});function m2e(e){let t={x:G(e,"x","acosh")};return se.runKernel(Yh,t)}var FR=ie({acosh_:m2e});function g2e(e){X(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),X(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);let t=e.map((a,s)=>G(a,`tensors${s}`,"addN")),r=t[0];t.forEach(a=>{if(a.dtype!==r.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(a=>{if(!cu(a.shape,r.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let n=t;return se.runKernel(Jh,n)}var nK=ie({addN_:g2e});function x2e(e,t=null,r=!1){let n={x:G(e,"x","all","bool")},a={axis:t,keepDims:r};return se.runKernel(Yg,n,a)}var Tk=ie({all_:x2e});function y2e(e,t=null,r=!1){let n={x:G(e,"x","any","bool")},a={axis:t,keepDims:r};return se.runKernel(Jg,n,a)}var db=ie({any_:y2e});function v2e(e,t=0){let r={x:G(e,"x","argMax")},n={axis:t};return se.runKernel(Zg,r,n)}var Eh=ie({argMax_:v2e});function b2e(e,t=0){let r={x:G(e,"x","argMin")},n={axis:t};return se.runKernel(ex,r,n)}var OR=ie({argMin_:b2e});function w2e(e){let t={x:G(e,"x","asin")};return se.runKernel(Zh,t)}var PR=ie({asin_:w2e});function N2e(e){let t={x:G(e,"x","asinh")};return se.runKernel(ep,t)}var LR=ie({asinh_:N2e});function S2e(e){let t={x:G(e,"x","atan")};return se.runKernel(tp,t)}var zR=ie({atan_:S2e});function _2e(e,t){let r=G(e,"a","atan2"),n=G(t,"b","atan2");[r,n]=yn(r,n);let a={a:r,b:n};return se.runKernel(np,a)}var BR=ie({atan2_:_2e});function k2e(e){let t={x:G(e,"x","atanh")};return se.runKernel(rp,t)}var UR=ie({atanh_:k2e});function C2e(e,t,r,n,a="NHWC",s){let i=e[3],o=[...t,i],u=iK(a);return O0(e,o,r,s,n,null,null,u)}function aK(e,t,r,n,a,s,i="channelsLast"){let[o,u]=hb(t),d;if(i==="channelsLast")d=[o,u,e[3],e[3]];else if(i==="channelsFirst")d=[o,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${i}`);return O0(e,d,r,n,a,s,!1,i)}function I2e(e,t,r,n,a,s,i="NDHWC"){let[o,u,d]=RT(t),c,h;if(i==="NDHWC")h="channelsLast",c=[o,u,d,e[4],e[4]];else if(i==="NCDHW")h="channelsFirst",c=[o,u,d,e[1],e[1]];else throw new Error(`Unknown dataFormat ${i}`);return sK(e,c,r,n,a,!1,h,s)}function O0(e,t,r,n,a,s,i=!1,o="channelsLast"){let[u,d,c,h]=[-1,-1,-1,-1];if(o==="channelsLast")[u,d,c,h]=e;else if(o==="channelsFirst")[u,h,d,c]=e;else throw new Error(`Unknown dataFormat ${o}`);let[p,f,,g]=t,[m,x]=hb(r),[y,v]=hb(n),b=Tm(p,y),N=Tm(f,v),{padInfo:S,outHeight:_,outWidth:C}=j2e(a,d,c,m,x,b,N,s,o),k=i?g*h:g,I;return o==="channelsFirst"?I=[u,k,_,C]:o==="channelsLast"&&(I=[u,_,C,k]),{batchSize:u,dataFormat:o,inHeight:d,inWidth:c,inChannels:h,outHeight:_,outWidth:C,outChannels:k,padInfo:S,strideHeight:m,strideWidth:x,filterHeight:p,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:N,dilationHeight:y,dilationWidth:v,inShape:e,outShape:I,filterShape:t}}function sK(e,t,r,n,a,s=!1,i="channelsLast",o){let[u,d,c,h,p]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[u,d,c,h,p]=e;else if(i==="channelsFirst")[u,p,d,c,h]=e;else throw new Error(`Unknown dataFormat ${i}`);let[f,g,m,,x]=t,[y,v,b]=RT(r),[N,S,_]=RT(n),C=Tm(f,N),k=Tm(g,S),I=Tm(m,_),{padInfo:T,outDepth:j,outHeight:E,outWidth:O}=A2e(a,d,c,h,y,v,b,C,k,I,o),M=s?x*p:x,W;return i==="channelsFirst"?W=[u,M,j,E,O]:i==="channelsLast"&&(W=[u,j,E,O,M]),{batchSize:u,dataFormat:i,inDepth:d,inHeight:c,inWidth:h,inChannels:p,outDepth:j,outHeight:E,outWidth:O,outChannels:M,padInfo:T,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:f,filterHeight:g,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:k,effectiveFilterWidth:I,dilationDepth:N,dilationHeight:S,dilationWidth:_,inShape:e,outShape:W,filterShape:t}}function E2e(e,t,r,n,a){n==null&&(n=WR(e,t,r));let s=e[0],i=e[1],o=pb((s-t+2*n)/r+1,a),u=pb((i-t+2*n)/r+1,a);return[o,u]}function T2e(e,t,r,n,a,s){a==null&&(a=WR(e,t[0],n[0]));let i=[0,0,0,r];for(let o=0;o<3;o++)e[o]+2*a>=t[o]&&(i[o]=pb((e[o]-t[o]+2*a)/n[o]+1,s));return i}function WR(e,t,r,n=1){let a=Tm(t,n);return Math.floor((e[0]*(r-1)-r+a)/2)}function hb(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function RT(e){return typeof e=="number"?[e,e,e]:e}function Tm(e,t){return t<=1?e:e+(e-1)*(t-1)}function j2e(e,t,r,n,a,s,i,o,u){let d,c,h;if(typeof e=="number"){d={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};let p=E2e([t,r],s,n,e,o);c=p[0],h=p[1]}else if(e==="same"){c=Math.ceil(t/n),h=Math.ceil(r/a);let p=Math.max(0,(c-1)*n+s-t),f=Math.max(0,(h-1)*a+i-r),g=Math.floor(p/2),m=p-g,x=Math.floor(f/2),y=f-x;d={top:g,bottom:m,left:x,right:y,type:"SAME"}}else if(e==="valid")d={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-s+1)/n),h=Math.ceil((r-i+1)/a);else if(typeof e=="object"){let p=u==="channelsLast"?e[1][0]:e[2][0],f=u==="channelsLast"?e[1][1]:e[2][1],g=u==="channelsLast"?e[2][0]:e[3][0],m=u==="channelsLast"?e[2][1]:e[3][1];d={top:p,bottom:f,left:g,right:m,type:p===0&&f===0&&g===0&&m===0?"VALID":"EXPLICIT"},c=pb((t-s+p+f)/n+1,o),h=pb((r-i+g+m)/a+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outHeight:c,outWidth:h}}function A2e(e,t,r,n,a,s,i,o,u,d,c){let h,p,f,g;if(e==="valid"&&(e=0),typeof e=="number"){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};let m=T2e([t,r,n,1],[o,u,d],1,[a,s,i],e,c);p=m[0],f=m[1],g=m[2]}else if(e==="same"){p=Math.ceil(t/a),f=Math.ceil(r/s),g=Math.ceil(n/i);let m=(p-1)*a+o-t,x=(f-1)*s+u-r,y=(g-1)*i+d-n,v=Math.floor(m/2),b=m-v,N=Math.floor(x/2),S=x-N,_=Math.floor(y/2),C=y-_;h={top:N,bottom:S,left:_,right:C,front:v,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:h,outDepth:p,outHeight:f,outWidth:g}}function pb(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function jc(e){let[t,r,n]=hb(e);return t===1&&r===1&&n===1}function bl(e,t){return jc(e)||jc(t)}function Th(e){return hb(e).every(t=>t>0)}function iK(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function ns(e,t,r){if(r!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${r} but got pad ${t}.`);if(typeof t=="number")X(ig(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${r} but got pad ${t}.`);else if(typeof t=="object")t.forEach(n=>{n.forEach(a=>{X(ig(a),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${r} but got pad ${a}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}function $2e(e,t){let r={x:G(e,"x","reshape","string_or_numeric")},n={shape:t};return se.runKernel(Dx,r,n)}var ue=ie({reshape_:$2e});function R2e(e,t,r,n,a){let s=G(e,"x","avgPool","float32"),i=1;X(bl(r,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${i}'`);let o=s,u=!1;s.rank===3&&(u=!0,o=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),X(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),ns("avgPool",n,a);let d={x:o},c={filterSize:t,strides:r,pad:n,dimRoundingMode:a},h=se.runKernel(ap,d,c);return h=Pe(h,s.dtype),u?ue(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var hu=ie({avgPool_:R2e});function D2e(e,t,r,n,a,s="NDHWC"){let i=G(e,"x","avgPool3d","float32"),o=i,u=!1;i.rank===4&&(u=!0,o=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),X(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),X(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),X(typeof r=="number"&&r>0||Array.isArray(r)&&r[0]>0&&r[1]>0&&r[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${r}'`),ns("avgPool3d",n,a);let d={x:o},c={filterSize:t,strides:r,pad:n,dimRoundingMode:a,dataFormat:s},h=se.runKernel(tx,d,c);return h=Pe(h,o.dtype),u?ue(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var VR=ie({avgPool3d_:D2e});function M2e(e,t=0){X(e.length>=1,()=>"Pass at least one tensor to concat");let r=cb(e,"tensors","concat","string_or_numeric");if(r[0].dtype==="complex64"&&r.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),r.length===1)return il(r[0]);let n=r,a={axis:t};return se.runKernel(sx,n,a)}var zr=ie({concat_:M2e});function F2e(e,t,r=!1,n=!1){let a=G(e,"a","matMul"),s=G(t,"b","matMul");[a,s]=yn(a,s);let i={a,b:s},o={transposeA:r,transposeB:n};return se.runKernel(sp,i,o)}var Gt=ie({matMul_:F2e});function O2e(e){let t={x:G(e,"x","sigmoid","float32")};return se.runKernel(sf,t)}var Wi=ie({sigmoid_:O2e});function P2e(e,t,r){let n=G(e,"x","slice","string_or_numeric");if(n.rank===0)throw new Error("Slicing scalar is not possible");let a={x:n},s={begin:t,size:r};return se.runKernel(Bx,a,s)}var ir=ie({slice_:P2e});function L2e(e){let t={x:G(e,"x","tanh","float32")};return se.runKernel(ff,t)}var Ac=ie({tanh_:L2e});function z2e(e,t,r,n,a,s){let i=G(e,"forgetBias","basicLSTMCell"),o=G(t,"lstmKernel","basicLSTMCell"),u=G(r,"lstmBias","basicLSTMCell"),d=G(n,"data","basicLSTMCell"),c=G(a,"c","basicLSTMCell"),h=G(s,"h","basicLSTMCell"),p=zr([d,h],1),f=Gt(p,o),g=Ne(f,u),m=g.shape[0],x=g.shape[1]/4,y=[m,x],v=ir(g,[0,0],y),b=ir(g,[0,x],y),N=ir(g,[0,x*2],y),S=ir(g,[0,x*3],y),_=Ne(oe(Wi(v),Ac(b)),oe(c,Wi(Ne(i,N)))),C=oe(Ac(_),Wi(S));return[_,C]}var oK=ie({basicLSTMCell_:z2e});function B2e(e,t,r){let n=G(e,"x","batchToSpaceND"),a=t.reduce((o,u)=>o*u);X(n.rank>=1+t.length,()=>`input rank is ${n.rank} but should be > than blockShape.length ${t.length}`),X(r.length===t.length,()=>`crops.length is ${r.length} but should be equal to blockShape.length  ${t.length}`),X(n.shape[0]%a===0,()=>`input tensor batch is ${n.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${a}`);let s={x:n},i={blockShape:t,crops:r};return se.runKernel(rx,s,i)}var P0=ie({batchToSpaceND_:B2e});function U2e(e){let t;return e.rank===0||e.rank===1?t=ue(e,[1,1,1,e.size]):e.rank===2?t=ue(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=ue(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}function W2e(e,t,r,n,a,s){s==null&&(s=.001);let i=G(e,"x","batchNorm"),o=G(t,"mean","batchNorm"),u=G(r,"variance","batchNorm"),d;a!=null&&(d=G(a,"scale","batchNorm"));let c;n!=null&&(c=G(n,"offset","batchNorm")),X(o.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),X(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),X(d==null||o.rank===d.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let h={x:U2e(i),scale:d,offset:c,mean:o,variance:u},p={varianceEpsilon:s},f=se.runKernel(Sp,h,p);return ue(f,i.shape)}var mf=ie({batchNorm_:W2e});function V2e(e,t,r,n,a,s){let i=G(e,"x","batchNorm"),o=G(t,"mean","batchNorm"),u=G(r,"variance","batchNorm"),d;a!=null&&(d=G(a,"scale","batchNorm"));let c;return n!=null&&(c=G(n,"offset","batchNorm")),X(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),X(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),X(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),d!=null&&X(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${d.rank}.`),c!=null&&X(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),mf(i,o,u,c,d,s)}var HR=ie({batchNorm2d_:V2e});function H2e(e,t,r,n,a,s){let i=G(e,"x","batchNorm"),o=G(t,"mean","batchNorm"),u=G(r,"variance","batchNorm"),d;a!=null&&(d=G(a,"scale","batchNorm"));let c;return n!=null&&(c=G(n,"offset","batchNorm")),X(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),X(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),X(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),d!=null&&X(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${d.rank}.`),c!=null&&X(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),mf(i,o,u,c,d,s)}var qR=ie({batchNorm3d_:H2e});function q2e(e,t,r,n,a,s){let i=G(e,"x","batchNorm"),o=G(t,"mean","batchNorm"),u=G(r,"variance","batchNorm"),d;a!=null&&(d=G(a,"scale","batchNorm"));let c;return n!=null&&(c=G(n,"offset","batchNorm")),X(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),X(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),X(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),d!=null&&X(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${d.rank}.`),c!=null&&X(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),mf(i,o,u,c,d,s)}var GR=ie({batchNorm4d_:q2e});function G2e(e,t,r){let n=G(e,"x","bincount"),a=G(t,"weights","bincount");X(n.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${n.dtype}`),X(r>=0,()=>`size must be non-negative, but got ${r}.`),X(a.size===n.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${n.shape}, weights shape: ${a.shape}.`);let s={x:n,weights:a},i={size:r};return se.runKernel(nx,s,i)}var KR=ie({bincount_:G2e});function K2e(e,t){let r=G(e,"x","bitwiseAnd"),n=G(t,"y","bitwiseAnd");if(!cu(r.shape,n.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${r.shape}, y: ${n.shape}`);if(r.dtype!=="int32"||n.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${r.dtype} and type of y: ${n.dtype}`);let a={a:r,b:n};return se.runKernel(ax,a)}var lK=ie({bitwiseAnd_:K2e});function Q2e(e,t){let r=G(e,"s0","broadcastArgs","int32"),n=G(t,"s1","broadcastArgs","int32");if(r.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${r.rank}`);if(n.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${n.rank}`);let a={s0:r,s1:n};return se.runKernel(p0,a)}var uK=ie({broadcastArgs_:Q2e});function X2e(e,t){let r=G(e,"broadcastTo","x"),n=r.shape;if(ti(t),t.length<r.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${r.rank}.`);if(t.length>r.rank){let u=r.shape.slice();for(;u.length<t.length;)u.unshift(1);r=ue(r,u)}let a=r.shape,s=Array.from(t);for(let u=t.length-1;u>=0;u--)if(a[u]===t[u])s[u]=1;else if(r.shape[u]!==1)throw new Error(`broadcastTo(): [${n}] cannot be broadcast to [${t}].`);if(s.map((u,d)=>u>1?d:-1).filter(u=>u>=0).length===0)return il(r);let i={x:r},o={reps:s};return se.runKernel(Zc,i,o)}var eh=ie({broadcastTo_:X2e});function Y2e(e){let t={x:G(e,"x","ceil","float32")};return se.runKernel(op,t)}var QR=ie({ceil_:Y2e});function Qs(e,t,r){ti(e),r=r||c0(t);let n={shape:e,value:t,dtype:r};return se.runKernel(x0,{},n)}function J2e(e,t,r){let n=G(e,"x","clipByValue");if(X(t<=r,()=>`Error in clip: min (${t}) must be less than or equal to max (${r}).`),t===r)return Qs(n.shape,t,n.dtype);let a={x:n},s={clipValueMin:t,clipValueMax:r};return se.runKernel(Jc,a,s)}var Ma=ie({clipByValue_:J2e});function Z2e(e){return zr(e,0)}var XR=ie({concat1d_:Z2e});function eIe(e,t){return zr(e,t)}var YR=ie({concat2d_:eIe});function tIe(e,t){return zr(e,t)}var JR=ie({concat3d_:tIe});function rIe(e,t){return zr(e,t)}var ZR=ie({concat4d_:rIe});function nIe(e,t,r,n,a="NHWC",s=[1,1],i){let o=G(e,"x","conv2d","float32"),u=G(t,"filter","conv2d","float32"),d=o,c=!1;o.rank===3&&(c=!0,d=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]])),X(d.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${d.rank}.`),X(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),ns("conv2d",n,i);let h=a==="NHWC"?d.shape[3]:d.shape[1];X(h===u.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${u.shape[2]}.`),X(bl(r,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`),X(Th(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),X(Th(r),()=>"Error in conv2D: Strides should be larger than 0.");let p={x:d,filter:u},f={strides:r,pad:n,dataFormat:a,dilations:s,dimRoundingMode:i},g=se.runKernel(lp,p,f);return c?ue(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var Za=ie({conv2d_:nIe});function aIe(e,t,r,n,a="NWC",s=1,i){let o=G(e,"x","conv1d"),u=G(t,"filter","conv1d"),d=o,c=!1;o.rank===2&&(c=!0,d=ue(o,[1,o.shape[0],o.shape[1]])),X(d.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${d.rank}.`),X(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),ns("conv1d",n,i),X(d.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${d.shape[2]}) must match input depth for filter ${u.shape[1]}.`),X(bl(r,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${r} and dilation '${s}'`),X(Th(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),X(Th(r),()=>"Error in conv1D: Stride should be larger than 0."),X(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);let h=ue(u,[1,u.shape[0],u.shape[1],u.shape[2]]),p=ue(d,[d.shape[0],1,d.shape[1],d.shape[2]]),f=Za(p,h,[1,r],n,"NHWC",[1,s],i);return c?ue(f,[f.shape[2],f.shape[3]]):ue(f,[f.shape[0],f.shape[2],f.shape[3]])}var jk=ie({conv1d_:aIe});function sIe(e,t,r,n,a,s="NHWC",i){X(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,u=t,d=!1;t.rank===3&&(d=!0,u=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),X(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),X(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),X(r.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${r.rank}`);let c=s==="NHWC"?o[3]:o[1],h=s==="NHWC"?u.shape[3]:u.shape[1];X(c===r.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${r.shape[2]}.`),X(h===r.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${r.shape[3]}.`),ns("conv2dDerInput",a,i);let p={dy:u,filter:r},f={strides:n,pad:a,dataFormat:s,dimRoundingMode:i,inputShape:o},g=se.runKernel(up,p,f);return d?ue(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var eD=ie({conv2DBackpropInput_:sIe});function iIe(e,t,r,n,a,s){let i=G(e,"x","conv2dTranspose"),o=G(t,"filter","conv2dTranspose");return eD(r,i,o,n,a,"NHWC",s)}var Ak=ie({conv2dTranspose_:iIe});function oIe(e,t,r,n,a="NDHWC",s=[1,1,1]){let i=G(e,"x","conv3d"),o=G(t,"filter","conv3d"),u=i,d=!1;i.rank===4&&(d=!0,u=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),X(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),X(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),X(u.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${o.shape[3]}.`),X(bl(r,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`),X(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`),X(Th(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),X(Th(r),()=>"Error in conv3D: Strides should be larger than 0.");let c={x:u,filter:o},h={strides:r,pad:n,dataFormat:a,dilations:s},p=se.runKernel(cp,c,h);return d?ue(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var tD=ie({conv3d_:oIe});function lIe(e,t,r,n,a){X(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let s=e,i=t,o=!1;t.rank===4&&(o=!0,i=ue(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);let u=s[4],d=i.shape[4];X(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),X(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),X(r.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${r.rank}`),X(u===r.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${r.shape[3]}.`),X(d===r.shape[4],()=>`Error in conv3dDerInput: depth of output (${d}) must match output depth for filter ${r.shape[4]}.`);let c={dy:i,filter:r},h={pad:a,strides:n,inputShape:s},p=se.runKernel(ox,c,h);return o?ue(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var cK=ie({conv3DBackpropInput_:lIe});function uIe(e,t,r,n,a){let s=G(e,"x","conv3dTranspose"),i=G(t,"filter","conv3dTranspose");return cK(r,s,i,n,a)}var rD=ie({conv3dTranspose_:uIe});function cIe(e){let t={x:G(e,"x","cos","float32")};return se.runKernel(dp,t)}var L0=ie({cos_:cIe});function dIe(e){let t={x:G(e,"x","cosh","float32")};return se.runKernel(hp,t)}var $k=ie({cosh_:dIe});function hIe(e,t=0,r=!1,n=!1){let a={x:G(e,"x","cumprod")},s={axis:t,exclusive:r,reverse:n};return se.runKernel(lx,a,s)}var fb=ie({cumprod_:hIe});function pIe(e,t=0,r=!1,n=!1){let a={x:G(e,"x","cumsum")},s={axis:t,exclusive:r,reverse:n};return se.runKernel(pp,a,s)}var Rk=ie({cumsum_:pIe});function fIe(e,t,r,n=!1){let a=G(e,"x","denseBincount"),s=G(t,"weights","denseBincount");X(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),X(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),X(r>=0,()=>`size must be non-negative, but got ${r}.`),X(s.size===a.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${s.shape}.`);let i={x:a,weights:s},o={size:r,binaryOutput:n};return se.runKernel(m0,i,o)}var uS=ie({denseBincount_:fIe});function mIe(e,t,r="NHWC"){let n=G(e,"x","depthToSpace","float32"),a=r==="NHWC"?n.shape[1]:n.shape[2],s=r==="NHWC"?n.shape[2]:n.shape[3],i=r==="NHWC"?n.shape[3]:n.shape[1];X(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),X(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t}  for depthToSpace with input shape
    ${n.shape}`),X(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${t} for depthToSpace with input shape
        ${n.shape}`),X(i%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${i} for depthToSpace with input shape ${n.shape}`);let o={x:n},u={blockSize:t,dataFormat:r};return se.runKernel(cx,o,u)}var nD=ie({depthToSpace_:mIe});function gIe(e,t,r,n,a="NHWC",s=[1,1],i){let o=G(e,"x","depthwiseConv2d","float32"),u=G(t,"filter","depthwiseConv2d","float32"),d=o,c=!1;o.rank===3&&(c=!0,d=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]])),X(d.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),X(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);let h=a==="NHWC"?d.shape[3]:d.shape[1];X(h===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${u.shape[2]}.`),ns("depthwiseConv2d",n,i);let p={x:d,filter:u},f={strides:r,pad:n,dataFormat:a,dilations:s,dimRoundingMode:i},g=se.runKernel(fp,p,f);return c?ue(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var gf=ie({depthwiseConv2d_:gIe});function xIe(e){let t={x:G(e,"x","diag")};return se.runKernel(g0,t)}var dK=ie({diag_:xIe});function yIe(e,t,r,n,a=[1,1],s="NHWC"){let i=G(e,"x","dilation2d"),o=G(t,"filter","dilation2d");X(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),X(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),X(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let u=i,d=!1;i.rank===3&&(u=ue(i,[1,i.shape[0],i.shape[1],i.shape[2]]),d=!0),X(u.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${o.shape[2]}`);let c={x:u,filter:o},h={strides:r,pad:n,dilations:a},p=se.runKernel(mp,c,h);return d?ue(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var aD=ie({dilation2d_:yIe}),Jx={};Ut(Jx,{assertAndGetBroadcastShape:()=>Br,getBroadcastDims:()=>hK,getReductionAxes:()=>Vn});function hK(e,t){let r=e.length,n=[];for(let a=0;a<r;a++){let s=r-1-a,i=e[s]||1;(t[t.length-1-a]||1)>1&&i===1&&n.unshift(s)}return n}function Vn(e,t){let r=[];for(let n=0;n<t.length;n++){let a=e[e.length-n-1],s=t.length-n-1,i=t[s];(a==null||a===1&&i>1)&&r.unshift(s)}return r}function Br(e,t){let r=Math.max(e.length,t.length),n=new Array(r);for(let a=0;a<r;a++){let s=e[e.length-a-1];s==null&&(s=1);let i=t[t.length-a-1];if(i==null&&(i=1),s===1)n[r-a-1]=i;else if(i===1)n[r-a-1]=s;else if(s!==i){let o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else n[r-a-1]=s}return n}function vIe(e,t){let r=G(e,"a","equal","string_or_numeric"),n=G(t,"b","equal","string_or_numeric");[r,n]=yn(r,n),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(hx,a)}var Xs=ie({equal_:vIe});function bIe(e,t,r){let n=G(t,"a","where"),a=G(r,"b","where"),s=G(e,"condition","where","bool"),i=Br(Br(s.shape,n.shape),a.shape),o=eh(s,i),u=eh(n,i),d=eh(a,i),c={condition:o,t:u,e:d};return se.runKernel(zx,c)}var da=ie({where_:bIe});function wIe(e){let t={x:G(e,"x","zerosLike")};return se.runKernel(Xx,t)}var hr=ie({zerosLike_:wIe});function NIe(e,t){let r=G(e,"a","div"),n=G(t,"b","div");[r,n]=yn(r,n);let a=it(r,n),s=hr(a),i=Xs(n,s);return da(i,s,a)}var sD=ie({divNoNan_:NIe});function SIe(e,t){let r=G(e,"t1","dot"),n=G(t,"t2","dot");X((r.rank===1||r.rank===2)&&(n.rank===1||n.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${r.rank} and ${n.rank}.`);let a=r.rank===1?r.size:r.shape[1],s=n.rank===1?n.size:n.shape[0];if(X(a===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${s}.`),r.rank===1&&n.rank===1){let i=ue(r,[1,-1]),o=ue(n,[-1,1]),u=Gt(i,o);return ue(u,[])}else if(r.rank===1&&n.rank===2){let i=ue(r,[1,-1]),o=ue(n,[n.shape[0],n.shape[1]]),u=Gt(i,o);return ue(u,[u.size])}else if(r.rank===2&&n.rank===1){let i=ue(n,[-1,1]),o=Gt(r,i);return ue(o,[o.size])}else{let i=ue(n,[n.shape[0],n.shape[1]]);return Gt(r,i)}}var iD=ie({dot_:SIe});function _Ie(e,...t){let r=t.map((a,s)=>G(a,`tensors${s}`,"einsum")),n={equation:e};return se.runKernel(xk,r,n)}var Ed=ie({einsum_:_Ie});function kIe(e){let t={x:G(e,"x","elu","float32")};return se.runKernel(xp,t)}var Zx=ie({elu_:kIe});function CIe(e,t){let r=G(e,"x","ensureShape","string_or_numeric");if(!g7(r.shape,t))throw new Error(`EnsureShape: Shape of tensor ${r.shape} is not compatible with expected shape ${t}`);return e}var pK=ie({ensureShape_:CIe});function IIe(e){let t=G(e,"x","erf");X(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Pe(t,"float32"));let r={x:t};return se.runKernel(yp,r)}var Dk=ie({erf_:IIe});function oD(e,t){for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0}function fK(e,t,r){let n=e.length+t.length,a=[],s=0,i=0;for(let o=0;o<n;o++)r.indexOf(o)===-1?a.push(e[s++]):a.push(t[i++]);return a}function mK(e,t){let r=[],n=e.length;for(let s=0;s<n;s++)t.indexOf(s)===-1&&r.push(e[s]);let a=t.map(s=>e[s]);return[r,a]}function jh(e,t){let r=t.map(n=>1);return fK(e,r,t)}function EIe(e,t,r){X(oD(t,r),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${r} input.`)}function gK(e,t){if(oD(e,t))return null;let r=[];for(let n=0;n<t;++n)e.indexOf(n)===-1&&r.push(n);return e.forEach(n=>r.push(n)),r}function lD(e){return e.map((t,r)=>[r,t]).sort((t,r)=>t[1]-r[1]).map(t=>t[0])}function TIe(e,t){let r=[];for(let n=t-e;n<t;++n)r.push(n);return r}function jIe(e,t=null,r=!1){let n={x:G(e,"x","max")},a={reductionIndices:t,keepDims:r};return se.runKernel(Rp,n,a)}var fi=ie({max_:jIe});function AIe(e,t=null,r=!1){let n={x:G(e,"x","min")},a={axis:t,keepDims:r};return se.runKernel(Op,n,a)}var cg=ie({min_:AIe});function $Ie(e,t){let r=G(e,"base","pow"),n=G(t,"exp","pow");[r,n]=yn(r,n);let a={a:r,b:n};return se.runKernel(Vp,a)}var pl=ie({pow_:$Ie});function bt(e,t){if((oa(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&oa(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return td(e,[],[],t)}function RIe(e){let t={x:G(e,"x","sqrt","float32")};return se.runKernel(lf,t)}var ha=ie({sqrt_:RIe});function DIe(e){let t=G(e,"x","square"),r={};return se.runKernel("Square",{x:t},r)}var Pr=ie({square_:DIe});function MIe(e,t=null,r=!1){let n=G(e,"x","sum");n.dtype==="bool"&&(n=Pe(n,"int32"));let a={x:n},s={axis:t,keepDims:r};return se.runKernel(uf,a,s)}var ht=ie({sum_:MIe});function FIe(e,t="euclidean",r=null,n=!1){e=G(e,"x","norm");let a=xK(e,t,r),s=a.shape;if(n){let i=Ki(r,e.shape);s=jh(a.shape,i)}return ue(a,s)}function xK(e,t,r=null){if(e.rank===0)return Fn(e);if(e.rank!==1&&r===null)return xK(ue(e,[-1]),t,r);if(e.rank===1||typeof r=="number"||Array.isArray(r)&&r.length===1){if(t===1)return ht(Fn(e),r);if(t===1/0)return fi(Fn(e),r);if(t===-1/0)return cg(Fn(e),r);if(t==="euclidean"||t===2)return ha(ht(pl(Fn(e),bt(2,"int32")),r));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(r)&&r.length===2){if(t===1)return fi(ht(Fn(e),r[0]),r[1]-1);if(t===1/0)return fi(ht(Fn(e),r[1]),r[0]);if(t===-1/0)return cg(ht(Fn(e),r[1]),r[0]);if(t==="fro"||t==="euclidean")return ha(ht(Pr(e),r));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${r}`)}var ey=ie({norm_:FIe});function OIe(e,t=null,r=!1){return ey(e,"euclidean",t,r)}var uD=ie({euclideanNorm_:OIe});function PIe(e){let t={x:G(e,"x","exp")};return se.runKernel(vp,t)}var Fa=ie({exp_:PIe});function LIe(e,t=0){let r=G(e,"x","expandDims","string_or_numeric");X(t<=r.rank,()=>"Axis must be <= rank of the tensor");let n={input:r},a={dim:t};return se.runKernel(px,n,a)}var la=ie({expandDims_:LIe});function zIe(e){let t={x:G(e,"x","expm1")};return se.runKernel(bp,t)}var cD=ie({expm1_:zIe});function BIe(e,t){let r=G(e,"x","tile","string_or_numeric");X(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of reps ${t}.`);let n={x:r},a={reps:t};return se.runKernel(Zc,n,a)}var Us=ie({tile_:BIe});function UIe(e,t,r,n="float32"){t==null&&(t=e);let a=Qt([e,t],n),s=e<=t?e:t;for(let o=0;o<s;++o)a.set(1,o,o);let i=ue(a.toTensor(),[e,t]);if(r==null)return i;if(r.length===1)return Us(la(i,0),[r[0],1,1]);if(r.length===2)return Us(la(la(i,0),0),[r[0],r[1],1,1]);if(r.length===3)return Us(la(la(la(i,0),0),0),[r[0],r[1],r[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${r.length}D.`)}var Mk=ie({eye_:UIe});function WIe(e){let t={x:G(e,"x","floor","float32")};return se.runKernel(wp,t)}var ty=ie({floor_:WIe});function VIe(e,t,r=0,n=0){let a=G(e,"x","gather"),s=G(t,"indices","gather","int32"),i={x:a,indices:s},o={axis:r,batchDims:n};return se.runKernel(mx,i,o)}var ry=ie({gather_:VIe});function HIe(e,t){let r=G(e,"a","greater","string_or_numeric"),n=G(t,"b","greater","string_or_numeric");[r,n]=yn(r,n),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(xx,a)}var as=ie({greater_:HIe});function qIe(e,t){let r=G(e,"a","greaterEqual","string_or_numeric"),n=G(t,"b","greaterEqual","string_or_numeric");[r,n]=yn(r,n),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(_p,a)}var pu=ie({greaterEqual_:qIe});function GIe(e){let t={input:G(e,"input","imag")};return se.runKernel(bk,t)}var z0=ie({imag_:GIe});function KIe(e){let t={x:G(e,"x","isFinite")};return se.runKernel(Cp,t)}var dD=ie({isFinite_:KIe});function QIe(e){let t={x:G(e,"x","isInf")};return se.runKernel(Ip,t)}var hD=ie({isInf_:QIe});function XIe(e){let t={x:G(e,"x","isNaN")};return se.runKernel(Ep,t)}var pD=ie({isNaN_:XIe});function YIe(e,t=.2){let r={x:G(e,"x","leakyRelu")},n={alpha:t};return se.runKernel(Tp,r,n)}var B0=ie({leakyRelu_:YIe});function JIe(e,t){let r=G(e,"a","less","string_or_numeric"),n=G(t,"b","less","string_or_numeric");[r,n]=yn(r,n),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(yx,a)}var dg=ie({less_:JIe});function ZIe(e,t){let r=G(e,"a","lessEqual","string_or_numeric"),n=G(t,"b","lessEqual","string_or_numeric");[r,n]=yn(r,n),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(vx,a)}var rd=ie({lessEqual_:ZIe});function yK(e,t,r){if(r<=0)throw new Error("The number of values should be positive.");let n={start:e,stop:t,num:r};return se.runKernel(bx,{},n)}function eEe(e,t=5,r=1,n=1,a=.5){let s=G(e,"x","localResponseNormalization");X(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),X(ig(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let i=s,o=!1;s.rank===3&&(o=!0,i=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let u={x:i},d={depthRadius:t,bias:r,alpha:n,beta:a},c=se.runKernel($p,u,d);return o?ue(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var fD=ie({localResponseNormalization_:eEe});function tEe(e){let t={x:G(e,"x","log","float32")};return se.runKernel(jp,t)}var Ys=ie({log_:tEe});function rEe(e){let t={x:G(e,"x","log1p")};return se.runKernel(Ap,t)}var U0=ie({log1p_:rEe});function nEe(e){return X(Cc(e),()=>"The f passed in grad(f) must be a function"),(t,r)=>{let n=G(t,"x","tf.grad","string_or_numeric"),a=r!=null?G(r,"dy","tf.grad"):null;return se.tidy(()=>{let{value:s,grads:i}=se.gradients(()=>e(n),[n],a);return a!=null&&rs(s.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Fk(i),i[0]})}}function aEe(e){return X(Cc(e),()=>"The f passed in grads(f) must be a function"),(t,r)=>{X(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let n=cb(t,"args","tf.grads","string_or_numeric"),a=r!=null?G(r,"dy","tf.grads"):null;return se.tidy(()=>{let{value:s,grads:i}=se.gradients(()=>e(...n),n,a);return a!=null&&rs(s.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Fk(i),i})}}function sEe(e){return X(Cc(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,r)=>{X(t instanceof Jt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),X(r==null||r instanceof Jt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:n,value:a}=se.gradients(()=>e(t),[t],r);return Fk(n),{grad:n[0],value:a}}}function iEe(e){return X(Cc(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,r)=>{X(Array.isArray(t)&&t.every(a=>a instanceof Jt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),X(r==null||r instanceof Jt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let n=se.gradients(()=>e(...t),t,r);return r!=null&&rs(n.value.shape,r.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Fk(n.grads),n}}function vK(e,t){X(Cc(e),()=>"The f passed in variableGrads(f) must be a function"),X(t==null||Array.isArray(t)&&t.every(d=>d instanceof _h),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let r=t!=null;if(!r){t=[];for(let d in se.registeredVariables)t.push(se.registeredVariables[d])}let n=r?t.filter(d=>!d.trainable):null,a=t.length;t=t.filter(d=>d.trainable),X(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);let s=!0,{value:i,grads:o}=se.gradients(e,t,null,s);X(o.some(d=>d!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),X(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);let u={};return t.forEach((d,c)=>{o[c]!=null&&(u[d.name]=o[c])}),n!=null&&n.forEach(d=>u[d.name]=null),{value:i,grads:u}}function fl(e){return se.customGrad(e)}function Fk(e){if(e.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}function oEe(e){let t={x:G(e,"x","neg")};return se.runKernel(Ix,t)}var Jr=ie({neg_:oEe});function lEe(e){let t={x:G(e,"x","softplus")};return se.runKernel(of,t)}var xf=ie({softplus_:lEe});function uEe(e){let t=G(e,"x","logSigmoid");return fl(r=>({value:Jr(xf(Jr(r))),gradFunc:n=>oe(n,Wi(Jr(r)))}))(t)}var mD=ie({logSigmoid_:uEe});function cEe(e,t){let r=G(e,"a","sub"),n=G(t,"b","sub");[r,n]=yn(r,n);let a={a:r,b:n};return se.runKernel(hf,a)}var Ze=ie({sub_:cEe});function dEe(e,t=-1){let r=G(e,"logits","logSoftmax");if(t===-1&&(t=r.rank-1),t!==r.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${r.rank} and axis was ${t}`);return fl((n,a)=>{let s=fi(n,t,!0),i=Ze(n,s),o=Ze(Pe(i,"float32"),Ys(ht(Fa(i),t,!0)));return a([o]),{value:o,gradFunc:(u,d)=>{let[c]=d,h=!0,p=Fa(c);return Ze(u,oe(ht(u,t,h),p))}}})(r)}var Ok=ie({logSoftmax_:dEe});function hEe(e,t=null,r=!1){let n=G(e,"x","logSumExp"),a=Ki(t,n.shape),s=fi(n,a,!0),i=Ze(n,s),o=Fa(i),u=ht(o,a),d=Ys(u),c=Ne(ue(s,d.shape),d);if(r){let h=jh(c.shape,a);return ue(c,h)}return c}var W0=ie({logSumExp_:hEe});function pEe(e,t){let r=G(e,"a","logicalAnd","bool"),n=G(t,"b","logicalAnd","bool");Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(wx,a)}var qi=ie({logicalAnd_:pEe});function fEe(e){let t={x:G(e,"x","logicalNot","bool")};return se.runKernel(Nx,t)}var V0=ie({logicalNot_:fEe});function mEe(e,t){let r=G(e,"a","logicalOr","bool"),n=G(t,"b","logicalOr","bool");Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(Sx,a)}var Pk=ie({logicalOr_:mEe});function gEe(e,t){let r=G(e,"a","logicalXor","bool"),n=G(t,"b","logicalXor","bool");return Br(r.shape,n.shape),qi(Pk(e,t),V0(qi(e,t)))}var gD=ie({logicalXor_:gEe}),i1=2147483648;function xEe(e,t,r="left"){let n=G(e,"sortedSequence","searchSorted"),a=G(t,"values","searchSorted"),s=n.shape[n.shape.length-1],i=a.shape[a.shape.length-1],o=ue(n,[-1,s]),u=ue(a,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Ar(u.shape)>=i1)throw new Error(`values tensor size must less than ${i1}`);if(o.shape[1]>=i1)throw new Error(`trailing dim_size must less than ${i1} for int32 output type, was ${o.shape[1]}`);let d={sortedSequence:o,values:u},c={side:r};return se.runKernel(Lx,d,c)}var Lk=ie({searchSorted_:xEe});function bK(e,t){return Lk(e,t,"left")}function yEe(e,t,r,n,a){let s=G(e,"x","maxPool"),i=1,o=s,u=!1;s.rank===3&&(u=!0,o=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),X(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),X(bl(r,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${i}'`),ns("maxPool",n,a);let d={x:o},c={filterSize:t,strides:r,pad:n,dimRoundingMode:a},h=se.runKernel(Mp,d,c);return u?ue(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var na=ie({maxPool_:yEe});function vEe(e,t=[1,1,1],r,n,a,s="NDHWC"){let i=G(e,"x","maxPool3d"),o=i,u=!1;i.rank===4&&(u=!0,o=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),X(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),X(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),ns("maxPool3d",n,a);let d={x:o},c={filterSize:t,strides:r,pad:n,dimRoundingMode:a,dataFormat:s},h=se.runKernel(kx,d,c);return u?ue(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var xD=ie({maxPool3d_:vEe});function bEe(e,t,r,n,a=!1){let s={x:G(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:r,pad:n,includeBatchInIndex:a},o=se.runKernel(b0,s,i);return{result:o[0],indexes:o[1]}}var wK=ie({maxPoolWithArgmax_:bEe});function wEe(e,t){let r=G(e,"a","maximum"),n=G(t,"b","maximum");[r,n]=yn(r,n),r.dtype==="bool"&&(r=Pe(r,"int32"),n=Pe(n,"int32")),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(Dp,a)}var wl=ie({maximum_:wEe});function NEe(e,t=null,r=!1){let n={x:G(e,"x","mean")},a={axis:t,keepDims:r};return se.runKernel(Fp,n,a)}var mn=ie({mean_:NEe});function gn(e,t="float32"){if(ti(e),t==="complex64"){let n=gn(e,"float32"),a=gn(e,"float32");return su(n,a)}let r=ck(Ar(e),t);return se.makeTensor(r,e,t)}function fs(e,t="float32"){if(ti(e),t==="complex64"){let n=fs(e,"float32"),a=gn(e,"float32");return su(n,a)}let r=_R(Ar(e),t);return se.makeTensor(r,e,t)}function NK(e,t,{indexing:r="xy"}={}){if(r!=="xy"&&r!=="ij")throw new TypeError(`${r} is not a valid third argument to meshgrid`);if(e===void 0)return[];let n=G(e,"x","meshgrid",e instanceof Jt?e.dtype:"float32");if(t===void 0)return[n];let a=G(t,"y","meshgrid",t instanceof Jt?t.dtype:"float32"),s=Ar(n.shape),i=Ar(a.shape);return r==="xy"?(n=ue(n,[1,-1]),a=ue(a,[-1,1]),[Gt(fs([i,1],n.dtype),n),Gt(a,fs([1,s],a.dtype))]):(n=ue(n,[-1,1]),a=ue(a,[1,-1]),[Gt(n,fs([1,i],n.dtype)),Gt(fs([s,1],a.dtype),a)])}function SEe(e,t){let r=G(e,"a","minimum"),n=G(t,"b","minimum");[r,n]=yn(r,n),r.dtype==="bool"&&(r=Pe(r,"int32"),n=Pe(n,"int32")),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(Pp,a)}var $c=ie({minimum_:SEe});function _Ee(e,t,r){X(r==="reflect"||r==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${r}.`);let n=G(e,"x","mirrorPad");if(n.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");X(t.length===n.rank,()=>`Padding doesn't match input. Must be ${n.rank}. Got ${t.length}.`);let a=r==="reflect"?1:0;for(let o=0;o<n.rank;o++)X(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),X(t[o][0]>=0&&t[o][0]<=n.shape[o]-a&&t[o][1]>=0&&t[o][1]<=n.shape[o]-a,()=>`Padding in dimension ${o} cannot be greater than or equal to ${n.shape[o]-a} or less than 0 for input of shape ${n.shape}`);let s={paddings:t,mode:r},i={x:n};return se.runKernel(Lp,i,s)}var yD=ie({mirrorPad_:_Ee});function kEe(e,t){let r=G(e,"a","mod"),n=G(t,"b","mod");[r,n]=yn(r,n);let a={a:r,b:n};return se.runKernel(zp,a)}var vD=ie({mod_:kEe});function CEe(e,t=null,r=!1){e=G(e,"x","moments");let n=Ki(t,e.shape),a=mn(e,n,r),s=a.shape;r||(s=jh(a.shape,n));let i=Pr(Ze(Pe(e,"float32"),ue(a,s))),o=mn(i,n,r);return{mean:a,variance:o}}var H0=ie({moments_:CEe});function IEe(e,t,r,n){let a=G(t,"data","multiRNNCell"),s=cb(r,"c","multiRNNCell"),i=cb(n,"h","multiRNNCell"),o=a,u=[];for(let h=0;h<e.length;h++){let p=e[h](o,s[h],i[h]);u.push(p[0]),u.push(p[1]),o=p[1]}let d=[],c=[];for(let h=0;h<u.length;h+=2)d.push(u[h]),c.push(u[h+1]);return[d,c]}var SK=ie({multiRNNCell_:IEe});function EEe(e,t,r,n=!1){let a=G(e,"logits","multinomial"),s=a.size,i=a.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);r=r||Math.random();let o={logits:i===1?ue(a,[1,-1]):a},u={numSamples:t,seed:r,normalized:n},d=se.runKernel(Cx,o,u);return i===1?ue(d,[d.size]):d}var _K=ie({multinomial_:EEe});function TEe(e,t){let r=G(e,"a","notEqual","string_or_numeric"),n=G(t,"b","notEqual","string_or_numeric");[r,n]=yn(r,n),Br(r.shape,n.shape);let a={a:r,b:n};return se.runKernel(Ex,a)}var Ah=ie({notEqual_:TEe});function jEe(e,t,r=1,n=0,a="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let s={indices:G(e,"indices","oneHot","int32")},i={dtype:a,depth:t,onValue:r,offValue:n};return se.runKernel(Up,s,i)}var hg=ie({oneHot_:jEe});function AEe(e){let t={x:G(e,"x","onesLike")};return se.runKernel($x,t)}var Js=ie({onesLike_:AEe});function $Ee(e,t){let r=G(e,"v1","outerProduct"),n=G(t,"v2","outerProduct");X(r.rank===1&&n.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${r.rank} and ${n.rank}.`);let a=ue(r,[-1,1]),s=ue(n,[1,-1]);return Gt(a,s)}var kK=ie({outerProduct_:$Ee});function REe(e,t,r=0){let n=G(e,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let a={paddings:t,constantValue:r},s={x:n};return se.runKernel(Wp,s,a)}var Fo=ie({pad_:REe});function DEe(e,t,r=0){return X(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),Fo(e,[t],r)}var CK=ie({pad1d_:DEe});function MEe(e,t,r=0){return X(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fo(e,t,r)}var IK=ie({pad2d_:MEe});function FEe(e,t,r=0){return X(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fo(e,t,r)}var EK=ie({pad3d_:FEe});function OEe(e,t,r=0){return X(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fo(e,t,r)}var TK=ie({pad4d_:OEe});function PEe(e,t,r){let n=G(e,"x","spaceToBatchND");X(n.rank>=1+t.length,()=>`input rank ${n.rank} should be > than [blockShape] ${t.length}`),X(r.length===t.length,()=>`paddings.shape[0] ${r.length} must be equal to [blockShape] ${t.length}`),X(n.shape.reduce((i,o,u)=>u>0&&u<=t.length?i&&(o+r[u-1][0]+r[u-1][1])%t[u-1]===0:i,!0),()=>`input spatial dimensions ${n.shape.slice(1)} with paddings ${r.toString()} must be divisible by blockShapes ${t.toString()}`);let a={x:n},s={blockShape:t,paddings:r};return se.runKernel(Ux,a,s)}var q0=ie({spaceToBatchND_:PEe});function LEe(e,t,r,n,a,s,i){a==null&&(a=[1,1]),s==null&&(s=1),n===0&&(n="valid");let o=G(e,"x","maxPool"),u=o,d=!1;o.rank===3&&(d=!0,u=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]])),X(bl(s,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${a}'`);let c=aK(u.shape,t,s,a,n),h=[c.dilationHeight,c.dilationWidth],p;n==="same"?p=BEe([c.filterHeight,c.filterWidth],h):p=[[0,0],[0,0]];let f=h[0]===1&&h[1]===1,[g,m]=zEe([c.inHeight,c.inWidth],h,p),x=f?n:"valid",y=f?u:q0(u,h,g),v=(r==="avg"?()=>hu(y,t,s,x,i):()=>na(y,t,s,x,i))(),b=f?v:P0(v,h,m);return d?ue(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function zEe(e,t,r){let n=r.map(c=>c[0]),a=r.map(c=>c[1]),s=e.concat(n,a),i=t.map((c,h)=>(c-s[h]%c)%c),o=a.map((c,h)=>c+i[h]),u=t.map((c,h)=>[n[h],o[h]]),d=t.map((c,h)=>[0,i[h]]);return[u,d]}function BEe(e,t){let r=e.map((s,i)=>s+(s-1)*(t[i]-1)).map(s=>s-1),n=r.map(s=>Math.floor(s/2)),a=r.map((s,i)=>s-n[i]);return r.map((s,i)=>[n[i],a[i]])}var bD=ie({pool_:LEe});function UEe(e,t){let r=G(e,"x","prelu"),n=G(t,"alpha","prelu"),a={x:r,alpha:n};return se.runKernel(Hp,a)}var G0=ie({prelu_:UEe});function WEe(e,t=null,r=!1){let n=G(e,"x","prod");n.dtype==="bool"&&(n=Pe(n,"int32"));let a={x:n},s={axis:t,keepDims:r};return se.runKernel(qp,a,s)}var wD=ie({prod_:WEe});function VEe(e,t,r,n){let a=e.map((c,h)=>G(c,`tensors${h}`,"raggedGather","int32")),s=G(t,"paramsDenseValues","raggedGather"),i=G(r,"indices","raggedGather","int32"),o={paramsNestedSplits:a,paramsDenseValues:s,indices:i},u={outputRaggedRank:n},d=se.runKernel(wk,o,u);return{outputNestedSplits:d.slice(0,d.length-1),outputDenseValues:d[d.length-1]}}var jK=ie({raggedGather_:VEe});function HEe(e,t,r){let n=G(e,"starts","raggedRange"),a=G(t,"limits","raggedRange",n.dtype),s=G(r,"deltas","raggedRange",n.dtype),i={starts:n,limits:a,deltas:s},o=se.runKernel(Nk,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}var AK=ie({raggedRange_:HEe});function qEe(e,t,r,n,a){let s=G(e,"shape","raggedTensorToTensor","int32"),i=G(t,"values","raggedTensorToTensor"),o=G(r,"defaultValue","raggedTensorToTensor",i.dtype),u=n.map((h,p)=>G(h,`tensors${p}`,"raggedTensorToTensor","int32")),d={shape:s,values:i,defaultValue:o,rowPartitionTensors:u},c={rowPartitionTypes:a};return se.runKernel(Sk,d,c)}var $K=ie({raggedTensorToTensor_:qEe});function GEe(e,t,r){ti(e);let n=Ar(e),a=null;if(r==null||r==="float32")a=new Float32Array(n);else if(r==="int32")a=new Int32Array(n);else if(r==="bool")a=new Uint8Array(n);else throw new Error(`Unknown data type ${r}`);for(let s=0;s<n;s++)a[s]=t();return se.makeTensor(a,e,r)}var RK=ie({rand_:GEe}),ND=Xc(lk()),DK={};Ut(DK,{TEST_EPSILON_FLOAT16:()=>MK,createVideoElement:()=>tTe,encodeStrings:()=>FK,expectArrayBuffersEqual:()=>eTe,expectArraysClose:()=>QEe,expectArraysEqual:()=>YEe,expectNumbersClose:()=>JEe,expectPromiseToFail:()=>XEe,expectValuesInRange:()=>ZEe,play:()=>rTe,testEpsilon:()=>SD});var KEe=.001,MK=.1;function QEe(e,t,r){return r==null&&(r=SD()),DT(e,t,(n,a)=>_D(n,a,r))}function SD(){return se.backend.floatPrecision()===32?KEe:MK}function DT(e,t,r){let n=!0;if((oa(e)||oa(t))&&(n=!1),oa(e)&&oa(t)&&(n=!0),n){let i=e.constructor.name,o=t.constructor.name;if(i!==o)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${o}`)}if(Array.isArray(e)&&Array.isArray(t)){let i=hl(e),o=hl(t);if(!cu(i,o))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${o}]`)}let a=oa(e)?e:Ic(e),s=oa(t)?t:Ic(t);if(a.length!==s.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${s.length}.
Actual:   ${a}.
Expected: ${s}.`);for(let i=0;i<s.length;++i){let o=a[i],u=s[i];if(!r(o,u))throw new Error(`Arrays differ: actual[${i}] = ${o}, expected[${i}] = ${u}.
Actual:   ${a}.
Expected: ${s}.`)}typeof expect<"u"&&expect().nothing()}function XEe(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function YEe(e,t){let r=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return rc(e)||rc(e[0])||rc(t)||rc(t[0])?DT(e,r,(n,a)=>n==a):DT(e,t,(n,a)=>_D(n,a,0))}function JEe(e,t,r){if(r==null&&(r=SD()),!_D(e,t,r))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function _D(e,t,r){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>r)}function ZEe(e,t,r){for(let n=0;n<e.length;n++)if(e[n]<t||e[n]>r)throw new Error(`Value out of range:${e[n]} low: ${t}, high: ${r}`)}function eTe(e,t){let r=new Float32Array(e),n=new Float32Array(t);if(r.length!==n.length)throw new Error(`Expected ArrayBuffer to be of length ${n.length}, but it was ${r.length}`);for(let a=0;a<n.length;a++)if(r[a]!==n[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${n[a]} but got ${r[a]} instead`)}function FK(e){for(let t=0;t<e.length;t++){let r=e[t];Array.isArray(r)?FK(r):e[t]=D0(r)}return e}function tTe(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(r=>{t.addEventListener("loadeddata",n=>r(t)),t.load()})}async function rTe(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}var kD=class{constructor(e,t,r,n,a){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=n,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let s=a||Math.random();this.random=ND.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){let n=this.nextVal;return this.nextVal=NaN,n}let e,t,r=!1;for(;!r;){let n,a,s;do n=2*this.random()-1,a=2*this.random()-1,s=n*n+a*a;while(s>=1||s===0);let i=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*n*i,t=this.mean+this.stdDev*a*i,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},nTe=class{constructor(e,t,r,n){this.alpha=e,this.beta=1/t,this.dtype=r;let a=n||Math.random();this.randu=ND.alea(a.toString()),this.randn=new kD(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,r,n,a,s;for(;;){do n=this.randn.nextValue(),s=1+this.c*n;while(s<=0);if(s*=s*s,e=n*n,t=1-.331*e*e,r=.5*e+this.d*(1-s+Math.log(s)),a=this.randu(),a<t||Math.log(a)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}},aTe=class{constructor(e=0,t=1,r,n){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,n==null&&(n=Math.random()),typeof n=="number"&&(n=n.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=ND.alea(n)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function sTe(e,t,r=1,n="float32",a){if(ti(e),r==null&&(r=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error(`Unsupported data type ${n}`);let s=new nTe(t,r,n,a),i=Qt(e,n);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var OK=ie({randomGamma_:sTe});function iTe(e,t=0,r=1,n,a){if(ti(e),n!=null&&n==="bool")throw new Error(`Unsupported data type ${n}`);let s=new kD(t,r,n,!1,a),i=Qt(e,n);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var zk=ie({randomNormal_:iTe});function oTe(e,t,r){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return zk(e,0,1,t,r)}var PK=ie({randomStandardNormal_:oTe});function lTe(e,t=0,r=1,n="float32",a){ti(e);let s=Qt(e,n),i=new aTe(t,r,null,a);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var nd=ie({randomUniform_:lTe});function uTe(e,t,r,n){return nd(e,t,r,"int32",n)}var LK=ie({randomUniformInt_:uTe});function $h(e,t,r=1,n="float32"){if(r===0)throw new Error("Cannot have a step of zero");let a={start:e,stop:t,step:r,dtype:n};return se.runKernel(w0,{},a)}function cTe(e){let t={input:G(e,"input","real")};return se.runKernel(_k,t)}var pg=ie({real_:cTe});function dTe(e){let t={x:G(e,"x","reciprocal")};return se.runKernel(Gp,t)}var CD=ie({reciprocal_:dTe});function hTe(e){let t={x:G(e,"x","relu")};return se.runKernel(Kp,t)}var Tr=ie({relu_:hTe});function pTe(e){let t={x:G(e,"x","relu6")};return se.runKernel(Yp,t)}var Bk=ie({relu6_:pTe});function fTe(e,t){let r={x:G(e,"x","reverse")},n={dims:t};return se.runKernel(Jp,r,n)}var Si=ie({reverse_:fTe});function mTe(e){let t=G(e,"x","reverse");return X(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Si(t,0)}var zK=ie({reverse1d_:mTe});function gTe(e,t){let r=G(e,"x","reverse");return X(r.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${r.rank}.`),Si(r,t)}var BK=ie({reverse2d_:gTe});function xTe(e,t){let r=G(e,"x","reverse");return X(r.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${r.rank}.`),Si(r,t)}var UK=ie({reverse3d_:xTe});function yTe(e,t){let r=G(e,"x","reverse");return X(r.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${r.rank}.`),Si(r,t)}var WK=ie({reverse4d_:yTe});function vTe(e){let t={x:G(e,"x","round")};return se.runKernel(Zp,t)}var Uk=ie({round_:vTe});function bTe(e){let t={x:G(e,"x","rsqrt","float32")};return se.runKernel(ef,t)}var Wk=ie({rsqrt_:bTe});function wTe(e){let t={x:G(e,"x","selu")};return se.runKernel(tf,t)}var Vk=ie({selu_:wTe});function NTe(e,t,r,n,a,s=[1,1],i="NHWC"){let o=G(e,"x","separableConv2d"),u=G(t,"depthwiseFilter","separableConv2d"),d=G(r,"pointwiseFilter","separableConv2d"),c=o,h=!1;if(o.rank===3&&(h=!0,c=ue(o,[1,o.shape[0],o.shape[1],o.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");X(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),X(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),X(d.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),X(d.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${d.shape[0]}.`),X(d.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${d.shape[1]}.`);let p=u.shape[2],f=u.shape[3];X(d.shape[2]===p*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*f}, but got ${d.shape[2]}.`);let g=gf(c,u,n,a,i,s),m=Za(g,d,1,"valid",i);return h?ue(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var ny=ie({separableConv2d_:NTe});async function STe(e,t){let r=G(e,"x","setdiff1d"),n=G(t,"y","setdiff1d");X(r.dtype===n.dtype,()=>`x and y should have the same dtype, but got x (${r.dtype}) and y (${n.dtype}).`),X(r.rank===1,()=>`x should be 1D tensor, but got x (${r.shape}).`),X(n.rank===1,()=>`y should be 1D tensor, but got y (${n.shape}).`);let a=await r.data(),s=await n.data(),i=new Set(s),o=0;for(let c=0;c<a.length;c++)i.has(a[c])||o++;let u=new zn([o],r.dtype),d=new zn([o],"int32");for(let c=0,h=0;c<a.length;c++)i.has(a[c])||(u.values[h]=a[c],d.values[h]=c,h++);return[u.toTensor(),d.toTensor()]}var VK=STe;function _Te(e){let t={x:G(e,"x","sign")};return se.runKernel(af,t)}var ID=ie({sign_:_Te});function kTe(e){let t={x:G(e,"x","sin","float32")};return se.runKernel(rf,t)}var Hk=ie({sin_:kTe});function CTe(e){let t={x:G(e,"x","sinh")};return se.runKernel(nf,t)}var qk=ie({sinh_:CTe});function ITe(e,t,r){let n=G(e,"x","slice1d");return X(n.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${n.rank} tensor`),ir(n,[t],[r])}var K0=ie({slice1d_:ITe});function ETe(e,t,r){let n=G(e,"x","slice2d");return X(n.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${n.rank} tensor`),ir(n,t,r)}var Gk=ie({slice2d_:ETe});function TTe(e,t,r){let n=G(e,"x","slice3d");return X(n.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${n.rank} tensor`),ir(n,t,r)}var ay=ie({slice3d_:TTe});function jTe(e,t,r){let n=G(e,"x","slice4d");return X(n.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${n.rank} tensor`),ir(n,t,r)}var fg=ie({slice4d_:jTe});function ATe(e,t=-1){let r=G(e,"logits","softmax","float32");if(t===-1&&(t=r.rank-1),t!==r.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${r.rank} and dim was ${t}`);let n={logits:r},a={dim:t};return se.runKernel(cf,n,a)}var ad=ie({softmax_:ATe});function $Te(e){X(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);let t={input:e};return se.runKernel(yk,t)}var Q0=ie({fft_:$Te});function RTe(e){X(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);let t={input:e};return se.runKernel(vk,t)}var mg=ie({ifft_:RTe});function DTe(e){let t=e.shape[e.shape.length-1],r=e.size/t,n;if(t<=2){let a=ue(e,[r,t]);n=mg(a)}else{let a=[r,2*(t-1)],s=ue(pg(e),[r,t]),i=ue(z0(e),[r,t]),o=Si(ir(s,[0,1],[r,t-2]),1),u=oe(Si(ir(i,[0,1],[r,t-2]),1),bt(-1)),d=zr([s,o],1),c=zr([i,u],1),h=ue(su(d,c),[a[0],a[1]]);n=mg(h)}if(n=pg(n),e.rank===3&&e.shape[0]!==0){let a=n,s=e.shape[0];n=ue(n,[s,n.shape[0]/s,n.shape[1]]),a.dispose()}return n}var Kk=ie({irfft_:DTe});function MTe(e,t,r=0){let n={x:G(e,"x","split")},a={numOrSizeSplits:t,axis:r};return se.runKernel(Wx,n,a)}var gs=ie({split_:MTe});function FTe(e,t){X(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let r=e.shape[e.shape.length-1],n=e.size/r,a;if(t!=null&&t<r){let g=e.shape.map(x=>0),m=e.shape.map(x=>x);m[e.shape.length-1]=t,a=ir(e,g,m),r=t}else if(t!=null&&t>r){let g=e.shape.map(m=>m);g[e.shape.length-1]=t-r,a=zr([e,gn(g)],e.shape.length-1),r=t}else a=e;let s=hr(a),i=ue(su(a,s),[n,r]),o=Q0(i),u=Math.floor(r/2)+1,d=pg(o),c=z0(o),h=gs(d,[u,r-u],d.shape.length-1),p=gs(c,[u,r-u],c.shape.length-1),f=a.shape.slice();return f[a.shape.length-1]=u,ue(su(h[0],p[0]),f)}var X0=ie({rfft_:FTe});function OTe(e,t){let r=G(e,"a","squaredDifference"),n=G(t,"b","squaredDifference");[r,n]=yn(r,n),Br(r.shape,n.shape);let a={a:r,b:n},s={};return se.runKernel(df,a,s)}var Qk=ie({squaredDifference_:OTe});function PTe(e,t){let r=G(e,"x","squeeze","string_or_numeric");return ue(r,x7(r.shape,t).newShape)}var sd=ie({squeeze_:PTe});function LTe(e,t=0){let r=cb(e,"tensors","stack","string_or_numeric");X(r.length>=1,()=>"Pass at least one tensor to tf.stack"),r.length>0&&X(t<=r[0].rank,()=>"Axis must be <= rank of the tensor");let n=r,a={axis:t};return se.runKernel(Rx,n,a)}var Bn=ie({stack_:LTe});function zTe(e,t=0){let r={x:G(e,"x","step")},n={alpha:t};return se.runKernel(ed,r,n)}var yf=ie({step_:zTe});function BTe(e,t,r,n,a=0,s=0,i=0,o=0,u=0){let d={x:G(e,"x","stridedSlice","string_or_numeric")},c={begin:t,end:r,strides:n,beginMask:a,endMask:s,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:u};return se.runKernel(qx,d,c)}var ED=ie({stridedSlice_:BTe});function UTe(e){let t={x:G(e,"x","tan","float32")};return se.runKernel(pf,t)}var TD=ie({tan_:UTe});function Cr(e,t){Qh(e);let r=hl(e,t);if(r.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return td(e,null,r,t)}function ol(e,t,r){if(Qh(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let n=hl(e,r);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return td(e,t,n,r)}function Xk(e,t,r){if(Qh(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let n=hl(e,r);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return td(e,t,n,r)}function Rc(e,t,r){if(Qh(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let n=hl(e,r);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return td(e,t,n,r)}function HK(e,t,r){if(Qh(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let n=hl(e,r);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return td(e,t,n,r)}function qK(e,t,r){if(Qh(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let n=hl(e,r);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||n,td(e,t,n,r)}var Yk={};Ut(Yk,{calculateShapes:()=>GK,validateInput:()=>Jk,validateUpdateShape:()=>jD});function jD(e,t,r){let n=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${r.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${n}, and batchDim: ${a}.`;if(r.rank<a)throw new Error(s+` update.rank < ${a}. `);if(e.length<n+(r.rank-a))throw new Error(s+` Output shape length < ${n+(r.rank-a)}`);if(r.rank!==a+e.length-n)throw new Error(s+` update.rank != ${a+e.length-n}`);for(let i=0;i<a;++i)if(r.shape[i]!==t.shape[i])throw new Error(s+` updates.shape[${i}] (${r.shape[i]}) != indices.shape[${i}] (${t.shape[i]}).`);for(let i=0;i<r.rank-a;++i)if(r.shape[i+a]!==e[i+n])throw new Error(s+` updates.shape[${i+a}] (${r.shape[i+a]}) != shape[${i+a}] (${e[i+a]})`)}function Jk(e,t,r){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(r.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${r}`);if(r.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}jD(r,t,e)}function GK(e,t,r){let n=t.shape.length,a=n>1?t.shape[n-1]:1,s=r.length,i=1;for(let h=a;h<s;++h)i*=r[h];let o=a<1?1:a,u=Ar(t.shape)/o,d=[...Qg(r.slice(0,a)),1],c=Ar(r);return{sliceRank:a,numUpdates:u,sliceSize:i,strides:d,outputSize:c}}function WTe(e,t,r){let n=G(e,"tensor","tensorScatterupdate"),a=G(t,"indices","tensorScatterupdate","int32"),s=G(r,"updates","tensorScatterupdate");if(Jk(s,a,n.shape),n.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${n.dtype} and ${s.dtype}.`);let i={tensor:n,indices:a,updates:s},o={};return se.runKernel(Px,i,o)}var KK=ie({tensorScatterUpdate_:WTe});function VTe(e,t=1,r=!0){let n=G(e,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let a=n.shape[n.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${t}`);let s={x:n},i={k:t,sorted:r},[o,u]=se.runKernel(Gx,s,i);return{values:o,indices:u}}var AD=ie({topk_:VTe});function HTe(e,t=0,r=1,n,a){if(ti(e),n!=null&&n==="bool")throw new Error("Unsupported data type $ { dtype }");let s=new kD(t,r,n,!0,a),i=Qt(e,n);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var Zk=ie({truncatedNormal_:HTe});function qTe(e,t=0){let r=G(e,"x","unique","string_or_numeric");X(r.rank>0,()=>"The input tensor must be at least 1D");let n={x:r},a={axis:t},[s,i]=se.runKernel(j0,n,a);return{values:s,indices:i}}var $D=ie({unique_:qTe});function GTe(e,t,r){let n=G(e,"x","unsortedSegmentSum"),a=G(t,"segmentIds","unsortedSegmentSum","int32");X(ig(r),()=>"numSegments must be of dtype int");let s={x:n,segmentIds:a},i={numSegments:r};return se.runKernel(A0,s,i)}var eC=ie({unsortedSegmentSum_:GTe});function KTe(e,t=0){let r=G(e,"x","unstack","string_or_numeric");X(t>=-r.shape.length&&t<r.shape.length,()=>`Axis = ${t} is not in [-${r.shape.length}, ${r.shape.length})`);let n={value:r},a={axis:t};return se.runKernel(Qx,n,a)}var Cn=ie({unstack_:KTe});function QK(e,t){return Lk(e,t,"right")}function RD(e,t=!0,r,n){return se.makeVariable(e,t,r,n)}function XK(e,t){let r=[];for(let s=0;s<t.length;s++)t[s]&&r.push(s);let n=Qt(e,"int32"),a=Qt([r.length,e.length],"int32");for(let s=0;s<r.length;s++){let i=n.indexToLoc(r[s]),o=s*e.length;a.values.set(i,o)}return a.toTensor()}async function QTe(e){let t=G(e,"condition","whereAsync","bool"),r=await t.data(),n=XK(t.shape,r);return e!==t&&t.dispose(),n}var DD=QTe;async function XTe(e,t,r){let n=G(e,"tensor","boolMask"),a=G(t,"mask","boolMask","bool"),s=r??0,i=a.rank,o=n.shape;X(i>0,()=>"mask cannot be scalar"),rs(o.slice(s,s+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let m=s;m<s+i;m++)u*=o[m];let d=o.slice(0,s).concat([u],o.slice(s+i)),c=ue(n,d),h=ue(a,[-1]),p=await DD(h),f=sd(p,[1]),g=ry(c,f,s);return e!==n&&n.dispose(),t!==a&&a.dispose(),f.dispose(),c.dispose(),h.dispose(),p.dispose(),g}var YK=XTe;function YTe(e,t,r){let n=G(e,"x","transpose");if(t==null&&(t=n.shape.map((i,o)=>o).reverse()),X(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${t}.`),t.forEach(i=>{X(i>=0&&i<n.rank,()=>`All entries in 'perm' must be between 0 and ${n.rank-1} but got ${t}`)}),n.rank<=1)return n.clone();let a={x:n},s={perm:t};return n.dtype==="complex64"?ce(()=>{let i=pg(n),o=z0(n);return i=se.runKernel(Gl,{x:i},s),o=se.runKernel(Gl,{x:o},s),r&&(o=Jr(o)),su(i,o)}):se.runKernel(Gl,a,s)}var Kt=ie({transpose_:YTe});function JTe(e,t,r,n,a=!0){let s=G(e,"v","movingAverage"),i=G(t,"x","movingAverage"),o=G(r,"decay","movingAverage");O7(s,i),X(cu(s.shape,i.shape),()=>"Shape mismatch in v and x");let u=bt(1),d=Ze(u,o),c=oe(Ze(i,s),d);if(a){X(n!=null,()=>"When using zeroDebias: true, step is required.");let h=G(n,"step","movingAverage");c=it(c,Ze(u,pl(o,h)))}return Ne(s,c)}var JK=ie({movingAverage_:JTe});function ZTe(e,t,r){ti(r);let n=G(e,"indices","scatterND","int32"),a=G(t,"updates","scatterND");Jk(a,n,r);let s={indices:n,updates:a},i={shape:r};return se.runKernel(Ox,s,i)}var ZK=ie({scatterND_:ZTe});function eje(e,t,r,n){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);let a=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(r.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${r.length}, should be: ${s}.`);let i=t.size;if(!(t.rank===0||t.rank===1&&i===a))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${a}]`);if(t.dtype!==n.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function tje(e,t,r,n=0){ti(r);let a=G(e,"sparseIndices","sparseToDense","int32"),s=G(t,"sparseValues","sparseToDense","string_or_numeric"),i=G(n,"defaultValue","sparseToDense",s.dtype);eje(a,s,r,i);let o={sparseIndices:a,sparseValues:s,defaultValue:i},u={outputShape:r};return se.runKernel(Hx,o,u)}var eQ=ie({sparseToDense_:tje});function rje(e,t){let r=G(t,"indices","gatherND","int32"),n={params:G(e,"x","gatherND","string_or_numeric"),indices:r};return se.runKernel(gx,n)}var tQ=ie({gatherND_:rje});function nje(e,t){if(t==null)return e.shape.slice();if(cu(e.shape,t))return t;if(e.shape.length===t.length){let r=[];for(let n=0;n<e.shape.length;n++)t[n]==null&&e.shape[n]!=null?r.push(e.shape[n]):r.push(t[n]);return r}return t}function aje(e,t,r,n){let a=G(e,"x","dropout");if(X(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),X(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Jt?a.clone():a;let s=nje(a,r),i=1-t,o=it(ty(Ne(nd(s,0,1,"float32",n),i)),i);return oe(a,o)}var MD=ie({dropout_:aje});function FD(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function tC(e,t,r){let n=1-e%2,a=new Float32Array(e);for(let s=0;s<e;++s){let i=2*Math.PI*s/(e+n-1);a[s]=t-r*Math.cos(i)}return Cr(a,"float32")}async function sje(e,t,r=1){let n=G(e,"predictions","inTopK"),a=G(t,"targets","inTopK");X(n.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${n.rank}`),X(n.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${n.rank} and targets rank ${a.rank}`),rs(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let s=n.shape[n.shape.length-1];X(r>0&&r<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${r}`);let i=await n.data(),o=await a.data(),[u,d]=[i.length/s,s],c=y7("bool",u);for(let h=0;h<u;h++){let p=h*d,f=i.subarray(p,p+d),g=[];for(let m=0;m<f.length;m++)g.push({value:f[m],index:m});g.sort((m,x)=>x.value-m.value),c[h]=0;for(let m=0;m<r;m++)if(g[m].index===o[h]){c[h]=1;break}}return e!==n&&n.dispose(),t!==a&&a.dispose(),Qa(c,a.shape,"bool")}var rQ=sje,gg={};Ut(gg,{conv2d:()=>lje,depthwiseConv2d:()=>hje,matMul:()=>fje});function ije(e,t,r,n,a,s="NHWC",i){let o=e;e.rank===3&&(o=ue(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]])),X(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),X(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),X(r.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${r}.`);let d=s==="NHWC"?o.shape[3]:o.shape[1],c=s==="NHWC"?u.shape[3]:u.shape[1];X(d===r[2],()=>`Error in conv2dDerFilter: depth of input ${d}) must match input depth in filter (${r[2]}.`),X(c===r[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${r[3]}).`),ns("conv2dDerFilter",a,i);let h={x:o,dy:u},p={strides:n,pad:a,dataFormat:s,dimRoundingMode:i,filterShape:r};return se.runKernel(pk,h,p)}var OD=ie({conv2DBackpropFilter_:ije});function rC(e,t,r){if(r==null||r==="linear")return e;if(r==="relu")return oe(e,yf(t));throw new Error(`Cannot compute gradient for fused activation ${r}.`)}function nC(e,t){let r=t,n=Vn(e.shape,t.shape);return n.length>0&&(r=ht(r,n)),ue(r,e.shape)}function aC(e,t,r,n){if(t==="linear")return e;if(t==="relu")return Tr(e);if(t==="elu")return Zx(e);if(t==="relu6")return Bk(e);if(t==="prelu")return G0(e,r);if(t==="leakyrelu")return B0(e,n);if(t==="sigmoid")return Wi(e);throw new Error(`Unknown fused activation ${t}.`)}var sC=(e,t)=>!(e>0)||t==="linear";function oje({x:e,filter:t,strides:r,pad:n,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:o,activation:u="linear",preluActivationWeights:d,leakyreluAlpha:c}){if(u=u||"linear",sC(se.state.gradientDepth,u)===!1){X(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let _=Za(e,t,r,n,a,s,i);return o!=null&&(_=Ne(_,o)),aC(_,u,d,c)}let h=G(e,"x","conv2d","float32"),p=G(t,"filter","conv2d","float32"),f=h,g=!1;h.rank===3&&(g=!0,f=ue(h,[1,h.shape[0],h.shape[1],h.shape[2]])),X(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),X(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),ns("fused conv2d",n,i);let m=a==="NHWC"?f.shape[3]:f.shape[1];X(p.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${p.shape[2]}.`),X(bl(r,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`);let x=O0(f.shape,p.shape,r,s,n,i),y;o!=null&&(y=G(o,"bias","fused conv2d"),[y]=yn(y,h),a==="NHWC"?Br(x.outShape,y.shape):(X(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),X(y.shape.length===0||y.shape[0]===x.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let v;if(d!=null){let _=d.shape;if(X(_.length<=1||_.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${_.length}.`),_.length===1)X(_[0]===1||_[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the number of output channels (${x.outChannels}).`);else if(_.length===3)try{Br(_,x.outShape)}catch{let k=`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(k)}v=G(d,"prelu weights","fused conv2d")}let b=(_,C)=>{X(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);let[k,I,T,j]=C,E=rC(_,T,u);X(jc(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);let O=eD(I.shape,E,k,r,n),M=OD(I,E,k.shape,r,n),W=[O,M];if(j!=null){let q=nC(j,E);W.push(q)}return W},N={x:f,filter:p,bias:y,preluActivationWeights:v},S={strides:r,pad:n,dataFormat:a,dilations:s,dimRoundingMode:i,activation:u,leakyreluAlpha:c};return o==null?fl((_,C,k)=>{let I=se.runKernel(Nh,N,S);return k([C,_,I]),g&&(I=ue(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:b}})(f,p):fl((_,C,k,I)=>{let T=se.runKernel(Nh,N,S);return I([C,_,T,k]),g&&(T=ue(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:b}})(f,p,y)}var lje=ie({fusedConv2d_:oje});function uje(e,t,r,n,a,s=[1,1],i){let o=e;e.rank===3&&(o=ue(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let d={x:o,dy:u},c={strides:n,pad:a,dimRoundingMode:i,dilations:s,filterShape:r};return se.runKernel(fk,d,c)}var nQ=ie({depthwiseConv2dNativeBackpropFilter_:uje});function cje(e,t,r,n,a,s=[1,1],i){let o=t,u=!1;t.rank===3&&(u=!0,o=ue(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let d={dy:o,filter:r},c={strides:n,pad:a,dimRoundingMode:i,dilations:s,inputShape:e},h=se.runKernel(mk,d,c);return u?ue(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var aQ=ie({depthwiseConv2dNativeBackpropInput_:cje});function dje({x:e,filter:t,strides:r,pad:n,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:o,activation:u="linear",preluActivationWeights:d,leakyreluAlpha:c}){if(sC(se.state.gradientDepth,u)===!1){let S=gf(e,t,r,n,a,s,i);return o!=null&&(S=Ne(S,o)),aC(S,u,d,c)}let h=G(e,"x","depthwiseConv2d","float32"),p=G(t,"filter","depthwiseConv2d","float32"),f=h,g=!1;h.rank===3&&(g=!0,f=ue(h,[1,h.shape[0],h.shape[1],h.shape[2]])),X(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),X(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),X(f.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),s==null&&(s=[1,1]),X(bl(r,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`),ns("fused depthwiseConv2d",n,i);let m=O0(f.shape,p.shape,r,s,n,i,!0),x;o!=null&&(x=G(o,"bias","fused conv2d"),[x]=yn(x,h),Br(m.outShape,x.shape));let y;d!=null&&(y=G(d,"prelu weights","fused depthwiseConv2d"));let v=(S,_)=>{X(jc(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);let[C,k,I,T]=_,j=rC(S,I,u),E=aQ(k.shape,j,C,r,n,s,i),O=nQ(k,j,C.shape,r,n,s,i);if(T!=null){let M=nC(x,j);return[E,O,M]}return[E,O]},b={x:f,filter:p,bias:x,preluActivationWeights:y},N={strides:r,pad:n,dataFormat:a,dilations:s,dimRoundingMode:i,activation:u,leakyreluAlpha:c};return o==null?fl((S,_,C)=>{let k=se.runKernel(Sh,b,N);return C([_,S,k]),g&&(k=ue(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:v}})(f,p):fl((S,_,C,k)=>{let I=se.runKernel(Sh,b,N);return k([_,S,I,C]),g&&(I=ue(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:v}})(f,p,x)}var hje=ie({fusedDepthwiseConv2d_:dje});function pje({a:e,b:t,transposeA:r=!1,transposeB:n=!1,bias:a,activation:s="linear",preluActivationWeights:i,leakyreluAlpha:o=.2}){if(sC(se.state.gradientDepth,s)===!1){let T=Gt(e,t,r,n);return a!=null&&(T=Ne(T,a)),aC(T,s,i,o)}let u=G(e,"a","fused matMul"),d=G(t,"b","fused matMul");[u,d]=yn(u,d);let c=r?u.shape[u.rank-2]:u.shape[u.rank-1],h=n?d.shape[d.rank-1]:d.shape[d.rank-2],p=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=n?d.shape[d.rank-2]:d.shape[d.rank-1],g=u.shape.slice(0,-2),m=d.shape.slice(0,-2),x=Ar(g),y=Ar(m);X(c===h,()=>`Error in fused matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${u.shape} and ${d.shape} and transposeA=${r} and transposeB=${n} must match.`);let v=Br(u.shape.slice(0,-2),d.shape.slice(0,-2)).concat([p,f]),b=r?ue(u,[x,c,p]):ue(u,[x,p,c]),N=n?ue(d,[y,f,h]):ue(d,[y,h,f]),S;a!=null&&(S=G(a,"bias","fused matMul"),[S]=yn(S,u),Br(v,S.shape));let _;i!=null&&(_=G(i,"prelu weights","fused matMul"));let C=(T,j)=>{let[E,O,M,W]=j,q=rC(ue(T,M.shape),M,s),P,A;if(!r&&!n?(P=Gt(q,O,!1,!0),A=Gt(E,q,!0,!1)):!r&&n?(P=Gt(q,O,!1,!1),A=Gt(q,E,!0,!1)):r&&!n?(P=Gt(O,q,!1,!0),A=Gt(E,q,!1,!1)):(P=Gt(O,q,!0,!0),A=Gt(q,E,!0,!0)),a!=null){let L=nC(W,q);return[P,A,L]}else return[P,A]},k={a:b,b:N,bias:S,preluActivationWeights:_},I={transposeA:r,transposeB:n,activation:s,leakyreluAlpha:o};return a==null?fl((T,j,E)=>{let O=se.runKernel(wh,k,I);return E([T,j,O]),{value:ue(O,v),gradFunc:C}})(b,N):fl((T,j,E,O)=>{let M=se.runKernel(wh,k,I);return O([T,j,M,E]),{value:ue(M,v),gradFunc:C}})(b,N,S)}var fje=ie({fusedMatMul_:pje});function mje(e){return tC(e,.54,.46)}var gje=ie({hammingWindow_:mje});function xje(e){return tC(e,.5,.5)}var sQ=ie({hannWindow_:xje});function yje(e,t,r,n=!1,a=0){let s=0,i=[];for(;s+t<=e.size;)i.push(ir(e,s,t)),s+=r;if(n)for(;s<e.size;){let o=s+t-e.size,u=zr([ir(e,s,t-o),Qs([o],a)]);i.push(u),s+=r}return i.length===0?ol([],[0,t]):ue(zr(i),[i.length,t])}var iQ=ie({frame_:yje});function vje(e,t,r,n,a=sQ){n==null&&(n=FD(t));let s=iQ(e,t,r),i=oe(s,a(t));return X0(i,n)}var bje=ie({stft_:vje});function wje(e,t,r,n,a="bilinear",s=0){let i=G(e,"image","cropAndResize"),o=G(t,"boxes","cropAndResize","float32"),u=G(r,"boxInd","cropAndResize","int32"),d=o.shape[0];X(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),X(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${d},4] but had shape ${o.shape}.`),X(u.rank===1&&u.shape[0]===d,()=>`Error in cropAndResize: boxInd must be have size [${d}] but had shape ${o.shape}.`),X(n.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${n.length}.`),X(n[0]>=1&&n[1]>=1,()=>`cropSize must be atleast [1,1], but was ${n}`),X(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);let c={image:i,boxes:o,boxInd:u},h={method:a,extrapolationValue:s,cropSize:n};return se.runKernel(ux,c,h)}var Nje=ie({cropAndResize_:wje});function Sje(e){let t=G(e,"image","flipLeftRight","float32");X(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let r={image:t};return se.runKernel(fx,r,{})}var _je=ie({flipLeftRight_:Sje});function kje(e){let t=G(e,"image","grayscaleToRGB"),r=t.rank-1,n=t.shape[r];X(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),X(n===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${n}.`);let a=new Array(t.rank);return a.fill(1,0,r),a[r]=3,Us(t,a)}var Cje=ie({grayscaleToRGB_:kje});function Ije(e){let t=G(e,"image","RGBToGrayscale"),r=t.rank-1,n=t.shape[r];X(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),X(n===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${n}.`);let a=t.dtype,s=Pe(t,"float32"),i=Cr([.2989,.587,.114]),o;switch(t.rank){case 2:o=Ed("ij,j->i",s,i);break;case 3:o=Ed("ijk,k->ij",s,i);break;case 4:o=Ed("ijkl,l->ijk",s,i);break;case 5:o=Ed("ijklm,m->ijkl",s,i);break;case 6:o=Ed("ijklmn,n->ijklm",s,i);break;default:throw new Error("Not a valid tensor rank.")}return o=la(o,-1),Pe(o,a)}var Eje=ie({rgbToGrayscale_:Ije});function Tje(e,t,r=0,n=.5){let a=G(e,"image","rotateWithOffset","float32");X(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);let s={image:a},i={radians:t,fillValue:r,center:n};return se.runKernel(Yx,s,i)}var jje=ie({rotateWithOffset_:Tje});function sy(e,t,r,n,a,s){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),s==null&&(s=0);let i=e.shape[0];return r=Math.min(r,i),X(0<=n&&n<=1,()=>`iouThreshold must be in [0, 1], but was '${n}'`),X(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),X(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),X(t.rank===1,()=>"scores must be a 1D tensor"),X(t.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${t.shape[0]}`),X(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:r,iouThreshold:n,scoreThreshold:a,softNmsSigma:s}}function Aje(e,t,r,n=.5,a=Number.NEGATIVE_INFINITY){let s=G(e,"boxes","nonMaxSuppression","float32"),i=G(t,"scores","nonMaxSuppression","float32"),o=sy(s,i,r,n,a);r=o.maxOutputSize,n=o.iouThreshold,a=o.scoreThreshold;let u={maxOutputSize:r,iouThreshold:n,scoreThreshold:a};return se.runKernel(Tx,{boxes:s,scores:i},u)}var $je=ie({nonMaxSuppression_:Aje});function Rje(e,t,r){let n=Dje(e,t,r),a=n<0?-(n+1):n;e.splice(a,0,t)}function Dje(e,t,r){return Fje(e,t,r||Mje)}function Mje(e,t){return e>t?1:e<t?-1:0}function Fje(e,t,r){let n=0,a=e.length,s=0,i=!1;for(;n<a;){s=n+(a-n>>>1);let o=r(t,e[s]);o>0?n=s+1:(a=s,i=!o)}return i?n:-n-1}function oQ(e,t,r,n,a){return PD(e,t,r,n,a,0)}function lQ(e,t,r,n,a,s){return PD(e,t,r,n,a,0,!1,s,!0)}function uQ(e,t,r,n,a,s){return PD(e,t,r,n,a,s,!0)}function PD(e,t,r,n,a,s,i=!1,o=!1,u=!1){let d=[];for(let x=0;x<t.length;x++)t[x]>a&&d.push({score:t[x],boxIndex:x,suppressBeginIndex:0});d.sort(o4);let c=s>0?-.5/s:0,h=[],p=[];for(;h.length<r&&d.length>0;){let x=d.pop(),{score:y,boxIndex:v,suppressBeginIndex:b}=x;if(y<a)break;let N=!1;for(let S=h.length-1;S>=b;--S){let _=Oje(e,v,h[S]);if(_>=n){N=!0;break}if(x.score=x.score*Pje(n,c,_),x.score<=a)break}x.suppressBeginIndex=h.length,N||(x.score===y?(h.push(v),p.push(x.score)):x.score>a&&Rje(d,x,o4))}let f=h.length,g=r-f;o&&g>0&&(h.push(...new Array(g).fill(0)),p.push(...new Array(g).fill(0)));let m={selectedIndices:h};return i&&(m.selectedScores=p),u&&(m.validOutputs=f),m}function Oje(e,t,r){let n=e.subarray(t*4,t*4+4),a=e.subarray(r*4,r*4+4),s=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),o=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]),d=Math.min(a[0],a[2]),c=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),f=(o-s)*(u-i),g=(h-d)*(p-c);if(f<=0||g<=0)return 0;let m=Math.max(s,d),x=Math.max(i,c),y=Math.min(o,h),v=Math.min(u,p),b=Math.max(y-m,0)*Math.max(v-x,0);return b/(f+g-b)}function Pje(e,t,r){let n=Math.exp(t*r*r);return r<=e?n:0}function o4(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}async function Lje(e,t,r,n=.5,a=Number.NEGATIVE_INFINITY){let s=G(e,"boxes","nonMaxSuppressionAsync"),i=G(t,"scores","nonMaxSuppressionAsync"),o=sy(s,i,r,n,a);r=o.maxOutputSize,n=o.iouThreshold,a=o.scoreThreshold;let u=await Promise.all([s.data(),i.data()]),d=u[0],c=u[1],{selectedIndices:h}=oQ(d,c,r,n,a);return s!==e&&s.dispose(),i!==t&&i.dispose(),Cr(h,"int32")}var zje=Lje;function Bje(e,t,r,n=.5,a=Number.NEGATIVE_INFINITY,s=0){let i=G(e,"boxes","nonMaxSuppression"),o=G(t,"scores","nonMaxSuppression"),u=sy(i,o,r,n,a,s);r=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,s=u.softNmsSigma;let d={boxes:i,scores:o},c={maxOutputSize:r,iouThreshold:n,scoreThreshold:a,softNmsSigma:s},h=se.runKernel(Ax,d,c);return{selectedIndices:h[0],selectedScores:h[1]}}var Uje=ie({nonMaxSuppressionWithScore_:Bje});async function Wje(e,t,r,n=.5,a=Number.NEGATIVE_INFINITY,s=0){let i=G(e,"boxes","nonMaxSuppressionAsync"),o=G(t,"scores","nonMaxSuppressionAsync"),u=sy(i,o,r,n,a,s);r=u.maxOutputSize,n=u.iouThreshold,a=u.scoreThreshold,s=u.softNmsSigma;let d=await Promise.all([i.data(),o.data()]),c=d[0],h=d[1],{selectedIndices:p,selectedScores:f}=uQ(c,h,r,n,a,s);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:Cr(p,"int32"),selectedScores:Cr(f)}}var Vje=Wje;function Hje(e,t,r,n=.5,a=Number.NEGATIVE_INFINITY,s=!1){let i=G(e,"boxes","nonMaxSuppression"),o=G(t,"scores","nonMaxSuppression"),u=sy(i,o,r,n,a,null),d=u.maxOutputSize,c=u.iouThreshold,h=u.scoreThreshold,p={boxes:i,scores:o},f={maxOutputSize:d,iouThreshold:c,scoreThreshold:h,padToMaxOutputSize:s},g=se.runKernel(jx,p,f);return{selectedIndices:g[0],validOutputs:g[1]}}var qje=ie({nonMaxSuppressionPadded_:Hje});async function Gje(e,t,r,n=.5,a=Number.NEGATIVE_INFINITY,s=!1){let i=G(e,"boxes","nonMaxSuppressionAsync"),o=G(t,"scores","nonMaxSuppressionAsync"),u=sy(i,o,r,n,a,null),d=u.maxOutputSize,c=u.iouThreshold,h=u.scoreThreshold,[p,f]=await Promise.all([i.data(),o.data()]),{selectedIndices:g,validOutputs:m}=lQ(p,f,d,c,h,s);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:Cr(g,"int32"),validOutputs:bt(m,"int32")}}var Kje=Gje;function Qje(e,t,r=!1,n=!1){let a=G(e,"images","resizeBilinear");X(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),X(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),X(n===!1||r===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=a,i=!1;a.rank===3&&(i=!0,s=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:s},u={alignCorners:r,halfPixelCenters:n,size:t},d=se.runKernel(Xp,o,u);return i?ue(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var cQ=ie({resizeBilinear_:Qje});function Xje(e,t,r=!1,n=!1){let a=G(e,"images","resizeNearestNeighbor");X(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),X(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),X(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),X(n===!1||r===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=a,i=!1;a.rank===3&&(i=!0,s=ue(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:s},u={alignCorners:r,halfPixelCenters:n,size:t},d=se.runKernel(Qp,o,u);return i?ue(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var dQ=ie({resizeNearestNeighbor_:Xje});function Yje(e,t="binary",r=!1,n=.5){let a=G(e,"image","threshold"),s=.2989,i=.587,o=.114,u=a.shape[0]*a.shape[1],d=oe(Cr([n]),255),c,h,p,f;if(X(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),X(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),X(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),X(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),a.shape[2]===3){[c,h,p]=gs(a,[1,1,1],-1);let m=oe(c,s),x=oe(h,i),y=oe(p,o);f=Ne(Ne(m,x),y)}else f=e;if(t==="otsu"){let m=KR(Pe(Uk(f),"int32"),Qa([]),256);d=Jje(m,u)}let g=r?rd(f,d):as(f,d);return Pe(oe(g,255),"int32")}function Jje(e,t){let r=Cr([-1]),n=Cr([0]),a=Cr([0]),s,i,o,u,d,c;for(let h=0;h<e.size-1;h++){s=ir(e,0,h+1),i=ir(e,h+1),d=it(ht(s),t),c=it(ht(i),t);let p=ht(oe(s,$h(0,s.size)));o=it(p,ht(s));let f=Qs(i.shape,s.size),g=Ne($h(0,i.size),f),m=oe(i,g);u=it(ht(m),ht(i));let x=Ze(o,u),y=Ze(o,u),v=oe(d,c);a=oe(oe(v,x),y);let b=as(a,n);n=da(b,a,n),r=da(b,Cr([h]),r)}return r}var Zje=ie({threshold_:Yje});function eAe(e,t,r="nearest",n="constant",a=0,s){let i=G(e,"image","transform","float32"),o=G(t,"transforms","transform","float32");X(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),X(o.rank===2&&(o.shape[0]===i.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),X(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);let u={image:i,transforms:o},d={interpolation:r,fillMode:n,fillValue:a,outputShape:s};return se.runKernel(Kx,u,d)}var tAe=ie({transform_:eAe});function rAe(e,t,r){let n=G(e,"a","bandPart");X(n.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${n.rank}.`);let a=n.shape,[s,i]=n.shape.slice(-2),o,u;typeof t=="number"?(X(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),X(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),o=G(t<0?s:t,"numLower","bandPart")):(X(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=da(dg(t,0),s,$c(t,s))),typeof r=="number"?(X(r%1===0,()=>`bandPart(): numUpper must be an integer, got ${r}.`),X(r<=i,()=>`bandPart(): numUpper (${r}) must not be greater than the number of columns (${i}).`),u=G(r<0?i:r,"numUpper","bandPart")):(X(r.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=da(dg(r,0),i,$c(r,i)));let d=ue($h(0,s,1,"int32"),[-1,1]),c=$h(0,i,1,"int32"),h=Ze(d,c),p=qi(rd(h,o),pu(h,Jr(u))),f=gn([s,i],n.dtype);return ue(Bn(Cn(ue(n,[-1,s,i])).map(g=>da(p,g,f))),a)}var nAe=ie({bandPart_:rAe});function aAe(e){let t;if(Array.isArray(e)){t=!1,X(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let a=e[0].shape[0];for(let s=1;s<e.length;++s)X(e[s].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[s].shape[0]} vs. ${a})`)}else t=!0,e=gs(e,e.shape[0],0).map(a=>sd(a,[0]));X(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let r=[],n=e;for(let a=0;a<e.length;++a)r.push(se.tidy(()=>{let s=n[a];if(a>0)for(let i=0;i<a;++i){let o=oe(ht(oe(r[i],s)),r[i]);s=Ze(s,o)}return it(s,ey(s,"euclidean"))}));return t?Bn(r,0):r}var sAe=ie({gramSchmidt_:aAe});function iAe(e,t=!1){if(X(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return l4(e,t);{let r=e.shape.slice(0,e.shape.length-2).reduce((u,d)=>u*d),n=Cn(ue(e,[r,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],s=[];n.forEach(u=>{let[d,c]=l4(u,t);a.push(d),s.push(c)});let i=ue(Bn(a,0),e.shape),o=ue(Bn(s,0),e.shape);return[i,o]}}function l4(e,t=!1){return se.tidy(()=>{X(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let r=e.shape[0],n=e.shape[1],a=Mk(r),s=il(e),i=ol([[1]],[1,1]),o=il(i),u=r>=n?n:r;for(let d=0;d<u;++d){let c=s,h=o,p=a;[o,s,a]=se.tidy(()=>{let f=ir(s,[d,d],[r-d,1]),g=ey(f),m=ir(s,[d,d],[1,1]),x=da(as(m,0),ol([[-1]]),ol([[1]])),y=Ze(m,oe(x,g)),v=it(f,y);v.shape[0]===1?o=il(i):o=zr([i,ir(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);let b=Jr(it(Gt(x,y),g)),N=ir(s,[d,0],[r-d,n]),S=oe(b,o),_=Kt(o);if(d===0)s=Ze(N,Gt(S,Gt(_,N)));else{let I=Ze(N,Gt(S,Gt(_,N)));s=zr([ir(s,[0,0],[d,n]),I],0)}let C=Kt(S),k=ir(a,[0,d],[r,a.shape[1]-d]);if(d===0)a=Ze(k,Gt(Gt(k,o),C));else{let I=Ze(k,Gt(Gt(k,o),C));a=zr([ir(a,[0,0],[r,d]),I],1)}return[o,s,a]}),zt([c,h,p])}return!t&&r>n&&(a=ir(a,[0,0],[r,n]),s=ir(s,[0,0],[n,n])),[a,s]})}var oAe=ie({qr_:iAe}),Ga;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ga||(Ga={}));function lAe(e,t,r=Ga.SUM_BY_NONZERO_WEIGHTS){let n=G(e,"losses","computeWeightedLoss"),a=null;t!=null&&(a=G(t,"weights","computeWeightedLoss"));let s=a==null?n:oe(n,a);if(r===Ga.NONE)return s;if(r===Ga.SUM)return ht(s);if(r===Ga.MEAN){if(a==null)return mn(s);{let i=n.size/a.size,o=it(ht(s),ht(a));return i>1?it(o,bt(i)):o}}if(r===Ga.SUM_BY_NONZERO_WEIGHTS){if(a==null)return it(ht(s),bt(n.size));{let i=oe(a,fs(n.shape)),o=Pe(ht(Ah(i,bt(0))),"float32");return it(ht(s),o)}}throw Error(`Unknown reduction: ${r}`)}var fu=ie({computeWeightedLoss_:lAe});function uAe(e,t,r,n=Ga.SUM_BY_NONZERO_WEIGHTS){let a=G(e,"labels","absoluteDifference"),s=G(t,"predictions","absoluteDifference"),i=null;r!=null&&(i=G(r,"weights","absoluteDifference")),rs(a.shape,s.shape,"Error in absoluteDifference: ");let o=Fn(Ze(a,s));return fu(o,i,n)}var cAe=ie({absoluteDifference_:uAe});function dAe(e,t,r,n,a=Ga.SUM_BY_NONZERO_WEIGHTS){let s=G(e,"labels","cosineDistance"),i=G(t,"predictions","cosineDistance"),o=null;n!=null&&(o=G(n,"weights","cosineDistance")),rs(s.shape,i.shape,"Error in cosineDistance: ");let u=bt(1),d=Ze(u,ht(oe(s,i),r,!0));return fu(d,o,a)}var hAe=ie({cosineDistance_:dAe});function pAe(e,t,r,n=Ga.SUM_BY_NONZERO_WEIGHTS){let a=G(e,"labels","hingeLoss"),s=G(t,"predictions","hingeLoss"),i=null;r!=null&&(i=G(r,"weights","hingeLoss")),rs(a.shape,s.shape,"Error in hingeLoss: ");let o=bt(1);a=Ze(oe(bt(2),a),o);let u=Tr(Ze(o,oe(a,s)));return fu(u,i,n)}var fAe=ie({hingeLoss_:pAe});function mAe(e,t,r,n=1,a=Ga.SUM_BY_NONZERO_WEIGHTS){let s=G(e,"labels","huberLoss"),i=G(t,"predictions","huberLoss"),o=null;r!=null&&(o=G(r,"weights","huberLoss")),rs(s.shape,i.shape,"Error in huberLoss: ");let u=bt(n),d=Fn(Ze(i,s)),c=$c(d,u),h=Ze(d,c),p=Ne(oe(bt(.5),Pr(c)),oe(u,h));return fu(p,o,a)}var gAe=ie({huberLoss_:mAe});function xAe(e,t,r,n=1e-7,a=Ga.SUM_BY_NONZERO_WEIGHTS){let s=G(e,"labels","logLoss"),i=G(t,"predictions","logLoss"),o=null;r!=null&&(o=G(r,"weights","logLoss")),rs(s.shape,i.shape,"Error in logLoss: ");let u=bt(1),d=bt(n),c=Jr(oe(s,Ys(Ne(i,d)))),h=oe(Ze(u,s),Ys(Ne(Ze(u,i),d))),p=Ze(c,h);return fu(p,o,a)}var yAe=ie({logLoss_:xAe});function vAe(e,t,r,n=Ga.SUM_BY_NONZERO_WEIGHTS){let a=G(e,"labels","meanSquaredError"),s=G(t,"predictions","meanSquaredError"),i=null;r!=null&&(i=G(r,"weights","meanSquaredError")),rs(a.shape,s.shape,"Error in meanSquaredError: ");let o=Qk(a,s);return fu(o,i,n)}var bAe=ie({meanSquaredError_:vAe});function wAe(e,t){let r=G(e,"labels","sigmoidCrossEntropyWithLogits"),n=G(t,"logits","sigmoidCrossEntropyWithLogits");rs(r.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");let a=Tr(n),s=oe(n,r),i=U0(Fa(Jr(Fn(n))));return Ne(Ze(a,s),i)}function NAe(e,t,r,n=0,a=Ga.SUM_BY_NONZERO_WEIGHTS){let s=G(e,"multiClassLabels","sigmoidCrossEntropy"),i=G(t,"logits","sigmoidCrossEntropy"),o=null;if(r!=null&&(o=G(r,"weights","sigmoidCrossEntropy")),rs(s.shape,i.shape,"Error in sigmoidCrossEntropy: "),n>0){let d=bt(n),c=bt(1),h=bt(.5);s=Ne(oe(s,Ze(c,d)),oe(h,d))}let u=wAe(s,i);return fu(u,o,a)}var SAe=ie({sigmoidCrossEntropy_:NAe});function _Ae(e,t,r=-1){if(r===-1&&(r=t.rank-1),r!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${r}`);return fl((n,a,s)=>{let i=W0(a,[r],!0),o=Ze(Pe(a,"float32"),i);s([n,o]);let u=Jr(oe(o,n));return{value:ht(u,[r]),gradFunc:(d,c)=>{let[h,p]=c,f=jh(d.shape,[r]);return[oe(ue(d,f),Ze(Pe(h,"float32"),Fa(p))),oe(ue(d,f),Ze(Fa(p),Pe(h,"float32")))]}}})(e,t)}function kAe(e,t,r,n=0,a=Ga.SUM_BY_NONZERO_WEIGHTS){let s=G(e,"onehotLabels","softmaxCrossEntropy"),i=G(t,"logits","softmaxCrossEntropy"),o=null;if(r!=null&&(o=G(r,"weights","softmaxCrossEntropy")),rs(s.shape,i.shape,"Error in softmaxCrossEntropy: "),n>0){let d=bt(n),c=bt(1),h=bt(s.shape[1]);s=Ne(oe(s,Ze(c,d)),it(d,h))}let u=_Ae(s,i);return fu(u,o,a)}var CAe=ie({softmaxCrossEntropy_:kAe});function IAe(e,t,r,n){let a=G(e,"indices","sparseFillEmptyRows","int32"),s=G(t,"values","sparseFillEmptyRows"),i=G(r,"denseShape","sparseFillEmptyRows","int32"),o=G(n,"defaultValue","sparseFillEmptyRows",s.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);let u={indices:a,values:s,denseShape:i,defaultValue:o},d=se.runKernel(N0,u);return{outputIndices:d[0],outputValues:d[1],emptyRowIndicator:d[2],reverseIndexMap:d[3]}}var EAe=ie({sparseFillEmptyRows_:IAe});function TAe(e,t,r){let n=G(e,"inputIndices","sparseReshape","int32"),a=G(t,"inputShape","sparseReshape","int32"),s=G(r,"newShape","sparseReshape","int32");if(n.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${n.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);let i={inputIndices:n,inputShape:a,newShape:s},o=se.runKernel(Vx,i);return{outputIndices:o[0],outputShape:o[1]}}var jAe=ie({sparseReshape_:TAe});function AAe(e,t,r){let n=G(e,"data","sparseSegmentMean"),a=G(t,"indices","sparseSegmentMean","int32"),s=G(r,"segmentIds","sparseSegmentMean","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);let i={data:n,indices:a,segmentIds:s};return se.runKernel(S0,i)}var $Ae=ie({sparseSegmentMean_:AAe});function RAe(e,t,r){let n=G(e,"data","sparseSegmentSum"),a=G(t,"indices","sparseSegmentSum","int32"),s=G(r,"segmentIds","sparseSegmentSum","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);let i={data:n,indices:a,segmentIds:s};return se.runKernel(_0,i)}var DAe=ie({sparseSegmentSum_:RAe});function MAe(e,t,r,n,a,s,i,o){let u=G(e,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);let d=G(t,"dataSplits","stringNGrams");if(d.dtype!=="int32")throw new Error("Data splits must be of datatype int32");let c={separator:r,nGramWidths:n,leftPad:a,rightPad:s,padWidth:i,preserveShortSequences:o},h={data:u,dataSplits:d},p=se.runKernel(I0,h,c);return{nGrams:p[0],nGramsSplits:p[1]}}var FAe=ie({stringNGrams_:MAe});function OAe(e,t,r=!0){let n=G(e,"input","stringSplit","string"),a=G(t,"delimiter","stringSplit","string");if(n.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${n.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);let s={skipEmpty:r},i={input:n,delimiter:a},o=se.runKernel(E0,i,s);return{indices:o[0],values:o[1],shape:o[2]}}var PAe=ie({stringSplit_:OAe});function LAe(e,t){let r=G(e,"input","stringToHashBucketFast","string"),n={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let a={input:r};return se.runKernel(T0,a,n)}var zAe=ie({stringToHashBucketFast_:LAe});function BAe(e,t,r,n=!0){let a=G(e,"input","staticRegexReplace","string"),s={pattern:t,rewrite:r,replaceGlobal:n};return se.runKernel(C0,{x:a},s)}var UAe=ie({staticRegexReplace_:BAe}),hQ={fft:Q0,ifft:mg,rfft:X0,irfft:Kk},pQ={hammingWindow:gje,hannWindow:sQ,frame:iQ,stft:bje},li={flipLeftRight:_je,grayscaleToRGB:Cje,resizeNearestNeighbor:dQ,resizeBilinear:cQ,rgbToGrayscale:Eje,rotateWithOffset:jje,cropAndResize:Nje,nonMaxSuppression:$je,nonMaxSuppressionAsync:zje,nonMaxSuppressionWithScore:Uje,nonMaxSuppressionWithScoreAsync:Vje,nonMaxSuppressionPadded:qje,nonMaxSuppressionPaddedAsync:Kje,threshold:Zje,transform:tAe},LD={bandPart:nAe,gramSchmidt:sAe,qr:oAe},fQ={absoluteDifference:cAe,computeWeightedLoss:fu,cosineDistance:hAe,hingeLoss:fAe,huberLoss:gAe,logLoss:yAe,meanSquaredError:bAe,sigmoidCrossEntropy:SAe,softmaxCrossEntropy:CAe},mQ={sparseFillEmptyRows:EAe,sparseReshape:jAe,sparseSegmentMean:$Ae,sparseSegmentSum:DAe},gQ={stringNGrams:FAe,stringSplit:PAe,stringToHashBucketFast:zAe,staticRegexReplace:UAe},Re={};Ut(Re,{Serializable:()=>xQ,SerializationMap:()=>yQ,getRegisteredName:()=>VAe,registerClass:()=>vQ});var WAe=new Map,MT=new Map,xQ=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},yQ=class Yf{constructor(){this.classNameMap={}}static getMap(){return Yf.instance==null&&(Yf.instance=new Yf),Yf.instance}static register(t){Yf.getMap().classNameMap[t.className]=[t,t.fromConfig]}};function vQ(e,t,r){X(e.className!=null,()=>"Class being registered does not have the static className property defined."),X(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),X(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof r>"u"&&(r=e.className);let n=r,a=t+">"+n;return yQ.register(e),WAe.set(a,e),MT.set(e,a),e}function VAe(e){return MT.has(e)?MT.get(e):e.className}var mu=class extends xQ{minimize(e,t=!1,r){let{value:n,grads:a}=this.computeGradients(e,r);if(r!=null){let s=r.map(i=>({name:i.name,tensor:a[i.name]}));this.applyGradients(s)}else this.applyGradients(a);return zt(a),t?n:(n.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return vK(e,t)}dispose(){this.iterations_!=null&&zt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:bt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(mu,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});var zD=class extends mu{static get className(){return"Adadelta"}constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=se.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,r)=>{let n=se.registeredVariables[t],a=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${t}/accum_grad`,variable:ce(()=>hr(n).variable(a))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${t}/accum_var`,variable:ce(()=>hr(n).variable(a))});let s=Array.isArray(e)?e[r].tensor:e[t];if(s==null)return;let i=this.accumulatedGrads[r].variable,o=this.accumulatedUpdates[r].variable;ce(()=>{let u=Ne(oe(i,this.rho),oe(Pr(s),1-this.rho)),d=oe(it(ha(Ne(o,this.epsilon)),ha(Ne(i,this.epsilon))),s),c=Ne(oe(o,this.rho),oe(Pr(d),1-this.rho));i.assign(u),o.assign(c);let h=Ne(oe(d,-this.learningRate),n);n.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(zt(this.accumulatedGrads.map(e=>e.variable)),zt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(n=>({originalName:n.name,variable:n.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(n=>({originalName:n.name,variable:n.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},BD=class extends mu{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,r)=>{let n=se.registeredVariables[t];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${t}/accumulator`,variable:ce(()=>Qs(n.shape,this.initialAccumulatorValue).variable(!1))});let a=Array.isArray(e)?e[r].tensor:e[t];if(a==null)return;let s=this.accumulatedGrads[r].variable;ce(()=>{let i=Ne(s,Pr(a));s.assign(i);let o=Ne(oe(it(a,ha(Ne(i,se.backend.epsilon()))),-this.learningRate),n);n.assign(o)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&zt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},UD=class extends mu{static get className(){return"Adam"}constructor(e,t,r,n=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=n,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ce(()=>{this.accBeta1=bt(t).variable(),this.accBeta2=bt(r).variable()}),n==null&&(this.epsilon=se.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ce(()=>{let r=Ze(1,this.accBeta1),n=Ze(1,this.accBeta2);t.forEach((a,s)=>{let i=se.registeredVariables[a],o=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:ce(()=>hr(i).variable(o))}),this.accumulatedSecondMoment[s]==null&&(this.accumulatedSecondMoment[s]={originalName:`${a}/v`,variable:ce(()=>hr(i).variable(o))});let u=Array.isArray(e)?e[s].tensor:e[a];if(u==null)return;let d=this.accumulatedFirstMoment[s].variable,c=this.accumulatedSecondMoment[s].variable,h=Ne(oe(d,this.beta1),oe(u,1-this.beta1)),p=Ne(oe(c,this.beta2),oe(Pr(u),1-this.beta2)),f=it(h,r),g=it(p,n);d.assign(h),c.assign(p);let m=Ne(oe(it(f,Ne(ha(g),this.epsilon)),-this.learningRate),i);i.assign(m)}),this.accBeta1.assign(oe(this.accBeta1,this.beta1)),this.accBeta2.assign(oe(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&zt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&zt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),ce(()=>{this.accBeta1.assign(pl(this.beta1,this.iterations_+1)),this.accBeta2.assign(pl(this.beta2,this.iterations_+1))});let t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(n=>({originalName:n.name,variable:n.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(n=>({originalName:n.name,variable:n.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},WD=class extends mu{static get className(){return"Adamax"}constructor(e,t,r,n=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=n,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ce(()=>{this.iteration=bt(0).variable(),this.accBeta1=bt(t).variable()}),n==null&&(this.epsilon=se.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ce(()=>{let r=Ze(1,this.accBeta1),n=it(-this.learningRate,Ne(oe(this.iteration,this.decay),1));t.forEach((a,s)=>{let i=se.registeredVariables[a],o=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:hr(i).variable(o)}),this.accumulatedWeightedInfNorm[s]==null&&(this.accumulatedWeightedInfNorm[s]={originalName:`${a}/v`,variable:hr(i).variable(o)});let u=Array.isArray(e)?e[s].tensor:e[a];if(u==null)return;let d=this.accumulatedFirstMoment[s].variable,c=this.accumulatedWeightedInfNorm[s].variable,h=Ne(oe(d,this.beta1),oe(u,1-this.beta1)),p=oe(c,this.beta2),f=Fn(u),g=wl(p,f);d.assign(h),c.assign(g);let m=Ne(oe(it(n,r),it(h,Ne(g,this.epsilon))),i);i.assign(m)}),this.iteration.assign(Ne(this.iteration,1)),this.accBeta1.assign(oe(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&zt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&zt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},iC=class extends mu{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,r)=>{let n=Array.isArray(e)?e[r].tensor:e[t];if(n==null)return;let a=se.registeredVariables[t];ce(()=>{let s=Ne(oe(this.c,n),a);a.assign(s)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Qn(bt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},VD=class extends iC{static get className(){return"Momentum"}constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=bt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,r)=>{let n=se.registeredVariables[t];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${t}/momentum`,variable:ce(()=>hr(n).variable(!1))});let a=this.accumulations[r].variable,s=Array.isArray(e)?e[r].tensor:e[t];s!=null&&ce(()=>{let i,o=Ne(oe(this.m,a),s);this.useNesterov?i=Ne(oe(this.c,Ne(s,oe(o,this.m))),n):i=Ne(oe(this.c,o),n),a.assign(o),n.assign(i)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&zt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},HD=class extends mu{static get className(){return"RMSProp"}constructor(e,t=.9,r=0,n=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=n,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,n==null&&(this.epsilon=se.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,r)=>{let n=se.registeredVariables[t],a=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${t}/rms`,variable:ce(()=>hr(n).variable(a))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${t}/momentum`,variable:ce(()=>hr(n).variable(a))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${t}/mg`,variable:ce(()=>hr(n).variable(a))});let s=Array.isArray(e)?e[r].tensor:e[t];if(s==null)return;let i=this.accumulatedMeanSquares[r].variable,o=this.accumulatedMoments[r].variable;ce(()=>{let u=Ne(oe(i,this.decay),oe(Pr(s),1-this.decay));if(this.centered){let d=this.accumulatedMeanGrads[r].variable,c=Ne(oe(d,this.decay),oe(s,1-this.decay)),h=it(oe(s,this.learningRate),ha(Ze(u,Ne(Pr(c),this.epsilon)))),p=Ne(oe(o,this.momentum),h);i.assign(u),d.assign(c),o.assign(p);let f=Ze(n,p);n.assign(f)}else{let d=Ne(oe(i,this.decay),oe(Pr(s),1-this.decay)),c=Ne(oe(o,this.momentum),it(oe(s,this.learningRate),ha(Ne(d,this.epsilon))));i.assign(d),o.assign(c);let h=Ze(n,c);n.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&zt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&zt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&zt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(n=>({originalName:n.name,variable:n.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(n=>({originalName:n.name,variable:n.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(n=>({originalName:n.name,variable:n.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},HAe=[zD,BD,UD,WD,VD,HD,iC];function qAe(){for(let e of HAe)vQ(e)}var Na={};Ut(Na,{CompositeArrayBuffer:()=>du,browserFiles:()=>ZAe,browserHTTPRequest:()=>s$e,concatenateArrayBuffers:()=>RCe,copyModel:()=>t2e,decodeWeights:()=>H7,decodeWeightsStream:()=>G7,encodeWeights:()=>ICe,fromMemory:()=>o$e,fromMemorySync:()=>_Q,getLoadHandlers:()=>BCe,getModelArtifactsForJSON:()=>RR,getModelArtifactsForJSONSync:()=>Q7,getModelArtifactsInfoForJSON:()=>F0,getSaveHandlers:()=>zCe,getWeightSpecs:()=>TT,http:()=>GD,isHTTPScheme:()=>OT,listModels:()=>ZCe,loadWeights:()=>t$e,moveModel:()=>r2e,registerLoadRouter:()=>LCe,registerSaveRouter:()=>PCe,removeModel:()=>e2e,weightsLoaderFactory:()=>wQ,withSaveHandler:()=>l$e,withSaveHandlerSync:()=>u$e});var GAe="model",KAe=".json",QAe=".weights.bin";function u4(e){return new Promise(t=>setTimeout(t)).then(e)}var cS=class FT{constructor(t){if(!ge().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(FT.URL_SCHEME)&&(t=t.slice(FT.URL_SCHEME.length)),(t==null||t.length===0)&&(t=GAe),this.modelJsonFileName=t+KAe,this.weightDataFileName=t+QAe}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let r=du.join(t.weightData),n=window.URL.createObjectURL(new Blob([r],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let a=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],s=K7(t,a),i=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await u4(()=>o.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){let u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=n,await u4(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:F0(t)}}}};cS.URL_SCHEME="downloads://";var XAe=class{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let r=new FileReader;r.onload=n=>{let a=JSON.parse(n.target.result),s=a.modelTopology;if(s==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:s});return}let i=RR(a,o=>this.loadWeights(o));e(i)},r.onerror=n=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){let t=[],r=[];for(let s of e)t.push(...s.weights),r.push(...s.paths);let n=this.checkManifestAndWeightFiles(e),a=r.map(s=>this.loadWeightsFile(s,n[s]));return Promise.all(a).then(s=>[t,s])}loadWeightsFile(e,t){return new Promise((r,n)=>{let a=new FileReader;a.onload=s=>{let i=s.target.result;r(i)},a.onerror=s=>n(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],r=this.weightsFiles.map(a=>i4(a.name)),n={};for(let a of e)a.paths.forEach(s=>{let i=i4(s);if(t.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(t.push(i),r.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);n[s]=this.weightsFiles[r.indexOf(i)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return n}},YAe=e=>ge().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(cS.URL_SCHEME)?JAe(e.slice(cS.URL_SCHEME.length)):null;Ni.registerSaveRouter(YAe);function JAe(e="model"){return new cS(e)}function ZAe(e){return new XAe(e)}function c4(e,t,r,n){i(e),r=r??0,n=n??1,o(r,n);let a=0,s=u=>(u.then(d=>{let c=r+ ++a/e.length*(n-r);return t(c),d}),u);function i(u){X(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function o(u,d){X(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),X(d>=0&&d<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${d}`),X(d>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${d}`)}return Promise.all(e.map(s))}async function bQ(e,t){t==null&&(t={});let r=t.fetchFunc==null?ge().platform.fetch:t.fetchFunc,n=e.map(s=>r(s,t.requestInit,{isBinary:!0})),a=(t.onProgress==null?await Promise.all(n):await c4(n,t.onProgress,0,.5)).map(s=>s.arrayBuffer());return t.onProgress==null?await Promise.all(a):await c4(a,t.onProgress,.5,1)}function e$e(e,t){var r;let n=t.fetchFunc==null?ge().platform.fetch:t.fetchFunc,a=0,s;return(r=t.onProgress)===null||r===void 0||r.call(t,0),new ReadableStream({pull:async i=>{for(var o;a<e.length;){s||(s=(await n(e[a],t.requestInit,{isBinary:!0})).body.getReader());let{done:u,value:d}=await s.read();if(u){a++,s=void 0,(o=t.onProgress)===null||o===void 0||o.call(t,a/e.length);continue}i.enqueue(d);return}i.close()}})}async function t$e(e,t="",r,n){return wQ(a=>bQ(a,{requestInit:n}))(e,t,r)}function wQ(e){return async(t,r="",n)=>{let a=t.map(()=>!1),s={},i=n!=null?n.map(()=>!1):[],o=[];if(t.forEach((f,g)=>{let m=0;f.weights.forEach(x=>{let y="quantization"in x?x.quantization.dtype:x.dtype,v=kh[y]*Ar(x.shape),b=()=>{a[g]=!0,s[g]==null&&(s[g]=[]),s[g].push({manifestEntry:x,groupOffset:m,sizeBytes:v})};n!=null?n.forEach((N,S)=>{N===x.name&&(b(),i[S]=!0)}):b(),o.push(x.name),m+=v})}),!i.every(f=>f)){let f=n.filter((g,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}let u=a.reduce((f,g,m)=>(g&&f.push(m),f),[]),d=[];u.forEach(f=>{t[f].paths.forEach(g=>{let m=r+(r.endsWith("/")?"":"/")+g;d.push(m)})});let c=await e(d),h={},p=0;return u.forEach(f=>{let g=t[f].paths.length,m=new du(c.slice(p,p+g));s[f].forEach(x=>{let y=m.slice(x.groupOffset,x.groupOffset+x.sizeBytes),v=H7(y,[x.manifestEntry]);for(let b in v)h[b]=v[b]}),p+=g}),h}}var r$e="application/octet-stream",n$e="application/json",qD=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(X(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=ge().platform.fetch,X(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&X(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],n=K7(e,r);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:n$e}),"model.json"),e.weightData!=null){let s=du.join(e.weightData);t.body.append("model.weights.bin",new Blob([s],{type:r$e}),"model.weights.bin")}let a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:F0(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){let e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let s=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?s+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":s+=" Please make sure the server is serving valid JSON for this request.",new Error(s)}let r=t.modelTopology,n=t.weightsManifest;if(r==null&&n==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();let e=await this.loadModelJSON();return RR(e,t=>this.loadWeights(t))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),r=TT(e.weightsManifest),n=()=>e$e(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:n})}async getWeightUrls(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[r,n]=a$e(t),a=this.weightPathPrefix||r,s=[],i=[];for(let o of e)for(let u of o.paths)this.weightUrlConverter!=null?i.push(this.weightUrlConverter(u)):s.push(a+u+n);return this.weightUrlConverter&&s.push(...await Promise.all(i)),s}async loadWeights(e){let t=await this.getWeightUrls(e),r=TT(e),n=await bQ(t,this.loadOptions);return[r,n]}};qD.URL_SCHEME_REGEX=/^https?:\/\//;function a$e(e){let t=e.lastIndexOf("/"),r=e.lastIndexOf("?"),n=e.substring(0,t),a=r>t?e.substring(r):"";return[n+"/",a]}function OT(e){return e.match(qD.URL_SCHEME_REGEX)!=null}var NQ=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let r=!0;if(Array.isArray(e)?r=e.every(n=>OT(n)):r=OT(e),r)return GD(e,t)}return null};Ni.registerSaveRouter(NQ);Ni.registerLoadRouter(NQ);function GD(e,t){return new qD(e,t)}function s$e(e,t){return GD(e,t)}var rI=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},SQ=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},i$e=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function o$e(e,t,r,n){let a=arguments;return new i$e(_Q(...a))}function _Q(e,t,r,n){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new rI(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new rI({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new rI({modelTopology:e,weightSpecs:t,weightData:r,trainingConfig:n}))}function l$e(e){return new SQ(e)}function u$e(e){return new SQ(e)}var kQ={};Ut(kQ,{confusionMatrix:()=>d$e});function c$e(e,t,r){let n=G(e,"labels","confusionMatrix"),a=G(t,"predictions","confusionMatrix");X(r==null||r>0&&Number.isInteger(r),()=>`If provided, numClasses must be a positive integer, but got ${r}`),X(n.rank===1,()=>`Expected the rank of labels to be 1, but got ${n.rank}`),X(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),X(n.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${n.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),X(r>0&&Number.isInteger(r),()=>`numClasses is required to be a positive integer, but got ${r}`);let s=hg(Pe(n,"int32"),r),i=hg(Pe(a,"int32"),r),o=Kt(s),u=Gt(o,i);return Pe(u,"int32")}var d$e=ie({confusionMatrix_:c$e}),Y0={};Ut(Y0,{draw:()=>v$e,fromPixels:()=>b$e,fromPixelsAsync:()=>g$e,toPixels:()=>y$e});var xd,d4=!1;function CQ(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let r=!1,n=!1,a=!1,s=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)r=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)s=!0;else if(e.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(lb(iS,se.backendName)!=null){let p={pixels:e},f={numChannels:t};return se.runKernel(iS,p,f)}let[u,d]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],c;if(i)c=e.getContext("2d").getImageData(0,0,u,d).data;else if(n||r)c=e.data;else if(s||a||o){if(xd==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")xd=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else xd=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});xd.canvas.width=u,xd.canvas.height=d,xd.drawImage(e,0,0,u,d),c=xd.getImageData(0,0,u,d).data}let h;if(t===4)h=new Int32Array(c);else{let p=u*d;h=new Int32Array(p*t);for(let f=0;f<p;f++)for(let g=0;g<t;++g)h[f*t+g]=c[f*4+g]}return Xk(h,[d,u,t],"int32")}function h$e(e){return e!=null&&e.data instanceof Uint8Array}function p$e(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function f$e(e){return e!=null&&e.width!==0&&e.height!==0}function m$e(e){return p$e()&&!(e instanceof ImageBitmap)&&f$e(e)&&!h$e(e)}async function g$e(e,t=3){let r=null;if(ge().getBool("WRAP_TO_IMAGEBITMAP")&&m$e(e)){let n;try{n=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{n=null}n!=null&&n.width===e.width&&n.height===e.height?r=n:r=e}else r=e;return CQ(r,t)}function IQ(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function x$e(e){let t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function y$e(e,t){let r=G(e,"img","toPixels");if(!(e instanceof Jt)){let d=r;r=Pe(d,"int32"),d.dispose()}IQ(r);let[n,a]=r.shape.slice(0,2),s=r.rank===2?1:r.shape[2],i=await r.data(),o=r.dtype==="float32"?255:1,u=new Uint8ClampedArray(a*n*4);for(let d=0;d<n*a;++d){let c=[0,0,0,255];for(let p=0;p<s;p++){let f=i[d*s+p];if(r.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(r.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);s===1?(c[0]=f*o,c[1]=f*o,c[2]=f*o):c[p]=f*o}let h=d*4;u[h+0]=Math.round(c[0]),u[h+1]=Math.round(c[1]),u[h+2]=Math.round(c[2]),u[h+3]=Math.round(c[3])}if(t!=null){d4||lb(gk,se.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),d4=!0),t.width=a,t.height=n;let d=t.getContext("2d"),c=new ImageData(u,a,n);d.putImageData(c,0,0)}return r!==e&&r.dispose(),u}function v$e(e,t,r){let n=G(e,"img","draw");if(!(e instanceof Jt)){let i=n;n=Pe(i,"int32"),i.dispose()}IQ(n),x$e(r==null?void 0:r.imageOptions);let a={image:n},s={canvas:t,options:r};se.runKernel(gk,a,s)}var b$e=ie({fromPixels_:CQ}),KD={};Ut(KD,{prepareAndValidate:()=>EQ});function EQ(e,t){let r=e.shape.length,n=t.shape.length;if(r<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${r}.`);if(n<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${n}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[n-1]>r)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[n-1]} vs. ${r}`);if(Ar(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let a=t.shape,s=a[a.length-1],i=1;for(let h=0;h<a.length-1;++h)i*=a[h];let o=e.shape,u=a.slice();u.pop();let d=1;for(let h=s;h<r;++h)d*=o[h],u.push(o[h]);let c=[...Qg(e.shape).map(h=>h/d),1].slice(0,s);return[u,i,d,c]}var Yn={};Ut(Yn,{assertParamsValid:()=>N$e,computeFlatOffset:()=>I$e,computeOutShape:()=>_$e,getNormalizedAxes:()=>k$e,isSliceContinous:()=>C$e,maskToAxes:()=>S$e,parseSliceParams:()=>OQ,sliceInfo:()=>E$e,startForAxis:()=>MQ,startIndicesWithElidedDims:()=>$Q,stopForAxis:()=>FQ,stopIndicesWithElidedDims:()=>RQ,stridesForAxis:()=>DQ,stridesWithElidedDims:()=>TQ});var PT=-2,w$e=-1;function N$e(e,t,r){let n=e.shape.length;X(n===t.length,()=>`Error in slice${n}D: Length of begin ${t} must match the rank of the array (${n}).`),X(n===r.length,()=>`Error in slice${n}D: Length of size ${r} must match the rank of the array (${n}).`);for(let a=0;a<n;++a)X(t[a]+r[a]<=e.shape[a],()=>`Error in slice${n}D: begin[${a}] + size[${a}] (${t[a]+r[a]}) would overflow input.shape[${a}] (${e.shape[a]})`)}function S$e(e){let t=[],r=0;for(;e>0;)e&1&&t.push(r),e/=2,r++;return t}function _$e(e,t,r){let n=[];for(let a=0;a<e.length;a++)n[a]=Math.ceil((t[a]-e[a])/r[a]);return n}function TQ(e,t,r,n){let a=[...e];for(let s=a.length;s<n.length;s++)a.push(1);for(let s=0;s<r;s++)s===0?a[t]=1:(a.splice(t,0,1),a.pop());return a}function jQ(e,t,r){return r<=e?r:r-(t-1)}function AQ(e,t){let r=[];for(let n=0;n<e;n++)r.push(t+n);return r}function k$e(e,t,r,n,a,s,i,o,u){let d=e.length,c=new Array(d),h=new Array(d),p=new Array(d);if(t.length&&r>0){let f=t[0],g=r+1;c=$Q(i,f,g,n,e),h=RQ(o,f,g,a,e),p=TQ(s,f,g,e)}else for(let f=0;f<d;f++)c[f]=MQ(i,n,s,e,f,u),h[f]=FQ(o,a,s,e,f,u),p[f]=DQ(s,f,u);return{begin:c,end:h,strides:p}}function $Q(e,t,r,n,a){let s=[...a],i=AQ(r,t);for(let o=0;o<s.length;o++)if(i.indexOf(o)>-1)s[o]=0;else{let u=jQ(t,r,o),d=n[u];e&1<<u&&(d=0),s[o]=d}return s}function RQ(e,t,r,n,a){let s=[...a],i=AQ(r,t);for(let o=0;o<s.length;o++)if(i.indexOf(o)>-1)s[o]=Number.MAX_SAFE_INTEGER;else{let u=jQ(t,r,o),d=n[u];e&1<<u&&(d=Number.MAX_SAFE_INTEGER),s[o]=d}for(let o=0;o<s.length;o++){let u=a[o];s[o]<0&&(s[o]+=u),s[o]=ib(0,s[o],a[o])}return s}function DQ(e,t,r){let n=e[t];return(r&1<<t||n==null)&&(n=1),n}function MQ(e,t,r,n,a,s){let i=t[a],o=r[a]||1;(e&1<<a||s&1<<a||i==null)&&(o>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);let u=n[a];return i<0&&(i+=u),i=ib(0,i,u-1),i}function FQ(e,t,r,n,a,s){let i=t[a],o=r[a]||1;(e&1<<a||s&1<<a||i==null)&&(o>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);let u=n[a];return i<0&&(i+=u),o>0?i=ib(0,i,u):i=ib(-1,i,u-1),i}function C$e(e,t,r){let n=r.length;for(let a=0;a<r.length;a++)if(r[a]>1){n=a;break}for(let a=n+1;a<r.length;a++)if(t[a]>0||r[a]!==e[a])return!1;return!0}function I$e(e,t){let r=e.length>0?e[e.length-1]:1;for(let n=0;n<e.length-1;n++)r+=e[n]*t[n];return r}function OQ(e,t,r){let n,a=e.shape.length;typeof t=="number"?n=[t,...new Array(a-1).fill(0)]:t.length<a?n=t.concat(new Array(a-t.length).fill(0)):n=t.slice(),n.forEach(i=>{X(i!==-1,()=>"slice() does not support negative begin indexing.")});let s;return r==null?s=new Array(a).fill(-1):typeof r=="number"?s=[r,...new Array(a-1).fill(-1)]:r.length<a?s=r.concat(new Array(a-r.length).fill(-1)):s=r,s=s.map((i,o)=>i>=0?i:(X(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${o}.`),e.shape[o]-n[o])),[n,s]}function E$e(e,t,r,n,a,s,i,o,u){let d;if(n==null?(d=new Array(t.length),d.fill(1)):d=n,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1,h={dims:d.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:r.slice(),strides:d.slice(),beginMask:a,endMask:s,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:u};for(let v=0;v<h.dims;v++)c&&1<<v&o&&h.numAddAxisAfterEllipsis++,1<<v&i&&(c=!0);c||(h.ellipsisMask|=1<<h.dims,h.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};T$e(h,p);let f=!0,g=!0,m=!0,x=[],y=[];for(let v=0;v<e.length;++v){if(p.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);let b=!!(p.shrinkAxisMask&1<<v),N=e[v];if(N===-1){x.push(b?1:-1);continue}let S=[p.beginMask&1<<v,p.endMask&1<<v],_=[p.strides[v]>0?0:-1,p.strides[v]>0?N:N-1];if(b&&p.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&p.strides[v]===1;let C=!!(p.beginMask&1<<v&&p.endMask&1<<v);if(p.beginValid&&p.endValid){if(b){let j=p.begin[v]<0?N+p.begin[v]:p.begin[v];if(p.begin[v]=j,p.end[v]=p.begin[v]+1,j<0||j>=N)throw Error(`slice index ${p.begin[v]} of dimension ${v} out of bounds.`)}else p.begin[v]=h4(p.begin[v],0,p.strides[v],N,S,_),p.end[v]=h4(p.end[v],1,p.strides[v],N,S,_);let T=p.strides[v]===1&&p.begin[v]===0&&p.end[v]===N;f=f&&T,g=g&&(v===0&&p.strides[v]===1||T)}else f=f&&p.strides[v]===1&&C,g=g&&(v===0&&p.strides[v]===1||C);let k,I=!1;if(p.beginValid&&p.endValid?(k=p.end[v]-p.begin[v],I=!0):b?(k=1,I=!0):C&&N>=0&&(p.strides[v]<0?k=-N:k=N,I=!0),I){let T;k===0||k<0!=p.strides[v]<0?T=0:T=Math.trunc(k/p.strides[v])+(k%p.strides[v]!==0?1:0),x.push(T)}else x.push(-1)}for(let v=0;v<p.finalShapeGatherIndices.length;++v){let b=p.finalShapeGatherIndices[v];b>=0?y.push(x[b]):b===PT&&y.push(1)}return{finalShapeSparse:y.filter((v,b)=>p.finalShapeGatherIndices[b]!==PT),finalShape:y,isIdentity:f,sliceDim0:g,isSimpleSlice:m,begin:p.begin,end:p.end,strides:p.strides}}function T$e(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let r=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let n=0;n<e.dims;n++)if(1<<n&e.ellipsisMask){let a=Math.min(t.dims-(e.dims-n)+1+e.numAddAxisAfterEllipsis,t.dims);for(;r<a;r++)t.begin[r]=0,t.end[r]=0,t.strides[r]=1,t.beginMask|=1<<r,t.endMask|=1<<r,t.finalShapeGatherIndices.push(r),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[r]=n}else if(1<<n&e.newAxisMask)t.finalShapeGatherIndices.push(PT),t.finalShapeGatherIndicesSparse.push(-1);else{if(r===t.begin.length)throw Error(`Index out of range using input dim ${r}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[r]=e.begin[n]),e.end!=null&&(t.end[r]=e.end[n]),t.strides[r]=e.strides[n],e.beginMask&1<<n&&(t.beginMask|=1<<r),e.endMask&1<<n&&(t.endMask|=1<<r),e.shrinkAxisMask&1<<n?(t.finalShapeGatherIndices.push(w$e),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<r):(t.finalShapeGatherIndices.push(r),t.finalShapeGatherIndicesSparse.push(n)),t.inputShapeGatherIndicesSparse[r]=n,r++}}function h4(e,t,r,n,a,s){if(a[t])return r>0?s[t]:s[t+1&1];{let i=e<0?n+e:e;return i<s[0]?s[0]:i>s[1]?s[1]:i}}var j$e="4.22.0",PQ=class{static sgd(e){return new iC(e)}static momentum(e,t,r=!1){return new VD(e,t,r)}static rmsprop(e,t=.9,r=0,n=null,a=!1){return new HD(e,t,r,n,a)}static adam(e=.001,t=.9,r=.999,n=null){return new UD(e,t,r,n)}static adadelta(e=.001,t=.95,r=null){return new zD(e,t,r)}static adamax(e=.002,t=.9,r=.999,n=null,a=0){return new WD(e,t,r,n,a)}static adagrad(e,t=.1){return new BD(e,t)}},_d=PQ,A$e=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function QD(){return new Promise(e=>A$e(()=>e()))}var H={};Ut(H,{ERF_A1:()=>q$e,ERF_A2:()=>G$e,ERF_A3:()=>K$e,ERF_A4:()=>Q$e,ERF_A5:()=>X$e,ERF_P:()=>H$e,PARALLELIZE_THRESHOLD:()=>XD,RowPartitionType:()=>Ko,SELU_SCALE:()=>zQ,SELU_SCALEALPHA:()=>LQ,applyActivation:()=>aC,assertAndGetBroadcastShape:()=>Br,assertAxesAreInnerMostDims:()=>EIe,assertParamsConsistent:()=>$$e,assignToTypedArray:()=>rRe,axesAreInnerMostDims:()=>oD,calculateShapes:()=>GK,checkEinsumDimSizes:()=>lRe,checkPadOnDimRoundingMode:()=>ns,combineLocations:()=>fK,combineRaggedTensorToTensorShapes:()=>D$e,complexWithEvenIndex:()=>Z$e,complexWithOddIndex:()=>eRe,computeConv2DInfo:()=>O0,computeConv3DInfo:()=>sK,computeDefaultPad:()=>WR,computeDilation2DInfo:()=>C2e,computeOptimalWindowSize:()=>P$e,computeOutAndReduceShapes:()=>mK,computeOutShape:()=>R$e,computePool2DInfo:()=>aK,computePool3DInfo:()=>I2e,convertConv2DDataFormat:()=>iK,decodeEinsumEquation:()=>iRe,eitherStridesOrDilationsAreOne:()=>bl,expandShapeToKeepDim:()=>jh,exponent:()=>aRe,exponents:()=>nRe,fromStringArrayToUint8:()=>TRe,fromUint8ToStringArray:()=>ERe,getAxesPermutation:()=>gK,getBroadcastDims:()=>hK,getComplexWithIndex:()=>tRe,getEinsumComputePath:()=>uRe,getEinsumPermutation:()=>oRe,getFusedBiasGradient:()=>nC,getFusedDyActivation:()=>rC,getImageCenter:()=>L$e,getInnerMostAxes:()=>TIe,getPermuted:()=>B$e,getRaggedRank:()=>F$e,getReductionAxes:()=>Vn,getReshaped:()=>z$e,getReshapedPermuted:()=>U$e,getRowPartitionTypesHelper:()=>M$e,getSliceBeginCoords:()=>W$e,getSliceSize:()=>V$e,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>pRe,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>fRe,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>mRe,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>yRe,getSparseReshapeInputOutputMismatchErrorMessage:()=>bRe,getSparseReshapeInputOutputMultipleErrorMessage:()=>vRe,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>gRe,getSparseReshapeNegativeOutputDimErrorMessage:()=>xRe,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>_Re,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>wRe,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>NRe,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>SRe,getUndoAxesPermutation:()=>lD,isIdentityPermutation:()=>cRe,log:()=>Pke,mergeRealAndImagArrays:()=>Y$e,prepareAndValidate:()=>EQ,prepareSplitSize:()=>hRe,segment_util:()=>BQ,shouldFuse:()=>sC,slice_util:()=>Yn,splitRealAndImagArrays:()=>J$e,stridesOrDilationsArePositive:()=>Th,tupleValuesAreOne:()=>jc,upcastType:()=>wi,validateDefaultValueShape:()=>O$e,validateInput:()=>Jk,validateUpdateShape:()=>jD,warn:()=>Uu});function $$e(e,t){let r=e[0].length;e.forEach((a,s)=>{X(a.length===r,()=>`Error in concat${r}D: rank of tensors[${s}] must be the same as the rank of the rest (${r})`)}),X(t>=0&&t<r,()=>`Error in concat${r}D: axis must be between 0 and ${r-1}.`);let n=e[0];e.forEach((a,s)=>{for(let i=0;i<r;i++)X(i===t||a[i]===n[i],()=>`Error in concat${r}D: Shape of tensors[${s}] (${a}) does not match the shape of the rest (${n}) along the non-concatenated axis ${s}.`)})}function R$e(e,t){let r=e[0].slice();for(let n=1;n<e.length;n++)r[t]+=e[n][t];return r}var Ko;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(Ko||(Ko={}));function D$e(e,t,r){let n=new Array;if(r==null&&t==null)return n;if(t==null)for(;n.length<e+r.length;)n.push(-1);else n=t.slice();if(r==null)return n;if(e+r.length!==n.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+r.length}, but shape.rank = ${n.length}`);for(let a=1;a<r.length;++a){let s=r[a],i=n[n.length-r.length+a],o=n[i];if(s>=0)if(o>=0){if(o!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${a+e}] = ${s} but shape[${a+e}] = ${o}`)}else n[i]=s}return n}function M$e(e){let t={FIRST_DIM_SIZE:Ko.FIRST_DIM_SIZE,VALUE_ROWIDS:Ko.VALUE_ROWIDS,ROW_LENGTHS:Ko.ROW_LENGTHS,ROW_SPLITS:Ko.ROW_SPLITS,ROW_LIMITS:Ko.ROW_LIMITS,ROW_STARTS:Ko.ROW_STARTS},r=[];for(let n of e)if(n in t)r.push(t[n]);else break;return r}function F$e(e){return e.length===0?0:e[0]===Ko.FIRST_DIM_SIZE?e.length-1:e.length}function O$e(e,t){if(e==null||t==null)return;let r=e.length,n=t.length;if(r>=n)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${r} must be less than ragged tensor input flatValues.rank = ${n})`);for(let a=0;a<Math.min(r,n-1);++a){let s=e[a],i=t[a+1];if(s>=0&&i>=0&&s!==1&&s!==i)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${a-e.length}] = ${s} but ragged tensor input.flatValues.shape[${a-e.length}] = ${i}`)}}var XD=30;function P$e(e){return e<=XD?e:sS(e,Math.floor(Math.sqrt(e)))}function L$e(e,t,r){let n=r*(typeof e=="number"?e:e[0]),a=t*(typeof e=="number"?e:e[1]);return[n,a]}function z$e(e,t,r,n=!0){let a=[];if(n)a=a.concat(t.slice(0)),a.push(e[0]/r),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let s=t.length;for(let i=0;i<s;++i)a=a.concat([e[i+1]/t[i],t[i]]);a=a.concat(e.slice(s+1))}return a}function B$e(e,t,r=!0){let n=[];if(r){n.push(t);for(let a=t+1;a<e;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{let a=[],s=[];for(let i=1;i<e;++i)i>=t*2+1||i%2===1?s.push(i):a.push(i);n.push(...a),n.push(0),n.push(...s)}return n}function U$e(e,t,r,n=!0){let a=[];n?a.push(e[0]/r):a.push(e[0]*r);for(let s=1;s<e.length;++s)s<=t.length?n?a.push(t[s-1]*e[s]):a.push(e[s]/t[s-1]):a.push(e[s]);return a}function W$e(e,t){let r=[0];for(let n=0;n<t;++n)r.push(e[n][0]);return r}function V$e(e,t,r){let n=e.slice(0,1);for(let a=0;a<r;++a)n.push(e[a+1]-t[a][0]-t[a][1]);return n}var LQ=1.7580993408473768,zQ=1.0507009873554805,H$e=.3275911,q$e=.254829592,G$e=-.284496736,K$e=1.421413741,Q$e=-1.453152027,X$e=1.061405429;function Y$e(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let r=new Float32Array(e.length*2);for(let n=0;n<r.length;n+=2)r[n]=e[n/2],r[n+1]=t[n/2];return r}function J$e(e){let t=new Float32Array(e.length/2),r=new Float32Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=e[n],r[n/2]=e[n+1];return{real:t,imag:r}}function Z$e(e){let t=Math.ceil(e.length/4),r=new Float32Array(t),n=new Float32Array(t);for(let a=0;a<e.length;a+=4)r[Math.floor(a/4)]=e[a],n[Math.floor(a/4)]=e[a+1];return{real:r,imag:n}}function eRe(e){let t=Math.floor(e.length/4),r=new Float32Array(t),n=new Float32Array(t);for(let a=2;a<e.length;a+=4)r[Math.floor(a/4)]=e[a],n[Math.floor(a/4)]=e[a+1];return{real:r,imag:n}}function tRe(e,t){let r=e[t*2],n=e[t*2+1];return{real:r,imag:n}}function rRe(e,t,r,n){e[n*2]=t,e[n*2+1]=r}function nRe(e,t){let r=new Float32Array(e/2),n=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){let s=(t?2:-2)*Math.PI*(a/e);r[a]=Math.cos(s),n[a]=Math.sin(s)}return{real:r,imag:n}}function aRe(e,t,r){let n=(r?2:-2)*Math.PI*(e/t),a=Math.cos(n),s=Math.sin(n);return{real:a,imag:s}}var nI="->",sRe=/->/g,p4=",",f4="...";function iRe(e,t){e=e.replace(/\s/g,"");let r=(e.length-e.replace(sRe,"").length)/nI.length;if(r<1)throw new Error("Equations without an arrow are not supported.");if(r>1)throw new Error(`Equation must contain exactly one arrow ("${nI}").`);let[n,a]=e.split(nI);X(n.indexOf(f4)===-1,()=>`The ellipsis notation ("${f4}") is not supported yet.`);let s=n.split(p4),i=s.length;if(t!==i)throw new Error(`Expected ${i} input tensors, received ${t}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let p=0;p<a.length;++p){let f=a[p];if(!s.some(g=>g.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);o.indexOf(f)===-1&&o.push(f)}for(let p=0;p<n.length;++p){let f=n[p];o.indexOf(f)===-1&&f!==p4&&o.push(f)}let u=new Array(s.length);for(let p=0;p<i;++p){if(new Set(s[p].split("")).size!==s[p].length)throw new Error(`Found duplicate axes in input component ${s[p]}. Support for duplicate axes in input is not implemented yet.`);u[p]=[];for(let f=0;f<s[p].length;++f)u[p].push(o.indexOf(s[p][f]))}let d=o.length,c=a.length,h=[];for(let p=c;p<d;++p)h.push(p);return{allDims:o,summedDims:h,idDims:u}}function oRe(e,t){let r=new Array(e);r.fill(-1);for(let a=0;a<t.length;++a)r[t[a]]=a;let n=[];for(let a=0;a<e;++a)r[a]===-1&&n.push(a);return r=r.filter(a=>a!==-1),{permutationIndices:r,expandDims:n}}function lRe(e,t,r){let n=new Array(e);for(let a=0;a<r.length;++a){let s=r[a].shape;for(let i=0;i<t[a].length;++i)n[t[a][i]]===void 0?n[t[a][i]]=s[i]:X(n[t[a][i]]===s[i],()=>`Expected dimension ${n[t[a][i]]} at axis ${i} of input shaped ${JSON.stringify(s)}, but got dimension ${s[i]}`)}}function uRe(e,t){let r=e,n=[],a=0;e.length===0&&r.push(-1),a=e.length+1;for(let i=0;i<a;++i)n.push([]);let s=[];for(let i=0;i<r.length;++i){let o=r[i],u=dRe(t,o);for(let d of u)s.indexOf(d)===-1&&(n[i].push(d),s.push(d))}return{path:r,steps:n}}function cRe(e){return e.every((t,r)=>t===r)}function dRe(e,t){let r=[];for(let n=0;n<e.length;++n)(e[n].length===0||e[n].indexOf(t)!==-1||t===-1)&&r.push(n);return r}function hRe(e,t,r=0){let n=[];if(typeof t=="number")X(e.shape[r]%t===0,()=>"Number of splits must evenly divide the axis."),n=new Array(t).fill(e.shape[r]/t);else{let a=t.reduce((i,o)=>(o===-1&&(i+=1),i),0);X(a<=1,()=>"There should be only one negative value in split array.");let s=t.indexOf(-1);if(s!==-1){let i=t.reduce((o,u)=>u>0?o+u:o);t[s]=e.shape[r]-i}X(e.shape[r]===t.reduce((i,o)=>i+o),()=>"The sum of sizes must match the size of the axis dimension."),n=t}return n}function pRe(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function fRe(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function mRe(e,t,r){return`indices(${e}, 0) is invalid: ${t} >= ${r}`}function gRe(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function xRe(e,t){return`size ${e} must be non-negative, not ${t}`}function yRe(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function vRe(e,t){let r=Ar(e),n=Ar(t);return`Input to reshape is a SparseTensor with ${r}
  dense values, but the requested shape requires a multiple of ${n}. inputShape=${e} outputShape= ${t}`}function bRe(e,t){let r=Ar(e),n=Ar(t);return`Input to reshape is a tensor with ${r} dense values, but the requested shape has ${n}. inputShape=${e} outputShape=${t}`}function wRe(){return"segment ids must be >= 0"}function NRe(){return"segment ids are not increasing"}function SRe(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function _Re(e,t,r){return`Bad: indices[${e}] == ${t} out of range [0, ${r})`}var BQ={};Ut(BQ,{collectGatherOpShapeInfo:()=>IRe,computeOutShape:()=>CRe,segOpComputeOptimalWindowSize:()=>kRe});function kRe(e,t){let r=!1,n;for(e<=XD?(n=e,r=!0):n=sS(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=sS(e,n+1);return n}function CRe(e,t,r){let n=[],a=e.length;for(let s=0;s<a;s++)s!==t?n.push(e[s]):n.push(r);return n}function IRe(e,t,r,n){let a=t.shape.length,s=e.shape.length;if(n!==0&&(n<-a||n>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${n}`);if(n<0&&(n+=a),n>s)throw new Error(`batchDims (${n}) must be less than rank(x) (
    ${s}).`);if(r<n)throw new Error(`batchDims (${n}) must be less than or equal to axis (${r}).`);for(let h=0;h<n;++h)if(e.shape[h]!==t.shape[h])throw new Error(`x.shape[${h}]: ${e.shape[h]} should be equal to indices.shape[${h}]: ${t.shape[h]}.`);let i=e.shape[r],o=[],u=1,d=1,c=1;for(let h=0;h<n;++h)o.push(e.shape[h]),u*=e.shape[h];for(let h=n;h<r;h++)o.push(e.shape[h]),d*=e.shape[h];for(let h=n;h<a;h++)o.push(t.shape[h]);for(let h=r+1;h<s;h++)o.push(e.shape[h]),c*=e.shape[h];return{batchSize:u,sliceSize:c,outerSize:d,dimSize:i,outputShape:o}}function ERe(e){try{return e.map(t=>lS(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function TRe(e){return e.map(t=>D0(t))}var Nl={};Ut(Nl,{nonMaxSuppressionV3Impl:()=>oQ,nonMaxSuppressionV4Impl:()=>lQ,nonMaxSuppressionV5Impl:()=>uQ,whereImpl:()=>XK});qAe();var UQ={kernelName:Xg,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(e,yf(Pe(r,"float32"),-1))}}},jRe={kernelName:Xh,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>{let n=Pr(Pe(r,"float32")),a=ha(Ze(bt(1),n));return Jr(it(e,a))}}}},ARe={kernelName:Yh,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>{let n=ha(Ze(Pr(Pe(r,"float32")),1));return it(e,n)}}}},$Re={kernelName:Yc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=Br(r.shape,n.shape);return{a:()=>{let s=e,i=Vn(r.shape,a);return i.length>0&&(s=ht(s,i)),ue(s,r.shape)},b:()=>{let s=e,i=Vn(n.shape,a);return i.length>0&&(s=ht(s,i)),ue(s,n.shape)}}}},RRe={kernelName:Jh,saveAllInputs:!0,gradFunc:(e,t)=>{let r={};return t.forEach((n,a)=>{r[a]=()=>e.clone()}),r}},DRe={kernelName:Zg,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>hr(r)}}},MRe={kernelName:ex,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>hr(r)}}},FRe={kernelName:Zh,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,ha(Ze(bt(1),Pr(Pe(r,"float32")))))}}},ORe={kernelName:ep,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>{let n=ha(Ne(bt(1),Pr(Pe(r,"float32"))));return it(e,n)}}}},PRe={kernelName:np,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=Br(r.shape,n.shape);return{a:()=>{let s=Ne(Pr(r),Pr(n)),i=oe(e,it(n,s)),o=Vn(r.shape,a);return o.length>0&&(i=ht(i,o)),ue(i,r.shape)},b:()=>{let s=Ne(Pr(r),Pr(n)),i=Jr(oe(e,it(r,s))),o=Vn(n.shape,a);return o.length>0&&(i=ht(i,o)),ue(i,n.shape)}}}},LRe={kernelName:tp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,Ne(Pr(Pe(r,"float32")),1))}}},zRe={kernelName:rp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,Ze(bt(1),Pr(Pe(r,"float32"))))}}};function BRe(e,t,r,n,a,s){let i=G(e,"dy","avgPool3dGrad"),o=G(t,"input","avgPool3dGrad"),u=i,d=o,c=!1;o.rank===4&&(c=!0,u=ue(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),d=ue(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),X(u.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),X(d.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),ns("avgPool3dGrad",a,s);let h={dy:u,input:d},p={filterSize:r,strides:n,pad:a,dimRoundingMode:s},f=se.runKernel(h0,h,p);return c?ue(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var URe=ie({avgPool3dGrad_:BRe}),WRe={kernelName:tx,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{filterSize:a,strides:s,pad:i,dimRoundingMode:o}=r;return{x:()=>URe(e,n,a,s,i,o)}}};function VRe(e,t,r,n,a){let s=G(e,"dy","avgPoolGrad"),i=G(t,"input","avgPoolGrad");X(i.rank===s.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${s.rank})`);let o=i,u=s,d=!1;i.rank===3&&(d=!0,o=ue(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=ue(s,[1,s.shape[0],s.shape[1],s.shape[2]])),X(u.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),X(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);let c={dy:u,input:o},h={filterSize:r,strides:n,pad:a},p=se.runKernel(d0,c,h);return d?ue(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var HRe=ie({avgPoolGrad_:VRe}),qRe={kernelName:ap,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{filterSize:a,strides:s,pad:i}=r;return{x:()=>HRe(e,n,a,s,i)}}},GRe={kernelName:sp,inputsToSave:["a","b"],gradFunc:(e,t,r)=>{let[n,a]=t,{transposeA:s,transposeB:i}=r;return!s&&!i?{a:()=>Gt(e,a,!1,!0),b:()=>Gt(n,e,!0,!1)}:!s&&i?{a:()=>Gt(e,a,!1,!1),b:()=>Gt(e,n,!0,!1)}:s&&!i?{a:()=>Gt(a,e,!1,!0),b:()=>Gt(n,e,!1,!1)}:{a:()=>Gt(a,e,!0,!0),b:()=>Gt(e,n,!0,!0)}}},KRe={kernelName:rx,gradFunc:(e,t,r)=>{let{blockShape:n,crops:a}=r;return{x:()=>q0(e,n,a)}}},QRe={kernelName:I7,gradFunc:(e,t,r)=>{let n=r,a=n.inputShape,s=n.shape,i=Array.from(s);for(let u=a.length-1;u>=0;u--)if(a[u]===s[u])i[u]=1;else if(a[u]!==1)throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${s}].`);let o=[];for(let u=0;u<i.length;u++)i[u]>1&&o.push(u);return{x:()=>ht(e,o,!0)}}},XRe={kernelName:ip,gradFunc:e=>({x:()=>e.clone()})},YRe={kernelName:op,gradFunc:e=>({x:()=>hr(e)})},JRe={kernelName:Jc,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{clipValueMin:a,clipValueMax:s}=r;return{x:()=>da(qi(pu(n,a),rd(n,s)),e,hr(e))}}},ZRe={kernelName:f0,inputsToSave:["x"],gradFunc:UQ.gradFunc},eDe={kernelName:sx,saveAllInputs:!0,gradFunc:(e,t,r)=>{let n=t.map(o=>o.shape),{axis:a}=r,s=Ki(a,t[0].shape)[0],i=n.map(o=>o[s]);return gs(e,i,s).map(o=>()=>o)}},tDe={kernelName:lp,inputsToSave:["x","filter"],gradFunc:(e,t,r)=>{let[n,a]=t,{dilations:s,strides:i,pad:o,dataFormat:u}=r;return X(jc(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>eD(n.shape,e,a,i,o,u),filter:()=>OD(n,e,a.shape,i,o,u)}}},rDe={kernelName:up,inputsToSave:["dy","filter"],gradFunc:(e,t,r)=>{let[n,a]=t,{strides:s,pad:i,dataFormat:o,dimRoundingMode:u}=r;return{dy:()=>Za(e,a,s,i,o,1,u),filter:()=>OD(e,n,a.shape,s,i,o,u)}}};function nDe(e,t,r,n,a){let s=e;e.rank===4&&(s=ue(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let i=t;i.rank===4&&(i=ue(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),X(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),X(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),X(r.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${r}.`),X(s.shape[4]===r[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${r[3]}.`),X(i.shape[4]===r[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${r[4]}).`);let o={x:s,dy:i},u={strides:n,pad:a,filterShape:r};return se.runKernel(ix,o,u)}var aDe=ie({conv3DBackpropFilter_:nDe}),sDe={kernelName:cp,inputsToSave:["x","filter"],gradFunc:(e,t,r)=>{let{dilations:n,strides:a,pad:s}=r;X(jc(n),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${n}'`);let[i,o]=t;return{x:()=>cK(i.shape,e,o,a,s),filter:()=>aDe(i,e,o.shape,a,s)}}},iDe={kernelName:dp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(Jr(Hk(Pe(r,"float32"))),e)}}},oDe={kernelName:hp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(qk(Pe(r,"float32")),e)}}},lDe={kernelName:pp,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{axis:a,exclusive:s,reverse:i}=r;return{x:()=>{let o=gK([a],n.rank),u=Rk(e,a,s,!i);return o!=null&&(u=Kt(u,o)),u}}}},uDe={kernelName:fp,inputsToSave:["x","filter"],gradFunc:(e,t,r)=>{let{dilations:n,strides:a,pad:s,dimRoundingMode:i}=r,o=n??[1,1];X(jc(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);let[u,d]=t;return X(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),X(d.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${d.rank}.`),X(u.shape[3]===d.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),X(bl(a,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${o}'.`),ns("depthwiseConv2d",s,i),{x:()=>aQ(u.shape,e,d,a,s,o,i),filter:()=>nQ(u,e,d.shape,a,s,o,i)}}},cDe={kernelName:mp,inputsToSave:["x","filter"],gradFunc:(e,t,r)=>{let[n,a]=t,s={x:n,filter:a,dy:e},i={x:n,filter:a,dy:e};return{x:()=>se.runKernel(og,s,r),filter:()=>se.runKernel(lg,i,r)}}},dDe={kernelName:xp,outputsToSave:[!0],gradFunc:(e,t)=>{let[r]=t,n={dy:e,y:r};return{x:()=>se.runKernel(dx,n)}}},hDe={kernelName:yp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t,n=oe(Fa(Jr(Pr(r))),2/Math.sqrt(Math.PI));return{x:()=>oe(e,n)}}},pDe={kernelName:vp,outputsToSave:[!0],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(e,r)}}},fDe={kernelName:px,inputsToSave:["input"],gradFunc:(e,t)=>{let[r]=t;return{input:()=>ue(e,r.shape)}}},mDe={kernelName:bp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(e,Fa(r))}}},gDe={kernelName:wp,gradFunc:e=>({x:()=>hr(e)})},xDe={kernelName:Np,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=Br(r.shape,n.shape);return{a:()=>{let s=it(e,Pe(n,"float32")),i=Vn(r.shape,a);return i.length>0?ue(ht(s,i),r.shape):s},b:()=>{let s=oe(e,Pe(r,"float32")),i=Vn(n.shape,a);i.length>0&&(s=ue(ht(s,i),n.shape));let o=Pr(n);return Jr(it(s,Pe(o,"float32")))}}}},yDe={kernelName:Sp,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,r)=>{let{varianceEpsilon:n}=r,[a,s,i,o]=t,u=o??bt(1),d=Vn(s.shape,a.shape),c=[];if(s.rank===1){for(let m=0;m<a.shape.length-1;++m)c.push(a.shape[m]);c.push(1)}let h=Ze(a,s),p=oe(e,u),f=Wk(Ne(i,bt(n))),g=oe(oe(oe(f,f),f),bt(-.5));return{x:()=>s.rank===1?ue(oe(oe(e,Us(ue(f,[1,1,1,s.shape[0]]),c)),u),a.shape):ue(oe(oe(e,f),u),a.shape),mean:()=>{let m=oe(oe(f,bt(-1)),p);return s.rank===1&&(m=ht(m,d)),ue(m,s.shape)},variance:()=>{let m=oe(oe(g,h),p);return s.rank===1&&(m=ht(m,d)),ue(m,s.shape)},scale:()=>{let m=oe(h,f),x=oe(e,m);return s.rank===1&&(x=ht(x,d)),ue(x,s.shape)},offset:()=>{let m=e;return s.rank===1&&(m=ht(m,d)),ue(m,s.shape)}}}},vDe={kernelName:mx,inputsToSave:["x","indices"],gradFunc:(e,t,r)=>{let[n,a]=t,{axis:s,batchDims:i}=r,o=Ki(s,n.shape)[0],u=(d,c,h)=>()=>{let p=d.shape,f=c.size,g=p.slice(0,o),m=g.length,x=p.slice(s,p.length).slice(1),y=x.length,v=m4(0,m),b=m4(m+1,m+1+y),N=g4([g,[f],x]),S=ue(h,N),_=ue(c,[f]),C=g4([[m],v,b]),k=Kt(S,C),I=eC(k,_,d.shape[o]),T=lD(C);return I=Kt(I,T),I};if(i===1){let d=n.shape[0],c=n.split(d,0);return{x:()=>Bn(c.map((h,p)=>u(h,a.slice(p,1),e.slice(p,1))())).reshape(n.shape),indices:()=>a}}else return{x:u(n,a,e),indices:()=>a}}};function m4(e,t){let r=[];for(let n=e;n<t;++n)r.push(n);return r}function g4(e){let t=[];for(let r=0;r<e.length;++r)for(let n=0;n<e[r].length;++n)t.push(e[r][n]);return t}var bDe={kernelName:_p,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t;return{a:()=>hr(r),b:()=>hr(n)}}},wDe={kernelName:kp,gradFunc:e=>({x:()=>Pe(e,"float32")})},NDe={kernelName:Cp,gradFunc:e=>({x:()=>hr(e)})},SDe={kernelName:Ip,gradFunc:e=>({x:()=>hr(e)})},_De={kernelName:Ep,gradFunc:e=>({x:()=>hr(e)})},kDe={kernelName:Tp,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{alpha:a}=r,s=as(n,0);return{x:()=>da(s,e,oe(e,a))}}},CDe={kernelName:Ap,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,Ne(r,1))}}},IDe={kernelName:jp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,Pe(r,"float32"))}}},EDe={kernelName:T7,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,r)=>{let[n]=t,{axis:a}=r;return{logits:()=>{let s=Fa(n);return Ze(e,oe(ht(e,a,!0),s))}}}};function TDe(e,t,r,n=5,a=1,s=1,i=.5){let o={x:e,y:t,dy:r},u={depthRadius:n,bias:a,alpha:s,beta:i};return se.runKernel(_x,o,u)}var jDe=ie({localResponseNormalizationBackprop_:TDe}),ADe={kernelName:$p,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,r)=>{let[n,a]=t,{depthRadius:s,bias:i,alpha:o,beta:u}=r;return{x:()=>jDe(n,a,e,s,i,o,u)}}};function WQ(e,t,r,n){return t.rank<r.rank&&(t=ue(t,jh(t.shape,n))),e.rank<r.rank&&(e=ue(e,jh(e.shape,n))),{x:()=>oe(e,Pe(Xs(r,t),e.dtype))}}var x4={kernelName:Rp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,r)=>{let n=r,{reductionIndices:a}=n,s=t[0],i=t[1],o=Ki(a,s.shape),u=WQ(e,i,s,o);return{x:()=>u.x()}}},$De={kernelName:Dp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t;return{a:()=>oe(e,Pe(pu(r,n),"float32")),b:()=>oe(e,Pe(dg(r,n),"float32"))}}};function RDe(e,t,r,n,a,s,i){let o=G(e,"dy","maxPool3dGrad"),u=G(t,"input","maxPool3dGrad"),d=G(r,"output","maxPool3dGrad"),c=o,h=u,p=d,f=!1;u.rank===4&&(f=!0,c=ue(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),h=ue(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),p=ue(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),X(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),X(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),X(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),ns("maxPool3dGrad",s,i);let g={dy:c,input:h,output:p},m={filterSize:n,strides:a,pad:s,dimRoundingMode:i},x=se.runKernel(v0,g,m);return f?ue(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}var DDe=ie({maxPool3dGrad_:RDe}),MDe={kernelName:kx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,r)=>{let[n,a]=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:u}=r;return{x:()=>DDe(e,n,a,s,i,o,u)}}};function FDe(e,t,r,n,a,s,i){let o=G(e,"dy","maxPoolGrad"),u=G(t,"input","maxPoolGrad"),d=G(r,"output","maxPoolGrad");X(u.rank===o.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${o.rank})`),X(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),X(u.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`),ns("maxPoolGrad",s,i);let c={dy:o,input:u,output:d},h={filterSize:n,strides:a,pad:s,dimRoundingMode:i};return se.runKernel(y0,c,h)}var ODe=ie({maxPoolGrad_:FDe}),PDe={kernelName:Mp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,r)=>{let[n,a]=t,{filterSize:s,strides:i,pad:o}=r;return{x:()=>ODe(e,n,a,s,i,o)}}},LDe={kernelName:Fp,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{axis:a}=r,s=Ki(a,n.shape),i=mK(n.shape,s)[1],o=Ar(i);return{x:()=>{let u=n.shape.slice();s.forEach(c=>{u[c]=1});let d=ue(e,u);return it(oe(d,fs(n.shape,"float32")),o)}}}},zDe={kernelName:Op,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,r)=>{let n=r,{axis:a}=n,[s,i]=t,o=Ki(a,s.shape),u=WQ(e,i,s,o);return{x:()=>u.x()}}},BDe={kernelName:Pp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t;return{a:()=>oe(e,Pe(rd(r,n),"float32")),b:()=>oe(e,Pe(as(r,n),"float32"))}}},UDe={kernelName:Lp,inputsToSave:["x"],gradFunc:(e,t,r)=>{let n=t[0],{paddings:a}=r,s=a.map(i=>i[0]);return{x:()=>ir(e,s,n.shape)}}},WDe={kernelName:zp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=Br(r.shape,n.shape);return{a:()=>{let s=Vn(r.shape,a);return s.length>0?ue(ht(e,s),r.shape):e},b:()=>{let s=oe(e,Jr(ty(it(r,n)))),i=Vn(n.shape,a);return i.length>0?ue(ht(s,i),n.shape):s}}}},VDe={kernelName:Bp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=Br(r.shape,n.shape);return{a:()=>{let s=oe(e,Pe(n,"float32")),i=Vn(r.shape,a);return i.length>0?ue(ht(s,i),r.shape):s},b:()=>{let s=oe(e,Pe(r,"float32")),i=Vn(n.shape,a);return i.length>0?ue(ht(s,i),n.shape):s}}}},HDe={kernelName:Ix,gradFunc:e=>({x:()=>Jr(e)})},qDe={kernelName:Up,inputsToSave:["indices"],gradFunc:(e,t)=>{let r=t[0];return{indices:()=>gn(r.shape,"float32")}}},GDe={kernelName:$x,gradFunc:e=>({x:()=>hr(e)})},KDe={kernelName:Rx,saveAllInputs:!0,gradFunc:(e,t,r)=>{let{axis:n}=r;return Cn(e,n).map(a=>()=>a)}},y4={kernelName:Wp,inputsToSave:["x"],gradFunc:(e,t,r)=>{let n=t[0],{paddings:a}=r,s=a.map(i=>i[0]);return{x:()=>ir(e,s,n.shape)}}},QDe={kernelName:Vp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[r,n,a]=t,s=r,i=n,o=Br(s.shape,i.shape);return{a:()=>{let u=Pe(i,"float32"),d=oe(e,oe(u,pl(s,Ze(u,bt(1))))),c=Vn(s.shape,o);return c.length>0&&(d=ht(d,c)),ue(d,s.shape)},b:()=>{let u=as(s,0),d=da(u,Ys(s),hr(s)),c=oe(e,oe(a,d)),h=Vn(i.shape,o);return h.length>0&&(c=ht(c,h)),ue(c,i.shape)}}}},XDe={kernelName:Hp,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[r,n]=t,a=as(r,0);return{x:()=>da(a,e,oe(e,n)),alpha:()=>{let s=da(a,hr(e),oe(e,r)),i=Vn(n.shape,e.shape);return i.length>0&&(s=ht(s,i)),ue(s,n.shape)}}}};function YDe(e,t,r){let n=e.shape.slice();n[r]=1;let a=ue(t,n),s=fb(e,r,!0,!1),i=fb(e,r,!0,!0),o=oe(s,i);return oe(a,o)}function JDe(e,t,r){let n=e.shape.length,a=n-r.length,s=H.getAxesPermutation(r,n),i=e;s!=null&&(i=Kt(e,s));let o=i.shape.slice(),u=o.splice(n-r.length,r.length).reduce((h,p)=>h*p,1);o.push(u);let d=i.reshape(o),c=YDe(d,t,a);if(c=c.reshape(i.shape),s!=null){let h=H.getUndoAxesPermutation(s);c=Kt(c,h)}return c}var ZDe={kernelName:qp,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{axis:a}=r,s=[];return a==null?s=n.shape.map((i,o)=>o):typeof a=="number"?s=[a]:s=a,{x:()=>JDe(n,e,s)}}},eMe={kernelName:gp,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=Br(r.shape,n.shape);return{a:()=>{let s=it(e,Pe(n,"float32")),i=Vn(r.shape,a);return i.length>0?ue(ht(s,i),r.shape):s},b:()=>{let s=oe(e,Pe(r,"float32")),i=Vn(n.shape,a);i.length>0&&(s=ue(ht(s,i),n.shape));let o=Pr(n);return Jr(it(s,Pe(o,"float32")))}}}},tMe={kernelName:Gp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,Jr(Pr(r)))}}},rMe={kernelName:Yp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t,n=oe(rd(r,6),yf(r));return{x:()=>oe(e,Pe(n,"float32"))}}},nMe={kernelName:Kp,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(e,Pe(yf(r),"float32"))}}},aMe={kernelName:Dx,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>ue(e,r.shape)}}},sMe={kernelName:Xp,inputsToSave:["images"],gradFunc:(e,t,r)=>{let[n]=t,a={dy:e,images:n};return{images:()=>se.runKernel(Fx,a,r)}}},iMe={kernelName:Qp,inputsToSave:["images"],gradFunc:(e,t,r)=>{let[n]=t,a={dy:e,images:n};return{images:()=>se.runKernel(Mx,a,r)}}},oMe={kernelName:Jp,gradFunc:(e,t,r)=>{let{dims:n}=r,a=Ki(n,e.shape);return{x:()=>Si(e,a)}}},lMe={kernelName:Zp,gradFunc:e=>({x:()=>hr(e)})},uMe={kernelName:ef,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>Jr(it(e,oe(pl(r,1.5),2)))}}},cMe={kernelName:zx,inputsToSave:["condition"],gradFunc:(e,t)=>{let[r]=t;return{condition:()=>Pe(hr(r),"float32"),t:()=>oe(e,Pe(r,e.dtype)),e:()=>oe(e,Pe(V0(r),e.dtype))}}},dMe={kernelName:tf,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>{let n=as(r,bt(0)),a=bt(LQ),s=bt(zQ),i=oe(e,s),o=oe(oe(e,a),Fa(Pe(r,"float32")));return da(n,i,o)}}}},hMe={kernelName:sf,outputsToSave:[!0],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(e,oe(r,Ze(bt(1),r)))}}},pMe={kernelName:af,gradFunc:e=>({x:()=>hr(e)})},fMe={kernelName:rf,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(L0(Pe(r,"float32")),e)}}},mMe={kernelName:nf,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe($k(Pe(r,"float32")),e)}}},gMe={kernelName:Bx,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{begin:a,size:s}=r,i=n.shape,[o,u]=OQ(n,a,s),d=[];for(let c=0;c<e.rank;c++)d.push([o[c],i[c]-o[c]-u[c]]);return{x:()=>Fo(e,d)}}},xMe={kernelName:cf,outputsToSave:[!0],gradFunc:(e,t,r)=>{let[n]=t,{dim:a}=r,s=!0,i=oe(e,n);return{logits:()=>Ze(i,oe(ht(i,[a],s),n))}}},yMe={kernelName:of,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(e,Wi(r))}}},v4={kernelName:Ux,gradFunc:(e,t,r)=>{let{blockShape:n,paddings:a}=r;return{x:()=>P0(e,n,a)}}},b4={kernelName:Wx,gradFunc:(e,t,r)=>{let{axis:n}=r;return{x:()=>zr(e,n)}}},vMe={kernelName:lf,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,oe(ha(Pe(r,"float32")),2))}}},bMe={kernelName:k0,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(e,oe(Pe(r,"float32"),2))}}},wMe={kernelName:df,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=bt(2);return{a:()=>oe(e,oe(a,Ze(r,n))),b:()=>oe(e,oe(a,Ze(n,r)))}}},NMe={kernelName:ed,gradFunc:e=>({x:()=>hr(e)})},SMe={kernelName:hf,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[r,n]=t,a=Br(r.shape,n.shape);return{a:()=>{let s=e,i=Vn(r.shape,a);return i.length>0&&(s=ht(s,i)),ue(s,r.shape)},b:()=>{let s=e,i=Vn(n.shape,a);return i.length>0&&(s=ht(s,i)),ue(Jr(s),n.shape)}}}},_Me={kernelName:uf,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,a=n.shape.slice(),{axis:s}=r;Ki(s,n.shape).forEach(u=>{a[u]=1});let i=ue(e,a),o=oe(i,fs(n.shape,"float32"));return{x:()=>o}}},kMe={kernelName:pf,inputsToSave:["x"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>it(e,Pr(L0(r)))}}},CMe={kernelName:ff,outputsToSave:[!0],gradFunc:(e,t)=>{let[r]=t;return{x:()=>oe(Ze(bt(1),Pr(r)),e)}}},IMe={kernelName:Zc,inputsToSave:["x"],gradFunc:(e,t,r)=>{let[n]=t,{reps:a}=r;return{x:()=>{let s=hr(n);if(n.rank===1)for(let i=0;i<a[0];++i)s=Ne(s,ir(e,[i*n.shape[0]],[n.shape[0]]));else if(n.rank===2)for(let i=0;i<a[0];++i)for(let o=0;o<a[1];++o)s=Ne(s,ir(e,[i*n.shape[0],o*n.shape[1]],[n.shape[0],n.shape[1]]));else if(n.rank===3)for(let i=0;i<a[0];++i)for(let o=0;o<a[1];++o)for(let u=0;u<a[2];++u)s=Ne(s,ir(e,[i*n.shape[0],o*n.shape[1],u*n.shape[2]],[n.shape[0],n.shape[1],n.shape[2]]));else if(n.rank===4)for(let i=0;i<a[0];++i)for(let o=0;o<a[1];++o)for(let u=0;u<a[2];++u)for(let d=0;d<a[3];++d)s=Ne(s,ir(e,[i*n.shape[0],o*n.shape[1],u*n.shape[2],d*n.shape[3]],[n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${n.rank} tensors yet.`);return s}}}},EMe={kernelName:Gl,gradFunc:(e,t,r)=>{let n=r,{perm:a}=n,s=lD(a);return{x:()=>Kt(e,s)}}},TMe={kernelName:Qx,gradFunc:(e,t,r)=>{let n=r,{axis:a}=n;return{value:()=>Bn(e,a)}}},jMe={kernelName:A0,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[r]=t;return{x:()=>AMe(e,r)}}};function AMe(e,t){let r=wl(t,hr(t)),n=ry(e,r),a=pu(t,bt(0,"int32")),s=n.rank-a.rank;for(let o=0;o<s;++o)a=la(a,o+1);a=qi(a,fs(n.shape,"bool"));let i=hr(n);return da(a,n,i)}var $Me={kernelName:Xx,gradFunc:e=>({x:()=>hr(e)})},RMe=[UQ,jRe,ARe,$Re,RRe,DRe,MRe,FRe,ORe,PRe,LRe,zRe,WRe,qRe,GRe,KRe,QRe,XRe,YRe,JRe,ZRe,eDe,rDe,tDe,sDe,iDe,oDe,lDe,uDe,cDe,eMe,dDe,hDe,pDe,fDe,mDe,xDe,gDe,yDe,vDe,bDe,wDe,NDe,SDe,_De,kDe,CDe,IDe,EDe,ADe,x4,x4,$De,MDe,PDe,LDe,zDe,BDe,UDe,WDe,VDe,HDe,qDe,GDe,KDe,y4,y4,QDe,XDe,ZDe,tMe,rMe,nMe,aMe,sMe,iMe,oMe,lMe,uMe,cMe,dMe,hMe,pMe,fMe,mMe,gMe,xMe,yMe,v4,v4,b4,b4,vMe,wMe,bMe,NMe,SMe,_Me,kMe,CMe,IMe,EMe,TMe,jMe,$Me];for(let e of RMe)j7(e);Se().prototype.abs=function(){return this.throwIfDisposed(),Fn(this)};Se().prototype.acos=function(){return this.throwIfDisposed(),MR(this)};Se().prototype.acosh=function(){return this.throwIfDisposed(),FR(this)};Se().prototype.add=function(e){return this.throwIfDisposed(),Ne(this,e)};Se().prototype.all=function(e,t){return this.throwIfDisposed(),Tk(this,e,t)};Se().prototype.any=function(e,t){return this.throwIfDisposed(),db(this,e,t)};Se().prototype.argMax=function(e){return this.throwIfDisposed(),Eh(this,e)};Se().prototype.argMin=function(e){return this.throwIfDisposed(),OR(this,e)};Se().prototype.asScalar=function(){return this.throwIfDisposed(),X(this.size===1,()=>"The array must have only 1 element."),ue(this,[])};Se().prototype.asType=function(e){return this.throwIfDisposed(),Pe(this,e)};Se().prototype.as1D=function(){return this.throwIfDisposed(),ue(this,[this.size])};Se().prototype.as2D=function(e,t){return this.throwIfDisposed(),ue(this,[e,t])};Se().prototype.as3D=function(e,t,r){return this.throwIfDisposed(),ue(this,[e,t,r])};Se().prototype.as4D=function(e,t,r,n){return this.throwIfDisposed(),ue(this,[e,t,r,n])};Se().prototype.as5D=function(e,t,r,n,a){return this.throwIfDisposed(),ue(this,[e,t,r,n,a])};Se().prototype.asin=function(){return this.throwIfDisposed(),PR(this)};Se().prototype.asinh=function(){return this.throwIfDisposed(),LR(this)};Se().prototype.atan=function(){return this.throwIfDisposed(),zR(this)};Se().prototype.atan2=function(e){return this.throwIfDisposed(),BR(this,e)};Se().prototype.atanh=function(){return this.throwIfDisposed(),UR(this)};Se().prototype.avgPool=function(e,t,r,n){return this.throwIfDisposed(),hu(this,e,t,r,n)};Se().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),P0(this,e,t)};Se().prototype.batchNorm=function(e,t,r,n,a){return this.throwIfDisposed(),mf(this,e,t,r,n,a)};Se().prototype.broadcastTo=function(e){return this.throwIfDisposed(),eh(this,e)};Se().prototype.cast=function(e){return this.throwIfDisposed(),Pe(this,e)};Se().prototype.ceil=function(){return this.throwIfDisposed(),QR(this)};Se().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Ma(this,e,t)};Se().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Jt&&(e=[e]),zr([this,...e],t)};Se().prototype.conv1d=function(e,t,r,n,a,s){return this.throwIfDisposed(),jk(this,e,t,r,n,a,s)};Se().prototype.conv2dTranspose=function(e,t,r,n,a){return this.throwIfDisposed(),Ak(this,e,t,r,n,a)};Se().prototype.conv2d=function(e,t,r,n,a,s){return this.throwIfDisposed(),Za(this,e,t,r,n,a,s)};Se().prototype.cos=function(){return this.throwIfDisposed(),L0(this)};Se().prototype.cosh=function(){return this.throwIfDisposed(),$k(this)};Se().prototype.cumprod=function(e,t,r){return this.throwIfDisposed(),fb(this,e,t,r)};Se().prototype.cumsum=function(e,t,r){return this.throwIfDisposed(),Rk(this,e,t,r)};Se().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),nD(this,e,t)};Se().prototype.depthwiseConv2d=function(e,t,r,n,a,s){return this.throwIfDisposed(),gf(this,e,t,r,n,a,s)};Se().prototype.dilation2d=function(e,t,r,n,a){return this.throwIfDisposed(),aD(this,e,t,r,n,a)};Se().prototype.divNoNan=function(e){return this.throwIfDisposed(),sD(this,e)};Se().prototype.div=function(e){return this.throwIfDisposed(),it(this,e)};Se().prototype.dot=function(e){return this.throwIfDisposed(),iD(this,e)};Se().prototype.elu=function(){return this.throwIfDisposed(),Zx(this)};Se().prototype.equal=function(e){return this.throwIfDisposed(),Xs(this,e)};Se().prototype.erf=function(){return this.throwIfDisposed(),Dk(this)};Se().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),uD(this,e,t)};Se().prototype.exp=function(){return this.throwIfDisposed(),Fa(this)};Se().prototype.expandDims=function(e){return this.throwIfDisposed(),la(this,e)};Se().prototype.expm1=function(){return this.throwIfDisposed(),cD(this)};Se().prototype.fft=function(){return this.throwIfDisposed(),Q0(this)};Se().prototype.flatten=function(){return this.throwIfDisposed(),ue(this,[this.size])};Se().prototype.floor=function(){return this.throwIfDisposed(),ty(this)};Se().prototype.floorDiv=function(e){return this.throwIfDisposed(),Ek(this,e)};Se().prototype.gather=function(e,t,r){return this.throwIfDisposed(),ry(this,e,t,r)};Se().prototype.greaterEqual=function(e){return this.throwIfDisposed(),pu(this,e)};Se().prototype.greater=function(e){return this.throwIfDisposed(),as(this,e)};Se().prototype.ifft=function(){return this.throwIfDisposed(),mg(this)};Se().prototype.irfft=function(){return this.throwIfDisposed(),Kk(this)};Se().prototype.isFinite=function(){return this.throwIfDisposed(),dD(this)};Se().prototype.isInf=function(){return this.throwIfDisposed(),hD(this)};Se().prototype.isNaN=function(){return this.throwIfDisposed(),pD(this)};Se().prototype.leakyRelu=function(e){return this.throwIfDisposed(),B0(this,e)};Se().prototype.lessEqual=function(e){return this.throwIfDisposed(),rd(this,e)};Se().prototype.less=function(e){return this.throwIfDisposed(),dg(this,e)};Se().prototype.localResponseNormalization=function(e,t,r,n){return this.throwIfDisposed(),fD(this,e,t,r,n)};Se().prototype.logSigmoid=function(){return this.throwIfDisposed(),mD(this)};Se().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Ok(this,e)};Se().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),W0(this,e,t)};Se().prototype.log=function(){return this.throwIfDisposed(),Ys(this)};Se().prototype.log1p=function(){return this.throwIfDisposed(),U0(this)};Se().prototype.logicalAnd=function(e){return this.throwIfDisposed(),qi(this,e)};Se().prototype.logicalNot=function(){return this.throwIfDisposed(),V0(this)};Se().prototype.logicalOr=function(e){return this.throwIfDisposed(),Pk(this,e)};Se().prototype.logicalXor=function(e){return this.throwIfDisposed(),gD(this,e)};Se().prototype.matMul=function(e,t,r){return this.throwIfDisposed(),Gt(this,e,t,r)};Se().prototype.maxPool=function(e,t,r,n){return this.throwIfDisposed(),na(this,e,t,r,n)};Se().prototype.max=function(e,t){return this.throwIfDisposed(),fi(this,e,t)};Se().prototype.maximum=function(e){return this.throwIfDisposed(),wl(this,e)};Se().prototype.mean=function(e,t){return this.throwIfDisposed(),mn(this,e,t)};Se().prototype.min=function(e,t){return this.throwIfDisposed(),cg(this,e,t)};Se().prototype.minimum=function(e){return this.throwIfDisposed(),$c(this,e)};Se().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),yD(this,e,t)};Se().prototype.mod=function(e){return this.throwIfDisposed(),vD(this,e)};Se().prototype.mul=function(e){return this.throwIfDisposed(),oe(this,e)};Se().prototype.neg=function(){return this.throwIfDisposed(),Jr(this)};Se().prototype.norm=function(e,t,r){return this.throwIfDisposed(),ey(this,e,t,r)};Se().prototype.notEqual=function(e){return this.throwIfDisposed(),Ah(this,e)};Se().prototype.oneHot=function(e,t=1,r=0){return this.throwIfDisposed(),hg(this,e,t,r)};Se().prototype.onesLike=function(){return this.throwIfDisposed(),Js(this)};Se().prototype.pad=function(e,t){return this.throwIfDisposed(),Fo(this,e,t)};Se().prototype.pool=function(e,t,r,n,a,s){return this.throwIfDisposed(),bD(this,e,t,r,n,a,s)};Se().prototype.pow=function(e){return this.throwIfDisposed(),pl(this,e)};Se().prototype.prelu=function(e){return this.throwIfDisposed(),G0(this,e)};Se().prototype.prod=function(e,t){return this.throwIfDisposed(),wD(this,e,t)};Se().prototype.reciprocal=function(){return this.throwIfDisposed(),CD(this)};Se().prototype.relu=function(){return this.throwIfDisposed(),Tr(this)};Se().prototype.relu6=function(){return this.throwIfDisposed(),Bk(this)};Se().prototype.reshapeAs=function(e){return this.throwIfDisposed(),ue(this,e.shape)};Se().prototype.reshape=function(e){return this.throwIfDisposed(),ue(this,e)};Se().prototype.resizeBilinear=function(e,t,r){return this.throwIfDisposed(),cQ(this,e,t,r)};Se().prototype.resizeNearestNeighbor=function(e,t,r){return this.throwIfDisposed(),dQ(this,e,t,r)};Se().prototype.reverse=function(e){return this.throwIfDisposed(),Si(this,e)};Se().prototype.rfft=function(){return this.throwIfDisposed(),X0(this)};Se().prototype.round=function(){return this.throwIfDisposed(),Uk(this)};Se().prototype.rsqrt=function(){return this.throwIfDisposed(),Wk(this)};Se().prototype.selu=function(){return this.throwIfDisposed(),Vk(this)};Se().prototype.separableConv2d=function(e,t,r,n,a,s){return this.throwIfDisposed(),ny(this,e,t,r,n,a,s)};Se().prototype.sigmoid=function(){return this.throwIfDisposed(),Wi(this)};Se().prototype.sign=function(){return this.throwIfDisposed(),ID(this)};Se().prototype.sin=function(){return this.throwIfDisposed(),Hk(this)};Se().prototype.sinh=function(){return this.throwIfDisposed(),qk(this)};Se().prototype.slice=function(e,t){return this.throwIfDisposed(),ir(this,e,t)};Se().prototype.softmax=function(e){return this.throwIfDisposed(),ad(this,e)};Se().prototype.softplus=function(){return this.throwIfDisposed(),xf(this)};Se().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),q0(this,e,t)};Se().prototype.split=function(e,t){return this.throwIfDisposed(),gs(this,e,t)};Se().prototype.sqrt=function(){return this.throwIfDisposed(),ha(this)};Se().prototype.square=function(){return this.throwIfDisposed(),Pr(this)};Se().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Qk(this,e)};Se().prototype.squeeze=function(e){return this.throwIfDisposed(),sd(this,e)};Se().prototype.stack=function(e,t){this.throwIfDisposed();let r=e instanceof Jt?[this,e]:[this,...e];return Bn(r,t)};Se().prototype.step=function(e){return this.throwIfDisposed(),yf(this,e)};Se().prototype.stridedSlice=function(e,t,r,n,a,s,i,o){return this.throwIfDisposed(),ED(this,e,t,r,n,a,s,i,o)};Se().prototype.sub=function(e){return this.throwIfDisposed(),Ze(this,e)};Se().prototype.sum=function(e,t){return this.throwIfDisposed(),ht(this,e,t)};Se().prototype.tan=function(){return this.throwIfDisposed(),TD(this)};Se().prototype.tanh=function(){return this.throwIfDisposed(),Ac(this)};Se().prototype.tile=function(e){return this.throwIfDisposed(),Us(this,e)};Se().prototype.toBool=function(){return this.throwIfDisposed(),Pe(this,"bool")};Se().prototype.toFloat=function(){return this.throwIfDisposed(),Pe(this,"float32")};Se().prototype.toInt=function(){return this.throwIfDisposed(),Pe(this,"int32")};Se().prototype.topk=function(e,t){return this.throwIfDisposed(),AD(this,e,t)};Se().prototype.transpose=function(e){return this.throwIfDisposed(),Kt(this,e)};Se().prototype.unique=function(e){return this.throwIfDisposed(),$D(this,e)};Se().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),eC(this,e,t)};Se().prototype.unstack=function(e){return this.throwIfDisposed(),Cn(this,e)};Se().prototype.where=function(e,t){return this.throwIfDisposed(),da(e,this,t)};Se().prototype.zerosLike=function(){return this.throwIfDisposed(),hr(this)};var Ou=class VQ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,VQ.prototype)}},tl=class HQ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,HQ.prototype)}},he=class qQ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,qQ.prototype)}},tr=class GQ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,GQ.prototype)}},DMe=class KQ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,KQ.prototype)}},QQ=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}};function Rh(e,t){if(Array.isArray(e)){let r=[];for(let n=0;n<t;n++)r=r.concat(e);return r}else{let r=new Array(t);return r.fill(e),r}}function Qo(e,t){if(!e)throw new DMe(t)}function w4(e,t){let r=0;for(let n of e)n===t&&r++;return r}function hs(e){return e.length===1?e[0]:e}function Er(e){return Array.isArray(e)?e:[e]}function Ml(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Td(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,r)=>r.toUpperCase())}var Ii={};function YD(e){if(e==null)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function LT(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>LT(t));else{let t=Object.keys(e);for(let r of t){let n=e[r];n!=null&&typeof n=="object"&&(!Array.isArray(n)&&n.type==="ndarray"&&typeof n.value=="number"?e[r]=n.value:LT(n))}}}function J0(e,t={},r={},n="object",a=!1){if(typeof e=="string"){let s=e,i;if(s in r)i=r[s];else if(s in Ii)i=Ii[s];else if(i=t[s],i==null)throw new he(`Unknown ${n}: ${e}. This may be due to one of the following reasons:
1. The ${n} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${n} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{let s=e;if(s.className==null||s.config==null)throw new he(`${n}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);let i=s.className,o,u;if(i in r?[o,u]=r[i]:i in Ii?[o,u]=Ii.className:i in t&&([o,u]=t[i]),o==null)throw new he(`Unknown ${n}: ${i}. This may be due to one of the following reasons:
1. The ${n} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${n} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(u!=null){let d={};for(let f of Object.keys(Ii))d[f]=Ii[f];for(let f of Object.keys(r))d[f]=r[f];let c=s.config;c.customObjects=d;let h=Object.assign({},Ii);for(let f of Object.keys(r))Ii[f]=r[f];LT(s.config);let p=u(o,s.config,r,a);return Ii=Object.assign({},h),p}else{let d=Object.assign({},Ii);for(let h of Object.keys(r))Ii[h]=r[h];let c=new o(s.config);return Ii=Object.assign({},d),c}}}function MMe(e,t){return e<t?-1:e>t?1:0}function o1(e,t){return-1*MMe(e,t)}function yc(e){if(e==null)return e;let t=[];for(let r of e)t.indexOf(r)===-1&&t.push(r);return t}function FMe(e){if(e==null)throw new he(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function vf(e,t,r){if(r!=null&&e.indexOf(r)<0)throw new he(`${r} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function JD(e,t,r=0,n=1/0){return Qo(r>=0),Qo(n>=r),Array.isArray(e)&&e.length>=r&&e.length<=n&&e.every(a=>typeof a===t)}function ca(e,t){Array.isArray(e)?(R.assert(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((r,n)=>ca(r,`element ${n+1} of ${t}`))):R.assert(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${XQ(e)}.`)}function XQ(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>XQ(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function OMe(e,t,r){let n=r!=null?r():R.now(),a;return(...s)=>{let i=r!=null?r():R.now();return i-n<t||(n=i,a=e(...s)),a}}function YQ(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}var PMe=0;function JQ(){return PMe++}var l1={};function oC(e=""){return e in l1||(l1[e]=0),l1[e]+=1,e+l1[e].toString()}var LMe=["channelsFirst","channelsLast"],zMe=["nearest","bilinear"],BMe=["valid","same","causal"],UMe=["max","avg"],WMe=["sum","mul","concat","ave"],Bf=new Map;function Dn(e){vf(LMe,"DataFormat",e)}function VMe(e){vf(zMe,"InterpolationFormat",e)}function Ci(e){vf(BMe,"PaddingMode",e)}function ZQ(e){vf(UMe,"PoolMode",e)}var Sv=[],N4="/";function th(e,t){Sv.push(e);try{let r=t();return Sv.pop(),r}catch(r){throw Sv.pop(),r}}function HMe(){return Sv.length===0?"":Sv.join(N4)+N4}function eX(e){if(!rX(e))throw new Error("Not a valid tensor name: '"+e+"'");return HMe()+e}function tX(e){if(!rX(e))throw new Error("Not a valid tensor name: '"+e+"'");Bf.has(e)||Bf.set(e,0);let t=Bf.get(e);if(Bf.set(e,Bf.get(e)+1),t>0){let r=`${e}_${t}`;return Bf.set(r,1),r}else return e}var qMe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function rX(e){return!!e.match(qMe)}function GMe(e){return e===parseInt(e.toString(),10)}function vc(e,t,r){t==null&&(t=0),r==null&&(r=e.length);let n=1;for(let a=t;a<r;++a)n*=e[a];return n}function xg(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let r=0;r<e.length;r++){let n=e[r];n<t&&(t=n)}return t}function Dc(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let r=0;r<e.length;r++){let n=e[r];n>t&&(t=n)}return t}function Eo(e,t){if(t<e)throw new he(`end (${t}) < begin (${e}) is forbidden.`);let r=[];for(let n=e;n<t;++n)r.push(n);return r}var aI;function Xn(){return aI==null&&(aI=AR().epsilon()),aI}function To(){return"channelsLast"}function iu(e,t){return Pe(e,t)}function Z0(e,t=-1){let r=e.shape.slice();return t<0&&(t=r.length+t+1),r.splice(t,0,1),ue(e,r)}function KMe(e,t){return ce(()=>{if(e.shape.length!==2)throw new he(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);let r=Z0(e,1);return zT(r,[1,t,1])})}function QMe(e){let t=[vc(e.shape)];return ue(e,t)}function XMe(e){if(e.rank<=1)throw new he(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],vc(e.shape,1)];return ue(e,t)}function rh(e,t,r){return ce(()=>{switch(e.rank){case 1:return K0(e,t,r);case 2:return Gk(e,[t,0],[r,e.shape[1]]);case 3:return ay(e,[t,0,0],[r,e.shape[1],e.shape[2]]);case 4:return fg(e,[t,0,0,0],[r,e.shape[1],e.shape[2],e.shape[3]]);case 5:return ir(e,[t,0,0,0,0],[r,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return ir(e,[t,0,0,0,0,0],[r,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new he(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function sI(e,t,r){return ce(()=>{switch(e.rank){case 1:return K0(e,t,r);case 2:return Gk(e,[0,t],[e.shape[0],r]);case 3:return ay(e,[0,0,t],[e.shape[0],e.shape[1],r]);case 4:return fg(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],r]);default:throw new he(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function u1(e,t,r,n){return ce(()=>{switch(e.rank){case 1:return K0(e,t,r);case 2:switch(n){case 1:return rh(e,t,r);case 2:return sI(e,t,r);default:throw new he(`The axis is not within the rank of the tensor ${n}`)}case 3:switch(n){case 1:return rh(e,t,r);case 2:return ay(e,[0,t,0],[e.shape[0],r,e.shape[2]]);case 3:return sI(e,t,r);default:throw new he(`The axis is not within the rank of the tensor ${n}`)}case 4:switch(n){case 1:return rh(e,t,r);case 2:return fg(e,[0,t,0,0],[e.shape[0],r,e.shape[2],e.shape[3]]);case 3:return fg(e,[0,0,t,0],[e.shape[0],e.shape[1],r,e.shape[3]]);case 4:return sI(e,t,r);default:throw new he(`The axis is not within the rank of the tensor ${n}`)}default:throw new he(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function ZD(e,t=-1){let r;return t<0&&(r=e[0].rank,r!==0?t=r:t=0),t===e[0].rank&&(t=-1),zr(e,t)}function S4(e,t){switch(e.rank){case 1:return XR([e,t]);case 2:return YR([e,t],0);case 3:return JR([e,t],0);case 4:return ZR([e,t],0);default:throw new he(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function zT(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new he(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return Us(e,t)}function lC(e,t=0,r=1,n,a){return zk(e,t,r,n,a)}function ll(e,t,r,n){if(e.rank<2||t.rank<2)throw new tr(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){let a=e.shape.slice(-1)[0],s=t.shape.slice(-2)[0];if(a!==s)throw new tr(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return gg.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:n?BT(e.rank,n,To()):null,activation:r});{let a=e.shape.slice(),s=a.pop();e=ue(e,[-1,s]);let i=t.shape.slice(),o=i.pop(),u=i.pop(),d=[...i,o],c=Array.from({length:t.rank},(p,f)=>f===0?t.rank-2:f<=t.rank-2?f-1:f);t=ue(Kt(t,c),[u,-1]);let h=[...a,...d];return ue(gg.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:n?BT(e.rank,n,To()):null,activation:r}),h)}}function nX(e,t,r){return ce(()=>(Array.isArray(t)?t=Cr(t,"int32"):t=Pe(t,"int32"),ry(e,t,r)))}function ew(e){return oe(e,e)}function BT(e,t,r){let n=t.shape;if(t.rank!==1&&t.rank!==e)throw new he(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(r==="channelsFirst")return n.length===1?ue(t,[1,n[0],1,1,1]):ue(t,[1,n[3],n[0],n[1],n[2]]);if(r==="channelsLast")return n.length===1?ue(t,[1,1,1,1,n[0]]):ue(t,[1].concat(n))}else if(e===4){if(r==="channelsFirst")return n.length===1?ue(t,[1,n[0],1,1]):ue(t,[1,n[2],n[0],n[1]]);if(r==="channelsLast")return n.length===1?ue(t,[1,1,1,n[0]]):ue(t,[1].concat(n))}else if(e===3){if(r==="channelsFirst")return n.length===1?ue(t,[1,n[0],1]):ue(t,[1,n[1],n[0]]);if(r==="channelsLast")return n.length===1?ue(t,[1,1,n[0]]):ue(t,[1].concat(n))}else if(e<3)return t;throw new he(`Unsupported input rank by biasAdd: ${t.rank}`)}function Oo(e,t,r){return ce(()=>(r==null&&(r=To()),Dn(r),Ne(e,BT(e.rank,t,r))))}function YMe(e,t=1){if(t!==1)throw new tr(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return Zx(e)}function JMe(e){return ce(()=>it(e,Ne(Fn(e),1)))}function aX(e,t,r,n){return ce(()=>MD(e,t,r,n))}function ZMe(e){return ce(()=>{let t=Ne(.5,oe(.2,e));return Ma(t,0,1)})}function tw(e,t,r=!1){return r?e():t()}var eFe=["fanIn","fanOut","fanAvg"],tFe=["normal","uniform","truncatedNormal"];function rFe(e){vf(eFe,"FanMode",e)}function nFe(e){vf(tFe,"Distribution",e)}var Qi=class extends Re.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},eM=class extends Qi{apply(e,t){return gn(e,t)}};eM.className="Zeros";Re.registerClass(eM);var uC=class extends Qi{apply(e,t){return fs(e,t)}};uC.className="Ones";Re.registerClass(uC);var tM=class extends Qi{constructor(e){if(super(),typeof e!="object")throw new he(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new he(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return ce(()=>oe(bt(this.value),fs(e,t)))}getConfig(){return{value:this.value}}};tM.className="Constant";Re.registerClass(tM);var rM=class extends Qi{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return nd(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};rM.className="RandomUniform";Re.registerClass(rM);var nM=class extends Qi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new tr(`randomNormal does not support dType ${t}.`);return lC(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};nM.className="RandomNormal";Re.registerClass(nM);var aM=class extends Qi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new tr(`truncatedNormal does not support dType ${t}.`);return Zk(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};aM.className="TruncatedNormal";Re.registerClass(aM);var sM=class extends Qi{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return ce(()=>{if(e.length!==2||e[0]!==e[1])throw new he("Identity matrix initializer can only be used for 2D square matrices.");return oe(this.gain,Mk(e[0]))})}getConfig(){return{gain:this.gain}}};sM.className="Identity";Re.registerClass(sM);function aFe(e,t="channelsLast"){let r,n;if(Dn(t),e.length===2)r=e[0],n=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){let a=vc(e,2);r=e[1]*a,n=e[0]*a}else if(t==="channelsLast"){let a=vc(e,0,e.length-2);r=e[e.length-2]*a,n=e[e.length-1]*a}}else{let a=vc(e);r=Math.sqrt(a),n=Math.sqrt(a)}return[r,n]}var vs=class extends Qi{constructor(e){if(super(),e.scale<0)throw new he(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,rFe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,nFe(this.distribution),this.seed=e.seed}apply(e,t){let r=aFe(e),n=r[0],a=r[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,n):this.mode==="fanOut"?s/=Math.max(1,a):s/=Math.max(1,(n+a)/2),this.distribution==="normal"){let i=Math.sqrt(s);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new tr(`${this.getClassName()} does not support dType ${t}.`);return Zk(e,0,i,t,this.seed)}else{let i=Math.sqrt(3*s);return nd(e,-i,i,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};vs.className="VarianceScaling";Re.registerClass(vs);var cC=class extends vs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return vs.className}};cC.className="GlorotUniform";Re.registerClass(cC);var dC=class extends vs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return vs.className}};dC.className="GlorotNormal";Re.registerClass(dC);var hC=class extends vs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return vs.className}};hC.className="HeNormal";Re.registerClass(hC);var pC=class extends vs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return vs.className}};pC.className="HeUniform";Re.registerClass(pC);var fC=class extends vs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return vs.className}};fC.className="LeCunNormal";Re.registerClass(fC);var mC=class extends vs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return vs.className}};mC.className="LeCunUniform";Re.registerClass(mC);var iM=class extends Qi{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return ce(()=>{if(e.length<2)throw new tr("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;let r=R.sizeFromShape(e.slice(0,-1)),n=e[e.length-1],a=r*n;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);let s=[Math.max(n,r),Math.min(n,r)],i=lC(s,0,1,t,this.seed),o=LD.qr(i,!1),u=o[0],d=o[1].flatten().stridedSlice([0],[Math.min(n,r)*Math.min(n,r)],[Math.min(n,r)+1]);return u=oe(u,d.sign()),r<n&&(u=u.transpose()),oe(bt(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};iM.className="Orthogonal";Re.registerClass(iM);var _4={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function k4(e,t={}){return J0(e,Re.SerializationMap.getMap().classNameMap,t,"initializer")}function xn(e){return YD(e)}function un(e){if(typeof e=="string"){let t=e in _4?_4[e]:e;if(t==="GlorotNormal")return new dC;if(t==="GlorotUniform")return new cC;if(t==="HeNormal")return new hC;if(t==="HeUniform")return new pC;if(t==="LeCunNormal")return new fC;if(t==="LeCunUniform")return new mC;{let r={};return r.className=t,r.config={},k4(r)}}else return e instanceof Qi?e:k4(e)}function UT(e){return Array.isArray(e)&&Array.isArray(e[0])}function dS(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Rt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new he(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function vr(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new he(`Expected exactly 1 Shape; got ${e.length}`)}else return e}function hS(e){let t=0;for(let r of e)r.shape.length===0?t+=1:t+=r.shape.reduce((n,a)=>n*a);return t}var C4="Variable",sX=class{constructor(e,t="float32",r=C4,n=!0,a=null){this.dtype=t??"float32",this.shape=e.shape,this.id=JQ(),r=r??C4,this.originalName=eX(r),this.name=tX(this.originalName),this.trainable_=n,this.constraint=a,this.val=RD(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),sFe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function sFe(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function WT(e){return e.map(t=>t.read())}function oM(e){e.forEach(t=>{t[0].write(t[1])})}var Pn=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},jo=class{constructor(e,t,r,n,a,s,i){this.dtype=e,this.shape=t,this.sourceLayer=r,this.inputs=n,this.callArgs=a,this.outputTensorIndex=i,this.id=JQ(),s!=null&&(this.originalName=eX(s),this.name=tX(this.originalName)),this.rank=t.length}},iFe=0,gC=class{constructor(e,t){this.callArgs=t,this.id=iFe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},oFe=0,rr=class extends Re.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=oFe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let r=this.getClassName();t=Ml(r)+"_"+oC(r)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),r=[a].concat(e.inputShape)}this.batchInputShape=r;let n=e.dtype;n==null&&(n=e.inputDType),n==null&&(n="float32"),this.dtype=n}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new tl(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new he(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return hs(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return hs(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Ou(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Ou(`Layer ${this.name} is not connected, no input to return.`);return hs(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Ou(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Ou(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return hs(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){let t=Er(e);if(this.inputSpec==null||this.inputSpec.length===0)return;let r=Er(this.inputSpec);if(t.length!==r.length)throw new he(`Layer ${this.name} expects ${r.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let n=0;n<t.length;n++){let a=t[n],s=r[n];if(s==null)continue;let i=a.rank;if(s.ndim!=null&&i!==s.ndim)throw new he(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${i}`);if(s.maxNDim!=null&&i>s.maxNDim)throw new he(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${i}`);if(s.minNDim!=null&&i<s.minNDim)throw new he(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${i}.`);if(s.dtype!=null&&a.dtype!==s.dtype)throw new he(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${a.dtype}.`);if(s.axes){let o=a.shape;for(let u in s.axes){let d=Number(u),c=s.axes[u],h=d>=0?o[d]:o[o.length+d];if(c!=null&&[c,null].indexOf(h)===-1)throw new he(`Input ${n} is incompatible with layer ${this.name}: expected axis ${d} of input shape to have value ${c} but got shape ${o}.`)}}if(s.shape!=null)for(let o=0;o<s.shape.length;++o){let u=s.shape[o],d=a.shape[o];if(u!=null&&d!=null&&u!==d)throw new he(`Input ${n} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${a.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let r=Er(e),n=cFe(e),a=dFe(e);if(n===a)throw new he("Arguments to apply() must be all SymbolicTensors or all Tensors");return th(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let s=[];for(let i of Er(e))s.push(i.shape);this.build(hs(s)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let s=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,s);let i=Er(s),o=[];for(let u of i)r.indexOf(u)!==-1&&(u=u.clone()),o.push(u);if(s=hs(o),this.activityRegularizer!=null)throw new tr("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}else{let s=lFe(e),i=this.computeOutputShape(s),o,u=uFe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?s[0]:s),i!=null&&i.length>0&&Array.isArray(i[0])?o=i.map((d,c)=>new jo(u,d,this,Er(e),t,this.name,c)):o=new jo(u,i,this,Er(e),t,this.name),this.addInboundNode(e,o,null,null,s,i,t),this._refCount++,this.activityRegularizer!=null)throw new tr("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((r,n)=>{r!=null&&e[n]!=null&&e[n]!==r&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Ou(`The layer ${this.name} has never been called and thus has no defined output shape.`);let e=[];for(let t of this.inboundNodes){let r=JSON.stringify(t.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){let t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Ou(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new tl(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return hS(this.weights)}build(e){this.built=!0}getWeights(e=!1){return WT(e?this.trainableWeights:this.weights)}setWeights(e){ce(()=>{let t=this.weights;if(t.length!==e.length)throw new he(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;let r=[],n=WT(t);for(let a=0;a<n.length;++a){let s=n[a],i=t[a],o=e[a];if(!R.arraysEqual(s.shape,o.shape))throw new he(`Layer weight shape ${s.shape} not compatible with provided weight shape ${o.shape}`);r.push([i,o])}oM(r)})}addWeight(e,t,r,n,a,s,i,o){if(this._addedWeightNames.indexOf(e)!==-1)throw new he(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(n=o!=null?o():un("zeros"));let u=n.apply(t,r),d=new sX(u,r,e,s,i);return u.dispose(),a!=null&&this.addLoss(()=>a.apply(d.read())),s==null&&(s=!0),s?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Er(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,r){if(!this.supportsMasking)return;let n=this.computeMask(e,r),a=Er(t),s=Er(n);if(a.length!==s.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let i=0;i<a.length;i++)a[i].kerasMask=s[i]}addInboundNode(e,t,r,n,a,s,i=null){let o=Er(e);t=Er(t),r=Er(r),n=Er(n),a=dS(a),s=dS(s);let u=[],d=[],c=[];for(let h of o)u.push(h.sourceLayer),d.push(h.nodeIndex),c.push(h.tensorIndex);new gC({outboundLayer:this,inboundLayers:u,nodeIndices:d,tensorIndices:c,inputTensors:o,outputTensors:t,inputMasks:r,outputMasks:n,inputShapes:a,outputShapes:s},i);for(let h=0;h<t.length;h++)t[h].sourceLayer=this,t[h].nodeIndex=this.inboundNodes.length-1,t[h].tensorIndex=h}getConfig(){let e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function lFe(e){e=Er(e);let t=[];for(let r of e)t.push(r.shape);return hs(t)}function uFe(e){return"float32"}function iX(e,t,r){if((t==null||r!=null&&r>0)&&(t=e.sourceLayer,r=e.nodeIndex),t.inboundNodes.length===0)return[e];{let n=t.inboundNodes[r];if(n.inboundLayers.length===0)return n.inputTensors;{let a=[];for(let s=0;s<n.inboundLayers.length;s++){let i=n.inputTensors[s],o=n.inboundLayers[s],u=n.nodeIndices[s],d=iX(i,o,u);for(let c of d)a.indexOf(c)===-1&&a.push(c)}return a}}}function cFe(e){let t=!0;for(let r of Er(e))if(!(r instanceof jo)){t=!1;break}return t}function dFe(e){let t=!0;for(let r of Er(e))if(r instanceof jo){t=!1;break}return t}var iy=class extends rr{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:oC("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new he("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new he("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new he("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let r=e.dtype||"float32";this.batchInputShape=t,this.dtype=r,this.inputSpec=[{shape:t}];let n=new jo(this.dtype,this.batchInputShape,this,[],{},this.name);n.nodeIndex=0,n.tensorIndex=0,new gC({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[n],outputTensors:[n],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new he(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};iy.className="InputLayer";Re.registerClass(iy);function oX(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new he("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let r=e.dtype;return r==null&&(r="float32"),new iy({batchInputShape:t,name:e.name,dtype:r,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function hFe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return Pe(t,e.dtype)}catch{throw new he(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}var pm=class lX{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof lX)for(let r in t.id2Value)this.id2Value[r]=t.id2Value[r],r in t.id2Mask&&(this.id2Mask[r]=t.id2Mask[r]);else{if(t==null)return;for(let r of t)this.add(r.key,r.value)}}add(t,r,n){if(this.id2Value[t.id]==null)this.id2Value[t.id]=hFe(t,r),this.name2Id[t.name]=t.id,n!=null&&(this.id2Mask[t.id]=n);else throw new he(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof jo){if(this.id2Value[t.id]==null)throw new he(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{let r=this.name2Id[t];if(r==null)throw new he(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[r]}}getMask(t){if(t instanceof jo){if(this.id2Value[t.id]==null)throw new he(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{let r=this.name2Id[t];if(r==null)throw new he(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[r]}}disposeMasks(){this.id2Mask!=null&&zt(this.id2Mask)}},pS=new QQ,fS=new QQ;function pFe(e){pS!=null&&pS.setMaxEntries(e),fS!=null&&fS.setMaxEntries(e)}function tv(e,t,r,n){let a=r==null?!1:r.training,s=Array.isArray(e),i=s?e:[e],o=i.map(g=>g.name),u=[],d=t.names();for(let g of o)d.indexOf(g)!==-1?u.push(t.getValue(g)):u.push(null);let c=o.join(",")+"|"+t.names().sort().join(","),h=pS.get(c),p;if(h==null){let g=fFe(i,t);h=g.sorted,p=g.recipientCounts,pS.put(c,h),fS.put(c,p)}p={},a||Object.assign(p,fS.get(c));let f=new pm(t);for(let g=0;g<h.length;++g){let m=h[g],x=m.sourceLayer;if(x instanceof iy)continue;let y=[],v=[],b=[],N=!1;for(let I of m.inputs){let T=f.getValue(I),j=f.getMask(I);y.push(T),v.push(j),j!=null&&(N=!0),a||(p[I.name]--,p[I.name]===0&&!t.hasKey(I)&&o.indexOf(I.name)===-1&&!T.isDisposed&&I.sourceLayer.stateful!==!0&&b.push(T))}N&&(r=r||{},r.mask=v[0]);let S=Er(x.apply(y,r)),_=null;x.supportsMasking&&(_=x.computeMask(y,v));let C=gFe(m),k=Array.isArray(C)?C:[C];for(let I=0;I<k.length;++I){f.hasKey(k[I])||f.add(k[I],S[I],Array.isArray(_)?_[0]:_);let T=o.indexOf(k[I].name);T!==-1&&(u[T]=S[I])}a||zt(b)}return f.disposeMasks(),s?u:u[0]}function fFe(e,t){R.assert(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let r=[],n={};if(e.length===1){let a=I4(e[0],t);r=a.sorted,n=a.recipientMap}else{let a=new Set;for(let s of e){let{sorted:i,recipientMap:o}=I4(s,t);for(let u of i)a.has(u.name)||(r.push(u),a.add(u.name));for(let u in o)n[u]==null&&(n[u]=new Set),o[u].forEach(d=>n[u].add(d))}}return{sorted:r,recipientCounts:mFe(n)}}function mFe(e){let t={};for(let r in e)t[r]=e[r].size;return t}function I4(e,t){let r=new Set,n=[],a={};for(let o of t.names())r.add(o);let s=[],i=[];for(s.push(e);s.length>0;){let o=s[s.length-1];if(r.has(o.name)){s.pop();continue}let u=i[i.length-1]===s.length-1;if(o.inputs.length===0||u)s.pop(),n.push(o),r.add(o.name),u&&i.pop();else{i.push(s.length-1);for(let d of o.inputs)a[d.name]==null&&(a[d.name]=new Set),a[d.name].add(o.name),!r.has(d.name)&&s.push(d)}}return{sorted:n,recipientMap:a}}function gFe(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let r=null;for(let n=0;n<e.sourceLayer.inboundNodes.length;++n)for(let a of e.sourceLayer.inboundNodes[n].outputTensors)if(a.id===e.id){r=n;break}t=e.sourceLayer.getOutputAt(r)}return t}var xFe=ge();xFe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,pFe);var uX={};Ut(uX,{maxNorm:()=>yFe,minMaxNorm:()=>wFe,nonNeg:()=>bFe,unitNorm:()=>vFe});function lM(e,t){return ce(()=>ha(ht(oe(e,e),t,!0)))}var rw=class extends Re.Serializable{getConfig(){return{}}},uM=class extends rw{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ce(()=>{let t=lM(e,this.axis),r=Ma(t,0,this.maxValue);return oe(e,it(r,Ne(Xn(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};uM.className="MaxNorm";Re.registerClass(uM);var cM=class extends rw{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ce(()=>it(e,Ne(Xn(),lM(e,this.axis))))}getConfig(){return{axis:this.axis}}};cM.className="UnitNorm";Re.registerClass(cM);var dM=class extends rw{apply(e){return Tr(e)}};dM.className="NonNeg";Re.registerClass(dM);var hM=class extends rw{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ce(()=>{let t=lM(e,this.axis),r=Ne(oe(this.rate,Ma(t,this.minValue,this.maxValue)),oe(1-this.rate,t));return oe(e,it(r,Ne(Xn(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};hM.className="MinMaxNorm";Re.registerClass(hM);var E4={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Jn(e){return YD(e)}function T4(e,t={}){return J0(e,Re.SerializationMap.getMap().classNameMap,t,"constraint")}function Zn(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in E4?E4[e]:e,config:{}};return T4(t)}else return e instanceof rw?e:T4(e)}function yFe(e){return new uM(e)}function vFe(e){return new cM(e)}function bFe(){return new dM}function wFe(e){return new hM(e)}var cX={};Ut(cX,{constant:()=>_Fe,glorotNormal:()=>AFe,glorotUniform:()=>jFe,heNormal:()=>$Fe,heUniform:()=>RFe,identity:()=>EFe,leCunNormal:()=>DFe,leCunUniform:()=>MFe,ones:()=>SFe,orthogonal:()=>FFe,randomNormal:()=>CFe,randomUniform:()=>kFe,truncatedNormal:()=>IFe,varianceScaling:()=>TFe,zeros:()=>NFe});function NFe(){return new eM}function SFe(){return new uC}function _Fe(e){return new tM(e)}function kFe(e){return new rM(e)}function CFe(e){return new nM(e)}function IFe(e){return new aM(e)}function EFe(e){return new sM(e)}function TFe(e){return new vs(e)}function jFe(e){return new cC(e)}function AFe(e){return new dC(e)}function $Fe(e){return new hC(e)}function RFe(e){return new pC(e)}function DFe(e){return new fC(e)}function MFe(e){return new mC(e)}function FFe(e){return new iM(e)}var dX={};Ut(dX,{Layer:()=>rr,RNN:()=>gu,RNNCell:()=>aw,activation:()=>pPe,add:()=>NPe,alphaDropout:()=>sLe,average:()=>SPe,averagePooling1d:()=>_F,averagePooling2d:()=>kF,averagePooling3d:()=>CF,avgPool1d:()=>$Pe,avgPool2d:()=>DPe,avgPool3d:()=>FPe,avgPooling1d:()=>RPe,avgPooling2d:()=>MPe,avgPooling3d:()=>OPe,batchNormalization:()=>TPe,bidirectional:()=>YPe,categoryEncoding:()=>cLe,centerCrop:()=>lLe,concatenate:()=>_Pe,conv1d:()=>aPe,conv2d:()=>sPe,conv2dTranspose:()=>iPe,conv3d:()=>oPe,conv3dTranspose:()=>lPe,convLstm2d:()=>GPe,convLstm2dCell:()=>KPe,cropping2D:()=>cPe,dense:()=>fPe,depthwiseConv2d:()=>hPe,dot:()=>EPe,dropout:()=>mPe,elu:()=>JOe,embedding:()=>wPe,flatten:()=>xPe,gaussianDropout:()=>aLe,gaussianNoise:()=>nLe,globalAveragePooling1d:()=>PPe,globalAveragePooling2d:()=>LPe,globalMaxPool1d:()=>ZPe,globalMaxPool2d:()=>eLe,globalMaxPooling1d:()=>pY,globalMaxPooling2d:()=>fY,gru:()=>BPe,gruCell:()=>UPe,input:()=>TX,inputLayer:()=>YOe,layerNormalization:()=>jPe,leakyReLU:()=>ePe,lstm:()=>WPe,lstmCell:()=>VPe,masking:()=>iLe,maxPool1d:()=>tLe,maxPool2d:()=>rLe,maxPooling1d:()=>mY,maxPooling2d:()=>gY,maxPooling3d:()=>zPe,maximum:()=>kPe,minimum:()=>CPe,multiply:()=>IPe,permute:()=>bPe,prelu:()=>tPe,randomWidth:()=>dLe,reLU:()=>ZOe,repeatVector:()=>yPe,rescaling:()=>oLe,reshape:()=>vPe,resizing:()=>uLe,rnn:()=>QPe,separableConv2d:()=>uPe,simpleRNN:()=>HPe,simpleRNNCell:()=>qPe,softmax:()=>rPe,spatialDropout1d:()=>gPe,stackedRNNCells:()=>XPe,thresholdedReLU:()=>nPe,timeDistributed:()=>JPe,upSampling2d:()=>dPe,zeroPadding2d:()=>APe});async function Au(e){if(e==null)return;let t=[],r=[],n=[];for(let a in e){let s=e[a];if(typeof s!="number"){let i=s;t.push(i.data()),r.push(a),n.push(i)}}if(t.length>0){let a=await Promise.all(t);for(let s=0;s<a.length;++s)e[r[s]]=a[s][0];zt(n)}}function hX(e){if(e!=null)for(let t in e){let r=e[t];typeof r!="number"&&r.dispose()}}var j4;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(j4||(j4={}));var OFe=125,yg=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},pX=class{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(let r of this.callbacks)await r.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(let r of this.callbacks)await r.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(let r of this.callbacks)await r.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(let r of this.callbacks)await r.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},PFe=class extends yg{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});let r=t.size==null?0:t.size;this.seen+=r;for(let n in t){let a=t[n];if(typeof a=="number")this.totals.hasOwnProperty(n)||(this.totals[n]=0),this.totals[n]=this.totals[n]+a*r;else{let s;n in this.totals?s=this.totals[n]:this.totals[n]=0;let i=ce(()=>Ne(this.totals[n],oe(a,r)));this.totals[n]=i,s!=null&&s.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(let r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?t[r]=this.totals[r]/this.seen:ce(()=>{let n=oe(it(1,this.seen),this.totals[r]);t[r]=n,this.totals[r].dispose(),Qn(t[r])}))}},fX=class extends yg{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(let r in t)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(t[r])}async syncData(){let e=[],t=[],r=[];for(let a in this.history){let s=this.history[a];for(let i=0;i<s.length;++i)if(typeof s[i]!="number"){let o=s[i];e.push(o.data()),t.push(a),r.push(i)}}let n=await Promise.all(e);for(let a=0;a<n.length;++a)this.history[t[a]][r[a]].dispose(),this.history[t[a]][r[a]]=n[a][0]}},mX=class extends yg{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||QD,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=OFe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");R.isNumber(this.yieldEvery)&&(this.maybeWait=OMe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,r){let n=[];this.yield!=null&&(await Au(r),n.push(this.yield(e,t,r))),n.push(this.nextFrameFunc()),await Promise.all(n)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Au(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let r=[];this.epochEnd!=null&&(await Au(t),r.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Au(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let r=[];this.batchEnd!=null&&(await Au(t),r.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):R.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await Au(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Au(e),await this.trainEnd(e))}};function gX(e,t){return e==null&&(e={}),e instanceof yg?[e]:Array.isArray(e)&&e[0]instanceof yg?e:Er(e).map(r=>new mX(r,t))}var pM=class Bo{constructor(){}static registerCallbackConstructor(t,r){R.assert(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),Bo.checkForDuplicate(r),Bo.constructors[t]==null&&(Bo.constructors[t]=[]),Bo.constructors[t].push(r)}static checkForDuplicate(t){for(let r in Bo.constructors)Bo.constructors[+r].forEach(n=>{if(n===t)throw new he("Duplicate callback constructor.")})}static clear(){Bo.constructors={}}static createCallbacks(t){let r=[];for(let n in Bo.constructors){let a=+n;t>=a&&r.push(...Bo.constructors[a])}return r.map(n=>new n)}};pM.constructors={};function xX(e,t,r,n,a,s,i,o,u){let d=new fX,c=[new PFe,...pM.createCallbacks(t)];e!=null&&c.push(...e),c.push(d);let h=new pX(c);return h.setParams({epochs:r,initialEpoch:n,samples:a,steps:s,batchSize:i,verbose:t,doValidation:o,metrics:u}),{callbackList:h,history:d}}function bo(e,t={},r=!1){return J0(e,Re.SerializationMap.getMap().classNameMap,t,"layer",r)}function mS(e,t){return ce(()=>{e.dtype!=="float32"&&(e=Pe(e,"float32"));let r=ht(ew(e),t,!0),n=Qs(r.shape,Xn()),a=ha(wl(r,n));return it(e,a)})}function bf(e,t){return ce(()=>mn(ew(Ze(t,e)),-1))}function xC(e,t){return ce(()=>mn(Fn(Ze(t,e)),-1))}function oy(e,t){return ce(()=>{let r=Ze(e,t),n=Ma(Fn(e),Xn(),Number.MAX_VALUE),a=Fn(it(r,n));return oe(100,mn(a,-1))})}function LFe(e,t){return ce(()=>{let r=Ma(t,Xn(),Number.MAX_VALUE),n=Ys(Ne(1,r)),a=Ma(e,Xn(),Number.MAX_VALUE),s=Ys(Ne(1,a));return mn(ew(Ze(n,s)),-1)})}function zFe(e,t){return ce(()=>{let r=wl(0,Ze(1,oe(e,t)));return mn(ew(r),-1)})}function BFe(e,t){return ce(()=>{let r=wl(0,Ze(1,oe(e,t)));return mn(r,-1)})}function UFe(e,t){return ce(()=>{let r=ht(oe(e,t),-1),n=fi(oe(Ze(1,e),t),-1);return wl(0,Ne(1,Ze(n,r)))})}function WFe(e,t){return ce(()=>{let r=Math.log(2),n=Ze(t,e),a=Ze(Ne(n,xf(oe(-2,n))),r);return mn(a,-1)})}function mb(e,t,r=!1){return ce(()=>{if(r)t=ad(t);else{let n=ht(t,t.shape.length-1,!0);t=it(t,n)}return t=Ma(t,Xn(),1-Xn()),Jr(ht(oe(Pe(e,"float32"),Ys(t)),t.shape.length-1))})}function gS(e,t,r=!1){return ce(()=>{let n=Pe(ty(QMe(e)),"int32");t=Ma(t,Xn(),1-Xn());let a=t.shape,s=ue(hg(n,a[a.length-1]),a);return mb(s,t,r)})}function VFe(e,t){if(!R.arraysEqual(e.shape,t.shape))throw new he(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return ce(()=>{let r=Tr(t),n=Jr(Fn(t));return Ne(Ze(r,oe(t,e)),U0(Fa(n)))})}function yC(e,t){return ce(()=>{let r;return r=Ma(t,Xn(),1-Xn()),r=Ys(it(r,Ze(1,r))),mn(VFe(e,r),-1)})}function HFe(e,t){return ce(()=>{let r=Ma(e,Xn(),1),n=Ma(t,Xn(),1);return ht(oe(e,Ys(it(r,n))),-1)})}function qFe(e,t){return ce(()=>{let r=Ys(Ne(Xn(),t));return mn(Ze(t,oe(e,r)),-1)})}function fM(e,t){return ce(()=>{let r=mS(e,-1),n=mS(t,-1),a=oe(r,n);return Jr(ht(a,-1))})}var xS={meanSquaredError:bf,meanAbsoluteError:xC,meanAbsolutePercentageError:oy,meanSquaredLogarithmicError:LFe,squaredHinge:zFe,hinge:BFe,categoricalHinge:UFe,logcosh:WFe,categoricalCrossentropy:mb,sparseCategoricalCrossentropy:gS,binaryCrossentropy:yC,kullbackLeiblerDivergence:HFe,poisson:qFe,cosineProximity:fM};function iI(e){if(typeof e=="string"){if(e in xS)return xS[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new he(t)}else return e}function mM(e,t){return ce(()=>{let r=oe(.5,Js(t)),n=iu(as(t,r),e.dtype);return mn(Xs(e,n),-1)})}function gM(e,t){return ce(()=>iu(Xs(Eh(e,-1),Eh(t,-1)),"float32"))}function yX(e,t){return ce(()=>Pe(ht(qi(Xs(e,1),Xs(t,1))),"float32"))}function GFe(e,t){return ce(()=>Pe(ht(qi(Xs(e,1),Xs(t,0))),"float32"))}function KFe(e,t){return ce(()=>Pe(ht(qi(Xs(e,0),Xs(t,1))),"float32"))}function vX(e,t){return ce(()=>{let r=yX(e,t),n=KFe(e,t),a=Ne(r,n);return Pe(da(as(a,0),it(r,a),0),"float32")})}function QFe(e,t){return ce(()=>{let r=yX(e,t),n=GFe(e,t),a=Ne(r,n);return Pe(da(as(a,0),it(r,a),0),"float32")})}function bX(e,t){return yC(e,t)}function wX(e,t){return e.rank===t.rank&&(e=sd(e,[e.rank-1])),t=Eh(t,-1),t.dtype!==e.dtype&&(t=Pe(t,e.dtype)),Pe(Xs(e,t),"float32")}function XFe(e,t){return ce(()=>{let r=e.sub(t).square().sum(),n=e.sub(e.mean()).square().sum();return bt(1).sub(r.div(n))})}var YFe=bf,JFe=bf,ZFe=xC,eOe=xC,tOe=oy,rOe=oy,xM=mb,nOe=fM,NX=gS,yS={binaryAccuracy:mM,categoricalAccuracy:gM,precision:vX,categoricalCrossentropy:xM,sparseCategoricalCrossentropy:NX,mse:YFe,MSE:JFe,mae:ZFe,MAE:eOe,mape:tOe,MAPE:rOe,cosine:nOe};function aOe(e){if(typeof e=="string"&&e in yS)return yS[e];if(typeof e!="string"&&e!=null)return e;throw new he(`Unknown metric ${e}`)}function c1(e){if(Qo(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(let r of Object.keys(xS))if(xS[r]===e){t=r;break}if(t!==void 0)return t;for(let r of Object.keys(yS))if(yS[r]===e){t=r;break}return t!==void 0?t:e.name}}function sOe(e){let t={Adagrad:()=>_d.adagrad(.01),Adadelta:()=>_d.adadelta(1,.95,Xn()),Adam:()=>_d.adam(.001,.9,.999,Xn()),Adamax:()=>_d.adamax(.002,.9,.999,Xn(),0),RMSProp:()=>_d.rmsprop(.001,.9,0,Xn()),SGD:()=>_d.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new he(`Unknown Optimizer ${e}`)}function A4(e,t,r=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!VT(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(r){let n=JSON.stringify(e);n.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function VT(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let r of t)if(typeof r!="string"||!VT(e[r]))return!1;return!0}else if(Array.isArray(e)){for(let t of e)if(!VT(t))return!1;return!0}else return!1;else{let t=typeof e;return t==="string"||t==="number"||t==="boolean"}}function iOe(e,t,r,n=console.log){let a=lOe(e),s=["Layer (type)","Input Shape","Output shape","Param #"];a?(t=t||90,r=r||[.32,.61,.89,1]):(t=t||115,r=r||[.24,.48,.7,.8,1]),r[r.length-1]<=1&&(r=r.map(c=>Math.floor(t*c)));let i;if(!a){s.push("Receives inputs"),i=[];for(let c in e.nodesByDepth)i.push(...e.nodesByDepth[c])}n("_".repeat(t)),vS(s,r,n),n("=".repeat(t));let o=e.layers;for(let c=0;c<o.length;++c)a?uOe(o[c],r,n):cOe(o[c],r,i,n),n((c===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let u=oOe(e),d=hS(e.nonTrainableWeights);n(`Total params: ${u+d}`),n(`Trainable params: ${u}`),n(`Non-trainable params: ${d}`),n("_".repeat(t))}function oOe(e){let t;return e.collectedTrainableWeights!=null?t=hS(e.collectedTrainableWeights):t=hS(e.trainableWeights),t}function lOe(e){let t=!0,r=[],n=[];for(let a in e.nodesByDepth)r.push(e.nodesByDepth[a]);for(let a of r){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){t=!1;break}n.push(...a)}if(t)for(let a of e.layers){let s=!1;for(let i of a.inboundNodes)if(n.indexOf(i)!==-1)if(s){t=!1;break}else s=!0;if(!t)break}return t}function vS(e,t,r=console.log){let n="";for(let a=0;a<e.length;++a)a>0&&(n=n.slice(0,n.length-1)+" "),n+=e[a],n=n.slice(0,t[a]),n+=" ".repeat(t[a]-n.length);r(n)}function uOe(e,t,r){let n,a;try{a=e.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch{a="multiple"}try{n=JSON.stringify(e.outputShape)}catch{n="multiple"}let s=e.name,i=e.getClassName(),o=[`${s} (${i})`,a,n,e.countParams().toString()];vS(o,t,r)}function cOe(e,t,r,n){let a,s;try{s=e.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{s="multiple"}try{a=JSON.stringify(e.outputShape)}catch{a="multiple"}let i=[];for(let h of e.inboundNodes)if(!(r!=null&&r.length>0&&r.indexOf(h)===-1))for(let p=0;p<h.inboundLayers.length;++p){let f=h.inboundLayers[p].name,g=h.nodeIndices[p],m=h.tensorIndices[p];i.push(`${f}[${g}][${m}]`)}let o=e.name,u=e.getClassName(),d=i.length===0?"":i[0],c=[`${o} (${u})`,s,a,e.countParams().toString(),d];vS(c,t,n);for(let h=1;h<i.length;++h)vS(["","","","",i[h]],t,n)}function SX(e,t,r){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof r=="string"}function gb(e,t){if(e===null)return null;if(typeof e=="string")return Td(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let r=[],n=e.length;for(let a=0;a<n;++a){let s=e[a];SX(t,a,s)?r.push(s):r.push(gb(s,t))}return r}else{let r={};for(let n of Object.keys(e)){let a=e[n];if(n==="name"&&typeof a=="string")r[n]=a;else{let s=Td(n);r[s]=gb(a,s)}}return r}}function HT(e,t){if(e==null)return null;if(typeof e=="string")return Ml(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let r=[],n=e.length;for(let a=0;a<n;++a){let s=e[a];SX(t,a,s)?r.push(s):r.push(HT(s,t))}return r}else{let r={};for(let n of Object.keys(e)){let a=e[n],s=Ml(n);(n==="name"||n==="className")&&typeof a=="string"?r[s]=a:r[s]=HT(a,n)}return r}}var yM="4.22.0",dOe=e=>{let t=Object.keys(e);if(t.length===0)return!1;let r=t[0].split("/");return!isNaN(parseInt(r[r.length-1],10))},hOe=class Uo extends rr{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){let v=this.getClassName().toLowerCase();this.name=oC(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],yc(this.inputs).length!==this.inputs.length)throw new he(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);yc(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let v of this.outputs){let b=v.sourceLayer,N=v.nodeIndex,S=v.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(N),this.outputLayersTensorIndices.push(S)}for(let v of this.inputs){let b=v.sourceLayer,N=v.nodeIndex,S=v.tensorIndex;Qo(N===0,"input layer has >1 nodes"),Qo(S===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(N),this.inputLayersTensorIndices.push(S)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){let b=this.inputLayers[v];if(!(b instanceof iy))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${v} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(let v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);let r={},n={},a={},s={},i={},o=[],u=(v,b,N,S,_,C)=>{(S==null||_==null||C==null)&&(S=v.sourceLayer,_=v.nodeIndex,C=v.tensorIndex);let k=S.inboundNodes[_];if(N.indexOf(k)!==-1)throw new tl(`The tensor ${v.name} at layer "${S.name}" is part of a cycle.`);if(b.indexOf(k)!==-1)return;this.containerNodes.add(Uo.nodeKey(S,_)),S.id in i||(i[S.id]=Object.keys(i).length),N.indexOf(k)===-1&&N.push(k);let I=k.inboundLayers.length;for(let T=0;T<I;T++){let j=k.inputTensors[T],E=k.inboundLayers[T],O=k.nodeIndices[T],M=k.tensorIndices[T];u(j,b,N,E,O,M)}for(b.push(k);N.indexOf(k)>=0;)N.splice(N.indexOf(k),1);o.push(k)},d=[],c=[];for(let v of this.outputs)u(v,d,c);let h=o.slice().reverse();for(let v of h){n[v.id]=v,v.id in r||(r[v.id]=0);let b=r[v.id],N=a[v.outboundLayer.id]==null?0:a[v.outboundLayer.id];b=Math.max(b,N),a[v.outboundLayer.id]=b,s[v.outboundLayer.id]=v.outboundLayer,r[v.id]=b;for(let S=0;S<v.inboundLayers.length;S++){let _=v.inboundLayers[S],C=v.nodeIndices[S],k=_.inboundNodes[C],I=r[k.id]==null?0:r[k.id];r[k.id]=Math.max(b+1,I),n[k.id]=k}}let p={};for(let v in r){let b=r[v];b in p||(p[b]=[]),p[b].push(n[v])}let f={};for(let v in a){let b=a[v];b in f||(f[b]=[]),f[b].push(s[v])}let g=Object.keys(f).map(v=>parseInt(v,10)).sort(o1);this.layers=[];for(let v of g){let b=f[v];b.sort((N,S)=>{let _=i[N.id],C=i[S.id];return _<C?-1:_>C?1:0});for(let N of b)N instanceof Uo&&this.internalContainerRefs.push(N),this.layers.push(N)}this.layersByDepth=f,g=Object.keys(p).map(v=>parseInt(v,10)).sort(o1);let m=this.inputs.slice(),x=[];for(let v of g)for(let b of p[v]){let N=b.outboundLayer;if(N!=null){for(let S of b.inputTensors)if(m.indexOf(S)===-1)throw new tl(`Graph disconnected: cannot obtain value for tensor ${S} at layer "${N.name}". The following previous layers were accessed without issue: ${x}`);for(let S of b.outputTensors)m.push(S);x.push(N.name)}}this.nodesByDepth=p;let y=this.layers.map(v=>v.name);for(let v of y){let b=y.filter(N=>N===v).length;if(b!==1)throw new tl(`The name "${v}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new gC({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let r of this.layers)t.numDisposedVariables+=r.dispose().numDisposedVariables;for(let r of this.internalContainerRefs)t.numDisposedVariables+=r.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(r=>{r._trainableWeights.forEach(n=>n.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new he("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(let r of this.layers)t=t.concat(r.trainableWeights);return t}get nonTrainableWeights(){let t=[];for(let r of this.layers)t.push(...r.nonTrainableWeights);if(!this.trainable){let r=[];for(let n of this.layers)r.push(...n.trainableWeights);return r.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,r=!0){let n={},a=0,s=dOe(t);s&&this.parseWeights(t);for(let o of this.layers)for(let[u,d]of o.weights.entries()){let c=s?`${d.name.split("/").slice(0,-1).join("/")+"/"}${u}`:d.originalName;if(n[c]!=null)throw new he(`Duplicate weight name: ${c}`);n[c]=d,a++}let i=[];for(let o in t){let u=o;if(n[o]==null){let d=o.split("/");u=d.slice(0,-2).concat([d[d.length-1]]).join("/")}if(n[u]!=null)i.push([n[u],t[o]]);else if(r)throw new he(`Provided weight data has no target variable: ${o}`);delete n[u]}if(r){let o=[];for(let u in n)o.push(u);if(o.length>0)throw new he(`${o.length} of ${a} weights are not set: ${o}`)}oM(i)}parseWeights(t){for(let r in Object.keys(t)){let n=r.split("/"),a=["vars","layer_checkpoint_dependencies"],s=n.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!a.includes(i)).join("/");s!==r&&(t[s]=t[r],delete t[r])}}updatedConfig(){let t=this.getConfig(),r={};return r.className=this.getClassName(),r.config=t,r.kerasVersion=`tfjs-layers ${yM}`,r.backend="TensorFlow.js",r}toJSON(t,r=!0){let n=HT(this.updatedConfig());return r?JSON.stringify(n):n}call(t,r){return ce(()=>{t=Er(t);let n=new pm;for(let a=0;a<this.inputs.length;++a)n.add(this.inputs[a],t[a]);return tv(this.outputs,n,r)})}computeMask(t,r){return ce(()=>{t=Er(t);let n;return r==null?n=Rh(null,t.length):n=Er(r),this.runInternalGraph(t,n)[1]})}computeOutputShape(t){let r=dS(t);if(r.length!==this.inputLayers.length)throw new he(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);let n={};for(let o=0;o<r.length;o++){let u=this.inputLayers[o],d=r[o],c=u.name+"_0_0";n[c]=d}let a=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(o1);if(a.length>1)for(let o of a){let u=this.nodesByDepth[o];for(let d of u){let c=d.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(c.id)!==-1)continue;let h=[];for(let m=0;m<d.inboundLayers.length;m++){let x=d.inboundLayers[m],y=d.nodeIndices[m],v=d.tensorIndices[m],b=`${x.name}_${y}_${v}`,N=n[b];h.push(N)}let p=c.computeOutputShape(hs(h)),f=dS(p),g=c.inboundNodes.indexOf(d);for(let m=0;m<f.length;m++){let x=`${c.name}_${g}_${m}`;n[x]=f[m]}}}let s=[],i=[];for(let o=0;o<this.outputLayers.length;o++){let u=this.outputLayers[o],d=this.outputLayersNodeIndices[o],c=this.outputLayersTensorIndices[o],h=`${u.name}_${d}_${c}`;i.push(h)}for(let o=0;o<i.length;o++){let u=i[o];Qo(u in n),s.push(n[u])}return hs(s)}runInternalGraph(t,r){r==null&&(r=Rh(null,t.length));let n={};for(let u=0;u<this.inputs.length;++u){let d=this.inputs[u],c=t[u],h=r[u];n[d.id]=[c,h]}let a=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(o1);for(let u of a){let d=this.nodesByDepth[u];for(let c of d){let h=c.outboundLayer,p=c.inputTensors,f=c.outputTensors,g=new Array;for(let m of p)m.id in n&&g.push(n[m.id]);if(g.length===p.length){let m={},x,y,v,b;if(c.callArgs!=null&&(m=c.callArgs),g.length===1){let[N,S]=g[0];m.mask==null&&(m.mask=S),v=Er(h.call(N,m)),b=Er(h.computeMask(N,S)),x=[N],y=[S]}else x=g.map(N=>N[0]),y=g.map(N=>N[1]),m.mask==null&&(m.mask=y),v=Er(h.call(x,m)),b=Er(h.computeMask(x,y));if(h.activityRegularizer)throw new tr("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let N=0;N<f.length;++N){let S=f[N],_=v[N],C=b[N];n[S.id]=[_,C]}}}}let s=[],i=[],o=[];for(let u of this.outputs){Qo(u.id in n,`Could not compute output ${u.name} : ${u.id}`);let[d,c]=n[u.id];o.push(d.shape),s.push(d),i.push(c)}return[s,i,o]}buildNodeConversionMap(t){let r={},n;for(let a of this.layers){n=a instanceof Uo?1:0;for(let s=0;s<a.inboundNodes.length;s++){let i=Uo.nodeKey(a,s);this.containerNodes.has(i)&&(r[i]=n,n+=1)}}return r}getLayer(t,r){if(r!=null)return this.findLayer(r);if(t==null)throw new he("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(let n of this.layers)if(n.name===t)return n;throw new he(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new he(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return ce(()=>{let t=[];for(let r of this.layers)for(let n=0;n<r.inboundNodes.length;++n){let a=Uo.nodeKey(r,n);this.containerNodes.has(a)&&t.push(...r.calculateLosses())}return t})}getConfig(){let t={name:this.name},r=this.buildNodeConversionMap(this.layers),n=[];for(let i of this.layers){let o=i.getClassName(),u=i.getConfig(),d=[];for(let h=0;h<i.inboundNodes.length;h++){let p=i.inboundNodes[h],f=Uo.nodeKey(i,h),g={};if(this.containerNodes.has(f)){if(p.callArgs)try{JSON.stringify(p.callArgs),g=p.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),g={}}if(p.inboundLayers.length>0){let m=[];for(let x=0;x<p.inboundLayers.length;x++){let y=p.inboundLayers[x],v=p.nodeIndices[x],b=p.tensorIndices[x],N=Uo.nodeKey(y,v),S=r[N];S==null&&(S=0),m.push([y.name,S,b,g])}d.push(m)}}}let c={};c.name=i.name,c.className=o,c.config=u,c.inboundNodes=d,n.push(c)}t.layers=n;let a=[];for(let i=0;i<this.inputLayers.length;i++){let o=this.inputLayers[i],u=this.inputLayersNodeIndices[i],d=Uo.nodeKey(o,u);if(!this.containerNodes.has(d))continue;let c=r[d];c==null&&(c=0);let h=this.inputLayersTensorIndices[i];a.push([o.name,c,h])}t.inputLayers=a;let s=[];for(let i=0;i<this.outputLayers.length;i++){let o=this.outputLayers[i],u=this.outputLayersNodeIndices[i],d=Uo.nodeKey(o,u);if(!this.containerNodes.has(d))continue;let c=r[d];c==null&&(c=0);let h=this.outputLayersTensorIndices[i];s.push([o.name,c,h])}return t.outputLayers=s,t}static fromConfig(t,r,n={},a=!1){let s={},i={};function o(x,y){x.name in i?i[x.name].push(y):i[x.name]=[y]}function u(x,y){let v=[],b;for(let N of y){let S=N[0],_=N[1],C=N[2];if(b=N[3]==null?{}:N[3],!(S in s)){o(x,y);return}let k=s[S];if(k.inboundNodes.length<=_){o(x,y);return}let I=k.inboundNodes[_];v.push(I.outputTensors[C])}v.length>0&&x.apply(hs(v),b)}function d(x){let y=x.name,v=bo(x,r.customObjects!=null?r.customObjects:{});v.setFastWeightInitDuringBuild(a),s[y]=v,x.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new he(`Corrupted configuration, expected array for nodeData: ${b}`);o(v,b)})}let c=r.name,h=r.layers;for(let x of h)d(x);for(;!FMe(i);)for(let x of h){let y=s[x.name];if(y.name in i){let v=i[y.name];delete i[y.name];for(let b of v)u(y,b)}}let p=[],f=[],g=r.inputLayers;for(let x of g){let y=x[0],v=x[1],b=x[2];Qo(y in s);let N=s[y].inboundNodes[v].outputTensors;p.push(N[b])}let m=r.outputLayers;for(let x of m){let y=x[0],v=x[1],b=x[2];Qo(y in s);let N=s[y].inboundNodes[v].outputTensors;f.push(N[b])}return new t({inputs:p,outputs:f,name:c})}get stateful(){if(this._stateful)throw new he("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let t of this.layers)if(t.stateful)return!0;return!1}resetStates(){ce(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}};function pOe(e,t,r){let n=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(a=>null);if(n===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==n)throw new Error(`Provided ${r} is an array of ${e.length} element(s), but the model has ${n} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){let a=[];return t.forEach(s=>{s in e?a.push(e[s]):a.push(null)}),a}else throw new Error(`The model has multiple (${n}) outputs, so ${r} must be either an array with ${n} elements or an object with ${t} keys. Provided ${r} not understood: ${JSON.stringify(e)}`)}function _X(e,t){return pOe(e,t,"classWeight")}async function kX(e,t,r,n){if(r!=null){let a=ce(()=>{if(e.shape.length===1)return il(e);if(e.shape.length===2){if(e.shape[1]>1)return Eh(e,1);if(e.shape[1]===1)return ue(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await a.data());zt(a);let i=[];return s.forEach(o=>{if(r[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);i.push(r[o])}),Cr(i,"float32")}else return null}function fOe(e,t){return oe(e,t)}var mOe=32;function CX(e,t){let r,n,a=t;r=a.xs,n=a.ys,R.assert(r!=null&&n!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let s=$4("input",e.inputNames,r),i=$4("output",e.outputNames,n),o=s[0].shape[0];R.assert(s.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),R.assert(i.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let u=0;u<s.length;u++)R.assert(s[u].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[u]} has ${s[u].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let u=0;u<i.length;u++)R.assert(i[u].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[u]} has ${i[u].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:s,ys:i}}function $4(e,t,r){if(r instanceof Jt)return[r];if(Array.isArray(r))return R.assert(r.length===t.length,()=>`Received an array of ${r.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),r;{let n=[];for(let a of t){if(r[a]==null)throw new he(`The feature data generated by the dataset lacks the required ${e} key '${a}'.`);n.push(r[a])}return n}}function gOe(e){if(e.length===3)throw new tr("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function xOe(e,t,r){let n=r.batchesPerEpoch!=null;if(R.assert(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),R.assert(r!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),R.assert(r.epochs!=null&&r.epochs>0&&Number.isInteger(r.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${r.epochs}`),R.assert(!n||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${r.batchesPerEpoch}`),R.assert(r.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let a=r.validationData!=null,s,i;if(a)if(R4(r.validationData))R.assert(r.validationBatches==null||r.validationBatches>0&&Number.isInteger(r.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${r.validationBatches}`);else{let x=gOe(r.validationData);s=x.xs,i=x.ys}let o=e.makeTrainFunction(),u=e.getDedupedMetricsNames(),d;a?d=u.slice().concat(u.map(x=>"val_"+x)):d=u.slice();let c=gX(r.callbacks,r.yieldEvery),h=r.verbose==null?1:r.verbose,{callbackList:p,history:f}=xX(c,h,r.epochs,null,null,yOe(t,r),null,a,d);p.setModel(e),e.history=f,await p.onTrainBegin(),e.stopTraining_=!1;let g=r.initialEpoch==null?0:r.initialEpoch,m=await t.iterator();for(;g<r.epochs;){let x={};await p.onEpochBegin(g);let y=0,v=0;for(n||(m=await t.iterator());!n||y<r.batchesPerEpoch;){let b=await m.next();if(n&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${r.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${r.batchesPerEpoch*r.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){let{xs:N,ys:S}=CX(e,b.value),_={};_.batch=v,_.size=N[0].shape[0],await p.onBatchBegin(v,_);let C=[];if(r.classWeight!=null){let T=_X(r.classWeight,e.outputNames);for(let j=0;j<T.length;++j)C.push(await kX(S[j],null,T[j]))}let k=N.concat(S).concat(C),I=o(k);zt(k);for(let T=0;T<u.length;++T){let j=u[T],E=I[T];_[j]=E,Qn(E)}await p.onBatchEnd(v,_),hX(_),v++,y++}if(n?y>=r.batchesPerEpoch:b.done){if(a){let N;R4(r.validationData)?N=Er(await e.evaluateDataset(r.validationData,{batches:r.validationBatches})):N=Er(e.evaluate(s,i,{batchSize:r.validationBatchSize==null?mOe:r.validationBatchSize,verbose:0}));for(let S=0;S<e.metricsNames.length;++S)x[`val_${e.metricsNames[S]}`]=N[S]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(g,x),g++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function yOe(e,t){let r=null;return t.batchesPerEpoch!=null?r=t.batchesPerEpoch:Number.isFinite(e.size)&&(r=e.size),r}function R4(e){return typeof e.iterator=="function"}function vOe(e){return typeof e.next=="function"}async function bOe(e,t,r){r=r||{};let n=r.batches!=null,a=e.testFunction,s=[];if(r.verbose>0)throw new tr("Verbose mode is not implemented yet.");R.assert(!n||r.batches>0&&Number.isInteger(r.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(r.batches)}`);let i=vOe(t)?t:await t.iterator(),o=0,u=0;for(;!n||u<r.batches;){let d=await i.next();if(s=ce(()=>{if(d.value){let{xs:c,ys:h}=CX(e,d.value),p=c.concat(h),f=ce(()=>a(p));if(zt(p),u===0)for(let m=0;m<f.length;++m)s.push(bt(0));let g=p[0].shape[0];for(let m=0;m<f.length;++m){let x=f[m],y=s[m];s[m]=ce(()=>Ne(s[m],oe(g,x))),u>0&&zt(y)}zt(f),o+=g,++u}return s}),d.done){n&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${r.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let d=0;d<s.length;++d){let c=s[d];s[d]=it(s[d],o),zt(c)}return hs(s)}function oI(e){R.assert(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function Ly(e,t,r){return e==null?[null]:Array.isArray(e)?e.map(n=>rh(n,t,r-t)):rh(e,t,r-t)}function qT(e,t){return ce(()=>e==null?null:Array.isArray(e)?e.map(r=>qT(r,t)):nX(e,t.dtype==="int32"?t:Pe(t,"int32")))}function lI(e,t){let r=[],n=0,a=null;for(;n<e;)a=n+t,a>=e&&(a=e),r.push([n,a]),n=a;return r}function IX(e){let t=[];e instanceof Jt&&(e=[e]);for(let r=0;r<e.length;++r){let n=e[r];if(n.rank===1)t.push(Z0(n,1));else{if(n.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(n)}}return t}function eo(e,t){if(e==null)return;let r=[];if(t instanceof Jt)r.push(t.id);else if(Array.isArray(t))t.forEach(a=>r.push(a.id));else if(t!=null)for(let a in t){let s=t[a];r.push(s.id)}let n=[];if(e instanceof Jt)r.indexOf(e.id)===-1&&n.push(e);else if(Array.isArray(e))e.forEach(a=>{r.indexOf(a.id)===-1&&n.push(a)});else if(e!=null)for(let a in e){let s=e[a];r.indexOf(s.id)===-1&&n.push(s)}n.forEach(a=>{a.isDisposed||a.dispose()})}function wOe(e){return e instanceof Jt}function GT(e){return Array.isArray(e)}function D4(e){return!wOe(e)&&!GT(e)}function M4(e,t,r,n=!0,a=""){if(t==null||t.length===0){if(e!=null){let i=!1;if(GT(e)&&e.length>0)i=!0;else if(D4(e)){for(let o in e)if(e.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new he(`Error when checking model ${a} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(i=>null);let s;if(D4(e)){e=e,s=[];for(let i of t){if(e[i]==null)throw new he(`No data provided for "${i}". Need data for each key in: ${t}`);s.push(e[i])}}else if(GT(e)){if(e=e,e.length!==t.length)throw new he(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);s=e}else{if(e=e,t.length>1)throw new he(`The model ${a} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);s=[e]}if(s=IX(s),r!=null)for(let i=0;i<t.length;++i){if(r[i]==null)continue;let o=s[i];if(o.shape.length!==r[i].length)throw new he(`Error when checking ${a}: expected ${t[i]} to have ${r[i].length} dimension(s). but got array with shape ${o.shape}`);for(let u=0;u<r[i].length;++u){if(u===0&&!n)continue;let d=o.shape[u],c=r[i][u];if(c!=null&&c>=0&&d!==c)throw new he(`${a} expected a batch of elements where each example has shape [${r[i].slice(1,r[i].length)}] (i.e.,tensor shape [*,${r[i].slice(1,r[i].length)}]) but the ${a} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return s}function NOe(e,t,r){let n=yc(e.map(s=>s.shape[0]));n.sort();let a=yc(t.map(s=>s.shape[0]));if(a.sort(),n.length>1)throw new he(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(a.length>1)throw new he(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(n.length>0&&a.length>0&&!R.arraysEqual(n,a))throw new he(`Input Tensors should have the same number of samples as target Tensors. Found ${n[0]} input sample(s) and ${a[0]} target sample(s).`)}function SOe(e,t,r){let n=[bf,yC,mb];for(let a=0;a<e.length;++a){let s=e[a],i=t[a],o=r[a];if(i!=null){if(i===mb&&s.shape[s.shape.length-1]===1)throw new he(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(n.indexOf(i)!==-1){let u=s.shape.slice(1),d=o.slice(1);for(let c=0;c<u.length;++c){let h=u[c],p=d[c];if(p!=null&&h!==p)throw new he(`A target Tensor with shape ${s.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function F4(e,t,r,n=!0,a=""){let s;if(Array.isArray(e)){if(e.length!==t.length)throw new he(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);s=e}else{if(t.length>1)throw new he(`The model expects ${t.length} ${a} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);s=[e]}if(r!=null)for(let i=0;i<t.length;++i){if(r[i]==null)continue;let o=s[i];if(o.shape.length!==r[i].length)throw new he(`Error when checking ${a}: expected ${t[i]} to have ${r[i].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let u=0;u<r[i].length;++u){if(u===0&&!n)continue;let d=o.shape[u],c=r[i][u];if(c!=null&&c!==d)throw new he(`Error when checking ${a}: expected ${t[i]} to have shape ${JSON.stringify(r[i])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function _Oe(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(n=>[]);let r;if(typeof e=="string"||typeof e=="function")r=[e];else if(Array.isArray(e)||typeof e=="object")r=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(r))return t.map(n=>r);{let n=[];for(let a of t){let s=r.hasOwnProperty(a)?r[a]:[];Array.isArray(s)||(s=[s]),n.push(s)}return n}}var kOe="layers-model",Kl=class extends hOe{constructor(e){super(e),this.isTraining=!1}summary(e,t,r=console.log){if(!this.built)throw new he("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");iOe(this,e,t,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=sOe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof mu))throw new he("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let s in e.loss)if(this.outputNames.indexOf(s)===-1)throw new he(`Unknown entry in loss dictionary: "${s}". Only expected the following keys: ${this.outputNames}`);for(let s of this.outputNames)e.loss[s]==null&&console.warn(`Output "${s}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${s} during training`),t.push(iI(e.loss[s]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new he(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(s=>iI(s))}else{let s=iI(e.loss);this.outputs.forEach(i=>{t.push(s)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){let i=this.internalOutputShapes[s],o=this.outputNames[s];this.feedOutputNames.push(o),this.feedOutputShapes.push(i),this.feedLossFns.push(this.lossFunctions[s])}let r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],th("loss",()=>{for(let s=0;s<this.outputs.length;++s){if(r.indexOf(s)!==-1)continue;let i=this.lossFunctions[s];this.outputs.length>1&&(this.metricsTensors.push([i,s]),this.metricsNames.push(this.outputNames[s]+"_loss"))}});let n=_Oe(e.metrics,this.outputNames),a=(s,i,o)=>{this.outputNames.length>1&&(i=this.outputNames[s]+"_"+i),this.metricsNames.push(i),this.metricsTensors.push([o,s])};th("metric",()=>{for(let s=0;s<this.outputs.length;++s){if(r.indexOf(s)!==-1)continue;let i=n[s];(o=>{let u="",d,c,h;for(let p of o){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){let g=this.internalOutputShapes[s];g[g.length-1]===1||this.lossFunctions[s]===yC?["accuracy","acc"].indexOf(p)!==-1?c=mM:["crossentropy","ce"].indexOf(p)!==-1&&(c=bX):this.lossFunctions[s]===gS?["accuracy","acc"].indexOf(p)!==-1?c=wX:["crossentropy","ce"].indexOf(p)!==-1&&(c=NX):["accuracy","acc"].indexOf(p)!==-1?c=gM:["crossentropy","ce"].indexOf(p)!==-1&&(c=xM);let m;["accuracy","acc"].indexOf(p)!==-1?m="acc":["crossentropy","ce"].indexOf(p)!==-1&&(m="ce"),h=c,d=u+m}else h=aOe(p),d=u+c1(p);let f;th(d,()=>{f=h}),a(s,d,f)}})(i)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,r={}){let n=r.batchSize==null?32:r.batchSize;oI(n);let a=this.standardizeUserDataXY(e,t,!0,n);try{let s=a[0].concat(a[1]);this.makeTestFunction();let i=this.testFunction,o=this.testLoop(i,s,n,r.verbose,r.steps);return hs(o)}finally{eo(a[0],e),eo(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),bOe(this,e,t)}checkNumSamples(e,t,r,n="steps"){let a;if(r!=null){if(a=null,t!=null)throw new he(`If ${n} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new he(`Either the input data should have a defined shape, or ${n} shoud be specified.`);return a}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new he("`outputs` is an empty Array, which is not allowed.");let r=Array.isArray(t),n=r?t:[t],a=this.retrieveSymbolicTensors(n),s=new pm;if(e instanceof Jt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new he(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let o=0;o<this.inputs.length;++o)s.add(this.inputs[o],e[o])}else for(let o of this.inputs){let u=e[o.name];if(u==null)throw new he(`No value is provided for the model's input ${o.name}`);s.add(o,u)}let i=tv(a,s);return r?i:i[0]}retrieveSymbolicTensors(e){let t=Rh(null,e.length),r=e.length;for(let n of this.layers){let a=Array.isArray(n.output)?n.output:[n.output],s=a.map(i=>i.name);for(let i=0;i<e.length;++i){let o=s.indexOf(e[i]);if(o!==-1&&(t[i]=a[o],r--),r===0)break}if(r===0)break}if(r>0){let n=[];throw t.forEach((a,s)=>{a==null&&n.push(e[s])}),new he(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return t}predictLoop(e,t=32,r=!1){return ce(()=>{let n=this.checkNumSamples(e);if(r)throw new tr("Verbose predictLoop() is not implemented yet.");let a=lI(n,t),s=this.outputs.map(i=>[]);for(let i=0;i<a.length;++i)ce(()=>{let o=a[i][0],u=a[i][1],d=Ly(e,o,u),c=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)c.push({key:this.inputs[p],value:d[p]});else c.push({key:this.inputs[0],value:d});let h=new pm(c);return tv(this.outputs,h)}).forEach((o,u)=>s[u].push(o));return hs(s.map(i=>zr(i,0)))})}predict(e,t={}){let r=IX(e);F4(r,this.inputNames,this.feedInputShapes,!1);try{let n=t.batchSize==null?32:t.batchSize;return oI(n),this.predictLoop(r,n)}finally{eo(r,e)}}predictOnBatch(e){F4(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,r=!0,n){if(this.optimizer_==null)throw new tl("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let s=0;s<this.feedOutputShapes.length;++s){let i=this.feedOutputShapes[s];this.feedLossFns[s]===gS?a.push(i.slice(0,i.length-1).concat([1])):a.push(i)}if(e=M4(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=M4(t,this.feedOutputNames,a,!1,"target"),NOe(e,t),SOe(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&n!=null&&n>0&&e[0].shape[0]%n!==0)throw new he(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${n}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,r,n,a=!0,s){let[i,o]=this.standardizeUserDataXY(e,t,a,s);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(n!=null){let d=_X(n,this.outputNames);u=[];for(let c=0;c<d.length;++c)u.push(await kX(o[c],null,d[c]))}return[i,o,u]}testLoop(e,t,r,n=0,a){return ce(()=>{let s=this.checkNumSamples(t,r,a,"steps"),i=[];if(n>0)throw new tr("Verbose mode is not implemented yet.");if(a!=null)throw new tr("steps mode in testLoop() is not implemented yet");{let o=lI(s,r),u=Cr(Eo(0,s));for(let d=0;d<o.length;++d){let c=o[d][0],h=o[d][1],p=rh(u,c,h-c),f=qT(t,p),g=e(f);if(d===0)for(let m=0;m<g.length;++m)i.push(bt(0));for(let m=0;m<g.length;++m){let x=g[m];i[m]=Ne(i[m],oe(h-c,x))}}for(let d=0;d<i.length;++d)i[d]=it(i[d],s)}return i})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let r=0;r<e.length;++r){let n=e[r],a=n;if(w4(e,n)>1){let s=w4(e.slice(0,r),n);a+=`_${s}`}t.push(a)}return t}makeTrainFunction(){return e=>{let t=[],r=e.slice(0,this.inputs.length),n=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),s=[],i=()=>{let u=[];for(let p=0;p<this.inputs.length;++p)u.push({key:this.inputs[p],value:r[p]});let d=new pm(u),c=tv(this.outputs,d,{training:!0}),h;for(let p=0;p<this.lossFunctions.length;++p){let f=this.lossFunctions[p],g=f(n[p],c[p]);a[p]!=null&&(g=fOe(g,a[p]));let m=mn(g);t.push(m),p===0?h=g:h=Ne(h,g)}for(let p=0;p<this.metricsTensors.length;++p){let f;if(this.outputs.length>1&&p<this.outputs.length)f=t[p];else{let g=this.metricsTensors[p][0],m=this.metricsTensors[p][1];f=mn(g(n[m],c[m]))}Qn(f),s.push(f)}return h=mn(h),this.calculateLosses().forEach(p=>{h=Ne(h,p)}),h},o=this.collectedTrainableWeights.map(u=>u.read());return[this.optimizer_.minimize(i,!0,o)].concat(s)}}makeTestFunction(){this.testFunction=e=>ce(()=>{let t=[],r,n=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let u=0;u<this.inputs.length;++u)s.push({key:this.inputs[u],value:n[u]});let i=new pm(s),o=tv(this.outputs,i);for(let u=0;u<this.lossFunctions.length;++u){let d=this.lossFunctions[u],c=mn(d(a[u],o[u]));u===0?r=c:r=Ne(r,c),t.push(r)}for(let u=0;u<this.metricsTensors.length;++u){let d=this.metricsTensors[u][0],c=this.metricsTensors[u][1],h=mn(d(a[c],o[c]));t.push(h)}return t})}async fit(e,t,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let n,a,s,i,o,u,d,c,h;try{let p=r.batchSize==null?32:r.batchSize;oI(p);let f=await this.standardizeUserData(e,t,r.sampleWeight,r.classWeight,!1,p);n=f[0],a=f[1],h=f[2];let g=!1,m;if(r.validationData!=null&&r.validationData.length>0){if(g=!0,r.validationData.length===2)o=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new tr("validationData including sample weights is not supported yet."):new he(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);let _=await this.standardizeUserData(o,u,null,null,!0,p);d=_[0],c=_[1],m=d.concat(c)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){g=!0;let _=Math.floor(n[0].shape[0]*(1-r.validationSplit)),C=n[0].shape[0];d=Ly(n,_,C),s=n,n=Ly(n,0,_),c=Ly(a,_,C),i=a,a=Ly(a,0,_),m=d.concat(c)}else r.validationSteps!=null&&(g=!0);let x=n.concat(a).concat(h);this.checkTrainableWeightsConsistency();let y=this.makeTrainFunction(),v=this.getDedupedMetricsNames(),b,N;g?(this.makeTestFunction(),b=this.testFunction,N=v.slice().concat(v.map(_=>"val_"+_))):(b=null,m=[],N=v.slice());let S=gX(r.callbacks,r.yieldEvery);return await this.fitLoop(y,x,v,p,r.epochs,r.verbose,S,b,m,r.shuffle,N,r.initialEpoch,null,null)}finally{this.isTraining=!1,eo(n,e),eo(a,t),eo(s,e),eo(i,t),eo(d,o),eo(c,u),h!=null&&zt(h)}}async fitLoop(e,t,r,n,a,s,i,o,u,d,c,h,p,f){n==null&&(n=32),a==null&&(a=1),d==null&&(d=!0),h==null&&(h=0);let g=!1;if(o!=null&&u!=null&&(g=!0),f!=null&&(g=!0,p==null))throw new he("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let m=this.checkNumSamples(t,n,p,"steps_per_epoch"),x;m!=null&&(x=Eo(0,m)),s==null&&(s=1);let{callbackList:y,history:v}=xX(i,s,a,h,m,p,n,g,c);y.setModel(this),this.history=v,await y.onTrainBegin(),this.stopTraining_=!1;for(let b=h;b<a;++b){await y.onEpochBegin(b);let N={};if(p!=null)throw new tr("stepsPerEpoch mode is not implemented yet.");{if(d==="batch")throw new tr("batch shuffling is not implemneted yet");d&&R.shuffle(x);let S=Cr(x),_=lI(m,n);for(let C=0;C<_.length;++C){let k={};if(await y.onBatchBegin(C,k),ce(()=>{let I=_[C][0],T=_[C][1],j=rh(S,I,T-I);k.batch=C,k.size=T-I;let E=qT(t,j),O=e(E);for(let M=0;M<r.length;++M){let W=r[M],q=O[M];k[W]=q,Qn(q)}if(C===_.length-1&&g){let M=this.testLoop(o,u,n);for(let W=0;W<r.length;++W){let q=r[W],P=M[W];Qn(P),N["val_"+q]=P}}}),await y.onBatchEnd(C,k),hX(k),this.stopTraining_)break}S.dispose()}if(await y.onEpochEnd(b,N),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return xOe(this,e,t)}async trainOnBatch(e,t){let r=await this.standardizeUserData(e,t),n=r[0],a=r[1],s=this.makeTrainFunction()(n.concat(a)),i=[];for(let o of s){let u=await o.data();i.push(u[0])}return zt(s),eo(r[0],e),eo(r[1],t),hs(i)}getNamedWeights(e){let t=[],r=e!=null&&e.trainableOnly,n=r?this.trainableWeights:this.weights,a=this.getWeights(r);for(let s=0;s<n.length;++s)r&&!n[s].trainable||t.push({name:n[s].originalName,tensor:a[s]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let t=ET().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-ET().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Ml(this.loss);else if(Array.isArray(this.loss)){for(let t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>Ml(t))}else{let t=Object.keys(this.loss);e={};let r=this.loss;for(let n of t)if(typeof r[n]=="string")e[n]=Ml(r[n]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Ml(c1(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Ml(c1(e)));{let e={};for(let t in this.metrics)e[t]=Ml(c1(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let t=gb(e.optimizer_config),r=bo(t),n;if(typeof e.loss=="string")n=Td(e.loss);else if(Array.isArray(e.loss))n=e.loss.map(s=>Td(s));else if(e.loss!=null){n={};for(let s in e.loss)n[s]=Td(e.loss[s])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(s=>Td(s));else if(e.metrics!=null){a={};for(let s in e.metrics)a[s]=Td(e.metrics[s])}this.compile({loss:n,metrics:a,optimizer:r})}async save(e,t){if(typeof e=="string"){let a=Na.getSaveHandlers(e);if(a.length===0)throw new he(`Cannot find any save handlers for URL '${e}'`);if(a.length>1)throw new he(`Found more than one (${a.length}) save handlers for URL '${e}'`);e=a[0]}if(e.save==null)throw new he("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let r=await Na.encodeWeights(this.getNamedWeights(t)),n={modelTopology:this.toJSON(null,!1),format:kOe,generatedBy:`TensorFlow.js tfjs-layers v${yM}`,convertedBy:null};if(t!=null&&t.includeOptimizer&&this.optimizer!=null){n.trainingConfig=this.getTrainingConfig();let a="optimizer",{data:s,specs:i}=await Na.encodeWeights(await this.optimizer.getWeights(),a);r.specs.push(...i),r.data=Na.concatenateArrayBuffers([r.data,s])}return this.userDefinedMetadata!=null&&(A4(this.userDefinedMetadata,this.name,!0),n.userDefinedMetadata=this.userDefinedMetadata),n.weightData=r.data,n.weightSpecs=r.specs,e.save(n)}setUserDefinedMetadata(e){A4(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};Kl.className="Model";Re.registerClass(Kl);var EX=class extends Kl{};EX.className="Functional";Re.registerClass(EX);async function COe(e,t){"modelTopology"in e||(e={modelTopology:e}),e=e;let r=e.modelTopology;r.model_config!=null&&(r=r.model_config);let n=gb(r),a=bo(n,t);if(e.weightsManifest!=null){let s=await Na.loadWeights(e.weightsManifest,e.pathPrefix,a.weights.map(o=>o.originalName)),i={};for(let o of a.weights)i[o.originalName]=s[o.originalName];a.loadWeights(i),zt(s)}return a}async function IOe(e,t){if(t==null&&(t={}),typeof e=="string"){let r=Na.getLoadHandlers(e,t);if(r.length===0)r.push(Na.browserHTTPRequest(e,t));else if(r.length>1)throw new he(`Found more than one (${r.length}) load handlers for URL '${e}'`);e=r[0]}return EOe(e,void 0,t)}async function EOe(e,t,r){if(r==null&&(r={}),e.load==null)throw new he("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let n=await e.load(),a=n.modelTopology;a.model_config!=null&&(a=a.model_config);let s=r.strict==null?!0:r.strict,i=n.weightData!=null&&n.weightSpecs!=null&&s,o=bo(gb(a),t,i),u=n.trainingConfig;if(u!=null&&o.loadTrainingConfig(u),n.userDefinedMetadata!=null&&o.setUserDefinedMetadata(n.userDefinedMetadata),n.weightData!=null){if(n.weightSpecs==null)throw new he("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:d,optimizerWeights:c}=TOe(n.weightData,n.weightSpecs);o.loadWeights(d,s),o.optimizer!=null&&c.length>0&&await o.optimizer.setWeights(c),zt(d),zt(c.map(h=>h.tensor))}return o}function TOe(e,t){let r=Na.decodeWeights(e,t),n={},a=[];return t.forEach(s=>{s.group==="optimizer"?a.push({name:s.name,tensor:r[s.name]}):n[s.name]=r[s.name]}),{modelWeights:n,optimizerWeights:a}}var vC=class KT extends Kl{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:oC("sequential_"),t.layers!=null)for(let r of t.layers)this.add(r)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new he(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){let r=t instanceof KT||t instanceof Kl,n;if(r){if(n=t,n.outputs.length!==1)throw new he("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new he("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new he("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let a=oX({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(a)}if(r)this.outputs=n.outputs,this.inputs=n.inputs;else{if(t.inboundNodes.length!==1)throw new he(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new he("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=iX(this.outputs[0])}this.inboundNodes=[],new gC({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Rh(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(a=>a.shape),outputShapes:this.outputs[0].shape})}else{let a=t.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,r){return this.model==null&&this.build(),this.model.call(t,r)}build(t){if(vr(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Kl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,r,n=console.log){this.built||this.build(),super.summary(t,r,n)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,r,n={}){if(!this.built)throw new tl("The model needs to be compiled before being used.");return this.model.evaluate(t,r,n)}async evaluateDataset(t,r){if(!this.built)throw new tl("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,r)}predict(t,r={}){return this.model==null&&this.build(),this.model.predict(t,r)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,r,n={}){if(!this.built)throw new tl("The model needs to be compiled before being used.");return this.model.fit(t,r,n)}async fitDataset(t,r){if(!this.built)throw new tl("The model needs to be compiled before being used.");return this.model.fitDataset(t,r)}async trainOnBatch(t,r){return this.model.trainOnBatch(t,r)}static fromConfig(t,r,n={},a=!1){let s,i={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new he("Legacy serialization format not supported yet.");s=r}else R.assert(r.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=r.layers,delete r.layers,i=r;let o=new t(i);if(!(o instanceof KT))throw new tr(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(let u of s){let d=bo(u,void 0,a);a&&d.setFastWeightInitDuringBuild(!0),o.add(d)}return o}set stopTraining(t){if(this.model==null)throw new he("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new he("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let t=[];for(let r of this.layers){let n={};n.className=r.getClassName(),n.config=r.getConfig(),t.push(n)}return{name:this.name,layers:t}}};vC.className="Sequential";Re.registerClass(vC);function jOe(e){return new Kl(e)}function AOe(e){return new vC(e)}function TX(e){return oX(e)}function $Oe(e,t){pM.registerCallbackConstructor(e,t)}var Oa=class extends Re.Serializable{getConfig(){return{}}},jX=class extends Oa{apply(e,t=1){return YMe(e,t)}};jX.className="elu";Re.registerClass(jX);var AX=class extends Oa{apply(e){return Vk(e)}};AX.className="selu";Re.registerClass(AX);var $X=class extends Oa{apply(e){return Tr(e)}};$X.className="relu";Re.registerClass($X);var RX=class extends Oa{apply(e){return ce(()=>$c(6,Tr(e)))}};RX.className="relu6";Re.registerClass(RX);var DX=class extends Oa{apply(e){return e}};DX.className="linear";Re.registerClass(DX);var MX=class extends Oa{apply(e){return Wi(e)}};MX.className="sigmoid";Re.registerClass(MX);var FX=class extends Oa{apply(e){return ZMe(e)}};FX.className="hardSigmoid";Re.registerClass(FX);var OX=class extends Oa{apply(e){return xf(e)}};OX.className="softplus";Re.registerClass(OX);var PX=class extends Oa{apply(e){return JMe(e)}};PX.className="softsign";Re.registerClass(PX);var LX=class extends Oa{apply(e){return Ac(e)}};LX.className="tanh";Re.registerClass(LX);var vM=class extends Oa{apply(e,t=-1){return ad(e,t)}};vM.className="softmax";Re.registerClass(vM);var zX=class extends Oa{apply(e,t=-1){return Ok(e,t)}};zX.className="logSoftmax";Re.registerClass(zX);var BX=class extends Oa{apply(e){return ce(()=>ce(()=>{let t=Math.sqrt(2),r=oe(.5,Ne(1,Dk(it(e,t))));return oe(e,r)}))}};BX.className="gelu";Re.registerClass(BX);var UX=class extends Oa{apply(e){return ce(()=>oe(.5,oe(e,Ne(1,Ac(oe(ha(it(2,Math.PI)),Ne(e,oe(.044715,pl(e,3)))))))))}};UX.className="gelu_new";Re.registerClass(UX);var WX=class extends Oa{apply(e){return ce(()=>oe(e,Ac(xf(e))))}};WX.className="mish";Re.registerClass(WX);var VX=class extends Oa{apply(e,t=1){return ce(()=>oe(Wi(oe(e,t)),e))}};VX.className="swish";Re.registerClass(VX);function Mc(e){return e.getClassName()}function uI(e,t={}){return J0(e,Re.SerializationMap.getMap().classNameMap,t,"activation")}function Fc(e){if(e==null){let t={};return t.className="linear",t.config={},uI(t)}if(typeof e=="string"){let t={};return t.className=e,t.config={},uI(t)}else return e instanceof Oa?e:uI(e)}function bM(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}var HX=class extends Re.Serializable{},nw=class extends HX{constructor(e){super(),bM(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ce(()=>{let t=gn([1]);return this.hasL1&&(t=Ne(t,ht(oe(this.l1,Fn(e))))),this.hasL2&&(t=Ne(t,ht(oe(this.l2,ew(e))))),ue(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};nw.className="L1L2";Re.registerClass(nw);function ROe(e){return bM(e),new nw({l1:e!=null?e.l1:null,l2:0})}function DOe(e){return bM(e),new nw({l2:e!=null?e.l2:null,l1:0})}var O4={l1l2:"L1L2"};function Qr(e){return YD(e)}function P4(e,t={}){return J0(e,Re.SerializationMap.getMap().classNameMap,t,"regularizer")}function cn(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in O4?O4[e]:e,config:{}};return P4(t)}else return e instanceof HX?e:P4(e)}var wM=class extends rr{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Rt(e);let r=Tr(e);return this.maxValue!=null&&(r=Ma(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};wM.className="ReLU";Re.registerClass(wM);var NM=class extends rr{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let r=Rt(e);return B0(r,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};NM.className="LeakyReLU";Re.registerClass(NM);var SM=class extends rr{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=un(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=cn(e.alphaRegularizer),this.alphaConstraint=Zn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new he(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=vr(e);let t=e.slice(1);if(this.sharedAxes!=null)for(let n of this.sharedAxes)t[n-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let r={};if(this.sharedAxes!=null)for(let n=1;n<e.length;++n)r[n]=e[n];this.inputSpec=[new Pn({ndim:e.length,axes:r})],this.built=!0}call(e,t){return e=Rt(e),G0(e,this.alpha.read())}getConfig(){let e={alphaInitializer:xn(this.alphaInitializer),alphaRegularizer:Qr(this.alphaRegularizer),alphaConstraint:Jn(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};SM.className="PReLU";Re.registerClass(SM);var _M=class extends rr{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new tr(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let r=Rt(e);return Zx(r)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};_M.className="ELU";Re.registerClass(_M);var kM=class extends rr{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){let r=Rt(e);return oe(r,Pe(as(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};kM.className="ThresholdedReLU";Re.registerClass(kM);var CM=class extends rr{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new vM().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return ce(()=>{let r=Rt(e),n=t.mask;if(n!=null){let a=oe(Ze(fs(r.shape),Pe(n,r.dtype)),bt(-1e9));r=Ne(r,a)}return this.axis instanceof Array?this.axis.length>1?Fa(Ze(r,W0(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};CM.className="Softmax";Re.registerClass(CM);function jm(e,t,r){if(typeof e=="number")return Rh(e,t);if(e.length!==t)throw new he(`The ${r} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let n=0;n<t;++n){let a=e[n];if(!GMe(a))throw new he(`The ${r} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${a}`)}return e}function wo(e,t,r,n,a=1){if(e==null)return e;let s=t+(t-1)*(a-1),i;return r==="same"?i=e:i=e-s+1,Math.floor((i+n-1)/n)}function Xo(e,t,r,n){if(e==null)return null;if(n==="valid")e=e*t+Dc([r-t,0]);else if(n==="same")e=e*t;else throw new he(`Unsupport padding mode: ${n}.`);return e}function IM(e,t){return ce(()=>(Dn(t),t==="channelsFirst"?Kt(e,[0,2,3,1]):e))}function qX(e,t){return ce(()=>(Dn(t),t==="channelsFirst"?Kt(e,[0,2,3,4,1]):e))}function MOe(e,t,r,n=1,a="valid",s,i=1){return ce(()=>{if(s==null&&(s=To()),Dn(s),e.shape.length!==3)throw new he(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new he(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(r!=null&&r.shape.length!==1)throw new he(`The bias for a conv1dWithBias operation should be 1, but is ${r.shape.length} instead`);if(s==="channelsFirst"&&(e=Kt(e,[0,2,1])),a==="causal")throw new tr("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=jk(e,t,n,a==="same"?"same":"valid","NWC",i);return r!=null&&(o=Oo(o,r)),o})}function L4(e,t,r,n=[1,1],a="valid",s,i,o=null){return ce(()=>{if(s==null&&(s=To()),Dn(s),e.rank!==3&&e.rank!==4)throw new he(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new he(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let u=IM(e,s);if(a==="causal")throw new tr("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=gg.conv2d({x:u,filter:t,strides:n,pad:a==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:r,activation:o}),s==="channelsFirst"&&(u=Kt(u,[0,3,1,2])),u})}function FOe(e,t,r,n=[1,1,1],a="valid",s,i){return ce(()=>{if(s==null&&(s=To()),Dn(s),e.rank!==4&&e.rank!==5)throw new he(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new he(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=qX(e,s);if(a==="causal")throw new tr("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=tD(o,t,n,a==="same"?"same":"valid","NDHWC",i),r!=null&&(o=Oo(o,r)),s==="channelsFirst"&&(o=Kt(o,[0,4,1,2,3])),o})}var GX=class KX extends rr{constructor(t,r){if(super(r),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",KX.verifyArgs(r),this.rank=t,ca(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new tr(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=jm(r.kernelSize,t,"kernelSize"),this.strides=jm(r.strides==null?1:r.strides,t,"strides"),this.padding=r.padding==null?"valid":r.padding,Ci(this.padding),this.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,Dn(this.dataFormat),this.activation=Fc(r.activation),this.useBias=r.useBias==null?!0:r.useBias,this.biasInitializer=un(r.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Zn(r.biasConstraint),this.biasRegularizer=cn(r.biasRegularizer),this.activityRegularizer=cn(r.activityRegularizer),this.dilationRate=jm(r.dilationRate==null?1:r.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new he(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new he(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new he(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(Qo("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!JD(t.kernelSize,"number",1,3))throw new he(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){let t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Mc(this.activation),useBias:this.useBias,biasInitializer:xn(this.biasInitializer),biasRegularizer:Qr(this.biasRegularizer),activityRegularizer:Qr(this.activityRegularizer),biasConstraint:Jn(this.biasConstraint)},r=super.getConfig();return Object.assign(t,r),t}},bC=class QX extends GX{constructor(t,r){super(t,r),this.kernel=null,QX.verifyArgs(r),this.filters=r.filters,ca(this.filters,"filters"),this.kernelInitializer=un(r.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Zn(r.kernelConstraint),this.kernelRegularizer=cn(r.kernelRegularizer)}build(t){t=vr(t);let r=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[r]==null)throw new he(`The channel dimension of the input should be defined. Found ${t[r]}`);let n=t[r],a=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[r]:n}}],this.built=!0}call(t,r){return ce(()=>{t=Rt(t);let n,a=this.bias==null?null:this.bias.read(),s=YQ(this.activation.getClassName());if(s!=null&&this.rank===2)n=L4(t,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)n=MOe(t,this.kernel.read(),a,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)n=L4(t,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)n=FOe(t,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new tr("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(n=this.activation.apply(n))}return n})}computeOutputShape(t){t=vr(t);let r=[],n=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<n.length;++s){let i=wo(n[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);r.push(i)}let a=[t[0]];return this.dataFormat==="channelsLast"?(a=a.concat(r),a.push(this.filters)):(a.push(this.filters),a=a.concat(r)),a}getConfig(){let t={filters:this.filters,kernelInitializer:xn(this.kernelInitializer),kernelRegularizer:Qr(this.kernelRegularizer),kernelConstraint:Jn(this.kernelConstraint)},r=super.getConfig();return Object.assign(t,r),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new he(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}},wC=class XX extends bC{constructor(t){super(2,t),XX.verifyArgs(t)}getConfig(){let t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!JD(t.kernelSize,"number",1,2))throw new he(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}};wC.className="Conv2D";Re.registerClass(wC);var NC=class YX extends bC{constructor(t){super(3,t),YX.verifyArgs(t)}getConfig(){let t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new he(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}};NC.className="Conv3D";Re.registerClass(NC);var EM=class extends wC{constructor(e){if(super(e),this.inputSpec=[new Pn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new he(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=vr(e),e.length!==4)throw new he("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new he("The channel dimension of the inputs should be defined. Found `None`.");let r=e[t],n=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",n,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Pn({ndim:4,axes:{[t]:r}})],this.built=!0}call(e,t){return ce(()=>{let r=Rt(e);if(r.shape.length!==4)throw new he(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);let n=r.shape,a=n[0],s,i;this.dataFormat==="channelsFirst"?(s=2,i=3):(s=1,i=2);let o=n[s],u=n[i],d=this.kernelSize[0],c=this.kernelSize[1],h=this.strides[0],p=this.strides[1],f=Xo(o,h,d,this.padding),g=Xo(u,p,c,this.padding),m=[a,f,g,this.filters];this.dataFormat!=="channelsLast"&&(r=Kt(r,[0,2,3,1]));let x=Ak(r,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=Kt(x,[0,3,1,2])),this.bias!=null&&(x=Oo(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=vr(e);let t=e.slice(),r,n,a;this.dataFormat==="channelsFirst"?(r=1,n=2,a=3):(r=3,n=1,a=2);let s=this.kernelSize[0],i=this.kernelSize[1],o=this.strides[0],u=this.strides[1];return t[r]=this.filters,t[n]=Xo(t[n],o,s,this.padding),t[a]=Xo(t[a],u,i,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};EM.className="Conv2DTranspose";Re.registerClass(EM);var TM=class extends NC{constructor(e){if(super(e),this.inputSpec=[new Pn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new he(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=vr(e),e.length!==5)throw new he("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new he("The channel dimension of the inputs should be defined. Found `None`.");let r=e[t],n=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",n,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Pn({ndim:5,axes:{[t]:r}})],this.built=!0}call(e,t){return ce(()=>{let r=Rt(e);if(r.shape.length!==5)throw new he(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);let n=r.shape,a=n[0],s,i,o;this.dataFormat==="channelsFirst"?(o=2,s=3,i=4):(o=1,s=2,i=3);let u=n[o],d=n[s],c=n[i],h=this.kernelSize[0],p=this.kernelSize[1],f=this.kernelSize[2],g=this.strides[0],m=this.strides[1],x=this.strides[2],y=Xo(u,g,h,this.padding),v=Xo(d,m,p,this.padding),b=Xo(c,x,f,this.padding),N=[a,y,v,b,this.filters];this.dataFormat!=="channelsLast"&&(r=Kt(r,[0,2,3,4,1]));let S=rD(r,this.kernel.read(),N,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Kt(S,[0,4,1,2,3])),this.bias!==null&&(S=Oo(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=vr(e);let t=e.slice(),r,n,a,s;this.dataFormat==="channelsFirst"?(r=1,n=2,a=3,s=4):(r=4,n=1,a=2,s=3);let i=this.kernelSize[0],o=this.kernelSize[1],u=this.kernelSize[2],d=this.strides[0],c=this.strides[1],h=this.strides[2];return t[r]=this.filters,t[n]=Xo(t[n],d,i,this.padding),t[a]=Xo(t[a],c,o,this.padding),t[s]=Xo(t[s],h,u,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};TM.className="Conv3DTranspose";Re.registerClass(TM);var JX=class extends bC{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new he("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new he("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new he(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=un(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=cn(t.depthwiseRegularizer),this.depthwiseConstraint=Zn(t.depthwiseConstraint),this.pointwiseInitializer=un(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=cn(t.pointwiseRegularizer),this.pointwiseConstraint=Zn(t.pointwiseConstraint)}build(e){if(e=vr(e),e.length<this.rank+2)throw new he(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new he(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);let r=e[t],n=this.kernelSize.concat([r,this.depthMultiplier]),a=[];for(let i=0;i<this.rank;++i)a.push(1);a.push(r*this.depthMultiplier,this.filters);let s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",n,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new Pn({ndim:this.rank+2,axes:{[t]:r}})],this.built=!0}call(e,t){return ce(()=>{e=Rt(e);let r;if(this.rank===1)throw new tr("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Kt(e,[0,2,3,1])),r=ny(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Oo(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Kt(r,[0,3,1,2])),r})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=xn(this.depthwiseInitializer),e.pointwiseInitializer=xn(this.pointwiseInitializer),e.depthwiseRegularizer=Qr(this.depthwiseRegularizer),e.pointwiseRegularizer=Qr(this.pointwiseRegularizer),e.depthwiseConstraint=Jn(this.depthwiseConstraint),e.pointwiseConstraint=Jn(this.pointwiseConstraint),e}};JX.className="SeparableConv";var jM=class extends JX{constructor(e){super(2,e)}};jM.className="SeparableConv2D";Re.registerClass(jM);var AM=class ZX extends bC{constructor(t){super(1,t),ZX.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){let t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!JD(t.kernelSize,"number",1,1))throw new he(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}};AM.className="Conv1D";Re.registerClass(AM);var $M=class extends rr{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return ce(()=>{if(e=Rt(e),this.dataFormat==="channelsLast"){let r=u1(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return u1(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let r=u1(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return u1(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};$M.className="Cropping2D";Re.registerClass($M);var RM=class extends rr{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Dn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,VMe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let t=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,r]}else{let t=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],t,r,e[3]]}}call(e,t){return ce(()=>{let r=Rt(e),n=r.shape;if(this.dataFormat==="channelsFirst"){r=Kt(r,[0,2,3,1]);let a=this.size[0]*n[2],s=this.size[1]*n[3],i=this.interpolation==="nearest"?li.resizeNearestNeighbor(r,[a,s]):li.resizeBilinear(r,[a,s]);return Kt(i,[0,3,1,2])}else{let a=this.size[0]*n[1],s=this.size[1]*n[2];return this.interpolation==="nearest"?li.resizeNearestNeighbor(r,[a,s]):li.resizeBilinear(r,[a,s])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};RM.className="UpSampling2D";Re.registerClass(RM);function OOe(e,t,r=[1,1],n="valid",a,s){return ce(()=>{a==null&&(a=To()),Dn(a);let i=IM(e,a);if(e.rank!==4)throw new he(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new he(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return i=gf(i,t,r,n==="same"?"same":"valid","NHWC",s),a==="channelsFirst"&&(i=Kt(i,[0,3,1,2])),i})}var DM=class extends GX{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=un(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Zn(e.depthwiseConstraint),this.depthwiseRegularizer=cn(e.depthwiseRegularizer)}build(e){if(e=vr(e),e.length<4)throw new he(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new he(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);let r=e[t],n=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",n,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ce(()=>{e=Rt(e);let r=OOe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Oo(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=vr(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],n=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=wo(t,this.kernelSize[0],this.padding,this.strides[0]),s=wo(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],n,a,s]:[e[0],a,s,n]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=xn(this.depthwiseInitializer),e.depthwiseRegularizer=Qr(this.depthwiseRegularizer),e.depthwiseConstraint=Jn(this.depthwiseRegularizer),e}};DM.className="DepthwiseConv2D";Re.registerClass(DM);function eY(e,t,r,n){if(Array.isArray(e)){if(t!=null||r!=null)throw new he("When inputs is an array, neither initialState or constants should be provided");n!=null&&(r=e.slice(e.length-n,e.length),e=e.slice(0,e.length-n)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(s){return s==null||Array.isArray(s)?s:[s]}return t=a(t),r=a(r),{inputs:e,initialState:t,constants:r}}function tY(e,t,r,n=!1,a,s,i=!1,o=!1){return ce(()=>{let u=t.shape.length;if(u<3)throw new he(`Input should be at least 3D, but is ${u}D.`);let d=[1,0].concat(Eo(2,u));t=Kt(t,d),s!=null,i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=Pe(Pe(a,"bool"),"float32"),a.rank===u-1&&(a=la(a,-1)),a=Kt(a,d)),n&&(t=Si(t,0),a!=null&&(a=Si(a,0)));let c=[],h,p=r,f=t.shape[0],g=Cn(t),m;a!=null&&(m=Cn(a));for(let y=0;y<f;++y){let v=g[y],b=ce(()=>e(v,p));if(a==null)h=b[0],p=b[1];else{let N=ce(()=>{let S=m[y],_=Ze(Js(S),S),C=Ne(oe(b[0],S),oe(p[0],_)),k=p.map((I,T)=>Ne(oe(b[1][T],S),oe(I,_)));return{output:C,newStates:k}});h=N.output,p=N.newStates}o&&c.push(h)}let x;return o&&(x=Bn(c,1)),[h,x,p]})}var gu=class rY extends rr{constructor(t){super(t);let r;if(t.cell==null)throw new he("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?r=new kC({cells:t.cell}):r=t.cell,r.stateSize==null)throw new he("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=r,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new Pn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Eo(0,t).map(r=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){UT(t)&&(t=t[0]),t=t;let r=this.cell.stateSize;Array.isArray(r)||(r=[r]);let n=r[0],a;if(this.returnSequences?a=[t[0],t[1],n]:a=[t[0],n],this.returnState){let s=[];for(let i of r)s.push([t[0],i]);return[a].concat(s)}else return a}computeMask(t,r){return ce(()=>{Array.isArray(r)&&(r=r[0]);let n=this.returnSequences?r:null;if(this.returnState){let a=this.states.map(s=>null);return[n].concat(a)}else return n})}get states(){if(this.states_==null){let t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[];for(let n=0;n<t;++n)r.push(null);return r}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new tr("Constants support is not implemented in RNN yet.");UT(t)&&(t=t[0]),t=t;let r=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new Pn({shape:[r,null,...n]});let a=[t[0]].concat(t.slice(2));this.cell.build(a);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!R.arraysEqual(this.stateSpec.map(i=>i.shape[i.shape.length-1]),s))throw new he(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(i=>new Pn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(t,r=!1){ce(()=>{if(!this.stateful)throw new Ou("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape[0];if(n==null)throw new he("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>gn([n,a])):this.states_=[gn([n,this.cell.stateSize])];else if(t==null)zt(this.states_),this.keptStates!=null&&(zt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>gn([n,a])):this.states_[0]=gn([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new he(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);r===!0?this.keptStates.push(this.states_.slice()):zt(this.states_);for(let a=0;a<this.states_.length;++a){let s=t[a],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[a]:this.cell.stateSize,o=[n,i];if(!R.arraysEqual(s.shape,o))throw new he(`State ${a} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${s.shape}`);this.states_[a]=s}}this.states_=this.states_.map(a=>Qn(a.clone()))})}apply(t,r){let n=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});let s=eY(t,n,a,this.numConstants);t=s.inputs,n=s.initialState,a=s.constants;let i=[],o=[];if(n!=null){r.initialState=n,i=i.concat(n),this.stateSpec=[];for(let u of n)this.stateSpec.push(new Pn({shape:u.shape}));o=o.concat(this.stateSpec)}if(a!=null&&(r.constants=a,i=i.concat(a),this.numConstants=a.length),i[0]instanceof jo){let u=[t].concat(i),d=this.inputSpec.concat(o),c=this.inputSpec;this.inputSpec=d;let h=super.apply(u,r);return this.inputSpec=c,h}else return super.apply(t,r)}call(t,r){return ce(()=>{let n=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;t=Rt(t),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(t));let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==i)throw new he(`RNN Layer has ${i} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let o={training:a},u=tY((f,g)=>{let m=this.cell.call([f].concat(g),o);return[m[0],m.slice(1)]},t,s,this.goBackwards,n,null,this.unroll,this.returnSequences),d=u[0],c=u[1],h=u[2];this.stateful&&this.resetStates(h,a);let p=this.returnSequences?c:d;return this.returnState?[p].concat(h):p})}getInitialState(t){return ce(()=>{let r=gn(t.shape);return r=ht(r,[1,2]),r=Z0(r),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(n=>n>1?zT(r,[1,n]):r):this.cell.stateSize>1?[zT(r,[1,this.cell.stateSize])]:[r]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){let t=super.getConfig(),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(r.numConstants=this.numConstants);let n=this.cell.getConfig();return this.getClassName()===rY.className&&(r.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),t),r)}static fromConfig(t,r,n={}){let a=r.cell,s=bo(a,n);return new t(Object.assign(r,{cell:s}))}};gu.className="RNN";Re.registerClass(gu);var aw=class extends rr{},SC=class extends aw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,ca(this.units,"units"),this.activation=Fc(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=un(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=un(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=un(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=cn(e.kernelRegularizer),this.recurrentRegularizer=cn(e.recurrentRegularizer),this.biasRegularizer=cn(e.biasRegularizer),this.kernelConstraint=Zn(e.kernelConstraint),this.recurrentConstraint=Zn(e.recurrentConstraint),this.biasConstraint=Zn(e.biasConstraint),this.dropout=xg([1,Dc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=xg([1,Dc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=vr(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ce(()=>{if(e=e,e.length!==2)throw new he(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];let n=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Oc({ones:()=>Js(e),rate:this.dropout,training:n,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Oc({ones:()=>Js(r),rate:this.recurrentDropout,training:n,dropoutFunc:this.dropoutFunc}));let a,s=this.dropoutMask,i=this.recurrentDropoutMask;s!=null?a=ll(oe(e,s),this.kernel.read()):a=ll(e,this.kernel.read()),this.bias!=null&&(a=Oo(a,this.bias.read())),i!=null&&(r=oe(r,i));let o=Ne(a,ll(r,this.recurrentKernel.read()));return this.activation!=null&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Mc(this.activation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),recurrentInitializer:xn(this.recurrentInitializer),biasInitializer:xn(this.biasInitializer),kernelRegularizer:Qr(this.kernelRegularizer),recurrentRegularizer:Qr(this.recurrentRegularizer),biasRegularizer:Qr(this.biasRegularizer),activityRegularizer:Qr(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),recurrentConstraint:Jn(this.recurrentConstraint),biasConstraint:Jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};SC.className="SimpleRNNCell";Re.registerClass(SC);var MM=class extends gu{constructor(e){e.cell=new SC(e),super(e)}call(e,t){return ce(()=>{this.cell.dropoutMask!=null&&(zt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(zt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let r=t==null?null:t.mask,n=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:r,training:n,initialState:a})})}static fromConfig(e,t){return new e(t)}};MM.className="SimpleRNN";Re.registerClass(MM);var _C=class extends aw{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new he("GRUCell does not support reset_after parameter set to true.");this.units=e.units,ca(this.units,"units"),this.activation=Fc(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Fc(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=un(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=un(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=un(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=cn(e.kernelRegularizer),this.recurrentRegularizer=cn(e.recurrentRegularizer),this.biasRegularizer=cn(e.biasRegularizer),this.kernelConstraint=Zn(e.kernelConstraint),this.recurrentConstraint=Zn(e.recurrentConstraint),this.biasConstraint=Zn(e.biasConstraint),this.dropout=xg([1,Dc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=xg([1,Dc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=vr(e);let t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ce(()=>{if(e=e,e.length!==2)throw new he(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let r=t.training==null?!1:t.training,n=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Oc({ones:()=>Js(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Oc({ones:()=>Js(n),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,s=this.recurrentDropoutMask,i,o,u;0<this.dropout&&this.dropout<1&&(e=oe(e,a[0]));let d=ll(e,this.kernel.read());this.useBias&&(d=Oo(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(n=oe(n,s[0]));let c=this.recurrentKernel.read(),[h,p]=gs(c,[2*this.units,this.units],c.rank-1),f=ll(n,h),[g,m,x]=gs(d,3,d.rank-1),[y,v]=gs(f,2,f.rank-1);i=this.recurrentActivation.apply(Ne(g,y)),o=this.recurrentActivation.apply(Ne(m,v));let b=ll(oe(o,n),p);u=this.activation.apply(Ne(x,b));let N=Ne(oe(i,n),oe(Ne(1,Jr(i)),u));return[N,N]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Mc(this.activation),recurrentActivation:Mc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),recurrentInitializer:xn(this.recurrentInitializer),biasInitializer:xn(this.biasInitializer),kernelRegularizer:Qr(this.kernelRegularizer),recurrentRegularizer:Qr(this.recurrentRegularizer),biasRegularizer:Qr(this.biasRegularizer),activityRegularizer:Qr(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),recurrentConstraint:Jn(this.recurrentConstraint),biasConstraint:Jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};_C.className="GRUCell";Re.registerClass(_C);var FM=class extends gu{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new _C(e),super(e)}call(e,t){return ce(()=>{this.cell.dropoutMask!=null&&(zt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(zt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let r=t==null?null:t.mask,n=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:r,training:n,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};FM.className="GRU";Re.registerClass(FM);var sw=class extends aw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,ca(this.units,"units"),this.activation=Fc(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Fc(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=un(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=un(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=un(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=cn(e.kernelRegularizer),this.recurrentRegularizer=cn(e.recurrentRegularizer),this.biasRegularizer=cn(e.biasRegularizer),this.kernelConstraint=Zn(e.kernelConstraint),this.recurrentConstraint=Zn(e.recurrentConstraint),this.biasConstraint=Zn(e.biasConstraint),this.dropout=xg([1,Dc([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=xg([1,Dc([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=vr(e);let r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let n;if(this.useBias){if(this.unitForgetBias){let a=this.biasInitializer,s=this.units;n=new(t=class extends Qi{apply(i,o){let u=a.apply([s]),d=new uC().apply([s]),c=a.apply([s*2]);return S4(S4(u,d),c)}},t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return ce(()=>{let r=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new he(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let n=e[1],a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Oc({ones:()=>Js(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Oc({ones:()=>Js(n),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));let s=this.dropoutMask,i=this.recurrentDropoutMask,o,u,d,c;0<this.dropout&&this.dropout<1&&(e=oe(e,s[0]));let h=ll(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(n=oe(n,i[0])),h=Ne(h,ll(n,this.recurrentKernel.read())),this.useBias&&(h=Oo(h,this.bias.read()));let[p,f,g,m]=gs(h,4,h.rank-1);o=this.recurrentActivation.apply(p),u=this.recurrentActivation.apply(f),d=Ne(oe(u,a),oe(o,this.activation.apply(g))),c=this.recurrentActivation.apply(m);let x=oe(c,this.activation.apply(d));return[x,x,d]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Mc(this.activation),recurrentActivation:Mc(this.recurrentActivation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),recurrentInitializer:xn(this.recurrentInitializer),biasInitializer:xn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Qr(this.kernelRegularizer),recurrentRegularizer:Qr(this.recurrentRegularizer),biasRegularizer:Qr(this.biasRegularizer),activityRegularizer:Qr(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),recurrentConstraint:Jn(this.recurrentConstraint),biasConstraint:Jn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};sw.className="LSTMCell";Re.registerClass(sw);var OM=class extends gu{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new sw(e),super(e)}call(e,t){return ce(()=>{this.cell.dropoutMask!=null&&(zt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(zt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let r=t==null?null:t.mask,n=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:r,training:n,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};OM.className="LSTM";Re.registerClass(OM);var kC=class extends aw{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return ce(()=>{e=e;let r=e.slice(1),n=[];for(let i of this.cells.slice().reverse())Array.isArray(i.stateSize)?n.push(r.splice(0,i.stateSize.length)):n.push(r.splice(0,1));n.reverse();let a=[],s;for(let i=0;i<this.cells.length;++i){let o=this.cells[i];r=n[i],i===0?s=[e[0]].concat(r):s=[s[0]].concat(r),s=o.call(s,t),a.push(s.slice(1))}r=[];for(let i of a.slice().reverse())r.push(...i);return[s[0]].concat(r)})}build(e){UT(e)&&(e=e[0]),e=e;let t;this.cells.forEach((r,n)=>{th(`RNNCell_${n}`,()=>{r.build(e),Array.isArray(r.stateSize)?t=r.stateSize[0]:t=r.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t=n=>({className:n.getClassName(),config:n.getConfig()}),r={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,t,r={}){let n=[];for(let a of t.cells)n.push(bo(a,r));return new e({cells:n})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let r of this.cells)t.push(...r.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return WT(e)}setWeights(e){let t=[];for(let r of this.cells){let n=r.weights.length,a=e.splice(n);for(let s=0;s<r.weights.length;++s)t.push([r.weights[s],a[s]])}oM(t)}};kC.className="StackedRNNCells";Re.registerClass(kC);function Oc(e){let{ones:t,rate:r,training:n=!1,count:a=1,dropoutFunc:s}=e,i=()=>s!=null?s(t(),r):aX(t(),r),o=()=>tw(i,t,n);return!a||a<=1?Qn(o().clone()):Array(a).fill(void 0).map(o).map(u=>Qn(u.clone()))}var POe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r},nY=class extends gu{constructor(e){if(e.unroll)throw new tr("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new tr("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Pn({ndim:5})]}call(e,t){return ce(()=>{if(this.cell.dropoutMask!=null&&(zt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(zt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new he("ConvRNN2D cell does not support constants");let r=t==null?null:t.mask,n=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:r,training:n,initialState:a})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return ce(()=>{let{stateSize:t}=this.cell,r=e.shape,n=this.computeSingleOutputShape(r),a=[n[0],...n.slice(2)],s=gn(a);return Array.isArray(t)?Array(t.length).fill(s):[s]})}resetStates(e,t=!1){ce(()=>{if(!this.stateful)throw new Ou("Cannot call resetStates() on an RNN Layer that is not stateful.");let r=this.inputSpec[0].shape,n=this.computeSingleOutputShape(r),a=[n[0],...n.slice(2)];if(r[0]==null)throw new he("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>gn(a)):this.states_=[gn(a)];else if(e==null)zt(this.states_),this.keptStates!=null&&(zt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>gn(a)):this.states_[0]=gn(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new he(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):zt(this.states_);for(let s=0;s<this.states_.length;++s){let i=e[s],o=a;if(!R.arraysEqual(i.shape,o))throw new he(`State ${s} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>Qn(s.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:r,kernelSize:n,padding:a,strides:s,dilationRate:i}=this.cell,o=t==="channelsFirst",u=e[o?3:2],d=e[o?4:3],c=wo(u,n[0],a,s[0],i[0]),h=wo(d,n[1],a,s[1],i[1]);return[...e.slice(0,2),...o?[r,c,h]:[c,h,r]]}};nY.className="ConvRNN2D";var CC=class extends sw{constructor(e){let{filters:t,kernelSize:r,strides:n,padding:a,dataFormat:s,dilationRate:i}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,ca(this.filters,"filters"),this.kernelSize=jm(r,2,"kernelSize"),this.kernelSize.forEach(o=>ca(o,"kernelSize")),this.strides=jm(n||1,2,"strides"),this.strides.forEach(o=>ca(o,"strides")),this.padding=a||"valid",Ci(this.padding),this.dataFormat=s||"channelsLast",Dn(this.dataFormat),this.dilationRate=jm(i||1,2,"dilationRate"),this.dilationRate.forEach(o=>ca(o,"dilationRate"))}build(e){var t;e=vr(e);let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new he(`The channel dimension of the input should be defined. Found ${e[r]}`);let n=e[r],a=4,s=this.kernelSize.concat([n,this.filters*a]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let i=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let o;if(this.unitForgetBias){let u=this.biasInitializer,d=this.filters;o=new(t=class extends Qi{apply(c,h){let p=u.apply([d]),f=fs([d]),g=u.apply([d*2]);return ZD([p,f,g])}},t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return ce(()=>{if(e.length!==3)throw new he(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=t.training||!1,n=e[0],a=e[1],s=e[2],i=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Oc({ones:()=>Js(n),rate:this.dropout,training:r,count:i,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,u=(L,z,$)=>!z||!z[$]?L:oe(z[$],L),d=u(n,o,0),c=u(n,o,1),h=u(n,o,2),p=u(n,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Oc({ones:()=>Js(a),rate:this.recurrentDropout,training:r,count:i,dropoutFunc:this.dropoutFunc}));let f=this.recurrentDropoutMask,g=u(a,f,0),m=u(a,f,1),x=u(a,f,2),y=u(a,f,3),v=3,[b,N,S,_]=gs(this.kernel.read(),i,v),[C,k,I,T]=this.useBias?gs(this.bias.read(),i):[null,null,null,null];d=this.inputConv(d,b,C,this.padding),c=this.inputConv(c,N,k,this.padding),h=this.inputConv(h,S,I,this.padding),p=this.inputConv(p,_,T,this.padding);let[j,E,O,M]=gs(this.recurrentKernel.read(),i,v);g=this.recurrentConv(g,j),m=this.recurrentConv(m,E),x=this.recurrentConv(x,O),y=this.recurrentConv(y,M);let W=this.recurrentActivation.apply(Ne(d,g)),q=this.recurrentActivation.apply(Ne(c,m)),P=Ne(oe(q,s),oe(W,this.activation.apply(Ne(h,x)))),A=oe(this.recurrentActivation.apply(Ne(p,y)),this.activation.apply(P));return[A,A,P]})}getConfig(){let e=super.getConfig(),{units:t}=e,r=POe(e,["units"]),n={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},r),n)}inputConv(e,t,r,n){let a=Za(e,t,this.strides,n||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Oo(a,r,this.dataFormat):a}recurrentConv(e,t){return Za(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}};CC.className="ConvLSTM2DCell";Re.registerClass(CC);var PM=class extends nY{constructor(e){let t=new CC(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};PM.className="ConvLSTM2D";Re.registerClass(PM);var IC=class extends rr{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let t=e.shape,r=[];for(let n=0;n<this.noiseShape.length;++n)r.push(this.noiseShape[n]==null?t[n]:this.noiseShape[n]);return r}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e);if(0<this.rate&&this.rate<1){let n=t.training==null?!1:t.training,a=this.getNoiseShape(r);return tw(()=>aX(r,this.rate,a,this.seed),()=>r,n)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};IC.className="Dropout";Re.registerClass(IC);var LM=class extends IC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};LM.className="SpatialDropout1D";Re.registerClass(LM);var zM=class extends rr{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,ca(this.units,"units"),this.activation=Fc(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=un(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=un(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Zn(e.kernelConstraint),this.biasConstraint=Zn(e.biasConstraint),this.kernelRegularizer=cn(e.kernelRegularizer),this.biasRegularizer=cn(e.biasRegularizer),this.activityRegularizer=cn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=vr(e);let t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=vr(e);let t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e),n=YQ(this.activation.getClassName()),a;return n!=null?a=ll(r,this.kernel.read(),n,this.bias?this.bias.read():null):(a=ll(r,this.kernel.read()),this.bias!=null&&(a=Oo(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){let e={units:this.units,activation:Mc(this.activation),useBias:this.useBias,kernelInitializer:xn(this.kernelInitializer),biasInitializer:xn(this.biasInitializer),kernelRegularizer:Qr(this.kernelRegularizer),biasRegularizer:Qr(this.biasRegularizer),activityRegularizer:Qr(this.activityRegularizer),kernelConstraint:Jn(this.kernelConstraint),biasConstraint:Jn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};zM.className="Dense";Re.registerClass(zM);var BM=class extends rr{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=vr(e);for(let t of e.slice(1))if(t==null)throw new he(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],vc(e,1)]}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){let n=[0];for(let a=2;a<r.rank;++a)n.push(a);n.push(1),r=Kt(r,n)}return XMe(r)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};BM.className="Flatten";Re.registerClass(BM);var UM=class extends rr{constructor(e){super(e),this.supportsMasking=!0,this.activation=Fc(e.activation)}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e);return this.activation.apply(r)})}getConfig(){let e={activation:Mc(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};UM.className="Activation";Re.registerClass(UM);var WM=class extends rr{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return ce(()=>(e=Rt(e),KMe(e,this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};WM.className="RepeatVector";Re.registerClass(WM);var VM=class extends rr{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){let r="Total size of new array must be unchanged.",n=t.slice(),a=1,s=null;for(let o=0;o<n.length;++o){let u=n[o];if(this.isUnknown(u))if(s===null)s=o;else throw new he("Can only specifiy one unknown dimension.");else a*=u}let i=vc(e);if(s!==null){if(a===0||i%a!==0)throw new he(r);n[s]=i/a}else if(i!==a)throw new he(r);return n}computeOutputShape(e){let t=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e),n=r.shape,a=n.slice(0,1).concat(this.fixUnknownDimension(n.slice(1),this.targetShape));return ue(r,a)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};VM.className="Reshape";Re.registerClass(VM);var HM=class extends rr{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let t=Eo(1,e.dims.length+1);if(!R.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Pn({ndim:this.dims.length+1})]}computeOutputShape(e){e=vr(e);let t=e.slice();return this.dims.forEach((r,n)=>{t[n+1]=e[r]}),t}call(e,t){return Kt(Rt(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};HM.className="Permute";Re.registerClass(HM);var qM=class extends rr{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let r=Rt(e);return db(Ah(r,this.maskValue),-1)}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e),n=db(Ah(r,this.maskValue),-1,!0);return oe(r,Pe(n,r.dtype))})}};qM.className="Masking";Re.registerClass(qM);var GM=class extends rr{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Er(e.inputLength))}this.inputDim=e.inputDim,ca(this.inputDim,"inputDim"),this.outputDim=e.outputDim,ca(this.outputDim,"outputDim"),this.embeddingsInitializer=un(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=cn(e.embeddingsRegularizer),this.activityRegularizer=cn(e.activityRegularizer),this.embeddingsConstraint=Zn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return ce(()=>this.maskZero?(e=Rt(e),Ah(e,hr(e))):null)}computeOutputShape(e){if(e=vr(e),this.inputLength==null)return[...e,this.outputDim];let t=Er(this.inputLength);if(t.length!==e.length-1)throw new he(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let n=0;n<t.length;++n){let a=t[n],s=e[n+1];if(a!=null&&s!=null&&a!==s)throw new he(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(t[r]=s),r++}}return[e[0],...t,this.outputDim]}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e);r.dtype!=="int32"&&(r=iu(r,"int32"));let n=nX(this.embeddings.read(),ue(r,[r.size]));return ue(n,vr(this.computeOutputShape(r.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:xn(this.embeddingsInitializer),embeddingsRegularizer:Qr(this.embeddingsRegularizer),activityRegularizer:Qr(this.activityRegularizer),embeddingsConstraint:Jn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};GM.className="Embedding";Re.registerClass(GM);var wf=class extends rr{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new tr}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;let r=e.slice(0,e.length-t.length);for(let n=0;n<t.length;++n){let a=e[e.length-t.length+n],s=t[n];if(a==null||s==null||a<0||s<0)r.push(null);else if(a===1)r.push(s);else if(s===1)r.push(a);else{if(a!==s)throw new he("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));r.push(a)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[vr(e)]),e=e,e.length<2)throw new he(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(let a of e)a!=null&&a[0]!==null&&t.push(a[0]);if(t=yc(t),t.length>1)throw new he(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){let s=e[a]==null?null:e[a].slice(1);r=this.computeElementwiseOpOutputShape(r,s)}let n=e.map(a=>a.length);e.indexOf(null)===-1&&yc(n).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return ce(()=>{if(e=e,this.reshapeRequired){let r=[],n=e.map(a=>a.rank);if(n.indexOf(null)===-1){let a=Dc(n);for(let s of e){let i=s.rank;for(let o=0;o<a-i;++o)s=Z0(s,1);r.push(s)}return this.mergeFunction(r)}else{let a=!1;for(let o of e){let u=o.rank;if(u==null){let d=o.shape,c=d[0],h=d.slice(1).concat([c]),p=ue(o,[c].concat(vc(d.slice(1))));p=Kt(p,[1,0]),p=ue(p,h),r.push(p),a=!0}else if(u>1){let d=Eo(1,u).concat([0]);r.push(Kt(o,d)),a=!0}else r.push(o)}let s=this.mergeFunction(r),i=s.rank;if(a){if(i==null){let o=s.shape,u=o.length,d=o[u-1],c=[d].concat(o.slice(0,o.length-1));s=ue(Kt(ue(s,[-1,d]),[1,0]),c)}else if(i>1){let o=[i-1].concat(Eo(0,i-1));s=Kt(s,o)}}return s}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let n=1;n<e.length;++n){let a=e[n]==null?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,a)}let r=[];for(let n of e)n!=null&&n[0]!==null&&r.push(n[0]);return r=yc(r),r.length===1?t=r.concat(t):t=[null].concat(t),t}computeMask(e,t){return ce(()=>{if(t==null)return null;if(!Array.isArray(t))throw new he("`mask` should be an Array");if(!Array.isArray(e))throw new he("`inputs` should be an Array");if(t.length!==e.length)throw new he(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(n=>n==null))return null;t=t.map(n=>n==null?n:la(n,0));let r=t[0];for(let n=1;n<t.length-1;++n)r=qi(r,t[n]);return r})}},KM=class extends wf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=Ne(t,e[r]);return t})}};KM.className="Add";Re.registerClass(KM);var QM=class extends wf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=oe(t,e[r]);return t})}};QM.className="Multiply";Re.registerClass(QM);var XM=class extends wf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=Ne(t,e[r]);return oe(1/e.length,t)})}};XM.className="Average";Re.registerClass(XM);var YM=class extends wf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=wl(t,e[r]);return t})}};YM.className="Maximum";Re.registerClass(YM);var JM=class extends wf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=$c(t,e[r]);return t})}};JM.className="Minimum";Re.registerClass(JM);var ZM=class extends wf{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new he("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(let n of e)if(n!=null){t=!1;break}if(t)return;let r=[];for(let n=0;n<e.length;++n){let a=e[n].slice();a.splice(this.axis,1);let s=!1;for(let i of r)if(R.arraysEqual(i,a)){s=!0;break}s||r.push(a)}if(r.length>1)throw new he("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ce(()=>ZD(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new he("A `Concatenate` layer should be called on a list of inputs.");let t=e,r=t[0].slice(),n=this.axis<0?r.length+this.axis:this.axis;for(let a of t.slice(1)){if(r[n]==null||a[n]==null){r[n]=null;break}r[n]+=a[n]}return r}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new he("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new he("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new he(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return ce(()=>{let r=!0;if(t.forEach(s=>{if(s!=null){r=!1;return}}),r)return null;let n=[];for(let s=0;s<e.length;++s)t[s]==null?n.push(Pe(Js(e[s]),"bool")):t[s].rank<e[s].rank?n.push(la(t[s],-1)):n.push(t[s]);let a=zr(n,this.axis);return Tk(a,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};ZM.className="Concatenate";Re.registerClass(ZM);function zy(e,t){for(;e<0;)e+=t;return e}function LOe(e,t,r){if(e.shape.length>3||t.shape.length>3)throw new tr("batchDot is not implemented for tensors of 4D or higher rank yet");if(R.assert(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),R.assert(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof r=="number"&&(r=[r,r]),e.dtype==="complex64"||t.dtype==="complex64")throw new tr("batchDot is not implemented for complex64-type Tensors yet.");let n=e.shape.length,a=t.shape.length;r==null&&(r=[n-1,a-2]);let s=r;return ce(()=>{let i;if(n>a){i=n-a;let u=[];for(let d=0;d<i;++d)u.push(1);t=ue(t,t.shape.concat(u))}else if(a>n){i=a-n;let u=[];for(let d=0;d<i;++d)u.push(1);e=ue(e,e.shape.concat(u))}else i=0;let o;if(e.shape.length===2&&t.shape.length===2)s[0]===s[1]?o=ht(oe(e,t),s[0]):o=ht(oe(Kt(e,[1,0]),t),s[1]);else{let u=s[0]!==e.shape.length-1,d=s[1]===t.shape.length-1;o=Gt(e,t,u,d)}if(i>0){let u;n>a?u=n+a-3:u=n-1;let d=[];for(let c=u;c<u+i;++c)d.push(c);o=sd(o,d)}return o.shape.length===1&&(o=la(o,1)),o})}var eF=class extends wf{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){R.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],r=e[1];if(t.length>3||r.length>3)throw new tr("Dot layer does not support tensors of 4D or higher rank yet.");let n=this.interpretAxes(t,r);if(t[n[0]]!==r[n[1]])throw new he(`Dimension incompatibility: ${t[n[0]]} !== ${r[n[1]]}`)}mergeFunction(e){if(e.length!==2)throw new he(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],r=e[1],n;return Array.isArray(this.axes)?n=this.axes.map((a,s)=>zy(a,e[s].shape.length)):n=[zy(this.axes,t.shape.length),zy(this.axes,r.shape.length)],this.normalize&&(t=mS(t,n[0]),r=mS(r,n[1])),LOe(t,r,n)}interpretAxes(e,t){let r;return Array.isArray(this.axes)?r=this.axes:r=[zy(this.axes,e.length),zy(this.axes,t.length)],r}computeOutputShape(e){R.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),r=e[1].slice();if(t.length>3||r.length>3)throw new tr("Dot layer does not support tensors of 4D or higher rank yet.");let n=this.interpretAxes(t,r);t.splice(n[0],1),r.splice(n[1],1),r.splice(0,1);let a=t.concat(r);return a.length===1&&a.push(1),a}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};eF.className="Dot";Re.registerClass(eF);var tF=class extends rr{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e);return tw(()=>Ne(lC(r.shape,0,this.stddev),r),()=>r,t.training||!1)})}};tF.className="GaussianNoise";Re.registerClass(tF);var rF=class extends rr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let r=Rt(e);return this.rate>0&&this.rate<1?tw(()=>{let n=Math.sqrt(this.rate/(1-this.rate));return oe(r,lC(r.shape,1,n))},()=>r,t.training||!1):r})}};rF.className="GaussianDropout";Re.registerClass(rF);var nF=class extends rr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Rt(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ce(()=>{if(this.rate<1&&this.rate>0){let r=this._getNoiseShape(e);return tw(()=>{let n=Rt(e),a=-1.6732632423543772*1.0507009873554805,s=pu(nd(r),this.rate);s=iu(s,"float32");let i=((1-this.rate)*(1+this.rate*a**2))**-.5,o=-i*a*this.rate,u=Ne(oe(n,s),oe(Ne(s,-1),a));return Ne(oe(u,i),o)},()=>Rt(e),t.training||!1)}return e})}};nF.className="AlphaDropout";Re.registerClass(nF);function xb(e,t,r,n,a,s=.001){let i;if(e.rank===2)i=HR(e,t,r,n,a,s);else if(e.rank===3)i=qR(e,t,r,n,a,s);else if(e.rank===4)i=GR(e,t,r,n,a,s);else throw new tr(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return i}function zOe(e,t,r,n,a=.001){return ce(()=>{let s=H0(e,n),i=s.mean,o=s.variance;return[xb(e,i,o,r,t,a),i,o]})}function BOe(e,t,r,n,a=.001){return ce(()=>{let s=H0(e,n),i=s.mean,o=s.variance,u=[];for(let f of Eo(0,e.rank))n.indexOf(f)!==-1?u.push(1):u.push(e.shape[f]);let d=ue(i,u),c=ue(o,u),h=t==null?null:ue(t,u),p=r==null?null:ue(r,u);return[xb(e,d,c,p,h,a),i,o]})}function UOe(e,t,r,n,a=.001){return R.arraysEqual(n.slice().sort(),Eo(0,e.rank-1))?zOe(e,t,r,n,a):BOe(e,t,r,n,a)}var aF=class extends rr{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=un(e.betaInitializer||"zeros"),this.gammaInitializer=un(e.gammaInitializer||"ones"),this.movingMeanInitializer=un(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=un(e.movingVarianceInitializer||"ones"),this.betaConstraint=Zn(e.betaConstraint),this.gammaConstraint=Zn(e.gammaConstraint),this.betaRegularizer=cn(e.betaRegularizer),this.gammaRegularizer=cn(e.gammaRegularizer)}build(e){e=vr(e);let t=this.axis>=0?this.axis:this.axis+e.length,r=e[t];if(r==null)throw new he(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Pn({ndim:e.length,axes:{[t]:r}})];let n=[r];this.scale&&(this.gamma=this.addWeight("gamma",n,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",n,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",n,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",n,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return ce(()=>{let r=t.training==null?!1:t.training,n=Rt(e),a=n.shape,s=a.length,i=Eo(0,s),o=this.axis>=0?this.axis:this.axis+s;i.splice(o,1);let u=Rh(1,s);u[o]=a[o];let d=i.slice();d.sort();let c=!R.arraysEqual(d,Eo(0,s).slice(0,s-1)),h=()=>{if(c){let x=ue(this.movingMean.read(),u),y=ue(this.movingVariance.read(),u),v=this.center?ue(this.beta.read(),u):null,b=this.scale?ue(this.gamma.read(),u):null;return xb(n,x,y,v,b,this.epsilon)}else return xb(n,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();let[p,f,g]=UOe(n,this.gamma.read(),this.beta.read(),i,this.epsilon),m=(x,y,v)=>{ce(()=>{let b=1-v,N=x.read(),S=oe(Ze(N,y),b);x.write(Ze(N,S))})};return m(this.movingMean,f,this.momentum),m(this.movingVariance,g,this.momentum),p})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:xn(this.betaInitializer),gammaInitializer:xn(this.gammaInitializer),movingMeanInitializer:xn(this.movingMeanInitializer),movingVarianceInitializer:xn(this.movingVarianceInitializer),betaRegularizer:Qr(this.betaRegularizer),gammaRegularizer:Qr(this.gammaRegularizer),betaConstraint:Jn(this.betaConstraint),gammaConstraint:Jn(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};aF.className="BatchNormalization";Re.registerClass(aF);var sF=class extends rr{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=un(e.betaInitializer||"zeros"),this.gammaInitializer=un(e.gammaInitializer||"ones"),this.betaRegularizer=cn(e.betaRegularizer),this.gammaRegularizer=cn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=vr(e);let t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(let a of this.axis)if(a<0||a>=t)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==yc(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let r=this.axis.map(a=>e[a]),n=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,n):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,n):this.beta=null,this.built=!0}call(e,t){let r=Rt(e),n=r.shape,a=n.length;return ce(()=>{let{mean:s,variance:i}=H0(r,this.axis,!0),o=Rh(1,a);for(let f of this.axis)o[f]=n[f];let u=f=>f!=null&&f.shape.length!==a?ue(f,o):f,d=this.scale?u(this.gamma.read()):null,c=this.center?u(this.beta.read()):null,h=[],p=[];for(let f=0;f<a;++f)this.axis.indexOf(f)!==-1?(h.push(n[f]),p.push(1)):(h.push(1),p.push(n[f]));return s=Us(s,h),i=Us(i,h),d!=null&&(d=Us(d,p)),c!=null&&(c=Us(c,p)),xb(r,s,i,c,d,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:xn(this.betaInitializer),gammaInitializer:xn(this.gammaInitializer),betaRegularizer:Qr(this.betaRegularizer),gammaRegularizer:Qr(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};sF.className="LayerNormalization";Re.registerClass(sF);function WOe(e,t,r){return ce(()=>{if(e.rank!==4)throw new he(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new he("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(r==null&&(r=To()),r!=="channelsLast"&&r!=="channelsFirst")throw new he(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let n;return r==="channelsFirst"?n=[[0,0],[0,0],t[0],t[1]]:n=[[0,0],t[0],t[1],[0,0]],Fo(e,n)})}var iF=class extends rr{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?To():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new he(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,r;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new he(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new he(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[t,r]}this.inputSpec=[new Pn({ndim:4})]}computeOutputShape(e){e=vr(e);let t,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],t,r]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],t,r,e[3]])}call(e,t){return ce(()=>WOe(Rt(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};iF.className="ZeroPadding2D";Re.registerClass(iF);function EC(e,t,r,n,a,s){return ce(()=>{Dn(a),ZQ(s),Ci(n),r==null&&(r=[1,1]),n==null&&(n="valid"),a==null&&(a=To()),s==null&&(s="max"),e=IM(e,a);let i,o=n==="same"?"same":"valid";return s==="max"?i=na(e,t,r,o):i=hu(e,t,r,o),a==="channelsFirst"&&(i=Kt(i,[0,3,1,2])),i})}function aY(e,t,r,n,a,s){return ce(()=>{Dn(a),ZQ(s),Ci(n),r==null&&(r=[1,1,1]),n==null&&(n="valid"),a==null&&(a=To()),s==null&&(s="max"),e=qX(e,a);let i,o=n==="same"?"same":"valid";return s==="max"?i=xD(e,t,r,o):i=VR(e,t,r,o),a==="channelsFirst"&&(i=Kt(i,[0,4,1,2,3])),i})}var sY=class extends rr{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new he(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(ca(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new he(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);ca(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Ci(this.padding),this.inputSpec=[new Pn({ndim:3})]}computeOutputShape(e){e=vr(e);let t=wo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return ce(()=>{this.invokeCallHook(e,t),e=Z0(Rt(e),2);let r=this.poolingFunction(Rt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return sd(r,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},oF=class extends sY{constructor(e){super(e)}poolingFunction(e,t,r,n,a){return Dn(a),Ci(n),EC(e,t,r,n,a,"max")}};oF.className="MaxPooling1D";Re.registerClass(oF);var lF=class extends sY{constructor(e){super(e)}poolingFunction(e,t,r,n,a){return Dn(a),Ci(n),EC(e,t,r,n,a,"avg")}};lF.className="AveragePooling1D";Re.registerClass(lF);var iY=class extends rr{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new he(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];ca(this.poolSize,"poolSize"),ca(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Dn(this.dataFormat),Ci(this.padding),this.inputSpec=[new Pn({ndim:4})]}computeOutputShape(e){e=vr(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=wo(t,this.poolSize[0],this.padding,this.strides[0]),r=wo(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r]:[e[0],t,r,e[3]]}call(e,t){return ce(()=>(this.invokeCallHook(e,t),this.poolingFunction(Rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},uF=class extends iY{constructor(e){super(e)}poolingFunction(e,t,r,n,a){return Dn(a),Ci(n),EC(e,t,r,n,a,"max")}};uF.className="MaxPooling2D";Re.registerClass(uF);var cF=class extends iY{constructor(e){super(e)}poolingFunction(e,t,r,n,a){return Dn(a),Ci(n),EC(e,t,r,n,a,"avg")}};cF.className="AveragePooling2D";Re.registerClass(cF);var oY=class extends rr{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new he(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];ca(this.poolSize,"poolSize"),ca(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Dn(this.dataFormat),Ci(this.padding),this.inputSpec=[new Pn({ndim:5})]}computeOutputShape(e){e=vr(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],n=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=wo(t,this.poolSize[0],this.padding,this.strides[0]),r=wo(r,this.poolSize[1],this.padding,this.strides[1]),n=wo(n,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r,n]:[e[0],t,r,n,e[4]]}call(e,t){return ce(()=>(this.invokeCallHook(e,t),this.poolingFunction(Rt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},dF=class extends oY{constructor(e){super(e)}poolingFunction(e,t,r,n,a){return Dn(a),Ci(n),aY(e,t,r,n,a,"max")}};dF.className="MaxPooling3D";Re.registerClass(dF);var hF=class extends oY{constructor(e){super(e)}poolingFunction(e,t,r,n,a){return Dn(a),Ci(n),aY(e,t,r,n,a,"avg")}};hF.className="AveragePooling3D";Re.registerClass(hF);var lY=class extends rr{constructor(e){super(e),this.inputSpec=[new Pn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new tr}},pF=class extends lY{constructor(e){super(e||{})}call(e,t){return ce(()=>{let r=Rt(e);return mn(r,1)})}};pF.className="GlobalAveragePooling1D";Re.registerClass(pF);var fF=class extends lY{constructor(e){super(e||{})}call(e,t){return ce(()=>{let r=Rt(e);return fi(r,1)})}};fF.className="GlobalMaxPooling1D";Re.registerClass(fF);var uY=class extends rr{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Dn(this.dataFormat),this.inputSpec=[new Pn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new tr}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},mF=class extends uY{call(e,t){return ce(()=>{let r=Rt(e);return this.dataFormat==="channelsLast"?mn(r,[1,2]):mn(r,[2,3])})}};mF.className="GlobalAveragePooling2D";Re.registerClass(mF);var gF=class extends uY{call(e,t){return ce(()=>{let r=Rt(e);return this.dataFormat==="channelsLast"?fi(r,[1,2]):fi(r,[2,3])})}};gF.className="GlobalMaxPooling2D";Re.registerClass(gF);var cY=class extends rr{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,r={}){let n=t.layer,a=bo(n,r);delete t.layer;let s={layer:a};return Object.assign(s,t),new e(s)}},xF=class extends cY{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=vr(e),e.length<3)throw new he(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=vr(e);let t=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(t),n=e[1];return[r[0],n].concat(r.slice(1))}call(e,t){return ce(()=>(e=Rt(e),tY((r,n)=>[Rt(this.layer.call(r,t)),[]],e,[],!1,null,null,!1,!0)[1]))}};xF.className="TimeDistributed";Re.registerClass(xF);function VOe(e){vf(WMe,"BidirectionalMergeMode",e)}var HOe="concat",yF=class extends cY{constructor(e){super(e);let t=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=t,this.forwardLayer=bo(r),t.goBackwards=t.goBackwards!==!0;let n={};if(n.className=e.layer.getClassName(),n.config=t,this.backwardLayer=bo(n),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?HOe:e.mergeMode,VOe(this.mergeMode),e.weights)throw new tr("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,r=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let r,n,a;return this.returnState&&(a=t.slice(1)),r=t[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,n=[r]):this.mergeMode==null?n=[r,r.slice()]:n=[r],this.returnState?this.mergeMode==null?n.concat(a).concat(a.slice()):[r].concat(a).concat(a.slice()):hs(n)}apply(e,t){let r=t==null?null:t.initialState,n=t==null?null:t.constants;t==null&&(t={});let a=eY(e,r,n,this.numConstants);if(e=a.inputs,r=a.initialState,n=a.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&n==null)return super.apply(e,t);let s=[],i=[];if(r!=null){let u=r.length;if(u%2>0)throw new he("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,s.push(...r);let d=r.map(c=>new Pn({shape:c.shape}));this.forwardLayer.stateSpec=d.slice(0,u/2),this.backwardLayer.stateSpec=d.slice(u/2),i.push(...d)}if(n!=null)throw new tr("Support for constants in Bidirectional layers is not implemented yet.");let o=s[0]instanceof jo;for(let u of s)if(u instanceof jo!==o)throw new he("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let u=[e].concat(s),d=this.inputSpec.concat(i),c=this.inputSpec;this.inputSpec=d;let h=super.apply(u,t);return this.inputSpec=c,h}else return super.apply(e,t)}call(e,t){return ce(()=>{let r=t.initialState,n,a;if(r==null)n=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{let o=r.slice(0,r.length/2),u=r.slice(r.length/2);n=this.forwardLayer.call(e,Object.assign(t,{initialState:o})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let s;this.returnState&&(Array.isArray(n)&&(s=n.slice(1).concat(a.slice(1))),n=n[0],a=a[0]),this.returnSequences&&(a=Si(a,1));let i;return this.mergeMode==="concat"?i=ZD([n,a]):this.mergeMode==="sum"?i=Ne(n,a):this.mergeMode==="ave"?i=oe(.5,Ne(n,a)):this.mergeMode==="mul"?i=oe(n,a):this.mergeMode==null&&(i=[n,a]),this.returnState?this.mergeMode==null?i.concat(s):[i].concat(s):i})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){th(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),th(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[t,t]:r=t:this.mergeMode==null?r=[null,null]:r=null,this.returnState){let n=this.forwardLayer.states.map(a=>null);return Array.isArray(r)?r.concat(n).concat(n):[r].concat(n).concat(n)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let r=bo(t.layer);if(delete t.layer,t.numConstants!=null)throw new tr("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let n=t;return n.layer=r,new e(n)}};yF.className="Bidirectional";Re.registerClass(yF);var vF=class extends rr{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ce(()=>(e=Rt(e),e.dtype!=="float32"&&(e=iu(e,"float32")),Ne(oe(e,this.scale),this.offset)))}};vF.className="Rescaling";Re.registerClass(vF);var{resizeBilinear:qOe,cropAndResize:GOe}=li,bF=class extends rr{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,r,n,a,s,i,o){return ce(()=>{let u,d=!1,c=t/s,h=r/i,p=(n+t)/s,f=(a+r)/i,g=[c,h,p,f],m=[];e.rank===3?(d=!0,u=Bn([e])):u=e;for(let b=0;b<u.shape[0];b++)m.push(g);let x=Qa(m,[m.length,4]),y=$h(0,m.length,1,"int32"),v=GOe(u,x,y,[n,a],"nearest");return iu(d?Rt(Cn(v)):v,o)})}upsize(e,t,r,n){return ce(()=>{let a=qOe(e,[t,r]);return iu(a,n)})}call(e,t){return ce(()=>{let r=Rt(e),n=r.dtype,a=r.shape,s=a[a.length-3],i=a[a.length-2],o=0;s!==this.height&&(o=Math.floor((s-this.height)/2));let u=0;return i!==this.width&&(u=Math.floor((i-this.width)/2),u===0&&(u=1)),o>=0&&u>=0?this.centerCrop(r,o,u,this.height,this.width,s,i,n):this.upsize(e,this.height,this.width,n)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=vr(e);let t=e.length-3,r=e.length-2;return e[t]=this.height,e[r]=this.width,e}};bF.className="CenterCrop";Re.registerClass(bF);function KOe(e,t,r,n){let a=Rt(e);if(a.dtype!=="int32"&&(a=iu(a,"int32")),t==="int")return a;let s=a.shape;if(a.rank===0&&(a=la(a,-1)),t==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=la(a,-1)),a.rank>2)throw new he(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${a.rank}.`);let i=["multiHot","oneHot"].includes(t),o=a,u;if(typeof n<"u"&&t==="count"?u=uS(o,n,r,i):u=uS(o,[],r,i),t!=="tfIdf")return u;if(n)return oe(u,n);throw new he("When outputMode is 'tfIdf', weights must be provided.")}var wF=class extends rr{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=vr(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return ce(()=>{e=Rt(e),e.dtype!=="int32"&&(e=iu(e,"int32"));let r;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new he(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);r=Rt(t.countWeights)}let n=fi(e),a=cg(e),s=as(this.numTokens,n).bufferSync().get(0),i=pu(a,0).bufferSync().get(0);if(!(s&&i))throw new he(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return KOe(e,this.outputMode,this.numTokens,r)})}};wF.className="CategoryEncoding";Re.registerClass(wF);var QOe=["bilinear","nearest"],z4=new Set(QOe),NF=class extends rr{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(z4.has(e.interpolation))this.interpolation=e.interpolation;else throw new he(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=vr(e);let t=e[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ce(()=>{let r=[this.height,this.width];if(this.interpolation==="bilinear")return li.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return li.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...z4]} are supported`)})}};NF.className="Resizing";Re.registerClass(NF);var dY=class{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}};dY.className="RandomSeed";var hY=class extends rr{constructor(e){super(e),this.randomGenerator=new dY(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};hY.className="BaseRandomLayer";var XOe=["bilinear","nearest"],B4=new Set(XOe),SF=class extends hY{constructor(e){super(e);let{factor:t,interpolation:r="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new he(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new he(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new he(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(B4.has(r))this.interpolation=r;else throw new he(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=vr(e);let t=e[2];return[this.imgHeight,-1,t]}call(e,t){return ce(()=>{let r=Rt(e);this.imgHeight=r.shape[r.shape.length-3];let n=r.shape[r.shape.length-2];this.widthFactor=nd([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*n;a=Math.round(a);let s=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return li.resizeBilinear(e,s);case"nearest":return li.resizeNearestNeighbor(e,s);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...B4]} are supported`)}})}};SF.className="RandomWidth";Re.registerClass(SF);function YOe(e){return new iy(e)}function JOe(e){return new _M(e)}function ZOe(e){return new wM(e)}function ePe(e){return new NM(e)}function tPe(e){return new SM(e)}function rPe(e){return new CM(e)}function nPe(e){return new kM(e)}function aPe(e){return new AM(e)}function sPe(e){return new wC(e)}function iPe(e){return new EM(e)}function oPe(e){return new NC(e)}function lPe(e){return new TM(e)}function uPe(e){return new jM(e)}function cPe(e){return new $M(e)}function dPe(e){return new RM(e)}function hPe(e){return new DM(e)}function pPe(e){return new UM(e)}function fPe(e){return new zM(e)}function mPe(e){return new IC(e)}function gPe(e){return new LM(e)}function xPe(e){return new BM(e)}function yPe(e){return new WM(e)}function vPe(e){return new VM(e)}function bPe(e){return new HM(e)}function wPe(e){return new GM(e)}function NPe(e){return new KM(e)}function SPe(e){return new XM(e)}function _Pe(e){return new ZM(e)}function kPe(e){return new YM(e)}function CPe(e){return new JM(e)}function IPe(e){return new QM(e)}function EPe(e){return new eF(e)}function TPe(e){return new aF(e)}function jPe(e){return new sF(e)}function APe(e){return new iF(e)}function _F(e){return new lF(e)}function $Pe(e){return _F(e)}function RPe(e){return _F(e)}function kF(e){return new cF(e)}function DPe(e){return kF(e)}function MPe(e){return kF(e)}function CF(e){return new hF(e)}function FPe(e){return CF(e)}function OPe(e){return CF(e)}function PPe(e){return new pF(e)}function LPe(e){return new mF(e)}function pY(e){return new fF(e)}function fY(e){return new gF(e)}function mY(e){return new oF(e)}function gY(e){return new uF(e)}function zPe(e){return new dF(e)}function BPe(e){return new FM(e)}function UPe(e){return new _C(e)}function WPe(e){return new OM(e)}function VPe(e){return new sw(e)}function HPe(e){return new MM(e)}function qPe(e){return new SC(e)}function GPe(e){return new PM(e)}function KPe(e){return new CC(e)}function QPe(e){return new gu(e)}function XPe(e){return new kC(e)}function YPe(e){return new yF(e)}function JPe(e){return new xF(e)}var ZPe=pY,eLe=fY,tLe=mY,rLe=gY;function nLe(e){return new tF(e)}function aLe(e){return new rF(e)}function sLe(e){return new nF(e)}function iLe(e){return new qM(e)}function oLe(e){return new vF(e)}function lLe(e){return new bF(e)}function uLe(e){return new NF(e)}function cLe(e){return new wF(e)}function dLe(e){return new SF(e)}var xY={};Ut(xY,{MAPE:()=>NLe,MSE:()=>kLe,binaryAccuracy:()=>hLe,binaryCrossentropy:()=>pLe,categoricalAccuracy:()=>mLe,categoricalCrossentropy:()=>gLe,cosineProximity:()=>vLe,mape:()=>SLe,meanAbsoluteError:()=>bLe,meanAbsolutePercentageError:()=>wLe,meanSquaredError:()=>_Le,mse:()=>CLe,precision:()=>xLe,r2Score:()=>ILe,recall:()=>yLe,sparseCategoricalAccuracy:()=>fLe});function hLe(e,t){return mM(e,t)}function pLe(e,t){return bX(e,t)}function fLe(e,t){return wX(e,t)}function mLe(e,t){return gM(e,t)}function gLe(e,t){return xM(e,t)}function xLe(e,t){return vX(e,t)}function yLe(e,t){return QFe(e,t)}function vLe(e,t){return fM(e,t)}function bLe(e,t){return xC(e,t)}function wLe(e,t){return oy(e,t)}function NLe(e,t){return oy(e,t)}function SLe(e,t){return oy(e,t)}function _Le(e,t){return bf(e,t)}function kLe(e,t){return bf(e,t)}function CLe(e,t){return bf(e,t)}function ILe(e,t){return XFe(e,t)}var yY={};Ut(yY,{modelFromJSON:()=>COe});var vY={};Ut(vY,{l1:()=>TLe,l1l2:()=>ELe,l2:()=>jLe});function ELe(e){return new nw(e)}function TLe(e){return ROe(e)}function jLe(e){return DOe(e)}var bY=class extends yg{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Kl))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function d1(e,t){return e<t}function U4(e,t){return e>t}var wY=class extends bY{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new tr("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=d1:this.mode==="max"?this.monitorFunc=U4:this.monitor.indexOf("acc")!==-1?this.monitorFunc=U4:this.monitorFunc=d1,this.monitorFunc===d1&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===d1?1/0:-1/0}async onEpochEnd(e,t){await Au(t);let r=this.getMonitorValue(t);r!=null&&(this.monitorFunc(r-this.minDelta,this.best)?(this.best=r,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});let t=e[this.monitor];return t==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),t}};function ALe(e){return new wY(e)}var $Le={earlyStopping:ALe},RLe=ge();RLe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var As;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(As||(As={}));var W4;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(W4||(W4={}));var IF={};function DLe(e,t){let r={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};IF[e]=r}function NY(e){return IF[e]}function MLe(e){delete IF[e]}function D(e,t,r,n,a){let s=t.inputParams[e];if(s&&s.inputIndexStart!==void 0){let o=s.inputIndexStart,u=s.inputIndexEnd===0?void 0:s.inputIndexEnd===void 0?o+1:s.inputIndexEnd,d=o<0?t.inputNames.length+o:o;if(s.type==="tensor")return va(t.inputNames[d],r,n,a);if(s.type==="tensors"){let p=t.inputs.slice(o,u);return t.inputNames.slice(o,u).filter((f,g)=>{var m;return((m=p[g])===null||m===void 0?void 0:m.op)!=="NoOp"}).map(f=>va(f,r,n,a))}let c=va(t.inputNames[d],r,n,a),h=c.dataSync();return s.type==="number"?h[0]:R.toNestedArray(c.shape,h)}let i=t.attrParams[e];return i&&i.value}function va(e,t,r,n){let[a,s]=Fs(e,r);if(n!=null){let o=n.getHashTableHandleByName(a);if(o!=null)return o}let i=r.currentContextIds.find(o=>!!t[bS(a,o)]);return i!==void 0?t[bS(a,i)][s]:void 0}function V4(e,t,r){return t[bS(e,r.currentContextId)]}function Fl(e,t){let[r,n,a]=Fs(e,t);return[bS(r,t&&t.currentContextId),n,a]}function bS(e,t){return t?`${e}-${t}`:e}function Fs(e,t){if(e==="")return["",0,void 0];let r=t!=null&&t.parseNodeNameCache!=null;if(r){let s=t.parseNodeNameCache.get(e);if(s!=null)return s}let n=e.split(":"),a;if(n.length===1)a=[e,0,void 0];else{let s=n[0],i=n.length===3?n[1]:void 0,o=Number(n[n.length-1]);a=[s,o,i]}return r&&t.parseNodeNameCache.set(e,a),a}function Z1(e,t,r){let n=D("pad",e,t,r);if(n==="explicit"){n=D("explicitPaddings",e,t,r);let a=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)a[s][0]=n[s*2],a[s][1]=n[s*2+1];return a}return n}function Ol(e){return e.kept?e:il(e)}var SY={};Ut(SY,{json:()=>FLe});var FLe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_Y={};Ut(_Y,{json:()=>OLe});var OLe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kY={};Ut(kY,{json:()=>PLe});var PLe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],CY={};Ut(CY,{json:()=>LLe});var LLe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],IY={};Ut(IY,{json:()=>zLe});var zLe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],EY={};Ut(EY,{json:()=>BLe});var BLe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],TY={};Ut(TY,{json:()=>ULe});var ULe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],jY={};Ut(jY,{json:()=>WLe});var WLe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],AY={};Ut(AY,{json:()=>VLe});var VLe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],$Y={};Ut($Y,{json:()=>HLe});var HLe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],RY={};Ut(RY,{json:()=>qLe});var qLe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],DY={};Ut(DY,{json:()=>GLe});var GLe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],MY={};Ut(MY,{json:()=>KLe});var KLe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],FY={};Ut(FY,{json:()=>QLe});var QLe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],OY={};Ut(OY,{json:()=>XLe});var XLe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],PY={};Ut(PY,{json:()=>YLe});var YLe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],LY={};Ut(LY,{json:()=>JLe});var JLe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],zY={};Ut(zY,{json:()=>ZLe});var ZLe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],BY={};Ut(BY,{json:()=>e3e});var e3e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],H4=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[SY,_Y,kY,CY,IY,EY,TY,jY,AY,$Y,RY,DY,MY,FY,OY,PY,LY,zY,BY],t=[].concat(...e.map(r=>r.json));this.opMappers=t.reduce((r,n)=>(r[n.tfOpName]=n,r),{})}transformGraph(e,t={}){let r=e.node,n=[],a=[],s=[],i=r.reduce((g,m)=>(g[m.name]=this.mapNode(m),m.op.startsWith("Placeholder")?n.push(g[m.name]):m.op==="Const"?a.push(g[m.name]):(m.input==null||m.input.length===0)&&s.push(g[m.name]),g),{}),o=[],u=[],d={},c={};t!=null&&(d=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));let h=Object.keys(i);h.forEach(g=>{let m=i[g];m.inputNames.forEach((x,y)=>{let[v,,b]=Fl(x),N=i[v];if(N.outputs!=null){let S=N.outputs.indexOf(b);if(S!==-1){let _=`${v}:${S}`;m.inputNames[y]=_}}m.inputs.push(N),N.children.push(m)})}),Object.keys(c).length===0?h.forEach(g=>{let m=i[g];m.children.length===0&&u.push(m)}):Object.keys(c).forEach(g=>{let[m]=Fl(g),x=i[m];x!=null&&(x.signatureKey=c[g],u.push(x))}),Object.keys(d).length>0?Object.keys(d).forEach(g=>{let[m]=Fl(g),x=i[m];x&&(x.signatureKey=d[g],o.push(x))}):o=n;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((g,m)=>(g[m.signature.name]=this.mapFunction(m),g),{}));let f={nodes:i,inputs:o,outputs:u,weights:a,placeholders:n,signature:t,functions:p};return s.length>0&&(f.initNodes=s),f}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,r)=>(t[e[r].name]=r,t),{})}mapNode(e){let t=NY(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});let r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(n=>n.startsWith("^")?n.slice(1):n),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(r.inputParams=t.inputs.reduce((n,a)=>(n[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},n),{})),t.attrs!=null&&(r.attrParams=t.attrs.reduce((n,a)=>{let s=a.type,i;switch(a.type){case"string":i=QT(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=QT(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":i=rj(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=rj(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":i=YT(e.attr,a.tfName,a.defaultValue||0),i===void 0&&a.tfDeprecatedName&&(i=YT(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":i=tj(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=tj(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":i=XT(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=XT(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":i=aj(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=aj(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":i=ej(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=ej(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":i=nj(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=nj(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":i=JT(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=JT(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":i=ZT(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=ZT(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":i=q4(e.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=q4(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return n[a.name]={value:i,type:s},n},{})),r}mapFunction(e){let t=e.nodeDef,r=[],n=[],a={};t!=null&&(a=t.reduce((d,c)=>(d[c.name]=this.mapNode(c),c.op==="Const"&&n.push(d[c.name]),d),{}));let s=[],i=[];e.signature.inputArg.forEach(d=>{let[c]=Fl(d.name),h={name:c,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:EF(d.type),type:"dtype"}},children:[]};h.signatureKey=d.name,s.push(h),a[c]=h}),Object.keys(a).forEach(d=>{let c=a[d];c.inputNames.forEach((h,p)=>{let[f,,g]=Fl(h),m=a[f];if(m.outputs!=null){let x=m.outputs.indexOf(g);if(x!==-1){let y=`${f}:${x}`;c.inputNames[p]=y}}c.inputs.push(m),m.children.push(c)})});let o=e.ret;e.signature.outputArg.forEach(d=>{let[c,h]=Fl(o[d.name]),p=a[c];p!=null&&(p.defaultOutput=h,i.push(p))});let u=this.mapArgsToSignature(e);return{nodes:a,inputs:s,outputs:i,weights:n,placeholders:r,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r),t),{}),outputs:e.signature.outputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r,e.ret),t),{})}}mapArgToTensorInfo(e,t){let r=e.name;return t!=null&&(r=t[r]),{name:r,dtype:e.type}}};function t3e(e){let t=ge().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function UY(e,t){let r=Array.isArray(e)?String.fromCharCode.apply(null,e):t3e(e);return t?r:r.toLowerCase()}function QT(e,t,r,n=!1){let a=e[t];return a!=null?UY(a.s,n):r}function XT(e,t,r){let n=e[t];return n?n.b:r}function YT(e,t,r){let n=e[t]||{},a=n.i!=null?n.i:n.f!=null?n.f:r;return typeof a=="number"?a:parseInt(a,10)}function EF(e){switch(typeof e=="string"&&(e=As[e]),e){case As.DT_FLOAT:case As.DT_HALF:return"float32";case As.DT_INT32:case As.DT_INT64:case As.DT_INT8:case As.DT_UINT8:return"int32";case As.DT_BOOL:return"bool";case As.DT_DOUBLE:return"float32";case As.DT_STRING:return"string";case As.DT_COMPLEX64:case As.DT_COMPLEX128:return"complex64";default:return null}}function q4(e,t,r){let n=e[t];return n&&n.func?n.func.name:r}function JT(e,t,r){let n=e[t];return n&&n.type?EF(n.type):r}function ZT(e,t,r){let n=e[t];return n&&n.list&&n.list.type?n.list.type.map(a=>EF(a)):r}function WY(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function ej(e,t,r){let n=e[t];return n&&n.shape?WY(n.shape):r}function tj(e,t,r){let n=e[t];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):r}function rj(e,t,r,n=!1){let a=e[t];return a&&a.list&&a.list.s?a.list.s.map(s=>UY(s,n)):r}function nj(e,t,r){let n=e[t];return n&&n.list&&n.list.shape?n.list.shape.map(a=>WY(a)):r}function aj(e,t,r){let n=e[t];return n&&n.list&&n.list.b?n.list.b:r}var r3e=class{constructor(e,t,r){this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(n=>this.getInput(n)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((n,a)=>(n[a]=this.getAttr(a),n),{}))}getInput(e){return va(e,this.tensorMap,this.context)}getAttr(e,t){let r=this.node.rawAttrs[e];if(r.tensor!=null)return va(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return YT(this.node.rawAttrs,e,t);if(r.s!=null)return QT(this.node.rawAttrs,e,t);if(r.b!=null)return XT(this.node.rawAttrs,e,t);if(r.shape!=null)return ej(this.node.rawAttrs,e,t);if(r.type!=null)return JT(this.node.rawAttrs,e,t);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return tj(this.node.rawAttrs,e,t);if(r.list.s!=null)return rj(this.node.rawAttrs,e,t);if(r.list.shape!=null)return nj(this.node.rawAttrs,e,t);if(r.list.b!=null)return aj(this.node.rawAttrs,e,t);if(r.list.type!=null)return ZT(this.node.rawAttrs,e,t)}return t}},ma={};Ut(ma,{OP_SCOPE_SUFFIX:()=>jR,abs:()=>Fn,acos:()=>MR,acosh:()=>FR,add:()=>Ne,addN:()=>nK,all:()=>Tk,any:()=>db,argMax:()=>Eh,argMin:()=>OR,asin:()=>PR,asinh:()=>LR,atan:()=>zR,atan2:()=>BR,atanh:()=>UR,avgPool:()=>hu,avgPool3d:()=>VR,basicLSTMCell:()=>oK,batchNorm:()=>mf,batchNorm2d:()=>HR,batchNorm3d:()=>qR,batchNorm4d:()=>GR,batchToSpaceND:()=>P0,bincount:()=>KR,bitwiseAnd:()=>lK,booleanMaskAsync:()=>YK,broadcastArgs:()=>uK,broadcastTo:()=>eh,buffer:()=>Qt,cast:()=>Pe,ceil:()=>QR,clipByValue:()=>Ma,clone:()=>il,complex:()=>su,concat:()=>zr,concat1d:()=>XR,concat2d:()=>YR,concat3d:()=>JR,concat4d:()=>ZR,conv1d:()=>jk,conv2d:()=>Za,conv2dTranspose:()=>Ak,conv3d:()=>tD,conv3dTranspose:()=>rD,cos:()=>L0,cosh:()=>$k,cosineWindow:()=>tC,cumprod:()=>fb,cumsum:()=>Rk,denseBincount:()=>uS,depthToSpace:()=>nD,depthwiseConv2d:()=>gf,diag:()=>dK,dilation2d:()=>aD,div:()=>it,divNoNan:()=>sD,dot:()=>iD,dropout:()=>MD,einsum:()=>Ed,elu:()=>Zx,enclosingPowerOfTwo:()=>FD,ensureShape:()=>pK,equal:()=>Xs,erf:()=>Dk,euclideanNorm:()=>uD,exp:()=>Fa,expandDims:()=>la,expm1:()=>cD,eye:()=>Mk,fft:()=>Q0,fill:()=>Qs,floor:()=>ty,floorDiv:()=>Ek,fused:()=>gg,gather:()=>ry,gatherND:()=>tQ,greater:()=>as,greaterEqual:()=>pu,ifft:()=>mg,imag:()=>z0,image:()=>li,inTopKAsync:()=>rQ,irfft:()=>Kk,isFinite:()=>dD,isInf:()=>hD,isNaN:()=>pD,leakyRelu:()=>B0,less:()=>dg,lessEqual:()=>rd,linalg:()=>LD,linspace:()=>yK,localResponseNormalization:()=>fD,log:()=>Ys,log1p:()=>U0,logSigmoid:()=>mD,logSoftmax:()=>Ok,logSumExp:()=>W0,logicalAnd:()=>qi,logicalNot:()=>V0,logicalOr:()=>Pk,logicalXor:()=>gD,losses:()=>fQ,lowerBound:()=>bK,matMul:()=>Gt,max:()=>fi,maxPool:()=>na,maxPool3d:()=>xD,maxPoolWithArgmax:()=>wK,maximum:()=>wl,mean:()=>mn,meshgrid:()=>NK,min:()=>cg,minimum:()=>$c,mirrorPad:()=>yD,mod:()=>vD,moments:()=>H0,movingAverage:()=>JK,mul:()=>oe,multiRNNCell:()=>SK,multinomial:()=>_K,neg:()=>Jr,norm:()=>ey,notEqual:()=>Ah,oneHot:()=>hg,ones:()=>fs,onesLike:()=>Js,op:()=>ie,outerProduct:()=>kK,pad:()=>Fo,pad1d:()=>CK,pad2d:()=>IK,pad3d:()=>EK,pad4d:()=>TK,pool:()=>bD,pow:()=>pl,prelu:()=>G0,print:()=>DR,prod:()=>wD,raggedGather:()=>jK,raggedRange:()=>AK,raggedTensorToTensor:()=>$K,rand:()=>RK,randomGamma:()=>OK,randomNormal:()=>zk,randomStandardNormal:()=>PK,randomUniform:()=>nd,randomUniformInt:()=>LK,range:()=>$h,real:()=>pg,reciprocal:()=>CD,relu:()=>Tr,relu6:()=>Bk,reshape:()=>ue,reverse:()=>Si,reverse1d:()=>zK,reverse2d:()=>BK,reverse3d:()=>UK,reverse4d:()=>WK,rfft:()=>X0,round:()=>Uk,rsqrt:()=>Wk,scalar:()=>bt,scatterND:()=>ZK,searchSorted:()=>Lk,selu:()=>Vk,separableConv2d:()=>ny,setdiff1dAsync:()=>VK,sigmoid:()=>Wi,sign:()=>ID,signal:()=>pQ,sin:()=>Hk,sinh:()=>qk,slice:()=>ir,slice1d:()=>K0,slice2d:()=>Gk,slice3d:()=>ay,slice4d:()=>fg,softmax:()=>ad,softplus:()=>xf,spaceToBatchND:()=>q0,sparse:()=>mQ,sparseToDense:()=>eQ,spectral:()=>hQ,split:()=>gs,sqrt:()=>ha,square:()=>Pr,squaredDifference:()=>Qk,squeeze:()=>sd,stack:()=>Bn,step:()=>yf,stridedSlice:()=>ED,string:()=>gQ,sub:()=>Ze,sum:()=>ht,tan:()=>TD,tanh:()=>Ac,tensor:()=>Qa,tensor1d:()=>Cr,tensor2d:()=>ol,tensor3d:()=>Xk,tensor4d:()=>Rc,tensor5d:()=>HK,tensor6d:()=>qK,tensorScatterUpdate:()=>KK,tile:()=>Us,topk:()=>AD,transpose:()=>Kt,truncatedNormal:()=>Zk,unique:()=>$D,unsortedSegmentSum:()=>eC,unstack:()=>Cn,upperBound:()=>QK,variable:()=>RD,where:()=>da,whereAsync:()=>DD,zeros:()=>gn,zerosLike:()=>hr});var n3e=(e,t,r,n=ma)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[n.add(D("a",e,t,r),D("b",e,t,r))];case"AddN":return[n.addN(D("tensors",e,t,r))];case"FloorMod":case"Mod":return[n.mod(D("a",e,t,r),D("b",e,t,r))];case"Mul":return[n.mul(D("a",e,t,r),D("b",e,t,r))];case"RealDiv":case"Div":return[n.div(D("a",e,t,r),D("b",e,t,r))];case"DivNoNan":return[n.divNoNan(D("a",e,t,r),D("b",e,t,r))];case"FloorDiv":return[n.floorDiv(D("a",e,t,r),D("b",e,t,r))];case"Sub":return[n.sub(D("a",e,t,r),D("b",e,t,r))];case"Minimum":return[n.minimum(D("a",e,t,r),D("b",e,t,r))];case"Maximum":return[n.maximum(D("a",e,t,r),D("b",e,t,r))];case"Pow":return[n.pow(D("a",e,t,r),D("b",e,t,r))];case"SquaredDifference":return[n.squaredDifference(D("a",e,t,r),D("b",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},a3e=(e,t,r,n=ma)=>{switch(e.op){case"Abs":case"ComplexAbs":return[n.abs(D("x",e,t,r))];case"Acos":return[n.acos(D("x",e,t,r))];case"Acosh":return[n.acosh(D("x",e,t,r))];case"Asin":return[n.asin(D("x",e,t,r))];case"Asinh":return[n.asinh(D("x",e,t,r))];case"Atan":return[n.atan(D("x",e,t,r))];case"Atan2":return[n.atan2(D("x",e,t,r),D("y",e,t,r))];case"Atanh":return[n.atanh(D("x",e,t,r))];case"Ceil":return[n.ceil(D("x",e,t,r))];case"Complex":return[n.complex(D("real",e,t,r),D("imag",e,t,r))];case"Cos":return[n.cos(D("x",e,t,r))];case"Cosh":return[n.cosh(D("x",e,t,r))];case"Elu":return[n.elu(D("x",e,t,r))];case"Erf":return[n.erf(D("x",e,t,r))];case"Exp":return[n.exp(D("x",e,t,r))];case"Expm1":return[n.expm1(D("x",e,t,r))];case"Floor":return[n.floor(D("x",e,t,r))];case"Log":return[n.log(D("x",e,t,r))];case"Log1p":return[n.log1p(D("x",e,t,r))];case"Imag":return[n.imag(D("x",e,t,r))];case"Neg":return[n.neg(D("x",e,t,r))];case"Reciprocal":return[n.reciprocal(D("x",e,t,r))];case"Real":return[n.real(D("x",e,t,r))];case"Relu":return[n.relu(D("x",e,t,r))];case"Round":return[n.round(D("x",e,t,r))];case"Selu":return[n.selu(D("x",e,t,r))];case"Sigmoid":return[n.sigmoid(D("x",e,t,r))];case"Sin":return[n.sin(D("x",e,t,r))];case"Sign":return[n.sign(D("x",e,t,r))];case"Sinh":return[n.sinh(D("x",e,t,r))];case"Softplus":return[n.softplus(D("x",e,t,r))];case"Sqrt":return[n.sqrt(D("x",e,t,r))];case"Square":return[n.square(D("x",e,t,r))];case"Tanh":return[n.tanh(D("x",e,t,r))];case"Tan":return[n.tan(D("x",e,t,r))];case"ClipByValue":return[n.clipByValue(D("x",e,t,r),D("clipValueMin",e,t,r),D("clipValueMax",e,t,r))];case"Relu6":return[n.relu6(D("x",e,t,r))];case"Rsqrt":return[n.rsqrt(va(e.inputNames[0],t,r))];case"LeakyRelu":return[n.leakyRelu(D("x",e,t,r),D("alpha",e,t,r))];case"Prelu":return[n.prelu(D("x",e,t,r),D("alpha",e,t,r))];case"IsNan":return[n.isNaN(va(e.inputNames[0],t,r))];case"IsInf":return[n.isInf(va(e.inputNames[0],t,r))];case"IsFinite":return[n.isFinite(va(e.inputNames[0],t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function $i(e,t,r=""){if(!(typeof e=="number"||typeof t=="number")){R.assert(e.length===t.length,()=>r+` Shapes ${e} and ${t} must match`);for(let n=0;n<e.length;n++){let a=e[n],s=t[n];R.assert(a<0||s<0||a===s,()=>r+` Shapes ${e} and ${t} must match`)}}}function G4(e){return!(typeof e=="number"||e.some(t=>t<0))}function By(e,t,r){let n=sj(e,r),a=!G4(n);if(a&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${n}`);if(a&&t.forEach(s=>{n=sj(s.shape,n)}),!G4(n))throw new Error(`Non-fully-defined elementShape: ${n}`);return n}function sj(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);let r=[];for(let n=0;n<e.length;++n){let a=e[n],s=t[n];if(a>=0&&s>=0&&a!==s)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);r[n]=a>=0?a:s}return r}var s3e=class{constructor(e,t,r,n,a,s,i){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=n,this.identicalElementShapes=a,this.dynamicSize=s,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=bt(0),Qn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);let t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);let r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),$i(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=t,Qn(t),r.written=!0,this.tensors[e]=r}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((r,n)=>this.write(r,t[n]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let n=0;n<this.size();n++)e.push(n)}if(e.length===0)return Qa([],[0].concat(this.elementShape));let r=this.readMany(e);return $i(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Bn(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Qa([],[0].concat(this.elementShape));let t=[];for(let n=0;n<this.size();n++)t.push(n);let r=this.readMany(t);return $i(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),zr(r,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);let r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Cn(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let r=0,n=e.map(o=>(r+=o,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);let a=r===0?0:t.size/r,s=[];ce(()=>{t=ue(t,[1,r,a]);for(let o=0;o<e.length;++o){let u=[0,o===0?0:n[o-1],0],d=[1,e[o],a];s[o]=ue(ir(t,u,d),this.elementShape)}return s});let i=[];for(let o=0;o<e.length;o++)i[o]=o;this.writeMany(i,s)}},TC=class ij{get id(){return this.idTensor.id}constructor(t,r,n,a=-1){this.tensors=t,this.elementShape=r,this.elementDtype=n,t!=null&&t.forEach(s=>{if(n!==s.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${s.dtype}`);$i(r,s.shape,"TensorList shape mismatch: "),Qn(s)}),this.idTensor=bt(0),this.maxNumElements=a,Qn(this.idTensor)}copy(){return new ij([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(r=>{(t==null||!t.has(r.id))&&r.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,r,n=-1){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(n!==-1&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);$i(t,this.elementShape,"TensorList shape mismatch: ");let a=By(this.elementShape,this.tensors,t);return ce(()=>{let s=this.tensors.map(i=>ue(i,a));return Bn(s,0)})}popBack(t,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");let n=By(this.elementShape,this.tensors,t),a=this.tensors.pop();return a.kept=!1,$i(a.shape,t,"TensorList shape mismatch: "),ue(a,n)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if($i(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Qn(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);let r=new ij([],this.elementShape,this.elementDtype,this.maxNumElements);r.tensors.length=t;for(let n=0;n<Math.min(this.tensors.length,t);++n)r.tensors[n]=this.tensors[n];return r}getItem(t,r,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);$i(this.tensors[t].shape,r,"TensorList shape mismatch: ");let a=By(this.elementShape,this.tensors,r);return ue(this.tensors[t],a)}setItem(t,r){if(r.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);$i(this.elementShape,r.shape,"TensorList shape mismatch: "),Qn(r),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=r}gather(t,r,n){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);$i(this.elementShape,n,"TensorList shape mismatch: "),t=t.slice(0,this.size());let a=By(this.elementShape,this.tensors,n);return t.length===0?Qa([],[0].concat(a)):ce(()=>{let s=t.map(i=>ue(this.tensors[i],a));return Bn(s,0)})}concat(t,r){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);$i(this.elementShape,r,"TensorList shape mismatch: ");let n=By(this.elementShape,this.tensors,r);return this.size()===0?Qa([],[0].concat(n)):ce(()=>{let a=this.tensors.map(s=>ue(s,n));return zr(a,0)})}};function i3e(e,t,r){let n=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==r)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${r}`);let a=e.shape.slice(1);$i(a,t,"TensorList shape mismatch: ");let s=Cn(e);return new TC(s,t,n)}function o3e(e,t,r,n){return new TC([],e,t,n)}function l3e(e,t,r,n){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);let a=Math.max(...t);if(n!=null&&n!==-1&&a>=n)throw new Error(`Max index must be < array size (${a}  vs. ${n})`);let s=new TC([],r,e.dtype,n),i=Cn(e,0);return t.forEach((o,u)=>{s.setItem(o,i[u])}),s}function u3e(e,t,r){let n=0,a=t.map(c=>(n+=c,n));if(n!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${n}, and tensor's shape is: ${e.shape}`);let s=e.shape.slice(1),i=sj(s,r),o=n===0?0:e.size/n,u=ce(()=>{let c=[];e=ue(e,[1,n,o]);for(let h=0;h<t.length;++h){let p=[0,h===0?0:a[h-1],0],f=[1,t[h],o];c[h]=ue(ir(e,p,f),i)}return e.dispose(),c}),d=new TC([],r,e.dtype,t.length);for(let c=0;c<u.length;c++)d.setItem(c,u[c]);return d}var c3e=async(e,t,r)=>{switch(e.op){case"If":case"StatelessIf":{let n=D("thenBranch",e,t,r),a=D("elseBranch",e,t,r),s=D("cond",e,t,r),i=D("args",e,t,r);return(await s.data())[0]?r.functionMap[n].executeFunctionAsync(i,r.tensorArrayMap,r.tensorListMap):r.functionMap[a].executeFunctionAsync(i,r.tensorArrayMap,r.tensorListMap)}case"While":case"StatelessWhile":{let n=D("body",e,t,r),a=D("cond",e,t,r),s=D("args",e,t,r),i=await r.functionMap[a].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap),o=s.map(c=>c.id),u=await i[0].data();i.forEach(c=>{!c.kept&&o.indexOf(c.id)===-1&&c.dispose()});let d=s;for(;u[0];){let c=d;d=await r.functionMap[n].executeFunctionAsync(d,r.tensorArrayMap,r.tensorListMap);let h=d.map(f=>f.id);c.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()});let p=await r.functionMap[a].executeFunctionAsync(d,r.tensorArrayMap,r.tensorListMap);u=await p[0].data(),p.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&h.indexOf(f.id)===-1&&f.dispose()})}return d}case"LoopCond":{let n=D("pred",e,t,r);return[Ol(n)]}case"Switch":{let n=D("pred",e,t,r),a=D("data",e,t,r);return a.kept||(a=Ol(a)),(await n.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{let n=e.inputNames.find(a=>va(a,t,r)!==void 0);if(n){let a=va(n,t,r);return[Ol(a)]}return}case"Enter":{let n=D("frameName",e,t,r),a=D("tensor",e,t,r);return r.enterFrame(n),[Ol(a)]}case"Exit":{let n=D("tensor",e,t,r);return r.exitFrame(),[Ol(n)]}case"NextIteration":{let n=D("tensor",e,t,r);return r.nextIteration(),[Ol(n)]}case"TensorArrayV3":{let n=D("size",e,t,r),a=D("dtype",e,t,r),s=D("elementShape",e,t,r),i=D("dynamicSize",e,t,r),o=D("clearAfterRead",e,t,r),u=D("identicalElementShapes",e,t,r),d=D("name",e,t,r),c=new s3e(d,a,n,s,u,i,o);return r.addTensorArray(c),[c.idTensor,bt(1)]}case"TensorArrayWriteV3":{let n=D("tensorArrayId",e,t,r),a=D("index",e,t,r),s=D("tensor",e,t,r),i=r.getTensorArray(n.id);return i.write(a,s),[i.idTensor]}case"TensorArrayReadV3":{let n=D("tensorArrayId",e,t,r),a=D("index",e,t,r);return[r.getTensorArray(n.id).read(a)]}case"TensorArrayGatherV3":{let n=D("tensorArrayId",e,t,r),a=D("indices",e,t,r),s=D("dtype",e,t,r);return[r.getTensorArray(n.id).gather(a,s)]}case"TensorArrayScatterV3":{let n=D("tensorArrayId",e,t,r),a=D("indices",e,t,r),s=D("tensor",e,t,r),i=r.getTensorArray(n.id);return i.scatter(a,s),[i.idTensor]}case"TensorArrayConcatV3":{let n=D("tensorArrayId",e,t,r),a=r.getTensorArray(n.id),s=D("dtype",e,t,r);return[a.concat(s)]}case"TensorArraySplitV3":{let n=D("tensorArrayId",e,t,r),a=D("tensor",e,t,r),s=D("lengths",e,t,r),i=r.getTensorArray(n.id);return i.split(s,a),[i.idTensor]}case"TensorArraySizeV3":{let n=D("tensorArrayId",e,t,r),a=r.getTensorArray(n.id);return[bt(a.size(),"int32")]}case"TensorArrayCloseV3":{let n=D("tensorArrayId",e,t,r),a=r.getTensorArray(n.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{let n=D("tensorListId",e,t,r),a=D("index",e,t,r),s=D("tensor",e,t,r),i=r.getTensorList(n.id);return i.setItem(a,s),[i.idTensor]}case"TensorListGetItem":{let n=D("tensorListId",e,t,r),a=D("index",e,t,r),s=D("elementShape",e,t,r),i=D("elementDType",e,t,r);return[r.getTensorList(n.id).getItem(a,s,i)]}case"TensorListScatterV2":case"TensorListScatter":{let n=D("indices",e,t,r),a=D("tensor",e,t,r),s=D("elementShape",e,t,r),i=D("numElements",e,t,r),o=l3e(a,n,s,i);return r.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let n=D("elementShape",e,t,r),a=D("elementDType",e,t,r),s;e.op==="TensorListReserve"?s="numElements":s="maxNumElements";let i=D(s,e,t,r),o=e.op==="TensorListReserve"?-1:i,u=o3e(n,a,i,o);return r.addTensorList(u),[u.idTensor]}case"TensorListGather":{let n=D("tensorListId",e,t,r),a=D("indices",e,t,r),s=D("elementShape",e,t,r),i=D("elementDType",e,t,r);return[r.getTensorList(n.id).gather(a,i,s)]}case"TensorListStack":{let n=D("tensorListId",e,t,r),a=D("elementShape",e,t,r),s=D("elementDType",e,t,r),i=D("numElements",e,t,r);return[r.getTensorList(n.id).stack(a,s,i)]}case"TensorListFromTensor":{let n=D("tensor",e,t,r),a=D("elementShape",e,t,r),s=D("elementDType",e,t,r),i=i3e(n,a,s);return r.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let n=D("tensorListId",e,t,r),a=r.getTensorList(n.id),s=D("dtype",e,t,r),i=D("elementShape",e,t,r);return[a.concat(s,i)]}case"TensorListPushBack":{let n=D("tensorListId",e,t,r),a=D("tensor",e,t,r),s=r.getTensorList(n.id);return s.pushBack(a),[s.idTensor]}case"TensorListPopBack":{let n=D("tensorListId",e,t,r),a=D("elementShape",e,t,r),s=D("elementDType",e,t,r);return[r.getTensorList(n.id).popBack(a,s)]}case"TensorListSplit":{let n=D("tensor",e,t,r),a=D("elementShape",e,t,r),s=D("lengths",e,t,r),i=u3e(n,s,a);return r.addTensorList(i),[i.idTensor]}case"TensorListLength":{let n=D("tensorListId",e,t,r),a=r.getTensorList(n.id);return[bt(a.size(),"int32")]}case"TensorListResize":{let n=D("tensorListId",e,t,r),a=D("size",e,t,r),s=r.getTensorList(n.id).resize(a);return r.addTensorList(s),[s.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};function K4(e,t,r){let[n,a]=D("fusedOps",e,t,r),s=n==="biasadd",i=!s,o=a==="prelu",u=n==="fusedbatchnorm",d=D("numArgs",e,t,r);if(s){if(o&&d!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&s&&d!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let c=D("strides",e,t,r),h=Z1(e,t,r),p=D("dataFormat",e,t,r).toUpperCase(),f=D("dilations",e,t,r),[g,m]=D("args",e,t,r);i&&(m=g,g=void 0);let x=D("leakyreluAlpha",e,t,r);return{stride:c,pad:h,dataFormat:p,dilations:f,biasArg:g,preluArg:m,activationFunc:a,leakyreluAlpha:x}}var d3e=(e,t,r,n=ma)=>{switch(e.op){case"Conv1D":{let a=D("stride",e,t,r),s=D("pad",e,t,r),i=D("dataFormat",e,t,r).toUpperCase(),o=D("dilation",e,t,r);return[n.conv1d(D("x",e,t,r),D("filter",e,t,r),a,s,i,o)]}case"Conv2D":{let a=D("strides",e,t,r),s=Z1(e,t,r),i=D("dataFormat",e,t,r).toUpperCase(),o=D("dilations",e,t,r);return[n.conv2d(D("x",e,t,r),D("filter",e,t,r),[a[1],a[2]],s,i,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:a,pad:s,dataFormat:i,dilations:o,biasArg:u,preluArg:d,activationFunc:c,leakyreluAlpha:h}=K4(e,t,r);return[n.fused.conv2d({x:D("x",e,t,r),filter:D("filter",e,t,r),strides:[a[1],a[2]],pad:s,dataFormat:i,dilations:[o[1],o[2]],bias:u,activation:c,preluActivationWeights:d,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{let{stride:a,pad:s,dataFormat:i,dilations:o,biasArg:u,preluArg:d,activationFunc:c,leakyreluAlpha:h}=K4(e,t,r);return[n.fused.depthwiseConv2d({x:D("x",e,t,r),filter:D("filter",e,t,r),strides:[a[1],a[2]],pad:s,dataFormat:i,dilations:[o[1],o[2]],bias:u,activation:c,preluActivationWeights:d,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let a=D("outputShape",e,t,r),s=D("strides",e,t,r),i=Z1(e,t,r);return[n.conv2dTranspose(D("x",e,t,r),D("filter",e,t,r),a,[s[1],s[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let a=D("strides",e,t,r),s=Z1(e,t,r),i=D("dilations",e,t,r),o=D("dataFormat",e,t,r).toUpperCase();return[n.depthwiseConv2d(D("input",e,t,r),D("filter",e,t,r),[a[1],a[2]],s,o,[i[1],i[2]])]}case"Conv3D":{let a=D("strides",e,t,r),s=D("pad",e,t,r),i=D("dataFormat",e,t,r).toUpperCase(),o=D("dilations",e,t,r);return[n.conv3d(D("x",e,t,r),D("filter",e,t,r),[a[1],a[2],a[3]],s,i,[o[1],o[2],o[3]])]}case"AvgPool":{let a=D("strides",e,t,r),s=D("pad",e,t,r),i=D("kernelSize",e,t,r);return[n.avgPool(D("x",e,t,r),[i[1],i[2]],[a[1],a[2]],s)]}case"MaxPool":{let a=D("strides",e,t,r),s=D("pad",e,t,r),i=D("kernelSize",e,t,r);return[n.maxPool(D("x",e,t,r),[i[1],i[2]],[a[1],a[2]],s)]}case"MaxPoolWithArgmax":{let a=D("strides",e,t,r),s=D("pad",e,t,r),i=D("kernelSize",e,t,r),o=D("includeBatchInIndex",e,t,r),{result:u,indexes:d}=n.maxPoolWithArgmax(D("x",e,t,r),[i[1],i[2]],[a[1],a[2]],s,o);return[u,d]}case"AvgPool3D":{let a=D("strides",e,t,r),s=D("pad",e,t,r),i=D("kernelSize",e,t,r);return[n.avgPool3d(D("x",e,t,r),[i[1],i[2],i[3]],[a[1],a[2],a[3]],s)]}case"MaxPool3D":{let a=D("strides",e,t,r),s=D("pad",e,t,r),i=D("kernelSize",e,t,r);return[n.maxPool3d(D("x",e,t,r),[i[1],i[2],i[3]],[a[1],a[2],a[3]],s)]}case"Dilation2D":{let a=D("strides",e,t,r),s=D("pad",e,t,r),i=D("dilations",e,t,r),o=a[1],u=a[2],d=i[1],c=i[2];return[n.dilation2d(D("x",e,t,r),D("filter",e,t,r),[o,u],s,[d,c],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},h3e=(e,t,r,n=ma)=>{switch(e.op){case"Fill":{let a=D("shape",e,t,r),s=D("dtype",e,t,r),i=D("value",e,t,r);return[n.fill(a,i,s)]}case"LinSpace":{let a=D("start",e,t,r),s=D("stop",e,t,r),i=D("num",e,t,r);return[n.linspace(a,s,i)]}case"Multinomial":{let a=D("logits",e,t,r),s=D("numSamples",e,t,r),i=D("seed",e,t,r);return[n.multinomial(a,s,i)]}case"OneHot":{let a=D("indices",e,t,r),s=D("depth",e,t,r),i=D("onValue",e,t,r),o=D("offValue",e,t,r),u=D("dtype",e,t,r);return[n.oneHot(a,s,i,o,u)]}case"Ones":return[n.ones(D("shape",e,t,r),D("dtype",e,t,r))];case"OnesLike":return[n.onesLike(D("x",e,t,r))];case"RandomStandardNormal":return[n.randomStandardNormal(D("shape",e,t,r),D("dtype",e,t,r),D("seed",e,t,r))];case"RandomUniform":return[n.randomUniform(D("shape",e,t,r),D("minval",e,t,r),D("maxval",e,t,r),D("dtype",e,t,r))];case"RandomUniformInt":return[n.randomUniformInt(D("shape",e,t,r),D("minval",e,t,r),D("maxval",e,t,r),D("seed",e,t,r))];case"Range":{let a=D("start",e,t,r),s=D("stop",e,t,r),i=D("step",e,t,r);return[n.range(a,s,i,D("dtype",e,t,r))]}case"TruncatedNormal":{let a=D("shape",e,t,r),s=D("mean",e,t,r),i=D("stdDev",e,t,r),o=D("seed",e,t,r);return[n.truncatedNormal(a,s,i,D("dtype",e,t,r),o)]}case"Zeros":return[n.zeros(D("shape",e,t,r),D("dtype",e,t,r))];case"ZerosLike":return[n.zerosLike(D("x",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function cI(e,t,r){let n=D("boxes",e,t,r),a=D("scores",e,t,r),s=D("maxOutputSize",e,t,r),i=D("iouThreshold",e,t,r),o=D("scoreThreshold",e,t,r),u=D("softNmsSigma",e,t,r);return{boxes:n,scores:a,maxOutputSize:s,iouThreshold:i,scoreThreshold:o,softNmsSigma:u}}var p3e=async(e,t,r,n,a=ma)=>{switch(e.op){case"NonMaxSuppressionV5":{let{boxes:s,scores:i,maxOutputSize:o,iouThreshold:u,scoreThreshold:d,softNmsSigma:c}=cI(e,t,r),h=await a.image.nonMaxSuppressionWithScoreAsync(s,i,o,u,d,c);return[h.selectedIndices,h.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:s,scores:i,maxOutputSize:o,iouThreshold:u,scoreThreshold:d}=cI(e,t,r),c=D("padToMaxOutputSize",e,t,r),h=await a.image.nonMaxSuppressionPaddedAsync(s,i,o,u,d,c);return[h.selectedIndices,h.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:s,scores:i,maxOutputSize:o,iouThreshold:u,scoreThreshold:d}=cI(e,t,r);return[await a.image.nonMaxSuppressionAsync(s,i,o,u,d)]}case"Where":{let s=a.cast(D("condition",e,t,r),"bool"),i=[await a.whereAsync(s)];return s.dispose(),i}case"ListDiff":return a.setdiff1dAsync(D("x",e,t,r),D("y",e,t,r));default:throw TypeError(`Node type ${e.op} is not implemented`)}},f3e=(e,t,r,n=ma)=>{switch(e.op){case"LowerBound":{let a=D("sortedSequence",e,t,r),s=D("values",e,t,r);return[n.lowerBound(a,s)]}case"TopKV2":{let a=D("x",e,t,r),s=D("k",e,t,r),i=D("sorted",e,t,r),o=n.topk(a,s,i);return[o.values,o.indices]}case"UpperBound":{let a=D("sortedSequence",e,t,r),s=D("values",e,t,r);return[n.upperBound(a,s)]}case"Unique":{let a=D("x",e,t,r),s=n.unique(a);return[s.values,s.indices]}case"UniqueV2":{let a=D("x",e,t,r),s=D("axis",e,t,r),i=n.unique(a,s);return[i.values,i.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},m3e=(e,t,r,n=ma)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let a=D("default",e,t,r);return[va(e.name,t,r)||a];case"Placeholder":return[va(e.name,t,r)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{let c=D("x",e,t,r);return[Ol(c)]}case"IdentityN":return D("x",e,t,r).map(c=>Ol(c));case"Snapshot":let s=D("x",e,t,r);return[Ol(s)];case"Shape":return[n.tensor1d(D("x",e,t,r).shape,"int32")];case"ShapeN":return D("x",e,t,r).map(c=>n.tensor1d(c.shape));case"Size":return[n.scalar(D("x",e,t,r).size,"int32")];case"Rank":return[n.scalar(D("x",e,t,r).rank,"int32")];case"NoOp":return[n.scalar(1)];case"Print":let i=D("x",e,t,r),o=D("data",e,t,r),u=D("message",e,t,r),d=D("summarize",e,t,r);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,d));return[i];default:throw TypeError(`Node type ${e.op} is not implemented`)}},g3e=class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=bt(0),this.tensorMap=new Map,Qn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return bt(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let r=await e.data();return this.tensorMap.forEach(n=>n.dispose()),this.tensorMap.clear(),ce(()=>{let n=Cn(t),a=r.length,s=n.length;R.assert(a===s,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${s} elements.`);for(let i=0;i<a;i++){let o=r[i],u=n[i];Qn(u),this.tensorMap.set(o,u)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);let r=await e.data();return ce(()=>{let n=[];for(let a=0;a<r.length;a++){let s=r[a],i=this.findWithDefault(s,t);n.push(i)}return Bn(n)})}findWithDefault(e,t){let r=this.tensorMap.get(e);return r??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}},x3e=async(e,t,r,n)=>{switch(e.op){case"HashTable":case"HashTableV2":{let a=n.getHashTableHandleByName(e.name);if(a!=null)return[a];{let s=D("keyDType",e,t,r),i=D("valueDType",e,t,r),o=new g3e(s,i);return n.addHashTable(e.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let a=D("tableHandle",e,t,r,n),s=D("keys",e,t,r),i=D("values",e,t,r);return[await n.getHashTableById(a.id).import(s,i)]}case"LookupTableFind":case"LookupTableFindV2":{let a=D("tableHandle",e,t,r,n),s=D("keys",e,t,r),i=D("defaultValue",e,t,r);return[await n.getHashTableById(a.id).find(s,i)]}case"LookupTableSize":case"LookupTableSizeV2":{let a=D("tableHandle",e,t,r,n);return[n.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},y3e=(e,t,r,n=ma)=>{switch(e.op){case"ResizeBilinear":{let a=D("images",e,t,r),s=D("size",e,t,r),i=D("alignCorners",e,t,r),o=D("halfPixelCenters",e,t,r);return[n.image.resizeBilinear(a,[s[0],s[1]],i,o)]}case"ResizeNearestNeighbor":{let a=D("images",e,t,r),s=D("size",e,t,r),i=D("alignCorners",e,t,r),o=D("halfPixelCenters",e,t,r);return[n.image.resizeNearestNeighbor(a,[s[0],s[1]],i,o)]}case"CropAndResize":{let a=D("image",e,t,r),s=D("boxes",e,t,r),i=D("boxInd",e,t,r),o=D("cropSize",e,t,r),u=D("method",e,t,r),d=D("extrapolationValue",e,t,r);return[n.image.cropAndResize(a,s,i,o,u,d)]}case"ImageProjectiveTransformV3":{let a=D("images",e,t,r),s=D("transforms",e,t,r),i=D("outputShape",e,t,r),o=D("fillValue",e,t,r),u=D("interpolation",e,t,r),d=D("fillMode",e,t,r);return[n.image.transform(a,s,u.toLowerCase(),d.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},v3e=(e,t,r,n=ma)=>{switch(e.op){case"Equal":return[n.equal(D("a",e,t,r),D("b",e,t,r))];case"NotEqual":return[n.notEqual(D("a",e,t,r),D("b",e,t,r))];case"Greater":return[n.greater(D("a",e,t,r),D("b",e,t,r))];case"GreaterEqual":return[n.greaterEqual(D("a",e,t,r),D("b",e,t,r))];case"Less":return[n.less(D("a",e,t,r),D("b",e,t,r))];case"LessEqual":return[n.lessEqual(D("a",e,t,r),D("b",e,t,r))];case"LogicalAnd":return[n.logicalAnd(D("a",e,t,r),D("b",e,t,r))];case"LogicalNot":return[n.logicalNot(D("a",e,t,r))];case"LogicalOr":return[n.logicalOr(D("a",e,t,r),D("b",e,t,r))];case"Select":case"SelectV2":return[n.where(D("condition",e,t,r),D("a",e,t,r),D("b",e,t,r))];case"BitwiseAnd":return[n.bitwiseAnd(D("a",e,t,r),D("b",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},b3e=(e,t,r,n=ma)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[n.matMul(D("a",e,t,r),D("b",e,t,r),D("transposeA",e,t,r),D("transposeB",e,t,r))];case"Einsum":return[n.einsum(D("equation",e,t,r),...D("tensors",e,t,r))];case"Transpose":return[n.transpose(D("x",e,t,r),D("perm",e,t,r))];case"_FusedMatMul":let[a,s]=D("fusedOps",e,t,r),i=a==="biasadd",o=s==="prelu",u=D("numArgs",e,t,r),d=D("leakyreluAlpha",e,t,r);if(i){if(o&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[c,h]=D("args",e,t,r);return[n.fused.matMul({a:D("a",e,t,r),b:D("b",e,t,r),transposeA:D("transposeA",e,t,r),transposeB:D("transposeB",e,t,r),bias:c,activation:s,preluActivationWeights:h,leakyreluAlpha:d})];case"MatrixBandPart":return[n.linalg.bandPart(D("a",e,t,r),D("numLower",e,t,r),D("numUpper",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},w3e=(e,t,r,n=ma)=>{switch(e.op){case"EuclideanNorm":return[n.euclideanNorm(D("x",e,t,r),D("axis",e,t,r),D("keepDims",e,t,r))];case"FusedBatchNorm":case"FusedBatchNormV2":return[n.batchNorm(D("x",e,t,r),D("mean",e,t,r),D("variance",e,t,r),D("offset",e,t,r),D("scale",e,t,r),D("epsilon",e,t,r))];case"FusedBatchNormV3":return[n.batchNorm(D("x",e,t,r),D("mean",e,t,r),D("variance",e,t,r),D("offset",e,t,r),D("scale",e,t,r),D("epsilon",e,t,r))];case"LRN":return[n.localResponseNormalization(D("x",e,t,r),D("radius",e,t,r),D("bias",e,t,r),D("alpha",e,t,r),D("beta",e,t,r))];case"Softmax":return[n.softmax(D("x",e,t,r))];case"LogSoftmax":return[n.logSoftmax(D("x",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},N3e=(e,t,r,n=ma)=>{switch(e.op){case"RaggedGather":{let{outputNestedSplits:a,outputDenseValues:s}=n.raggedGather(D("paramsNestedSplits",e,t,r),D("paramsDenseValues",e,t,r),D("indices",e,t,r),D("outputRaggedRank",e,t,r));return a.concat(s)}case"RaggedRange":{let{rtNestedSplits:a,rtDenseValues:s}=n.raggedRange(D("starts",e,t,r),D("limits",e,t,r),D("splits",e,t,r));return[a,s]}case"RaggedTensorToTensor":return[n.raggedTensorToTensor(D("shape",e,t,r),D("values",e,t,r),D("defaultValue",e,t,r),D("rowPartitionTensors",e,t,r),D("rowPartitionTypes",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},S3e=(e,t,r,n=ma)=>{switch(e.op){case"Max":{let o=D("axis",e,t,r),u=D("keepDims",e,t,r);return[n.max(D("x",e,t,r),o,u)]}case"Mean":{let o=D("axis",e,t,r),u=D("keepDims",e,t,r);return[n.mean(D("x",e,t,r),o,u)]}case"Min":{let o=D("axis",e,t,r),u=D("keepDims",e,t,r);return[n.min(D("x",e,t,r),o,u)]}case"Sum":{let o=D("axis",e,t,r),u=D("keepDims",e,t,r);return[n.sum(D("x",e,t,r),o,u)]}case"All":{let o=D("axis",e,t,r),u=D("keepDims",e,t,r);return[n.all(D("x",e,t,r),o,u)]}case"Any":{let o=D("axis",e,t,r),u=D("keepDims",e,t,r);return[n.any(D("x",e,t,r),o,u)]}case"ArgMax":{let o=D("axis",e,t,r);return[n.argMax(D("x",e,t,r),o)]}case"ArgMin":{let o=D("axis",e,t,r);return[n.argMin(D("x",e,t,r),o)]}case"Prod":{let o=D("axis",e,t,r),u=D("keepDims",e,t,r);return[n.prod(D("x",e,t,r),o,u)]}case"Cumprod":{let o=D("axis",e,t,r),u=D("exclusive",e,t,r),d=D("reverse",e,t,r);return[n.cumprod(D("x",e,t,r),o,u,d)]}case"Cumsum":{let o=D("axis",e,t,r),u=D("exclusive",e,t,r),d=D("reverse",e,t,r);return[n.cumsum(D("x",e,t,r),o,u,d)]}case"Bincount":let a=D("x",e,t,r),s=D("weights",e,t,r),i=D("size",e,t,r);return[n.bincount(a,s,i)];case"DenseBincount":{let o=D("x",e,t,r),u=D("weights",e,t,r),d=D("size",e,t,r),c=D("binaryOutput",e,t,r);return[n.denseBincount(o,u,d,c)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},_3e=(e,t,r,n=ma)=>{switch(e.op){case"ConcatV2":case"Concat":{let a=D("n",e,t,r),s=D("axis",e,t,r),i=D("tensors",e,t,r);return i=i.slice(0,a),[n.concat(i,s)]}case"Gather":{let a=D("x",e,t,r),s=D("indices",e,t,r);return[n.gather(a,n.cast(s,"int32"),0)]}case"GatherV2":{let a=D("axis",e,t,r),s=D("batchDims",e,t,r),i=D("x",e,t,r),o=D("indices",e,t,r);return[n.gather(i,n.cast(o,"int32"),a,s)]}case"Reverse":{let a=D("dims",e,t,r),s=[];for(let o=0;o<a.length;o++)a[o]&&s.push(o);let i=D("x",e,t,r);return[n.reverse(i,s)]}case"ReverseV2":{let a=D("axis",e,t,r),s=D("x",e,t,r);return[n.reverse(s,a)]}case"Slice":{let a=D("begin",e,t,r),s=D("size",e,t,r);return[n.slice(D("x",e,t,r),a,s)]}case"StridedSlice":{let a=D("begin",e,t,r),s=D("end",e,t,r),i=D("strides",e,t,r),o=D("beginMask",e,t,r),u=D("endMask",e,t,r),d=D("ellipsisMask",e,t,r),c=D("newAxisMask",e,t,r),h=D("shrinkAxisMask",e,t,r),p=D("x",e,t,r);return[n.stridedSlice(p,a,s,i,o,u,d,c,h)]}case"Pack":return ce(()=>{let a=D("axis",e,t,r),s=D("tensors",e,t,r),i=s[0].shape,o=n.squeeze(s[0]).shape,u=s.map(d=>{let c=R.arraysEqual(d.shape,i);if(!c&&!R.arraysEqual(n.squeeze(d).shape,o))throw new Error("the input tensors shape does not match");return c?d:n.reshape(d,i)});return[n.stack(u,a)]});case"Unpack":{let a=D("axis",e,t,r),s=D("tensor",e,t,r);return n.unstack(s,a)}case"Tile":{let a=D("reps",e,t,r);return[n.tile(D("x",e,t,r),a)]}case"Split":case"SplitV":{let a=D("axis",e,t,r),s=D("numOrSizeSplits",e,t,r),i=D("x",e,t,r);return n.split(i,s,a)}case"ScatterNd":{let a=D("indices",e,t,r),s=D("values",e,t,r),i=D("shape",e,t,r);return[n.scatterND(a,s,i)]}case"GatherNd":{let a=D("x",e,t,r),s=D("indices",e,t,r);return[n.gatherND(a,s)]}case"SparseToDense":{let a=D("sparseIndices",e,t,r),s=D("outputShape",e,t,r),i=D("sparseValues",e,t,r),o=D("defaultValue",e,t,r);return[n.sparseToDense(a,i,s,i.dtype===o.dtype?o:n.cast(o,i.dtype))]}case"TensorScatterUpdate":{let a=D("indices",e,t,r),s=D("values",e,t,r),i=D("tensor",e,t,r);return[n.tensorScatterUpdate(i,a,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},k3e=(e,t,r,n=ma)=>{switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:a,outputValues:s,emptyRowIndicator:i,reverseIndexMap:o}=n.sparse.sparseFillEmptyRows(D("indices",e,t,r),D("values",e,t,r),D("denseShape",e,t,r),D("defaultValue",e,t,r));return[a,s,i,o]}case"SparseReshape":{let{outputIndices:a,outputShape:s}=n.sparse.sparseReshape(D("inputIndices",e,t,r),D("inputShape",e,t,r),D("newShape",e,t,r));return[a,s]}case"SparseSegmentMean":return[n.sparse.sparseSegmentMean(D("data",e,t,r),D("indices",e,t,r),D("segmentIds",e,t,r))];case"SparseSegmentSum":return[n.sparse.sparseSegmentSum(D("data",e,t,r),D("indices",e,t,r),D("segmentIds",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},C3e=(e,t,r,n=ma)=>{switch(e.op){case"FFT":return[n.fft(D("x",e,t,r))];case"IFFT":return[n.ifft(D("x",e,t,r))];case"RFFT":return[n.rfft(D("x",e,t,r))];case"IRFFT":return[n.irfft(D("x",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},I3e=(e,t,r,n=ma)=>{switch(e.op){case"StaticRegexReplace":return[n.string.staticRegexReplace(D("input",e,t,r),D("pattern",e,t,r),D("rewrite",e,t,r),D("replaceGlobal",e,t,r))];case"StringNGrams":{let{nGrams:a,nGramsSplits:s}=n.string.stringNGrams(D("data",e,t,r),D("dataSplits",e,t,r),D("separator",e,t,r),D("nGramWidths",e,t,r),D("leftPad",e,t,r),D("rightPad",e,t,r),D("padWidth",e,t,r),D("preserveShortSequences",e,t,r));return[a,s]}case"StringSplit":{let{indices:a,values:s,shape:i}=n.string.stringSplit(D("input",e,t,r),D("delimiter",e,t,r),D("skipEmpty",e,t,r));return[a,s,i]}case"StringToHashBucketFast":return[n.string.stringToHashBucketFast(D("input",e,t,r),D("numBuckets",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},E3e=(e,t,r,n=ma)=>{switch(e.op){case"Cast":return[n.cast(D("x",e,t,r),D("dtype",e,t,r))];case"ExpandDims":{let a=D("axis",e,t,r);return[n.expandDims(D("x",e,t,r),a)]}case"Squeeze":{let a=D("axis",e,t,r);return[n.squeeze(D("x",e,t,r),a)]}case"Reshape":return[n.reshape(D("x",e,t,r),D("shape",e,t,r))];case"EnsureShape":return[n.ensureShape(D("x",e,t,r),D("shape",e,t,r))];case"MirrorPad":return[n.mirrorPad(D("x",e,t,r),D("padding",e,t,r),D("mode",e,t,r))];case"PadV2":case"Pad":return[n.pad(D("x",e,t,r),D("padding",e,t,r),D("constantValue",e,t,r))];case"SpaceToBatchND":{let a=D("blockShape",e,t,r),s=D("paddings",e,t,r);return[n.spaceToBatchND(D("x",e,t,r),a,s)]}case"BatchToSpaceND":{let a=D("blockShape",e,t,r),s=D("crops",e,t,r);return[n.batchToSpaceND(D("x",e,t,r),a,s)]}case"DepthToSpace":{let a=D("blockSize",e,t,r),s=D("dataFormat",e,t,r).toUpperCase();return[n.depthToSpace(D("x",e,t,r),a,s)]}case"BroadcastTo":return[n.broadcastTo(D("x",e,t,r),D("shape",e,t,r))];case"BroadcastArgs":return[n.broadcastArgs(D("s0",e,t,r),D("s1",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function Q4(e,t,r,n,a=ce){let s=((i,o,u)=>{switch(i.category){case"arithmetic":return a(()=>n3e(i,o,u));case"basic_math":return a(()=>a3e(i,o,u));case"control":return c3e(i,o,u);case"convolution":return a(()=>d3e(i,o,u));case"creation":return a(()=>h3e(i,o,u));case"dynamic":return p3e(i,o,u);case"evaluation":return a(()=>f3e(i,o,u));case"image":return a(()=>y3e(i,o,u));case"graph":return a(()=>m3e(i,o,u));case"logical":return a(()=>v3e(i,o,u));case"matrices":return a(()=>b3e(i,o,u));case"normalization":return a(()=>w3e(i,o,u));case"ragged":return a(()=>N3e(i,o,u));case"reduction":return a(()=>S3e(i,o,u));case"slice_join":return a(()=>_3e(i,o,u));case"sparse":return a(()=>k3e(i,o,u));case"spectral":return a(()=>C3e(i,o,u));case"string":return a(()=>I3e(i,o,u));case"transformation":return a(()=>E3e(i,o,u));case"hash_table":return x3e(i,o,u,n);case"custom":let d=NY(i.op);if(d&&d.customExecutor)return d.customExecutor(new r3e(i,o,u));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,r);return R.isPromise(s)?s.then(i=>[].concat(i)):[].concat(s)}var X4=class{constructor(e={},t={},r={},n={},a){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=r,this.functionMap=n,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function Y4(e,t,r,n){let a=new Set,s=[],i=null,o=null,u=new Set,d=new Set(Object.keys(e).map(p=>Fs(p)[0]));n=n||[];let c=new Set(n.map(p=>Fs(p.name)[0])),h=[...t];for(;h.length>0;){let p=h.pop();if((jd(p)||F3e(p)||O3e(p))&&i==null&&(i=p,o=i.children.map(f=>f.name).filter(f=>a.has(f))),a.add(p.name),r[p.name]==null&&!d.has(p.name)&&!c.has(p.name)){if(p.inputs.length===0){s.push(p.name);continue}p.inputs.forEach(f=>{u.has(f.name)||(u.add(f.name),h.push(f))})}}return{inputs:e,outputs:t,usedNodes:a,missingInputs:s,dynamicNode:i,syncInputs:o}}function T3e(e,t){let{usedNodes:r,inputs:n}=t,a=Object.keys(n).map(x=>Fs(x)[0]).map(x=>e.nodes[x]),s=e.initNodes||[],i=x=>r.has(typeof x=="string"?x:x.name);function o(x){return[...new Map(x.map(y=>[y.name,y])).values()]}let u=o([...a,...e.weights,...s]).filter(i),d=o([...u,...Object.values(e.nodes)]).filter(i),c=new Map(d.map(x=>[x.name,x])),h={};for(let x of d){h[x.name]=h[x.name]||0;for(let y of x.children)i(y)||(h[y.name]=Number.POSITIVE_INFINITY),h[y.name]=(h[y.name]||0)+1}let p=Object.entries(h).filter(([,x])=>x===0).map(([x])=>x),f=[...p];for(;p.length>0;){let x=p.pop(),y=c.get(x);for(let v of y.children.filter(i))--h[v.name]===0&&(f.push(v.name),p.push(v.name))}let g=f.map(x=>c.get(x)),m=j3e(g,u);return A3e(m,u),m}function j3e(e,t){let r=new Map(e.map(s=>[s.name,s])),n=t.map(s=>s.name),a=new Set(n);for(;n.length>0;){let s=n.pop(),i=r.get(s);for(let o of i.children)!r.has(o.name)||a.has(o.name)||(a.add(o.name),n.push(o.name))}return e.filter(s=>a.has(s.name))}var h1=class extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}};function A3e(e,t){let r=new Map(e.map((o,u)=>[o.name,u])),n=new Set(t.map(o=>o.name)),a=o=>n.has(typeof o=="string"?o:o.name),s=new Set(e.map(o=>o.name)),i=o=>s.has(typeof o=="string"?o:o.name);for(let o of e){for(let u of o.children.filter(i)){if(!r.has(u.name))throw new h1(`Child ${u.name} of node ${o.name} is unreachable.`);if(r.get(o.name)>r.get(u.name))throw new h1(`Node ${o.name} is scheduled to run after its child ${u.name}.`)}if(!a(o))for(let u of o.inputs){if(!r.has(u.name))throw new h1(`Input ${u.name} of node ${o.name} is unreachable.`);if(r.get(u.name)>r.get(o.name))throw new h1(`Node ${o.name} is scheduled to run before its input ${u.name}.`)}}}function $3e(e){let t=new Map(e.map((o,u)=>[o.name,u])),r=Number.MAX_SAFE_INTEGER,n=e.map((o,u)=>jd(o)?r:u),a=o=>{let u=n[t.get(o.name)];return u??-1},s=e.map((o,u)=>o.children.map(a).reduce((d,c)=>Math.max(d,c),n[u])),i=new Map;for(let o=0;o<e.length;++o){let u=s[o];if(u===r)continue;let d=e[o],c=e[u];i.has(c.name)||i.set(c.name,[]),i.get(c.name).push(d)}return i}var R3e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),D3e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),M3e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function jd(e){return R3e.has(e.op)}function F3e(e){return D3e.has(e.op)}function O3e(e){return M3e.has(e.op)}var J4=class VY{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){let r=Object.keys(t).map(n=>t[n].map(a=>a.id));this._weightIds=[].concat(...r),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{let r=t.signatureKey||t.name;return t.defaultOutput?`${r}:${t.defaultOutput}`:r})}get functions(){return Object.keys(this._functions).reduce((t,r)=>(t[r]=this._functions[r].signature,t),{})}constructor(t,r){this.graph=t,this.parent=r,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(n=>{this._functionExecutorMap[n]=new VY(t.functions[n],this)})}getCompilationKey(t,r){let n=t.map(s=>s.name).sort(),a=r.map(s=>s.name).sort();return n.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(t,r){let n=Y4(t,r,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:s,syncInputs:i}=n;if(s!=null)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(a.length>0){let d=r.map(h=>h.name),c=Object.keys(t);throw new Error(`Cannot compute the outputs [${d}] from the provided inputs [${c}]. Missing the following inputs: [${a}]`)}let o=T3e(this.graph,n),u=$3e(o);return{orderedNodes:o,nodeLiveUntilMap:u}}cloneAndKeepTensor(t){if(t==null)return null;let r=t.clone();return Qn(r),r}cloneTensorList(t){return t?t.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([r,n])=>[r,this.cloneTensorList(n)]))}execute(t,r){this.disposeIntermediateTensors(),t=this.mapInputs(t);let n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),r=this.mapOutputs(r),this.checkOutputs(r);let a=n.map(p=>this.graph.nodes[Fs(p)[0]]),s=r.map(p=>Fs(p)[0]),i=new Set(s),o=s.map(p=>this.graph.nodes[p]);o.length===0&&(o=this._outputs);let u=this.getCompilationKey(a,o),d=this.compiledMap.get(u);d==null&&(d=this.compile(t,o),this.compiledMap.set(u,d));try{this.keepIntermediateTensors=ge().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}let c={},h={};return ce(()=>{let p=new X4(this.weightMap,c,h,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(y=>{let[v,b]=Fs(y,p),N=[];N[b]=t[y],f[v]=N,this.keepIntermediateTensors&&(this.clonedTensorsMap[v]=this.cloneTensorList(N))});let g=this.getFrozenTensorIds(f),{orderedNodes:m,nodeLiveUntilMap:x}=d;for(let y of m){if(f[y.name])continue;let v=Q4(y,f,p,this._resourceManager);if(R.isPromise(v))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);f[y.name]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[y.name]=this.cloneTensorList(v)),this.checkTensorForDisposalWithNodeLiveUntilInfo(y,f,p,g,i,x.get(y.name))}return this.parent==null&&p.dispose(g),r.map(y=>va(y,f,p))})}getFrozenTensorIds(t){let r=[].concat.apply([],Object.keys(t).map(n=>t[n]).map(n=>n.map(a=>a.id)));return new Set(r)}checkTensorForDisposal(t,r,n,a,s,i,o){if(!(jd(r)||i.has(t))){for(let u of n[t])u!=null&&(o[u.id]=(o[u.id]||0)+r.children.length);for(let u of r.inputs){if(jd(u))continue;let d=V4(u.name,n,a);if(d!=null)for(let c of d){if(!c||c.kept||s.has(c.id))continue;let h=o[c.id];h===1?(c.dispose(),delete o[c.id]):h!=null&&o[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,r,n,a,s,i){function o(u){return jd(u)||s.has(u.name)}if(!(jd(t)||i==null))for(let u of i){if(o(u))continue;let d=V4(u.name,r,n);for(let c of d)!c||c.kept||a.has(c.id)||c.dispose()}}async executeAsync(t,r){return this._executeAsync(t,r)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(let r of t)r&&!r.isDisposed&&r.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,r,n=!1,a={},s={}){this.disposeIntermediateTensors(),n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),r=this.mapOutputs(r),this.checkOutputs(r));try{this.keepIntermediateTensors=ge().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}let i=new X4(this.weightMap,a,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let o=await this.executeWithControlFlow(t,i,r,n),u=r.map(p=>va(p,o,i)),d=u.map(p=>p.id),c=Object.keys(t).map(p=>t[p].id),h=new Set([...d,...c,...this.weightIds]);return Object.values(o).forEach(p=>{p.forEach(f=>{f&&!f.isDisposed&&!h.has(f.id)&&f.dispose()})}),this.parent==null&&i.dispose(h),u}async executeFunctionAsync(t,r,n){let a=t.reduce((s,i,o)=>(s[this.inputs[o].name]=i,s),{});return this._executeAsync(a,this.outputNodes,!0,r,n)}async executeWithControlFlow(t,r,n,a){let s=Object.keys(t),i=s.map(N=>this.graph.nodes[Fs(N)[0]]),o=n.map(N=>Fs(N)[0]),u=new Set(o),d=o.map(N=>this.graph.nodes[N]);d.length===0&&(d=this._outputs);let{usedNodes:c,missingInputs:h,dynamicNode:p,syncInputs:f}=Y4(t,d,this.weightMap,this._initNodes),g=[...i,...this.graph.weights,...this._initNodes||[]].map(N=>({node:N,contexts:r.currentContext})),m=Object.assign({},this.weightMap);Object.keys(t).forEach(N=>{let[S,_]=Fs(N),C=[];C[_]=t[N],m[S]=C});let x={},y=this.getFrozenTensorIds(m),v={};for(;g.length>0;){let N=this.processStack(i,g,r,m,v,y,u,x,c);await Promise.all(N)}p==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let b=d.filter(N=>!jd(N)&&!va(N.name,m,r)).map(N=>N.name);if(b.length>0){let N="";throw p!=null&&(N=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${s}]. Consider providing the following inputs: [${h}]. ${N}`)}return m}processStack(t,r,n,a,s,i,o,u,d){let c=[];for(;r.length>0;){let h=r.pop();n.currentContext=h.contexts;let p="";if(h.node.op==="Enter"&&D("isConstant",h.node,a,n)&&([p]=Fl(h.node.name,n)),a[h.node.name]==null){let f=Q4(h.node,a,n,this._resourceManager);p||([p]=Fl(h.node.name,n));let g=n.currentContext;R.isPromise(f)?c.push(f.then(m=>(a[p]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(m)),n.currentContext=g,this.checkTensorForDisposal(p,h.node,a,n,i,o,u),this.processChildNodes(h.node,r,n,a,s,d),m))):(a[p]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(f)),this.checkTensorForDisposal(p,h.node,a,n,i,o,u),this.processChildNodes(h.node,r,n,a,s,d))}else this.processChildNodes(h.node,r,n,a,s,d)}return c}processChildNodes(t,r,n,a,s,i){t.children.forEach(o=>{let[u]=Fl(o.name,n);s[u]||!i.has(o.name)||(o.op==="Merge"?o.inputNames.some(d=>!!va(d,a,n))&&(s[u]=!0,r.push({contexts:n.currentContext,node:o})):o.inputNames.every(d=>!!va(d,a,n))&&(s[u]=!0,r.push({contexts:n.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(r=>r.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(r=>{let n=t[r],[a]=Fs(r),s=this.graph.nodes[a];if(s.attrParams.shape&&s.attrParams.shape.value){let i=s.attrParams.shape.value,o=i.length===n.shape.length&&n.shape.every((u,d)=>i[d]===-1||i[d]===u);R.assert(o,()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${i}], but was [${n.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&R.assert(n.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${n.dtype}`)})}mapInputs(t){var r,n;let a={};for(let s in t){let i=(n=(r=this._signature)===null||r===void 0?void 0:r.inputs)===null||n===void 0?void 0:n[s];i!=null?a[i.name]=t[s]:a[s]=t[s]}return a}checkInputs(t){let r=Object.keys(t).filter(n=>{let[a]=Fs(n);return this.graph.nodes[a]==null});if(r.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${r}] that are not part of graph`)}mapOutputs(t){return t.map(r=>{var n,a;let s=(a=(n=this._signature)===null||n===void 0?void 0:n.outputs)===null||a===void 0?void 0:a[r];return s!=null?s.name:r},{})}checkOutputs(t){t.forEach(r=>{let[n]=Fs(r);if(!this.graph.nodes[n])throw new Error(`The output '${r}' is not found in the graph`)})}},P3e=class{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}},L3e="?tfjs-format=file",z3e="model.json",TF=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},r=Na){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=r,t==null&&(this.loadOptions={}),this.resourceManager=new P3e}findIOHandler(){let e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return R.isPromise(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){let t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");let t=await G7(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;let r=this.artifacts.modelTopology,n=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){let a=this.artifacts.userDefinedMetadata;a.signature!=null&&(n=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=n,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new J4(H4.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){let a=H4.Instance.transformGraph(e.modelInitializer);this.initializer=new J4(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){let r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t=e instanceof Jt?[e]:e,r={};return t.forEach((n,a)=>r[this.structuredOutputKeys[a]]=n),r}return e}predict(e,t){let r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,t){let r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var t;if(!(e instanceof Jt)&&!Array.isArray(e)){let a=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(a!=null)for(let s in a){let i=a[s];i.resourceId!=null&&(e[s]=this.resourceIdToCapturedInput[i.resourceId])}return e}e=Array.isArray(e)?e:[e];let r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let n=0;return this.inputNodes.reduce((a,s)=>{var i,o,u;let d=(u=(o=(i=this.signature)===null||i===void 0?void 0:i.inputs)===null||o===void 0?void 0:o[s])===null||u===void 0?void 0:u.resourceId;return d!=null?a[s]=this.resourceIdToCapturedInput[d]:a[s]=e[n++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,r=Object.keys(t);for(let n=0;n<r.length;n++){let a=r[n],s=t[a];this.resourceIdToCapturedInput[s.resourceId]=e[n]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let r=this.executor.execute(e,t);return r.length>1?r:r[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let r=await this.executor.executeAsync(e,t);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,r)=>(t[r]=[e[r]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&zt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function B3e(e,t={},r=Na){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=W3e(e));let n=new TF(e,t,r);return await n.load(),n}function U3e(e){if(e==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[n,a]=e;if(!n)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in n))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in n))throw new Error("Model JSON is missing 'weightsManifest'");let s=Na.getWeightSpecs(n.weightsManifest),i=Na.getModelArtifactsForJSONSync(n,s,a);t=Na.fromMemorySync(i)}else if("load"in e)t=e;else if("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e)t=Na.fromMemorySync(e);else throw new Error("Unknown model format");let r=new TF(t);return r.load(),r}function W3e(e){return e.endsWith("/")||(e=e+"/"),`${e}${z3e}${L3e}`}var V3e="4.22.0",HY={};Ut(HY,{CSVDataset:()=>rJ,Dataset:()=>ly,FileDataSource:()=>uJ,TextLineDataset:()=>tJ,URLDataSource:()=>cJ,array:()=>p4e,csv:()=>C4e,func:()=>I4e,generator:()=>E4e,microphone:()=>j4e,version_data:()=>A4e,webcam:()=>T4e,zip:()=>f4e});var H3e=Xc(lk()),q3e=Xc(lk());function G3e(e,t){return wS(e,t)}function wS(e,t,r=new Map,n=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(n.has(e))throw new Error("Circular references are not supported.");if(r.has(e))return r.get(e);let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse)if(vg(e)){let s=Array.isArray(e)?[]:{};n.add(e);for(let i in e){let o=e[i],u=wS(o,t,r,n);s[i]=u}return n.delete(e),e.__proto__&&(s.__proto__=e.__proto__),s}else throw new Error(`Can't recurse into non-iterable type: ${e}`);else return r.set(e,a.value),a.value}function K3e(e,t=GY){return qY(e,t)}function qY(e,t,r=new Set){let n=e[0];if(r.has(n))throw new Error("Circular references are not supported.");let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse)if(vg(n)){let s=Array.isArray(n)?[]:{};r.add(n);for(let i in n){let o=e.map(d=>d[i]),u=qY(o,t,r);s[i]=u}return r.delete(n),s}else throw new Error(`Can't recurse into non-iterable type: ${n}`);else return a.value}function GY(e){return e===null?null:vg(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function KY(e,t){let r=new Map;wS(e,t,r);for(let n of Array.from(r.keys())){let a=r.get(n);if(R.isPromise(a)){let s=await a;r.set(n,s)}}return wS(e,t,r)}function vg(e){let t=!1;if(ge().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:r}=p7();t=e instanceof r}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Jt)&&!(e instanceof Promise)&&!t)}function Q3e(e){return e==null||X3e(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Jt||R.isTypedArray(e)}function X3e(e){return e===null||typeof e!="object"&&typeof e!="function"}function Y3e(e){return G3e(e,J3e)}function J3e(e){return e instanceof Jt?{value:e.clone(),recurse:!1}:vg(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var QY=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),r=this.get(t);return this.set(t,this.pop()),r}},XY=class YY extends QY{constructor(){super(YY.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){let t=this.capacity*2,r=new Array(t),n=this.length();for(let a=0;a<n;a++)r[a]=this.get(this.wrap(this.begin+a));this.data=r,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}};XY.INITIAL_CAPACITY=32;function JY(e){return new t4e(e)}function jF(e){return new r4e(e)}function Z3e(e,t){return new ZY(e,t)}function e4e(e,t=ac.FAIL){return new d4e(e,t)}var pa=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],r=await e.next();for(;!r.done;)t.push(r.value),r=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),r=e(t.value);for(;!t.done&&r;)t=await this.next(),r=e(t.value)}handleErrors(e){return new u4e(this,e)}filter(e){return new o4e(this,e)}map(e){return new l4e(this,e)}mapAsync(e){return new Z4(this,e)}serialMapAsync(e){return new Z4(this,e).serial()}flatmap(e){return new c4e(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(t=>t===!0)}rowMajorBatch(e,t=!0){return new i4e(this,e,t)}columnMajorBatch(e,t=!0,r=GY){return this.rowMajorBatch(e,t).map(n=>K3e(n,r))}concatenate(e,t){return new ZY(JY([this,e]),t)}take(e){return e<0||e==null?this:new s4e(this,e)}skip(e){return e<0||e==null?this:new a4e(this,e)}prefetch(e){return new eJ(this,e)}shuffle(e,t){return new h4e(this,e,t)}serial(){return new n4e(this)}},t4e=class extends pa{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:Y3e(e),done:!1}}},r4e=class extends pa{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}},n4e=class extends pa{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},a4e=class extends pa{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;zt(e.value)}return this.upstream.next()}},s4e=class extends pa{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},i4e=class extends pa{constructor(e,t,r=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=r,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},o4e=class extends pa{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;zt(e.value)}}},l4e=class extends pa{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=vo.getTensorsInContainer(e.value),r=this.transform(e.value),n=vo.getTensorsInContainer(r);for(let a of t)vo.isTensorInList(a,n)||a.dispose();return{value:r,done:!1}}},u4e=class extends pa{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}},Z4=class extends pa{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=vo.getTensorsInContainer(e.value),r=await this.transform(e.value),n=vo.getTensorsInContainer(r);for(let a of t)vo.isTensorInList(a,n)||a.dispose();return{value:r,done:!1}}},AF=class extends pa{constructor(){super(),this.outputQueue=new XY,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},c4e=class extends AF{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=vo.getTensorsInContainer(e.value),r=this.transform(e.value),n=vo.getTensorsInContainer(r);this.outputQueue.pushAll(r);for(let a of t)vo.isTensorInList(a,n)||a.dispose();return!0}},ZY=class extends pa{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){let r=await this.moreIterators.next();if(r.done)return{value:null,done:!0};this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}},ac;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(ac||(ac={}));var d4e=class extends pa{constructor(e,t=ac.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,r=0;function n(s){return s instanceof pa?{value:s.next().then(i=>(t++,i.done&&r++,i.value)),recurse:!1}:{value:null,recurse:!0}}let a=await KY(this.iterators,n);if(t===r)return{value:null,done:!0};if(r>0)switch(this.mismatchMode){case ac.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case ac.SHORTEST:return{value:null,done:!0};case ac.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},eJ=class extends pa{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new QY(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},h4e=class extends eJ{constructor(e,t,r){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=q3e.alea(r||R.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(t.done)this.upstreamExhausted=!0;else return this.refill(),t}return{value:null,done:!0}}},ly=class{constructor(){this.size=null}batch(e,t=!0){let r=this;R.assert(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let n;return this.size===1/0||this.size==null?n=this.size:t?n=Math.ceil(this.size/e):n=Math.floor(this.size/e),Ds(async()=>(await r.iterator()).columnMajorBatch(e,t,m4e),n)}concatenate(e){let t=this,r;return this.size===1/0||e.size===1/0?r=1/0:this.size!=null&&e.size!=null?r=this.size+e.size:r=null,Ds(async()=>(await t.iterator()).concatenate(await e.iterator()),r)}filter(e){let t=this,r;return this.size===1/0?r=1/0:r=null,Ds(async()=>(await t.iterator()).filter(n=>ce(()=>e(n))),r)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return Ds(async()=>(await t.iterator()).map(r=>ce(()=>e(r))),this.size)}mapAsync(e){let t=this;return Ds(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return Ds(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this,r;return this.size!=null&&e>0?r=this.size*e:e===0?r=0:this.size!=null&&(e===void 0||e<0)?r=1/0:r=null,Ds(async()=>{let n=jF(async()=>({value:await t.iterator(),done:!1}));return Z3e(n.take(e))},r)}skip(e){let t=this,r;return this.size!=null&&e>=0&&this.size>=e?r=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?r=0:r=null,Ds(async()=>(await t.iterator()).skip(e),r)}shuffle(e,t,r=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let n=this,a=H3e.alea(t||R.now().toString());return Ds(async()=>{let s=a.int32();return r&&(s+=a.int32()),(await n.iterator()).shuffle(e,s.toString())},this.size)}take(e){let t=this,r;return this.size!=null&&this.size>e?r=e:this.size!=null&&this.size<=e?r=this.size:r=null,Ds(async()=>(await t.iterator()).take(e),r)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};ly.MAX_BUFFER_SIZE=1e4;function Ds(e,t=null){return new class extends ly{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function p4e(e){return Ds(async()=>JY(e),e.length)}function f4e(e){if(!vg(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let r=0;r<e.length;r++)t=t==null?e[r].size:Math.min(t,e[r].size);else if(e instanceof Object)for(let r in e)t=t==null?e[r].size:Math.min(t,e[r].size);return Ds(async()=>{let r=await KY(e,n=>{if(n instanceof ly)return{value:n.iterator(),recurse:!1};if(vg(n))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return e4e(r,ac.SHORTEST)},t)}function m4e(e){if(e===null)return null;let t=e[0];return Q3e(t)?{value:g4e(e),recurse:!1}:{value:null,recurse:!0}}function g4e(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Jt?Bn(e):Qa(e)}var tJ=class extends ly{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}},p1='"',Uy=Symbol("out"),ez=Symbol("field"),f1=Symbol("quote"),dI=Symbol("quoteafterquote"),tz=Symbol("quoteinquote"),rJ=class extends ly{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&R.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((n,a)=>(n[a]=n[a]+1||1,n),{}),r=Object.keys(t).filter(n=>t[n]>1);if(R.assert(r.length===0,()=>"Duplicate column names found: "+r.toString()),this.columnConfigs){for(let n of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(n)===-1)throw new Error('The key "'+n+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}else return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new tJ(e),t||(t={}),this.hasHeader=t.hasHeader!==!1,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(R.assert(t.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(t=>this.makeDataElement(t))}makeDataElement(e){let t=this.parseRow(e),r={},n={};for(let a=0;a<this.fullColumnNames.length;a++){let s=this.fullColumnNames[a],i=this.columnConfigs?this.columnConfigs[s]:null;if(!(this.configuredColumnsOnly&&!i)){let o=t[a],u=null;if(o==="")if(i&&i.default!==void 0)u=i.default;else{if(i&&(i.required||i.isLabel))throw new Error(`Required column ${s} is empty in this line: ${e}`);u=void 0}else{let d=Number(o);if(isNaN(d))i&&i.dtype==="bool"?u=this.getBoolean(o):u=o;else if(!i||!i.dtype)u=d;else switch(i.dtype){case"float32":u=d;break;case"int32":u=Math.floor(d);break;case"bool":u=this.getBoolean(o);break;default:u=d}}i&&i.isLabel?n[s]=u:r[s]=u}}return Object.keys(n).length===0?r:{xs:r,ys:n}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,t=!0){let r=[],n=0,a=e.length,s=Uy;for(let i=0;i<a;i++)switch(s){case Uy:switch(e.charAt(i)){case p1:n=i+1,s=f1;break;case this.delimiter:if(n=i+1,this.delimiter===" "&&this.delimWhitespace)break;r.push(""),s=Uy;break;default:s=ez,n=i;break}break;case ez:switch(e.charAt(i)){case this.delimiter:r.push(e.substring(n,i)),s=Uy,n=i+1;break}break;case f1:switch(e.charAt(i)){case p1:s=dI;break}break;case dI:switch(e.charAt(i)){case this.delimiter:r.push(e.substring(n,i-1)),s=Uy,n=i+1;break;case p1:s=f1;break;default:s=tz;break}break;case tz:switch(e.charAt(i)){case p1:s=f1;break}break}if(s===dI?r.push(e.substring(n,a-1)):r.push(e.substring(n)),t&&r.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${r}`);return r}},x4e=class nJ extends pa{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;let r=Math.log2(this.fftSize);if(this.fftSize<0||r<4||r>14||!Number.isInteger(r))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(!ge().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let r=new nJ(t);return await r.start(),r}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(n){throw new Error(`Error thrown while initializing video stream: ${n.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);let r=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,r.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,r,n=await this.getAudioData();if(this.includeSpectrogram){let a=this.flattenQueue(n.freqDataQueue);t=this.getTensorFromAudioDataArray(a,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let a=this.flattenQueue(n.timeDataQueue);r=this.getTensorFromAudioDataArray(a,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:r},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let t=[],r=[],n=0;return new Promise(a=>{let s=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&a({freqDataQueue:t,timeDataQueue:r}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),r.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(s),a({freqDataQueue:t,timeDataQueue:r}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){let r=t[0].length,n=new Float32Array(t.length*r);return t.forEach((a,s)=>n.set(a,s*r)),n}getTensorFromAudioDataArray(t,r){let n=new Float32Array(R.sizeFromShape(r));return n.set(t,n.length-t.length),Qa(n,r)}},y4e=class aJ extends pa{constructor(t,r){if(super(),this.webcamVideoElement=t,this.webcamConfig=r,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Cr([0],"int32"),this.webcamConfig.centerCrop){let n=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,a=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,s=(1-n)/2,i=(1-a)/2,o=s+n,u=a+i;this.cropBox=ol([i,s,u,o],[1,4])}else this.cropBox=ol([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,r={}){if(!ge().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=r.resizeWidth,t.height=r.resizeHeight}let n=new aJ(t,r);return await n.start(),n}async start(){this.webcamConfig.facingMode&&R.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=Y0.fromPixels(this.webcamVideoElement)}catch(r){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(r)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(r){throw new Error(`Error thrown cropping the video: ${r.message}`)}finally{t.dispose()}else return{value:t,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return ce(()=>{let r=la(Pe(t,"float32"),0),n;n=li.cropAndResize(r,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let a=n.shape;return ue(n,a.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},sJ=class{},iJ=class extends pa{split(e){return new v4e(this,e)}},v4e=class extends iJ{constructor(e,t){super(),this.upstream=e,this.impl=new b4e(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},b4e=class extends AF{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){let e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let r of t.slice(0,-1))this.outputQueue.push(r);return this.carryover=t[t.length-1],!0}},w4e=class extends pa{decodeUTF8(){return new N4e(this)}},N4e=class extends iJ{constructor(e){super(),this.upstream=e,this.impl=new S4e(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},S4e=class extends AF{constructor(e){if(super(),this.upstream=e,ge().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:t}=p7();this.decoder=new t("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){let e=await this.upstream.next(),t;if(e.done)return!1;t=e.value;let r;return ge().get("IS_BROWSER")?r=this.decoder.decode(t,{stream:!0}):r=this.decoder.write(Buffer.from(t.buffer)),this.outputQueue.push(r),!0}},oJ=class extends w4e{constructor(e,t={}){super(),this.file=e,this.options=t,R.assert(e instanceof Uint8Array||(ge().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((e,t)=>{let r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,r)));else{let n=new FileReader;n.onload=s=>{let i=n.result;if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),!(i instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(i)},n.onabort=s=>t(new Error("Aborted")),n.onerror=s=>t(new Error(s.type));let a=this.file.slice(this.offset,r);n.readAsArrayBuffer(a)}this.offset=r}),done:!1}}};async function _4e(e,t={},r){let n,a;typeof e=="string"?n=e:(n=e.url,a=k4e(e));let s=await(0,R.fetch)(n,a);if(s.ok){let i=new Uint8Array(await s.arrayBuffer());return new oJ(i,t)}else throw new Error(s.statusText)}var k4e=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function lJ(e){return typeof e=="string"&&e.slice(0,7)==="file://"}var uJ=class extends sJ{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(lJ(this.input)&&ge().get("IS_NODE")){let e=NR();this.input=e.readFileSync(this.input.slice(7))}return new oJ(this.input,this.options)}},cJ=class extends sJ{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return lJ(this.url)?new uJ(this.url,this.fileOptions).iterator():_4e(this.url,this.fileOptions)}};function C4e(e,t={}){return new rJ(new cJ(e),t)}function I4e(e){let t=jF(e);return Ds(async()=>t)}function E4e(e){return Ds(async()=>{let t=await e();return jF(()=>t.next())})}async function T4e(e,t){return y4e.create(e,t)}async function j4e(e){return x4e.create(e)}var A4e="4.22.0";function mt(e,t){Array.isArray(e)||(e=[e]),e.forEach(r=>{r!=null&&R.assert(r.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var $4e=Nl.whereImpl,$F=class dJ extends u0{nextDataId(){return dJ.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new uk(this,Ai())}write(t,r,n){this.firstUse&&(this.firstUse=!1,ge().get("IS_NODE")&&H.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let a={id:this.nextDataId()};return this.data.set(a,{values:t,dtype:n,refCount:1}),a}makeTensorInfo(t,r,n){let a;if(r==="string"&&n!=null&&n.length>0&&R.isString(n[0])){let s=n.map(i=>R.encodeString(i));a=this.write(s,t,r)}else a=this.write(n,t,r);return{dataId:a,shape:t,dtype:r}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){let r=this.data.get(t);r.refCount++}decRef(t){if(this.data.has(t)){let r=this.data.get(t);r.refCount--}}move(t,r,n,a,s){this.data.set(t,{values:r,dtype:a,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){let{dtype:r,complexTensorInfos:n}=this.data.get(t);if(r==="complex64"){let a=this.readSync(n.real.dataId),s=this.readSync(n.imag.dataId);return H.mergeRealAndImagArrays(a,s)}return R.convertBackendValuesAndArrayBuffer(this.data.get(t).values,r)}bufferSync(t){let r=this.readSync(t.dataId);if(t.dtype==="string")try{let n=r.map(a=>R.decodeString(a));return Qt(t.shape,t.dtype,n)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Qt(t.shape,t.dtype,r)}makeOutput(t,r,n){return Ai().makeTensorFromTensorInfo(this.makeTensorInfo(r,n,t),this)}disposeData(t,r=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!r&&this.data.get(t).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(t);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){let r=R.now();return t(),{kernelMs:R.now()-r}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){mt([t],"where");let r=this.readSync(t.dataId);return $4e(t.shape,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};$F.nextDataId=0;var RF={};Ut(RF,{addImpl:()=>fJ,bincountImpl:()=>MF,bincountReduceImpl:()=>mJ,bitwiseAndImpl:()=>gJ,castImpl:()=>pJ,ceilImpl:()=>xJ,concatImpl:()=>FF,equalImpl:()=>yJ,expImpl:()=>bJ,expm1Impl:()=>NJ,floorDivImpl:()=>_J,floorImpl:()=>SJ,gatherNdImpl:()=>kJ,gatherV2Impl:()=>CJ,greaterEqualImpl:()=>EJ,greaterImpl:()=>IJ,lessEqualImpl:()=>jJ,lessImpl:()=>TJ,linSpaceImpl:()=>AJ,logImpl:()=>$J,maxImpl:()=>RJ,maximumImpl:()=>DJ,minimumImpl:()=>MJ,multiplyImpl:()=>OF,negImpl:()=>FJ,notEqualImpl:()=>OJ,prodImpl:()=>PJ,raggedGatherImpl:()=>LJ,raggedRangeImpl:()=>zJ,raggedTensorToTensorImpl:()=>BJ,rangeImpl:()=>LF,rsqrtImpl:()=>UJ,scatterImpl:()=>Pd,sigmoidImpl:()=>Aze,simpleAbsImpl:()=>hJ,sliceImpl:()=>SS,sparseFillEmptyRowsImpl:()=>VJ,sparseReshapeImpl:()=>HJ,sparseSegmentReductionImpl:()=>zF,sqrtImpl:()=>Dze,squaredDifferenceImpl:()=>qJ,staticRegexReplaceImpl:()=>GJ,stridedSliceImpl:()=>KJ,stringNGramsImpl:()=>BF,stringSplitImpl:()=>UF,stringToHashBucketFastImpl:()=>WF,subImpl:()=>QJ,tileImpl:()=>XJ,topKImpl:()=>JJ,transposeImpl:()=>PF,uniqueImpl:()=>HF});function hJ(e){let t=new Float32Array(e.length);for(let r=0;r<e.length;++r)t[r]=Math.abs(e[r]);return t}var R4e=e=>{let{x:t}=e.inputs,r=e.backend;mt(t,"abs");let n=new Float32Array(R.sizeFromShape(t.shape)),a=r.data.get(t.dataId).values;return n=hJ(a),r.makeOutput(n,t.shape,t.dtype)},D4e={kernelName:Xg,backendName:"cpu",kernelFunc:R4e};function Mn(e){return(t,r,n,a,s)=>{let i=H.assertAndGetBroadcastShape(t,r),o=i.length,u=R.computeStrides(i),d=R.sizeFromShape(i),c=R.getTypedArrayFromDType(s,d),h=t.length,p=r.length,f=R.computeStrides(t),g=R.computeStrides(r),m=H.getBroadcastDims(t,i),x=H.getBroadcastDims(r,i);if(m.length+x.length===0)for(let y=0;y<c.length;++y)c[y]=e(n[y%n.length],a[y%a.length]);else for(let y=0;y<c.length;++y){let v=R.indexToLoc(y,o,u),b=v.slice(-h);m.forEach(C=>b[C]=0);let N=R.locToIndex(b,h,f),S=v.slice(-p);x.forEach(C=>S[C]=0);let _=R.locToIndex(S,p,g);c[y]=e(n[N],a[_])}return[c,i]}}function Ls(e){let{inputs:t,backend:r}=e,{real:n,imag:a}=t,s=r.data.get(n.dataId).values,i=r.data.get(a.dataId).values,o=r.makeTensorInfo(n.shape,"complex64"),u=r.data.get(o.dataId);return u.complexTensorInfos={real:r.makeTensorInfo(n.shape,"float32",s),imag:r.makeTensorInfo(a.shape,"float32",i)},o}var M4e={kernelName:hk,backendName:"cpu",kernelFunc:Ls};function NS(e,t,r="float32"){if(r==="complex64"){let a=NS(e,t,"float32"),s=NS(e,t,"float32");return Ls({inputs:{real:a,imag:s},backend:e})}let n=R.makeZerosTypedArray(R.sizeFromShape(t),r);return e.makeTensorInfo(t,r,n)}function ml(e){let{inputs:t,backend:r}=e,{x:n}=t;return r.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}var F4e={kernelName:kp,backendName:"cpu",kernelFunc:ml};function Dh(e){let{inputs:t,backend:r}=e,{input:n}=t,a=r.data.get(n.dataId).complexTensorInfos.real,s=r.data.get(a.dataId).values;return r.makeTensorInfo(a.shape,a.dtype,s)}var O4e={kernelName:_k,backendName:"cpu",kernelFunc:Dh};function pJ(e,t,r,n){if(n==="int32"){let a=Int32Array.from(e);return[t,"int32",a]}if(n==="bool"){let a=R.toTypedArray([0],r),[s,i]=Mn((o,u)=>o!==u?1:0)(t,[],e,a,"bool");return[i,"bool",s]}throw new Error(`Error in Cast: failed to cast ${r} to ${n}`)}function Pc(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{dtype:s}=n;if(s==="complex64"){if(a.dtype==="complex64")return ml({inputs:{x:a},backend:r});let c=NS(r,a.shape,a.dtype),h=Pc({inputs:{x:a},backend:r,attrs:{dtype:"float32"}}),p=Ls({inputs:{real:h,imag:c},backend:r});return r.disposeIntermediateTensorInfo(c),r.disposeIntermediateTensorInfo(h),p}if(a.dtype==="complex64"){let c=Dh({inputs:{input:a},backend:r}),h=Pc({inputs:{x:c},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(c),h}if(!R.hasEncodingLoss(a.dtype,s)){let c=ml({inputs:{x:a},backend:r});return{dataId:c.dataId,shape:c.shape,dtype:s}}let i=r.data.get(a.dataId).values,[o,u,d]=pJ(i,a.shape,a.dtype,s);return r.makeTensorInfo(o,u,d)}var P4e={kernelName:ip,backendName:"cpu",kernelFunc:Pc};function ea(e,t,r,n){return r==null?({inputs:a,backend:s})=>{let{a:i,b:o}=a,u=s;mt([i,o],e);let d=u.data.get(i.dataId).values,c=u.data.get(o.dataId).values,h=i.dtype==="string"?H.fromUint8ToStringArray(d):d,p=i.dtype==="string"?H.fromUint8ToStringArray(c):c,f=n||i.dtype,[g,m]=t(i.shape,o.shape,h,p,f);return u.makeTensorInfo(m,f,g)}:({inputs:a,backend:s})=>{let{a:i,b:o}=a,u=s;if(i.dtype==="complex64"||o.dtype==="complex64"){let d=Pc({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),c=u.data.get(d.dataId),h=c.complexTensorInfos.real,p=c.complexTensorInfos.imag,f=u.data.get(h.dataId).values,g=u.data.get(p.dataId).values,m=Pc({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),x=u.data.get(m.dataId),y=x.complexTensorInfos.real,v=x.complexTensorInfos.imag,b=u.data.get(y.dataId).values,N=u.data.get(v.dataId).values,[S,_,C]=r(i.shape,o.shape,f,g,b,N),k=u.makeTensorInfo(C,"float32",S),I=u.makeTensorInfo(C,"float32",_),T=Ls({inputs:{real:k,imag:I},backend:u});return u.disposeIntermediateTensorInfo(d),u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(k),u.disposeIntermediateTensorInfo(I),T}else{let d=u.data.get(i.dataId).values,c=u.data.get(o.dataId).values,h=n||i.dtype,[p,f]=t(i.shape,o.shape,d,c,h);return u.makeTensorInfo(f,h,p)}}}function DF(e){return(t,r,n,a,s,i)=>{let o=H.assertAndGetBroadcastShape(t,r),u=R.sizeFromShape(o),d=o.length,c=R.computeStrides(o),h=R.getTypedArrayFromDType("float32",u),p=R.getTypedArrayFromDType("float32",u),f=H.getBroadcastDims(t,o),g=H.getBroadcastDims(r,o),m=H.mergeRealAndImagArrays(n,a),x=H.mergeRealAndImagArrays(s,i),y=t.length,v=R.computeStrides(t),b=r.length,N=R.computeStrides(r);if(f.length+g.length===0)for(let S=0;S<h.length;S++){let _=S%m.length,C=S%x.length,k=e(m[_*2],m[_*2+1],x[C*2],x[C*2+1]);h[S]=k.real,p[S]=k.imag}else for(let S=0;S<h.length;S++){let _=R.indexToLoc(S,d,c),C=_.slice(-y);f.forEach(E=>C[E]=0);let k=R.locToIndex(C,y,v),I=_.slice(-b);g.forEach(E=>I[E]=0);let T=R.locToIndex(I,b,N),j=e(m[k*2],m[k*2+1],x[T*2],x[T*2+1]);h[S]=j.real,p[S]=j.imag}return[h,p,o]}}var fJ=Mn((e,t)=>e+t),L4e=DF((e,t,r,n)=>({real:e+r,imag:t+n})),bg=ea(Yc,fJ,L4e),z4e={kernelName:Yc,backendName:"cpu",kernelFunc:bg};function MF(e,t,r,n,a){let s=R.sizeFromShape(n),i=R.makeZerosTypedArray(a,r);for(let o=0;o<e.length;o++){let u=e[o];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(s>0?i[u]+=t[o]:i[u]+=1)}return i}function mJ(e,t,r,n=!1){let a=e.shape[0],s=e.shape[1],i=Qt([a,r],t.dtype);for(let o=0;o<a;o++)for(let u=0;u<s;u++){let d=e.get(o,u);if(d<0)throw new Error("Input x must be non-negative!");d>=r||(n?i.set(1,o,d):t.size>0?i.set(i.get(o,d)+t.get(o,u),o,d):i.set(i.get(o,d)+1,o,d))}return i}var gJ=Mn((e,t)=>e&t),B4e=ea(ax,gJ),U4e={kernelName:ax,backendName:"cpu",kernelFunc:B4e};function Sl(e){return(t,r,n)=>{let a=R.getArrayFromDType(r,t.length);for(let s=0;s<t.length;++s)a[s]=e(t[s],n);return a}}function $r(e,t,r){let n=Sl(t);return id(e,n,r)}function id(e,t,r){return({inputs:n,attrs:a,backend:s})=>{let{x:i}=n;mt(i,e);let o=s,u=o.data.get(i.dataId).values,d;if(i.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");d=H.fromUint8ToStringArray(u)}else d=u;let c=r||i.dtype,h=t(d,c,a);return o.makeTensorInfo(i.shape,c,h)}}var xJ=Sl(e=>Math.ceil(e)),W4e=id(op,xJ),V4e={kernelName:op,backendName:"cpu",kernelFunc:W4e};function FF(e,t,r,n){let a=R.getArrayFromDType(r,R.sizeFromShape(t));if(n&&r!=="string"){let s=0;e.forEach(i=>{let o=R.sizeFromShape(i.shape);a.set(i.vals,s),s+=o})}else{let s=0;e.forEach(i=>{let o=r==="string"?H.fromUint8ToStringArray(i.vals):i.vals,u=0;for(let d=0;d<i.shape[0];++d){let c=d*t[1]+s;for(let h=0;h<i.shape[1];++h)a[c+h]=o[u++]}s+=i.shape[1]})}return a}var yJ=Mn((e,t)=>e===t?1:0),vJ=ea(hx,yJ,null,"bool"),H4e={kernelName:hx,backendName:"cpu",kernelFunc:vJ},bJ=Sl(e=>Math.exp(e)),wJ=id(vp,bJ,"float32"),q4e={kernelName:vp,backendName:"cpu",kernelFunc:wJ},NJ=Sl(e=>Math.expm1(e)),G4e=id(bp,NJ),K4e={kernelName:bp,backendName:"cpu",kernelFunc:G4e},SJ=Sl(e=>Math.floor(e)),Q4e=id(wp,SJ),X4e={kernelName:wp,backendName:"cpu",kernelFunc:Q4e},_J=Mn((e,t)=>Math.floor(e/t)),Y4e=ea(Np,_J,null,"int32"),J4e={kernelName:Np,backendName:"cpu",kernelFunc:Y4e};function kJ(e,t,r,n,a,s,i,o,u){let d=Qt([n,s],r);for(let c=0;c<n;c++){let h=[],p=0;for(let f=0;f<a;f++){let g=e[c*a+f];p+=g*i[f],h.push(g)}if(p<0||p>=u/s)throw new Error(`Invalid indices: ${h} does not index into ${o}`);for(let f=0;f<s;f++)d.values[c*s+f]=t.get(...t.indexToLoc(p*s+f))}return d}function CJ(e,t,r){let n=Qt(r,e.dtype);for(let a=0;a<n.size;++a){let s=n.indexToLoc(a).slice(),i=s[0],o=s[2],u=t.locToIndex([i,o]);s[2]=t.values[u];let d=e.locToIndex(s);0<=d&&d<e.values.length&&(n.values[a]=e.values[d])}return n}var IJ=Mn((e,t)=>e>t?1:0),Z4e=ea(xx,IJ,null,"bool"),eze={kernelName:xx,backendName:"cpu",kernelFunc:Z4e},EJ=Mn((e,t)=>e>=t?1:0),tze=ea(_p,EJ,null,"bool"),rze={kernelName:_p,backendName:"cpu",kernelFunc:tze},TJ=Mn((e,t)=>e<t?1:0),nze=ea(yx,TJ,null,"bool"),aze={kernelName:yx,backendName:"cpu",kernelFunc:nze},jJ=Mn((e,t)=>e<=t?1:0),sze=ea(vx,jJ,null,"bool"),ize={kernelName:vx,backendName:"cpu",kernelFunc:sze};function AJ(e,t,r){let n=(t-e)/(r-1),a=R.makeZerosTypedArray(r,"float32");a[0]=e;for(let s=1;s<a.length;s++)a[s]=a[s-1]+n;return a}var $J=Sl(e=>Math.log(e)),oze=id(jp,$J),lze={kernelName:jp,backendName:"cpu",kernelFunc:oze};function RJ(e,t,r,n){let a=R.getTypedArrayFromDType(n,R.sizeFromShape(r));for(let s=0;s<a.length;++s){let i=s*t,o=e[i];for(let u=0;u<t;++u){let d=e[i+u];(Number.isNaN(d)||d>o)&&(o=d)}a[s]=o}return a}var DJ=Mn((e,t)=>Math.max(e,t)),uze=ea(Dp,DJ),cze={kernelName:Dp,backendName:"cpu",kernelFunc:uze},MJ=Mn((e,t)=>Math.min(e,t)),dze=ea(Pp,MJ),hze={kernelName:Pp,backendName:"cpu",kernelFunc:dze},OF=Mn((e,t)=>e*t),pze=DF((e,t,r,n)=>({real:e*r-t*n,imag:e*n+t*r})),jC=ea(Bp,OF,pze),fze={kernelName:Bp,backendName:"cpu",kernelFunc:jC};function FJ(e,t,r){let n=R.createScalarValue(-1,r);return OF([],t,n,e,r)}function mze(e){let{inputs:t,backend:r}=e,{x:n}=t;mt(n,"neg");let a=r.data.get(n.dataId).values,[s,i]=FJ(a,n.shape,n.dtype);return r.makeTensorInfo(i,n.dtype,s)}var gze={kernelName:Ix,backendName:"cpu",kernelFunc:mze},OJ=Mn((e,t)=>e!==t?1:0),xze=ea(Ex,OJ,null,"bool"),yze={kernelName:Ex,backendName:"cpu",kernelFunc:xze};function PF(e,t,r,n,a){let s=t.length,i=R.sizeFromShape(t),o=R.computeStrides(t),u=R.computeStrides(a),d=R.getTypedArrayFromDType(r,R.sizeFromShape(a));for(let c=0;c<i;++c){let h=R.indexToLoc(c,s,o),p=new Array(h.length);for(let g=0;g<p.length;g++)p[g]=h[n[g]];let f=R.locToIndex(p,s,u);d[f]=e[c]}return d}function bs(e){let{inputs:t,attrs:r,backend:n}=e,{x:a}=t,{perm:s}=r;mt(a,"transpose");let i=a.shape.length,o=new Array(i);for(let c=0;c<o.length;c++)o[c]=a.shape[s[c]];let u=n.data.get(a.dataId).values,d=PF(u,a.shape,a.dtype,s,o);return{dataId:n.write(d,o,a.dtype),shape:o,dtype:a.dtype}}var vze={kernelName:Gl,backendName:"cpu",kernelFunc:bs};function PJ(e,t,r,n){let[a,s]=H.computeOutAndReduceShapes(e,n),i=wi(t,"int32"),o=R.makeZerosTypedArray(R.sizeFromShape(a),i),u=R.sizeFromShape(s);for(let d=0;d<o.length;++d){let c=d*u,h=1;for(let p=0;p<u;++p)h*=r[c+p];o[d]=h}return{outVals:o,outShape:a,outDtype:i}}function bze(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n;mt(a,"prod");let o=a.shape.length,u=R.parseAxisParam(s,a.shape),d=H.getAxesPermutation(u,o),c=u,h=a,p=[];d!=null&&(h=bs({inputs:{x:a},backend:r,attrs:{perm:d}}),p.push(h),c=H.getInnerMostAxes(c.length,o));let f=r.data.get(h.dataId).values,{outVals:g,outShape:m,outDtype:x}=PJ(h.shape,h.dtype,f,c),y=m;return i&&(y=H.expandShapeToKeepDim(m,u)),p.forEach(v=>r.disposeIntermediateTensorInfo(v)),r.makeTensorInfo(y,x,g)}var wze={kernelName:qp,backendName:"cpu",kernelFunc:bze};function Nze(e,t,r){e.forEach((n,a)=>{if(n<0||n>=r){let s=R.indexToLoc(a,t.length,R.computeStrides(t)).join(",");throw new Error(`indices[${s}] = ${n} is not in [0, ${r})`)}})}function Sze(e,t){for(let r=0;r<e.length;++r){let n=e[r],a=r===e.length-1?t:e[r+1].length;if(n.length===0)throw new Error("Ragged splits may not be empty");if(n[0]<0)throw new Error("Ragged splits must be non-negative");if(n[n.length-1]>a)throw new Error("Ragged splits must not point past values");for(let s=1;s<n.length;++s)if(n[s-1]>n[s])throw new Error("Ragged splits must be sorted in ascending order")}}function _ze(e,t,r,n){let a=[],s=0,i=t.length-1+r.length,o=new Array(i).fill(null).map(()=>[0]);Sze(r,n);let u=1;for(let d=0;d<t.length-1;++d){u*=t[d];let c=t[d+1];for(let h=1;h<u+1;++h)o[d].push(h*c)}for(let d=0;d<e.length;++d){let c=e[d],h=e[d]+1;for(let p=0;p<r.length;++p){let f=r[p],g=p+t.length-1;if(g>=0){let m=o[g],x=m[m.length-1]-f[c];for(let y=c;y<h;++y)o[g].push(f[y+1]+x)}c=f[c],h=f[h]}h!==c&&(a.push([c,h]),s+=h-c)}return{outSplits:o,valueSlices:a,numValues:s}}function kze(e){let t=[];for(let r=0;r<e.length;++r){let n=e[r].length,a=R.getArrayFromDType("int32",n);t.push(a),e[r].forEach((s,i)=>a[i]=s)}return t}function rz(e,t){let r=e.slice(0,t);for(;r.length<t;)r.push(1);for(let n=t;n<e.length;n++)r[t-1]*=e[n];return r}function Cze(e,t,r,n,a,s){let i=rz(t,2)[1],o=rz(s,2)[1],u=0;for(let d of r)for(let c=d[0];c<d[1];++c){for(let h=0;h<n;++h)a[u*o+h]=e[c*i+h];++u}}function Ize(e,t,r,n,a){let s=t.slice();s[0]=a;let i=R.getArrayFromDType(r,R.sizeFromShape(s)),o=e.length,u=o===0?0:o/t[0];return Cze(e,t,n,u,i,s),[i,s]}function LJ(e,t,r,n,a,s,i,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");let u=t[0][0]-1;if(Nze(s,i,u),n.length===0)throw new Error("params.rank must be nonzero");let d=n[0],{outSplits:c,valueSlices:h,numValues:p}=_ze(s,i,e,d),f=kze(c),g=Ize(r,n,a,h,p);return[f,g[0],g[1]]}var nz=2147483647;function zJ(e,t,r,n,a,s,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");let o=t.length===0,u=a.length===0,d=i.length===0,c=[];o||c.push(t[0]),u||c.push(a[0]),d||c.push(i[0]);for(let x=1;x<c.length;++x)if(c[x]!==c[x-1])throw new Error("starts, limits, and deltas must have the same shape");let h=c.length===0?1:c[0],p=R.getArrayFromDType("int32",h+1);p[0]=0;for(let x=0;x<h;++x){let y=o?e[0]:e[x],v=u?n[0]:n[x],b=d?s[0]:s[x];if(b===0)throw new Error("Requires delta != 0");let N;if(b>0&&v<y||b<0&&v>y)N=0;else if(N=Math.ceil(Math.abs((v-y)/b)),N>nz)throw new Error(`Requires ((limit - start) / delta) <= ${nz}`);p[x+1]=p[x]+N}let f=p[h],g=R.getArrayFromDType(r,f),m=0;for(let x=0;x<h;++x){let y=p[x+1]-p[x],v=o?e[0]:e[x],b=d?s[0]:s[x];for(let N=0;N<y;++N)g[m++]=v,v+=b}return[p,g]}var Ei=H.RowPartitionType,Eze=class oj{constructor(t,r,n,a,s,i,o,u,d,c){this.shape=t,this.shapeShape=r,this.values=n,this.valuesShape=a,this.valuesDType=s,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=u,this.rowPartitionValuesShapes=d,this.rowPartitionTypes=H.getRowPartitionTypesHelper(c),this.raggedRank=H.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===Ei.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===Ei.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){let r=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case Ei.VALUE_ROWIDS:return oj.getMaxWidthValueRowID(r);case Ei.ROW_SPLITS:return oj.getMaxWidthRowSplit(r);default:throw new Error(`Cannot handle partition type ${Ei[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){let r=t.length;if(r===0||r===1)return 0;let n=0;for(let a=0;a<r-1;++a){let s=t[a+1]-t[a];s>n&&(n=s)}return n}static getMaxWidthValueRowID(t){let r=t.length;if(r===0)return 0;let n=0,a=t[0],s=0;for(let i=1;i<r;++i){let o=t[i];o!==a&&(a=o,s=Math.max(i-n,s),n=i)}return Math.max(r-n,s)}tensorShapeFromTensor(t,r,n=!0){if(r.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return sz(t,n)}calculateOutputSize(t){let r=this.valuesShape,n=this.defaultValueShape;H.validateDefaultValueShape(n,r);let a=this.tensorShapeFromTensor(this.shape,this.shapeShape),s=H.combineRaggedTensorToTensorShapes(this.raggedRank,a,r);s[0]<0&&(s[0]=t);for(let i=1;i<=this.raggedRank;++i)s[i]<0&&(s[i]=this.getMaxWidth(i));return s}calculateFirstParentOutputIndex(t,r,n){let a=Math.min(t,n),s=[],i=0;for(let o=0;o<a;++o,i+=r)s.push(i);for(let o=a;o<t;++o)s.push(-1);return R.assert(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,r,n,a){let s=t.length,i=[];for(let o=0;o<s-1;++o){let u=t[o+1]-t[o],d=Math.min(a,u),c=r[o];c===-1&&(d=0);for(let h=0;h<d;++h)i.push(c),c+=n;for(let h=0;h<u-d;++h)i.push(-1)}if(s>0&&i.length!==t[s-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(t,r,n,a){let s=t.length,i=[];if(s===0)return[];let o=0,u=t[0];if(u>=r.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${r.length}`);let d=r[u];i.push(d);for(let c=1;c<s;++c){let h=t[c];if(h===u)d>=0&&(++o,o<a?d+=n:d=-1);else{if(o=0,u=h,h>=r.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${r.length}`);d=r[h]}i.push(d)}if(i.length!==t.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(t,r,n,a){let s=this.getRowPartitionTensor(t),i=this.getRowPartitionTypeByDimension(t);switch(i){case Ei.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,r,n,a);case Ei.ROW_SPLITS:if(s.length-1>r.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${r.length}`);return this.calculateOutputIndexRowSplit(s,r,n,a);default:throw new Error(`Unsupported partition type: ${Ei[i]}`)}}getFirstDimensionSize(){let t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let r=this.rowPartitionTypes[0];switch(r){case Ei.FIRST_DIM_SIZE:return t[0];case Ei.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ei.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ei[r]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*r[i+1];let a=sz(r,!1),s=R.getArrayFromDType(this.valuesDType,R.sizeFromShape(a));if(n[0]*r[0]>0){let i=this.calculateFirstParentOutputIndex(t,n[0],r[0]);for(let o=1;o<=this.raggedRank;++o)i=this.calculateOutputIndex(o-1,i,n[o],r[o]);this.setOutput(this.raggedRank,i,s,a)}return[a,s]}setOutput(t,r,n,a){if(n.length===0)return;let s=this.values,i=n,o=a.slice();o=o.slice(t+1);let u=R.sizeFromShape(o),d=r.length,c=this.defaultValue;if(c.length!==u&&c.length!==1){let g=this.defaultValueShape;ce(()=>{let m=ue(c,g);c=eh(m,o).dataSync()})}let h=0,p=0,f=0;for(let g=0;g<=d;++g){let m=g<d?r[g]:-1;if(m===f){++f;continue}if(p<f){let x=s.subarray(h*u),y=i.subarray(p*u),v=(f-p)*u;az(y,x,v)}if(g>=d){let x=n.length;m=Math.floor(x/u)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*u,m*u).fill(this.defaultValue[0]),f=m;else for(;m>f;){let x=i.slice(f*u);az(x,c,u),++f}m<0?(h=g+1,p=f):(h=g,p=f,f=p+1)}}};function az(e,t,r){for(let n=0;n<r;n++)e[n]=t[n]}function sz(e,t){let r=[];for(let n of e){if(n<0){if(!t)throw new Error(`Dimension ${n} must be >= 0`);if(n<-1)throw new Error(`Dimension ${n} must be >= -1`);n=-1}r.push(n)}return r}function BJ(e,t,r,n,a,s,i,o,u,d){return new Eze(e,t,r,n,a,s,i,o,u,d).compute()}function LF(e,t,r,n){let a=e===t,s=e<t&&r<0,i=t<e&&r>1;if(a||s||i)return R.makeZerosTypedArray(0,n);let o=Math.abs(Math.ceil((t-e)/r)),u=R.makeZerosTypedArray(o,n);t<e&&r===1&&(r=-1),u[0]=e;for(let d=1;d<u.length;d++)u[d]=u[d-1]+r;return u}var UJ=Sl(e=>1/Math.sqrt(e)),Tze=id(ef,UJ),jze={kernelName:ef,backendName:"cpu",kernelFunc:Tze};function Pd(e,t,r,n,a,s,i,o,u,d){let c=[n/a,a],h=e.values,p=t.values;if(n===0)return Qt(r,t.dtype);let f=u instanceof zn?u:Qt(c,t.dtype);typeof u=="string"||typeof u=="number"?f.values.fill(u):typeof u=="boolean"&&f.values.fill(+u);for(let g=0;g<s;g++){let m=[],x=0;for(let y=0;y<i;y++){let v=h[g*i+y];m.push(v),x+=v*o[y]}if(x<0||x>=n/a)throw new Error(`Invalid indices: ${m} does not index into ${r}`);for(let y=0;y<a;y++)d?f.values[x*a+y]+=p[g*a+y]:f.values[x*a+y]=t.rank===0?p[0]:p[g*a+y]}return f}var Aze=Sl(e=>1/(1+Math.exp(-e))),WJ=$r(sf,e=>1/(1+Math.exp(-e))),$ze={kernelName:sf,backendName:"cpu",kernelFunc:WJ};function SS(e,t,r,n,a){let s=Yn.isSliceContinous(n,t,r),i=R.sizeFromShape(r),o=R.computeStrides(n);if(s){let h=Yn.computeFlatOffset(t,o);return a==="string"?e.slice(h,h+i):e.subarray(h,h+i)}let u=a==="string"?H.fromUint8ToStringArray(e):e,d=Qt(n,a,u),c=Qt(r,a);for(let h=0;h<c.size;++h){let p=c.indexToLoc(h),f=p.map((g,m)=>g+t[m]);c.set(d.get(...f),...p)}return a==="string"?H.fromStringArrayToUint8(c.values):c.values}function Mh(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{begin:s,size:i}=n;mt(a,"slice");let[o,u]=Yn.parseSliceParams(a,s,i);Yn.assertParamsValid(a,o,u);let d=r.data.get(a.dataId).values,c=SS(d,o,u,a.shape,a.dtype);return r.makeTensorInfo(u,a.dtype,c)}var Rze={kernelName:Bx,backendName:"cpu",kernelFunc:Mh};function VJ(e,t,r,n,a,s,i){let o=t[0],u=s[0],d=new Array(u),c=new Array(o),h=t[1];if(u===0){if(o!==0)throw new Error(H.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));let x=R.getArrayFromDType(r,0),y=R.getArrayFromDType(a,0);return[x,[0,h],y,d,c]}let p=!0,f=0,g=new Array(u).fill(0);for(let x=0;x<o;++x){let y=e[x*h];if(y<0)throw new Error(H.getSparseFillEmptyRowsNegativeIndexErrorMessage(x,y));if(y>=u)throw new Error(H.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(x,y,u));++g[y],p=p&&y>=f,f=y}let m=!0;for(let x=0;x<u;++x){let y=g[x]===0;d[x]=y,m=m&&!y,g[x]=Math.max(g[x],1),x>0&&(g[x]+=g[x-1])}if(m&&p){let x=e,y=n;for(let v=0;v<o;++v)c[v]=v;return[x,[o,h],y,d,c]}else{let x=g[u-1],y=R.getArrayFromDType(r,x*h),v=R.getArrayFromDType(a,x),b=new Array(u).fill(0);for(let N=0;N<o;++N){let S=e[N*h],_=b[S],C=(S===0?0:g[S-1])+_;b[S]++;for(let k=0;k<h;++k)y[C*h+k]=e[N*h+k];v[C]=n[N],c[N]=C}for(let N=0;N<u;++N)if(b[N]===0){let S=N===0?0:g[N-1];y[S*h+0]=N;for(let _=1;_<h;++_)y[S*h+_]=0;v[S]=i}return[y,[x,h],v,d,c]}}function HJ(e,t,r,n,a){let s=R.sizeFromShape(n),i=t[0],o=a.length,u=[],d=1,c=-1;for(let m=0;m<o;++m){let x=a[m];if(x===-1){if(c!==-1)throw new Error(H.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(c,m));c=m,u.push(1)}else{if(x<0)throw new Error(H.getSparseReshapeNegativeOutputDimErrorMessage(m,x));d*=x,u.push(x)}}if(c!==-1){if(d<=0)throw new Error(H.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let m=Math.trunc(s/d);if(d*m!==s)throw new Error(H.getSparseReshapeInputOutputMultipleErrorMessage(n,u));u[c]=m}if(R.sizeFromShape(u)!==s)throw new Error(H.getSparseReshapeInputOutputMismatchErrorMessage(n,u));let h=n.length,p=[];if(h>0){p[h-1]=1;for(let m=h-2;m>=0;--m)p[m]=p[m+1]*n[m+1]}let f=[];if(o>0){f[o-1]=1;for(let m=o-2;m>=0;--m)f[m]=f[m+1]*u[m+1]}let g=R.getArrayFromDType(r,i*o);for(let m=0;m<i;++m){let x=0;for(let y=0;y<h;++y)x+=e[m*h+y]*p[y];for(let y=0;y<o;++y)g[m*o+y]=Math.trunc(x/f[y]),x%=f[y]}return[g,[i,o],u]}function zF(e,t,r,n,a,s=!1,i=0){let o=n.length,u=[t[0],e.length/t[0]],d=u[1],c=o>0?a[o-1]+1:0;if(c<0)throw new Error(H.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let h=t.slice();h[0]=c;let p=h.reduce((v,b)=>v*b,1),f=R.getArrayFromDType(r,p);if(o===0)return c>0&&f.fill(i),[f,h];if(c<=0)throw new Error(H.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let g=0,m=1,x=0,y=a[g];for(;;){let v=0;if(m<o){if(v=a[m],y===v){++m;continue}if(y>=v)throw new Error(H.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=c)throw new Error(H.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,c));y>x&&f.fill(i,x*d,y*d);for(let b=g;b<m;++b){let N=n[b];if(N<0||N>=u[0])throw new Error(H.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(b,n[b],u[0]));for(let S=0;S<d;S++)f[y*d+S]+=e[N*d+S]}if(s)for(let b=0;b<d;b++)f[y*d+b]/=m-g;if(g=m,++m,x=y+1,y=v,m>o)break}return x<c&&f.fill(i,x*d,c*d),[f,h]}var Dze=Sl(e=>Math.sqrt(e)),Mze=$r(lf,e=>Math.sqrt(e)),Fze={kernelName:lf,backendName:"cpu",kernelFunc:Mze},qJ=Mn((e,t)=>{let r=e-t;return r*r}),Oze=ea(df,qJ),Pze={kernelName:df,backendName:"cpu",kernelFunc:Oze},GJ=Sl((e,t)=>{let{pattern:r,replaceGlobal:n,rewrite:a}=t;return e.replace(new RegExp(r,n?"g":""),a)}),Lze=id(C0,GJ),zze={kernelName:C0,backendName:"cpu",kernelFunc:Lze};function KJ(e,t,r,n){let a=Qt(e,t.dtype);for(let s=0;s<a.size;s++){let i=a.indexToLoc(s),o=new Array(i.length);for(let u=0;u<o.length;u++)o[u]=i[u]*r[u]+n[u];a.set(t.get(...o),...i)}return a}var Bze=class{constructor(e,t,r,n,a,s){this.separator=R.encodeString(e),this.nGramWidths=t,this.leftPad=R.encodeString(r),this.rightPad=R.encodeString(n),this.padWidth=a,this.preserveShort=s}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,n,a,s){for(let i=0;i<a;++i){let o=this.getPadWidth(s),u=Math.max(0,o-i),d=Math.max(0,o-(a-(i+1))),c=s-(u+d),h=t+(u>0?0:i-o),p=0;p+=u*this.leftPad.length;for(let y=0;y<c;++y)p+=e[h+y].length;p+=d*this.rightPad.length;let f=u+d+c-1;p+=f*this.separator.length,r[n+i]=new Uint8Array(p);let g=r[n+i],m=0,x=y=>y.forEach(v=>g[m++]=v);for(let y=0;y<u;++y)x(this.leftPad),x(this.separator);for(let y=0;y<c-1;++y)x(e[h+y]),x(this.separator);if(c>0){x(e[h+c-1]);for(let y=0;y<d;++y)x(this.separator),x(this.rightPad)}else{for(let y=0;y<d-1;++y)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,t){let r=e.length,n=t.length;if(n>0){let o=t[0];if(o!==0)throw new Error(`First split value must be 0, got ${o}`);for(let u=1;u<n;++u){let d=t[u]>=o;if(d=d&&t[u]<=r,!d)throw new Error(`Invalid split value ${t[u]}, must be in [${o}, ${r}]`);o=t[u]}if(o!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${o}`)}let a=n-1,s=R.getArrayFromDType("int32",n);if(r===0||n===0){let o=new Array(r);for(let u=0;u<=a;++u)s[u]=0;return[o,s]}s[0]=0;for(let o=1;o<=a;++o){let u=t[o]-t[o-1],d=0;this.nGramWidths.forEach(c=>{d+=this.getNumNGrams(u,c)}),this.preserveShort&&u>0&&d===0&&(d=1),s[o]=s[o-1]+d}let i=new Array(s[a]);for(let o=0;o<a;++o){let u=t[o],d=s[o];if(this.nGramWidths.forEach(c=>{let h=t[o+1]-t[o],p=this.getNumNGrams(h,c);this.createNGrams(e,u,i,d,p,c),d+=p}),this.preserveShort&&d===s[o]){let c=t[o+1]-t[o];if(c===0)continue;let h=c+2*this.padWidth;this.createNGrams(e,u,i,d,1,h)}}return[i,s]}};function BF(e,t,r,n,a,s,i,o){return new Bze(r,n,a,s,i,o).compute(e,t)}function Uze(e,t,r,n){if(!e.length)return;if(t.length===0){for(let s=0;s<e.length;++s)n.push(e.subarray(s,s+1));return}if(t.length===1){let s=t[0],i=e.indexOf(s);for(;i!==-1;){let o=e.subarray(0,i);(!r||o.length!==0)&&n.push(o),e=e.subarray(i+1),i=e.indexOf(s)}(!r||e.length!==0)&&n.push(e);return}let a=0;for(let s=0;s<e.length+1;s++)if(s===e.length||t.indexOf(e[s])!==-1){let i=e.subarray(a,s);(!r||i.length!==0)&&n.push(i),a=s+1}}function UF(e,t,r){let n=e.length,a=[],s=0,i=0,o=new Array(n);for(let p=0;p<n;++p){let f=a.length;Uze(e[p],t,r,a);let g=a.length-f;o[p]=g,s+=g,i=Math.max(i,g)}let u=R.getArrayFromDType("int32",s*2),d=new Array(s),c=[n,i],h=0;for(let p=0;p<n;++p)for(let f=0;f<o[p];++f)u[h*2]=p,u[h*2+1]=f,d[h]=a[h],++h;return[u,d,c]}function WF(e,t){let r=R.getArrayFromDType("int32",e.length);for(let n=0;n<e.length;++n)r[n]=R.fingerPrint64(e[n]).modulo(t).getLowBitsUnsigned();return r}var QJ=Mn((e,t)=>e-t),Wze=DF((e,t,r,n)=>({real:e-r,imag:t-n})),VF=ea(hf,QJ,Wze),Vze={kernelName:hf,backendName:"cpu",kernelFunc:VF};function XJ(e,t){let r=new Array(e.rank);for(let a=0;a<r.length;a++)r[a]=e.shape[a]*t[a];let n=Qt(r,e.dtype);for(let a=0;a<n.values.length;++a){let s=n.indexToLoc(a),i=new Array(e.rank);for(let u=0;u<i.length;u++)i[u]=s[u]%e.shape[u];let o=e.locToIndex(i);n.values[a]=e.values[o]}return n}var rv=(e,t)=>{let r=t.value-e.value;return r===0?e.index-t.index:r};function YJ(e,t,r=0,n=e.length-1){for(;n>r;){if(n-r>600){let o=n-r+1,u=t-r+1,d=Math.log(o),c=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*c*(o-c)/o)*Math.sign(u-o/2),p=Math.max(r,Math.floor(t-u*c/o+h)),f=Math.min(n,Math.floor(t+(o-u)*c/o+h));YJ(e,t,p,f)}let a=e[t],s=r,i=n;for(R.swap(e,r,t),rv(e[n],a)>0&&R.swap(e,r,n);s<i;){for(R.swap(e,s,i),s++,i--;rv(e[s],a)<0;)s=s+1;for(;rv(e[i],a)>0;)i=i-1}rv(e[r],a)===0?R.swap(e,r,i):(i=i+1,R.swap(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}}function JJ(e,t,r,n,a){let s=t[t.length-1],[i,o]=[e.length/s,s],u=R.getTypedArrayFromDType(r,i*n),d=R.getTypedArrayFromDType("int32",i*n);for(let h=0;h<i;h++){let p=h*o,f=e.subarray(p,p+o),g=new Array(f.length);f.forEach((v,b)=>g[b]={value:v,index:b}),n<g.length&&(YJ(g,n),g=g.slice(0,n)),a&&g.sort(rv);let m=h*n,x=u.subarray(m,m+n),y=d.subarray(m,m+n);for(let v=0;v<n;v++)x[v]=g[v].value,y[v]=g[v].index}let c=t.slice();return c[c.length-1]=n,[Qt(c,r,u),Qt(c,"int32",d)]}function HF(e,t,r,n){let a=R.parseAxisParam(t,r)[0],s=[1,r[0],1];for(let g=0;g<a;g++)s[0]*=r[g];s[1]=r[a];for(let g=a+1;g<r.length;g++)s[2]*=r[g];let i=new Map,o=new Int32Array(r[a]),u=new zn(s,n,e),d=[],c=s[0]===1&&s[2]===1;for(let g=0;g<r[a];g++){let m;if(c)m=e[g].toString();else{let y=[];for(let v=0;v<s[0];v++)for(let b=0;b<s[2];b++)y.push(u.get(v,g,b));m=y.join(",")}let x=i.get(m);if(x!=null)o[g]=x;else{let y=i.size;i.set(m,y),o[g]=y,d.push(g)}}let h=s.slice();h[1]=i.size;let p=new zn(h,n);d.forEach((g,m)=>{for(let x=0;x<s[0];x++)for(let y=0;y<s[2];y++)p.set(u.get(x,g,y),x,m,y)});let f=r.slice();return f[a]=h[1],{outputValues:p.values,outputShape:f,indices:o}}var Hze="4.22.0";Ik("cpu",()=>new $F,1);var ZJ=$r(xp,e=>e>=0?e:Math.exp(e)-1),qze={kernelName:xp,backendName:"cpu",kernelFunc:ZJ};function eZ(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{alpha:s}=n;mt([a],"leakyRelu");let i=R.sizeFromShape(a.shape),o=r.data.get(a.dataId).values,u=R.getTypedArrayFromDType("float32",i);for(let d=0;d<o.length;d++)u[d]=o[d]<0?s*o[d]:o[d];return r.makeTensorInfo(a.shape,"float32",u)}var Gze={kernelName:Tp,backendName:"cpu",kernelFunc:eZ},Kze=Mn((e,t)=>e<0?t*e:e);function tZ(e){let{inputs:t,backend:r}=e,{x:n,alpha:a}=t;mt([n,a],"prelu");let s=r.data.get(n.dataId).values,i=r.data.get(a.dataId).values,[o,u]=Kze(n.shape,a.shape,s,i,"float32");return r.makeTensorInfo(u,"float32",o)}var Qze={kernelName:Hp,backendName:"cpu",kernelFunc:tZ},rZ=$r(Kp,e=>Math.max(0,e)),Xze={kernelName:Kp,backendName:"cpu",kernelFunc:rZ},nZ=$r(Yp,e=>Math.min(Math.max(0,e),6)),Yze={kernelName:Yp,backendName:"cpu",kernelFunc:nZ};function _S(e,t,r,n,a){if(r==="linear")return ml({inputs:{x:t},backend:e});if(r==="relu")return rZ({inputs:{x:t},backend:e});if(r==="elu")return ZJ({inputs:{x:t},backend:e});if(r==="relu6")return nZ({inputs:{x:t},backend:e});if(r==="prelu")return tZ({inputs:{x:t,alpha:n},backend:e});if(r==="leakyrelu")return eZ({inputs:{x:t},backend:e,attrs:{alpha:a}});if(r==="sigmoid")return WJ({inputs:{x:t},backend:e});throw new Error(`Activation ${r} has not been implemented for the CPU backend.`)}function Zr(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{shape:s}=n,i=R.sizeFromShape(a.shape),o=R.inferFromImplicitShape(s,i),u=R.sizeFromShape(o);R.assert(i===u,()=>`The new shape (${o}) has ${u} elements and the old shape (${a.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),r.incRef(a.dataId);let d=r.data.get(a.dataId);if(d.complexTensorInfos!=null){let c=d.complexTensorInfos.real,h=d.complexTensorInfos.imag;c.shape=o,h.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}var Jze={kernelName:Dx,backendName:"cpu",kernelFunc:Zr};function aZ(e){let{inputs:t,backend:r,attrs:n}=e,{a,b:s}=t,{transposeA:i,transposeB:o}=n;mt([a,s],"matMul");let u=a.shape.length,d=s.shape.length,c=i?a.shape[u-2]:a.shape[u-1],h=o?s.shape[d-1]:s.shape[d-2],p=i?a.shape[u-1]:a.shape[u-2],f=o?s.shape[d-2]:s.shape[d-1],g=a.shape.slice(0,-2),m=s.shape.slice(0,-2),x=R.sizeFromShape(g),y=R.sizeFromShape(m),v=Jx.assertAndGetBroadcastShape(a.shape.slice(0,-2),s.shape.slice(0,-2)).concat([p,f]);R.assert(c===h,()=>`Error in matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${a.shape} and ${s.shape} and transposeA=${i} and transposeB=${o} must match.`);let b=i?[x,c,p]:[x,p,c],N=o?[y,f,h]:[y,h,f],S=Zr({inputs:{x:a},backend:r,attrs:{shape:b}}),_=Zr({inputs:{x:s},backend:r,attrs:{shape:N}}),C=i?S.shape[1]:S.shape[2],k=i?S.shape[2]:S.shape[1],I=o?_.shape[1]:_.shape[2],T=Math.max(x,y),j=r.data.get(S.dataId).values,E=r.data.get(_.dataId).values,O=R.computeStrides(S.shape),M=R.computeStrides(_.shape),[W,q,P]=i?[O[0],1,O[1]]:[O[0],O[1],1],[A,L,z]=o?[1,M[1],M[0]]:[M[1],1,M[0]],$=k*I,V=Qt([T,k,I],S.dtype),B=V.values,Y=r.blockSize;for(let re=0;re<T;re++){let ae=re%x,K=re%y;for(let J=0;J<k;J+=Y){let Z=Math.min(J+Y,k);for(let Q=0;Q<I;Q+=Y){let U=Math.min(Q+Y,I);for(let F=0;F<C;F+=Y){let te=Math.min(F+Y,C);for(let pe=J;pe<Z;pe++)for(let ve=Q;ve<U;ve++){let fe=0;for(let Me=F;Me<te;Me++){let je=j[ae*W+pe*q+Me*P],Qe=E[Me*A+ve*L+K*z];fe+=je*Qe}B[re*$+(pe*I+ve)]+=fe}}}}}return r.disposeIntermediateTensorInfo(S),r.disposeIntermediateTensorInfo(_),r.makeTensorInfo(v,V.dtype,V.values)}var Zze={kernelName:sp,backendName:"cpu",kernelFunc:aZ};function e5e(e){let{inputs:t,backend:r,attrs:n}=e,{a,b:s,bias:i,preluActivationWeights:o}=t,{transposeA:u,transposeB:d,activation:c,leakyreluAlpha:h}=n,p,f,g,m=[];p=aZ({inputs:{a,b:s},attrs:{transposeA:u,transposeB:d},backend:r}),i&&(f=bg({inputs:{a:p,b:i},backend:r}),m.push(p),p=f),c&&(g=_S(r,p,c,o,h),m.push(p),p=g);for(let x of m)r.disposeIntermediateTensorInfo(x);return p}var t5e={kernelName:wh,backendName:"cpu",kernelFunc:e5e},r5e=$r(Xh,e=>Math.acos(e)),n5e={kernelName:Xh,backendName:"cpu",kernelFunc:r5e},a5e=$r(Yh,e=>Math.acosh(e)),s5e={kernelName:Yh,backendName:"cpu",kernelFunc:a5e};function i5e(e){let{inputs:t,backend:r}=e,n=t;mt(t,"addN");let a=n.map(o=>r.data.get(o.dataId).values),s=Qt(n[0].shape,n[0].dtype),i=s.values;for(let o=0;o<n.length;o++){let u=a[o];for(let d=0;d<i.length;d++)i[d]+=u[d]}return r.makeTensorInfo(s.shape,s.dtype,s.values)}var o5e={kernelName:Jh,backendName:"cpu",kernelFunc:i5e};function l5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n;mt(a,"all");let o=R.parseAxisParam(s,a.shape),u=o,d=H.getAxesPermutation(u,a.shape.length),c=a;d!=null&&(c=bs({inputs:{x:a},backend:r,attrs:{perm:d}}),u=H.getInnerMostAxes(u.length,a.shape.length)),H.assertAxesAreInnerMostDims("all",u,c.shape.length);let[h,p]=H.computeOutAndReduceShapes(c.shape,u),f=R.sizeFromShape(p),g=R.makeZerosTypedArray(R.sizeFromShape(h),c.dtype),m=r.data.get(c.dataId).values;for(let y=0;y<g.length;++y){let v=y*f,b=m[v];for(let N=0;N<f;++N){let S=m[v+N];b=b&&S}g[y]=b}d!=null&&r.disposeIntermediateTensorInfo(c);let x=r.makeTensorInfo(h,c.dtype,g);if(i){let y=H.expandShapeToKeepDim(h,o),v=Zr({inputs:{x},backend:r,attrs:{shape:y}});return r.disposeIntermediateTensorInfo(x),v}return x}var u5e={kernelName:Yg,backendName:"cpu",kernelFunc:l5e};function c5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n;mt(a,"any");let o=R.parseAxisParam(s,a.shape),u=o,d=H.getAxesPermutation(u,a.shape.length),c=a;d!=null&&(c=bs({inputs:{x:a},backend:r,attrs:{perm:d}}),u=H.getInnerMostAxes(u.length,a.shape.length)),H.assertAxesAreInnerMostDims("any",u,c.shape.length);let[h,p]=H.computeOutAndReduceShapes(c.shape,u),f=R.sizeFromShape(p),g=R.makeZerosTypedArray(R.sizeFromShape(h),c.dtype),m=r.data.get(c.dataId).values;for(let y=0;y<g.length;++y){let v=y*f,b=m[v];for(let N=0;N<f;++N){let S=m[v+N];b=b||S}g[y]=b}d!=null&&r.disposeIntermediateTensorInfo(c);let x=r.makeTensorInfo(h,c.dtype,g);if(i){let y=H.expandShapeToKeepDim(h,o),v=Zr({inputs:{x},backend:r,attrs:{shape:y}});return r.disposeIntermediateTensorInfo(x),v}return x}var d5e={kernelName:Jg,backendName:"cpu",kernelFunc:c5e};function h5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s}=n;mt(a,"argMax");let i=R.parseAxisParam(s,a.shape),o=H.getAxesPermutation(i,a.shape.length),u=a,d=[];o!=null&&(u=bs({inputs:{x:a},backend:r,attrs:{perm:o}}),d.push(u),i=H.getInnerMostAxes(i.length,u.shape.length)),i=[i[0]],H.assertAxesAreInnerMostDims("argMax",i,u.shape.length);let[c,h]=H.computeOutAndReduceShapes(u.shape,i),p=R.sizeFromShape(c),f=R.makeZerosTypedArray(p,"int32"),g=R.sizeFromShape(h),m=r.data.get(u.dataId).values;for(let x=0;x<f.length;++x){let y=x*g,v=m[y],b=0;for(let N=0;N<g;++N){let S=m[y+N];S>v&&(v=S,b=N)}f[x]=b}return d.forEach(x=>r.disposeIntermediateTensorInfo(x)),r.makeTensorInfo(c,"int32",f)}var p5e={kernelName:Zg,backendName:"cpu",kernelFunc:h5e};function f5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s}=n;mt(a,"argMin");let i=R.parseAxisParam(s,a.shape),o=H.getAxesPermutation(i,a.shape.length),u=a,d=[];o!=null&&(u=bs({inputs:{x:a},backend:r,attrs:{perm:o}}),d.push(u),i=H.getInnerMostAxes(i.length,u.shape.length)),i=[i[0]],H.assertAxesAreInnerMostDims("argMin",i,u.shape.length);let[c,h]=H.computeOutAndReduceShapes(u.shape,i),p=R.sizeFromShape(c),f=R.makeZerosTypedArray(p,"int32"),g=R.sizeFromShape(h),m=r.data.get(u.dataId).values;for(let x=0;x<f.length;++x){let y=x*g,v=m[y],b=0;for(let N=0;N<g;++N){let S=m[y+N];S<v&&(v=S,b=N)}f[x]=b}return d.forEach(x=>r.disposeIntermediateTensorInfo(x)),r.makeTensorInfo(c,"int32",f)}var m5e={kernelName:ex,backendName:"cpu",kernelFunc:f5e},g5e=$r(Zh,e=>Math.asin(e)),x5e={kernelName:Zh,backendName:"cpu",kernelFunc:g5e},y5e=$r(ep,e=>Math.asinh(e)),v5e={kernelName:ep,backendName:"cpu",kernelFunc:y5e},b5e=$r(tp,e=>Math.atan(e)),w5e={kernelName:tp,backendName:"cpu",kernelFunc:b5e},N5e=Mn((e,t)=>Math.atan2(e,t)),S5e=ea(np,N5e),_5e={kernelName:np,backendName:"cpu",kernelFunc:S5e},k5e=$r(rp,e=>Math.atanh(e)),C5e={kernelName:rp,backendName:"cpu",kernelFunc:k5e};function qF(e,t,r,n,a,s){let i=a.strideHeight,o=a.strideWidth,u=a.dilationHeight,d=a.dilationWidth,c=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=a.padInfo.top,f=a.padInfo.left,g=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Qt(a.outShape,r),x=m.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],v=a.outShape[2]*a.outShape[3],b=a.outShape[3];for(let N=0;N<a.batchSize;++N){let S=N*y,_=N*n[0];for(let C=0;C<a.inChannels;++C)for(let k=0;k<a.outHeight;++k){let I=k*i-p,T=Math.max(0,I),j=Math.min(a.inHeight,c+I),E=S+k*v;for(let O=0;O<a.outWidth;++O){let M=O*o-f,W=Math.max(0,M),q=Math.min(a.inWidth,h+M),P=g,A=0,L=0;for(let $=T;$<j;$+=u){let V=_+$*n[1];for(let B=W;B<q;B+=d){let Y=V+B*n[2],re=e[Y+C];s==="max"&&re>P?P=re:s==="avg"&&(A+=re,L++)}if(isNaN(P))break}let z=E+O*b+C;x[z]=s==="avg"?A/L:P}}}return m}function sZ(e,t,r,n,a=!1,s=!1){let i=Qt(n.outShape,"int32"),o=n.strideHeight,u=n.strideWidth,d=n.dilationHeight,c=n.dilationWidth,h=n.effectiveFilterHeight,p=n.effectiveFilterWidth,f=n.padInfo.top,g=n.padInfo.left,m=Qt(t,r,e);for(let x=0;x<n.batchSize;++x)for(let y=0;y<n.inChannels;++y)for(let v=0;v<n.outHeight;++v){let b=v*o-f,N=b;for(;N<0;)N+=d;let S=Math.min(n.inHeight,h+b);for(let _=0;_<n.outWidth;++_){let C=_*u-g,k=C;for(;k<0;)k+=c;let I=Math.min(n.inWidth,p+C),T=Number.NEGATIVE_INFINITY,j=-1;for(let E=N;E<S;E+=d){let O=E-b;for(let M=k;M<I;M+=c){let W=M-C,q=m.get(x,E,M,y);q>T&&(T=q,a?j=s?((x*n.inHeight+E)*n.inWidth+M)*n.inChannels+y:(E*n.inWidth+M)*n.inChannels+y:j=O*p+W)}}i.set(j,x,v,_,y)}}return i}function iZ(e,t,r,n,a,s){let i=a.strideDepth,o=a.strideHeight,u=a.strideWidth,d=a.dilationDepth,c=a.dilationHeight,h=a.dilationWidth,p=a.effectiveFilterDepth,f=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=a.padInfo.front,x=a.padInfo.top,y=a.padInfo.left,v=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Qt(a.outShape,r),N=b.values,S=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[2]*a.outShape[3]*a.outShape[4],C=a.outShape[3]*a.outShape[4],k=a.outShape[4];for(let I=0;I<a.batchSize;++I){let T=I*S,j=I*n[0];for(let E=0;E<a.inChannels;++E)for(let O=0;O<a.outDepth;++O){let M=O*i-m,W=M;for(;W<0;)W+=d;let q=Math.min(a.inDepth,p+M),P=T+O*_;for(let A=0;A<a.outHeight;++A){let L=A*o-x,z=L;for(;z<0;)z+=c;let $=Math.min(a.inHeight,f+L),V=P+A*C;for(let B=0;B<a.outWidth;++B){let Y=B*u-y,re=Y;for(;re<0;)re+=h;let ae=Math.min(a.inWidth,g+Y),K=V+B*k,J=v,Z=0,Q=0;for(let F=W;F<q;F+=d){let te=j+F*n[1];for(let pe=z;pe<$;pe+=c){let ve=te+pe*n[2];for(let fe=re;fe<ae;fe+=h){let Me=ve+fe*n[3],je=e[Me+E];if(s==="max"&&je>J?J=je:s==="avg"&&(Z+=je,Q++),isNaN(J))break}if(isNaN(J))break}if(isNaN(J))break}let U=K+E;N[U]=s==="avg"?Z/Math.max(Q,1):J}}}}return b}function I5e(e,t){let r=Qt(t.outShape,"int32"),n=t.strideDepth,a=t.strideHeight,s=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,u=t.dilationWidth,d=t.effectiveFilterDepth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.front,f=t.padInfo.top,g=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let x=0;x<t.inChannels;++x)for(let y=0;y<t.outDepth;++y){let v=y*n-p,b=v;for(;b<0;)b+=i;let N=Math.min(t.inDepth,d+v);for(let S=0;S<t.outHeight;++S){let _=S*a-f,C=_;for(;C<0;)C+=o;let k=Math.min(t.inHeight,c+_);for(let I=0;I<t.outWidth;++I){let T=I*s-g,j=T;for(;j<0;)j+=u;let E=Math.min(t.inWidth,h+T),O=Number.NEGATIVE_INFINITY,M=-1;for(let W=b;W<N;W+=i){let q=W-v;for(let P=C;P<k;P+=o){let A=P-_;for(let L=j;L<E;L+=u){let z=L-T,$=e.get(m,W,P,L,x);$>=O&&(O=$,M=q*c*h+A*c+z)}}}r.set(M,m,y,S,I,x)}}}return r}function E5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t;mt(a,"avgPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:u}=n,d=1;R.assert(H.eitherStridesOrDilationsAreOne(i,d),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);let c=H.computePool2DInfo(a.shape,s,i,d,o,u),h;if(c.filterWidth===1&&c.filterHeight===1&&R.arraysEqual(c.inShape,c.outShape))h=ml({inputs:{x:a},backend:r});else{let p=r.data.get(a.dataId).values,f=R.computeStrides(a.shape),g=qF(p,a.shape,a.dtype,f,c,"avg");h=r.makeTensorInfo(c.outShape,a.dtype,g.values)}return h}var T5e={kernelName:ap,backendName:"cpu",kernelFunc:E5e};function j5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:u,dataFormat:d}=n;mt(a,"avgPool3d");let c=H.computePool3DInfo(a.shape,s,i,1,o,u,d),h=r.data.get(a.dataId).values,p=iZ(h,a.shape,a.dtype,R.computeStrides(a.shape),c,"avg");return r.makeTensorInfo(p.shape,"float32",p.values)}var A5e={kernelName:tx,backendName:"cpu",kernelFunc:j5e};function $5e(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:u,dimRoundingMode:d}=n;mt([a,s],"avgPool3DGrad");let c=H.computePool3DInfo(s.shape,i,o,1,u,d),h=c.strideDepth,p=c.strideHeight,f=c.strideWidth,g=c.filterDepth,m=c.filterHeight,x=c.filterWidth,y=c.dilationDepth,v=c.dilationHeight,b=c.dilationWidth,N=c.effectiveFilterDepth,S=c.effectiveFilterHeight,_=c.effectiveFilterWidth,C=N-1-c.padInfo.front,k=_-1-c.padInfo.left,I=S-1-c.padInfo.top,T=Qt(s.shape,"float32"),j=1/(g*m*x),E=r.bufferSync(a);for(let O=0;O<c.batchSize;++O)for(let M=0;M<c.inChannels;++M)for(let W=0;W<c.inDepth;++W)for(let q=0;q<c.inHeight;++q)for(let P=0;P<c.inWidth;++P){let A=W-C,L=q-I,z=P-k,$=0;for(let V=0;V<N;V+=y){let B=(A+V)/h;if(!(B<0||B>=c.outDepth||Math.floor(B)!==B))for(let Y=0;Y<S;Y+=v){let re=(L+Y)/p;if(!(re<0||re>=c.outHeight||Math.floor(re)!==re))for(let ae=0;ae<_;ae+=b){let K=(z+ae)/f;if(K<0||K>=c.outWidth||Math.floor(K)!==K)continue;let J=E.get(O,B,re,K,M);$+=J}}}T.set($*j,O,W,q,P,M)}return r.makeTensorInfo(T.shape,T.dtype,T.values)}var R5e={kernelName:h0,backendName:"cpu",kernelFunc:$5e};function D5e(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,i=s;mt([a,s],"avgPoolGrad");let{filterSize:o,strides:u,pad:d}=n,c=H.computePool2DInfo(i.shape,o,u,1,d),h=c.strideHeight,p=c.strideWidth,f=c.filterHeight,g=c.filterWidth,m=c.dilationHeight,x=c.dilationWidth,y=c.effectiveFilterHeight,v=c.effectiveFilterWidth,b=v-1-c.padInfo.left,N=y-1-c.padInfo.top,S=Qt(i.shape,"float32"),_=1/(f*g),C=r.data.get(a.dataId).values,k=Qt(a.shape,"float32",C);for(let I=0;I<c.batchSize;++I)for(let T=0;T<c.inChannels;++T)for(let j=0;j<c.inHeight;++j)for(let E=0;E<c.inWidth;++E){let O=j-N,M=E-b,W=0;for(let q=0;q<y;q+=m){let P=(O+q)/h;if(!(P<0||P>=c.outHeight||Math.floor(P)!==P))for(let A=0;A<v;A+=x){let L=(M+A)/p;if(L<0||L>=c.outWidth||Math.floor(L)!==L)continue;let z=k.get(I,P,L,T);W+=z}}S.set(W*_,I,j,E,T)}return r.makeTensorInfo(S.shape,S.dtype,S.values)}var M5e={kernelName:d0,backendName:"cpu",kernelFunc:D5e};function F5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,scale:s,offset:i,mean:o,variance:u}=t;R.assert(o.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R.assert(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),mt([a,o,u,s,i],"batchNorm");let{varianceEpsilon:d}=n;d==null&&(d=.001);let c=r.data.get(a.dataId).values,h=r.data.get(o.dataId).values,p=r.data.get(u.dataId).values,f=s?r.data.get(s.dataId).values:new Float32Array([1]),g=i?r.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),x=g.length,y=f.length,v=p.length,b=h.length,N=0,S=0,_=0,C=0;for(let k=0;k<c.length;++k)m[k]=g[N++]+(c[k]-h[S++])*f[_++]/Math.sqrt(p[C++]+d),N>=x&&(N=0),S>=b&&(S=0),_>=y&&(_=0),C>=v&&(C=0);return r.makeTensorInfo(a.shape,a.dtype,m)}var O5e={kernelName:Sp,backendName:"cpu",kernelFunc:F5e};function P5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockShape:s,crops:i}=n;mt([a],"batchToSpaceND");let o=s.reduce((y,v)=>y*v),u=H.getReshaped(a.shape,s,o),d=H.getPermuted(u.length,s.length),c=H.getReshapedPermuted(a.shape,s,o),h=H.getSliceBeginCoords(i,s.length),p=H.getSliceSize(c,i,s.length),f=Zr({inputs:{x:a},backend:r,attrs:{shape:u}}),g=bs({inputs:{x:f},backend:r,attrs:{perm:d}}),m=Zr({inputs:{x:g},backend:r,attrs:{shape:c}}),x=Mh({inputs:{x:m},backend:r,attrs:{begin:h,size:p}});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),x}var L5e={kernelName:rx,backendName:"cpu",kernelFunc:P5e};function z5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,weights:s}=t,{size:i}=n,o=r.data.get(a.dataId).values,u=r.data.get(s.dataId).values,d=MF(o,u,s.dtype,s.shape,i);return r.makeTensorInfo([i],s.dtype,d)}var B5e={kernelName:nx,backendName:"cpu",kernelFunc:z5e};function U5e(e){let{inputs:t,backend:r}=e,{s0:n,s1:a}=t,s=r.data.get(n.dataId).values,i=r.data.get(a.dataId).values,o=H.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return r.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var W5e={kernelName:p0,backendName:"cpu",kernelFunc:U5e},V5e=$r(Jc,(e,t)=>{let r=t;return e>r.clipValueMax?r.clipValueMax:e<r.clipValueMin?r.clipValueMin:e}),H5e={kernelName:Jc,backendName:"cpu",kernelFunc:V5e},q5e=e=>{let{x:t}=e.inputs,r=e.backend,n=new Float32Array(R.sizeFromShape(t.shape)),a=r.data.get(t.dataId),s=a.complexTensorInfos.real,i=a.complexTensorInfos.imag,o=r.data.get(s.dataId).values,u=r.data.get(i.dataId).values;for(let d=0;d<o.length;d++){let c=o[d],h=u[d];n[d]=Math.hypot(c,h)}return r.makeOutput(n,t.shape,"float32")},G5e={kernelName:f0,backendName:"cpu",kernelFunc:q5e};function wg(e){let{inputs:t,backend:r}=e,{input:n}=t,a=r.data.get(n.dataId).complexTensorInfos.imag,s=r.data.get(a.dataId).values;return r.makeTensorInfo(a.shape,a.dtype,s)}var K5e={kernelName:bk,backendName:"cpu",kernelFunc:wg};function Ng(e){let{inputs:t,backend:r,attrs:n}=e,{axis:a}=n,s=R.parseAxisParam(a,t[0].shape)[0],i=t.map(m=>m.shape);H.assertParamsConsistent(i,s);let o=H.computeOutShape(t.map(m=>m.shape),s);if(R.sizeFromShape(o)===0)return r.makeTensorInfo(o,t[0].dtype,[]);let u=t.filter(m=>R.sizeFromShape(m.shape)>0);if(u.length===1)return ml({inputs:{x:u[0]},backend:r});if(u[0].dtype==="complex64"){let m=u.map(N=>Dh({inputs:{input:N},backend:r})),x=u.map(N=>wg({inputs:{input:N},backend:r})),y=Ng({inputs:m,backend:r,attrs:{axis:s}}),v=Ng({inputs:x,backend:r,attrs:{axis:s}}),b=Ls({inputs:{real:y,imag:v},backend:r});return m.forEach(N=>r.disposeIntermediateTensorInfo(N)),x.forEach(N=>r.disposeIntermediateTensorInfo(N)),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(v),b}let d=u.map(m=>{let x=[-1,R.sizeFromShape(m.shape.slice(s))];return Zr({inputs:{x:m},backend:r,attrs:{shape:x}})}),c=d.map(m=>({vals:r.data.get(m.dataId).values,shape:m.shape}));o=H.computeOutShape(d.map(m=>m.shape),1);let h=d[0].shape[0]===1,p=FF(c,o,t[0].dtype,h),f=H.computeOutShape(u.map(m=>m.shape),s),g=r.makeTensorInfo(f,t[0].dtype,p);return d.forEach(m=>r.disposeIntermediateTensorInfo(m)),g}var Q5e={kernelName:sx,backendName:"cpu",kernelFunc:Ng};function oZ(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dataFormat:u,dilations:d,dimRoundingMode:c}=n;mt([a,s],"conv2d");let h=H.convertConv2DDataFormat(u),p=H.computeConv2DInfo(a.shape,s.shape,i,d,o,c,!1,h),f=p.filterHeight,g=p.filterWidth,m=p.dilationHeight,x=p.dilationWidth,y=p.padInfo.left,v=p.padInfo.top,b=p.dataFormat==="channelsLast",N=new zn(p.outShape,a.dtype),S=R.computeStrides(a.shape),_=R.computeStrides(s.shape),C=S[0],k=b?S[1]:S[2],I=b?S[2]:1,T=b?1:S[1],j=N.strides[0],E=b?N.strides[1]:N.strides[2],O=b?N.strides[2]:1,M=b?1:N.strides[1],W=r.data.get(a.dataId).values,q=r.data.get(s.dataId).values,P=N.values;for(let A=0;A<p.batchSize;++A){let L=A*C,z=A*j;for(let $=0;$<p.outHeight;++$){let V=z+$*E,B=$*p.strideHeight-v;for(let Y=0;Y<f;++Y){let re=B+Y*m;if(re<0||re>=p.inHeight)continue;let ae=Y*_[0],K=L+re*k;for(let J=0;J<p.outWidth;++J){let Z=V+J*O,Q=J*p.strideWidth-y;for(let U=0;U<g;++U){let F=Q+U*x;if(F<0||F>=p.inWidth)continue;let te=ae+U*_[1],pe=K+F*I,ve=te;for(let fe=0;fe<p.inChannels;++fe){let Me=W[pe+fe*T];for(let je=0;je<p.outChannels;++je)P[Z+je*M]+=Me*q[ve+je];ve+=p.outChannels}}}}}}return r.makeTensorInfo(N.shape,N.dtype,P)}var X5e={kernelName:lp,backendName:"cpu",kernelFunc:oZ};function Y5e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,dy:s}=t,{strides:i,pad:o,dataFormat:u,dimRoundingMode:d,filterShape:c}=n;mt([a,s],"conv2dBackpropFilter");let h=H.convertConv2DDataFormat(u),p=H.computeConv2DInfo(a.shape,c,i,1,o,d,!1,h),{strideHeight:f,strideWidth:g,filterHeight:m,filterWidth:x}=p,y=p.dataFormat==="channelsLast",v=new zn(p.filterShape,"float32"),b=p.padInfo.left,N=p.padInfo.top,S=r.data.get(a.dataId).values,_=r.data.get(s.dataId).values,C=new zn(a.shape,a.dtype,S),k=new zn(s.shape,s.dtype,_);for(let I=0;I<m;++I){let T=Math.max(0,Math.ceil((N-I)/f)),j=Math.min(p.outHeight,(p.inHeight+N-I)/f);for(let E=0;E<x;++E){let O=Math.max(0,Math.ceil((b-E)/g)),M=Math.min(p.outWidth,(p.inWidth+b-E)/g);for(let W=0;W<p.inChannels;++W)for(let q=0;q<p.outChannels;++q){let P=0;for(let A=0;A<p.batchSize;++A)for(let L=T;L<j;++L){let z=I+L*f-N;for(let $=O;$<M;++$){let V=E+$*g-b;y?P+=C.get(A,z,V,W)*k.get(A,L,$,q):P+=C.get(A,W,z,V)*k.get(A,q,L,$)}}v.set(P,I,E,W,q)}}}return r.makeTensorInfo(v.shape,v.dtype,v.values)}var J5e={kernelName:pk,backendName:"cpu",kernelFunc:Y5e};function Z5e(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,filter:s}=t,{inputShape:i,strides:o,pad:u,dataFormat:d,dimRoundingMode:c}=n;mt([a,s],"conv2dBackpropInput");let h=R.computeStrides(s.shape),p=R.computeStrides(a.shape),f=H.convertConv2DDataFormat(d),g=H.computeConv2DInfo(i,s.shape,o,1,u,c,!1,f),m=new zn(g.inShape,"float32"),x=m.values,y=r.data.get(a.dataId).values,v=r.data.get(s.dataId).values,[b,N,S]=h,{batchSize:_,filterHeight:C,filterWidth:k,inChannels:I,inHeight:T,inWidth:j,outChannels:E,outHeight:O,outWidth:M,strideHeight:W,strideWidth:q}=g;f=g.dataFormat;let P=C-1-g.padInfo.top,A=k-1-g.padInfo.left,L=f==="channelsLast",z=m.strides[0],$=L?m.strides[1]:m.strides[2],V=L?m.strides[2]:1,B=L?1:m.strides[1],Y=p[0],re=L?p[1]:p[2],ae=L?p[2]:1,K=L?1:p[1];for(let J=0;J<_;++J)for(let Z=0;Z<I;++Z)for(let Q=0;Q<T;++Q){let U=Q-P,F=Math.max(0,Math.ceil(U/W)),te=Math.min(O,(C+U)/W);for(let pe=0;pe<j;++pe){let ve=pe-A,fe=Math.max(0,Math.ceil(ve/q)),Me=Math.min(M,(k+ve)/q),je=0;for(let ft=F;ft<te;++ft){let Ot=ft*W-U;for(let yt=fe;yt<Me;++yt){let De=yt*q-ve,Fe=Y*J+re*ft+ae*yt,et=b*(C-1-Ot)+N*(k-1-De)+S*Z;for(let Ae=0;Ae<E;++Ae){let He=y[Fe+K*Ae],st=v[et+Ae];je+=He*st}}}let Qe=z*J+$*Q+V*pe+B*Z;x[Qe]=je}}return r.makeTensorInfo(m.shape,m.dtype,m.values)}var eBe={kernelName:up,backendName:"cpu",kernelFunc:Z5e};function tBe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:u}=n;mt([a,s],"conv3d");let d=H.computeConv3DInfo(a.shape,s.shape,i,u,o),{filterDepth:c,filterHeight:h,filterWidth:p,dilationDepth:f,dilationHeight:g,dilationWidth:m,padInfo:x}=d,y=x.front,v=x.left,b=x.top,N=new zn(d.outShape,a.dtype),S=r.data.get(a.dataId).values,_=r.data.get(s.dataId).values,C=N.values,k=R.computeStrides(a.shape),I=R.computeStrides(s.shape);for(let T=0;T<d.batchSize;++T){let j=T*k[0],E=T*N.strides[0];for(let O=0;O<d.outDepth;++O){let M=E+O*N.strides[1],W=O*d.strideDepth-y;for(let q=0;q<c;++q){let P=W+q*f;if(P<0||P>=d.inDepth)continue;let A=q*I[0],L=j+P*k[1];for(let z=0;z<d.outHeight;++z){let $=M+z*N.strides[2],V=z*d.strideHeight-b;for(let B=0;B<h;++B){let Y=V+B*g;if(Y<0||Y>=d.inHeight)continue;let re=A+B*I[1],ae=L+Y*k[2];for(let K=0;K<d.outWidth;++K){let J=$+K*d.outChannels,Z=K*d.strideWidth-v;for(let Q=0;Q<p;++Q){let U=Z+Q*m;if(U<0||U>=d.inWidth)continue;let F=re+Q*I[2],te=ae+U*d.inChannels,pe=F;for(let ve=0;ve<d.inChannels;++ve){let fe=S[te+ve];for(let Me=0;Me<d.outChannels;++Me)C[J+Me]+=fe*_[pe+Me];pe+=d.outChannels}}}}}}}}return r.makeTensorInfo(N.shape,N.dtype,N.values)}var rBe={kernelName:cp,backendName:"cpu",kernelFunc:tBe};function nBe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,dy:s}=t,{strides:i,pad:o,filterShape:u}=n;mt([a,s],"conv3dBackpropFilterV2");let d=R.computeStrides(a.shape),c=R.computeStrides(s.shape),h=H.computeConv3DInfo(a.shape,u,i,1,o),p=h.strideDepth,f=h.strideHeight,g=h.strideWidth,m=h.filterDepth,x=h.filterHeight,y=h.filterWidth,v=new zn(h.filterShape,"float32"),b=v.values,[N,S,_,C]=v.strides,k=r.data.get(s.dataId).values,[I,T,j,E]=c,O=r.data.get(a.dataId).values,[M,W,q,P]=d,A=h.padInfo.front,L=h.padInfo.left,z=h.padInfo.top;for(let $=0;$<m;++$){let V=Math.max(0,Math.ceil((A-$)/p)),B=Math.min(h.outDepth,(h.inDepth+A-$)/p),Y=$*N;for(let re=0;re<x;++re){let ae=Math.max(0,Math.ceil((z-re)/f)),K=Math.min(h.outHeight,(h.inHeight+z-re)/f),J=re*S+Y;for(let Z=0;Z<y;++Z){let Q=Math.max(0,Math.ceil((L-Z)/g)),U=Math.min(h.outWidth,(h.inWidth+L-Z)/g),F=Z*_+J;for(let te=0;te<h.inChannels;++te){let pe=te*C+F;for(let ve=0;ve<h.outChannels;++ve){let fe=0;for(let Me=0;Me<h.batchSize;++Me){let je=Me*M,Qe=Me*I;for(let ft=V;ft<B;++ft){let Ot=($+ft*p-A)*W+je,yt=ft*T+Qe;for(let De=ae;De<K;++De){let Fe=(re+De*f-z)*q+Ot,et=De*j+yt;for(let Ae=Q;Ae<U;++Ae){let He=(Z+Ae*g-L)*P+Fe,st=Ae*E+et;fe+=O[He+te]*k[st+ve]}}}}b[pe+ve]=fe}}}}}return r.makeTensorInfo(v.shape,v.dtype,v.values)}var aBe={kernelName:ix,backendName:"cpu",kernelFunc:nBe};function sBe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,filter:s}=t,{pad:i,strides:o,inputShape:u}=n;mt([a],"conv3dBackpropInputV2");let d=R.computeStrides(a.shape),c=R.computeStrides(s.shape),h=H.computeConv3DInfo(u,s.shape,o,1,i),p=new zn(h.inShape,"float32"),f=p.values,[g,m,x,y]=p.strides,v=r.data.get(a.dataId).values,[b,N,S,_]=d,C=r.data.get(s.dataId).values,[k,I,T,j]=c,{batchSize:E,filterDepth:O,filterHeight:M,filterWidth:W,inChannels:q,inDepth:P,inHeight:A,inWidth:L,outChannels:z,outDepth:$,outHeight:V,outWidth:B,strideDepth:Y,strideHeight:re,strideWidth:ae}=h,K=O-1-h.padInfo.front,J=M-1-h.padInfo.top,Z=W-1-h.padInfo.left;for(let Q=0;Q<E;++Q)for(let U=0;U<q;++U)for(let F=0;F<P;++F){let te=F-K,pe=Math.max(0,Math.ceil(te/Y)),ve=Math.min($,(O+te)/Y);for(let fe=0;fe<A;++fe){let Me=fe-J,je=Math.max(0,Math.ceil(Me/re)),Qe=Math.min(V,(M+Me)/re);for(let ft=0;ft<L;++ft){let Ot=ft-Z,yt=Math.max(0,Math.ceil(Ot/ae)),De=Math.min(B,(W+Ot)/ae),Fe=0;for(let et=pe;et<ve;++et){let Ae=et*Y-te;for(let He=je;He<Qe;++He){let st=He*re-Me;for(let kt=yt;kt<De;++kt){let Vt=kt*ae-Ot,ur=b*Q+N*et+S*He+_*kt,we=k*(O-1-Ae)+I*(M-1-st)+T*(W-1-Vt)+j*U;for(let wr=0;wr<z;++wr){let nr=v[ur+wr],Zt=C[we+wr];Fe+=nr*Zt}}}}f[g*Q+m*F+x*fe+y*ft+U]=Fe}}}return r.makeTensorInfo(p.shape,p.dtype,p.values)}var iBe={kernelName:ox,backendName:"cpu",kernelFunc:sBe},oBe=$r(dp,e=>Math.cos(e)),lBe={kernelName:dp,backendName:"cpu",kernelFunc:oBe},uBe=$r(hp,e=>Math.cosh(e)),cBe={kernelName:hp,backendName:"cpu",kernelFunc:uBe};function dBe(e){let{inputs:t,backend:r,attrs:n}=e,{image:a,boxes:s,boxInd:i}=t,{cropSize:o,method:u,extrapolationValue:d}=n,[c,h,p,f]=a.shape,g=s.shape[0],[m,x]=o,y=Qt([g,m,x,f],"float32"),v=r.data.get(s.dataId).values,b=r.data.get(i.dataId).values,N=r.data.get(a.dataId).values,S=R.computeStrides(a.shape),_=R.computeStrides(y.shape);for(let C=0;C<g;C++){let k=C*4,I=v[k],T=v[k+1],j=v[k+2],E=v[k+3],O=b[C];if(O>=c)continue;let M=m>1?(j-I)*(h-1)/(m-1):0,W=x>1?(E-T)*(p-1)/(x-1):0;for(let q=0;q<m;q++){let P=m>1?I*(h-1)+q*M:.5*(I+j)*(h-1);if(P<0||P>h-1){for(let A=0;A<x;A++)for(let L=0;L<f;L++){let z=L+A*_[2]+q*_[1]+C*_[0];y.values[z]=d}continue}if(u==="bilinear"){let A=Math.floor(P),L=Math.ceil(P),z=P-A;for(let $=0;$<x;$++){let V=x>1?T*(p-1)+$*W:.5*(T+E)*(p-1);if(V<0||V>p-1){for(let ae=0;ae<f;ae++){let K=ae+$*_[2]+q*_[1]+C*_[0];y.values[K]=d}continue}let B=Math.floor(V),Y=Math.ceil(V),re=V-B;for(let ae=0;ae<f;ae++){let K=ae+B*S[2]+A*S[1]+O*S[0],J=N[K];K=ae+Y*S[2]+A*S[1]+O*S[0];let Z=N[K];K=ae+B*S[2]+L*S[1]+O*S[0];let Q=N[K];K=ae+Y*S[2]+L*S[1]+O*S[0];let U=N[K],F=J+(Z-J)*re,te=Q+(U-Q)*re;K=ae+$*_[2]+q*_[1]+C*_[0],y.values[K]=F+(te-F)*z}}}else for(let A=0;A<x;++A){let L=x>1?T*(p-1)+A*W:.5*(T+E)*(p-1);if(L<0||L>p-1){for(let V=0;V<f;V++){let B=V+A*_[2]+q*_[1]+C*_[0];y.values[B]=d}continue}let z=Math.round(L),$=Math.round(P);for(let V=0;V<f;V++){let B=V+z*S[2]+$*S[1]+O*S[0],Y=V+A*_[2]+q*_[1]+C*_[0];y.values[Y]=N[B]}}}}return r.makeTensorInfo(y.shape,y.dtype,y.values)}var hBe={kernelName:ux,backendName:"cpu",kernelFunc:dBe};function pBe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=n;mt(a,"cumprod");let u=H.getAxesPermutation([s],a.shape.length),d=a;u!=null&&(d=bs({inputs:{x:a},backend:r,attrs:{perm:u}}));let c=H.getInnerMostAxes(1,a.shape.length)[0];if(c!==d.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${c}`);let h=wi(d.dtype,"int32"),p=R.makeOnesTypedArray(R.sizeFromShape(d.shape),h),f=r.data.get(d.dataId).values,g=d.shape[d.shape.length-1],m=o?(y,v)=>y+g-v-1:(y,v)=>y+v;for(let y=0;y<f.length;y+=g)for(let v=0;v<g;v++){let b=m(y,v);if(v===0)p[b]=i?1:f[b];else{let N=m(y,v-1);p[b]=i?f[N]*p[N]:f[b]*p[N]}}let x=r.makeTensorInfo(d.shape,h,p);if(u!=null){let y=H.getUndoAxesPermutation(u),v=bs({inputs:{x},backend:r,attrs:{perm:y}});return r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(d),v}return x}var fBe={kernelName:lx,backendName:"cpu",kernelFunc:pBe};function mBe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=n;mt(a,"cumsum");let u=H.getAxesPermutation([s],a.shape.length),d=a;u!=null&&(d=bs({inputs:{x:a},backend:r,attrs:{perm:u}}));let c=H.getInnerMostAxes(1,a.shape.length)[0];if(c!==d.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${c}`);let h=wi(d.dtype,"int32"),p=R.makeZerosTypedArray(R.sizeFromShape(d.shape),h),f=r.data.get(d.dataId).values,g=d.shape[d.shape.length-1],m=o?(y,v)=>y+g-v-1:(y,v)=>y+v;for(let y=0;y<f.length;y+=g)for(let v=0;v<g;v++){let b=m(y,v);if(v===0)p[b]=i?0:f[b];else{let N=m(y,v-1);p[b]=i?f[N]+p[N]:f[b]+p[N]}}let x=r.makeTensorInfo(d.shape,h,p);if(u!=null){let y=H.getUndoAxesPermutation(u),v=bs({inputs:{x},backend:r,attrs:{perm:y}});return r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(d),v}return x}var gBe={kernelName:pp,backendName:"cpu",kernelFunc:mBe};function xBe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,weights:s}=t,{size:i,binaryOutput:o}=n;if(a.shape.length===1){let u=r.data.get(a.dataId).values,d=r.data.get(s.dataId).values,c=MF(u,d,s.dtype,s.shape,i);return r.makeTensorInfo([i],s.dtype,c)}else if(a.shape.length===2){let u=r.bufferSync(a),d=r.bufferSync(s),c=mJ(u,d,i,o);return r.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}var yBe={kernelName:m0,backendName:"cpu",kernelFunc:xBe};function vBe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockSize:s,dataFormat:i}=n;R.assert(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);let o=a.shape[0],u=a.shape[1],d=a.shape[2],c=a.shape[3],h=u*s,p=d*s,f=c/(s*s),g=r.data.get(a.dataId).values,m=new Float32Array(o*h*p*f),x=0;for(let y=0;y<o;++y)for(let v=0;v<h;++v){let b=Math.floor(v/s),N=v%s;for(let S=0;S<p;++S){let _=Math.floor(S/s),C=S%s,k=(N*s+C)*f;for(let I=0;I<f;++I){let T=I+k+c*(_+d*(b+u*y));m[x++]=g[T]}}}return r.makeTensorInfo([o,h,p,f],a.dtype,m)}var bBe={kernelName:cx,backendName:"cpu",kernelFunc:vBe};function lZ(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:u,dimRoundingMode:d}=n;mt([a,s],"depthwiseConv2DNative");let c=R.computeStrides(a.shape),h=R.computeStrides(s.shape),p=u;p==null&&(p=[1,1]),R.assert(H.eitherStridesOrDilationsAreOne(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);let f=H.computeConv2DInfo(a.shape,s.shape,i,p,o,d,!0),{filterHeight:g,filterWidth:m,dilationHeight:x,dilationWidth:y,padInfo:v}=f,b=v.left,N=v.top,S=f.outChannels/f.inChannels,_=new zn(f.outShape,a.dtype),C=r.data.get(a.dataId).values,k=r.data.get(s.dataId).values,I=_.values;for(let T=0;T<f.batchSize;++T){let j=T*c[0],E=T*_.strides[0];for(let O=0;O<f.outHeight;++O){let M=E+O*_.strides[1],W=O*f.strideHeight-N;for(let q=0;q<g;++q){let P=W+q*x;if(P<0||P>=f.inHeight)continue;let A=q*h[0],L=j+P*c[1];for(let z=0;z<f.outWidth;++z){let $=M+z*_.strides[2],V=z*f.strideWidth-b;for(let B=0;B<m;++B){let Y=V+B*y;if(Y<0||Y>=f.inWidth)continue;let re=A+B*h[1],ae=L+Y*f.inChannels,K=$,J=re;for(let Z=0;Z<f.inChannels;++Z){let Q=C[ae+Z];for(let U=0;U<S;++U)I[K+U]+=Q*k[J+U];K+=S,J+=S}}}}}}return r.makeTensorInfo(_.shape,_.dtype,_.values)}var wBe={kernelName:fp,backendName:"cpu",kernelFunc:lZ};function NBe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,dy:s}=t,{strides:i,dilations:o,pad:u,dimRoundingMode:d,filterShape:c}=n;mt([a,s],"depthwiseConv2dNativeBackpropFilter");let h=H.computeConv2DInfo(a.shape,c,i,o,u,d,!0),{strideHeight:p,strideWidth:f,filterHeight:g,filterWidth:m}=h,x=new zn(h.filterShape,"float32"),y=h.padInfo.left,v=h.padInfo.top,b=h.outChannels/h.inChannels,N=r.data.get(a.dataId).values,S=new zn(a.shape,a.dtype,N),_=r.data.get(s.dataId).values,C=new zn(s.shape,s.dtype,_);for(let k=0;k<g;++k){let I=Math.max(0,Math.ceil((v-k)/p)),T=Math.min(h.outHeight,(h.inHeight+v-k)/p);for(let j=0;j<m;++j){let E=Math.max(0,Math.ceil((y-j)/f)),O=Math.min(h.outWidth,(h.inWidth+y-j)/f);for(let M=0;M<h.outChannels;++M){let W=Math.trunc(M/b),q=M%b,P=0;for(let A=0;A<h.batchSize;++A)for(let L=I;L<T;++L){let z=k+L*p-v;for(let $=E;$<O;++$){let V=j+$*f-y;P+=S.get(A,z,V,W)*C.get(A,L,$,M)}}x.set(P,k,j,W,q)}}}return r.makeTensorInfo(x.shape,x.dtype,x.values)}var SBe={kernelName:fk,backendName:"cpu",kernelFunc:NBe};function _Be(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,filter:s}=t,{strides:i,dilations:o,pad:u,dimRoundingMode:d,inputShape:c}=n;mt([a,s],"depthwiseConv2DNativeBackpropInput");let h=R.computeStrides(a.shape),p=R.computeStrides(s.shape),f=H.computeConv2DInfo(c,s.shape,i,o,u,d,!0),g=new zn(f.inShape,"float32"),m=g.values,[x,y,v]=g.strides,b=r.data.get(a.dataId).values,[N,S,_]=h,C=r.data.get(s.dataId).values,[k,I,T]=p,{batchSize:j,filterHeight:E,filterWidth:O,inChannels:M,inHeight:W,inWidth:q,outChannels:P,outHeight:A,outWidth:L,strideHeight:z,strideWidth:$}=f,V=E-1-f.padInfo.top,B=O-1-f.padInfo.left,Y=P/M;for(let re=0;re<j;++re)for(let ae=0;ae<M;++ae)for(let K=0;K<W;++K){let J=K-V,Z=Math.max(0,Math.ceil(J/z)),Q=Math.min(A,(E+J)/z);for(let U=0;U<q;++U){let F=U-B,te=Math.max(0,Math.ceil(F/$)),pe=Math.min(L,(O+F)/$),ve=0;for(let fe=Z;fe<Q;++fe){let Me=fe*z-J;for(let je=te;je<pe;++je){let Qe=je*$-F,ft=N*re+S*fe+_*je,Ot=k*(E-1-Me)+I*(O-1-Qe)+T*ae;for(let yt=0;yt<Y;++yt){let De=ae*Y+yt,Fe=b[ft+De],et=C[Ot+yt];ve+=Fe*et}}}m[x*re+y*K+v*U+ae]=ve}}return r.makeTensorInfo(g.shape,g.dtype,g.values)}var kBe={kernelName:mk,backendName:"cpu",kernelFunc:_Be};function CBe(e){let{inputs:t,backend:r}=e,{x:n}=t,a=R.sizeFromShape(n.shape),s=r.data.get(n.dataId).values,i=Qt([a,a],n.dtype),o=i.values;for(let d=0;d<s.length;d++)o[d*a+d]=s[d];let u=[...n.shape,...n.shape];return r.makeTensorInfo(u,i.dtype,i.values)}var IBe={kernelName:g0,backendName:"cpu",kernelFunc:CBe},EBe={kernelName:mp,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:r})=>{let{x:n,filter:a}=e,{strides:s,pad:i,dilations:o}=r,u=t,d=u.data.get(n.dataId).values,c=n.shape.length,h=u.data.get(a.dataId).values,p=a.shape.length,{batchSize:f,inHeight:g,inWidth:m,inChannels:x,outHeight:y,outWidth:v,padInfo:b,strideHeight:N,strideWidth:S,filterHeight:_,filterWidth:C,dilationHeight:k,dilationWidth:I,outShape:T}=H.computeDilation2DInfo(n.shape,a.shape,s,i,"NHWC",o),j=R.sizeFromShape(T),E=T.length,O=R.getArrayFromDType(n.dtype,j);for(let M=0;M<f;++M)for(let W=0;W<y;++W){let q=W*N-b.top;for(let P=0;P<v;++P){let A=P*S-b.left;for(let L=0;L<x;++L){let z=Number.MIN_SAFE_INTEGER;for(let V=0;V<_;++V){let B=q+V*k;if(B>=0&&B<g)for(let Y=0;Y<C;++Y){let re=A+Y*I;if(re>=0&&re<m){let ae=R.locToIndex([M,B,re,L],c,R.computeStrides(n.shape)),K=R.locToIndex([V,Y,L],p,R.computeStrides(a.shape)),J=d[ae]+h[K];J>z&&(z=J)}}}let $=R.locToIndex([M,W,P,L],E,R.computeStrides(T));O[$]=z}}}return{dataId:u.write(R.toTypedArray(O,n.dtype),T,n.dtype),shape:T,dtype:n.dtype}}},TBe={kernelName:lg,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:r})=>{let{x:n,filter:a,dy:s}=e,{strides:i,pad:o,dilations:u}=r,d=t,c=R.toNestedArray(n.shape,d.data.get(n.dataId).values),h=R.toNestedArray(a.shape,d.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:g,inChannels:m,outHeight:x,outWidth:y,padInfo:v,strideHeight:b,strideWidth:N,filterHeight:S,filterWidth:_,dilationHeight:C,dilationWidth:k,outShape:I}=H.computeDilation2DInfo(n.shape,a.shape,i,o,"NHWC",u);R.assert(s.rank===I.length,()=>`Error in ${lg}, dy must have the same rank as output ${I.length}, but got ${s.rank}`);let T=R.toNestedArray(I,d.data.get(s.dataId).values),j=R.makeZerosNestedTypedArray(a.shape,a.dtype);for(let E=0;E<p;++E)for(let O=0;O<x;++O){let M=O*b-v.top;for(let W=0;W<y;++W){let q=W*N-v.left;for(let P=0;P<m;++P){let A=Number.MIN_SAFE_INTEGER,L=0,z=0;for(let $=0;$<S;++$){let V=M+$*C;if(V>=0&&V<f)for(let B=0;B<_;++B){let Y=q+B*k;if(Y>=0&&Y<g){let re=c[E][V][Y][P]+h[$][B][P];re>A&&(A=re,L=$,z=B)}}}j[L][z][P]+=T[E][O][W][P]}}}return{dataId:d.write(R.toTypedArray(j,n.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},jBe={kernelName:og,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:r})=>{let{x:n,filter:a,dy:s}=e,{strides:i,pad:o,dilations:u}=r,d=t,c=R.toNestedArray(n.shape,d.data.get(n.dataId).values),h=R.toNestedArray(a.shape,d.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:g,inChannels:m,outHeight:x,outWidth:y,padInfo:v,strideHeight:b,strideWidth:N,filterHeight:S,filterWidth:_,dilationHeight:C,dilationWidth:k,outShape:I}=H.computeDilation2DInfo(n.shape,a.shape,i,o,"NHWC",u);R.assert(s.rank===I.length,()=>`Error in ${og}, dy must have the same rank as output ${I.length}, but got ${s.rank}`);let T=R.toNestedArray(I,d.data.get(s.dataId).values),j=R.makeZerosNestedTypedArray(n.shape,n.dtype);for(let E=0;E<p;++E)for(let O=0;O<x;++O){let M=O*b-v.top;for(let W=0;W<y;++W){let q=W*N-v.left;for(let P=0;P<m;++P){let A=Number.MIN_SAFE_INTEGER,L=M<0?0:M,z=q<0?0:q;for(let $=0;$<S;++$){let V=M+$*C;if(V>=0&&V<f)for(let B=0;B<_;++B){let Y=q+B*k;if(Y>=0&&Y<g){let re=c[E][V][Y][P]+h[$][B][P];re>A&&(A=re,L=V,z=Y)}}}j[E][L][z][P]+=T[E][O][W][P]}}}return{dataId:d.write(R.toTypedArray(j,n.dtype),n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};function ABe(e){let{inputs:t,backend:r,attrs:n}=e,{image:a}=t,{canvas:s,options:i}=n,{contextOptions:o,imageOptions:u}=i||{},d=(u==null?void 0:u.alpha)||1,c=(o==null?void 0:o.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);let h=s.getContext(c,(o==null?void 0:o.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${c} type.`);let[p,f]=a.shape.slice(0,2),g=a.shape.length===2?1:a.shape[2],m=r.data.get(a.dataId).values,x=a.dtype==="float32"?255:1,y=new Uint8ClampedArray(f*p*4);for(let b=0;b<p*f;++b){let N=[0,0,0,255*d];for(let _=0;_<g;_++){let C=m[b*g+_];if(a.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(a.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);g===1?(N[0]=C*x,N[1]=C*x,N[2]=C*x):N[_]=C*x}let S=b*4;y[S+0]=Math.round(N[0]),y[S+1]=Math.round(N[1]),y[S+2]=Math.round(N[2]),y[S+3]=Math.round(N[3])}s.width=f,s.height=p;let v=new ImageData(y,f,p);return h.putImageData(v,0,0),a}var $Be={kernelName:gk,backendName:"cpu",kernelFunc:ABe};function iw(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n;mt(a,"sum");let o;a.dtype==="bool"?o=Pc({inputs:{x:a},backend:r,attrs:{dtype:"int32"}}):o=ml({inputs:{x:a},backend:r});let u=o.shape.length,d=R.parseAxisParam(s,o.shape),c=H.getAxesPermutation(d,u),h=d,p=o;c!=null&&(p=bs({inputs:{x:o},backend:r,attrs:{perm:c}}),h=H.getInnerMostAxes(h.length,u)),H.assertAxesAreInnerMostDims("sum",h,p.shape.length);let[f,g]=H.computeOutAndReduceShapes(p.shape,h),m=H.upcastType(p.dtype,"int32"),x=NS(r,f,m),y=R.sizeFromShape(g),v=r.data.get(x.dataId).values,b=r.data.get(p.dataId).values;for(let N=0;N<v.length;++N){let S=N*y,_=0;for(let C=0;C<y;++C)_+=b[S+C];v[N]=_}if(i){let N=H.expandShapeToKeepDim(x.shape,d),S=x;x=Zr({inputs:{x},backend:r,attrs:{shape:N}}),r.disposeIntermediateTensorInfo(S)}return r.disposeIntermediateTensorInfo(o),c!=null&&r.disposeIntermediateTensorInfo(p),x}var RBe={kernelName:uf,backendName:"cpu",kernelFunc:iw};function DBe(e){let{inputs:t,backend:r,attrs:n}=e,{equation:a}=n,s=t,{allDims:i,summedDims:o,idDims:u}=H.decodeEinsumEquation(a,s.length);H.checkEinsumDimSizes(i.length,u,s);let{path:d,steps:c}=H.getEinsumComputePath(o,u),h=c.length,p=null,f=i.length,g=[];for(let m=0;m<h;++m){for(let x of c[m]){let{permutationIndices:y,expandDims:v}=H.getEinsumPermutation(f,u[x]),b;H.isIdentityPermutation(y)?b=s[x]:(b=bs({inputs:{x:s[x]},backend:r,attrs:{perm:y}}),g.push(b));let N=b.shape.slice();for(let S=0;S<v.length;++S)N.splice(v[S],0,1);R.arraysEqual(b.shape,N)||(b=Zr({inputs:{x:b},backend:r,attrs:{shape:N}}),g.push(b)),p===null?p=b:(p=jC({inputs:{a:b,b:p},backend:r}),g.push(p))}m<h-1&&(d[m]>=0&&(p=iw({inputs:{x:p},backend:r,attrs:{axis:d[m]-(i.length-f),keepDims:!1}}),g.push(p)),f--)}for(let m of g)m!==p&&r.disposeIntermediateTensorInfo(m);return p}var MBe={kernelName:xk,backendName:"cpu",kernelFunc:DBe};function FBe(e){let{inputs:t,backend:r}=e,{dy:n,y:a}=t;mt([n,a],"eluGrad");let s=new Float32Array(R.sizeFromShape(a.shape)),i=r.data.get(a.dataId).values,o=r.data.get(n.dataId).values;for(let u=0;u<i.length;++u){let d=i[u];d>=0?s[u]=o[u]:s[u]=o[u]*(d+1)}return r.makeTensorInfo(a.shape,"float32",s)}var OBe={kernelName:dx,backendName:"cpu",kernelFunc:FBe},PBe=H.ERF_P,LBe=H.ERF_A1,zBe=H.ERF_A2,BBe=H.ERF_A3,UBe=H.ERF_A4,WBe=H.ERF_A5,VBe=$r(yp,e=>{let t=Math.sign(e),r=Math.abs(e),n=1/(1+PBe*r);return t*(1-((((WBe*n+UBe)*n+BBe)*n+zBe)*n+LBe)*n*Math.exp(-r*r))}),HBe={kernelName:yp,backendName:"cpu",kernelFunc:VBe};function kS(e){let{inputs:t,backend:r,attrs:n}=e,{input:a}=t,{dim:s}=n,i=a.shape.length,o=a.shape.slice(),u=s;return s<0&&(R.assert(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+s+1),o.splice(u,0,1),Zr({inputs:{x:a},backend:r,attrs:{shape:o}})}var qBe={kernelName:px,backendName:"cpu",kernelFunc:kS},GBe=Mn((e,t)=>e/t),GF=ea(gp,GBe),lj={kernelName:gp,backendName:"cpu",kernelFunc:GF};function uZ(e,t,r){let n=e.shape,a=n[0],s=n[1],i=r.data.get(e.dataId),o=i.complexTensorInfos.real,u=i.complexTensorInfos.imag,d=[a,s],c=R.sizeFromShape(d),h=R.getTypedArrayFromDType("float32",c),p=R.getTypedArrayFromDType("float32",c);for(let x=0;x<a;x++){let y=Mh({inputs:{x:o},backend:r,attrs:{begin:[x,0],size:[1,s]}}),v=Mh({inputs:{x:u},backend:r,attrs:{begin:[x,0],size:[1,s]}}),b=Ls({inputs:{real:y,imag:v},backend:r}),{real:N,imag:S}=KBe(b,t,r),_=H.mergeRealAndImagArrays(N,S);for(let C=0;C<s;C++){let k=H.getComplexWithIndex(_,C);h[x*s+C]=k.real,p[x*s+C]=k.imag}r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b)}let f=r.makeTensorInfo(d,"float32",h),g=r.makeTensorInfo(d,"float32",p),m=Ls({inputs:{real:f,imag:g},backend:r});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),m}function KBe(e,t,r){let n=R.sizeFromShape(e.shape),a=r.data.get(e.dataId),s=r.data.get(a.complexTensorInfos.real.dataId).values,i=r.data.get(a.complexTensorInfos.imag.dataId).values;if(QBe(n)){let o=uj(s,i,n,t,r),u=[e.shape[0],e.shape[1]];if(t){let d=r.makeTensorInfo(u,"float32",o.real),c=r.makeTensorInfo(u,"float32",o.imag),h=r.makeTensorInfo([],"float32",R.createScalarValue(n,"float32")),p=ml({inputs:{x:h},backend:r}),f=lj.kernelFunc({inputs:{a:d,b:h},backend:r}),g=lj.kernelFunc({inputs:{a:c,b:p},backend:r}),m=r.data.get(f.dataId).values,x=r.data.get(g.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(c),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),{real:m,imag:x}}return o}else{let o=H.mergeRealAndImagArrays(s,i),u=XBe(o,n,t);return H.splitRealAndImagArrays(u)}}function QBe(e){return(e&e-1)===0}function uj(e,t,r,n,a){if(r===1)return{real:e,imag:t};let s=H.mergeRealAndImagArrays(e,t),i=r/2,o=H.complexWithEvenIndex(s),u=o.real,d=o.imag,c=[u.length],h=a.makeTensorInfo(c,"float32",u),p=a.makeTensorInfo(c,"float32",d),f=Ls({inputs:{real:h,imag:p},backend:a}),g=H.complexWithOddIndex(s),m=g.real,x=g.imag,y=[m.length],v=a.makeTensorInfo(y,"float32",m),b=a.makeTensorInfo(y,"float32",x),N=Ls({inputs:{real:v,imag:b},backend:a}),S=uj(u,d,i,n,a),_=S.real,C=S.imag,k=[_.length],I=a.makeTensorInfo(k,"float32",_),T=a.makeTensorInfo(k,"float32",C),j=Ls({inputs:{real:I,imag:T},backend:a}),E=uj(m,x,i,n,a),O=E.real,M=E.imag,W=[O.length],q=a.makeTensorInfo(W,"float32",O),P=a.makeTensorInfo(W,"float32",M),A=Ls({inputs:{real:q,imag:P},backend:a}),L=H.exponents(r,n),z=[L.real.length],$=a.makeTensorInfo(z,"float32",L.real),V=a.makeTensorInfo(z,"float32",L.imag),B=Ls({inputs:{real:$,imag:V},backend:a}),Y=jC({inputs:{a:B,b:A},backend:a}),re=bg({inputs:{a:j,b:Y},backend:a}),ae=VF({inputs:{a:j,b:Y},backend:a}),K=Dh({inputs:{input:re},backend:a}),J=Dh({inputs:{input:ae},backend:a}),Z=wg({inputs:{input:re},backend:a}),Q=wg({inputs:{input:ae},backend:a}),U=Ng({inputs:[K,J],backend:a,attrs:{axis:0}}),F=Ng({inputs:[Z,Q],backend:a,attrs:{axis:0}}),te=a.data.get(U.dataId).values,pe=a.data.get(F.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(N),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo($),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(re),a.disposeIntermediateTensorInfo(ae),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(Z),a.disposeIntermediateTensorInfo(J),a.disposeIntermediateTensorInfo(Q),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(F),{real:te,imag:pe}}function XBe(e,t,r){let n=new Float32Array(t*2);for(let a=0;a<t;a++){let s=0,i=0;for(let o=0;o<t;o++){let u=H.exponent(a*o,t,r),d=H.getComplexWithIndex(e,o);s+=d.real*u.real-d.imag*u.imag,i+=d.real*u.imag+d.imag*u.real}r&&(s/=t,i/=t),H.assignToTypedArray(n,s,i,a)}return n}function YBe(e){let{inputs:t,backend:r}=e,{input:n}=t,a=R.sizeFromShape(n.shape),s=n.shape[n.shape.length-1],i=a/s,o=Zr({inputs:{x:n},backend:r,attrs:{shape:[i,s]}}),u=uZ(o,!1,r),d=Zr({inputs:{x:u},backend:r,attrs:{shape:n.shape}});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),d}var JBe={kernelName:yk,backendName:"cpu",kernelFunc:YBe};function KF(e){let{backend:t,attrs:r}=e,{shape:n,value:a,dtype:s}=r,i=s||R.inferDtype(a),o=R.getArrayFromDType(i,R.sizeFromShape(n));return eUe(o,a),t.makeTensorInfo(n,i,o)}var ZBe={kernelName:x0,backendName:"cpu",kernelFunc:KF};function eUe(e,t,r){e.fill(t)}var tUe={kernelName:fx,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:r})=>{let{image:n}=e,a=r,s=R.getTypedArrayFromDType(n.dtype,R.sizeFromShape(n.shape)),[i,o,u,d]=n.shape,c=a.data.get(n.dataId).values;for(let h=0;h<i;h++){let p=h*u*o*d;for(let f=0;f<o;f++){let g=f*(u*d);for(let m=0;m<u;m++){let x=m*d;for(let y=0;y<d;y++){let v=Math.round(u-m-1),b=p+g+x+y,N=c[b];if(v>=0&&v<u){let S=v*d,_=p+g+S+y;N=c[_]}s[b]=N}}}}return{dataId:a.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};function rUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:u,pad:d,dataFormat:c,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=n,m=oZ({inputs:{x:a,filter:s},backend:r,attrs:{strides:u,pad:d,dataFormat:c,dilations:h,dimRoundingMode:p}});if(i){let x=m;if(c==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){let y=Zr({inputs:{x:i},backend:r,attrs:{shape:[i.shape[0],1,1]}});m=bg({inputs:{a:m,b:y},backend:r}),r.disposeIntermediateTensorInfo(y)}else m=bg({inputs:{a:m,b:i},backend:r});r.disposeIntermediateTensorInfo(x)}if(f){let x=m;if(c==="NCHW"&&f==="prelu"&&o.shape.length===1&&o.shape[0]!==1){let y=Zr({inputs:{x:o},backend:r,attrs:{shape:[o.shape[0],1,1]}});m=_S(r,m,f,y,g),r.disposeIntermediateTensorInfo(y)}else m=_S(r,m,f,o,g);r.disposeIntermediateTensorInfo(x)}return m}var nUe={kernelName:Nh,backendName:"cpu",kernelFunc:rUe};function aUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:u,pad:d,dataFormat:c,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=n,m=lZ({inputs:{x:a,filter:s},backend:r,attrs:{strides:u,pad:d,dataFormat:c,dilations:h,dimRoundingMode:p}});if(i){let x=m;m=bg({inputs:{a:m,b:i},backend:r}),r.disposeIntermediateTensorInfo(x)}if(f){let x=m;m=_S(r,m,f,o,g),r.disposeIntermediateTensorInfo(x)}return m}var sUe={kernelName:Sh,backendName:"cpu",kernelFunc:aUe};function iUe(e){let{inputs:t,backend:r}=e,{params:n,indices:a}=t,s=R.sizeFromShape(n.shape),i=a.shape,o=i[i.length-1],[u,d,c,h]=H.prepareAndValidate(n,a);if(d===0)return r.makeTensorInfo(u,n.dtype,[]);let p=r.data.get(a.dataId).values,f=r.bufferSync(n),g=kJ(p,f,n.dtype,d,o,c,h,n.shape,s);return r.makeTensorInfo(u,n.dtype,g.values)}var oUe={kernelName:gx,backendName:"cpu",kernelFunc:iUe};function lUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,indices:s}=t,{axis:i,batchDims:o}=n;mt([a,s],"gatherV2");let u=R.parseAxisParam(i,a.shape)[0],d=r.data.get(s.dataId).values,c=a.shape[u];for(let N=0;N<d.length;++N){let S=d[N];R.assert(S<=c-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${c-1}]`)}let h=o;o==null&&(h=0);let p=R.sizeFromShape(s.shape),f=H.segment_util.collectGatherOpShapeInfo(a,s,u,h),g=Zr({inputs:{x:a},backend:r,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=Zr({inputs:{x:s},backend:r,attrs:{shape:[f.batchSize,p/f.batchSize]}}),x=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize],y=r.bufferSync(m),v=r.bufferSync(g),b=CJ(v,y,x);return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),r.makeTensorInfo(f.outputShape,b.dtype,b.values)}var uUe={kernelName:mx,backendName:"cpu",kernelFunc:lUe};function cUe(e){let{inputs:t,backend:r}=e,{input:n}=t,a=R.sizeFromShape(n.shape),s=n.shape[n.shape.length-1],i=a/s,o=Zr({inputs:{x:n},backend:r,attrs:{shape:[i,s]}}),u=uZ(o,!0,r),d=Zr({inputs:{x:u},backend:r,attrs:{shape:n.shape}});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),d}var dUe={kernelName:vk,backendName:"cpu",kernelFunc:cUe},hUe=$r(Cp,e=>Number.isFinite(e)?1:0,"bool"),pUe={kernelName:Cp,backendName:"cpu",kernelFunc:hUe},fUe=$r(Ip,e=>Math.abs(e)===1/0?1:0,"bool"),mUe={kernelName:Ip,backendName:"cpu",kernelFunc:fUe},gUe=$r(Ep,e=>Number.isNaN(e)?1:0,"bool"),xUe={kernelName:Ep,backendName:"cpu",kernelFunc:gUe};function yUe(e){let{backend:t,attrs:r}=e,{start:n,stop:a,num:s}=r,i=AJ(n,a,s);return t.makeTensorInfo([i.length],"float32",i)}var vUe={kernelName:bx,backendName:"cpu",kernelFunc:yUe},bUe=$r(Ap,e=>Math.log1p(e)),wUe={kernelName:Ap,backendName:"cpu",kernelFunc:bUe},NUe=Mn((e,t)=>e&&t),SUe=ea(wx,NUe,null,"bool"),_Ue={kernelName:wx,backendName:"cpu",kernelFunc:SUe},kUe=$r(Nx,e=>e?0:1,"bool"),CUe={kernelName:Nx,backendName:"cpu",kernelFunc:kUe},IUe=Mn((e,t)=>e||t),EUe=ea(Sx,IUe,null,"bool"),TUe={kernelName:Sx,backendName:"cpu",kernelFunc:EUe};function jUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{depthRadius:s,bias:i,alpha:o,beta:u}=n;mt(a,"LRN");let d=a.shape[3],c=d-1,h=r.data.get(a.dataId).values,p=R.sizeFromShape(a.shape),f=new Float32Array(p);function g(m){let x=m%d,y=m-x+Math.max(0,x-s),v=m-x+Math.min(x+s,c),b=0;for(;y<=v;y++){let N=h[y];b+=N*N}return b}for(let m=0;m<p;m++){let x=g(m),y=h[m]*Math.pow(i+o*x,-u);f[m]=y}return r.makeTensorInfo(a.shape,a.dtype,f)}var AUe={kernelName:$p,backendName:"cpu",kernelFunc:jUe};function $Ue(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,y:s,dy:i}=t,{depthRadius:o,bias:u,alpha:d,beta:c}=n;mt(i,"LRNGrad");let h=R.sizeFromShape(i.shape),p=i.shape[3],f=r.data.get(i.dataId).values,g=r.data.get(a.dataId).values,m=r.data.get(s.dataId).values,x=new Float32Array(h),y=h;for(let v=0;v<y;v++){let b=v%p,N=v-b+Math.max(0,b-o),S=v-b+Math.min(p,b+o+1),_=0;for(let C=N;C<S;C++)_+=Math.pow(g[C],2);_=d*_+u;for(let C=N;C<S;C++){let k=-2*d*c*g[C]*m[v]/_;v===C&&(k+=Math.pow(_,-c)),k*=f[v],x[C]+=k}}return r.makeTensorInfo(i.shape,a.dtype,x)}var RUe={kernelName:_x,backendName:"cpu",kernelFunc:$Ue};function cZ(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{reductionIndices:s,keepDims:i}=n,o=r,u=a.shape,d=u.length,c=R.parseAxisParam(s,u),h=c,p=H.getAxesPermutation(h,d),f=o.data.get(a.dataId).values;if(p!=null){let N=new Array(d);for(let S=0;S<N.length;S++)N[S]=u[p[S]];f=PF(f,u,a.dtype,p,N),h=H.getInnerMostAxes(h.length,d),u=N}mt(a,"max"),H.assertAxesAreInnerMostDims("max",h,d);let[g,m]=H.computeOutAndReduceShapes(u,h),x=R.sizeFromShape(m),y=RJ(f,x,g,a.dtype),v=o.write(y,g,a.dtype),b=g;return i&&(b=H.expandShapeToKeepDim(g,c)),{dataId:v,shape:b,dtype:a.dtype}}var DUe={kernelName:Rp,backendName:"cpu",kernelFunc:cZ};function MUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t;mt(a,"maxPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:u}=n,d=1;R.assert(H.eitherStridesOrDilationsAreOne(i,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);let c=H.computePool2DInfo(a.shape,s,i,d,o,u),h;if(c.filterWidth===1&&c.filterHeight===1&&R.arraysEqual(c.inShape,c.outShape))h=ml({inputs:{x:a},backend:r});else{let p=r.data.get(a.dataId).values,f=R.computeStrides(a.shape),g=qF(p,a.shape,a.dtype,f,c,"max");h=r.makeTensorInfo(c.outShape,a.dtype,g.values)}return h}var FUe={kernelName:Mp,backendName:"cpu",kernelFunc:MUe};function OUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:u,dataFormat:d}=n;mt(a,"maxPool3d");let c=H.computePool3DInfo(a.shape,s,i,1,o,u,d),h=r.data.get(a.dataId).values,p=iZ(h,a.shape,a.dtype,R.computeStrides(a.shape),c,"max");return r.makeTensorInfo(p.shape,"float32",p.values)}var PUe={kernelName:kx,backendName:"cpu",kernelFunc:OUe};function LUe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:u,dimRoundingMode:d}=n;mt([a,s],"maxPool3DGrad");let c=H.computePool3DInfo(s.shape,i,o,1,u,d),h=r.bufferSync(s),p=I5e(h,c),f=c.strideDepth,g=c.strideHeight,m=c.strideWidth,x=c.dilationDepth,y=c.dilationHeight,v=c.dilationWidth,b=c.effectiveFilterDepth,N=c.effectiveFilterHeight,S=c.effectiveFilterWidth,_=b-1-c.padInfo.front,C=S-1-c.padInfo.left,k=N-1-c.padInfo.top,I=Qt(s.shape,"float32"),T=r.bufferSync(a);for(let j=0;j<c.batchSize;++j)for(let E=0;E<c.inChannels;++E)for(let O=0;O<c.inDepth;++O)for(let M=0;M<c.inHeight;++M)for(let W=0;W<c.inWidth;++W){let q=O-_,P=M-k,A=W-C,L=0;for(let z=0;z<b;z+=x){let $=(q+z)/f;if(!($<0||$>=c.outDepth||Math.floor($)!==$))for(let V=0;V<N;V+=y){let B=(P+V)/g;if(!(B<0||B>=c.outHeight||Math.floor(B)!==B))for(let Y=0;Y<S;Y+=v){let re=(A+Y)/m;if(re<0||re>=c.outWidth||Math.floor(re)!==re)continue;let ae=b*N*S-1-p.get(j,$,B,re,E),K=z*N*S+V*S+Y,J=ae===K?1:0;if(J===0)continue;let Z=T.get(j,$,B,re,E);L+=Z*J}}}I.set(L,j,O,M,W,E)}return r.makeTensorInfo(I.shape,I.dtype,I.values)}var zUe={kernelName:v0,backendName:"cpu",kernelFunc:LUe};function BUe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s,output:i}=t,o=s;mt([s,i],"maxPoolGrad");let{filterSize:u,strides:d,pad:c,dimRoundingMode:h}=n,p=H.computePool2DInfo(o.shape,u,d,1,c,h),f=r.data.get(o.dataId).values,g=Qt(p.outShape,o.dtype,sZ(f,o.shape,o.dtype,p).values),m=p.strideHeight,x=p.strideWidth,y=p.dilationHeight,v=p.dilationWidth,b=p.effectiveFilterHeight,N=p.effectiveFilterWidth,S=N-1-p.padInfo.left,_=b-1-p.padInfo.top,C=Qt(o.shape,"float32"),k=r.data.get(a.dataId).values,I=Qt(a.shape,"float32",k);for(let T=0;T<p.batchSize;++T)for(let j=0;j<p.inChannels;++j)for(let E=0;E<p.inHeight;++E)for(let O=0;O<p.inWidth;++O){let M=E-_,W=O-S,q=0;for(let P=0;P<b;P+=y){let A=(M+P)/m;if(!(A<0||A>=p.outHeight||Math.floor(A)!==A))for(let L=0;L<N;L+=v){let z=(W+L)/x;if(z<0||z>=p.outWidth||Math.floor(z)!==z)continue;let $=b*N-1-g.get(T,A,z,j),V=P*N+L,B=$===V?1:0;if(B===0)continue;let Y=I.get(T,A,z,j);q+=Y*B}}C.set(q,T,E,O,j)}return r.makeTensorInfo(C.shape,C.dtype,C.values)}var UUe={kernelName:y0,backendName:"cpu",kernelFunc:BUe};function WUe(e,t,r,n,a){let s=R.computeStrides(t),i=qF(e,t,r,s,a,"max"),o=sZ(e,t,r,a,!0,n);return[i.values,o.values]}var VUe={kernelName:b0,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:r})=>{let{x:n}=e,{filterSize:a,strides:s,pad:i,includeBatchInIndex:o}=t,u=r;mt(n,"MaxPoolWithArgmax");let d=u.data.get(n.dataId).values,c=H.computePool2DInfo(n.shape,a,s,[1,1],i),[h,p]=WUe(d,n.shape,n.dtype,o,c),f=u.write(h,c.outShape,n.dtype),g=u.write(p,c.outShape,n.dtype);return[{dataId:f,shape:c.outShape,dtype:n.dtype},{dataId:g,shape:c.outShape,dtype:"int32"}]}};function HUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n,o=R.parseAxisParam(s,a.shape),u=H.computeOutAndReduceShapes(a.shape,o)[1],d=R.sizeFromShape(u),c=[],h=r.makeTensorInfo([],"float32",new Float32Array([d]));c.push(h);let p=Pc({inputs:{x:a},backend:r,attrs:{dtype:"float32"}});c.push(p);let f=GF({inputs:{a:p,b:h},backend:r});c.push(f);let g=iw({inputs:{x:f},backend:r,attrs:{axis:s,keepDims:i}});return c.forEach(m=>r.disposeIntermediateTensorInfo(m)),g}var qUe={kernelName:Fp,backendName:"cpu",kernelFunc:HUe};function GUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n;mt(a,"min");let o=R.parseAxisParam(s,a.shape),u=o,d=H.getAxesPermutation(u,a.shape.length),c=a;d!=null&&(c=bs({inputs:{x:a},backend:r,attrs:{perm:d}}),u=H.getInnerMostAxes(u.length,a.shape.length)),H.assertAxesAreInnerMostDims("min",u,c.shape.length);let[h,p]=H.computeOutAndReduceShapes(c.shape,u),f=R.sizeFromShape(p),g=R.makeZerosTypedArray(R.sizeFromShape(h),c.dtype),m=r.data.get(c.dataId).values;for(let y=0;y<g.length;++y){let v=y*f,b=m[v];for(let N=0;N<f;++N){let S=m[v+N];(Number.isNaN(S)||S<b)&&(b=S)}g[y]=b}d!=null&&r.disposeIntermediateTensorInfo(c);let x=r.makeTensorInfo(h,c.dtype,g);if(i){let y=H.expandShapeToKeepDim(h,o),v=Zr({inputs:{x},backend:r,attrs:{shape:y}});return r.disposeIntermediateTensorInfo(x),v}return x}var KUe={kernelName:Op,backendName:"cpu",kernelFunc:GUe};function QUe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{paddings:s,mode:i}=n;mt(a,"mirrorPad");let o=s.map((v,b)=>v[0]+a.shape[b]+v[1]),u=s.map(v=>v[0]),d=s.map((v,b)=>v[0]+a.shape[b]),c=i==="reflect"?0:1,h=r.data.get(a.dataId).values,p=a.shape.length,f=R.computeStrides(a.shape),g=R.sizeFromShape(o),m=o.length,x=R.computeStrides(o),y=R.getTypedArrayFromDType(a.dtype,g);for(let v=0;v<g;v++){let b=R.indexToLoc(v,m,x);for(let S=0;S<m;S++)b[S]<u[S]?b[S]=u[S]*2-b[S]-c:b[S]>=d[S]&&(b[S]=(d[S]-1)*2-b[S]+c);b=b.map((S,_)=>S-u[_]);let N=R.locToIndex(b,p,f);y[v]=h[N]}return{dataId:r.write(y,o,a.dtype),shape:o,dtype:a.dtype}}var XUe={kernelName:Lp,backendName:"cpu",kernelFunc:QUe},YUe=Mn((e,t)=>{let r=e%t;return e<0&&t<0||e>=0&&t>=0?r:(r+t)%t}),JUe=ea(zp,YUe),ZUe={kernelName:zp,backendName:"cpu",kernelFunc:JUe},eWe=Xc(lk());function dZ(e){let{inputs:t,backend:r,attrs:n}=e,{logits:a}=t,{dim:s}=n,i=a.shape.length,o=s;if(o===-1&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);let u=R.parseAxisParam([o],a.shape),d=cZ({inputs:{x:a},backend:r,attrs:{reductionIndices:u,keepDims:!1}}),c=H.expandShapeToKeepDim(d.shape,u),h=Zr({inputs:{x:d},backend:r,attrs:{shape:c}}),p=VF({inputs:{a,b:h},backend:r}),f=wJ({inputs:{x:p},backend:r}),g=iw({inputs:{x:f},backend:r,attrs:{axis:u,keepDims:!1}}),m=Zr({inputs:{x:g},backend:r,attrs:{shape:c}}),x=GF({inputs:{a:f,b:m},backend:r});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),x}var tWe={kernelName:cf,backendName:"cpu",kernelFunc:dZ};function rWe(e){let{inputs:t,backend:r,attrs:n}=e,{logits:a}=t,{numSamples:s,seed:i,normalized:o}=n;mt(a,"multinomial");let u=o?a:dZ({inputs:{logits:a},backend:r,attrs:{dim:-1}}),d=u.shape[0],c=u.shape[1],h=r.data.get(u.dataId).values,p=[d,s],f=R.makeZerosTypedArray(R.sizeFromShape(p),"int32");for(let g=0;g<d;++g){let m=g*c,x=new Float32Array(c-1);x[0]=h[m];for(let b=1;b<x.length;++b)x[b]=x[b-1]+h[m+b];let y=eWe.alea(i.toString()),v=g*s;for(let b=0;b<s;++b){let N=y();f[v+b]=x.length;for(let S=0;S<x.length;S++)if(N<x[S]){f[v+b]=S;break}}}return o||r.disposeIntermediateTensorInfo(u),r.makeTensorInfo(p,"int32",f)}var nWe={kernelName:Cx,backendName:"cpu",kernelFunc:rWe},aWe=Nl.nonMaxSuppressionV3Impl;function sWe(e){let{inputs:t,backend:r,attrs:n}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:u}=n;mt(a,"NonMaxSuppression");let d=r.data.get(a.dataId).values,c=r.data.get(s.dataId).values,{selectedIndices:h}=aWe(d,c,i,o,u);return r.makeTensorInfo([h.length],"int32",new Int32Array(h))}var iWe={kernelName:Tx,backendName:"cpu",kernelFunc:sWe},oWe=Nl.nonMaxSuppressionV4Impl;function lWe(e){let{inputs:t,backend:r,attrs:n}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:u,padToMaxOutputSize:d}=n;mt(a,"NonMaxSuppressionPadded");let c=r.data.get(a.dataId).values,h=r.data.get(s.dataId).values,{selectedIndices:p,validOutputs:f}=oWe(c,h,i,o,u,d);return[r.makeTensorInfo([p.length],"int32",new Int32Array(p)),r.makeTensorInfo([],"int32",new Int32Array([f]))]}var uWe={kernelName:jx,backendName:"cpu",kernelFunc:lWe},cWe=Nl.nonMaxSuppressionV5Impl;function dWe(e){let{inputs:t,backend:r,attrs:n}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:u,softNmsSigma:d}=n;mt(a,"NonMaxSuppressionWithScore");let c=r.data.get(a.dataId).values,h=r.data.get(s.dataId).values,p=i,f=o,g=u,m=d,{selectedIndices:x,selectedScores:y}=cWe(c,h,p,f,g,m);return[r.makeTensorInfo([x.length],"int32",new Int32Array(x)),r.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var hWe={kernelName:Ax,backendName:"cpu",kernelFunc:dWe};function pWe(e){let{inputs:t,backend:r,attrs:n}=e,{indices:a}=t,{dtype:s,depth:i,onValue:o,offValue:u}=n;mt(a,"oneHot");let d=R.sizeFromShape(a.shape),c=new Float32Array(d*i);c.fill(u);let h=r.data.get(a.dataId).values;for(let p=0;p<d;++p)h[p]>=0&&h[p]<i&&(c[p*i+h[p]]=o);return r.makeTensorInfo([...a.shape,i],s,c)}var fWe={kernelName:Up,backendName:"cpu",kernelFunc:pWe};function CS(e){let{inputs:t,backend:r}=e,{x:n}=t;if(n.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(n.dtype==="complex64"){let a=Dh({inputs:{input:n},backend:r}),s=CS({inputs:{x:a},backend:r}),i=wg({inputs:{input:n},backend:r}),o=CS({inputs:{x:i},backend:r}),u=Ls({inputs:{real:s,imag:o},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}else return KF({backend:r,attrs:{shape:n.shape,value:0,dtype:n.dtype}})}var mWe={kernelName:Xx,backendName:"cpu",kernelFunc:CS};function hZ(e){let{inputs:t,backend:r}=e,{x:n}=t;if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(n.dtype==="complex64"){let a=Dh({inputs:{input:n},backend:r}),s=hZ({inputs:{x:a},backend:r}),i=wg({inputs:{input:n},backend:r}),o=CS({inputs:{x:i},backend:r}),u=Ls({inputs:{real:s,imag:o},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}else return KF({backend:r,attrs:{shape:n.shape,value:1,dtype:n.dtype}})}var gWe={kernelName:$x,backendName:"cpu",kernelFunc:hZ};function pZ(e){let{inputs:t,backend:r,attrs:n}=e,{axis:a}=n;if(t.length===1)return kS({inputs:{input:t[0]},backend:r,attrs:{dim:a}});let s=t[0].shape,i=t[0].dtype;t.forEach(c=>{R.assertShapesMatch(s,c.shape,"All tensors passed to stack must have matching shapes"),R.assert(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],u=t.map(c=>{let h=kS({inputs:{input:c},backend:r,attrs:{dim:a}});return o.push(h),h}),d=Ng({inputs:u,backend:r,attrs:{axis:a}});return o.forEach(c=>r.disposeIntermediateTensorInfo(c)),d}var xWe={kernelName:Rx,backendName:"cpu",kernelFunc:pZ};function yWe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{paddings:s,constantValue:i}=n;mt(a,"pad");let o=s.map((y,v)=>y[0]+a.shape[v]+y[1]),u=s.map(y=>y[0]),d=r.data.get(a.dataId).values,c=R.sizeFromShape(a.shape),h=a.shape.length,p=R.computeStrides(a.shape),f=R.sizeFromShape(o),g=o.length,m=R.computeStrides(o),x=R.getTypedArrayFromDType(a.dtype,f);i!==0&&x.fill(i);for(let y=0;y<c;y++){let v=R.indexToLoc(y,h,p).map((N,S)=>N+u[S]),b=R.locToIndex(v,g,m);x[b]=d[y]}return{dataId:r.write(x,o,a.dtype),shape:o,dtype:a.dtype}}var fZ={kernelName:Wp,backendName:"cpu",kernelFunc:yWe},vWe=Mn((e,t)=>Math.pow(e,t)),bWe=ea(Vp,vWe),wWe={kernelName:Vp,backendName:"cpu",kernelFunc:bWe};function NWe(e){let{inputs:t,backend:r,attrs:n}=e,{paramsNestedSplits:a,paramsDenseValues:s,indices:i}=t,{outputRaggedRank:o}=n,u=a.map(y=>r.data.get(y.dataId).values),d=a.map(y=>y.shape),c=r.data.get(s.dataId).values,h=r.data.get(i.dataId).values,[p,f,g]=LJ(u,d,c,s.shape,s.dtype,h,i.shape),m=p.map(y=>r.makeTensorInfo([y.length],"int32",y)),x=r.makeTensorInfo(g,s.dtype,f);return m.concat([x])}var SWe={kernelName:wk,backendName:"cpu",kernelFunc:NWe};function _We(e){let{inputs:t,backend:r}=e,{starts:n,limits:a,deltas:s}=t,i=r.data.get(n.dataId).values,o=r.data.get(a.dataId).values,u=r.data.get(s.dataId).values,[d,c]=zJ(i,n.shape,n.dtype,o,a.shape,u,s.shape),h=r.makeTensorInfo([d.length],"int32",d),p=r.makeTensorInfo([c.length],n.dtype,c);return[h,p]}var kWe={kernelName:Nk,backendName:"cpu",kernelFunc:_We};function CWe(e){let{inputs:t,backend:r,attrs:n}=e,{shape:a,values:s,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:u}=n,d=r.data.get(a.dataId).values,c=r.data.get(s.dataId).values,h=r.data.get(i.dataId).values,p=o.map(x=>r.data.get(x.dataId).values),f=o.map(x=>x.shape),[g,m]=BJ(d,a.shape,c,s.shape,s.dtype,h,i.shape,p,f,u);return r.makeTensorInfo(g,s.dtype,m)}var IWe={kernelName:Sk,backendName:"cpu",kernelFunc:CWe};function EWe(e){let{backend:t,attrs:r}=e,{start:n,stop:a,dtype:s,step:i}=r,o=LF(n,a,i,s);return t.makeTensorInfo([o.length],s,o)}var TWe={kernelName:w0,backendName:"cpu",kernelFunc:EWe},jWe=$r(Gp,e=>1/e),AWe={kernelName:Gp,backendName:"cpu",kernelFunc:jWe};function $We(e){let{inputs:t,backend:r,attrs:n}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=n;mt(a,"resizeBilinear");let u=R.computeStrides(a.shape),[d,c]=o,[h,p,f,g]=a.shape,m=r.data.get(a.dataId).values,x=new Float32Array(R.sizeFromShape([h,d,c,g])),y=[s&&d>1?p-1:p,s&&c>1?f-1:f],v=[s&&d>1?d-1:d,s&&c>1?c-1:c],b=0,N=y[0]/v[0],S=y[1]/v[1];for(let _=0;_<h;_++)for(let C=0;C<d;C++){let k;i?k=N*(C+.5)-.5:k=N*C;let I=Math.max(0,Math.floor(k)),T=k-I,j=Math.min(p-1,Math.ceil(k)),E=_*u[0]+I*u[1],O=_*u[0]+j*u[1];for(let M=0;M<c;M++){let W;i?W=S*(M+.5)-.5:W=S*M;let q=Math.max(0,Math.floor(W)),P=W-q,A=Math.min(f-1,Math.ceil(W)),L=E+q*u[2],z=O+q*u[2],$=E+A*u[2],V=O+A*u[2];for(let B=0;B<g;B++){let Y=m[L+B],re=m[z+B],ae=m[$+B],K=m[V+B],J=Y+(ae-Y)*P,Z=re+(K-re)*P,Q=J+(Z-J)*T;x[b++]=Q}}}return r.makeTensorInfo([h,d,c,g],"float32",x)}var RWe={kernelName:Xp,backendName:"cpu",kernelFunc:$We};function DWe(e){let{inputs:t,backend:r,attrs:n}=e,{images:a,dy:s}=t,{alignCorners:i}=n;mt([s,a],"resizeBilinearGrad");let o=R.computeStrides(a.shape),[u,d,c,h]=a.shape,[,p,f]=s.shape,g=new Float32Array(u*d*c*h),m=[i&&p>1?d-1:d,i&&f>1?c-1:c],x=[i&&p>1?p-1:p,i&&f>1?f-1:f],y=m[0]/x[0],v=m[1]/x[1],b=r.data.get(s.dataId).values,N=0;for(let S=0;S<u;S++){let _=S*o[0];for(let C=0;C<p;C++){let k=C*y,I=Math.floor(k),T=Math.min(Math.ceil(k),d-1),j=_+I*o[1],E=_+T*o[1],O=k-I,M=1-O;for(let W=0;W<f;W++){let q=W*v,P=Math.floor(q),A=Math.min(Math.ceil(q),c-1),L=q-P,z=1-L,$=j+P*o[2],V=j+A*o[2],B=E+P*o[2],Y=E+A*o[2],re=M*z,ae=M*L,K=O*z,J=O*L;for(let Z=0;Z<h;Z++){let Q=b[N++];g[$+Z]+=Q*re,g[V+Z]+=Q*ae,g[B+Z]+=Q*K,g[Y+Z]+=Q*J}}}}return r.makeTensorInfo([u,c,d,h],"float32",g)}var MWe={kernelName:Fx,backendName:"cpu",kernelFunc:DWe};function FWe(e){let{inputs:t,backend:r,attrs:n}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=n;mt(a,"resizeNearestNeighbor");let u=R.computeStrides(a.shape),[d,c]=o,[h,p,f,g]=a.shape,m=r.data.get(a.dataId).values,x=new Float32Array(h*d*c*g),y=[s&&d>1?p-1:p,s&&c>1?f-1:f],v=[s&&d>1?d-1:d,s&&c>1?c-1:c],b=y[0]/v[0],N=y[1]/v[1],S=0;for(let _=0;_<h;_++){let C=_*u[0];for(let k=0;k<d;k++){let I=i?b*(k+.5):b*k,T=Math.min(p-1,s?Math.round(I):Math.floor(I));i&&(T=Math.max(0,T));let j=C+T*u[1];for(let E=0;E<c;E++){let O=i?N*(E+.5):N*E,M=Math.min(f-1,s?Math.round(O):Math.floor(O));i&&(M=Math.max(0,M));let W=j+M*u[2];for(let q=0;q<g;q++){let P=m[W+q];x[S++]=P}}}}return r.makeTensorInfo([h,d,c,g],a.dtype,x)}var OWe={kernelName:Qp,backendName:"cpu",kernelFunc:FWe};function PWe(e){let{inputs:t,backend:r,attrs:n}=e,{images:a,dy:s}=t,{alignCorners:i}=n;mt([s,a],"resizeNearestNeighborGrad");let o=R.computeStrides(a.shape),u=R.computeStrides(s.shape),[d,c,h,p]=a.shape,[,f,g]=s.shape,m=new Float32Array(d*c*h*p),x=r.data.get(s.dataId).values,y=[i&&f>1?c-1:c,i&&g>1?h-1:h],v=[i&&f>1?f-1:f,i&&g>1?g-1:g],b=y[0]/v[0],N=y[1]/v[1],S=1/b,_=1/N,C=Math.ceil(S)*2+2,k=Math.ceil(_)*2+2;for(let I=0;I<d;I++){let T=I*o[0];for(let j=0;j<c;j++){let E=T+j*o[1],O=Math.floor(j*S),M=Math.floor(O-C/2);for(let W=0;W<h;W++){let q=E+W*o[2],P=Math.floor(W*_),A=Math.floor(P-k/2);for(let L=0;L<p;L++){let z=0;for(let $=0;$<C;$++){let V=$+M;if(V<0||V>=f)continue;let B=T+V*u[1],Y=V*b,re=Math.min(c-1,i?Math.round(Y):Math.floor(Y));if(j===re)for(let ae=0;ae<k;ae++){let K=ae+A;if(K<0||K>=g)continue;let J=B+K*u[2],Z=K*N,Q=Math.min(h-1,i?Math.round(Z):Math.floor(Z));W===Q&&(z+=x[J+L])}}m[q+L]=z}}}}return r.makeTensorInfo(a.shape,a.dtype,m)}var LWe={kernelName:Mx,backendName:"cpu",kernelFunc:PWe};function zWe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{dims:s}=n;mt(a,"reverse");let i=a.shape.length,o=R.parseAxisParam(s,a.shape);if(i===0)return ml({inputs:{x:a},backend:r});let u=new zn(a.shape,a.dtype),d=r.bufferSync(a);for(let c=0;c<u.size;c++){let h=u.indexToLoc(c),p=h.slice();o.forEach(f=>p[f]=a.shape[f]-1-p[f]),u.set(d.get(...p),...h)}return r.makeTensorInfo(u.shape,u.dtype,u.values)}var BWe={kernelName:Jp,backendName:"cpu",kernelFunc:zWe},UWe={kernelName:Yx,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:r})=>{let{image:n}=e,{radians:a,fillValue:s,center:i}=t,o=r,u=R.getTypedArrayFromDType(n.dtype,R.sizeFromShape(n.shape)),[d,c,h,p]=n.shape,[f,g]=H.getImageCenter(i,c,h),m=255,x=Math.sin(a),y=Math.cos(a),v=o.data.get(n.dataId).values;for(let b=0;b<d;b++){let N=b*h*c*p;for(let S=0;S<c;S++){let _=S*(h*p);for(let C=0;C<h;C++){let k=C*p;for(let I=0;I<p;I++){let T=[d,S,C,I],j=T[2],E=T[1],O=(j-f)*y-(E-g)*x,M=(j-f)*x+(E-g)*y;O=Math.round(O+f),M=Math.round(M+g);let W=s;if(typeof s!="number"&&(I===3?W=m:W=s[I]),O>=0&&O<h&&M>=0&&M<c){let P=M*(h*p),A=O*p,L=N+P+A+I;W=v[L]}let q=N+_+k+I;u[q]=W}}}}return{dataId:o.write(u,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},WWe=$r(Zp,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),VWe={kernelName:Zp,backendName:"cpu",kernelFunc:WWe};function HWe(e){let{inputs:t,backend:r,attrs:n}=e,{indices:a,updates:s}=t,{shape:i}=n,{sliceRank:o,numUpdates:u,sliceSize:d,strides:c,outputSize:h}=H.calculateShapes(s,a,i),p=!0,f=r.bufferSync(a),g=r.bufferSync(s),m=Pd(f,g,i,h,d,u,o,c,0,p);return r.makeTensorInfo(i,m.dtype,m.values)}var qWe={kernelName:Ox,backendName:"cpu",kernelFunc:HWe};function GWe(e,t){let r=0,n=e.length,a=0;for(;r<n;)a=Math.floor((r+n)/2),e[a]<t?r=a+1:n=a;return n}function KWe(e,t){let r=0,n=e.length,a=0;for(;r<n;)a=Math.floor((r+n)/2),e[a]<=t?r=a+1:n=a;return n}function QWe(e,t,r,n,a,s){let i=R.getArrayFromDType("int32",r*a);for(let o=0;o<r;++o){let u=e.slice(o*n,(o+1)*n),d=o*a;for(let c=0;c<a;++c)i[d+c]=s==="left"?GWe(u,t[c+d]):KWe(u,t[c+d])}return i}function XWe(e){let{inputs:t,backend:r,attrs:n}=e,{sortedSequence:a,values:s}=t,{side:i}=n,o=r.data.get(a.dataId).values,u=r.data.get(s.dataId).values,d=QWe(o,u,a.shape[0],a.shape[1],s.shape[1],i);return r.makeTensorInfo(s.shape,"int32",d)}var YWe={kernelName:Lx,backendName:"cpu",kernelFunc:XWe};function JWe(e){let{inputs:t,backend:r}=e,{condition:n,t:a,e:s}=t;mt([n,a,s],"select");let i=n.shape.length,o=r.data.get(n.dataId).values,u=r.data.get(a.dataId).values,d=r.data.get(s.dataId).values,c=wi(a.dtype,s.dtype),h=R.makeZerosTypedArray(R.sizeFromShape(a.shape),c),p=0,f=i===0||i>1||a.shape.length===1?1:R.sizeFromShape(a.shape.slice(1));for(let g=0;g<o.length;g++)for(let m=0;m<f;m++)o[g]===1?h[p++]=u[g]:h[p++]=d[g];return r.makeTensorInfo(a.shape,c,h)}var ZWe={kernelName:zx,backendName:"cpu",kernelFunc:JWe},e6e=H.SELU_SCALEALPHA,t6e=H.SELU_SCALE,r6e=$r(tf,e=>e>=0?t6e*e:e6e*(Math.exp(e)-1)),n6e={kernelName:tf,backendName:"cpu",kernelFunc:r6e},a6e=$r(af,e=>e<0?-1:e>0?1:0),s6e={kernelName:af,backendName:"cpu",kernelFunc:a6e},i6e=$r(rf,e=>Math.sin(e)),o6e={kernelName:rf,backendName:"cpu",kernelFunc:i6e},l6e=$r(nf,e=>Math.sinh(e)),u6e={kernelName:nf,backendName:"cpu",kernelFunc:l6e},c6e=11920928955078125e-23,iz=Math.log(c6e)+2,d6e=$r(of,e=>{let t=e>-iz,r=e<iz,n=Math.exp(e),a;return r?a=n:t?a=e:a=Math.log(1+n),a}),h6e={kernelName:of,backendName:"cpu",kernelFunc:d6e};function p6e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockShape:s,paddings:i}=n;mt([a],"spaceToBatchND");let o=R.sizeFromShape(s),u=[[0,0]];u.push(...i);for(let x=1+s.length;x<a.shape.length;++x)u.push([0,0]);let d=fZ.kernelFunc({inputs:{x:a},backend:r,attrs:{paddings:u,constantValue:0}}),c=H.getReshaped(d.shape,s,o,!1),h=H.getPermuted(c.length,s.length,!1),p=H.getReshapedPermuted(d.shape,s,o,!1),f=Zr({inputs:{x:d},backend:r,attrs:{shape:c}}),g=bs({inputs:{x:f},backend:r,attrs:{perm:h}}),m=Zr({inputs:{x:g},backend:r,attrs:{shape:p}});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),m}var f6e={kernelName:Ux,backendName:"cpu",kernelFunc:p6e};function m6e(e){let{inputs:t,backend:r}=e,{indices:n,values:a,denseShape:s,defaultValue:i}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(n.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${n.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let o=r.data.get(n.dataId).values,u=r.data.get(a.dataId).values,d=r.data.get(s.dataId).values,c=r.data.get(i.dataId).values[0],[h,p,f,g,m]=VJ(o,n.shape,n.dtype,u,a.dtype,d,c);return[r.makeTensorInfo(p,n.dtype,h),r.makeTensorInfo([p[0]],a.dtype,f),r.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(x=>Number(x)))),r.makeTensorInfo([m.length],n.dtype,new Int32Array(m))]}var g6e={kernelName:N0,backendName:"cpu",kernelFunc:m6e};function x6e(e){let{inputs:t,backend:r}=e,{inputIndices:n,inputShape:a,newShape:s}=t;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${n.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(r.data.get(a.dataId).values),o=r.data.get(n.dataId).values,u=Array.from(r.data.get(s.dataId).values),[d,c,h]=HJ(o,n.shape,n.dtype,i,u);return[r.makeTensorInfo(c,n.dtype,d),r.makeTensorInfo([h.length],s.dtype,new Int32Array(h))]}var y6e={kernelName:Vx,backendName:"cpu",kernelFunc:x6e};function v6e(e){let{inputs:t,backend:r}=e,{data:n,indices:a,segmentIds:s}=t;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(a.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=r.data.get(n.dataId).values,o=r.data.get(a.dataId).values,u=r.data.get(s.dataId).values,[d,c]=zF(i,n.shape,n.dtype,o,u,!0);return r.makeTensorInfo(c,n.dtype,d)}var b6e={kernelName:S0,backendName:"cpu",kernelFunc:v6e};function w6e(e){let{inputs:t,backend:r}=e,{data:n,indices:a,segmentIds:s}=t;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(a.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=r.data.get(n.dataId).values,o=r.data.get(a.dataId).values,u=r.data.get(s.dataId).values,[d,c]=zF(i,n.shape,n.dtype,o,u);return r.makeTensorInfo(c,n.dtype,d)}var N6e={kernelName:_0,backendName:"cpu",kernelFunc:w6e};function S6e(e){let{inputs:t,backend:r,attrs:n}=e,{sparseIndices:a,sparseValues:s,defaultValue:i}=t,{outputShape:o}=n,{sliceRank:u,numUpdates:d,sliceSize:c,strides:h,outputSize:p}=H.calculateShapes(s,a,o),f=!1,g=r.bufferSync(a),m;switch(s.dtype){case"bool":{let x=r.bufferSync(s),y=!!r.data.get(i.dataId).values[0];m=Pd(g,x,o,p,c,d,u,h,y,f);break}case"float32":{let x=r.bufferSync(s),y=r.data.get(i.dataId).values[0];m=Pd(g,x,o,p,c,d,u,h,y,f);break}case"int32":{let x=r.bufferSync(s),y=r.data.get(i.dataId).values[0];m=Pd(g,x,o,p,c,d,u,h,y,f);break}case"string":{let x=r.bufferSync(s),y=R.decodeString(r.data.get(i.dataId).values[0]);m=Pd(g,x,o,p,c,d,u,h,y,f);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return r.makeTensorInfo(o,m.dtype,m.values)}var _6e={kernelName:Hx,backendName:"cpu",kernelFunc:S6e};function k6e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{numOrSizeSplits:s,axis:i}=n,o=R.parseAxisParam(i,a.shape)[0],u=H.prepareSplitSize(a,s,o),d=new Array(a.shape.length).fill(0),c=a.shape.slice();return u.map(h=>{let p=[...c];p[o]=h;let f=Mh({inputs:{x:a},backend:r,attrs:{begin:d,size:p}});return d[o]+=h,f})}var C6e={kernelName:Wx,backendName:"cpu",kernelFunc:k6e},I6e={kernelName:k0,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{let{x:r}=e,n=t;mt(r,"square");let a=n.data.get(r.dataId).values,s=new Float32Array(a.length);for(let i=0;i<a.length;++i){let o=a[i];s[i]=o*o}return{dataId:n.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},E6e=$r(ed,(e,t)=>{let r=t;return isNaN(e)?NaN:e>0?1:r.alpha}),T6e={kernelName:ed,backendName:"cpu",kernelFunc:E6e};function j6e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{begin:s,end:i,strides:o,beginMask:u,endMask:d,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:p}=n;mt(a,"stridedSlice");let{finalShapeSparse:f,finalShape:g,isIdentity:m,sliceDim0:x,isSimpleSlice:y,begin:v,end:b,strides:N}=Yn.sliceInfo(a.shape,s,i,o,u,d,c,h,p),S;if(m)S=Zr({inputs:{x:a},backend:r,attrs:{shape:g}});else if(x||y){R.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let _=Yn.computeOutShape(v,b,N),C=Mh({inputs:{x:a},backend:r,attrs:{begin:v,size:_}});S=Zr({inputs:{x:C},backend:r,attrs:{shape:g}}),r.disposeIntermediateTensorInfo(C)}else{let _=r.bufferSync(a),C=KJ(f,_,N,v);S=r.makeTensorInfo(g,C.dtype,C.values)}return S}var A6e={kernelName:qx,backendName:"cpu",kernelFunc:j6e};function $6e(e){let{inputs:t,backend:r,attrs:n}=e,{separator:a,nGramWidths:s,leftPad:i,rightPad:o,padWidth:u,preserveShortSequences:d}=n,{data:c,dataSplits:h}=t,p=r.data.get(c.dataId).values,f=r.data.get(h.dataId).values,[g,m]=BF(p,f,a,s,i,o,u,d);return[r.makeTensorInfo([g.length],"string",g),r.makeTensorInfo(h.shape,"int32",m)]}var R6e={kernelName:I0,backendName:"cpu",kernelFunc:$6e};function D6e(e){let{inputs:t,backend:r,attrs:n}=e,{skipEmpty:a}=n,{input:s,delimiter:i}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let o=r.data.get(s.dataId).values,u=r.data.get(i.dataId).values[0],[d,c,h]=UF(o,u,a),p=c.length;return[r.makeTensorInfo([p,2],"int32",d),r.makeTensorInfo([p],"string",c),r.makeTensorInfo([2],"int32",new Int32Array(h))]}var M6e={kernelName:E0,backendName:"cpu",kernelFunc:D6e};function F6e(e){let{inputs:t,backend:r,attrs:n}=e,{numBuckets:a}=n,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let i=r.data.get(s.dataId).values,o=WF(i,a);return r.makeTensorInfo(s.shape,"int32",o)}var O6e={kernelName:T0,backendName:"cpu",kernelFunc:F6e},P6e=$r(pf,e=>Math.tan(e)),L6e={kernelName:pf,backendName:"cpu",kernelFunc:P6e},z6e=$r(ff,e=>Math.tanh(e)),B6e={kernelName:ff,backendName:"cpu",kernelFunc:z6e};function U6e(e){let{inputs:t,backend:r}=e,{tensor:n,indices:a,updates:s}=t,{sliceRank:i,numUpdates:o,sliceSize:u,strides:d,outputSize:c}=H.calculateShapes(s,a,n.shape),h=!1,p=r.bufferSync(a),f=r.bufferSync(s),g=r.bufferSync(n),m=Pd(p,f,n.shape,c,u,o,i,d,g,h);return r.makeTensorInfo(n.shape,m.dtype,m.values)}var W6e={kernelName:Px,backendName:"cpu",kernelFunc:U6e};function V6e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{reps:s}=n;mt(a,"tile");let i=XJ(r.bufferSync(a),s);return r.makeTensorInfo(i.shape,i.dtype,i.values)}var H6e={kernelName:Zc,backendName:"cpu",kernelFunc:V6e};function q6e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{k:s,sorted:i}=n;mt(a,"topk");let o=r.data.get(a.dataId).values,[u,d]=JJ(o,a.shape,a.dtype,s,i);return[r.makeTensorInfo(u.shape,u.dtype,u.values),r.makeTensorInfo(d.shape,d.dtype,d.values)]}var G6e={kernelName:Gx,backendName:"cpu",kernelFunc:q6e};function K6e(e){let{inputs:t,attrs:r,backend:n}=e,{image:a,transforms:s}=t,{interpolation:i,fillMode:o,fillValue:u,outputShape:d}=r,[c,h,p,f]=a.shape,[g,m]=d??[h,p],x=[c,g,m,f],y=R.computeStrides(a.shape),v=y[0],b=y[1],N=y[2],S=R.computeStrides(x),_=S[0],C=S[1],k=S[2],I=R.getTypedArrayFromDType(a.dtype,R.sizeFromShape(x));I.fill(u);let T=n.data.get(a.dataId).values,j=n.data.get(s.dataId).values;for(let E=0;E<c;++E){let O=s.shape[0]===1?j:j.subarray(E*8,E*8+8);for(let M=0;M<g;++M)for(let W=0;W<m;++W)for(let q=0;q<f;++q){let P,A=O[6]*W+O[7]*M+1;if(A===0)continue;let L=(O[0]*W+O[1]*M+O[2])/A,z=(O[3]*W+O[4]*M+O[5])/A,$=oz(L,p,o),V=oz(z,h,o);switch(i){case"nearest":P=eVe(T,h,p,v,b,N,E,V,$,q,u);break;case"bilinear":P=tVe(T,h,p,v,b,N,E,V,$,q,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}let B=E*_+M*C+W*k+q;I[B]=P}return n.makeTensorInfo(x,a.dtype,I)}return{dataId:n.write(I,x,a.dtype),shape:a.shape,dtype:a.dtype}}var Q6e={kernelName:Kx,backendName:"cpu",kernelFunc:K6e};function oz(e,t,r){switch(r){case"reflect":return X6e(e,t);case"wrap":return Y6e(e,t);case"nearest":return Z6e(e,t);case"constant":default:return J6e(e)}}function X6e(e,t){let r=e;if(r<0)if(t<=1)r=0;else{let n=2*t;r<n&&(r=n*Math.trunc(-r/n)+r),r=r<-t?r+n:-r-1}else if(r>t-1)if(t<=1)r=0;else{let n=2*t;r-=n*Math.trunc(r/n),r>=t&&(r=n-r-1)}return R.clamp(0,r,t-1)}function Y6e(e,t){let r=e;if(r<0)if(t<=1)r=0;else{let n=t-1;r+=t*(Math.trunc(-r/n)+1)}else if(r>t-1)if(t<=1)r=0;else{let n=t-1;r-=t*Math.trunc(r/n)}return R.clamp(0,r,t-1)}function J6e(e,t){return e}function Z6e(e,t){return R.clamp(0,e,t-1)}function nv(e,t,r,n,a,s,i,o,u,d,c){let h=i*n+o*a+u*s+d;return 0<=o&&o<t&&0<=u&&u<r?e[h]:c}function eVe(e,t,r,n,a,s,i,o,u,d,c){let h=Math.round(o),p=Math.round(u);return nv(e,t,r,n,a,s,i,h,p,d,c)}function tVe(e,t,r,n,a,s,i,o,u,d,c){let h=Math.floor(o),p=Math.floor(u),f=h+1,g=p+1,m=(g-u)*nv(e,t,r,n,a,s,i,h,p,d,c)+(u-p)*nv(e,t,r,n,a,s,i,h,g,d,c),x=(g-u)*nv(e,t,r,n,a,s,i,f,p,d,c)+(u-p)*nv(e,t,r,n,a,s,i,f,g,d,c);return(f-o)*m+(o-h)*x}function rVe(e){let{inputs:t,attrs:r,backend:n}=e,{axis:a}=r,{x:s}=t;mt(s,"unique");let i=n.data.get(s.dataId).values,{outputValues:o,outputShape:u,indices:d}=HF(i,a,s.shape,s.dtype);return[n.makeTensorInfo(u,s.dtype,o),n.makeTensorInfo([d.length],"int32",d)]}var nVe={kernelName:j0,backendName:"cpu",kernelFunc:rVe};function aVe(e){let{inputs:t,backend:r,attrs:n}=e,{value:a}=t,{axis:s}=n;s<0&&(s+=a.shape.length);let i=a.shape.length,o=a.shape[s],u=new Array(i-1),d=0;for(let f=0;f<i;f++)f!==s&&(u[d++]=a.shape[f]);let c=new Array(i).fill(0),h=a.shape.slice();h[s]=1;let p=new Array(o);for(let f=0;f<p.length;f++){c[s]=f;let g=Mh({inputs:{x:a},backend:r,attrs:{begin:c,size:h}});p[f]=Zr({inputs:{x:g},backend:r,attrs:{shape:u}}),r.disposeIntermediateTensorInfo(g)}return p}var sVe={kernelName:Qx,backendName:"cpu",kernelFunc:aVe};function iVe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,segmentIds:s}=t,{numSegments:i}=n;mt(a,"unsortedSegmentSum");let o=a.shape.length,u=s.shape.length,d=[],c=[],h=o-u,p=s;for(let g=0;g<h;++g){let m=kS({inputs:{input:p},backend:r,attrs:{dim:g+1}});p=m,c.push(m)}for(let g=0;g<i;++g){let m=R.createScalarValue(g,"int32"),x=r.makeTensorInfo([],"int32",m),y=vJ({inputs:{a:x,b:p},backend:r}),v=Pc({inputs:{x:y},backend:r,attrs:{dtype:"float32"}}),b=jC({inputs:{a:v,b:a},backend:r}),N=iw({inputs:{x:b},backend:r,attrs:{axis:0,keepDims:!1}});d.push(N),c.push(x),c.push(y),c.push(v),c.push(b),c.push(N)}let f=pZ({inputs:d,backend:r,attrs:{axis:0}});return c.forEach(g=>r.disposeIntermediateTensorInfo(g)),f}var oVe={kernelName:A0,backendName:"cpu",kernelFunc:iVe},lVe=[t5e,D4e,n5e,s5e,z4e,o5e,u5e,d5e,p5e,m5e,x5e,v5e,w5e,_5e,C5e,T5e,A5e,R5e,M5e,Zze,O5e,L5e,B5e,U4e,W5e,P4e,V4e,H5e,M4e,G5e,Q5e,X5e,J5e,eBe,rBe,aBe,iBe,lBe,cBe,hBe,fBe,gBe,yBe,bBe,wBe,SBe,kBe,IBe,EBe,TBe,jBe,$Be,MBe,qze,OBe,H4e,HBe,q4e,qBe,K4e,JBe,ZBe,tUe,X4e,J4e,nUe,sUe,oUe,uUe,eze,rze,F4e,dUe,K5e,pUe,mUe,xUe,Gze,aze,ize,vUe,lze,wUe,_Ue,CUe,TUe,AUe,RUe,DUe,cze,FUe,PUe,zUe,UUe,VUe,qUe,KUe,hze,XUe,ZUe,nWe,fze,gze,iWe,uWe,hWe,yze,fWe,gWe,xWe,fZ,wWe,Qze,wze,SWe,kWe,IWe,TWe,O4e,lj,AWe,Xze,Yze,Jze,RWe,MWe,OWe,LWe,BWe,UWe,VWe,jze,qWe,YWe,ZWe,n6e,$ze,s6e,o6e,u6e,Rze,tWe,h6e,f6e,g6e,y6e,b6e,N6e,_6e,C6e,Fze,I6e,Pze,zze,T6e,A6e,R6e,M6e,O6e,Vze,RBe,L6e,B6e,W6e,H6e,G6e,Q6e,vze,nVe,sVe,oVe,mWe];for(let e of lVe)$0(e);var mZ={};Ut(mZ,{assertNotComplex:()=>cy,bindCanvasToFramebuffer:()=>vVe,bindColorTextureToFramebuffer:()=>tN,bindTextureToProgramUniformSampler:()=>AZ,bindTextureUnit:()=>EZ,bindVertexBufferToProgramAttribute:()=>cj,callAndCheck:()=>Je,canBeRepresented:()=>xZ,createFragmentShader:()=>bZ,createFramebuffer:()=>IZ,createProgram:()=>wZ,createStaticIndexBuffer:()=>_Z,createStaticVertexBuffer:()=>SZ,createTexture:()=>kZ,createVertexShader:()=>vZ,getBatchDim:()=>Fh,getExtensionOrThrow:()=>av,getFramebufferErrorMessage:()=>$Z,getMaxTexturesInShader:()=>FZ,getNumChannels:()=>xVe,getProgramUniformLocation:()=>jZ,getProgramUniformLocationOrThrow:()=>TZ,getRowsCols:()=>Oh,getShapeAs3D:()=>iv,getTextureShapeFromLogicalShape:()=>DZ,getWebGLDisjointQueryTimerVersion:()=>OZ,getWebGLErrorMessage:()=>yZ,getWebGLMaxTextureSize:()=>MZ,hasExtension:()=>ci,isCapableOfRenderingToFloatTexture:()=>PZ,isDownloadFloatTextureEnabled:()=>LZ,isReshapeFree:()=>vb,isWebGLFenceEnabled:()=>zZ,isWebGLVersionEnabled:()=>hj,linkProgram:()=>NZ,logShaderSourceAndInfoLog:()=>XF,resetMaxTextureSize:()=>bVe,resetMaxTexturesInShader:()=>wVe,unbindColorTextureFromFramebuffer:()=>dj,unbindTextureUnit:()=>yVe,validateFramebuffer:()=>sv,validateProgram:()=>eN,validateTextureSize:()=>CZ});var Ad={},m1={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function gZ(e,t){Ad[e]=t}function Ao(e,t){if(!(e in Ad)||t!=null){let n=cVe(e,t);if(n!==null)Ad[e]=n;else return console.log("Could not get context for WebGL version",e),null}let r=Ad[e];return r==null||r.isContextLost()?(delete Ad[e],Ao(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),Ad[e])}function uVe(e){if(!ge().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function cVe(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let r=t??uVe(e);return r.addEventListener("webglcontextlost",n=>{n.preventDefault(),delete Ad[e]},!1),ge().getBool("SOFTWARE_WEBGL_ENABLED")&&(m1.failIfMajorPerformanceCaveat=!1),e===1?r.getContext("webgl",m1)||r.getContext("experimental-webgl",m1):r.getContext("webgl2",m1)}var yb;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(yb||(yb={}));var ui;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(ui||(ui={}));var ba;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(ba||(ba={}));function ow(e,t){return[t,e]}function dVe(e,t){return e*t}function g1(e){let t=R.sizeFromShape(e),r=Math.ceil(t/4);return R.sizeToSquarishShape(r)}function uy(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function hVe(e,t){let[r,n]=uy(e,t);return r*n*4}function QF(e,t){let r=e,n,a,s,i,o,u,d,c,h,p;return ge().getNumber("WEBGL_VERSION")===2?(n=r.R32F,a=r.R16F,s=r.RGBA16F,i=r.RGBA32F,o=r.RED,d=4,c=1,h=r.HALF_FLOAT,p=r.FLOAT,u=r.RGBA8):(n=e.RGBA,a=e.RGBA,s=e.RGBA,i=r.RGBA,o=e.RGBA,d=4,c=4,h=t!=null?t.HALF_FLOAT_OES:null,p=e.FLOAT,u=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:u,downloadUnpackNumChannels:d,defaultNumChannels:c,textureTypeHalfFloat:h,textureTypeFloat:p}}function Je(e,t){let r=t();return ge().getBool("DEBUG")&&pVe(e),r}function pVe(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+yZ(e,t))}var fVe=596e-10,mVe=65504;function xZ(e){return!!(ge().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||fVe<Math.abs(e)&&Math.abs(e)<mVe)}function yZ(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function av(e,t){return xu(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function vZ(e,t){let r=xu(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Je(e,()=>e.shaderSource(r,t)),Je(e,()=>e.compileShader(r)),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function bZ(e,t){let r=xu(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Je(e,()=>e.shaderSource(r,t)),Je(e,()=>e.compileShader(r)),ge().get("ENGINE_COMPILE_ONLY"))return r;if(e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw XF(t,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var gVe=/ERROR: [0-9]+:([0-9]+):/g;function XF(e,t){let r=gVe.exec(t);if(r==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let n=+r[1],a=e.split(`
`),s=a.length.toString().length+2,i=a.map((h,p)=>R.rightPad((p+1).toString(),s)+h),o=0;for(let h=0;h<i.length;h++)o=Math.max(i[h].length,o);let u=i.slice(0,n-1),d=i.slice(n-1,n),c=i.slice(n);console.log(u.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${R.rightPad(d[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function wZ(e){return xu(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function NZ(e,t){if(Je(e,()=>e.linkProgram(t)),!ge().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function eN(e,t){if(Je(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function SZ(e,t){let r=xu(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Je(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Je(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),r}function _Z(e,t){let r=xu(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Je(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)),Je(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),r}function xVe(){return ge().getNumber("WEBGL_VERSION")===2?1:4}function kZ(e){return xu(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function CZ(e,t){let r=ge().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let n=`[${e}x${t}]`;throw new Error("Requested texture size "+n+" is invalid.")}if(e>r||t>r){let n=`[${e}x${t}]`,a=`[${r}x${r}]`;throw new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+a+".")}}function IZ(e){return xu(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function cj(e,t,r,n,a,s,i){let o=e.getAttribLocation(t,r);return o===-1?!1:(Je(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Je(e,()=>e.vertexAttribPointer(o,a,e.FLOAT,!1,s,i)),Je(e,()=>e.enableVertexAttribArray(o)),!0)}function EZ(e,t,r){RZ(e,r),Je(e,()=>e.activeTexture(e.TEXTURE0+r)),Je(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function yVe(e,t){RZ(e,t),Je(e,()=>e.activeTexture(e.TEXTURE0+t)),Je(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function TZ(e,t,r){return xu(e,()=>e.getUniformLocation(t,r),'uniform "'+r+'" not present in program.')}function jZ(e,t,r){return e.getUniformLocation(t,r)}function AZ(e,t,r,n){Je(e,()=>EZ(e,t,n)),Je(e,()=>e.uniform1i(r,n))}function vVe(e){Je(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Je(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),Je(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function tN(e,t,r){Je(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,r)),Je(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function dj(e,t){Je(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Je(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function sv(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+$Z(e,t))}function $Z(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function xu(e,t,r){let n=Je(e,()=>t());if(n==null)throw new Error(r);return n}function RZ(e,t){let r=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+e.TEXTURE0;if(n<e.TEXTURE0||n>r){let a=`[gl.TEXTURE0, gl.TEXTURE${r}]`;throw new Error(`textureUnit must be in ${a}.`)}}function Fh(e,t=2){return R.sizeFromShape(e.slice(0,e.length-t))}function Oh(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function iv(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Fh(e),...Oh(e)]),t}function DZ(e,t=!1){let r=ge().getNumber("WEBGL_MAX_TEXTURE_SIZE"),n=ge().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");n===1/0&&ge().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(n=r/2),t&&(r=r*2,n=n*2,e=e.map((o,u)=>u>=e.length-2?R.nearestLargerEven(e[u]):e[u]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=R.squeezeShape(e).newShape);let a=R.sizeFromShape(e),s=null;e.length<=1&&a<=r?s=[1,a]:e.length===2&&e[0]<=r&&e[1]<=r?s=e:e.length===3&&e[0]*e[1]<=r&&e[2]<=r?s=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=r&&e[1]*e[2]<=r?s=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r?s=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r&&(s=[e[0],e[1]*e[2]*e[3]]);let i=s!=null&&Math.max(...s)>n&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(s==null||i)if(t){let o=Fh(e),u=2,d=2;e.length&&([u,d]=Oh(e)),a=o*(u/2)*(d/2),s=R.sizeToSquarishShape(a).map(c=>c*2)}else s=R.sizeToSquarishShape(a);return s}function x1(e){return e%2===0}function vb(e,t){if(e=e.slice(-2),t=t.slice(-2),R.arraysEqual(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){let r=e[e.length-1],n=t[t.length-1];if(r===n||x1(r)&&x1(n)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&x1(e[0])&&x1(t[0])}var rN,nN;function MZ(e){if(rN==null){let t=Ao(e);rN=t.getParameter(t.MAX_TEXTURE_SIZE)}return rN}function bVe(){rN=null}function wVe(){nN=null}function FZ(e){if(nN==null){let t=Ao(e);nN=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,nN)}function OZ(e){if(e===0)return 0;let t,r=Ao(e);return ci(r,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:ci(r,"EXT_disjoint_timer_query")?t=1:t=0,t}function ci(e,t){return e.getExtension(t)!=null}function hj(e){try{if(Ao(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function PZ(e){if(e===0)return!1;let t=Ao(e);if(e===1){if(!ci(t,"OES_texture_float"))return!1}else if(!ci(t,"EXT_color_buffer_float"))return!1;return pj(t)}function LZ(e){if(e===0)return!1;let t=Ao(e);if(e===1){if(!ci(t,"OES_texture_float")||!ci(t,"WEBGL_color_buffer_float"))return!1}else{if(ci(t,"EXT_color_buffer_float"))return pj(t);let r="EXT_color_buffer_half_float";if(ci(t,r)){let n=t.getExtension(r);return NVe(t,n)}return!1}return pj(t)}function pj(e){let t=QF(e),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(n),a}function NVe(e,t){let r=QF(e,t),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,r.internalFormatHalfFloat,1,1,0,r.textureFormatFloat,r.textureTypeHalfFloat,null);let a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),s}function zZ(e){return e!==2?!1:Ao(e).fenceSync!=null}function cy(e,t){Array.isArray(e)||(e=[e]),e.forEach(r=>{r!=null&&R.assert(r.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var xt=ge();xt.registerFlag("HAS_WEBGL",()=>xt.getNumber("WEBGL_VERSION")>0);xt.registerFlag("WEBGL_VERSION",()=>hj(2)?2:hj(1)?1:0);xt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);xt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>xt.get("WEBGL_VERSION")===2);xt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);xt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);xt.registerFlag("WEBGL_PACK",()=>xt.getBool("HAS_WEBGL"));xt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_CLIP",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_REDUCE",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_LAZILY_UNPACK",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_CONV_IM2COL",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>MZ(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>FZ(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=xt.getNumber("WEBGL_VERSION");return e===0?0:OZ(e)});xt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>xt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!M0.isMobile());xt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>PZ(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>xt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:xt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));xt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>LZ(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>zZ(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>xt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);xt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});xt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>M0.isMobile()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});xt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);xt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);xt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);xt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);xt.registerFlag("WEBGL_EXP_CONV",()=>!1);xt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>xt.getBool("IS_TEST"));xt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);xt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);xt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);xt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function ss(){let e,t,r,n,a,s,i,o,u,d;return ge().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",r="out",n="in",a="texture",s="outputColor",i="out vec4 outputColor;",o=ge().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",d=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",r="varying",n="varying",a="texture2D",s="gl_FragColor",i="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,d=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:r,varyingFs:n,texture2D:a,output:s,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:u,defineRound:d}}function Nf(e,t,r="index"){let n=R.computeStrides(t);return n.map((a,s)=>{let i=`int ${e[s]} = ${r} / ${a}`,o=s===n.length-1?`int ${e[s+1]} = ${r} - ${e[s]} * ${a}`:`index -= ${e[s]} * ${a}`;return`${i}; ${o};`}).join("")}function AC(e,t,r="index"){let n=R.computeStrides(t);return n.map((a,s)=>{let i=`int ${e[s]} = ${r} / outShapeStrides[${s}]`,o=s===n.length-1?`int ${e[s+1]} = ${r} - ${e[s]} * outShapeStrides[${s}]`:`index -= ${e[s]} * outShapeStrides[${s}]`;return`${i}; ${o};`}).join("")}function SVe(e,t){let r=e.length,n=e.map(s=>`${t}[${s}]`),a=new Array(r-1);a[r-2]=n[r-1];for(let s=r-3;s>=0;--s)a[s]=`(${a[s+1]} * ${n[s+1]})`;return a}function _Ve(e,t,r="index"){let n=e.map((s,i)=>i),a=SVe(n,t);return a.map((s,i)=>{let o=`int ${e[i]} = ${r} / ${a[i]}`,u=i===a.length-1?`int ${e[i+1]} = ${r} - ${e[i]} * ${a[i]}`:`index -= ${e[i]} * ${a[i]}`;return`${o}; ${u};`}).join("")}function YF(e){let t=R.computeStrides(e).map(r=>r.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function JF(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var BZ=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`,{getBroadcastDims:UZ}=H;function kVe(e,t,r){let n=[];if(e.forEach(p=>{let f=R.sizeFromShape(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?n.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(n.push(`uniform sampler2D ${p.name};`),n.push(`uniform int offset${p.name};`)),r.enableShapeUniforms){let{uniformShape:g}=ZF(r.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(g.length){case 1:n.push(`uniform int ${p.name}Shape;`);break;case 2:n.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:n.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:n.push(`uniform ivec4 ${p.name}Shape;`);break}n.push(`uniform ivec2 ${p.name}TexShape;`)}}),r.enableShapeUniforms){switch(t.logicalShape.length){case 1:n.push("uniform int outShape;");break;case 2:n.push("uniform ivec2 outShape;"),n.push("uniform int outShapeStrides;");break;case 3:n.push("uniform ivec3 outShape;"),n.push("uniform ivec2 outShapeStrides;");break;case 4:n.push("uniform ivec4 outShape;"),n.push("uniform ivec3 outShapeStrides;");break}n.push("uniform ivec2 outTexShape;")}r.customUniforms&&r.customUniforms.forEach(p=>{n.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});let a=n.join(`
`),s=e.map(p=>CVe(p,t,r.packedInputs,r.enableShapeUniforms)).join(`
`),i=t.texShape,o=ss(),u=TVe(o),d,c,h=$Ve(o);return t.isPacked?(d=IVe(t.logicalShape,i,r.enableShapeUniforms),c=AVe(o)):(d=EVe(t.logicalShape,i,r.enableShapeUniforms),c=jVe(o)),r.packedInputs&&(h+=FVe),[h,u,c,a,d,s,r.userCode].join(`
`)}function dy(e,t=!1){let r=e.shapeInfo.logicalShape;switch(r.length){case 0:return KVe(e,t);case 1:return XVe(e,t);case 2:return JVe(e,t);case 3:return eHe(e,t);case 4:return rHe(e,t);case 5:return nHe(e);case 6:return aHe(e);default:throw new Error(`${r.length}-D input sampling is not yet supported`)}}function WZ(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return GVe(e);case 1:return QVe(e,t);case 2:return YVe(e,t);case 3:return ZVe(e,t);default:return tHe(e,t)}}function CVe(e,t,r=!1,n){let a="";r?a+=WZ(e,n):a+=dy(e,n);let s=e.shapeInfo.logicalShape,i=t.logicalShape;return s.length<=i.length&&(r?a+=sHe(e,t):a+=iHe(e,t)),a}function IVe(e,t,r){switch(e.length){case 0:return VZ();case 1:return OVe(e,t,r);case 2:return HVe(e,t,r);case 3:return LVe(e,t,r);default:return BVe(e,t,r)}}function EVe(e,t,r){switch(e.length){case 0:return VZ();case 1:return PVe(e,t,r);case 2:return qVe(e,t,r);case 3:return zVe(e,t,r);case 4:return UVe(e,t,r);case 5:return WVe(e,t);case 6:return VVe(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function TVe(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function jVe(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function AVe(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function $Ve(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${RVe}
    ${DVe}
    ${MVe}
  `}var RVe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,DVe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,MVe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,FVe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function VZ(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function OVe(e,t,r){let n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return n[0]===1?r?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${n[1]}.0);
      }
    `:n[1]===1?r?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${n[0]}.0);
      }
    `:r?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);
    }
  `}function PVe(e,t,r){return t[0]===1?r?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?r?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:r?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function LVe(e,t,r){if(r)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),s=a*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function zVe(e,t,r){if(r)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${AC(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;let n=Nf(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${n}
      return ivec3(r, c, d);
    }
  `}function BVe(e,t,r){if(r)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),s=a*Math.ceil(e[e.length-2]/2),i=s,o="",u="b, r, c";for(let d=2;d<e.length-1;d++)i*=e[e.length-d-1],o=`
      int b${d} = index / ${i};
      index -= b${d} * ${i};
    `+o,u=`b${d}, `+u;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${o}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${e.length}(${u});
    }
  `}function UVe(e,t,r){if(r)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${AC(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;let n=Nf(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${n}
      return ivec4(r, c, d, d2);
    }
  `}function WVe(e,t){let r=Nf(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${r}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function VVe(e,t){let r=Nf(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${r}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function HVe(e,t,r){let n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(R.arraysEqual(e,t))return r?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));
      }
    `;let a=Math.ceil(e[1]/2);return r?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));

      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function qVe(e,t,r){return R.arraysEqual(e,t)?r?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?r?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?r?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:r?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function Sf(e){return`offset${e}`}function GVe(e){let t=e.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),n=ss();return`
    vec4 ${r}() {
      return ${n.texture2D}(${t}, halfCR);
    }
  `}function KVe(e,t){let r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`float ${n}() {return ${r};}`;let[a,s]=e.shapeInfo.texShape;if(a===1&&s===1)return`
      float ${n}() {
        return sampleTexture(${r}, halfCR);
      }
    `;let i=Sf(r);if(t)return`
    float ${n}() {
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], ${i});
      return sampleTexture(${r}, uv);
    }
  `;let[o,u]=e.shapeInfo.texShape;return`
    float ${n}() {
      vec2 uv = uvFromFlat(${o}, ${u}, ${i});
      return sampleTexture(${r}, uv);
    }
  `}function QVe(e,t){let r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,s=ss();if(t)return`
    vec4 ${n}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${r}, uv);
    }
  `;let i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${n}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${s.texture2D}(${r}, uv);
    }
  `}function XVe(e,t){let r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`
      float ${n}(int index) {
        ${hy(e)}
      }
    `;let a=e.shapeInfo.texShape,s=a[0],i=a[1];if(i===1&&s===1)return`
      float ${n}(int index) {
        return sampleTexture(${r}, halfCR);
      }
    `;let o=Sf(r);return i===1?t?`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${s}.0);
        return sampleTexture(${r}, uv);
      }
    `:s===1?t?`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${r}, uv);
      }
    `:t?`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${o});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${s}, ${i}, index + ${o});
      return sampleTexture(${r}, uv);
    }
  `}function YVe(e,t){let r=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape,i=s[0],o=s[1],u=ss();if(s!=null&&R.arraysEqual(r,s))return t?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);

        return ${u.texture2D}(${n}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);

        return ${u.texture2D}(${n}, uv);
      }
    `;if(t)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${n}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${n}, uv);
    }
  `;let d=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Math.ceil(r[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${d[0]}, ${d[1]}, row, col);
      return ${u.texture2D}(${n}, uv);
    }
  `}function JVe(e,t){let r=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape;if(s!=null&&R.arraysEqual(r,s)){if(t)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `;let p=s[0],f=s[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${n}, uv);
    }
  `}let{newShape:i,keptDims:o}=R.squeezeShape(r),u=i;if(u.length<r.length){let p=py(e,u),f=["row","col"];return`
      ${dy(p,t)}
      float ${a}(int row, int col) {
        return ${a}(${fy(f,o)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${r[1]}, 1)));
        ${hy(e)}
      }
    `;let d=s[0],c=s[1],h=Sf(n);return c===1?t?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${n}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${r[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${d}.0);
      return sampleTexture(${n}, uv);
    }
  `:d===1?t?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${n}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${r[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${n}, uv);
    }
  `:t?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${n}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);
        return sampleTexture(${n}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${r[1]} + col + ${h};
    vec2 uv = uvFromFlat(${d}, ${c}, index);
    return sampleTexture(${n}, uv);
  }
`}function ZVe(e,t){let r=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(r[0]===1){let p=r.slice(1),f=[1,2],g=py(e,p),m=["b","row","col"];return`
        ${WZ(g,t)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${fy(m,f)});
        }
      `}let o=ss();if(t)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${n}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${n}, uv);
    }
  `;let u=i[0],d=i[1],c=Math.ceil(r[2]/2),h=c*Math.ceil(r[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${d}, ${h}, ${c}, b, row, col);
      return ${o.texture2D}(${n}, uv);
    }
  `}function eHe(e,t){let r=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=r[1]*r[2],i=r[2],{newShape:o,keptDims:u}=R.squeezeShape(r),d=o;if(d.length<r.length){let m=py(e,d),x=["row","col","depth"];return`
        ${dy(m,t)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${fy(x,u)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${i}, 1)));
        ${hy(e)}
      }
    `;let c=e.shapeInfo.texShape,h=c[0],p=c[1],f=e.shapeInfo.flatOffset;if(p===s&&f==null)return t?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${n}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${h}.0);
          return sampleTexture(${n}, uv);
        }
      `;if(p===i&&f==null)return t?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${n}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${r[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${n}, uv);
    }
  `;let g=Sf(n);return t?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${n}Shape[1] * ${n}Shape[2];
      int stride1 = ${n}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${g};
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);
      return sampleTexture(${n}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${i} + depth + ${g};
        vec2 uv = uvFromFlat(${h}, ${p}, index);
        return sampleTexture(${n}, uv);
      }
  `}function tHe(e,t){let r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),a=ss();if(t)return`
    vec4 ${n}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${r}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${r}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${r}, uv);
    }
  `;let s=e.shapeInfo.logicalShape,i=s.length,o=e.shapeInfo.texShape,u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],d=u[0],c=u[1],h=Math.ceil(s[i-1]/2),p=h*Math.ceil(s[i-2]/2),f="int b, int row, int col",g=`b * ${p} + (row / 2) * ${h} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,p*=s[i-m-1],g=`b${m} * ${p} + `+g;return`
    vec4 ${n}(${f}) {
      int index = ${g};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${d});
      return ${a.texture2D}(${r}, uv);
    }
  `}function rHe(e,t){let r=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=r[3],i=r[2]*s,o=r[1]*i,{newShape:u,keptDims:d}=R.squeezeShape(r);if(u.length<r.length){let v=py(e,u),b=["row","col","depth","depth2"];return`
      ${dy(v,t)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${fy(b,d)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${i}, ${s}, 1)));
        ${hy(e)}
      }
    `;let c=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1],g=`int stride2 = ${n}Shape[3];`,m=`int stride1 = ${n}Shape[2] * stride2;`,x=`int stride0 = ${n}Shape[1] * stride1;`;if(f===o&&c==null)return t?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${g}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&c==null)return t?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n}Shape[1] * ${n}Shape[2], ${n}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${n}TexShape[1], ${n}TexShape[0]);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r[1]*r[2]}, ${r[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;let y=Sf(n);return t?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${g}
      ${m}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${y});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${p}, ${f}, index + ${y});
      return sampleTexture(${n}, uv);
    }
  `}function nHe(e){let t=e.shapeInfo.logicalShape,r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t[4],s=t[3]*a,i=t[2]*s,o=t[1]*i,{newShape:u,keptDims:d}=R.squeezeShape(t);if(u.length<t.length){let m=py(e,u),x=["row","col","depth","depth2","depth3"];return`
      ${dy(m)}
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        return ${n}(${fy(x,d)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${i}, ${s}, ${a})) +
          depth3;
        ${hy(e)}
      }
    `;let c=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];if(f===o&&c==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${s}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===a&&c==null)return`
      float ${n}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;let g=Sf(r);return`
    float ${n}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} + depth * ${s} +
          depth2 * ${a} + depth3 + ${g};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${r}, uv);
    }
  `}function aHe(e){let t=e.shapeInfo.logicalShape,r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),{newShape:a,keptDims:s}=R.squeezeShape(t);if(a.length<t.length){let x=py(e,a),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${dy(x)}
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${n}(${fy(y,s)});
      }
    `}let i=t[5],o=t[4]*i,u=t[3]*o,d=t[2]*u,c=t[1]*d;if(e.shapeInfo.isUniform)return`
      float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${d}, ${u}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${hy(e)}
      }
    `;let h=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,f=p[0],g=p[1];if(g===c&&h==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${d}, ${u}, ${o}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(g===i&&h==null)return`
      float ${n}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;let m=Sf(r);return`
    float ${n}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${d} + depth * ${u} +
          depth2 * ${o} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${g}, index);
      return sampleTexture(${r}, uv);
    }
  `}function hy(e){let t=e.name,r=R.sizeFromShape(e.shapeInfo.logicalShape);return r<2?`return ${t};`:`
    for (int i = 0; i < ${r}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function sHe(e,t){let r=e.name,n=r.charAt(0).toUpperCase()+r.slice(1),a="get"+n+"AtOutCoords",s=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,o=UZ(e.shapeInfo.logicalShape,t.logicalShape),u=Ur(i),d=i-s,c,h=["x","y","z","w","u","v"];s===0?c="":i<2&&o.length>=1?c="coords = 0;":c=o.map(x=>`coords.${h[x+d]} = 0;`).join(`
`);let p="";i<2&&s>0?p="coords":p=e.shapeInfo.logicalShape.map((x,y)=>`coords.${h[y+d]}`).join(", ");let f="return outputValue;",g=R.sizeFromShape(e.shapeInfo.logicalShape)===1,m=R.sizeFromShape(t.logicalShape)===1;if(s===1&&!g&&!m)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!m)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(o.length){let x=s-2,y=s-1;o.indexOf(x)>-1&&o.indexOf(y)>-1?f="return vec4(outputValue.x);":o.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(y)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${u} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${n}(${p});
      ${f}
    }
  `}function iHe(e,t){let r=e.name,n=r.charAt(0).toUpperCase()+r.slice(1),a="get"+n+"AtOutCoords",s=t.texShape,i=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===u&&e.shapeInfo.flatOffset==null&&R.arraysEqual(i,s))return`
      float ${a}() {
        return sampleTexture(${r}, resultUV);
      }
    `;let d=Ur(u),c=UZ(e.shapeInfo.logicalShape,t.logicalShape),h=u-o,p,f=["x","y","z","w","u","v"];o===0?p="":u<2&&c.length>=1?p="coords = 0;":p=c.map(m=>`coords.${f[m+h]} = 0;`).join(`
`);let g="";return u<2&&o>0?g="coords":g=e.shapeInfo.logicalShape.map((m,x)=>`coords.${f[x+h]}`).join(", "),`
    float ${a}() {
      ${d} coords = getOutputCoords();
      ${p}
      return get${n}(${g});
    }
  `}function Ur(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function ZF(e,t,r){let{newShape:n,keptDims:a}=R.squeezeShape(t),s=t.length,i=e&&s===3&&t[0]===1,o=i?t.slice(1):n,u=!e&&s>1&&!R.arraysEqual(t,r)&&n.length<s||i;return{useSqueezeShape:u,uniformShape:u?o:t,keptDims:a}}function py(e,t){let r=JSON.parse(JSON.stringify(e));return r.shapeInfo.logicalShape=t,r}function fy(e,t){return t.map(r=>e[r]).join(", ")}function oHe(e,t,r,n){let a=r.map((c,h)=>{let p={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(p.flatOffset=c.texData.slice.flatOffset),{name:t.variableNames[h],shapeInfo:p}}),s=a.map(c=>c.shapeInfo),i={logicalShape:n.shape,texShape:n.texData.texShape,isUniform:!1,isPacked:n.texData.isPacked,flatOffset:null},o=kVe(a,i,t),u=bZ(e.gl,o),d=e.createProgram(u);return ge().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:o,webGLProgram:d,inShapeInfos:s,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(d),Object.assign({program:t,fragmentShader:u,source:o,webGLProgram:d,inShapeInfos:s,outShapeInfo:i},HZ(e,t,d)))}function HZ(e,t,r){let n=[],a=[],s,i,o,u=null,d=null;d=e.getUniformLocation(r,"NAN",!1),ge().getNumber("WEBGL_VERSION")===1&&(u=e.getUniformLocation(r,"INFINITY",!1));let c=!1;for(let h of t.variableNames){let p={name:h,uniform:e.getUniformLocation(r,h,c),offset:e.getUniformLocation(r,`offset${h}`,c)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(r,`${h}Shape`,c),p.texShape=e.getUniformLocation(r,`${h}TexShape`,c)),n.push(p)}if(t.enableShapeUniforms&&(s=e.getUniformLocation(r,"outShape",c),o=e.getUniformLocation(r,"outShapeStrides",c),i=e.getUniformLocation(r,"outTexShape",c)),t.customUniforms)for(let h of t.customUniforms)a.push(e.getUniformLocation(r,h.name,c));return{variablesLocations:n,customUniformLocations:a,infLoc:u,nanLoc:d,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:i}}function lz(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((r,n)=>{let a=r.logicalShape,s=t[n],i=s.shape;if(!R.arraysEqual(a,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${i} must match`);if(r.isUniform&&s.isUniform)return;let o=r.texShape,u=s.isUniform?null:s.texData.texShape;if(!R.arraysEqual(o,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${u} must match`)})}function lHe(e,t,r,n,a){t.program.enableShapeUniforms||(lz(t.inShapeInfos,r),lz([t.outShapeInfo],[n]));let s=n.texData.texture,i=n.texData.texShape;n.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,i[0],i[1]):e.setOutputMatrixTexture(s.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),ge().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let u=0;u<r.length;++u){let d=r[u],{uniform:c,offset:h,shape:p,texShape:f}=t.variablesLocations[u];if(p){let{uniformShape:g}=ZF(t.program.packedInputs,d.shape,d.texData.texShape);switch(g.length){case 1:e.gl.uniform1iv(p,new Int32Array(g));break;case 2:e.gl.uniform2iv(p,new Int32Array(g));break;case 3:e.gl.uniform3iv(p,new Int32Array(g));break;case 4:e.gl.uniform4iv(p,new Int32Array(g));break}}if(f&&e.gl.uniform2i(f,d.texData.texShape[0],d.texData.texShape[1]),c!=null){if(d.isUniform){if(R.sizeFromShape(d.shape)<2)e.gl.uniform1f(c,d.uniformValues[0]);else{let g=d.uniformValues;g instanceof Float32Array||(g=new Float32Array(g)),e.gl.uniform1fv(c,g)}continue}d.texData.slice!=null&&h!=null&&e.gl.uniform1i(h,d.texData.slice.flatOffset),e.setInputMatrixTexture(d.texData.texture.texture,c,u)}}let o=t.outShapeLocation;if(o)switch(n.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(n.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(n.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(n.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(n.shape));break}if(t.outShapeStridesLocation){let u=R.computeStrides(n.shape);switch(n.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(u));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(u));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(u));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,n.texData.texShape[0],n.texData.texShape[1]),t.program.customUniforms&&a)for(let u=0;u<t.program.customUniforms.length;++u){let d=t.program.customUniforms[u],c=t.customUniformLocations[u],h=a[u];if(d.type==="float")e.gl.uniform1fv(c,h);else if(d.type==="vec2")e.gl.uniform2fv(c,h);else if(d.type==="vec3")e.gl.uniform3fv(c,h);else if(d.type==="vec4")e.gl.uniform4fv(c,h);else if(d.type==="int")e.gl.uniform1iv(c,h);else if(d.type==="ivec2")e.gl.uniform2iv(c,h);else if(d.type==="ivec3")e.gl.uniform3iv(c,h);else if(d.type==="ivec4")e.gl.uniform4iv(c,h);else throw Error(`uniform type ${d.type} is not supported yet.`)}e.executeProgram()}function uHe(e,t,r){let n="";t.concat(r).forEach(i=>{let o=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!i.isUniform){let u=i.texData.texShape,{useSqueezeShape:d,uniformShape:c,keptDims:h}=ZF(e.packedInputs,i.shape,u),p="",f="",g="";if(c.length===1&&e.packedInputs){let S=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];p=`${S[0]>1}_${S[1]>1}`}else if(c.length===2&&!e.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!e.packedInputs){let S=R.computeStrides(c);g=`${S[0]===u[1]}_${S[S.length-1]===u[1]}`}let m=i.shape.length,x=c.length===2&&R.arraysEqual(i.shape,u),y=R.sizeFromShape(i.shape)===1,v=H.getBroadcastDims(i.shape,r.shape),b=!e.packedInputs&&m===r.shape.length&&R.arraysEqual(u,r.texData.texShape),N=e.packedInputs||c.length>2?"":`${u[0]>1}_${u[1]>1}`;n+=`${m}_${b}_${d?h:""}_${c.length}_${y}_${v}_${x}_${p}_${f}_${g}_${N}_${o}`}else{let u=i.isUniform?"uniform":i.texData.texShape;n+=`${i.shape}_${u}_${o}`}});let a=e.userCode,s=e.constructor.name;return s+="_"+n+"_"+a+`${ge().getNumber("WEBGL_VERSION")}`,s}function Pa(e){return ge().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var cHe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=yb.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=ss();this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?AC(["r","c","d"],e):Nf(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}},dHe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=yb.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=ss();this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?AC(["r","c","d"],e):Nf(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}},hHe=class{constructor(e){this.variableNames=["A"],this.outTexUsage=ui.DOWNLOAD;let t=ss();this.outputShape=e,this.userCode=`
      ${BZ}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}},pHe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ui.DOWNLOAD;let t=ss();this.outputShape=e,this.userCode=`
      ${BZ}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}},fHe={R:0,G:1,B:2,A:3},uz=class{constructor(e,t=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=ss();this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let s="";for(let i=0;i<r.length;i++){let o=r[i];s+=`
          if(offset == ${i}) {
            result = values[${fHe[o]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?JF():YF(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${n.texture2D}(A, uv);
          ${s}
        }
        ${n.output} = vec4(${a}, 0., 0., 0.);
      }
    `}},mHe=class{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=ss();this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length);let n="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let i=0;i<=1;i++){let o=s*2+i;n+=`
          localCoords = coords;
          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${i};
          if (localCoords[1] + ${s} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${s};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${o}] = values[0];
            } else if (offset == 1) {
              result[${o}] = values[1];
            } else if (offset == 2) {
              result[${o}] = values[2];
            } else {
              result[${o}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?JF():YF(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${n}

          ${r.output} = ${a};
        }
    `}},qZ={};Ut(qZ,{bindVertexProgramAttributeStreams:()=>tee,createBufferFromOutputTexture:()=>aee,createFloat16MatrixTexture:()=>YZ,createFloat16PackedMatrixTexture:()=>eee,createFloat32MatrixTexture:()=>XZ,createIndexBuffer:()=>QZ,createPackedMatrixTexture:()=>ZZ,createUnsignedBytesMatrixTexture:()=>JZ,createVertexBuffer:()=>KZ,createVertexShader:()=>GZ,downloadByteEncodedFloatMatrixFromOutputTexture:()=>iee,downloadFloat32MatrixFromBuffer:()=>see,downloadMatrixFromPackedOutputTexture:()=>lee,downloadPackedMatrixFromBuffer:()=>oee,getInternalFormatForFloat16MatrixTexture:()=>tO,getInternalFormatForFloat16PackedMatrixTexture:()=>aO,getInternalFormatForFloat32MatrixTexture:()=>eO,getInternalFormatForPackedMatrixTexture:()=>nO,getInternalFormatForUnsignedBytesMatrixTexture:()=>rO,uploadDenseMatrixToTexture:()=>ree,uploadPixelDataToTexture:()=>nee});function GZ(e){let t=ss(),r=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return vZ(e,r)}function KZ(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return SZ(e,t)}function QZ(e){let t=new Uint16Array([0,1,2,2,1,3]);return _Z(e,t)}function lw(e,t,r,n,a,s){CZ(t,r);let i=kZ(e),o=e.TEXTURE_2D;return Je(e,()=>e.bindTexture(o,i)),Je(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Je(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Je(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),Je(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),ge().getNumber("WEBGL_VERSION")===1?Je(e,()=>e.texImage2D(o,0,n,t,r,0,a,s,null)):Je(e,()=>e.texStorage2D(o,1,n,t,r)),Je(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:i,texShape:[r,t]}}function eO(e){return e.internalFormatFloat}function XZ(e,t,r,n){let[a,s]=ow(t,r);return lw(e,a,s,eO(n),n.textureFormatFloat,e.FLOAT)}function tO(e){return e.internalFormatHalfFloat}function YZ(e,t,r,n){let[a,s]=ow(t,r);return lw(e,a,s,tO(n),n.textureFormatFloat,n.textureTypeHalfFloat)}function rO(e){return e.downloadTextureFormat}function JZ(e,t,r,n){let[a,s]=ow(t,r);return lw(e,a,s,rO(n),e.RGBA,e.UNSIGNED_BYTE)}function nO(e){return e.internalFormatPackedFloat}function ZZ(e,t,r,n){let[a,s]=uy(t,r);return lw(e,a,s,nO(n),e.RGBA,e.FLOAT)}function aO(e){return e.internalFormatPackedHalfFloat}function eee(e,t,r,n){let[a,s]=uy(t,r);return lw(e,a,s,aO(n),e.RGBA,n.textureTypeHalfFloat)}function tee(e,t,r){return Je(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),cj(e,t,"clipSpacePos",r,3,20,0)&&cj(e,t,"uv",r,2,20,12)}function ree(e,t,r,n,a,s){Je(e,()=>e.bindTexture(e.TEXTURE_2D,t));let i,o,u;a instanceof Uint8Array?(i=new Uint8Array(r*n*4),o=e.UNSIGNED_BYTE,u=e.RGBA):(i=new Float32Array(r*n*4),o=e.FLOAT,u=s.internalFormatPackedFloat),i.set(a),ge().getNumber("WEBGL_VERSION")===2?Je(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,r,n,e.RGBA,o,i)):Je(e,()=>e.texImage2D(e.TEXTURE_2D,0,u,r,n,0,e.RGBA,o,i)),Je(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function nee(e,t,r){Je(e,()=>e.bindTexture(e.TEXTURE_2D,t)),r.data instanceof Uint8Array?ge().getNumber("WEBGL_VERSION")===2?Je(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,e.RGBA,e.UNSIGNED_BYTE,r.data)):Je(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)):ge().getNumber("WEBGL_VERSION")===2?Je(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,r)):Je(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)),Je(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function aee(e,t,r,n){let a=e.createBuffer();Je(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,a));let s=4*4*t*r;return Je(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ)),Je(e,()=>e.readPixels(0,0,r,t,e.RGBA,e.FLOAT,0)),Je(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),a}function see(e,t,r){let n=e,a=new Float32Array(r);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function iee(e,t,r,n){let[a,s]=ow(t,r),i=4,o=new Uint8Array(dVe(t*r,i));return Je(e,()=>e.readPixels(0,0,a,s,n.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function oee(e,t,r,n,a,s,i,o){let u=e,d=new Float32Array(hVe(s,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,d),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),d}function lee(e,t,r){let n=new Float32Array(t*r*4);return Je(e,()=>e.readPixels(0,0,r,t,e.RGBA,e.FLOAT,n)),n}var aN=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=ge().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,gZ(t,e)):this.gl=Ao(t),e=this.gl,ge().getNumber("WEBGL_VERSION")===2){let a=e;this.createVertexArray=()=>Je(a,()=>a.createVertexArray()),this.bindVertexArray=s=>Je(a,()=>a.bindVertexArray(s)),this.deleteVertexArray=s=>Je(a,()=>a.deleteVertexArray(s)),this.getVertexArray=()=>Je(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){let a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Je(e,()=>a.createVertexArrayOES()),this.bindVertexArray=s=>Je(e,()=>a.bindVertexArrayOES(s)),this.deleteVertexArray=s=>Je(e,()=>a.deleteVertexArrayOES(s)),this.getVertexArray=()=>Je(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float",n="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ge().getNumber("WEBGL_VERSION")===1){let a="OES_texture_float",s="OES_texture_half_float";if(this.textureFloatExtension=av(this.gl,a),ci(this.gl,s))this.textureHalfFloatExtension=av(this.gl,s);else if(ge().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ci(this.gl,n))this.colorBufferHalfFloatExtension=av(this.gl,n);else if(ge().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ci(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(ci(this.gl,n))this.colorBufferHalfFloatExtension=this.gl.getExtension(n);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=KZ(this.gl),this.indexBuffer=QZ(this.gl),this.framebuffer=IZ(this.gl),this.textureConfig=QF(this.gl,this.textureHalfFloatExtension)}get debug(){return ge().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;Je(e,()=>e.finish()),Je(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Je(e,()=>e.deleteFramebuffer(this.framebuffer)),Je(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Je(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Je(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),XZ(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),YZ(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),JZ(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),nee(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,n){this.throwIfDisposed(),ree(this.gl,e,t,r,n,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),eee(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),ZZ(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(dj(this.gl,this.framebuffer),this.outputTexture=null),Je(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>iee(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,n,a,s){return oee(this.gl,e,t,r,n,a,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return see(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);let n=aee(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),n}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(ge().getBool("WEBGL_FENCE_API_ENABLED")){let n=e,a=n.fenceSync(n.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{let s=n.clientWaitSync(a,0,0);return s===n.ALREADY_SIGNALED||s===n.CONDITION_SATISFIED},t=a}else ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>lee(this.gl,t,r))}createProgram(e){this.throwIfDisposed();let t=this.gl;this.vertexShader==null&&(this.vertexShader=GZ(t));let r=wZ(t);Je(t,()=>t.attachShader(r,this.vertexShader)),Je(t,()=>t.attachShader(r,e)),NZ(t,r);let n=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&eN(t,n),n}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;Je(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),tee(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Je(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&eN(this.gl,this.program),Je(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?TZ(this.gl,e,t):jZ(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Je(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),AZ(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();let[n,a]=uy(t,r);this.setOutputMatrixTextureDriver(e,n,a)}setOutputMatrixWriteRegion(e,t,r,n){this.setOutputMatrixWriteRegionDriver(r,e,n,t)}setOutputPackedMatrixWriteRegion(e,t,r,n){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&eN(this.gl,this.program),sv(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Je(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Je(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=av(this.gl,ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let r=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=r.createQuery();return r.beginQuery(n.TIME_ELAPSED_EXT,a),a}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await R.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){let r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{let r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){let r=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{let r=this.getQueryTimerExtensionWebGL1(),n=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=gHe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ge().platform&&(r=ge().platform.setTimeoutCustom.bind(ge().platform)),R.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),tN(this.gl,e,this.framebuffer),this.debug&&sv(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(tN(this.gl,this.outputTexture,this.framebuffer),this.debug&&sv(this.gl)):dj(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();let n=this.gl;tN(n,e,this.framebuffer),this.debug&&sv(n),this.outputTexture=e,Je(n,()=>n.viewport(0,0,t,r)),Je(n,()=>n.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,n){this.throwIfDisposed(),Je(this.gl,()=>this.gl.scissor(e,t,r,n))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function gHe(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var{addImpl:xHe,bincountImpl:uee,bincountReduceImpl:yHe,bitwiseAndImpl:vHe,castImpl:bHe,ceilImpl:wHe,concatImpl:NHe,equalImpl:SHe,expImpl:_He,expm1Impl:kHe,floorImpl:CHe,gatherNdImpl:IHe,gatherV2Impl:EHe,greaterImpl:THe,greaterEqualImpl:jHe,lessImpl:AHe,lessEqualImpl:$He,linSpaceImpl:RHe,logImpl:DHe,maxImpl:MHe,maximumImpl:FHe,minimumImpl:OHe,multiplyImpl:PHe,negImpl:LHe,notEqualImpl:zHe,prodImpl:BHe,raggedGatherImpl:UHe,raggedRangeImpl:WHe,raggedTensorToTensorImpl:VHe,rangeImpl:HHe,rsqrtImpl:qHe,scatterImpl:GHe,sigmoidImpl:KHe,simpleAbsImpl:cee,sliceImpl:QHe,sparseFillEmptyRowsImpl:XHe,sparseReshapeImpl:YHe,sparseSegmentReductionImpl:dee,sqrtImpl:JHe,staticRegexReplaceImpl:ZHe,stridedSliceImpl:eqe,stringNGramsImpl:tqe,stringSplitImpl:rqe,stringToHashBucketFastImpl:nqe,subImpl:aqe,tileImpl:sqe,topKImpl:iqe,transposeImpl:sO,uniqueImpl:oqe}=RF;function hee(e,t){return["x","y","z","w","u","v"].slice(0,t).map(r=>`${e}.${r}`)}function Ka(e,t){return t===1?[e]:hee(e,t)}function lqe(e,t){if(e===1)return"rc";let r="";for(let n=0;n<e;n++)r+=t[n],n<e-1&&(r+=",");return r}var uqe=class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Pa(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let t=Ka("rc",this.rank),r=Ur(this.rank),n=this.getOutOfBoundsCondition(t),a=this.getSetup(t),s=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${n}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${s}));
          }
        }
      `}}getSourceCoordsArr(e){let t=[];for(let r=0;r<=1;r++)for(let n=0;n<=1;n++){let a=`${r===0?"r":"rp1"}, ${n===0?"c":"cp1"}`;for(let s=2;s<this.rank;s++)a=`${e[e.length-1-s]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";let t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],n=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${n};
    `}getOutput(e){let t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}},pee=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length);let r="";for(let n=0;n<4;n++){let a="thisRC = rc;";n%2===1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),r+=`
        ${a}
        ${n>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${n}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${n>0?"}":""}
      `}this.userCode=`
      ${cqe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?JF():YF(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}};function cqe(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?_Ve(["r","c","d"],"inputShape"):Nf(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}var dqe=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,r){let n=dz(t,r),a=hz(e,n,r);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);let s=cz(e,n,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();let o=this.freeTextures[a].pop();return this.usedTextures[a].push(o),o}let i;return n===ba.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):n===ba.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):n===ba.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):n===ba.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):n===ba.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),i}releaseTexture(e,t,r,n){if(this.freeTextures==null)return;let a=dz(r,n),s=hz(t,a,n);s in this.freeTextures||(this.freeTextures[s]=[]);let i=cz(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,n),o=ge().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");o!==-1&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[s].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;let u=this.usedTextures[s],d=u&&u.indexOf(e);if(d==null||d<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[d]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function hqe(e,t){let r=e;if(t===r.R32F)return 4;if(t===r.R16F)return 2;if(t===r.RGBA32F||t===e.RGBA)return 16;if(t===r.RGBA16F)return 8;if(t===r.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function cz(e,t,r,n,a){let s=pqe(t,n),i;if(a){let[u,d]=uy(e[0],e[1]);i=u*d}else{let[u,d]=ow(e[0],e[1]);i=u*d}let o=hqe(r,s);return i*o}function pqe(e,t){switch(e){case ba.PACKED_2X2_FLOAT32:return nO(t);case ba.PACKED_2X2_FLOAT16:return aO(t);case ba.UNPACKED_FLOAT32:return eO(t);case ba.UNPACKED_FLOAT16:return tO(t);case ba.PACKED_4X1_UNSIGNED_BYTE:return rO(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function fqe(e){return ge().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?ba.PACKED_2X2_FLOAT32:ba.UNPACKED_FLOAT32:e?ba.PACKED_2X2_FLOAT16:ba.UNPACKED_FLOAT16}function dz(e,t){if(e===ui.UPLOAD)return ba.PACKED_2X2_FLOAT32;if(e===ui.RENDER||e==null)return fqe(t);if(e===ui.DOWNLOAD||e===ui.PIXELS)return ba.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function hz(e,t,r){return`${e[0]}_${e[1]}_${t}_${r}`}var rl=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},Xi="if (isnan(x)) return x;",mqe="return x;",pz="return abs(x);",gqe="return (x >= 0.0) ? x : (exp(x) - 1.0);",xqe=Xi+`
  return (x < 0.0) ? 0.0 : x;
`,yqe=Xi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Pu="return x;",vqe="return 1.0 / (1.0 + exp(-1.0 * x));",bqe="return x;",wqe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Nqe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Sqe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_qe="return 1.0 / (1.0 + exp(-1.0 * x));",sc=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}},kqe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length);let t=e.length,r=Ka("rc",t),n=Ur(t),a=lqe(t,r),s=r.slice(-2),i=t<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`
      void main() {
        ${n} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${i}));
      }
    `}},Cqe=Nl.whereImpl,Iqe=1e-7,Eqe=1e-4,hI={};function Tqe(e){return e in hI||(hI[e]={}),hI[e]}var jqe=ge().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Aqe=600;function $qe(){return ge().global.screen==null?1024:ge().global.screen.height*ge().global.screen.width*window.devicePixelRatio*Aqe/1024/1024}var iO=class fee extends u0{nextDataId(){return fee.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ge().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let r;if(t!=null){if(t instanceof aN)r=t;else{let n=Ao(ge().getNumber("WEBGL_VERSION"),t);r=new aN(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let n=Ao(ge().getNumber("WEBGL_VERSION"));r=new aN(n),this.binaryCache=Tqe(ge().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=r,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new dqe(this.gpgpu),this.numMBBeforeWarning=$qe(),this.texData=new uk(this,Ai())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,r,n,a,s,i){let o=this.makeTensorInfo(r,n),u=this.texData.get(o.dataId);u.isPacked=!1,u.texture={texture:t,texShape:[a,s]},u.texShape=[a,s];let d=iv(r),c=new uz(d,!1,i),h=this.runWebGLProgram(c,[o],n,[[a,s]]);return h.shape=r,u.texture=null,this.disposeIntermediateTensorInfo(o),h.dataId}write(t,r,n){if((ge().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ge().getBool("DEBUG"))&&this.checkNumericalProblems(t),n==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let a={id:this.nextDataId()};return this.texData.set(a,{shape:r,dtype:n,values:t,usage:ui.UPLOAD,refCount:1}),a}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){let r=this.texData.get(t);r.refCount++}decRef(t){if(this.texData.has(t)){let r=this.texData.get(t);r.refCount--}}move(t,r,n,a,s){if(ge().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:a,values:r,usage:ui.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){let r=this.texData.get(t),{values:n,dtype:a,complexTensorInfos:s,slice:i,shape:o,isPacked:u}=r;if(i!=null){let p;u?p=new sc(o,Pu):p=new rl(o,Pu);let f=this.runWebGLProgram(p,[{dataId:t,shape:o,dtype:a}],a),g=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),g}if(n!=null)return this.convertAndCacheOnCPU(t);if(a==="string")return n;let d=this.activeTimers!=null,c;d&&(c=R.now());let h;if(a==="complex64"){let p=this.readSync(s.real.dataId),f=this.readSync(s.imag.dataId);h=H.mergeRealAndImagArrays(p,f)}else h=this.getValuesFromTexture(t);return d&&(this.downloadWaitMs+=R.now()-c),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){let g=this.pendingRead.get(t);return new Promise(m=>g.push(m))}let r=this.texData.get(t),{values:n,shape:a,slice:s,dtype:i,complexTensorInfos:o,isPacked:u}=r;if(s!=null){let g;u?g=new sc(a,Pu):g=new rl(a,Pu);let m=this.runWebGLProgram(g,[{dataId:t,shape:a,dtype:i}],i),x=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),x}if(n!=null)return this.convertAndCacheOnCPU(t);if(ge().getBool("DEBUG")&&!ge().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ge().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let d=null,c;if(i!=="complex64"&&ge().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);let g=this.texData.get(c.dataId);d=this.gpgpu.createBufferFromTexture(g.texture.texture,...g1(a))}this.pendingRead.set(t,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(i==="complex64"){let g=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),m=g[0],x=g[1];h=H.mergeRealAndImagArrays(m,x)}else if(d==null)h=this.getValuesFromTexture(t);else{let g=R.sizeFromShape(a);h=this.gpgpu.downloadFloat32MatrixFromBuffer(d,g)}if(c!=null&&this.disposeIntermediateTensorInfo(c),d!=null){let g=this.gpgpu.gl;Je(g,()=>g.deleteBuffer(d))}let p=this.convertAndCacheOnCPU(t,h),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach(g=>g(p)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Ai().removeDataId(t,this),this.pendingDeletes--),p}readToGPU(t,r={}){let n=this.texData.get(t),{values:a,shape:s,slice:i,dtype:o,isPacked:u,texture:d}=n;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;u?f=new sc(s,Pu):f=new rl(s,Pu);let g=this.runWebGLProgram(f,[{dataId:t,shape:s,dtype:o}],o),m=this.readToGPU(g,r);return this.disposeIntermediateTensorInfo(g),m}if(d==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let c=this.decode(t,r.customTexShape),h=Ai().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:h},p.texture)}bufferSync(t){let r=this.readSync(t.dataId);if(t.dtype==="string")try{let n=r.map(a=>R.decodeString(a));return Qt(t.shape,t.dtype,n)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Qt(t.shape,t.dtype,r)}checkNumericalProblems(t){if(t!=null)for(let r=0;r<t.length;r++){let n=t[r];if(!xZ(n))throw ge().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${n} cannot be represented on this device.`)}}getValuesFromTexture(t){let{shape:r,dtype:n,isPacked:a}=this.texData.get(t),s=R.sizeFromShape(r);if(ge().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let p=this.decode(t),f=this.texData.get(p.dataId),g=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...g1(r)).subarray(0,s);return this.disposeIntermediateTensorInfo(p),g}let i=ge().getBool("WEBGL_PACK")&&a===!0,o=i?iv(r):r,u=i?new pHe(o):new hHe(o),d=this.runWebGLProgram(u,[{shape:o,dtype:n,dataId:t}],"float32"),c=this.texData.get(d.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(d),h}timerAvailable(){return ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){let r=this.activeTimers,n=[],a=!1;this.programTimersStack==null?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,t();let s=R.flatten(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=R.flatten(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=r,a&&(this.programTimersStack=null);let o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let u=await Promise.all(s);o.kernelMs=R.sum(u),o.getExtraProfileInfo=()=>u.map((d,c)=>({name:i[c],ms:d})).map(d=>`${d.name}: ${d.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:R.now(),endMs:null}}endTimer(t){return ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=R.now(),t)}async getQueryTime(t){if(ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);let r=t;return r.endMs-r.startMs}disposeData(t,r=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(r?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!r&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);let{complexTensorInfos:n}=this.texData.get(t);return n!=null&&(this.disposeData(n.real.dataId,r),this.disposeData(n.imag.dataId,r)),this.texData.delete(t),!0}releaseGPUData(t){let{texture:r,dtype:n,texShape:a,usage:s,isPacked:i,slice:o}=this.texData.get(t),u=o&&o.origDataId||t,d=this.dataRefCount.get(u);d>1?this.dataRefCount.set(u,d-1):(this.dataRefCount.delete(u),r!=null&&(this.numBytesInGPU-=this.computeBytes(a,n),this.textureManager.releaseTexture(r,a,s,i)));let c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,r=jqe){return ge().getBool("WEBGL_CPU_FORWARD")&&t.every(n=>this.texData.get(n.dataId).texture==null&&R.sizeFromShape(n.shape)<r)}getGPGPUContext(){return this.gpgpu}where(t){H.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let r=t.dataSync();return Cqe(t.shape,r)}packedUnaryOp(t,r,n){let a=new sc(t.shape,r),s=this.compileAndRun(a,[t],n);return Ai().makeTensorFromTensorInfo(s)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){let a=cee(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,a)}if(ge().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,pz,t.dtype);let r=new rl(t.shape,pz),n=this.compileAndRun(r,[t]);return Ai().makeTensorFromTensorInfo(n)}makeTensorInfo(t,r,n){let a;if(r==="string"&&n!=null&&n.length>0&&R.isString(n[0])){let s=n.map(i=>R.encodeString(i));a=this.write(s,t,r)}else a=this.write(n,t,r);return this.texData.get(a).usage=null,{dataId:a,shape:t,dtype:r}}makeOutput(t,r,n){return Ai().makeTensorFromTensorInfo(this.makeTensorInfo(t,r,n),this)}unpackTensor(t){let r=new kqe(t.shape);return this.runWebGLProgram(r,[t],t.dtype)}packTensor(t){let r=new uqe(t.shape);return this.runWebGLProgram(r,[t],t.dtype,null,!0)}packedReshape(t,r){let n=[Fh(t.shape),...Oh(t.shape)],a={dtype:t.dtype,shape:n,dataId:t.dataId},s=[Fh(r),...Oh(r)],i=new pee(s,n),o=!0,u=[n],d=this.runWebGLProgram(i,[a],t.dtype,u,o);return{dataId:d.dataId,shape:r,dtype:d.dtype}}decode(t,r){let n=this.texData.get(t),{isPacked:a,shape:s,dtype:i}=n;if(r!=null){let p=R.sizeFromShape(s),f=r[0]*r[1]*4;R.assert(p<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let o=iv(s),u;a?u=new dHe(o):u=new cHe(o);let d=!0,c=[r??g1(o)],h=this.runWebGLProgram(u,[{shape:o,dtype:i,dataId:t}],i,c,d,r);return{dtype:i,shape:s,dataId:h.dataId}}runWebGLProgram(t,r,n,a,s=!1,i){let o=this.makeTensorInfo(t.outputShape,n),u=this.texData.get(o.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===yb.DENSE){let y=i??g1(t.outputShape);u.texShape=y.map(v=>v*2)}if(t.outTexUsage!=null&&(u.usage=t.outTexUsage),R.sizeFromShape(o.shape)===0)return u.values=R.getTypedArrayFromDType(o.dtype,0),o;let d=[],c=r.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(y.dataId);if(v.texture==null){if(!t.packedInputs&&R.sizeFromShape(y.shape)<=ge().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:v.values};t.packedInputs&&(v.isPacked=!0,v.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!v.isPacked!=!!t.packedInputs)y=v.isPacked?this.unpackTensor(y):this.packTensor(y),d.push(y),v=this.texData.get(y.dataId);else if(v.isPacked&&!vb(v.shape,y.shape)){let b=y,N=y.shape;y.shape=v.shape,y=this.packedReshape(y,N),d.push(y),v=this.texData.get(y.dataId),b.shape=N}return{shape:y.shape,texData:v,isUniform:!1}});this.uploadToGPU(o.dataId);let h={shape:o.shape,texData:u,isUniform:!1},p=uHe(t,c,h),f=this.getAndSaveBinary(p,()=>oHe(this.gpgpu,t,c,h)),g=this.activeTimers!=null,m;g&&(m=this.startTimer()),ge().get("ENGINE_COMPILE_ONLY")||lHe(this.gpgpu,f,c,h,a),d.forEach(y=>this.disposeIntermediateTensorInfo(y)),g&&(m=this.endTimer(m),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(m)}));let x=ge().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){let y=R.now();y-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!ge().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&s===!1){let y=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),y}return o}compileAndRun(t,r,n,a,s=!1){return n=n||r[0].dtype,this.runWebGLProgram(t,r,n,a,s)}getAndSaveBinary(t,r){return t in this.binaryCache||(this.binaryCache[t]=r()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ge().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ce(()=>{if(!ge().get("WEBGL_RENDER_FLOAT32_ENABLED")){let t=ge().getBool("DEBUG");ge().set("DEBUG",!1);let r=this.abs(bt(1e-8)).dataSync()[0];if(ge().set("DEBUG",t),r>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Iqe:Eqe}uploadToGPU(t){let r=this.texData.get(t),{shape:n,dtype:a,values:s,texture:i,usage:o,isPacked:u}=r;if(i!=null)return;let d=this.activeTimers!=null,c;d&&(c=R.now());let h=r.texShape;if(h==null&&(h=DZ(n,u),r.texShape=h),s!=null){let p=iv(n),f,g=h[1],m=h[0],x=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(u||!x)&&([g,m]=uy(h[0],h[1])),u?f=new mHe(p,x):f=new uz(p,x);let y=x?[m,g]:h,v=this.makeTensorInfo(y,a),b=this.texData.get(v.dataId);x?b.usage=ui.PIXELS:b.usage=ui.UPLOAD,b.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),g,m,s);let N=[[m,g]],S=this.runWebGLProgram(f,[v],a,N,!0),_=this.texData.get(S.dataId);r.texShape=_.texShape,r.isPacked=_.isPacked,r.usage=_.usage,ge().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(r.texture=_.texture,r.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(v),d&&(this.uploadWaitMs+=R.now()-c)}else{let p=this.acquireTexture(h,o,a,u);r.texture=p}}convertAndCacheOnCPU(t,r){let n=this.texData.get(t),{dtype:a}=n;return r!=null&&(n.values=Rqe(r,a)),n.values}acquireTexture(t,r,n,a){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,r,a)}computeBytes(t,r){return t[0]*t[1]*R.bytesPerElement(r)}checkCompileCompletion(){for(let[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){let t=[];if(this.gpgpu.parallelCompilationExtension){for(let[,r]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(r));return Promise.all(t)}else{for(let[,r]of Object.entries(this.binaryCache)){let n=new Promise(a=>{try{this.checkCompletion_(r),a(!0)}catch(s){throw s}});t.push(n)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await QD(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(XF(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);let{variablesLocations:r,customUniformLocations:n,infLoc:a,nanLoc:s,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:u}=HZ(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=r,t.customUniformLocations=n,t.infLoc=a,t.nanLoc=s,t.outShapeLocation=i,t.outShapeStridesLocation=o,t.outTexShapeLocation=u}}createTensorFromGPUData(t,r,n){t.channels=t.channels||"RGBA";let{texture:a,height:s,width:i,channels:o}=t,u=Ai().backend;if(!u.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let d=u.writeTexture(a,r,n,s,i,o);return Ai().makeTensorFromDataId(d,r,n,u)}};iO.nextDataId=0;function Rqe(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){let r=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let n=0;n<r.length;++n)r[n]=Math.round(e[n]);return r}else throw new Error(`Unknown dtype ${t}`)}var Dqe="4.22.0";function mee(){ge().set("WEBGL_FORCE_F16_TEXTURES",!0)}M0.isBrowser()&&Ik("webgl",()=>new iO,2);var Mqe={forceHalfFloat:mee},oO=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,Ph=class{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=H.assertAndGetBroadcastShape(t,r),this.enableShapeUniforms=Pa(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}},_f=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`,my=class{constructor(e,t,r,n=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=H.assertAndGetBroadcastShape(t,r);let a=this.outputShape.length;this.enableShapeUniforms=Pa(a);let s="";if(n)if(a===0||R.sizeFromShape(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          ${Ur(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?s+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:s+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let i=Ka("coords",a);this.enableShapeUniforms?s+=`
            bool nextRowOutOfBounds =
              (${i[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${i[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:s+=`
            bool nextRowOutOfBounds =
              (${i[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${i[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${s}

        setOutput(result);
      }
    `}};function Zs(e){let{inputs:t,backend:r}=e,{x:n}=t;return r.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}var Fqe={kernelName:kp,backendName:"webgl",kernelFunc:Zs};function od(e){let{inputs:t,backend:r}=e,{real:n,imag:a}=t,s=r.makeTensorInfo(n.shape,"complex64"),i=r.texData.get(s.dataId),o=Zs({inputs:{x:n},backend:r}),u=Zs({inputs:{x:a},backend:r});return i.complexTensorInfos={real:o,imag:u},s}var Oqe={kernelName:hk,backendName:"webgl",kernelFunc:od},gee="return (a < 0.) ? b * a : a;",xee=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Pqe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{alpha:s}=n,i=r.makeTensorInfo([],"float32",R.createScalarValue(s,"float32")),o=ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new my(xee,a.shape,i.shape):new Ph(gee,a.shape,i.shape),u=r.runWebGLProgram(o,[a,i],"float32");return r.disposeIntermediateTensorInfo(i),u}var Lqe={kernelName:Tp,backendName:"webgl",kernelFunc:Pqe},yee="return (a < 0.) ? b * a : a;",vee=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function zqe(e){let{inputs:t,backend:r}=e,{x:n,alpha:a}=t,s=ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new my(vee,n.shape,a.shape):new Ph(yee,n.shape,a.shape);return r.runWebGLProgram(s,[n,a],"float32")}var Bqe={kernelName:Hp,backendName:"webgl",kernelFunc:zqe},gy="if (isnan(x)) return x;";function gr({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:r,dtype:n}){return({inputs:a,backend:s})=>{let{x:i}=a,o=s,u=n||i.dtype;if(o.shouldExecuteOnCPU([i])&&r!=null){let h=o.texData.get(i.dataId),p=r(h.values,u);return o.makeTensorInfo(i.shape,u,p)}let d=ge().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,c;return d?c=new sc(i.shape,t):c=new rl(i.shape,e),o.runWebGLProgram(c,[i],u)}}function Ea({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:r=!1,supportsComplex:n=!1,cpuKernelImpl:a,dtype:s}){return({inputs:i,backend:o})=>{let{a:u,b:d}=i,c=o;if(n&&u.dtype==="complex64"){let g=c.texData.get(u.dataId),m=c.texData.get(d.dataId),[x,y]=[[g.complexTensorInfos.real,m.complexTensorInfos.real],[g.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{let[N,S]=b,_={dataId:N.dataId,dtype:N.dtype,shape:u.shape},C={dataId:S.dataId,dtype:S.dtype,shape:d.shape},k=new Ph(e,u.shape,d.shape);return c.runWebGLProgram(k,[_,C],wi(N.dtype,S.dtype))}),v=od({inputs:{real:x,imag:y},backend:c});return c.disposeIntermediateTensorInfo(x),c.disposeIntermediateTensorInfo(y),v}let h=s||wi(u.dtype,d.dtype);if((u.dtype==="string"||d.dtype==="string"||c.shouldExecuteOnCPU([u,d]))&&a!=null){let g=c.texData.get(u.dataId).values,m=c.texData.get(d.dataId).values,x=u.dtype==="string"?H.fromUint8ToStringArray(g):g,y=u.dtype==="string"?H.fromUint8ToStringArray(m):m,[v,b]=a(u.shape,d.shape,x,y,h),N=c.makeTensorInfo(b,h),S=c.texData.get(N.dataId);return S.values=v,N}let p=ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,f;return p?f=new my(t,u.shape,d.shape,r):f=new Ph(e,u.shape,d.shape),c.runWebGLProgram(f,[u,d],h)}}function bb(e,t=!1){if(e==="linear")return t?bqe:mqe;if(e==="relu")return t?Nqe:xqe;if(e==="elu")return t?wqe:gqe;if(e==="relu6")return t?Sqe:yqe;if(e==="prelu")return t?vee:yee;if(e==="leakyrelu")return t?xee:gee;if(e==="sigmoid")return t?_qe:vqe;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}var bee=class{constructor(e,t,r,n=!1,a=!1,s=!1,i=null,o=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Pa(this.outputShape.length);let d=n?e[1]:e[2],c=Math.ceil(d/2),h=n?"i * 2, rc.y":"rc.y, i * 2",p=a?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",x="";i&&(o?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${i}
        }`:u?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${i}
        }`:m=`vec4 activation(vec4 x) {
          ${i}
        }`,x="result = activation(result);");let y=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<t[0]?v=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(b=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${c}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${b};
        for (int i = 0; i < ${c}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${g[0]});
          result += (${f[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${x}

        setOutput(result);
      }
    `}},fz={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},mz=class{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=H.assertAndGetBroadcastShape(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}},gz="return a * b;";function lO(e){let{inputs:t,backend:r}=e,{a:n,b:a}=t,s=H.upcastType(n.dtype,a.dtype);if(n.dtype==="complex64"){let o=r.texData.get(n.dataId),u=r.texData.get(a.dataId),d=new mz(fz.REAL,n.shape,a.shape),c=new mz(fz.IMAG,n.shape,a.shape),h=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:n.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:n.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:a.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:a.shape}],p=r.runWebGLProgram(d,h,"float32"),f=r.runWebGLProgram(c,h,"float32"),g=od({inputs:{real:p,imag:f},backend:r});return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),g}if(r.shouldExecuteOnCPU([n,a])){let o=r.texData.get(n.dataId),u=r.texData.get(a.dataId),[d,c]=PHe(n.shape,a.shape,o.values,u.values,s),h=r.makeTensorInfo(c,s),p=r.texData.get(h.dataId);return p.values=d,h}let i;return ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new my(gz,n.shape,a.shape):i=new Ph(gz,n.shape,a.shape),r.runWebGLProgram(i,[n,a],s)}var Uqe={kernelName:Bp,backendName:"webgl",kernelFunc:lO};function Wqe(e,t,r){let n=[Fh(e.shape),...Oh(e.shape)],a={dtype:e.dtype,shape:n,dataId:e.dataId},s=[Fh(t),...Oh(t)],i=new pee(s,n),o=!0,u=[n],d=r.runWebGLProgram(i,[a],e.dtype,u,o);return{dataId:d.dataId,shape:t,dtype:d.dtype}}function Ye(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{shape:s}=n,i=r,o=R.sizeFromShape(a.shape),u=R.inferFromImplicitShape(s,o),d=R.sizeFromShape(u);R.assert(o===d,()=>`The new shape (${u}) has ${d} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);let c=i.texData.get(a.dataId);return c.isPacked&&!vb(a.shape,u)&&!(c.texture!==null&&vb(c.shape,u))?Wqe(a,u,i):(i.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype})}var Vqe={kernelName:Dx,backendName:"webgl",kernelFunc:Ye},xz=class{constructor(e,t){this.variableNames=["x"];let{windowSize:r,batchSize:n,inSize:a,outSize:s}=e;this.outputShape=[n,s];let i=Math.floor(r/4)*4,o=r%4,u="sumValue += dot(values, ones);";if(t!=null){let c=1/t;u=`sumValue += dot(values * ${R.isInt(c)?c.toPrecision(2):c}, ones);`}let d="";a%r>0&&(d=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${i}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${i};
        if (${o===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${o===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${o===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}},Hqe=class{constructor(e,t){this.variableNames=["x"];let{windowSize:r,batchSize:n,inSize:a,outSize:s}=e;this.outputShape=[n,s];let i="0.0",o="";t==="prod"?i="1.0":t==="min"?(i="1.0 / 1e-20",o="min"):t==="max"&&(i="-1.0 / 1e-20",o="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");let d=Math.floor(r/4)*4,c=r%4,h=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${o}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${o}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";t==="all"?(i="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(i="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let f="";a%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${i};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${i});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${d};
        if (${c===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${c===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${c===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}};function qqe(e){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let r=t.length?t[t.length-1].outSize:e[1],n=H.computeOptimalWindowSize(r);t.push({inSize:r,windowSize:n,outSize:Math.ceil(r/n)})}return t}function kf(e,t,r,n){let a=qqe(e.shape),s=e;for(let i=0;i<a.length;i++){let{inSize:o,windowSize:u,outSize:d}=a[i],c,h;r==="mean"?c=i===0?new xz({windowSize:u,inSize:o,batchSize:e.shape[0],outSize:d},o):new xz({windowSize:u,inSize:o,batchSize:e.shape[0],outSize:d}):c=new Hqe({windowSize:u,inSize:o,batchSize:e.shape[0],outSize:d},r),h=s,s=n.runWebGLProgram(c,[s],t),h.dataId!==e.dataId&&n.disposeIntermediateTensorInfo(h)}return s}var Gqe=class{constructor(e,t){this.variableNames=["A"];let r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[t[s]];this.outputShape=r,this.rank=r.length;let n=Ur(this.rank),a=Kqe(t);this.userCode=`
    void main() {
      ${n} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}};function Kqe(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let r=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],n=new Array(t);for(let a=0;a<e.length;a++)n[e[a]]=r[a];return n.join()}var Qqe=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let r=new Array(e.length);for(let d=0;d<r.length;d++)r[d]=e[t[d]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let n=Ur(this.rank),a=hee("rc",this.rank),s=new Array(this.rank);for(let d=0;d<t.length;d++)s[t[d]]=a[d];let i=`vec2(${s.slice(-2).join()})`,o=`++${a[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${s.join()}), ${i})`;this.userCode=`
    void main() {
      ${n} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${o}) {
        result[1] = ${u};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${o}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}};function $C(e,t,r){let n=ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Qqe(e.shape,t):new Gqe(e.shape,t);return r.runWebGLProgram(n,[e],e.dtype)}function Xqe(e,t,r,n){let a=t,s=e.shape.length,i=R.parseAxisParam(a,e.shape),o=i,u=H.getAxesPermutation(o,s),d=u!=null,c=e;d&&(c=$C(e,u,n),o=H.getInnerMostAxes(o.length,s)),H.assertAxesAreInnerMostDims("sum",o,s);let[h,p]=H.computeOutAndReduceShapes(c.shape,o),f=h;r&&(f=H.expandShapeToKeepDim(h,i));let g=R.sizeFromShape(p),m=R.sizeFromShape(e.shape)/g,x=Ye({inputs:{x:c},attrs:{shape:[m,g]},backend:n}),y=Ck(e.dtype),v=kf(x,y,"sum",n),b=Ye({inputs:{x:v},attrs:{shape:f},backend:n});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),d&&n.disposeIntermediateTensorInfo(c),b}function RC(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n;return Xqe(a,s,i,r)}var Yqe={kernelName:uf,backendName:"webgl",kernelFunc:RC};function es(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{perm:s}=n,i=r,o=a.shape.length,u=new Array(o);for(let c=0;c<u.length;c++)u[c]=a.shape[s[c]];let d;if(i.shouldExecuteOnCPU([a])){let c=i.texData.get(a.dataId).values,h=sO(c,a.shape,a.dtype,s,u);d=i.makeTensorInfo(u,a.dtype);let p=i.texData.get(d.dataId);p.values=h}else d=$C(a,s,i);return d}var Jqe={kernelName:Gl,backendName:"webgl",kernelFunc:es},wee=1e3;function IS({a:e,b:t,transposeA:r,transposeB:n,backend:a,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:u=null}){let d=e.shape.length,c=t.shape.length,h=r?e.shape[d-2]:e.shape[d-1],p=n?t.shape[c-1]:t.shape[c-2],f=r?e.shape[d-1]:e.shape[d-2],g=n?t.shape[c-2]:t.shape[c-1],m=e.shape.slice(0,-2),x=t.shape.slice(0,-2),y=R.sizeFromShape(m),v=R.sizeFromShape(x),b=Jx.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([f,g]);R.assert(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${r} and transposeB=${n} must match.`);let N=r?[y,h,f]:[y,f,h],S=n?[v,g,p]:[v,p,g],_=Ye({inputs:{x:e},backend:a,attrs:{shape:N}}),C=Ye({inputs:{x:t},backend:a,attrs:{shape:S}}),k=[_,C],I=Math.max(y,v),T=r?_.shape[1]:_.shape[2],j=s!=null,E=i!=null,O=u==="leakyrelu",M=u!=null?bb(u,!0):null,W=j||E||O||M!=null,q;if((f===1||g===1)&&T>wee&&W===!1){let A=_,L=C;r&&(A=es({inputs:{x:_},backend:a,attrs:{perm:[0,2,1]}}),k.push(A)),n&&(L=es({inputs:{x:C},backend:a,attrs:{perm:[0,2,1]}}),k.push(L));let z=g!==1,$=g===1,V=A;z&&(V=Ye({inputs:{x:A},backend:a,attrs:{shape:[I,T,1]}}),k.push(V));let B=g===1?2:1,Y=L;$&&(Y=Ye({inputs:{x:L},backend:a,attrs:{shape:[I,1,T]}}),k.push(Y));let re=lO({inputs:{a:V,b:Y},backend:a});q=RC({inputs:{x:re},backend:a,attrs:{axis:B,keepDims:!0}}),k.push(re)}else{let A=wi(e.dtype,t.dtype),L=new bee(N,S,[I,f,g],r,n,j,M,E,O),z=[_,C];if(s!=null&&z.push(s),E&&z.push(i),O){let $=a.makeTensorInfo([],"float32",R.createScalarValue(o,"float32"));z.push($),k.push($)}q=a.runWebGLProgram(L,z,A)}let P=Ye({inputs:{x:q},backend:a,attrs:{shape:b}});k.push(q);for(let A of k)a.disposeIntermediateTensorInfo(A);return P}function Zqe(e){let{inputs:t,backend:r,attrs:n}=e,{a,b:s,bias:i,preluActivationWeights:o}=t,{transposeA:u,transposeB:d,activation:c,leakyreluAlpha:h}=n;return IS({a,b:s,transposeA:u,transposeB:d,backend:r,bias:i,preluActivationWeights:o,leakyreluAlpha:h,activation:c})}var eGe={kernelName:wh,backendName:"webgl",kernelFunc:Zqe},yz="return abs(x);";function tGe(e){let{inputs:t,backend:r}=e,{x:n}=t;if(r.shouldExecuteOnCPU([n])&&n.dtype!=="complex64"){let s=r.texData.get(n.dataId),i=cee(s.values);return r.makeTensorInfo(n.shape,n.dtype,i)}let a;return ge().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new sc(n.shape,yz):a=new rl(n.shape,yz),r.runWebGLProgram(a,[n],n.dtype)}var rGe={kernelName:Xg,backendName:"webgl",kernelFunc:tGe},nGe=Xi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,aGe=gr({opSnippet:nGe}),sGe={kernelName:Xh,backendName:"webgl",kernelFunc:aGe},iGe=Xi+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,oGe=gr({opSnippet:iGe}),lGe={kernelName:Yh,backendName:"webgl",kernelFunc:oGe},vz="return a + b;",uGe=Ea({opSnippet:vz,packedOpSnippet:vz,supportsComplex:!0,cpuKernelImpl:xHe}),cGe={kernelName:Yc,backendName:"webgl",kernelFunc:uGe},dGe=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,s)=>`T${s}`);let r=[];this.variableNames.forEach(a=>{r.push(`float v${a} = get${a}AtOutCoords();`)});let n=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${n};
        setOutput(result);
      }
    `}},hGe=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,s)=>`T${s}`);let r=[];this.variableNames.forEach(a=>{r.push(`vec4 v${a} = get${a}AtOutCoords();`)});let n=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${n};
        setOutput(result);
      }
    `}};function sN(e){let{inputs:t,backend:r}=e,n=t;if(n.length===1)return Zs({inputs:{x:n[0]},backend:r});if(n.length>ge().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let o=Math.floor(n.length/2),u=sN({inputs:n.slice(0,o),backend:r}),d=sN({inputs:n.slice(o),backend:r});return sN({inputs:[u,d],backend:r})}let a=n.map(o=>o.dtype).reduce((o,u)=>wi(o,u)),s=n.map(o=>o.shape),i=ge().getBool("WEBGL_PACK")?new hGe(n[0].shape,s):new dGe(n[0].shape,s);return r.runWebGLProgram(i,n,a)}var pGe={kernelName:Jh,backendName:"webgl",kernelFunc:sN};function fGe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n,o=a.shape.length,u=R.parseAxisParam(s,a.shape),d=u,c=H.getAxesPermutation(d,o),h=a;c!=null&&(h=es({inputs:{x:a},backend:r,attrs:{perm:c}}),d=H.getInnerMostAxes(d.length,o)),H.assertAxesAreInnerMostDims("all",d,o);let[p,f]=H.computeOutAndReduceShapes(h.shape,d),g=R.sizeFromShape(f),m=Ye({inputs:{x:h},backend:r,attrs:{shape:[-1,g]}}),x=kf(m,m.dtype,"all",r),y;if(i){let v=H.expandShapeToKeepDim(p,u);y=Ye({inputs:{x},backend:r,attrs:{shape:v}})}else y=Ye({inputs:{x},backend:r,attrs:{shape:p}});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(x),c!=null&&r.disposeIntermediateTensorInfo(h),y}var mGe={kernelName:Yg,backendName:"webgl",kernelFunc:fGe};function gGe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n,o=a.shape.length,u=R.parseAxisParam(s,a.shape),d=u,c=H.getAxesPermutation(d,o),h=a;c!=null&&(h=es({inputs:{x:a},backend:r,attrs:{perm:c}}),d=H.getInnerMostAxes(d.length,o)),H.assertAxesAreInnerMostDims("any",d,o);let[p,f]=H.computeOutAndReduceShapes(h.shape,d),g=R.sizeFromShape(f),m=Ye({inputs:{x:h},backend:r,attrs:{shape:[-1,g]}}),x=kf(m,m.dtype,"any",r),y;if(i){let v=H.expandShapeToKeepDim(p,u);y=Ye({inputs:{x},backend:r,attrs:{shape:v}})}else y=Ye({inputs:{x},backend:r,attrs:{shape:p}});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(x),c!=null&&r.disposeIntermediateTensorInfo(h),y}var xGe={kernelName:Jg,backendName:"webgl",kernelFunc:gGe},yGe=class{constructor(e,t,r){this.variableNames=["A"];let{windowSize:n,batchSize:a,outSize:s}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];let i=t==="max"?">":"<",o=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${n}; i++) {
          int inIdx = ${o};
          float candidate = getA(batch, inIdx);
          if (candidate ${i} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}},vGe=class{constructor(e,t,r,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,R.assert(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);let a=e[e.length-1],s=Math.ceil(a/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),n||this.variableNames.push("bestIndicesA");let i=this.outputShape,o=i.length,u=Ur(o),d=Ka("coords",o),c,h;if(s===1){h=o+1;let C=Ur(h);c=`
        ${C} sourceLocR = ${C}(${d.join()}, 0);
        ++${d[o-1]};
        ${C} sourceLocG = ${C}(${d.join()}, 0);
        ++${d[o-2]};
        ${C} sourceLocA = ${C}(${d.join()}, 0);
        --${d[o-1]};
        ${C} sourceLocB = ${C}(${d.join()}, 0);
        --${d[o-2]};`}else h=o,c=`
        ${u} sourceLocR = coords;
        ++${d[o-1]};
        ${u} sourceLocG = coords;
        ++${d[o-2]};
        ${u} sourceLocA = coords;
        --${d[o-1]};
        ${u} sourceLocB = coords;
        --${d[o-2]};`;let p=["x","y","z","w","u","v"].slice(0,h),f="."+p[h-1],g=p.map(C=>"int "+C),m=Ka("sourceLocR",h-1).concat("inIdx.r"),x=Ka("sourceLocG",h-1).concat("inIdx.g"),y=Ka("sourceLocB",h-1).concat("inIdx.b"),v=Ka("sourceLocA",h-1).concat("inIdx.a"),b=r==="max"?"greaterThan":"lessThan",N=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${v.join()})));`,S=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,_=n?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${_}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${d[o-1]} < ${i[o-1]-1};
        bool hasNextRow = ${d[o-2]} < ${i[o-2]-1};
        ${c}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${N}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function Nee(e,t,r,n=null){let a=t.shape[0],s=t.shape[1];n!=null&&(a=n.shape[0],s=n.shape[1]);let i=H.computeOptimalWindowSize(s),o={windowSize:i,inSize:s,batchSize:a,outSize:Math.ceil(s/i)},u=new yGe(o,r,n==null),d=[t];n!=null&&d.push(n);let c=e.runWebGLProgram(u,d,"int32");if(c.shape[1]===1)return c;let h=Nee(e,t,r,c);return e.disposeIntermediateTensorInfo(c),h}function See(e,t,r,n=null){let a=n!=null?n.shape:t.shape,s=a[a.length-1],i=H.computeOptimalWindowSize(s),o=new vGe(a,i,r,n==null),u=n==null?[t]:[t,n],d=e.runWebGLProgram(o,u,"int32");if(d.shape.length===t.shape.length){let c=See(e,t,r,d);return e.disposeIntermediateTensorInfo(d),c}return d}function _ee(e,t,r,n){let a=[r];if(H.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),a,t.shape.length),!ge().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let s=[],i=e.texData.get(t.dataId),o=i!==null&&i.isPacked,u=t;o&&(u=e.unpackTensor(t),s.push(u));let[d,c]=H.computeOutAndReduceShapes(u.shape,a),h=R.sizeFromShape(c),p=Ye({inputs:{x:u},backend:e,attrs:{shape:[-1,h]}});s.push(p);let f=Nee(e,p,n);s.push(f);let g=Ye({inputs:{x:f},backend:e,attrs:{shape:d}});return s.forEach(m=>e.disposeIntermediateTensorInfo(m)),g}return See(e,t,n)}function bGe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s}=n,i=R.parseAxisParam(s,a.shape),o=H.getAxesPermutation(i,a.shape.length),u=a,d=[];o!=null&&(u=es({inputs:{x:a},backend:r,attrs:{perm:o}}),d.push(u),i=H.getInnerMostAxes(i.length,u.shape.length)),H.assertAxesAreInnerMostDims("argMax",[i[0]],u.shape.length);let c=_ee(r,u,i[0],"max");return d.forEach(h=>r.disposeIntermediateTensorInfo(h)),c}var wGe={kernelName:Zg,backendName:"webgl",kernelFunc:bGe};function NGe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s}=n,i=R.parseAxisParam(s,a.shape),o=H.getAxesPermutation(i,a.shape.length),u=a,d=[];o!=null&&(u=es({inputs:{x:a},backend:r,attrs:{perm:o}}),d.push(u),i=H.getInnerMostAxes(i.length,u.shape.length)),H.assertAxesAreInnerMostDims("argMin",[i[0]],u.shape.length);let c=_ee(r,u,i[0],"min");return d.forEach(h=>r.disposeIntermediateTensorInfo(h)),c}var SGe={kernelName:ex,backendName:"webgl",kernelFunc:NGe},_Ge=Xi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,kGe=gr({opSnippet:_Ge}),CGe={kernelName:Zh,backendName:"webgl",kernelFunc:kGe},IGe=Xi+"return log(x + sqrt(x * x + 1.0));",EGe=gr({opSnippet:IGe}),TGe={kernelName:ep,backendName:"webgl",kernelFunc:EGe},jGe=Xi+`
  return atan(x);
`,AGe=gr({opSnippet:jGe}),$Ge={kernelName:tp,backendName:"webgl",kernelFunc:AGe},RGe=oO+`
  return atan(a, b);
`,DGe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+_f+`
  return result;
`,MGe=Ea({opSnippet:RGe,packedOpSnippet:DGe}),FGe={kernelName:np,backendName:"webgl",kernelFunc:MGe},OGe=Xi+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,PGe=gr({opSnippet:OGe}),LGe={kernelName:rp,backendName:"webgl",kernelFunc:PGe},wb=class{constructor(e,t,r,n=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let s=e.filterWidth,i=e.strideHeight,o=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;let g=t==="avg",m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,y="0.0";if(g||(y="-1.0 / 1e-20"),r){let C=">=";this.userCode=`
        const ivec2 strides = ivec2(${i}, ${o});
        const ivec2 pads = ivec2(${p}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${c};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${d}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${C} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${n?a?m:x:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let v="max",b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(b="avgValue / max(count, 1.0)");let N=Math.floor(s/4)*4,S=s%4,_=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${p}, ${f});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${c};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${N}; wC += 4) {
            int xC = xCCorner + wC * ${d};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              getValue(batch, xR, xC + 3 * ${d}, d)
            );

            ${_}
          }

          int xC = xCCorner + ${N};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              initializationValue
            );

            ${_}
          }
        }
        setOutput(${b});
      }
    `}},uO=class{constructor(e,t,r,n=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,u=e.strideWidth,d=e.dilationDepth,c=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,g=e.effectiveFilterWidth,m=e.padInfo.front,x=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;let v=t==="avg",b="0.0";if(v||(b="-1.0 / 1e-20"),r){let I=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${i}, ${o}, ${u});
        const ivec3 pads = ivec3(${m}, ${x}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${d}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${c}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${I} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${n?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let N="max",S=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(S="avgValue / max(count, 1.0)");let _=Math.floor(s/4)*4,C=s%4,k=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${N}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${i}, ${o}, ${u});
      const ivec3 pads = ivec3(${m}, ${x}, ${y});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${d}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${_}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${k}
            }

            int xC = xCCorner + ${_};
            if (${C===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${C===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${C===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${k}
            }
          }
        }
        setOutput(${S});
      }
    `}};function zGe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t;cy(a,"avgPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:u}=n,d=1;R.assert(H.eitherStridesOrDilationsAreOne(i,d),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);let c=H.computePool2DInfo(a.shape,s,i,d,o,u);if(c.filterWidth===1&&c.filterHeight===1&&R.arraysEqual(c.inShape,c.outShape))return Zs({inputs:{x:a},backend:r});let h=new wb(c,"avg",!1);return r.runWebGLProgram(h,[a],"float32")}var BGe={kernelName:ap,backendName:"webgl",kernelFunc:zGe};function UGe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:u,dataFormat:d}=n,c=[1,1,1],h=H.computePool3DInfo(a.shape,s,i,c,o,u,d),p=new uO(h,"avg",!1);return r.runWebGLProgram(p,[a],"float32")}var WGe={kernelName:tx,backendName:"webgl",kernelFunc:UGe},VGe=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,a=e.strideWidth,s=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=o-1-e.padInfo.top,c=u-1-e.padInfo.left,h=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${d}, ${c});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
            wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${i}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},HGe=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,r=e.filterHeight,n=e.filterWidth,a=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,c=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=c-1-e.padInfo.front,g=h-1-e.padInfo.top,m=p-1-e.padInfo.left,x=1/(t*r*n);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${g}, ${m});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
            wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${d}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function qGe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,i=s,{filterSize:o,strides:u,pad:d,dimRoundingMode:c}=n,h=[1,1,1],p=H.computePool3DInfo(i.shape,o,u,h,d,c),f=new HGe(p);return r.runWebGLProgram(f,[a],i.dtype)}var GGe={kernelName:h0,backendName:"webgl",kernelFunc:qGe};function KGe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,i=s;cy([a,s],"avgPoolGrad");let{filterSize:o,strides:u,pad:d}=n,c=H.computePool2DInfo(i.shape,o,u,1,d),h=new VGe(c);return r.runWebGLProgram(h,[a],i.dtype)}var QGe={kernelName:d0,backendName:"webgl",kernelFunc:KGe};function XGe(e){let{inputs:t,backend:r,attrs:n}=e,{a,b:s}=t,{transposeA:i,transposeB:o}=n;return IS({a,b:s,transposeA:i,transposeB:o,backend:r})}var YGe={kernelName:sp,backendName:"webgl",kernelFunc:XGe},JGe=class{constructor(e,t,r,n,a,s){this.outputShape=[],this.variableNames=["x","mean","variance"],H.assertAndGetBroadcastShape(e,t),H.assertAndGetBroadcastShape(e,r);let i="0.0";n!=null&&(H.assertAndGetBroadcastShape(e,n),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="1.0";a!=null&&(H.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${i};
        float scale = ${o};
        float inv = scale * inversesqrt(variance + float(${s}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}},ZGe=class{constructor(e,t,r,n,a,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],H.assertAndGetBroadcastShape(e,t),H.assertAndGetBroadcastShape(e,r);let i="vec4(0.0)";n!=null&&(H.assertAndGetBroadcastShape(e,n),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="vec4(1.0)";a!=null&&(H.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${i};
        vec4 scale = ${o};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${s}));

        setOutput((x - mean) * inv + offset);
      }
    `}},e8e=({inputs:e,backend:t,attrs:r})=>{let{x:n,mean:a,variance:s,offset:i,scale:o}=e;R.assert(a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R.assert(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R.assert(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=r;u==null&&(u=.001);let d=[n,a,s],c=null;i!=null&&(c=i.shape,d.push(i));let h=null;o!=null&&(h=o.shape,d.push(o));let p=ge().getBool("WEBGL_PACK_NORMALIZATION")?new ZGe(n.shape,a.shape,s.shape,c,h,u):new JGe(n.shape,a.shape,s.shape,c,h,u);return t.runWebGLProgram(p,d,d[0].dtype)},t8e={kernelName:Sp,backendName:"webgl",kernelFunc:e8e},r8e=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=Ur(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let r=n8e(this.rank),n,a=e.map((s,i)=>`sourceLoc.${fj[i]} = start[${i}] + coords.${fj[i]};`);n=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${n}
        setOutput(getSource(${r}));
      }
    `}},fj=["x","y","z","w","u","v"];function n8e(e){if(e===1)return"sourceLoc";if(e<=6)return fj.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}var a8e=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=Ur(this.rank),r=Ka("coords",this.rank),n=Ka("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${n.slice(-2).join()})`,s=`getChannel(getSource(${n.join()}), ${a})`,i=`
      result.x = ${s};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${n[this.rank-1]};
        result.y = ${s};
        --${n[this.rank-1]};
      }
    `,o=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${n[this.rank-2]};
        result.z = ${s};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${n[this.rank-1]};
          result.w = ${s};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((d,c)=>`start[${c}]`).join()});`:e.map((d,c)=>`${n[c]} = ${r[c]} + start[${c}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${i}
        ${o}
        setOutput(result);
      }
    `}};function s8e(e,t,r,n){let a=n.texData.get(e.dataId),s=n.makeTensorInfo(r,e.dtype),i=n.texData.get(s.dataId);Object.assign(i,a),i.refCount=1,i.shape=r,i.dtype=e.dtype;let o=Yn.computeFlatOffset(t,R.computeStrides(e.shape));a.slice&&(o+=a.slice.flatOffset),i.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||e.dataId};let u=n.dataRefCount.get(i.slice.origDataId)||1;return n.dataRefCount.set(i.slice.origDataId,u+1),s}function xy(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{begin:s,size:i}=n,[o,u]=Yn.parseSliceParams(a,s,i);if(Yn.assertParamsValid(a,o,u),R.sizeFromShape(u)===0)return r.makeTensorInfo(u,a.dtype,[]);if(r.shouldExecuteOnCPU([a])||a.dtype==="string"){let h=r.texData.get(a.dataId),p=QHe(h.values,o,u,a.shape,a.dtype);return r.makeTensorInfo(u,a.dtype,p)}let{isPacked:d}=r.texData.get(a.dataId),c=Yn.isSliceContinous(a.shape,o,u);if(d||!c){let h=ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new a8e(u):new r8e(u),p=[o];return r.runWebGLProgram(h,[a],a.dtype,p)}return r.uploadToGPU(a.dataId),s8e(a,o,u,r)}var i8e={kernelName:Bx,backendName:"webgl",kernelFunc:xy},o8e=e=>{let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockShape:s,crops:i}=n;R.assert(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=s.reduce((v,b)=>v*b),u=H.getReshaped(a.shape,s,o),d=H.getPermuted(u.length,s.length),c=H.getReshapedPermuted(a.shape,s,o),h=H.getSliceBeginCoords(i,s.length),p=H.getSliceSize(c,i,s.length),f=[],g=Ye({inputs:{x:a},backend:r,attrs:{shape:u}}),m=es({inputs:{x:g},backend:r,attrs:{perm:d}}),x=Ye({inputs:{x:m},backend:r,attrs:{shape:c}}),y=xy({inputs:{x},backend:r,attrs:{begin:h,size:p}});return f.push(g),f.push(m),f.push(x),f.forEach(v=>r.disposeIntermediateTensorInfo(v)),y},l8e={kernelName:rx,backendName:"webgl",kernelFunc:o8e};function u8e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,weights:s}=t,{size:i}=n,o=r.readSync(a.dataId),u=r.readSync(s.dataId),d=uee(o,u,s.dtype,s.shape,i);return r.makeTensorInfo([i],s.dtype,d)}var c8e={kernelName:nx,backendName:"webgl",kernelFunc:u8e},d8e=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,h8e=`
  return float(int(a.r) & int(b.r));
`;function p8e(e){let{inputs:t,backend:r}=e,{a:n,b:a}=t,s=ge().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=ge().getNumber("WEBGL_VERSION");if(r.shouldExecuteOnCPU([n,a])||i===1){let u=r.texData.get(n.dataId).values,d=r.texData.get(a.dataId).values,[c,h]=vHe(n.shape,a.shape,u,d,n.dtype),p=r.makeTensorInfo(h,n.dtype),f=r.texData.get(p.dataId);return f.values=c,p}let o;return s?o=new my(d8e,n.shape,a.shape,!1):o=new Ph(h8e,n.shape,a.shape),r.runWebGLProgram(o,[n,a],n.dtype)}var f8e={kernelName:ax,backendName:"webgl",kernelFunc:p8e};function m8e(e){let{inputs:t,backend:r}=e,{s0:n,s1:a}=t,s=r.readSync(n.dataId),i=r.readSync(a.dataId),o=H.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return r.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var g8e={kernelName:p0,backendName:"webgl",kernelFunc:m8e},x8e="return float(a != b);",kee=Ea({opSnippet:x8e,cpuKernelImpl:zHe,dtype:"bool"}),y8e={kernelName:Ex,backendName:"webgl",kernelFunc:kee};function uw(e){let{inputs:t,backend:r}=e,{input:n}=t,a=r.texData.get(n.dataId);return Zs({inputs:{x:a.complexTensorInfos.real},backend:r})}var v8e={kernelName:_k,backendName:"webgl",kernelFunc:uw},b8e="return float(int(x));";function w8e(e,t){let r=new rl(e.shape,b8e),n=t.runWebGLProgram(r,[e],"int32");return{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}function mj(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{dtype:s}=n;if(s==="complex64"){if(a.dtype==="complex64")return Zs({inputs:{x:a},backend:r});let i=gn(a.shape),o=mj({inputs:{x:a},backend:r,attrs:{dtype:"float32"}}),u=od({inputs:{real:o,imag:i},backend:r});return i.dispose(),r.disposeIntermediateTensorInfo(o),u}if(a.dtype==="complex64"){let i=uw({inputs:{input:a},backend:r}),o=mj({inputs:{x:i},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(i),o}if(!R.hasEncodingLoss(a.dtype,s)){let i=Zs({inputs:{x:a},backend:r});return{dataId:i.dataId,shape:i.shape,dtype:s}}if(r.shouldExecuteOnCPU([a])){let i=r.texData.get(a.dataId).values,[o,u,d]=bHe(i,a.shape,a.dtype,s);return r.makeTensorInfo(o,u,d)}if(s==="int32")return w8e(a,r);if(s==="bool"){let i=r.makeTensorInfo([],"bool",R.getTypedArrayFromDType("bool",1)),o=kee({inputs:{a,b:i},backend:r});return r.disposeIntermediateTensorInfo(i),o}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${s}`)}var N8e={kernelName:ip,backendName:"webgl",kernelFunc:mj},bz="return ceil(x);",S8e=gr({opSnippet:bz,packedOpSnippet:bz,cpuKernelImpl:wHe}),_8e={kernelName:op,backendName:"webgl",kernelFunc:S8e},k8e=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}},C8e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function I8e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{clipValueMin:s,clipValueMax:i}=n,o;ge().getBool("WEBGL_PACK_CLIP")?o=new C8e(a.shape):o=new k8e(a.shape);let u=[[s],[i]];return r.runWebGLProgram(o,[a],a.dtype,u)}var E8e={kernelName:Jc,backendName:"webgl",kernelFunc:I8e},T8e=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function wz(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function j8e(e){let{inputs:t,backend:r}=e,{x:n}=t,a=r.texData.get(n.dataId),s=new T8e(n.shape),i=[wz(n,a.complexTensorInfos.real),wz(n,a.complexTensorInfos.imag)];return r.runWebGLProgram(s,i,i[0].dtype)}var A8e={kernelName:f0,backendName:"webgl",kernelFunc:j8e},$8e=class{constructor(e){this.outputShape=[],this.outputShape=H.computeOutShape(e,1),this.variableNames=e.map((s,i)=>`T${i}`);let t=new Array(e.length-1);t[0]=e[0][1];for(let s=1;s<t.length;s++)t[s]=t[s-1]+e[s][1];let r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<t.length;s++){let i=t[s-1];r.push(`else if (yC < ${t[s]}) setOutput(getT${s}(yR, yC-${i}));`)}let n=t.length,a=t[t.length-1];r.push(`else setOutput(getT${n}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}},R8e=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=H.computeOutShape(e,t);let r=this.outputShape,n=r.length,a=Ur(n),s=Ka("coords",n),i=["x","y","z","w","u","v"].slice(0,n);this.variableNames=e.map((g,m)=>`T${m}`);let o=new Array(e.length-1);o[0]=e[0][t];for(let g=1;g<o.length;g++)o[g]=o[g-1]+e[g][t];let u=i[t],d=i.slice(-2),c=i.join(),h=`if (${u} < ${o[0]}) {
        return getChannel(
            getT0(${c}), vec2(${d.join()}));
        }`;for(let g=1;g<o.length;g++){let m=o[g-1];h+=`
        if (${u} < ${o[g]}  && ${u} >= ${o[g-1]}) {
          return getChannel(
            getT${g}(${y1(i,u,m)}),
            vec2(${y1(d,u,m)}));
        }`}let p=o.length,f=o[o.length-1];h+=`
        return getChannel(
          getT${p}(${y1(i,u,f)}),
          vec2(${y1(d,u,f)}));`,this.userCode=`
      float getValue(${i.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${s}), 0., 0., 0.);

        ${s[n-1]} = ${s[n-1]} + 1;
        if (${s[n-1]} < ${r[n-1]}) {
          result.g = getValue(${s});
        }

        ${s[n-2]} = ${s[n-2]} + 1;
        if (${s[n-2]} < ${r[n-2]}) {
          result.a = getValue(${s});
        }

        ${s[n-1]} = ${s[n-1]} - 1;
        if (${s[n-2]} < ${r[n-2]} &&
            ${s[n-1]} < ${r[n-1]}) {
          result.b = getValue(${s});
        }
        setOutput(result);
      }
    `}};function y1(e,t,r){let n=e.indexOf(t);return e.map((a,s)=>s===n?`${a} - ${r}`:a).join()}function DC(e){let{inputs:t,backend:r}=e,{input:n}=t,a=r.texData.get(n.dataId);return Zs({inputs:{x:a.complexTensorInfos.imag},backend:r})}var D8e={kernelName:bk,backendName:"webgl",kernelFunc:DC};function ov(e,t,r){let n=e[0].dtype;if(n==="complex64"){let f=e.map(v=>uw({inputs:{input:v},backend:r})),g=e.map(v=>DC({inputs:{input:v},backend:r})),m=ov(f,t,r),x=ov(g,t,r),y=od({inputs:{real:m,imag:x},backend:r});return f.forEach(v=>r.disposeIntermediateTensorInfo(v)),g.forEach(v=>r.disposeIntermediateTensorInfo(v)),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(x),y}let a=r.shouldExecuteOnCPU(e);if(n==="string"&&(a=!0),a){let f=e.map(N=>{let S=[-1,R.sizeFromShape(N.shape.slice(t))];return Ye({inputs:{x:N},backend:r,attrs:{shape:S}})}),g=f.map(N=>({vals:r.readSync(N.dataId),shape:N.shape})),m=H.computeOutShape(f.map(N=>N.shape),1),x=f[0].shape[0]===1,y=NHe(g,m,n,x),v=H.computeOutShape(e.map(N=>N.shape),t),b=r.makeTensorInfo(v,n,y);return f.forEach(N=>r.disposeIntermediateTensorInfo(N)),b}let s=e.filter(f=>R.sizeFromShape(f.shape)>0),i=ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){let f=i?new rl(e[0].shape,Pu):new sc(e[0].shape,Pu);return r.runWebGLProgram(f,e,n)}let o=ge().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>o){let f=[];for(let m=0;m<s.length;m+=o){let x=s.slice(m,m+o);f.push(ov(x,t,r))}let g=ov(f,t,r);for(let m of f)r.disposeIntermediateTensorInfo(m);return g}if(i){let f=new R8e(s.map(g=>g.shape),t);return r.runWebGLProgram(f,s,n)}let{tensors2D:u,outShape:d}=M8e(s,t,r),c=new $8e(u.map(f=>f.shape)),h=r.runWebGLProgram(c,u,n);u.forEach(f=>r.disposeIntermediateTensorInfo(f));let p=Ye({inputs:{x:h},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(h),p}function M8e(e,t,r){let n=H.computeOutShape(e.map(a=>a.shape),t);return{tensors2D:e.map(a=>Ye({inputs:{x:a},attrs:{shape:[-1,R.sizeFromShape(a.shape.slice(t))]},backend:r})),outShape:n}}function Cee(e){let{inputs:t,backend:r,attrs:n}=e,{axis:a}=n,s=R.parseAxisParam(a,t[0].shape)[0],i=t.map(d=>d.shape);H.assertParamsConsistent(i,s);let o=H.computeOutShape(t.map(d=>d.shape),s);if(R.sizeFromShape(o)===0)return r.makeTensorInfo(o,t[0].dtype,[]);let u=t.filter(d=>R.sizeFromShape(d.shape)>0);return u.length===1?Zs({inputs:{x:u[0]},backend:r}):ov(u,s,r)}var F8e={kernelName:sx,backendName:"webgl",kernelFunc:Cee},Iee=class{constructor(e,t=!1,r=null,n=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let s=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,c=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,m=e.dataFormat==="channelsLast",x=m?1:2,y=m?2:3,v=m?3:1,b="",N="";r&&(n?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:b=`
          float activation(float x) {
            ${r}
          }
        `,N="result = activation(result);");let S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${o}, ${u});
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${d};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${c};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${N}
        setOutput(result);
      }
    `}},O8e=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,r=e.padInfo.top,n=e.padInfo.left,a=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,c=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${s}, ${i});
      const ivec3 pads = ivec3(${t}, ${r}, ${n});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${c}; wF++) {
          int xF = xFCorner + wF * ${o};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${d};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},Eee=class{constructor(e,t=!1,r=null,n=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Pa(this.outputShape.length);let s=e.padInfo.left,i=e.strideWidth,o=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,c=d,h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<d;m++)h+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let m=0;m<d;m++)h+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(c+1)/2;m++){let x=m*2;if(h+=`
           xC = xCCorner + ${x*o};
           `,i===1){if(x<d&&(s%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,o===1&&x>0?h+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<d)){let y=s%2===0?R.nearestLargerEven(o):o;o%2===0&&s%2===1||o%2!==0&&s%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,o>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:h+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):y===1?h+=`
                     xC${x+1} = xTexelC${x};
                     `:h+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<d&&(s%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<d&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<d&&(h+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<d&&(h+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<d&&(h+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let p="",f="";r&&(n?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:a?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:p=`vec4 activation(vec4 x) {
           ${r}
         }`,f="result = activation(result);");let g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${f}
         setOutput(result);
       }
     `}},P8e=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Pa(this.outputShape.length);let{dataFormat:r}=t,n=ss(),a=r==="channelsLast",s=a?1:2,i=a?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,u="";for(let d=0;d<=1;d++)for(let c=0;c<=1;c++)u+=`
          blockIndex = rc.z + ${c};
          pos = rc.y + ${d};

          ${o}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${s}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${i}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${d*2+c}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${d*2+c}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${n.output} = result;
      }
    `}};function ES(e,t){let r=e.length;return r>=3?t?[...e.slice(0,-3),e[r-3]*e[r-2],e[r-1]]:[...e.slice(0,-3),e[r-3],e[r-2]*e[r-1]]:!t&&r===1&&e[0]>1?[e[0],1]:null}function Tee({x:e,filter:t,convInfo:r,backend:n,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:o=null}){let u=e.shape,d=n.texData.get(e.dataId),c=r.inChannels,h=u[0]*u[1]*u[2],p=r.outChannels,f=r.dataFormat==="channelsLast",g=!1,m=!1,x,y=[];if(s!=null){let v=ES(s.shape,f);v!=null&&(s=Ye({inputs:{x:s},backend:n,attrs:{shape:v}}),y.push(s))}if(a!=null){let v=ES(a.shape,f);v!=null&&(a=Ye({inputs:{x:a},backend:n,attrs:{shape:v}}),y.push(a))}if(!((h===1||p===1)&&c>wee)&&d.isPacked&&f&&d.texture!=null&&u[2]%2!==0&&R.arraysEqual(d.shape.slice(-3),u.slice(-3))){let v=u[0]*u[1]*(u[2]+1),b={dataId:e.dataId,shape:[1,v,r.inChannels],dtype:e.dtype},N=d.shape;d.shape=d.shape.slice(),d.shape[d.shape.length-2]++,R.assert(vb(d.shape,b.shape),()=>`packed reshape ${d.shape} to ${b.shape} isn't free`);let S=Ye({inputs:{x:t},backend:n,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(S);let _=IS({a:b,b:S,backend:n,transposeA:g,transposeB:m,bias:a,activation:o,preluActivationWeights:s,leakyreluAlpha:i}),C=n.texData.get(_.dataId);R.assert(C.isPacked,()=>"batchMatMul result is expected to be packed"),d.shape=N,C.shape=r.outShape,x=Zs({inputs:{x:_},backend:n}),x.shape=r.outShape,y.push(_)}else{let v=r.outHeight*r.outWidth,b=Ye({inputs:{x:e},backend:n,attrs:{shape:f?[r.batchSize,v,r.inChannels]:[r.batchSize,r.inChannels,v]}}),N=Ye({inputs:{x:t},backend:n,attrs:{shape:[1,r.inChannels,r.outChannels]}}),S=IS({a:f?b:N,b:f?N:b,transposeA:!f,transposeB:m,backend:n,bias:a,activation:o,preluActivationWeights:s,leakyreluAlpha:i});x=Ye({inputs:{x:S},backend:n,attrs:{shape:r.outShape}}),y.push(b),y.push(N),y.push(S)}for(let v of y)n.disposeIntermediateTensorInfo(v);return x}function jee({x:e,filter:t,convInfo:r,backend:n,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:o=null}){let{filterWidth:u,filterHeight:d,inChannels:c,outWidth:h,outHeight:p,dataFormat:f}=r,g=f==="channelsLast",m=u*d*c,x=p*h,y=[r.batchSize,m,x],v=!0,b=!1,N=[];if(s!=null){let A=ES(s.shape,g);A!=null&&(s=Ye({inputs:{x:s},backend:n,attrs:{shape:A}}),N.push(s))}if(a!=null){let A=ES(a.shape,g);A!=null&&(a=Ye({inputs:{x:a},backend:n,attrs:{shape:A}}),N.push(a))}let S=Ye({inputs:{x:t},backend:n,attrs:{shape:[1,m,R.sizeFromShape(t.shape)/m]}});N.push(S);let _=new P8e(y,r),C=[e.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],k=n.runWebGLProgram(_,[e],"float32",C),I=Ye({inputs:{x:k},backend:n,attrs:{shape:y}});N.push(k),N.push(I);let T=a!=null,j=s!=null,E=o==="leakyrelu",O=o?bb(o,!0):null,M=new bee(g?I.shape:S.shape,g?S.shape:I.shape,g?[r.batchSize,x,r.outChannels]:[r.batchSize,r.outChannels,x],v,b,T,O,j,E),W=g?[I,S]:[S,I];if(a&&W.push(a),j&&W.push(s),E){let A=n.makeTensorInfo([],"float32",R.createScalarValue(i,"float32"));W.push(A),N.push(A)}let q=n.runWebGLProgram(M,W,"float32"),P=Ye({inputs:{x:q},backend:n,attrs:{shape:r.outShape}});N.push(q);for(let A of N)n.disposeIntermediateTensorInfo(A);return P}function L8e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dataFormat:u,dilations:d,dimRoundingMode:c}=n,h=H.convertConv2DDataFormat(u),p=H.computeConv2DInfo(a.shape,s.shape,i,d,o,c,!1,h),f;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))f=Tee({x:a,filter:s,convInfo:p,backend:r});else if(p.strideWidth<=2&&h==="channelsLast"&&ge().getBool("WEBGL_EXP_CONV")){let m=new Eee(p),x=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];f=r.runWebGLProgram(m,[a,s],"float32",x)}else if(ge().getBool("WEBGL_CONV_IM2COL"))f=jee({x:a,filter:s,convInfo:p,backend:r});else{let m=new Iee(p);f=r.runWebGLProgram(m,[a,s],"float32")}let g=Ye({inputs:{x:f},backend:r,attrs:{shape:p.outShape}});return r.disposeIntermediateTensorInfo(f),g}var z8e={kernelName:lp,backendName:"webgl",kernelFunc:L8e},B8e=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,r=e.strideWidth,n=e.padInfo.top,a=e.padInfo.left,s=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${n};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${s?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},U8e=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,a=e.strideWidth,s=e.dataFormat==="channelsLast",i=t-1-e.padInfo.top,o=r-1-e.padInfo.left,u=s?1:2,d=s?2:3,c=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${c}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${d}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${s}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},W8e=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,r=e.strideHeight,n=e.strideWidth,a=e.padInfo.front,s=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${s};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${n} - ${i};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},V8e=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,r=e.filterHeight,n=e.filterWidth,a=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.front,u=r-1-e.padInfo.top,d=n-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${o}, ${u}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${n}; wC++) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${n} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function H8e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,dy:s}=t,{strides:i,pad:o,dataFormat:u,dimRoundingMode:d,filterShape:c}=n,h=H.convertConv2DDataFormat(u),p=H.computeConv2DInfo(a.shape,c,i,1,o,d,!1,h),f=new B8e(p);return r.runWebGLProgram(f,[a,s],"float32")}var q8e={kernelName:pk,backendName:"webgl",kernelFunc:H8e},G8e=class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Pa(this.outputShape.length);let t=e.filterHeight,r=e.filterWidth,n=t-1-e.padInfo.top,a=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${n}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function K8e(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,filter:s}=t,{inputShape:i,strides:o,pad:u,dataFormat:d,dimRoundingMode:c}=n,h=H.convertConv2DDataFormat(d),p=H.computeConv2DInfo(i,s.shape,o,1,u,c,!1,h);if(ge().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&h==="channelsLast"){let f=[[p.strideHeight,p.strideWidth]],g=new G8e(p);return r.runWebGLProgram(g,[a,s],"float32",f)}else{let f=new U8e(p);return r.runWebGLProgram(f,[a,s],"float32")}}var Q8e={kernelName:up,backendName:"webgl",kernelFunc:K8e};function X8e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:u}=n,d=H.computeConv3DInfo(a.shape,s.shape,i,u,o),c=new O8e(d);return r.runWebGLProgram(c,[a,s],"float32")}var Y8e={kernelName:cp,backendName:"webgl",kernelFunc:X8e};function J8e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,dy:s}=t,{strides:i,pad:o,filterShape:u}=n,d=H.computeConv3DInfo(a.shape,u,i,1,o),c=new W8e(d);return r.runWebGLProgram(c,[a,s],"float32")}var Z8e={kernelName:ix,backendName:"webgl",kernelFunc:J8e};function e9e(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,filter:s}=t,{pad:i,strides:o,inputShape:u}=n,d=H.computeConv3DInfo(u,s.shape,o,1,i),c=new V8e(d);return r.runWebGLProgram(c,[a,s],"float32")}var t9e={kernelName:ox,backendName:"webgl",kernelFunc:e9e},r9e=gy+`
  return cos(x);
`,n9e=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${_f}
  return result;
`,a9e=gr({opSnippet:r9e,packedOpSnippet:n9e}),s9e={kernelName:dp,backendName:"webgl",kernelFunc:a9e},i9e=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,o9e=gr({opSnippet:i9e}),l9e={kernelName:hp,backendName:"webgl",kernelFunc:o9e},u9e=class{constructor(e,t,r,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[s,i,o,u]=e,[d]=t,[c,h]=r;this.outputShape=[d,c,h,u];let p=n==="bilinear"?1:0,[f,g]=[`${i-1}.0`,`${o-1}.0`],[m,x,y]=c>1?[`${(i-1)/(c-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[v,b,N]=h>1?[`${(o-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${s}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${b};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${N};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}},c9e=e=>{let{inputs:t,backend:r,attrs:n}=e,{image:a,boxes:s,boxInd:i}=t,{cropSize:o,method:u,extrapolationValue:d}=n,c=new u9e(a.shape,s.shape,o,u,d);return r.runWebGLProgram(c,[a,s,i],"float32")},d9e={kernelName:ux,backendName:"webgl",kernelFunc:c9e},Nb;(function(e){e.Prod="*",e.Sum="+"})(Nb||(Nb={}));var Nz=class{constructor(e,t,r,n){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let a=this.outputShape.length,s=this.op===Nb.Prod?"1.0":"0.0",i=r?s:`getX(${Sz(a,"coords",this.op)})`,o=this.outputShape[this.outputShape.length-1],u="",d="";r?(u=n?`end != ${o-1}`:"end != 0",d=n?"end + 1":"end - 1"):(u=n?`end + pow2 < ${o}`:"end >= pow2",d=n?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Ur(a)} coords = getOutputCoords();
        int end = ${_z(a,"coords",this.op)};
        float val = ${i};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${d};
          ${_z(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${Sz(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}};function Sz(e,t,r){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${r} for rank ${e} is not yet supported`)}function _z(e,t,r){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${r} for rank ${e} is not yet supported`)}function Aee(e,t,r,n,a,s){let i=t.shape.length,o=H.getAxesPermutation([n],i),u=t;o!=null&&(u=es({inputs:{x:t},backend:r,attrs:{perm:o}}));let d=H.getInnerMostAxes(1,i)[0];if(d!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${n}`);let c=u.shape[d],h=Zs({inputs:{x:u},backend:r});for(let p=0;p<=Math.ceil(Math.log2(c))-1;p++){let f=new Nz(e,u.shape,!1,s),g=[[p]],m=h;h=r.runWebGLProgram(f,[h],h.dtype,g),r.disposeIntermediateTensorInfo(m)}if(a){let p=new Nz(e,u.shape,a,s),f=h;h=r.runWebGLProgram(p,[h],h.dtype),r.disposeIntermediateTensorInfo(f)}if(o!=null){let p=H.getUndoAxesPermutation(o),f=es({inputs:{x:h},backend:r,attrs:{perm:p}});return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(u),f}return h}function h9e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=n;return Aee(Nb.Prod,a,r,s,i,o)}var p9e={kernelName:lx,backendName:"webgl",kernelFunc:h9e};function f9e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=n;return Aee(Nb.Sum,a,r,s,i,o)}var m9e={kernelName:pp,backendName:"webgl",kernelFunc:f9e};function g9e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,weights:s}=t,{size:i,binaryOutput:o}=n;if(a.shape.length===1){let u=r.readSync(a.dataId),d=r.readSync(s.dataId),c=uee(u,d,s.dtype,s.shape,i);return r.makeTensorInfo([i],s.dtype,c)}else if(a.shape.length===2){let u=r.bufferSync(a),d=r.bufferSync(s),c=yHe(u,d,i,o);return r.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}var x9e={kernelName:m0,backendName:"webgl",kernelFunc:g9e},y9e=class{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function v9e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockSize:s,dataFormat:i}=n,o=a.shape[0],u=i==="NHWC"?a.shape[1]:a.shape[2],d=i==="NHWC"?a.shape[2]:a.shape[3],c=i==="NHWC"?a.shape[3]:a.shape[1],h=u*s,p=d*s,f=c/(s*s),g=i==="NHWC"?[o,h,p,f]:[o,f,h,p],m=new y9e(g,s,i);return r.runWebGLProgram(m,[a],a.dtype)}var b9e={kernelName:cx,backendName:"webgl",kernelFunc:v9e},$ee=class{constructor(e,t=!1,r=null,n=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Pa(this.outputShape.length);let s=e.filterHeight,i=e.filterWidth,o=e.outChannels/e.inChannels,u="",d="";r&&(n?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,d="result = activation(result);");let c=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${s}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${i}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${c}
        ${d}
        setOutput(result);
      }
    `}},Ree=class{constructor(e,t=!1,r=null,n=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Pa(this.outputShape.length);let s=e.outChannels/e.inChannels,i=e.padInfo.left,o=e.strideWidth,u=e.dilationWidth,d=e.filterHeight,c=e.filterWidth,h=c,p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<c;x++)p+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;p+=`
    for (int r = 0; r < ${d}; r++) {
      `;for(let x=0;x<c;x++)p+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(h+1)/2;x++){let y=x*2;if(p+=`
          xC = xCCorner + ${y*u};
          `,o===1){if(y<c&&(i%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,u===1&&y>0?p+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<c)){let v=i%2===0?R.nearestLargerEven(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,u>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:p+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):v===1?p+=`
                    xC${y+1} = xTexelC${y};
                    `:p+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<c&&(i%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<c&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<c&&(p+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<c&&(p+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<c&&(p+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let f="",g="";r&&(n?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:f=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}};function w9e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:u,dimRoundingMode:d}=n,c=u;c==null&&(c=[1,1]),R.assert(H.eitherStridesOrDilationsAreOne(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let h=H.computeConv2DInfo(a.shape,s.shape,i,c,o,d,!0),p;ge().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?p=new Ree(h):p=new $ee(h);let f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return r.runWebGLProgram(p,[a,s],"float32",f)}var N9e={kernelName:fp,backendName:"webgl",kernelFunc:w9e},S9e=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,r=e.strideWidth,n=e.padInfo.top,a=e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${s} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${n};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},_9e=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.top,i=r-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${o}; dm++) {
              int d2 = d1 * ${o} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function k9e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,dy:s}=t,{strides:i,dilations:o,pad:u,dimRoundingMode:d,filterShape:c}=n,h=H.computeConv2DInfo(a.shape,c,i,o,u,d,!0),p=new S9e(h);return r.runWebGLProgram(p,[a,s],"float32")}var C9e={kernelName:fk,backendName:"webgl",kernelFunc:k9e};function I9e(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,filter:s}=t,{strides:i,dilations:o,pad:u,dimRoundingMode:d,inputShape:c}=n,h=H.computeConv2DInfo(c,s.shape,i,o,u,d,!0),p=new _9e(h);return r.runWebGLProgram(p,[a,s],"float32")}var E9e={kernelName:mk,backendName:"webgl",kernelFunc:I9e},T9e=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function j9e(e){let{inputs:t,backend:r}=e,{x:n}=t,a=[...n.shape,...n.shape],s=R.sizeFromShape(n.shape),i=Ye({inputs:{x:n},backend:r,attrs:{shape:[s]}}),o=new T9e(s),u=r.runWebGLProgram(o,[i],i.dtype),d=Ye({inputs:{x:u},backend:r,attrs:{shape:a}});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(u),d}var A9e={kernelName:g0,backendName:"webgl",kernelFunc:j9e},$9e=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:r,padInfo:n,strideHeight:a,strideWidth:s,filterHeight:i,filterWidth:o,dilationHeight:u,dilationWidth:d}=e,{top:c,left:h}=n;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${s});
      const ivec2 pads = ivec2(${c}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${i}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${o}; w++) {
              int wIn = wBeg + w * ${d};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function R9e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:u}=n,d=H.computeDilation2DInfo(a.shape,s.shape,i,o,"NHWC",u),c,h=new $9e(d);c=r.runWebGLProgram(h,[a,s],"float32");let p=Ye({inputs:{x:c},backend:r,attrs:{shape:d.outShape}});return r.disposeIntermediateTensorInfo(c),p}var D9e={kernelName:mp,backendName:"webgl",kernelFunc:R9e};function M9e(e){let{inputs:t,backend:r,attrs:n}=e,{equation:a}=n,s=t,{allDims:i,summedDims:o,idDims:u}=H.decodeEinsumEquation(a,s.length);H.checkEinsumDimSizes(i.length,u,s);let{path:d,steps:c}=H.getEinsumComputePath(o,u),h=c.length,p=null,f=i.length,g=[];for(let m=0;m<h;++m){for(let x of c[m]){let{permutationIndices:y,expandDims:v}=H.getEinsumPermutation(f,u[x]),b;H.isIdentityPermutation(y)?b=s[x]:(b=es({inputs:{x:s[x]},backend:r,attrs:{perm:y}}),g.push(b));let N=b.shape.slice();for(let S=0;S<v.length;++S)N.splice(v[S],0,1);R.arraysEqual(b.shape,N)||(b=Ye({inputs:{x:b},backend:r,attrs:{shape:N}}),g.push(b)),p===null?p=b:(p=lO({inputs:{a:b,b:p},backend:r}),g.push(p))}m<h-1&&(d[m]>=0&&(p=RC({inputs:{x:p},backend:r,attrs:{axis:d[m]-(i.length-f),keepDims:!1}}),g.push(p)),f--)}for(let m of g)m!==p&&r.disposeIntermediateTensorInfo(m);return p}var F9e={kernelName:xk,backendName:"webgl",kernelFunc:M9e},O9e="return (x >= 0.0) ? x : (exp(x) - 1.0);",P9e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,L9e=gr({opSnippet:O9e,packedOpSnippet:P9e}),z9e={kernelName:xp,backendName:"webgl",kernelFunc:L9e},B9e="return (b >= 0.0) ? a : a * (b + 1.0);",U9e=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,W9e=e=>{let{inputs:t,backend:r}=e,{dy:n,y:a}=t,s=ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new my(U9e,n.shape,a.shape):new Ph(B9e,n.shape,a.shape);return r.runWebGLProgram(s,[n,a],n.dtype)},V9e={kernelName:dx,backendName:"webgl",kernelFunc:W9e},H9e=`
  return vec4(equal(a, b));
`,q9e="return float(a == b);",G9e=Ea({opSnippet:q9e,packedOpSnippet:H9e,dtype:"bool",cpuKernelImpl:SHe}),K9e={kernelName:hx,backendName:"webgl",kernelFunc:G9e},Q9e=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${H.ERF_P};
  float a1 = ${H.ERF_A1};
  float a2 = ${H.ERF_A2};
  float a3 = ${H.ERF_A3};
  float a4 = ${H.ERF_A4};
  float a5 = ${H.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,X9e=gr({opSnippet:Q9e}),Y9e={kernelName:yp,backendName:"webgl",kernelFunc:X9e},J9e=gy+`
  return exp(x);
`,Z9e=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Dee=gr({opSnippet:J9e,packedOpSnippet:Z9e,cpuKernelImpl:_He,dtype:"float32"}),e7e={kernelName:vp,backendName:"webgl",kernelFunc:Dee};function gj(e){let{inputs:t,attrs:r,backend:n}=e,{dim:a}=r,{input:s}=t,i=s.shape.length,o=s.shape.slice(),u=a;return a<0&&(R.assert(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+a+1),o.splice(u,0,1),Ye({inputs:{x:s},backend:n,attrs:{shape:o}})}var t7e={kernelName:px,backendName:"webgl",kernelFunc:gj},kz="return exp(x) - 1.0;",r7e=gr({opSnippet:kz,packedOpSnippet:kz,cpuKernelImpl:kHe}),n7e={kernelName:bp,backendName:"webgl",kernelFunc:r7e},Cz=class{constructor(e,t,r){this.variableNames=["real","imag"];let n=t[1];this.outputShape=t;let a=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=r?`${n}.0`:"1.0",i;if(e==="real")i="return real * expR - imag * expI;";else if(e==="imag")i="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${i}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${n});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${n}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function Mee(e,t,r){let n=r.texData.get(e.dataId),a=R.sizeFromShape(e.shape),s=e.shape[e.shape.length-1],i=a/s,o=Ye({inputs:{x:e},backend:r,attrs:{shape:[i,s]}}),u=o.shape,d=new Cz("real",u,t),c=new Cz("imag",u,t),h=[{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:u},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:u}],p=r.runWebGLProgram(d,h,"float32"),f=r.runWebGLProgram(c,h,"float32"),g=od({inputs:{real:p,imag:f},backend:r});r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f);let m=Ye({inputs:{x:g},backend:r,attrs:{shape:e.shape}});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(g),m}function a7e(e){let{inputs:t,backend:r}=e,{input:n}=t;return Mee(n,!1,r)}var s7e={kernelName:yk,backendName:"webgl",kernelFunc:a7e},i7e=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function cw(e){let{backend:t,attrs:r}=e,{shape:n,value:a}=r,{dtype:s}=r;if(s=s||R.inferDtype(a),s==="string"){let i=R.getArrayFromDType(s,R.sizeFromShape(n));return i.fill(a),t.makeTensorInfo(n,s,i)}else{let i=new i7e(n,a),o=[[a]];return t.runWebGLProgram(i,[],s,o)}}var o7e={kernelName:x0,backendName:"webgl",kernelFunc:cw},l7e=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}},u7e={kernelName:fx,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:r}=e,n=t,a=new l7e(r.shape);return n.runWebGLProgram(a,[r],r.dtype)}},Iz="return floor(x);",c7e=gr({opSnippet:Iz,packedOpSnippet:Iz,cpuKernelImpl:CHe}),d7e={kernelName:wp,backendName:"webgl",kernelFunc:c7e},h7e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,p7e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,f7e=Ea({opSnippet:h7e,packedOpSnippet:p7e,dtype:"int32"}),m7e={kernelName:Np,backendName:"webgl",kernelFunc:f7e},g7e=class{constructor(e){this.variableNames=["A"];let t=ss(),[r,n]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${n}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}},x7e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=ss(),[r,n]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${n}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}},y7e={kernelName:iS,backendName:"webgl",kernelFunc:v7e},Uf,pI=ge().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function v7e(e){let{inputs:t,backend:r,attrs:n}=e,{pixels:a}=t,{numChannels:s}=n,i=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[u,d]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=[d,u],h=[d,u,s];if(o||i){let m=ge().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Uf==null||m!==pI)&&(pI=m,Uf=document.createElement("canvas").getContext("2d",{willReadFrequently:pI})),Uf.canvas.width=u,Uf.canvas.height=d,Uf.drawImage(a,0,0,u,d),a=Uf.canvas}let p=r.makeTensorInfo(c,"int32");r.texData.get(p.dataId).usage=ui.PIXELS,r.gpgpu.uploadPixelDataToTexture(r.getTexture(p.dataId),a);let f=ge().getBool("WEBGL_PACK")?new x7e(h):new g7e(h),g=r.runWebGLProgram(f,[p],"int32");return r.disposeData(p.dataId),g}function b7e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:u,pad:d,dataFormat:c,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=n,m=H.convertConv2DDataFormat(c),x=H.computeConv2DInfo(a.shape,s.shape,u,h,d,p,!1,m),y,v=[],b=i!=null,N=o!=null,S=f==="leakyrelu",_=()=>{let k=[a,s],I=(T,j)=>{if(j==="NCHW"&&T.shape.length===1&&T.shape[0]!==1){let E=Ye({inputs:{x:T},backend:r,attrs:{shape:[T.shape[0],1,1]}});return v.push(E),E}return T};if(b&&k.push(I(i,c)),N&&k.push(I(o,c)),S){let T=r.makeTensorInfo([],"float32",R.createScalarValue(g,"float32"));k.push(T),v.push(T)}return k};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))y=Tee({x:a,filter:s,convInfo:x,backend:r,bias:i,activation:f,preluActivationWeights:o,leakyreluAlpha:g});else if(x.strideWidth<=2&&m==="channelsLast"&&ge().getBool("WEBGL_EXP_CONV")){let k=f?bb(f,!0):null,I=new Eee(x,b,k,N,S),T=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],j=_();y=r.runWebGLProgram(I,j,"float32",T)}else if(ge().getBool("WEBGL_CONV_IM2COL"))y=jee({x:a,filter:s,convInfo:x,backend:r,bias:i,activation:f,preluActivationWeights:o,leakyreluAlpha:g});else{let k=f?bb(f,!1):null,I=new Iee(x,b,k,N,S),T=_();y=r.runWebGLProgram(I,T,"float32")}let C=Ye({inputs:{x:y},backend:r,attrs:{shape:x.outShape}});return v.push(y),v.forEach(k=>r.disposeIntermediateTensorInfo(k)),C}var w7e={kernelName:Nh,backendName:"webgl",kernelFunc:b7e};function N7e(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:u,pad:d,dilations:c,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=n,g=[],m=c;m==null&&(m=[1,1]),R.assert(H.eitherStridesOrDilationsAreOne(u,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${m}'`);let x=H.computeConv2DInfo(a.shape,s.shape,u,m,d,h,!0),y=ge().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,v=p?bb(p,y):null,b=[a,s],N=i!=null,S=o!=null,_=p==="leakyrelu";if(N&&b.push(i),S&&b.push(o),_){let T=r.makeTensorInfo([],"float32",R.createScalarValue(f,"float32"));b.push(T),g.push(T)}let C;y?C=new Ree(x,N,v,S,_):C=new $ee(x,N,v,S,_);let k=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],I=r.runWebGLProgram(C,b,"float32",k);return g.forEach(T=>r.disposeIntermediateTensorInfo(T)),I}var S7e={kernelName:Sh,backendName:"webgl",kernelFunc:N7e},_7e=class{constructor(e,t,r,n){this.sliceDim=e,this.strides=t,this.paramsShape=n,this.variableNames=["x","indices"],this.outputShape=r;let a=Ur(r.length),s=`
    int index;`;for(let i=0;i<this.sliceDim;i++)s+=`
          index = round(getIndices(coords[0], ${i}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[i]};
          flattenIndex += index * ${this.strides[i]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${s}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function k7e(e){let{inputs:t,backend:r}=e,{params:n,indices:a}=t,s=a.shape,i=s[s.length-1],o=R.sizeFromShape(n.shape),[u,d,c,h]=H.prepareAndValidate(n,a),p=Ye({inputs:{x:a},backend:r,attrs:{shape:[d,i]}}),f=Ye({inputs:{x:n},backend:r,attrs:{shape:[R.sizeFromShape(n.shape)/c,c]}});if(r.shouldExecuteOnCPU([n,a])||n.dtype==="string"){let y=r.readSync(a.dataId),v=r.bufferSync(n),b=IHe(y,v,n.dtype,d,i,c,h,n.shape,o);return r.makeTensorInfo(u,n.dtype,b.values)}let g=new _7e(i,h,[d,c],n.shape),m=r.runWebGLProgram(g,[f,p],f.dtype),x=Ye({inputs:{x:m},backend:r,attrs:{shape:u}});return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(m),x}var C7e={kernelName:gx,backendName:"webgl",kernelFunc:k7e},I7e=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let r=Ur(this.rank),n=E7e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${n}));
      }
    `}};function E7e(e,t){let r=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let a=0;a<e.length;a++)a===2?n.push("index"):n.push(`${r[a]}`);return n.join()}function Fee(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,indices:s}=t,{axis:i,batchDims:o}=n,u=R.parseAxisParam(i,a.shape)[0];if(ge().get("DEBUG")){let v=r.readSync(s.dataId),b=a.shape[u];for(let N=0;N<v.length;++N){let S=v[N];R.assert(S<=b-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${b-1}]`)}}let d=H.segment_util.collectGatherOpShapeInfo(a,s,u,o),c=R.sizeFromShape(s.shape),h=[],p=Ye({inputs:{x:a},backend:r,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),f=Ye({inputs:{x:s},backend:r,attrs:{shape:[d.batchSize,c/d.batchSize]}});h.push(p),h.push(f);let g=[d.batchSize,d.outerSize,c/d.batchSize,d.sliceSize];if(r.shouldExecuteOnCPU([a,s])||a.dtype==="string"){let v=r.bufferSync(f),b=r.bufferSync(p),N=EHe(b,v,g);return h.forEach(S=>r.disposeIntermediateTensorInfo(S)),r.makeTensorInfo(d.outputShape,N.dtype,N.values)}let m=new I7e(p.shape,g),x=r.runWebGLProgram(m,[p,f],p.dtype);h.push(x);let y=Ye({inputs:{x},backend:r,attrs:{shape:d.outputShape}});return h.forEach(v=>r.disposeIntermediateTensorInfo(v)),y}var T7e={kernelName:mx,backendName:"webgl",kernelFunc:Fee},j7e="return float(a > b);",A7e=`
  return vec4(greaterThan(a, b));
`,$7e=Ea({opSnippet:j7e,packedOpSnippet:A7e,cpuKernelImpl:THe,dtype:"bool"}),R7e={kernelName:xx,backendName:"webgl",kernelFunc:$7e},D7e="return float(a >= b);",M7e=`
  return vec4(greaterThanEqual(a, b));
`,F7e=Ea({opSnippet:D7e,packedOpSnippet:M7e,dtype:"bool",cpuKernelImpl:jHe}),O7e={kernelName:_p,backendName:"webgl",kernelFunc:F7e};function P7e(e){let{inputs:t,backend:r}=e,{input:n}=t;return Mee(n,!0,r)}var L7e={kernelName:vk,backendName:"webgl",kernelFunc:P7e},z7e="return float(!isnan(x) && !isinf(x));",B7e=gr({opSnippet:z7e,dtype:"bool"}),U7e={kernelName:Cp,backendName:"webgl",kernelFunc:B7e},W7e="return float(isinf(x));",V7e=gr({opSnippet:W7e,dtype:"bool"}),H7e={kernelName:Ip,backendName:"webgl",kernelFunc:V7e},q7e="return float(isnan(x));",G7e=gr({opSnippet:q7e,dtype:"bool"}),K7e={kernelName:Ep,backendName:"webgl",kernelFunc:G7e},Q7e="return float(a < b);",X7e=`
  return vec4(lessThan(a, b));
`,Y7e=Ea({opSnippet:Q7e,packedOpSnippet:X7e,cpuKernelImpl:AHe,dtype:"bool"}),J7e={kernelName:yx,backendName:"webgl",kernelFunc:Y7e},Z7e="return float(a <= b);",eKe=`
  return vec4(lessThanEqual(a, b));
`,tKe=Ea({opSnippet:Z7e,packedOpSnippet:eKe,cpuKernelImpl:$He,dtype:"bool"}),rKe={kernelName:vx,backendName:"webgl",kernelFunc:tKe};function nKe(e){let{backend:t,attrs:r}=e,{start:n,stop:a,num:s}=r,i=RHe(n,a,s);return t.makeTensorInfo([i.length],"float32",i)}var aKe={kernelName:bx,backendName:"webgl",kernelFunc:nKe},sKe=gy+`
  return x < 0.0 ? 0./0. : log(x);
`,iKe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,oKe=gr({opSnippet:sKe,packedOpSnippet:iKe,cpuKernelImpl:DHe}),lKe={kernelName:jp,backendName:"webgl",kernelFunc:oKe},uKe=gy+`
  return log(1.0 + x);
`,cKe=gr({opSnippet:uKe}),dKe={kernelName:Ap,backendName:"webgl",kernelFunc:cKe},hKe="return float(a >= 1.0 && b >= 1.0);",pKe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,fKe=Ea({opSnippet:hKe,packedOpSnippet:pKe,dtype:"bool"}),mKe={kernelName:wx,backendName:"webgl",kernelFunc:fKe},gKe="return float(!(x >= 1.0));",xKe=gr({opSnippet:gKe}),yKe={kernelName:Nx,backendName:"webgl",kernelFunc:xKe},vKe="return float(a >= 1.0 || b >= 1.0);",bKe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,wKe=Ea({opSnippet:vKe,packedOpSnippet:bKe,dtype:"bool"}),NKe={kernelName:Sx,backendName:"webgl",kernelFunc:wKe},SKe=class{constructor(e,t,r,n,a){this.variableNames=["x"],this.outputShape=[];let s=t,i=e[3]-1;this.outputShape=e;let o,u=`float(${r}) + float(${n}) * sum`;a===.5?o=`inversesqrt(${u})`:a===1?o=`1.0/(${u})`:o=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${s}; j <= ${s}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${i}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${o};
        setOutput(val);
      }
    `}},_Ke=class{constructor(e,t,r,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let s=t,i=e[3]-1;this.outputShape=e;let o,u=`float(${r}) + float(${n}) * sum`;a===.5?o=`inversesqrt(${u})`:a===1?o=`1.0/(${u})`:o=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${s};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${s}; j <= ${s}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${i}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${o};
        setOutput(result);
      }
    `}},kKe=e=>{let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{depthRadius:s,bias:i,alpha:o,beta:u}=n,d=ge().getBool("WEBGL_PACK_NORMALIZATION")?new _Ke(a.shape,s,i,o,u):new SKe(a.shape,s,i,o,u);return r.runWebGLProgram(d,[a],a.dtype)},CKe={kernelName:$p,backendName:"webgl",kernelFunc:kKe},IKe=class{constructor(e,t,r,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${n}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${n})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}},EKe=e=>{let{inputs:t,backend:r,attrs:n}=e,{x:a,y:s,dy:i}=t,{depthRadius:o,bias:u,alpha:d,beta:c}=n,h=new IKe(a.shape,o,u,d,c);return r.runWebGLProgram(h,[a,s,i],a.dtype)},TKe={kernelName:_x,backendName:"webgl",kernelFunc:EKe};function jKe(e,t,r,n){let a=R.sizeFromShape(t),s=R.sizeFromShape(e.shape)/a,i=Ye({inputs:{x:e},attrs:{shape:[s,a]},backend:n}),o=kf(i,e.dtype,"max",n),u=Ye({inputs:{x:o},attrs:{shape:r},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),u}function Oee(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{reductionIndices:s,keepDims:i}=n,o=a.shape.length,u=R.parseAxisParam(s,a.shape),d=u,c=H.getAxesPermutation(d,o),h=c!=null,p=r.shouldExecuteOnCPU([a]),f=a;if(h){if(p){let v=r.texData.get(f.dataId).values,b=new Array(o);for(let _=0;_<b.length;_++)b[_]=a.shape[c[_]];let N=sO(v,a.shape,a.dtype,c,b);f=r.makeTensorInfo(b,a.dtype);let S=r.texData.get(f.dataId);S.values=N}else f=$C(a,c,r);d=H.getInnerMostAxes(d.length,o)}H.assertAxesAreInnerMostDims("max",d,o);let[g,m]=H.computeOutAndReduceShapes(f.shape,d),x=g;i&&(x=H.expandShapeToKeepDim(g,u));let y;if(p){let v=r.texData.get(f.dataId).values,b=MHe(v,R.sizeFromShape(m),x,a.dtype);y=r.makeTensorInfo(x,a.dtype);let N=r.texData.get(y.dataId);N.values=b}else y=jKe(f,m,x,r);return h&&r.disposeIntermediateTensorInfo(f),y}var AKe={kernelName:Rp,backendName:"webgl",kernelFunc:Oee},$Ke=oO+`
  return max(a, b);
`,RKe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+_f+`
  return result;
`,DKe=Ea({opSnippet:$Ke,packedOpSnippet:RKe,cpuKernelImpl:FHe}),MKe={kernelName:Dp,backendName:"webgl",kernelFunc:DKe};function FKe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t;cy(a,"maxPool");let{filterSize:s,strides:i,pad:o,dimRoundingMode:u}=n,d=1;R.assert(H.eitherStridesOrDilationsAreOne(i,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);let c=H.computePool2DInfo(a.shape,s,i,d,o,u);if(c.filterWidth===1&&c.filterHeight===1&&R.arraysEqual(c.inShape,c.outShape))return Zs({inputs:{x:a},backend:r});let h=new wb(c,"max",!1);return r.runWebGLProgram(h,[a],a.dtype)}var OKe={kernelName:Mp,backendName:"webgl",kernelFunc:FKe};function PKe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dataFormat:u,dimRoundingMode:d}=n,c=[1,1,1],h=H.computePool3DInfo(a.shape,s,i,c,o,d,u),p=new uO(h,"max",!1);return r.runWebGLProgram(p,[a],a.dtype)}var LKe={kernelName:kx,backendName:"webgl",kernelFunc:PKe},zKe=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,r=e.strideWidth,n=e.dilationHeight,a=e.effectiveFilterHeight,s=e.effectiveFilterWidth,i=a-1-e.padInfo.top,o=s-1-e.padInfo.left,u=a*s-1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${n}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${s} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},BKe=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,r=e.strideHeight,n=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,c=o-1-e.padInfo.front,h=u-1-e.padInfo.top,p=d-1-e.padInfo.left,f=o*u*d-1;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${h}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${o};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${s}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${i}) {
              float dyC = float(dyCCorner + wC) / ${n}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${d} +
                  wR * ${d} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function UKe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,i=s,{filterSize:o,strides:u,pad:d,dimRoundingMode:c}=n,h=[1,1,1],p=H.computePool3DInfo(i.shape,o,u,h,d,c),f=new uO(p,"max",!0),g=r.runWebGLProgram(f,[i],i.dtype),m=new BKe(p),x=r.runWebGLProgram(m,[a,g],i.dtype);return r.disposeIntermediateTensorInfo(g),x}var WKe={kernelName:v0,backendName:"webgl",kernelFunc:UKe};function VKe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s,output:i}=t,o=s;cy([s,i],"maxPoolGrad");let{filterSize:u,strides:d,pad:c,dimRoundingMode:h}=n,p=H.computePool2DInfo(o.shape,u,d,1,c,h),f=!0,g=new wb(p,"max",f),m=r.runWebGLProgram(g,[o],o.dtype),x=new zKe(p),y=r.runWebGLProgram(x,[a,m],o.dtype);return r.disposeIntermediateTensorInfo(m),y}var HKe={kernelName:y0,backendName:"webgl",kernelFunc:VKe};function qKe(e,t,r,n){let a=new wb(r,"max",!1),s=n.runWebGLProgram(a,[e],"float32");a=new wb(r,"max",!0,!0,t);let i=n.runWebGLProgram(a,[e],"float32");return[s,i]}var GKe={kernelName:b0,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:r})=>{let{x:n}=e,{filterSize:a,strides:s,pad:i,includeBatchInIndex:o}=t,u=r;R.assert(n.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${n.shape.length}.`);let d=[1,1];R.assert(H.eitherStridesOrDilationsAreOne(s,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${d}'`);let c=H.computePool2DInfo(n.shape,a,s,d,i),[h,p]=qKe(n,o,c,u);return[h,p]}};function KKe(e,t,r,n){let a=R.sizeFromShape(t),s=R.sizeFromShape(e.shape)/a,i=Ye({inputs:{x:e},attrs:{shape:[s,a]},backend:n}),o=kf(i,"float32","mean",n),u=Ye({inputs:{x:o},attrs:{shape:r},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),u}var QKe={kernelName:Fp,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:r})=>{let{x:n}=e,{keepDims:a,axis:s}=t,i=r,o=n.shape.length,u=R.parseAxisParam(s,n.shape),d=u,c=H.getAxesPermutation(d,o),h=c!=null,p=i.shouldExecuteOnCPU([n]),f=[],g=n;if(h){if(p){let b=i.texData.get(g.dataId).values,N=new Array(o);for(let C=0;C<N.length;C++)N[C]=n.shape[c[C]];let S=sO(b,n.shape,n.dtype,c,N);g=i.makeTensorInfo(N,n.dtype);let _=i.texData.get(g.dataId);_.values=S}else g=$C(n,c,i);f.push(g),d=H.getInnerMostAxes(d.length,o)}H.assertAxesAreInnerMostDims("sum",d,o);let[m,x]=H.computeOutAndReduceShapes(g.shape,d),y=m;a&&(y=H.expandShapeToKeepDim(m,u));let v=KKe(g,x,y,i);for(let b of f)i.disposeIntermediateTensorInfo(b);return v}};function XKe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n,o=a.shape.length,u=R.parseAxisParam(s,a.shape),d=u,c=H.getAxesPermutation(d,o),h=a;c!=null&&(h=es({inputs:{x:a},backend:r,attrs:{perm:c}}),d=H.getInnerMostAxes(d.length,a.shape.length)),H.assertAxesAreInnerMostDims("min",d,o);let[p,f]=H.computeOutAndReduceShapes(h.shape,d),g=R.sizeFromShape(f),m=Ye({inputs:{x:h},backend:r,attrs:{shape:[-1,g]}}),x=kf(m,m.dtype,"min",r),y;if(i){let v=H.expandShapeToKeepDim(p,u);y=Ye({inputs:{x},backend:r,attrs:{shape:v}})}else y=Ye({inputs:{x},backend:r,attrs:{shape:p}});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(x),c!=null&&r.disposeIntermediateTensorInfo(h),y}var YKe={kernelName:Op,backendName:"webgl",kernelFunc:XKe},JKe=oO+`
  return min(a, b);
`,ZKe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+_f+`
  return result;
`,eQe=Ea({opSnippet:JKe,packedOpSnippet:ZKe,cpuKernelImpl:OHe}),tQe={kernelName:Pp,backendName:"webgl",kernelFunc:eQe},rQe=class{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((d,c)=>d[0]+e[c]+d[1]);let n=e.length,a=Ur(n),s=t.map(d=>d[0]).join(","),i=t.map((d,c)=>d[0]+e[c]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n),u=r==="reflect"?0:1;if(n===1){this.userCode=`
        int start = ${s};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${i});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${n}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${o}));
      }
    `}},nQe=class{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((f,g)=>f[0]+e[g]+f[1]);let n=e.length,a=Ur(n),s=t.map(f=>f[0]).join(","),i=t.map((f,g)=>f[0]+e[g]).join(","),o=Ka("rc",n),u=Ka("source",n),d=`${o[n-1]} < ${this.outputShape[n-1]}`,c=n===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1,p="";if(n===1){let f=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${c});
        ${o[n-1]} += 1;
        if(${d}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${c});
        }
      `}else{let f=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${c});
        ${o[n-1]} += 1;
        if(${d}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${c});
        }
        rc = outputLoc;
        ${o[n-2]} += 1;
        if(${o[n-2]} < ${this.outputShape[n-2]}) {
          ${f}
          result[2] = getChannel(getX(${u.join()}), ${c});
          ${o[n-1]} += 1;
          if(${d}) {
            ${f}
            result[3] = getChannel(getX(${u.join()}), ${c});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${i});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}},aQe=({inputs:e,backend:t,attrs:r})=>{let{x:n}=e,{paddings:a,mode:s}=r,i=ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nQe(n.shape,a,s):new rQe(n.shape,a,s);return t.runWebGLProgram(i,[n],n.dtype)},sQe={kernelName:Lp,backendName:"webgl",kernelFunc:aQe},iQe=`if (b == 0.0) return NAN;
  return mod(a, b);`,oQe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+_f+`
  return result;
`,lQe=Ea({opSnippet:iQe,packedOpSnippet:oQe}),uQe={kernelName:zp,backendName:"webgl",kernelFunc:lQe},cQe=class{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}},dQe=`
if (a == b) {
  return 1.0;
};
return a / b;`,hQe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,Pee=Ea({opSnippet:dQe,packedOpSnippet:hQe,checkOutOfBounds:!0}),pQe={kernelName:gp,backendName:"webgl",kernelFunc:Pee},Ez="return a - b;",Lee=Ea({opSnippet:Ez,packedOpSnippet:Ez,supportsComplex:!0,cpuKernelImpl:aqe}),fQe={kernelName:hf,backendName:"webgl",kernelFunc:Lee};function zee(e){let{inputs:t,backend:r,attrs:n}=e,{logits:a}=t,{dim:s}=n,i=R.parseAxisParam([s],a.shape),o=Oee({inputs:{x:a},backend:r,attrs:{reductionIndices:i,keepDims:!1}}),u=H.expandShapeToKeepDim(o.shape,i),d=Ye({inputs:{x:o},backend:r,attrs:{shape:u}}),c=Lee({inputs:{a,b:d},backend:r}),h=Dee({inputs:{x:c},backend:r}),p=RC({inputs:{x:h},backend:r,attrs:{axis:i,keepDims:!1}}),f=Ye({inputs:{x:p},backend:r,attrs:{shape:u}}),g=Pee({inputs:{a:h,b:f},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(c),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),g}var mQe={kernelName:cf,backendName:"webgl",kernelFunc:zee};function gQe(e){let{inputs:t,backend:r,attrs:n}=e,{logits:a}=t,{numSamples:s,seed:i,normalized:o}=n,u=o?a:zee({inputs:{logits:a},backend:r,attrs:{dim:a.shape.length-1}}),d=u.shape[0],c=u.shape[1],h=new cQe(d,c,s),p=[[i]],f=r.runWebGLProgram(h,[u],"int32",p);return o||r.disposeIntermediateTensorInfo(u),f}var xQe={kernelName:Cx,backendName:"webgl",kernelFunc:gQe},yQe=Xi+`
  return -x;
`,vQe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function bQe(e){let{inputs:t,backend:r}=e,{x:n}=t;if(r.shouldExecuteOnCPU([n])){let s=r.texData.get(n.dataId),[i,o]=LHe(s.values,n.shape,n.dtype);return r.makeTensorInfo(o,n.dtype,i)}let a;return ge().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new sc(n.shape,vQe):a=new rl(n.shape,yQe),r.runWebGLProgram(a,[n],n.dtype)}var wQe={kernelName:Ix,backendName:"webgl",kernelFunc:bQe},NQe=Nl.nonMaxSuppressionV3Impl;function SQe(e){H.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:r,attrs:n}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:u}=n,d=r.readSync(a.dataId),c=r.readSync(s.dataId),{selectedIndices:h}=NQe(d,c,i,o,u);return r.makeTensorInfo([h.length],"int32",new Int32Array(h))}var _Qe={kernelName:Tx,backendName:"webgl",kernelFunc:SQe},kQe=Nl.nonMaxSuppressionV4Impl;function CQe(e){H.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:r,attrs:n}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:u,padToMaxOutputSize:d}=n,c=r.readSync(a.dataId),h=r.readSync(s.dataId),{selectedIndices:p,validOutputs:f}=kQe(c,h,i,o,u,d);return[r.makeTensorInfo([p.length],"int32",new Int32Array(p)),r.makeTensorInfo([],"int32",new Int32Array([f]))]}var IQe={kernelName:jx,backendName:"webgl",kernelFunc:CQe},EQe=Nl.nonMaxSuppressionV5Impl;function TQe(e){H.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:r,attrs:n}=e,{boxes:a,scores:s}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:u,softNmsSigma:d}=n,c=r.readSync(a.dataId),h=r.readSync(s.dataId),p=i,f=o,g=u,m=d,{selectedIndices:x,selectedScores:y}=EQe(c,h,p,f,g,m);return[r.makeTensorInfo([x.length],"int32",new Int32Array(x)),r.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var jQe={kernelName:Ax,backendName:"webgl",kernelFunc:TQe},AQe=class{constructor(e,t,r,n){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${n}), float(${r}),
                      float(index == coords.y)));
      }
    `}},$Qe=e=>{let{inputs:t,backend:r,attrs:n}=e,{indices:a}=t,{dtype:s,depth:i,onValue:o,offValue:u}=n,d=R.sizeFromShape(a.shape),c=new AQe(d,i,o,u),h=Ye({inputs:{x:a},backend:r,attrs:{shape:[d]}}),p=r.runWebGLProgram(c,[h],s);r.disposeIntermediateTensorInfo(h);let f=[...a.shape,i],g=Ye({inputs:{x:p},backend:r,attrs:{shape:f}});return r.disposeIntermediateTensorInfo(p),g},RQe={kernelName:Up,backendName:"webgl",kernelFunc:$Qe};function TS(e){let{inputs:t,backend:r}=e,{x:n}=t;if(n.dtype==="complex64"){let a=uw({inputs:{input:n},backend:r}),s=TS({inputs:{x:a},backend:r}),i=DC({inputs:{input:n},backend:r}),o=TS({inputs:{x:i},backend:r}),u=od({inputs:{real:s,imag:o},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}else return cw({attrs:{shape:n.shape,dtype:n.dtype,value:n.dtype==="string"?"":0},backend:r})}var DQe={kernelName:Xx,backendName:"webgl",kernelFunc:TS};function Bee(e){let{inputs:t,backend:r}=e,{x:n}=t;if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(n.dtype==="complex64"){let a=uw({inputs:{input:n},backend:r}),s=Bee({inputs:{x:a},backend:r}),i=DC({inputs:{input:n},backend:r}),o=TS({inputs:{x:i},backend:r}),u=od({inputs:{real:s,imag:o},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}else return cw({attrs:{shape:n.shape,dtype:n.dtype,value:1},backend:r})}var MQe={kernelName:$x,backendName:"webgl",kernelFunc:Bee};function FQe(e){let{inputs:t,backend:r,attrs:n}=e,{axis:a}=n;if(t.length===1)return gj({inputs:{input:t[0]},backend:r,attrs:{dim:a}});let s=t[0].shape,i=t[0].dtype;t.forEach(c=>{R.assertShapesMatch(s,c.shape,"All tensors passed to stack must have matching shapes"),R.assert(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],u=t.map(c=>{let h=gj({inputs:{input:c},backend:r,attrs:{dim:a}});return o.push(h),h}),d=Cee({inputs:u,backend:r,attrs:{axis:a}});return o.forEach(c=>r.disposeIntermediateTensorInfo(c)),d}var OQe={kernelName:Rx,backendName:"webgl",kernelFunc:FQe},PQe=class{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,d)=>u[0]+e[d]+u[1]);let n=e.length,a=Ur(n),s=t.map(u=>u[0]).join(","),i=t.map((u,d)=>u[0]+e[d]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);if(n===1){this.userCode=`
        int start = ${s};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${i});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${o}));
        }
      }
    `}},LQe=class{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((g,m)=>g[0]+e[m]+g[1]);let n=e.length,a=Ur(n),s=t.map(g=>g[0]).join(","),i=t.map((g,m)=>g[0]+e[m]).join(","),o=Ka("rc",n),u=Ka("source",n),d=`${o[n-1]} < ${this.outputShape[n-1]}`,c=n===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${a} rc = outputLoc;`,`${o[n-1]} += 1;
       if(${d}) {
      `,n===1?"":`}
       rc = outputLoc;
       ${o[n-2]} += 1;
       if(${o[n-2]} < ${this.outputShape[n-2]}) {`,n===1?"":`  ${o[n-1]} += 1;
         if(${d}) {`],p=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="";for(let g=0,m=n===1?2:4;g<m;g++)f+=`
        ${h[g]}
        if (${p}) {
          result[${g}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${c});
        }
      `;f+=n===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${i});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}},Uee=e=>{let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{paddings:s,constantValue:i}=n;if(R.sizeFromShape(a.shape)===0){let d=s.map((c,h)=>c[0]+a.shape[h]+c[1]);return cw({backend:r,attrs:{shape:d,value:i,dtype:a.dtype}})}let o=ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new LQe(a.shape,s,i):new PQe(a.shape,s,i),u=[[i]];return r.runWebGLProgram(o,[a],a.dtype,u)},zQe={kernelName:Wp,backendName:"webgl",kernelFunc:Uee},BQe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,UQe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+_f+`
  return result;
`,WQe=Ea({opSnippet:BQe,packedOpSnippet:UQe}),VQe={kernelName:Vp,backendName:"webgl",kernelFunc:WQe};function HQe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,keepDims:i}=n,o=a.shape.length,u=[],d=R.parseAxisParam(s,a.shape),c=d,h=H.getAxesPermutation(c,o),p=a;h!=null&&(p=es({inputs:{x:a},backend:r,attrs:{perm:h}}),c=H.getInnerMostAxes(c.length,o),u.push(p)),H.assertAxesAreInnerMostDims("prod",c,o);let f;if(r.shouldExecuteOnCPU([p])){let g=r.texData.get(p.dataId).values,{outVals:m,outShape:x,outDtype:y}=BHe(p.shape,p.dtype,g,c);f=r.makeTensorInfo(x,y,m)}else{let[g,m]=H.computeOutAndReduceShapes(p.shape,c),x=R.sizeFromShape(m),y=Ye({inputs:{x:p},backend:r,attrs:{shape:[-1,x]}}),v=Ck(a.dtype),b=kf(y,v,"prod",r);f=Ye({inputs:{x:b},backend:r,attrs:{shape:g}}),u.push(y),u.push(b)}if(i){u.push(f);let g=H.expandShapeToKeepDim(f.shape,d);f=Ye({inputs:{x:f},backend:r,attrs:{shape:g}})}return u.forEach(g=>r.disposeIntermediateTensorInfo(g)),f}var qQe={kernelName:qp,backendName:"webgl",kernelFunc:HQe};function GQe(e){let{inputs:t,backend:r,attrs:n}=e,{paramsNestedSplits:a,paramsDenseValues:s,indices:i}=t,{outputRaggedRank:o}=n,u=a.map(y=>r.readSync(y.dataId)),d=a.map(y=>y.shape),c=r.readSync(s.dataId),h=r.readSync(i.dataId),[p,f,g]=UHe(u,d,c,s.shape,s.dtype,h,i.shape,o),m=p.map(y=>r.makeTensorInfo([y.length],"int32",y)),x=r.makeTensorInfo(g,s.dtype,f);return m.concat([x])}var KQe={kernelName:wk,backendName:"webgl",kernelFunc:GQe};function QQe(e){let{inputs:t,backend:r}=e,{starts:n,limits:a,deltas:s}=t,i=r.readSync(n.dataId),o=r.readSync(a.dataId),u=r.readSync(s.dataId),[d,c]=WHe(i,n.shape,n.dtype,o,a.shape,u,s.shape),h=r.makeTensorInfo([d.length],"int32",d),p=r.makeTensorInfo([c.length],n.dtype,c);return[h,p]}var XQe={kernelName:Nk,backendName:"webgl",kernelFunc:QQe};function YQe(e){let{inputs:t,backend:r,attrs:n}=e,{shape:a,values:s,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:u}=n,d=r.readSync(a.dataId),c=r.readSync(s.dataId),h=r.readSync(i.dataId),p=o.map(x=>r.readSync(x.dataId)),f=o.map(x=>x.shape),[g,m]=VHe(d,a.shape,c,s.shape,s.dtype,h,i.shape,p,f,u);return r.makeTensorInfo(g,s.dtype,m)}var JQe={kernelName:Sk,backendName:"webgl",kernelFunc:YQe},Wee=e=>{let{backend:t,attrs:r}=e,{start:n,stop:a,step:s,dtype:i}=r,o=HHe(n,a,s,i);return t.makeTensorInfo([o.length],i,o)},ZQe={kernelName:w0,backendName:"webgl",kernelFunc:Wee},eXe="return 1.0 / x;",tXe=gr({opSnippet:eXe}),rXe={kernelName:Gp,backendName:"webgl",kernelFunc:tXe},nXe=Xi+`
  return (x < 0.0) ? 0.0 : x;
`,aXe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sXe=gr({opSnippet:nXe,packedOpSnippet:aXe}),iXe={kernelName:Kp,backendName:"webgl",kernelFunc:sXe},oXe=Xi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,lXe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uXe=gr({opSnippet:oXe,packedOpSnippet:lXe}),cXe={kernelName:Yp,backendName:"webgl",kernelFunc:uXe},dXe=class{constructor(e,t,r,n,a){this.variableNames=["A"],this.outputShape=[];let[s,i,o,u]=e;this.outputShape=[s,t,r,u];let d=[n&&t>1?i-1:i,n&&r>1?o-1:o],c=[n&&t>1?t-1:t,n&&r>1?r-1:r],h;a?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/c[0]},
          ${d[1]/c[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}},hXe=class{constructor(e,t,r,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,i,o,u]=e;this.outputShape=[s,t,r,u];let d=[n&&t>1?i-1:i,n&&r>1?o-1:o],c=[n&&t>1?t-1:t,n&&r>1?r-1:r],h;a?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/c[0]},
          ${d[1]/c[1]},
          ${d[1]/c[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function pXe(e){let{inputs:t,backend:r,attrs:n}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=n,[u,d]=o,c=ge().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new hXe(a.shape,u,d,s,i):new dXe(a.shape,u,d,s,i);return r.runWebGLProgram(c,[a],"float32")}var fXe={kernelName:Xp,backendName:"webgl",kernelFunc:pXe},mXe=class{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,n,a]=t,[,s,i]=e,o=[r&&s>1?n-1:n,r&&i>1?a-1:a],u=[r&&s>1?s-1:s,r&&i>1?i-1:i],d=o[0]/u[0],c=o[1]/u[1],h=1/d,p=1/c,f=Math.ceil(h)*2+2,g=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${c});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${n-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function gXe(e){let{inputs:t,backend:r,attrs:n}=e,{images:a,dy:s}=t,{alignCorners:i}=n,o=new mXe(s.shape,a.shape,i);return r.runWebGLProgram(o,[s],s.dtype)}var xXe={kernelName:Fx,backendName:"webgl",kernelFunc:gXe},yXe=class{constructor(e,t,r,n,a){this.variableNames=["A"],this.outputShape=[];let[s,i,o,u]=e;this.outputShape=[s,t,r,u];let d=[n&&t>1?i-1:i,n&&r>1?o-1:o],c=[n&&t>1?t-1:t,n&&r>1?r-1:r],h=n?"0.5":"0.0",p;a?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/c[0]},
          ${d[1]/c[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}},vXe=class{constructor(e,t,r,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[s,i,o,u]=e;this.outputShape=[s,t,r,u];let d=[n&&t>1?i-1:i,n&&r>1?o-1:o],c=[n&&t>1?t-1:t,n&&r>1?r-1:r],h=n?"0.5":"0.0",p;a?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/c[0]},
          ${d[1]/c[1]},
          ${d[1]/c[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function bXe(e){let{inputs:t,backend:r,attrs:n}=e,{images:a}=t,{alignCorners:s,halfPixelCenters:i,size:o}=n,[u,d]=o,c=ge().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new vXe(a.shape,u,d,s,i):new yXe(a.shape,u,d,s,i);return r.runWebGLProgram(c,[a],a.dtype)}var wXe={kernelName:Qp,backendName:"webgl",kernelFunc:bXe},NXe=class{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,n,a]=t,[,s,i]=e,o=[r&&s>1?n-1:n,r&&i>1?a-1:a],u=[r&&s>1?s-1:s,r&&i>1?i-1:i],d=o[0]/u[0],c=o[1]/u[1],h=1/d,p=1/c,f=Math.ceil(h)*2+2,g=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${c});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float sourceFracRow =
              float(${o[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${o[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${n}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function SXe(e){let{inputs:t,backend:r,attrs:n}=e,{images:a,dy:s}=t,{alignCorners:i}=n,o=new NXe(s.shape,a.shape,i);return r.runWebGLProgram(o,[s],s.dtype)}var _Xe={kernelName:Mx,backendName:"webgl",kernelFunc:SXe},kXe=class{constructor(e,t){this.variableNames=["x"];let r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let n=i=>t.indexOf(i)!==-1&&e[i]!==1?`${e[i]} - coords[${i}] - 1`:`coords[${i}]`,a=e.map((i,o)=>n(o)).join(","),s=Ur(r);this.userCode=`
      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}},CXe=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;let n=Ka("rc",r),a=`${n[r-1]} + 1 < ${this.outputShape[r-1]}`,s=`${n[r-2]} + 1 < ${this.outputShape[r-2]}`,i=Ur(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${i} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${o(n.slice())};
          if(${a}){
            result.g = ${u(n.slice())};
          }
          if(${s}) {
            result.b = ${d(n.slice())};
            if(${a}) {
              result.a = ${c(n.slice())};
            }
          }
          setOutput(result);
        }
    `;function o(f){return h(f)}function u(f){return f[r-1]="("+f[r-1]+" + 1)",h(f)}function d(f){return f[r-2]="("+f[r-2]+" + 1)",h(f)}function c(f){return f[r-1]="("+f[r-1]+" + 1)",f[r-2]="("+f[r-2]+" + 1)",h(f)}function h(f){let g=e.map((y,v)=>p(v,f)),m=g.join(","),x=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${x}))`}function p(f,g){return t.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${g[f]} - 1`:`${g[f]}`}}};function IXe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{dims:s}=n,i=a.shape.length,o=R.parseAxisParam(s,a.shape);if(i===0)return Zs({inputs:{x:a},backend:r});let u=ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CXe(a.shape,o):new kXe(a.shape,o);return r.runWebGLProgram(u,[a],a.dtype)}var EXe={kernelName:Jp,backendName:"webgl",kernelFunc:IXe},TXe=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let r=e[1],n=e[2];this.outputShape=e;let a="";typeof t=="number"?a=`float outputValue = ${t.toFixed(2)};`:a=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${n} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}},jXe={kernelName:Yx,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:r})=>{let{image:n}=e,{radians:a,fillValue:s,center:i}=t,o=r,u=new TXe(n.shape,s),[d,c]=H.getImageCenter(i,n.shape[1],n.shape[2]),h=[[d,c,Math.sin(a),Math.cos(a)]];return o.runWebGLProgram(u,[n],n.dtype,h)}},AXe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,$Xe=gr({opSnippet:AXe}),RXe={kernelName:Zp,backendName:"webgl",kernelFunc:$Xe},DXe="return inversesqrt(x);",MXe=gr({opSnippet:DXe,cpuKernelImpl:qHe}),FXe={kernelName:ef,backendName:"webgl",kernelFunc:MXe},cO=class{constructor(e,t,r,n,a,s,i=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;let u=Ur(a.length),d=Ur(s.length),c="";r===1?c="i":r===2&&(c="i, j");let h=`getIndices(${c})`,p="";n===1?p="i":n===2&&(p="i, coords[1]");let f=`getUpdates(${p})`,g="";o&&(g="coords[0], coords[1]");let m=`getDefaultValue(${g})`,x=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}},OXe=class{constructor(e,t,r,n,a,s,i=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;let u=Ur(a.length),d=Ur(s.length),c="";r===1?c="i":r===2&&(c="i, j");let h=`getIndices(${c})`,p="";n===1?p="i":n===2&&(p="i, coords[1]");let f=`getUpdates(${p})`,g="";o&&(g="coords[0], coords[1]");let m=`getDefaultValue(${g})`,x=t>1?"strides[j]":"strides",y=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}};function PXe(e){let{inputs:t,backend:r,attrs:n}=e,{indices:a,updates:s}=t,{shape:i}=n,{sliceRank:o,numUpdates:u,sliceSize:d,strides:c,outputSize:h}=H.calculateShapes(s,a,i),p=[h/d,d];if(h===0)return r.makeTensorInfo(i,a.dtype);let f=Ye({inputs:{x:a},backend:r,attrs:{shape:[u,o]}}),g=Ye({inputs:{x:s},backend:r,attrs:{shape:[u,d]}}),m=r.makeTensorInfo([],"float32",new Float32Array([0])),x;ge().getBool("WEBGL_PACK")?x=new OXe(u,o,f.shape.length,g.shape.length,c,p):x=new cO(u,o,f.shape.length,g.shape.length,c,p);let y=r.runWebGLProgram(x,[g,f,m],g.dtype),v=Ye({inputs:{x:y},backend:r,attrs:{shape:i}});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(m),v}var LXe={kernelName:Ox,backendName:"webgl",kernelFunc:PXe},zXe=class{constructor(e,t,r,n){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];let a="while (left < right) {",s=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,i=ge().getNumber("WEBGL_VERSION")===2?a:s,o=n==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${o} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function BXe(e){let{inputs:t,backend:r,attrs:n}=e,{sortedSequence:a,values:s}=t,{side:i}=n,o=new zXe(a.shape[0],a.shape[1],s.shape[1],i),u=[[a.shape[1]]];return r.runWebGLProgram(o,[a,s],"int32",u)}var UXe={kernelName:Lx,backendName:"webgl",kernelFunc:BXe},WXe=class{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let n,a;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)a="resRC",n="resRC";else{let i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],u=[];for(let d=0;d<t.length;d++)u.push(`${i[d]}`),d<e&&o.push(`${i[d]}`);n=o.join(),a=u.join()}let s=Ur(r);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        float cVal = getC(${n});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}};function VXe(e){let{inputs:t,backend:r}=e,{condition:n,t:a,e:s}=t,i=new WXe(n.shape.length,a.shape,a.shape.length);return r.runWebGLProgram(i,[n,a,s],wi(a.dtype,s.dtype))}var HXe={kernelName:zx,backendName:"webgl",kernelFunc:VXe},qXe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${H.SELU_SCALEALPHA};
  float scale = ${H.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,GXe=gr({opSnippet:qXe}),KXe={kernelName:tf,backendName:"webgl",kernelFunc:GXe},QXe=gy+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,XXe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,YXe=gr({opSnippet:QXe,packedOpSnippet:XXe,cpuKernelImpl:KHe}),JXe={kernelName:sf,backendName:"webgl",kernelFunc:YXe},ZXe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,eYe=gr({opSnippet:ZXe}),tYe={kernelName:af,backendName:"webgl",kernelFunc:eYe},rYe=gy+`
  return sin(x);
`,nYe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${_f}
  return result;
`,aYe=gr({opSnippet:rYe,packedOpSnippet:nYe}),sYe={kernelName:rf,backendName:"webgl",kernelFunc:aYe},iYe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,oYe=gr({opSnippet:iYe}),lYe={kernelName:nf,backendName:"webgl",kernelFunc:oYe},uYe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,cYe=gr({opSnippet:uYe}),dYe={kernelName:of,backendName:"webgl",kernelFunc:cYe},hYe=e=>{let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockShape:s,paddings:i}=n;R.assert(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=s.reduce((y,v)=>y*v),u=[[0,0]];u.push(...i);for(let y=1+s.length;y<a.shape.length;++y)u.push([0,0]);let d=[],c=Uee({inputs:{x:a},backend:r,attrs:{paddings:u,constantValue:0}}),h=H.getReshaped(c.shape,s,o,!1),p=H.getPermuted(h.length,s.length,!1),f=H.getReshapedPermuted(c.shape,s,o,!1),g=Ye({inputs:{x:c},backend:r,attrs:{shape:h}}),m=es({inputs:{x:g},backend:r,attrs:{perm:p}}),x=Ye({inputs:{x:m},backend:r,attrs:{shape:f}});return d.push(c),d.push(g),d.push(m),d.forEach(y=>r.disposeIntermediateTensorInfo(y)),x},pYe={kernelName:Ux,backendName:"webgl",kernelFunc:hYe};function fYe(e){let{inputs:t,backend:r}=e,{indices:n,values:a,denseShape:s,defaultValue:i}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(n.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${n.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let o=r.readSync(n.dataId),u=r.readSync(a.dataId),d=r.readSync(s.dataId),c=r.readSync(i.dataId)[0],[h,p,f,g,m]=XHe(o,n.shape,n.dtype,u,a.dtype,d,c);return[r.makeTensorInfo(p,n.dtype,h),r.makeTensorInfo([p[0]],a.dtype,f),r.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(x=>Number(x)))),r.makeTensorInfo([m.length],n.dtype,new Int32Array(m))]}var mYe={kernelName:N0,backendName:"webgl",kernelFunc:fYe};function gYe(e){let{inputs:t,backend:r}=e,{inputIndices:n,inputShape:a,newShape:s}=t;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${n.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(r.readSync(a.dataId)),o=r.readSync(n.dataId),u=Array.from(r.readSync(s.dataId)),[d,c,h]=YHe(o,n.shape,n.dtype,i,u);return[r.makeTensorInfo(c,n.dtype,d),r.makeTensorInfo([h.length],s.dtype,new Int32Array(h))]}var xYe={kernelName:Vx,backendName:"webgl",kernelFunc:gYe};function yYe(e){let{inputs:t,backend:r}=e,{data:n,indices:a,segmentIds:s}=t;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);let i=r.readSync(n.dataId),o=r.readSync(a.dataId),u=r.readSync(s.dataId),[d,c]=dee(i,n.shape,n.dtype,o,u,!0);return r.makeTensorInfo(c,n.dtype,d)}var vYe={kernelName:S0,backendName:"webgl",kernelFunc:yYe};function bYe(e){let{inputs:t,backend:r}=e,{data:n,indices:a,segmentIds:s}=t;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);let i=r.readSync(n.dataId),o=r.readSync(a.dataId),u=r.readSync(s.dataId),[d,c]=dee(i,n.shape,n.dtype,o,u);return r.makeTensorInfo(c,n.dtype,d)}var wYe={kernelName:_0,backendName:"webgl",kernelFunc:bYe};function NYe(e){let{inputs:t,backend:r,attrs:n}=e,{sparseIndices:a,sparseValues:s,defaultValue:i}=t,{outputShape:o}=n,{sliceRank:u,numUpdates:d,sliceSize:c,strides:h,outputSize:p}=H.calculateShapes(s,a,o),f=!1;if(s.dtype==="string"){let y=r.bufferSync(a),v=r.bufferSync(s),b=R.decodeString(r.readSync(i.dataId)[0]),N=GHe(y,v,o,p,c,d,u,h,b,f);return r.makeTensorInfo(o,N.dtype,N.values)}let g=new cO(d,u,a.shape.length,s.shape.length,h,[p,1],f),m=r.runWebGLProgram(g,[s,a,i],s.dtype),x=Ye({inputs:{x:m},backend:r,attrs:{shape:o}});return r.disposeIntermediateTensorInfo(m),x}var SYe={kernelName:Hx,backendName:"webgl",kernelFunc:NYe};function _Ye(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{numOrSizeSplits:s,axis:i}=n,o=R.parseAxisParam(i,a.shape)[0],u=H.prepareSplitSize(a,s,o),d=a.shape.length,c=new Array(d).fill(0),h=a.shape.slice();return u.map(p=>{let f=[...h];f[o]=p;let g=xy({inputs:{x:a},backend:r,attrs:{begin:c,size:f}});return c[o]+=p,g})}var kYe={kernelName:Wx,backendName:"webgl",kernelFunc:_Ye},Tz="return sqrt(x);",CYe=gr({opSnippet:Tz,packedOpSnippet:Tz,cpuKernelImpl:JHe}),IYe={kernelName:lf,backendName:"webgl",kernelFunc:CYe},EYe="return x * x;",TYe=gr({opSnippet:EYe}),jYe={kernelName:k0,backendName:"webgl",kernelFunc:TYe},jz="return (a - b) * (a - b);",AYe=Ea({opSnippet:jz,packedOpSnippet:jz}),$Ye={kernelName:df,backendName:"webgl",kernelFunc:AYe};function RYe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");let s=r.readSync(a.dataId),i=H.fromUint8ToStringArray(s),o=ZHe(i,"string",n);return r.makeTensorInfo(a.shape,"string",o)}var DYe={kernelName:C0,backendName:"webgl",kernelFunc:RYe};function MYe({inputs:e,attrs:t,backend:r}){let{x:n}=e,a=Xi+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,s=new rl(n.shape,a);return r.runWebGLProgram(s,[n],n.dtype)}var FYe={kernelName:ed,backendName:"webgl",kernelFunc:MYe},OYe=class{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;let n=r.length,a=Ur(r.length),s=Ur(r.length),i="";if(n===1)i="coords * strides + begin";else{let o=0;i=r.map((u,d)=>(o++,r.length===1?`coords * strides[${d}] + begin[${d}]`:`coords[${o-1}] * strides[${d}] + begin[${d}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}};function PYe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{begin:s,end:i,strides:o,beginMask:u,endMask:d,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:p}=n,{finalShapeSparse:f,finalShape:g,isIdentity:m,sliceDim0:x,isSimpleSlice:y,begin:v,end:b,strides:N}=Yn.sliceInfo(a.shape,s,i,o,u,d,c,h,p),S;if(m)S=Ye({inputs:{x:a},backend:r,attrs:{shape:g}});else if(x||y){R.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let C=Yn.computeOutShape(v,b,N),k=xy({inputs:{x:a},backend:r,attrs:{begin:v,size:C}});S=Ye({inputs:{x:k},backend:r,attrs:{shape:g}}),r.disposeIntermediateTensorInfo(k)}else if(r.shouldExecuteOnCPU([a])){let C=r.readSync(a.dataId),k=Qt(a.shape,a.dtype,C),I=eqe(f,k,N,v);S=r.makeTensorInfo(g,a.dtype,I.values)}else{let C=new OYe(v,N,f);S=r.runWebGLProgram(C,[a],a.dtype)}let _=Ye({inputs:{x:S},backend:r,attrs:{shape:g}});return r.disposeIntermediateTensorInfo(S),_}var LYe={kernelName:qx,backendName:"webgl",kernelFunc:PYe};function zYe(e){let{inputs:t,backend:r,attrs:n}=e,{separator:a,nGramWidths:s,leftPad:i,rightPad:o,padWidth:u,preserveShortSequences:d}=n,{data:c,dataSplits:h}=t,p=r.readSync(c.dataId),f=r.readSync(h.dataId),[g,m]=tqe(p,f,a,s,i,o,u,d);return[r.makeTensorInfo([g.length],"string",g),r.makeTensorInfo(h.shape,"int32",m)]}var BYe={kernelName:I0,backendName:"webgl",kernelFunc:zYe};function UYe(e){let{inputs:t,backend:r,attrs:n}=e,{skipEmpty:a}=n,{input:s,delimiter:i}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let o=r.readSync(s.dataId),u=r.readSync(i.dataId)[0],[d,c,h]=rqe(o,u,a),p=c.length;return[r.makeTensorInfo([p,2],"int32",d),r.makeTensorInfo([p],"string",c),r.makeTensorInfo([2],"int32",new Int32Array(h))]}var WYe={kernelName:E0,backendName:"webgl",kernelFunc:UYe};function VYe(e){let{inputs:t,backend:r,attrs:n}=e,{numBuckets:a}=n,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let i=r.readSync(s.dataId),o=nqe(i,a);return r.makeTensorInfo(s.shape,"int32",o)}var HYe={kernelName:T0,backendName:"webgl",kernelFunc:VYe},qYe="return tan(x);",GYe=gr({opSnippet:qYe}),KYe={kernelName:pf,backendName:"webgl",kernelFunc:GYe},QYe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,XYe=gr({opSnippet:QYe}),YYe={kernelName:ff,backendName:"webgl",kernelFunc:XYe};function JYe(e){let{inputs:t,backend:r,attrs:n}=e,{tensor:a,indices:s,updates:i}=t,{sliceRank:o,numUpdates:u,sliceSize:d,strides:c,outputSize:h}=H.calculateShapes(i,s,a.shape),p=[h/d,d];if(h===0)return r.makeTensorInfo(a.shape,s.dtype);let f=Ye({inputs:{x:s},backend:r,attrs:{shape:[u,o]}}),g=Ye({inputs:{x:i},backend:r,attrs:{shape:[u,d]}}),m=Ye({inputs:{x:a},backend:r,attrs:{shape:p}}),x=new cO(u,o,f.shape.length,g.shape.length,c,p,!1,!0),y=r.runWebGLProgram(x,[g,f,m],m.dtype),v=Ye({inputs:{x:y},backend:r,attrs:{shape:a.shape}});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(y),v}var ZYe={kernelName:Px,backendName:"webgl",kernelFunc:JYe},eJe=class{constructor(e,t){this.variableNames=["A"];let r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[s]*t[s];this.outputShape=r,this.rank=r.length;let n=Ur(this.rank),a=tJe(e);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}};function tJe(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;let r=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],n=[];for(let a=0;a<e.length;a++)n.push(`imod(${r[a]}, ${e[a]})`);return n.join()}function Vee(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{reps:s}=n;if(a.dtype==="string"||a.shape.length>5){let o=r.readSync(a.dataId),u=a.dtype==="string"?o.map(h=>R.decodeString(h)):o,d=Qt(a.shape,a.dtype,u),c=sqe(d,s);return r.makeTensorInfo(c.shape,c.dtype,c.values)}let i=new eJe(a.shape,s);return r.runWebGLProgram(i,[a],a.dtype)}var rJe={kernelName:Zc,backendName:"webgl",kernelFunc:Vee},nJe=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},aJe=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function yd(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function Az(e){let t=1;for(;t<e;)t*=2;return t}function sJe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{k:s,sorted:i}=n,o=ge().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=ge().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),d=a.shape,c=d[d.length-1];if(r.shouldExecuteOnCPU([a])||c<o||s>u){let I=r.readSync(a.dataId),[T,j]=iqe(I,d,a.dtype,s,i);return[r.makeTensorInfo(T.shape,T.dtype,T.values),r.makeTensorInfo(j.shape,j.dtype,j.values)]}if(s===0)return d[d.length-1]=0,[r.makeTensorInfo(d,a.dtype,[]),r.makeTensorInfo(d,"int32",[])];if(c===1)return[a,cw({attrs:{shape:d,dtype:"int32",value:0},backend:r})];let h=r.texData.get(a.dataId),p=h!==null&&h.isPacked,f=p?r.unpackTensor(a):a,g=R.sizeFromShape(d)/c,m=Ye({inputs:{x:f},attrs:{shape:[g,c]},backend:r});p&&yd(r,f);let x=Az(s),y=Az(c),v=null,b=()=>v===null?[m,m]:[m,v],N=(I,T,j)=>{let E=b(),O=new nJe(j),M=[[c],[v===null?1:0],[Number.NEGATIVE_INFINITY],[I],[T]],W=v;v=r.runWebGLProgram(O,E,"int32",M),yd(r,W)};for(let I=1;I<x;I*=2){let T=I*2;for(let j=I;j>=1;j/=2)N(T,j,[g,y])}for(let I=y;I>x;I/=2){let T=b(),j=new aJe([g,I/2]),E=[[c],[v===null?1:0],[x]],O=v;v=r.runWebGLProgram(j,T,"int32",E),yd(r,O);let M=x/2,W=M*2;for(let q=M;q>=1;q/=2)N(W,q,v.shape)}let S=v;v=xy({inputs:{x:v},backend:r,attrs:{begin:0,size:[g,s]}}),yd(r,S);let _=Fee({inputs:{x:m,indices:v},backend:r,attrs:{axis:1,batchDims:1}});yd(r,m);let C=d.slice(0,-1);C.push(s),S=v,v=Ye({inputs:{x:v},attrs:{shape:C},backend:r}),yd(r,S);let k=_;return _=Ye({inputs:{x:_},attrs:{shape:C},backend:r}),yd(r,k),[_,v]}var iJe={kernelName:Gx,backendName:"webgl",kernelFunc:sJe},oJe=class{constructor(e,t,r,n,a,s){this.variableNames=["Image","Transforms"],this.outputShape=s;let i=r==="nearest"?1:2,o;switch(n){case"constant":o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4;break;default:o=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${o} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${i} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function lJe(e){let{inputs:t,backend:r,attrs:n}=e,{image:a,transforms:s}=t,{interpolation:i,fillMode:o,fillValue:u,outputShape:d}=n,[c,h,p,f]=a.shape,[g,m]=d??[h,p],x=[c,g,m,f],y=new oJe(h,p,i,o,u,x);return r.runWebGLProgram(y,[a,s],"float32")}var uJe={kernelName:Kx,backendName:"webgl",kernelFunc:lJe};function cJe(e){let{inputs:t,attrs:r,backend:n}=e,{axis:a}=r,{x:s}=t;cy(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let i=n.readSync(s.dataId),{outputValues:o,outputShape:u,indices:d}=oqe(i,a,s.shape,s.dtype);return[n.makeTensorInfo(u,s.dtype,o),n.makeTensorInfo([d.length],"int32",d)]}var dJe={kernelName:j0,backendName:"webgl",kernelFunc:cJe};function hJe(e){let{inputs:t,backend:r,attrs:n}=e,{value:a}=t,{axis:s}=n;s<0&&(s+=a.shape.length);let i=a,o=i.shape.length,u=a.shape[s],d=new Array(o-1),c=0;for(let m=0;m<o;m++)m!==s&&(d[c++]=i.shape[m]);let h=[],p=new Array(o).fill(0),f=i.shape.slice();f[s]=1;let g=new Array(u);for(let m=0;m<g.length;m++){p[s]=m;let x=xy({inputs:{x:i},backend:r,attrs:{begin:p,size:f}}),y=Ye({inputs:{x},backend:r,attrs:{shape:d}});g[m]=y,h.push(x)}return h.forEach(m=>r.disposeIntermediateTensorInfo(m)),g}var pJe={kernelName:Qx,backendName:"webgl",kernelFunc:hJe},fJe=class{constructor(e,t){this.variableNames=["x","segmentIds"];let r=e.windowSize,n=e.batchSize,a=e.inSize,s=e.numSegments,i=s*Math.ceil(a/r);this.outputShape=[n,i];let o="0.0",u="sumValue",d=Math.floor(r/4)*4,c=r%4,h=`
        sumValue += dot(values, segFilter);
    `,p="";a%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let f="";a%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${o};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${s})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${s})));

        float sumValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${d};
        if (${c===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}};function mJe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,segmentIds:s}=t,{numSegments:i}=n,o=a.shape.length,u=[],d=0,c=H.getAxesPermutation([d],o),h=a;c!=null&&(h=es({inputs:{x:a},backend:r,attrs:{perm:c}}),u.push(h),d=H.getInnerMostAxes(1,o)[0]);let p=H.segment_util.computeOutShape(h.shape,d,i),f=R.sizeFromShape([h.shape[d]]),g=Ye({inputs:{x:h},backend:r,attrs:{shape:[-1,f]}});u.push(g);let m=Ck(a.dtype),x=(N,S,_,C,k)=>{let I=N.shape[0],T=N.shape[1],j=H.segment_util.segOpComputeOptimalWindowSize(T,k),E={windowSize:j,inSize:T,batchSize:I,numSegments:k},O=new fJe(E,S),M=r.compileAndRun(O,[N,_],C);if(u.push(M),M.shape[1]===k)return M;let W=Wee({backend:r,attrs:{start:0,stop:k,step:1,dtype:"float32"}}),q=Vee({inputs:{x:W},backend:r,attrs:{reps:[T/j]}});return u.push(W),u.push(q),x(M,S,q,C,k)},y=x(g,"unsortedSegmentSum",s,m,i),v=Ye({inputs:{x:y},backend:r,attrs:{shape:p}}),b=v;if(c!=null){u.push(v);let N=H.getUndoAxesPermutation(c);b=es({inputs:{x:b},backend:r,attrs:{perm:N}})}return u.forEach(N=>r.disposeIntermediateTensorInfo(N)),b}var gJe={kernelName:A0,backendName:"webgl",kernelFunc:mJe},xJe=[eGe,rGe,sGe,lGe,cGe,pGe,mGe,xGe,wGe,SGe,CGe,TGe,$Ge,FGe,LGe,BGe,WGe,GGe,QGe,YGe,t8e,l8e,c8e,f8e,g8e,N8e,_8e,E8e,Oqe,A8e,F8e,z8e,q8e,Q8e,Y8e,Z8e,t9e,s9e,l9e,d9e,p9e,m9e,x9e,b9e,N9e,C9e,E9e,A9e,D9e,F9e,z9e,V9e,K9e,Y9e,e7e,t7e,n7e,s7e,o7e,u7e,d7e,m7e,y7e,w7e,S7e,C7e,T7e,R7e,O7e,Fqe,L7e,D8e,U7e,H7e,K7e,Lqe,J7e,rKe,aKe,lKe,dKe,mKe,yKe,NKe,CKe,TKe,AKe,MKe,OKe,LKe,WKe,HKe,GKe,QKe,YKe,tQe,sQe,uQe,xQe,Uqe,wQe,_Qe,IQe,jQe,y8e,RQe,MQe,OQe,zQe,VQe,Bqe,qQe,KQe,XQe,JQe,ZQe,v8e,pQe,rXe,iXe,cXe,Vqe,fXe,xXe,wXe,_Xe,EXe,jXe,RXe,FXe,LXe,UXe,HXe,KXe,JXe,tYe,sYe,lYe,i8e,mQe,dYe,pYe,mYe,xYe,vYe,wYe,SYe,kYe,IYe,jYe,$Ye,DYe,FYe,LYe,BYe,WYe,HYe,fQe,Yqe,KYe,YYe,ZYe,rJe,iJe,uJe,Jqe,dJe,pJe,gJe,DQe];for(let e of xJe)$0(e);var br;(function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"})(br||(br={}));var Sb;(function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"})(Sb||(Sb={}));var Hee;function yJe(e){Hee=e.wasm.cwrap(wh,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function vJe(e){let{inputs:t,backend:r,attrs:n}=e,{a,b:s,bias:i,preluActivationWeights:o}=t;if(a.dtype!=="float32"||s.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:u,transposeB:d,activation:c,leakyreluAlpha:h}=n,p=r.dataIdMap.get(a.dataId).id,f=r.dataIdMap.get(s.dataId).id,g=0;if(i!=null){let k=r.dataIdMap.get(i.dataId);if(k.shape.length!==1)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${k.shape.length}.`);g=k.id}let m=o==null?0:r.dataIdMap.get(o.dataId).id,x=Sb[c];if(x==null)throw new Error(`${c} activation not yet supported for FusedConv2D in the wasm backend.`);let y=u?a.shape[2]:a.shape[1],v=d?s.shape[1]:s.shape[2],b=Jx.assertAndGetBroadcastShape(a.shape.slice(0,-2),s.shape.slice(0,-2)),N=r.makeOutput([...b,y,v],a.dtype),S=r.dataIdMap.get(N.dataId).id,_=new Uint8Array(new Int32Array(a.shape).buffer),C=new Uint8Array(new Int32Array(s.shape).buffer);return Hee(p,_,a.shape.length,f,C,s.shape.length,u,d,x,g,m,h||0,S),N}var bJe={kernelName:wh,backendName:"wasm",setupFunc:yJe,kernelFunc:vJe};function fr(e,t){let r;function n(s){r=s.wasm.cwrap(e,null,["number","number","number"])}function a(s){let{backend:i,inputs:{x:o}}=s,u=i.dataIdMap.get(o.dataId).id,d=i.makeOutput(o.shape,t||o.dtype),c=i.dataIdMap.get(d.dataId).id;return R.sizeFromShape(d.shape)===0||r(u,br[o.dtype],c),d}return{kernelName:e,backendName:"wasm",setupFunc:n,kernelFunc:a}}var wJe=fr(Xg),NJe=fr(Xh),SJe=fr(Yh);function qn(e,t,r){let n;function a(i){n=i.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])}function s(i){let{backend:o,inputs:u}=i,{a:d,b:c}=u,h=o.dataIdMap.get(d.dataId).id,p=o.dataIdMap.get(c.dataId).id,f=r??d.dtype,g=H.assertAndGetBroadcastShape(d.shape,c.shape),m=o.makeOutput(g,f);if(R.sizeFromShape(g)===0)return m;let x=new Uint8Array(new Int32Array(d.shape).buffer),y=new Uint8Array(new Int32Array(c.shape).buffer),v=o.dataIdMap.get(m.dataId).id;return n(h,x,d.shape.length,p,y,c.shape.length,br[d.dtype],v),m}return{kernelName:e,backendName:"wasm",setupFunc:a,kernelFunc:s}}var _Je=qn(Yc),qee;function kJe(e){qee=e.wasm.cwrap(Jh,null,["array","number","number","number"])}function CJe(e){let{inputs:t,backend:r}=e,n=r.makeOutput(t[0].shape,t[0].dtype);if(R.sizeFromShape(n.shape)===0)return n;let a=t.map(o=>r.dataIdMap.get(o.dataId).id),s=new Uint8Array(new Int32Array(a).buffer),i=r.dataIdMap.get(n.dataId).id;return qee(s,a.length,br[n.dtype],i),n}var IJe={kernelName:Jh,backendName:"wasm",setupFunc:kJe,kernelFunc:CJe};function MC(e){let{inputs:{x:t},backend:r}=e;if(t.dtype==="string")return Qa(r.readSync(t.dataId),t.shape,t.dtype);let n=r.makeOutput(t.shape,t.dtype),a=r.typedArrayFromHeap(t);return r.typedArrayFromHeap(n).set(a),n}var EJe={kernelName:kp,backendName:"wasm",kernelFunc:MC},Gee;function TJe(e){Gee=e.wasm.cwrap(Gl,null,["number","array","number","number","number","array","number"])}function Lc(e){let{inputs:t,backend:r,attrs:n}=e,[a,s]=AJe(t.x.shape,n.perm),i=!0;for(let g=0;g<s.length;g++)s[g]!==g&&(i=!1);let o=jJe(t.x.shape,n.perm),u={dataId:t.x.dataId,shape:a,dtype:t.x.dtype};if(i){let g=MC({inputs:t,backend:r});return g.shape=o,g}let d=r.makeOutput(o,u.dtype),c=r.dataIdMap.get(u.dataId).id,h=r.dataIdMap.get(d.dataId).id,p=new Uint8Array(new Int32Array(s).buffer),f=new Uint8Array(new Int32Array(u.shape).buffer);return Gee(c,f,u.shape.length,br[u.dtype],h,p,s.length),d}function jJe(e,t){let r=new Array(e.length);for(let n=0;n<r.length;n++)r[n]=e[t[n]];return r}function AJe(e,t){let r=[],n=[];for(let a=0;a<e.length;++a)e[a]!==1&&r.push(e[a]),e[t[a]]!==1&&n.push(t[a]);for(let a=0;a<n.length;++a){let s=-1;for(let i=0;i<n.length;++i)n[i]>=a&&(s===-1||n[s]>n[i])&&(s=i);n[s]=a}return[r,n]}var $Je={kernelName:Gl,backendName:"wasm",kernelFunc:Lc,setupFunc:TJe};function ld(e,t,r){let n=e.shape,a=e.shape.length,s=R.parseAxisParam(t,n),i=s,o=H.getAxesPermutation(i,a),u=null,d=!1;if(o!=null){let c=new Array(a);for(let p=0;p<c.length;p++)c[p]=n[o[p]];i=H.getInnerMostAxes(i.length,a),u=Lc({inputs:{x:e},attrs:{perm:o},backend:r});let h=r.dataIdMap.get(e.dataId).id;r.dataIdMap.get(u.dataId).id!==h&&(d=!0)}return{transposed:u,originalAxes:s,axes:i,inputWasTransposed:d}}var Kee;function RJe(e){Kee=e.wasm.cwrap(Yg,null,["number, number, number"])}function DJe(e){let{backend:t,inputs:r,attrs:n}=e,{axis:a,keepDims:s}=n,{x:i}=r,o=t.dataIdMap.get(i.dataId).id,u=i,{transposed:d,axes:c,originalAxes:h,inputWasTransposed:p}=ld(i,a,t);if(p){let v=t.dataIdMap.get(d.dataId).id;u=d,o=v}let f=u.shape.length;H.assertAxesAreInnerMostDims("all",c,f);let[g,m]=H.computeOutAndReduceShapes(u.shape,c),x=R.sizeFromShape(m),y=t.makeOutput(g,i.dtype);if(R.sizeFromShape(u.shape)!==0){let v=t.dataIdMap.get(y.dataId).id;Kee(o,x,v)}if(p&&t.disposeData(d.dataId),s){let v=H.expandShapeToKeepDim(y.shape,h);y.shape=v}return y}var MJe={kernelName:Yg,backendName:"wasm",setupFunc:RJe,kernelFunc:DJe},Qee;function FJe(e){Qee=e.wasm.cwrap(Jg,null,["number, number, number"])}function OJe(e){let{backend:t,inputs:r,attrs:n}=e,{axis:a,keepDims:s}=n,{x:i}=r,o=t.dataIdMap.get(i.dataId).id,u=i,{transposed:d,axes:c,originalAxes:h,inputWasTransposed:p}=ld(i,a,t);if(p){let v=t.dataIdMap.get(d.dataId).id;u=d,o=v}let f=u.shape.length;H.assertAxesAreInnerMostDims("any",c,f);let[g,m]=H.computeOutAndReduceShapes(u.shape,c),x=R.sizeFromShape(m),y=t.makeOutput(g,i.dtype);if(R.sizeFromShape(u.shape)!==0){let v=t.dataIdMap.get(y.dataId).id;Qee(o,x,v)}if(p&&t.disposeData(d.dataId),s){let v=H.expandShapeToKeepDim(y.shape,h);y.shape=v}return y}var PJe={kernelName:Jg,backendName:"wasm",setupFunc:FJe,kernelFunc:OJe};function Xee(e){let t;function r(a){t=a.wasm.cwrap(e,null,["number","number","number","number","number"])}function n(a){let{backend:s,inputs:i,attrs:o}=a,{axis:u}=o,{x:d}=i,c=s.dataIdMap.get(d.dataId).id,h=c,p=d,{transposed:f,axes:g,inputWasTransposed:m}=ld(d,u,s);if(m){let S=s.dataIdMap.get(f.dataId).id;S!==c&&(p=f,h=S)}let x=p.shape.slice(0,-1),y=s.makeOutput(x,"int32"),v=s.dataIdMap.get(y.dataId).id,b=R.sizeFromShape(y.shape),N=p.shape[g[0]];return t(h,br[p.dtype],b,N,v),m&&s.disposeData(f.dataId),y}return{kernelName:e,backendName:"wasm",setupFunc:r,kernelFunc:n}}var LJe=Xee(Zg),zJe=Xee(ex),BJe=fr(Zh),UJe=fr(ep),WJe=fr(tp),VJe=qn(np),HJe=fr(rp),Yee;function qJe(e){Yee=e.wasm.cwrap(ap,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function GJe(e){let{inputs:t,attrs:r,backend:n}=e,a=t.x,s=n.dataIdMap.get(a.dataId).id,{filterSize:i,strides:o,pad:u,dimRoundingMode:d}=r,c=H.computePool2DInfo(a.shape,i,o,1,u,d),h=c.filterHeight,p=c.filterWidth,f=c.padInfo.top,g=c.padInfo.right,m=c.padInfo.bottom,x=c.padInfo.left,y=c.strideHeight,v=c.strideWidth,b=c.inChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);if(c.dilationWidth!==1||c.dilationHeight!==1)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${c.dilationHeight}, ${c.dilationWidth}].`);let N=n.makeOutput(c.outShape,"float32"),S=n.dataIdMap.get(N.dataId).id;return Yee(s,a.shape[0],a.shape[1],a.shape[2],h,p,f,g,m,x,y,v,b,S),N}var KJe={kernelName:ap,backendName:"wasm",setupFunc:qJe,kernelFunc:GJe},Jee;function QJe(e){Jee=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function XJe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:u,dataFormat:d}=n,c=H.computePool3DInfo(a.shape,s,i,1,o,u,d),h=r.makeOutput(c.outShape,a.dtype);return Jee(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(h.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),h}var YJe={kernelName:tx,backendName:"wasm",setupFunc:QJe,kernelFunc:XJe},Zee;function JJe(e){Zee=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function ZJe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:u,dimRoundingMode:d}=n,c=H.computePool3DInfo(s.shape,i,o,1,u,d),h=r.makeOutput(s.shape,s.dtype);return Zee(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(h.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left,c.filterDepth,c.filterHeight,c.filterWidth),h}var eZe={kernelName:h0,backendName:"wasm",setupFunc:JJe,kernelFunc:ZJe},ete;function tZe(e){ete=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function rZe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:u}=n,d=H.computePool2DInfo(s.shape,i,o,1,u),c=r.makeOutput(s.shape,s.dtype);return ete(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(c.dataId).id,d.batchSize,d.inChannels,d.inHeight,d.inWidth,d.outHeight,d.outWidth,d.strideHeight,d.strideWidth,d.dilationHeight,d.dilationWidth,d.effectiveFilterHeight,d.effectiveFilterWidth,d.padInfo.top,d.padInfo.left,d.filterHeight,d.filterWidth),c}var nZe={kernelName:d0,backendName:"wasm",setupFunc:tZe,kernelFunc:rZe};function xs(e){let{inputs:t,attrs:r}=e,{x:n}=t,{shape:a}=r,s=R.sizeFromShape(n.shape),i=R.inferFromImplicitShape(a,s);return R.assert(s===R.sizeFromShape(i),()=>`new shape: ${i}, old shape: ${n.shape}. New shape and old shape must have the same number of elements.`),e.backend.incRef(n.dataId),{dataId:n.dataId,shape:i,dtype:n.dtype}}var aZe={kernelName:Dx,backendName:"wasm",kernelFunc:xs},tte;function sZe(e){tte=e.wasm.cwrap(sp,null,["number","array","number","number","array","number","number","number","number"])}function iZe(e){let{inputs:t,backend:r,attrs:n}=e,{a,b:s}=t,{transposeA:i,transposeB:o}=n;if(a.dtype!=="float32"||s.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let u=a.shape.length,d=s.shape.length,c=i?a.shape[u-2]:a.shape[u-1],h=o?s.shape[d-1]:s.shape[d-2],p=i?a.shape[u-1]:a.shape[u-2],f=o?s.shape[d-2]:s.shape[d-1],g=a.shape.slice(0,-2),m=s.shape.slice(0,-2),x=R.sizeFromShape(g),y=R.sizeFromShape(m),v=Jx.assertAndGetBroadcastShape(a.shape.slice(0,-2),s.shape.slice(0,-2)).concat([p,f]);R.assert(c===h,()=>`Error in matMul: inner shapes (${c}) and (${h}) of Tensors with shapes ${a.shape} and ${s.shape} and transposeA=${i} and transposeB=${o} must match.`);let b=i?[x,c,p]:[x,p,c],N=o?[y,f,h]:[y,h,f],S=xs({inputs:{x:a},backend:r,attrs:{shape:b}}),_=xs({inputs:{x:s},backend:r,attrs:{shape:N}}),C=r.dataIdMap.get(S.dataId).id,k=r.dataIdMap.get(_.dataId).id,I=i?S.shape[2]:S.shape[1],T=o?_.shape[1]:_.shape[2],j=Math.max(x,y),E=r.makeOutput([j,I,T],S.dtype),O=r.dataIdMap.get(E.dataId).id,M=new Uint8Array(new Int32Array(S.shape).buffer),W=new Uint8Array(new Int32Array(_.shape).buffer);return tte(C,M,S.shape.length,k,W,_.shape.length,i,o,O),r.disposeData(S.dataId),r.disposeData(_.dataId),E.shape=v,E}var oZe={kernelName:sp,backendName:"wasm",setupFunc:sZe,kernelFunc:iZe};function Lh(e){let{inputs:{x:t},attrs:{begin:r,size:n},backend:a}=e,[s,i]=Yn.parseSliceParams(t,r,n),o=Yn.isSliceContinous(t.shape,s,i),u=a.readSync(t.dataId),d=a.makeOutput(i,t.dtype),c=R.computeStrides(t.shape),h=a.dataIdMap.get(d.dataId);if(o){let g=Yn.computeFlatOffset(s,c);return t.dtype==="string"?h.stringBytes=u.slice(g,g+R.sizeFromShape(i)):a.typedArrayFromHeap(d).set(u.subarray(g,g+R.sizeFromShape(i))),d}if(t.dtype==="string"){let g=SS(u,s,i,t.shape,t.dtype);return h.stringBytes=g,d}let p=a.typedArrayFromHeap(d),f=t.shape.length;if(f===2)lZe(u,c[0],p,s,i);else if(f===3)uZe(u,c[0],c[1],p,s,i);else if(f===4)cZe(u,c[0],c[1],c[2],p,s,i);else{let g=SS(u,s,i,t.shape,t.dtype);p.set(g)}return d}function lZe(e,t,r,n,a){let s=0,i=n[0],o=n[1],u=i+a[0];for(let d=i;d<u;d++){let c=d*t+o;r.set(e.subarray(c,c+a[1]),s),s+=a[1]}}function uZe(e,t,r,n,a,s){let i=0,o=a[0],u=a[1],d=a[2],c=o+s[0],h=u+s[1];for(let p=o;p<c;p++)for(let f=u;f<h;f++){let g=p*t+f*r+d;n.set(e.subarray(g,g+s[2]),i),i+=s[2]}}function cZe(e,t,r,n,a,s,i){let o=0,u=s[0],d=s[1],c=s[2],h=u+i[0],p=d+i[1],f=c+i[2],g=s[3];for(let m=u;m<h;m++)for(let x=d;x<p;x++)for(let y=c;y<f;y++){let v=m*t+x*r+y*n+g;a.set(e.subarray(v,v+i[3]),o),o+=i[3]}}var dZe={kernelName:Bx,backendName:"wasm",kernelFunc:Lh};function hZe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockShape:s,crops:i}=n,o=s.reduce((y,v)=>y*v),u=H.getReshaped(a.shape,s,o),d=H.getPermuted(u.length,s.length),c=H.getReshapedPermuted(a.shape,s,o),h=H.getSliceBeginCoords(i,s.length),p=H.getSliceSize(c,i,s.length),f=xs({inputs:{x:a},backend:r,attrs:{shape:u}}),g=Lc({inputs:{x:f},backend:r,attrs:{perm:d}}),m=xs({inputs:{x:g},backend:r,attrs:{shape:c}}),x=Lh({inputs:{x:m},backend:r,attrs:{begin:h,size:p}});return r.disposeData(f.dataId),r.disposeData(g.dataId),r.disposeData(m.dataId),x}var pZe={kernelName:rx,backendName:"wasm",kernelFunc:hZe},rte;function fZe(e){rte=e.wasm.cwrap(nx,null,["number","number","boolean","number","number","number"])}function mZe(e){let{backend:t,inputs:r,attrs:n}=e,{x:a,weights:s}=r,{size:i}=n,o=s.shape.reduce((h,p)=>h*p,1)!==0,u=a.shape.length===1?[i]:[a.shape[0],i],d=t.makeOutput(u,s.dtype);function c(h){return t.dataIdMap.get(h.dataId).id}return rte(c(a),i,o,c(s),br[s.dtype],c(d)),d}var gZe={kernelName:nx,backendName:"wasm",setupFunc:fZe,kernelFunc:mZe},xZe=qn(ax);function yZe(e){let{inputs:t,backend:r}=e,{s0:n,s1:a}=t,s=r.typedArrayFromHeap(n),i=r.typedArrayFromHeap(a),o=H.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return r.makeOutput([o.length],"int32",void 0,new Int32Array(o))}var vZe={kernelName:p0,backendName:"wasm",kernelFunc:yZe};function ud(e){let{inputs:{x:t},attrs:{dtype:r},backend:n}=e,a=n.makeOutput(t.shape,r),s=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(a).set(s),a}var bZe={kernelName:ip,backendName:"wasm",kernelFunc:ud},wZe=fr(op),nte;function NZe(e){nte=e.wasm.cwrap(Jc,null,["number","number","number","number"])}function SZe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{clipValueMin:s,clipValueMax:i}=n,o=r.dataIdMap.get(a.dataId).id,u=r.makeOutput(a.shape,a.dtype),d=r.dataIdMap.get(u.dataId).id;return nte(o,s,i,d),u}var _Ze={kernelName:Jc,backendName:"wasm",setupFunc:NZe,kernelFunc:SZe};function ate(e){let{inputs:t,backend:r}=e,n=R.parseAxisParam(e.attrs.axis,t[0].shape)[0],a=t.map(f=>f.shape);H.assertParamsConsistent(a,n);let s=H.computeOutShape(t.map(f=>f.shape),n),i=t.filter(f=>R.sizeFromShape(f.shape)>0);if(i.length===1)return MC({inputs:{x:i[0]},backend:r});let o=r.makeOutput(s,t[0].dtype);if(R.sizeFromShape(s)===0)return o;if(i[0].dtype==="string"){let f=i.map(b=>{let N=[-1,R.sizeFromShape(b.shape.slice(n))];return xs({inputs:{x:b},backend:r,attrs:{shape:N}})}),g=f.map(b=>({vals:r.readSync(b.dataId),shape:b.shape}));s=H.computeOutShape(f.map(b=>b.shape),1);let m=f[0].shape[0]===1,x=FF(g,s,t[0].dtype,m),y=H.computeOutShape(i.map(b=>b.shape),n);o.shape=y;let v=r.dataIdMap.get(o.dataId);return v.stringBytes=H.fromStringArrayToUint8(x),f.forEach(b=>r.disposeData(b.dataId)),o}let u=R.sizeFromShape(i[0].shape.slice(0,n)),d=0,c=i.map(f=>{let g=R.sizeFromShape(f.shape.slice(n));return d+=g,g}),h=i.map(f=>r.typedArrayFromHeap(f)),p=r.typedArrayFromHeap(o);for(let f=0;f<u;f++){let g=f*d;for(let m=0;m<h.length;m++){let x=c[m],y=f*x,v=h[m].subarray(y,y+x);p.set(v,g),g+=x}}return o}var kZe={kernelName:sx,backendName:"wasm",kernelFunc:ate},ste;function CZe(e){ste=e.wasm.cwrap(lp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function IZe(e){let{inputs:t,attrs:r,backend:n}=e,{x:a,filter:s}=t,i=n.dataIdMap.get(a.dataId).id,o=n.dataIdMap.get(s.dataId).id,{strides:u,dilations:d,pad:c,dimRoundingMode:h,dataFormat:p}=r,f=H.convertConv2DDataFormat(p),g=H.computeConv2DInfo(a.shape,s.shape,u,d,c,h,!1,f),m=g.filterHeight,x=g.filterWidth,y=g.padInfo.top,v=g.padInfo.right,b=g.padInfo.bottom,N=g.padInfo.left,S=g.dilationHeight,_=g.dilationWidth,C=g.strideHeight,k=g.strideWidth,I=g.inChannels,T=g.outChannels,j=g.padInfo.type==="SAME"?1:0;if(g.dataFormat!=="channelsLast")throw new Error(`wasm backend Conv2D does not support dataFormat:'${g.dataFormat}'. Please use 'channelsLast'.`);let E=n.makeOutput(g.outShape,"float32"),O=n.dataIdMap.get(E.dataId).id;return ste(i,a.shape[0],a.shape[1],a.shape[2],o,m,x,y,v,b,N,j,S,_,C,k,I,T,O),E}var EZe={kernelName:lp,backendName:"wasm",setupFunc:CZe,kernelFunc:IZe},ite;function TZe(e){ite=e.wasm.cwrap(up,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function jZe(e){let{backend:t,inputs:r,attrs:n}=e,{dy:a,filter:s}=r,{strides:i,pad:o,dataFormat:u,dimRoundingMode:d,inputShape:c}=n,h=1,p=H.convertConv2DDataFormat(u),f=H.computeConv2DInfo(c,s.shape,i,h,o,d,!1,p),{batchSize:g,filterHeight:m,filterWidth:x,inChannels:y,inHeight:v,inWidth:b,outChannels:N,outHeight:S,outWidth:_,strideHeight:C,strideWidth:k}=f,I=m-1-f.padInfo.top,T=x-1-f.padInfo.left,j=f.dataFormat==="channelsLast",E=R.computeStrides(f.inShape),O=R.computeStrides(a.shape),[M,W,q]=R.computeStrides(s.shape),P=E[0],A=j?E[1]:E[2],L=j?E[2]:1,z=j?1:E[1],$=O[0],V=j?O[1]:O[2],B=j?O[2]:1,Y=j?1:O[1],re=t.makeOutput(f.inShape,"float32"),ae=t.dataIdMap.get(re.dataId).id,K=t.dataIdMap.get(a.dataId).id,J=t.dataIdMap.get(s.dataId).id;return ite(K,J,g,m,x,v,b,y,S,_,N,C,k,I,T,M,W,q,P,A,L,z,$,V,B,Y,ae),re}var AZe={kernelName:up,backendName:"wasm",setupFunc:TZe,kernelFunc:jZe},ote;function $Ze(e){ote=e.wasm.cwrap(cp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function RZe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:u}=n;if(a.dtype!=="float32")throw new Error(`Tensor x must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);let d=H.computeConv3DInfo(a.shape,s.shape,i,u,o),c=r.makeOutput(d.outShape,a.dtype);return ote(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(c.dataId).id,d.batchSize,d.inDepth,d.inHeight,d.inWidth,d.inChannels,d.outDepth,d.outHeight,d.outWidth,d.outChannels,d.strideDepth,d.strideHeight,d.strideWidth,d.dilationDepth,d.dilationHeight,d.dilationWidth,d.filterDepth,d.filterHeight,d.filterWidth,d.padInfo.front,d.padInfo.top,d.padInfo.left),c}var DZe={kernelName:cp,backendName:"wasm",setupFunc:$Ze,kernelFunc:RZe},lte;function MZe(e){lte=e.wasm.cwrap(ix,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function FZe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,dy:s}=t,{strides:i,pad:o,filterShape:u}=n;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);let d=H.computeConv3DInfo(a.shape,u,i,1,o),c=r.makeOutput(d.filterShape,s.dtype);return lte(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(c.dataId).id,d.batchSize,d.inDepth,d.inHeight,d.inWidth,d.inChannels,d.outDepth,d.outHeight,d.outWidth,d.outChannels,d.strideDepth,d.strideHeight,d.strideWidth,d.dilationDepth,d.dilationHeight,d.dilationWidth,d.filterDepth,d.filterHeight,d.filterWidth,d.padInfo.front,d.padInfo.top,d.padInfo.left),c}var OZe={kernelName:ix,backendName:"wasm",setupFunc:MZe,kernelFunc:FZe},ute;function PZe(e){ute=e.wasm.cwrap(ox,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function LZe(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,filter:s}=t,{pad:i,strides:o,inputShape:u}=n;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);let d=H.computeConv3DInfo(u,s.shape,o,1,i),c=r.makeOutput(d.inShape,a.dtype);return ute(r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(c.dataId).id,d.batchSize,d.inDepth,d.inHeight,d.inWidth,d.inChannels,d.outDepth,d.outHeight,d.outWidth,d.outChannels,d.strideDepth,d.strideHeight,d.strideWidth,d.dilationDepth,d.dilationHeight,d.dilationWidth,d.filterDepth,d.filterHeight,d.filterWidth,d.padInfo.front,d.padInfo.top,d.padInfo.left),c}var zZe={kernelName:ox,backendName:"wasm",setupFunc:PZe,kernelFunc:LZe},BZe=fr(dp),UZe=fr(hp),xj;(function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"})(xj||(xj={}));var cte;function WZe(e){cte=e.wasm.cwrap(ux,null,["number","number","number","number","array","number","number","number","number","number"])}function VZe(e){let{backend:t,inputs:r,attrs:n}=e,{method:a,extrapolationValue:s,cropSize:i}=n,{image:o,boxes:u,boxInd:d}=r,c=u.shape[0],[h,p]=i,f=[c,h,p,o.shape[3]],g=t.dataIdMap.get(o.dataId),m;o.dtype!=="float32"&&(m=ud({backend:t,inputs:{x:o},attrs:{dtype:"float32"}}),g=t.dataIdMap.get(m.dataId));let x=g.id,y=t.dataIdMap.get(u.dataId).id,v=t.dataIdMap.get(d.dataId).id,b=t.makeOutput(f,"float32"),N=t.dataIdMap.get(b.dataId).id,S=new Uint8Array(new Int32Array(o.shape).buffer);return cte(x,y,v,c,S,h,p,xj[a],s,N),m!=null&&t.disposeData(m.dataId),b}var HZe={kernelName:ux,backendName:"wasm",setupFunc:WZe,kernelFunc:VZe},dte;function qZe(e){dte=e.wasm.cwrap(lx,null,["number","number","number","number","number","number"])}function GZe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=n,u=a.shape.length;R.assert(a.dtype==="float32"||a.dtype==="int32",()=>`cumprod does not support ${a.dtype} tensors in the WASM backend`);let d=H.getAxesPermutation([s],u),c=a;d!==null&&(c=Lc({inputs:{x:a},attrs:{perm:d},backend:r}));let h=H.getInnerMostAxes(1,u)[0];H.assertAxesAreInnerMostDims("cumprod",[h],u);let p=r.makeOutput(c.shape,c.dtype),f=c.shape[h],g=r.dataIdMap.get(c.dataId).id,m=r.dataIdMap.get(p.dataId).id;dte(g,i?1:0,o?1:0,f,m,br[a.dtype]);let x=p;if(d!==null){let y=H.getUndoAxesPermutation(d);x=Lc({inputs:{x:p},attrs:{perm:y},backend:r}),r.disposeData(c.dataId),r.disposeData(p.dataId)}return x}var KZe={kernelName:lx,backendName:"wasm",setupFunc:qZe,kernelFunc:GZe},hte;function QZe(e){hte=e.wasm.cwrap(pp,null,["number","number","number","number","number","number"])}function XZe(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{axis:s,exclusive:i,reverse:o}=n,u=a.shape.length;R.assert(a.dtype==="float32"||a.dtype==="int32",()=>`cumsum does not support ${a.dtype} tensors in the WASM backend`);let d=H.getAxesPermutation([s],u),c=a;d!==null&&(c=Lc({inputs:{x:a},attrs:{perm:d},backend:r}));let h=H.getInnerMostAxes(1,u)[0];H.assertAxesAreInnerMostDims("cumsum",[h],u);let p=r.makeOutput(c.shape,c.dtype),f=c.shape[h],g=r.dataIdMap.get(c.dataId).id,m=r.dataIdMap.get(p.dataId).id;hte(g,i?1:0,o?1:0,f,m,br[a.dtype]);let x=p;if(d!==null){let y=H.getUndoAxesPermutation(d);x=Lc({inputs:{x:p},attrs:{perm:y},backend:r}),r.disposeData(c.dataId),r.disposeData(p.dataId)}return x}var YZe={kernelName:pp,backendName:"wasm",setupFunc:QZe,kernelFunc:XZe},pte;function JZe(e){pte=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])}function ZZe(e){let{backend:t,inputs:r,attrs:n}=e,{x:a,weights:s}=r,{size:i,binaryOutput:o}=n,u=s.shape.reduce((p,f)=>p*f,1)!==0,d=a.shape.length===1?[i]:[a.shape[0],i],c=t.makeOutput(d,s.dtype);function h(p){return t.dataIdMap.get(p.dataId).id}return pte(h(a),new Uint8Array(new Int32Array(a.shape).buffer),a.shape.length,i,u,h(s),br[s.dtype],o,h(c)),c}var eet={kernelName:m0,backendName:"wasm",setupFunc:JZe,kernelFunc:ZZe},fte;function tet(e){fte=e.wasm.cwrap(cx,null,["number","number","number","array","number","array","array","number","number"])}function ret(e){let{backend:t,inputs:r,attrs:n}=e,{x:a}=r,{blockSize:s,dataFormat:i}=n,o=a.shape[0],u=i==="NHWC"?a.shape[1]:a.shape[2],d=i==="NHWC"?a.shape[2]:a.shape[3],c=i==="NHWC"?a.shape[3]:a.shape[1],h=u*s,p=d*s,f=c/(s*s),g=i==="NHWC"?[o,h,p,f]:[o,f,h,p],m=t.makeOutput(g,"float32"),x=t.dataIdMap.get(a.dataId).id,y=new Uint8Array(new Int32Array(R.computeStrides(a.shape)).buffer),v=new Uint8Array(new Int32Array(g).buffer),b=new Uint8Array(new Int32Array(R.computeStrides(g)).buffer),N=t.dataIdMap.get(m.dataId).id;return fte(x,s,i==="NHWC"?1:0,y,a.shape.length-1,v,b,g.length,N),m}var net={kernelName:cx,backendName:"wasm",setupFunc:tet,kernelFunc:ret},mte;function aet(e){mte=e.wasm.cwrap(fp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function set(e){let{inputs:t,attrs:r,backend:n}=e,{x:a,filter:s}=t,i=n.dataIdMap.get(a.dataId).id,o=n.dataIdMap.get(s.dataId).id,{strides:u,dilations:d,pad:c,dimRoundingMode:h}=r,p=d??[1,1],f=H.computeConv2DInfo(a.shape,s.shape,u,p,c,h,!0),g=f.filterHeight,m=f.filterWidth,x=f.padInfo.top,y=f.padInfo.right,v=f.padInfo.bottom,b=f.padInfo.left,N=f.dilationHeight,S=f.dilationWidth,_=f.strideHeight,C=f.strideWidth,k=f.inChannels,I=f.outChannels,T=f.padInfo.type==="SAME"?1:0;if(f.dataFormat!=="channelsLast")throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);let j=n.makeOutput(f.outShape,"float32"),E=n.dataIdMap.get(j.dataId).id;return mte(i,a.shape[0],a.shape[1],a.shape[2],o,g,m,x,y,v,b,T,N,S,_,C,k,I,E),j}var iet={kernelName:fp,backendName:"wasm",setupFunc:aet,kernelFunc:set},gte;function oet(e){gte=e.wasm.cwrap("Diag",null,["number","number","number","number"])}function uet(e){let{inputs:t,backend:r}=e,{x:n}=t,a=R.sizeFromShape(n.shape),s=r.makeOutput([...n.shape,...n.shape],n.dtype);return gte(r.dataIdMap.get(n.dataId).id,br[n.dtype],a,r.dataIdMap.get(s.dataId).id),s}var cet={kernelName:g0,backendName:"wasm",setupFunc:oet,kernelFunc:uet},xte;function det(e){xte=e.wasm.cwrap(mp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function het(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s}=t,{strides:i,pad:o,dilations:u}=n;if(a.dtype!==s.dtype)throw new Error(`Dilation2D error: x must have the same dtype as filter. Got ${a.dtype} and ${s.dtype}`);let d=H.computeDilation2DInfo(a.shape,s.shape,i,o,"NHWC",u),c=r.makeOutput(d.outShape,a.dtype);return xte(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(c.dataId).id,br[a.dtype],d.batchSize,d.inChannels,d.inHeight,d.inWidth,d.outHeight,d.outWidth,d.strideHeight,d.strideWidth,d.dilationHeight,d.dilationWidth,d.filterHeight,d.filterWidth,d.padInfo.top,d.padInfo.left),c}var pet={kernelName:mp,backendName:"wasm",setupFunc:det,kernelFunc:het},yte;function fet(e){yte=e.wasm.cwrap(lg,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function met(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s,dy:i}=t,{strides:o,pad:u,dilations:d}=n;if(a.dtype!==s.dtype||a.dtype!==i.dtype)throw new Error(`Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${s.dtype}, and ${i.dtype}`);let c=H.computeDilation2DInfo(a.shape,s.shape,o,u,"NHWC",d),h=r.makeOutput(s.shape,s.dtype);return yte(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(i.dataId).id,r.dataIdMap.get(h.dataId).id,br[a.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),h}var get={kernelName:lg,backendName:"wasm",setupFunc:fet,kernelFunc:met},vte;function xet(e){vte=e.wasm.cwrap(og,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function yet(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,filter:s,dy:i}=t,{strides:o,pad:u,dilations:d}=n;if(a.dtype!==s.dtype||a.dtype!==i.dtype)throw new Error(`Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${s.dtype}, and ${i.dtype}`);let c=H.computeDilation2DInfo(a.shape,s.shape,o,u,"NHWC",d),h=r.makeOutput(a.shape,a.dtype);return vte(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(i.dataId).id,r.dataIdMap.get(h.dataId).id,br[a.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),h}var vet={kernelName:og,backendName:"wasm",setupFunc:xet,kernelFunc:yet},bet=fr(xp),bte;function wet(e){bte=e.wasm.cwrap(dx,null,["number","number","number"])}function Net(e){let{inputs:t,backend:r}=e,{dy:n,y:a}=t,s=r.makeOutput(a.shape,"float32"),i=o=>r.dataIdMap.get(o.dataId).id;return bte(i(a),i(n),i(s)),s}var _et={kernelName:dx,backendName:"wasm",setupFunc:wet,kernelFunc:Net},ket=!1,Cet=qn(hx,ket,"bool"),Iet=fr(yp),Eet=fr(vp,"float32");function yj(e){let{inputs:t,attrs:r,backend:n}=e,{input:a}=t,{dim:s}=r,i=a.shape.length,o=a.shape.slice(),u=s;return s<0&&(R.assert(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+s+1),o.splice(u,0,1),xs({inputs:{x:a},backend:n,attrs:{shape:o}})}var Tet={kernelName:px,backendName:"wasm",kernelFunc:yj},jet=fr(bp,"float32");function wte(e){let{attrs:{shape:t,value:r},backend:n}=e,{attrs:{dtype:a}}=e;a=a||R.inferDtype(r);let s=n.makeOutput(t,a);return n.typedArrayFromHeap(s).fill(r),s}var Aet={kernelName:x0,backendName:"wasm",kernelFunc:wte},Nte;function $et(e){Nte=e.wasm.cwrap(fx,null,["number","number","number","number","number","number"])}function Ret(e){let{inputs:t,backend:r}=e,{image:n}=t,a=r.makeOutput(n.shape,n.dtype),s=r.dataIdMap.get(n.dataId).id,i=r.dataIdMap.get(a.dataId).id,[o,u,d,c]=n.shape;return Nte(s,o,u,d,c,i),a}var Det={kernelName:fx,backendName:"wasm",kernelFunc:Ret,setupFunc:$et},Met=fr(wp),Fet=qn(Np),Ste;function Oet(e){Ste=e.wasm.cwrap(Sp,null,["number","number","number","number","number","number","number"])}function Pet(e){let{backend:t,inputs:r,attrs:n}=e,{varianceEpsilon:a}=n,{x:s,mean:i,variance:o,offset:u,scale:d}=r,c=t.dataIdMap.get(s.dataId).id,h=t.dataIdMap.get(i.dataId).id,p=t.dataIdMap.get(o.dataId).id,f=u!=null?t.dataIdMap.get(u.dataId).id:0,g=d!=null?t.dataIdMap.get(d.dataId).id:0,m=t.makeOutput(s.shape,s.dtype);if(R.sizeFromShape(s.shape)===0)return m;let x=t.dataIdMap.get(m.dataId).id;return Ste(c,h,p,f,g,a,x),m}var Let={kernelName:Sp,backendName:"wasm",setupFunc:Oet,kernelFunc:Pet},_te;function zet(e){_te=e.wasm.cwrap(Nh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Bet(e){let{inputs:t,attrs:r,backend:n}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:u,pad:d,dilations:c,dataFormat:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r,m=H.computeConv2DInfo(a.shape,s.shape,u,c,d,p),x=Sb[f];if(x==null)throw new Error(`${f} activation not yet supported for FusedConv2D in the wasm backend.`);let y=n.dataIdMap.get(a.dataId).id,v=n.dataIdMap.get(s.dataId).id,b=m.outChannels,N=0;if(i!=null){let B=n.dataIdMap.get(i.dataId);if(B.shape.length!==1)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${B.shape.length}.`);if(B.shape[0]!==b)throw new Error(`FusedConv2D bias shape (${B.shape}) does not match the number of output channels (${b})`);N=B.id}let S=m.filterHeight,_=m.filterWidth,C=m.padInfo.top,k=m.padInfo.right,I=m.padInfo.bottom,T=m.padInfo.left,j=m.dilationHeight,E=m.dilationWidth,O=m.strideHeight,M=m.strideWidth,W=m.inChannels,q=m.padInfo.type==="SAME"?1:0,P=m.batchSize,A=m.inHeight,L=m.inWidth;if(h!=="NHWC")throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${h}'. Please use 'NHWC'.`);let z=n.makeOutput(m.outShape,"float32"),$=n.dataIdMap.get(z.dataId).id,V=o==null?0:n.dataIdMap.get(o.dataId).id;return _te(y,P,A,L,v,S,_,N,C,k,I,T,q,j,E,O,M,W,b,x,V,g||0,$),z}var Uet={kernelName:Nh,backendName:"wasm",setupFunc:zet,kernelFunc:Bet},kte;function Wet(e){kte=e.wasm.cwrap(Sh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Vet(e){let{inputs:t,attrs:r,backend:n}=e,{x:a,filter:s,bias:i,preluActivationWeights:o}=t,{strides:u,pad:d,dilations:c,dataFormat:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r,m=H.computeConv2DInfo(a.shape,s.shape,u,c,d,p,!0),x=Sb[f];if(x==null)throw new Error(`${f} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);let y=n.dataIdMap.get(a.dataId).id,v=n.dataIdMap.get(s.dataId).id,b=m.outChannels,N=0;if(i!=null){let B=n.dataIdMap.get(i.dataId);if(B.shape.length!==1)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${B.shape.length}.`);if(B.shape[0]!==b)throw new Error(`FusedDepthwiseConv2D bias shape (${B.shape}) does not match the number of output channels (${b})`);N=B.id}let S=m.filterHeight,_=m.filterWidth,C=m.padInfo.top,k=m.padInfo.right,I=m.padInfo.bottom,T=m.padInfo.left,j=m.dilationHeight,E=m.dilationWidth,O=m.strideHeight,M=m.strideWidth,W=m.inChannels,q=m.padInfo.type==="SAME"?1:0,P=m.batchSize,A=m.inHeight,L=m.inWidth;if(h!=="NHWC")throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${h}'. Please use 'NHWC'.`);let z=n.makeOutput(m.outShape,"float32"),$=n.dataIdMap.get(z.dataId).id,V=o==null?0:n.dataIdMap.get(o.dataId).id;return kte(y,P,A,L,v,S,_,N,C,k,I,T,q,j,E,O,M,W,b,x,V,g||0,$),z}var Het={kernelName:Sh,backendName:"wasm",setupFunc:Wet,kernelFunc:Vet},Cte;function qet(e){Cte=e.wasm.cwrap(gx,null,["number","number","number","number","number","number","array","number"])}function Get(e){let{backend:t,inputs:r}=e,{params:n,indices:a}=r,[s,i,o,u]=KD.prepareAndValidate(n,a),d=t.makeOutput(s,n.dtype);if(i===0)return d;let c=a.shape,h=c[c.length-1],p=t.dataIdMap.get(n.dataId).id,f=t.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(u).buffer),m=t.dataIdMap.get(d.dataId).id;return Cte(p,br[n.dtype],f,i,h,o,g,m),d}var Ket={kernelName:gx,backendName:"wasm",setupFunc:qet,kernelFunc:Get},Ite;function Qet(e){Ite=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function Xet(e){let{backend:t,inputs:r,attrs:n}=e,{x:a,indices:s}=r,{axis:i,batchDims:o}=n,u=R.parseAxisParam(i,a.shape)[0],d=t.readSync(s.dataId),c=a.shape[u];for(let C=0;C<d.length;++C){let k=d[C];R.assert(k<=c-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${c-1}]`)}let h=H.segment_util.collectGatherOpShapeInfo(a,s,u,o),p=xs({inputs:{x:a},attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]},backend:t}),f=R.sizeFromShape(s.shape),g=xs({inputs:{x:s},attrs:{shape:[h.batchSize,f/h.batchSize]},backend:t}),m=[h.batchSize,h.outerSize,f/h.batchSize,h.sliceSize],x=t.makeOutput(m,a.dtype);if(R.sizeFromShape(a.shape)===0)return x;let y=p.shape.length-1,v=t.dataIdMap.get(p.dataId).id,b=t.dataIdMap.get(g.dataId).id,N=t.dataIdMap.get(x.dataId).id,S=new Uint8Array(new Int32Array(R.computeStrides(p.shape)).buffer),_=new Uint8Array(new Int32Array(R.computeStrides(m)).buffer);return Ite(v,br[a.dtype],S,y,b,h.batchSize,_,N),t.disposeData(p.dataId),t.disposeData(g.dataId),x.shape=h.outputShape,x}var Yet={kernelName:mx,backendName:"wasm",setupFunc:Qet,kernelFunc:Xet},Jet=!1,Zet=qn(xx,Jet,"bool"),ett=!1,ttt=qn(_p,ett,"bool"),rtt=fr(Cp,"bool"),ntt=fr(Ip,"bool"),att=fr(Ep,"bool"),Ete;function stt(e){Ete=e.wasm.cwrap(Tp,null,["number","number","number","number"])}function itt(e){let{inputs:{x:t},attrs:{alpha:r},backend:n}=e,a=n.dataIdMap.get(t.dataId).id,s=n.makeOutput(t.shape,"float32");if(R.sizeFromShape(t.shape)!==0){let i=n.dataIdMap.get(s.dataId).id;Ete(a,br[t.dtype],r,i)}return s}var ott={kernelName:Tp,backendName:"wasm",setupFunc:stt,kernelFunc:itt},ltt=!1,utt=qn(yx,ltt,"bool"),ctt=!1,dtt=qn(vx,ctt,"bool"),Tte;function htt(e){Tte=e.wasm.cwrap(bx,null,["number","number","number","number"])}function ptt(e){let{attrs:t,backend:r}=e,{start:n,stop:a,num:s}=t,i=Math.floor(s),o=r.makeOutput([i],"float32");return Tte(r.dataIdMap.get(o.dataId).id,n,a,i),o}var ftt={kernelName:bx,backendName:"wasm",setupFunc:htt,kernelFunc:ptt},mtt=fr(jp),gtt=fr(Ap),xtt=!1,ytt=qn(wx,xtt,"bool"),vtt=fr(Nx),btt=!1,wtt=qn(Sx,btt,"bool"),Ntt=!1,Stt=qn(E7,Ntt,"bool"),jte;function _tt(e){jte=e.wasm.cwrap($p,null,["number","number","number","number","number","number","number"])}function ktt(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{depthRadius:s,bias:i,alpha:o,beta:u}=n;if(a.dtype!=="float32")throw new Error("LRN error: x must have dtype float32");let d=r.makeOutput(a.shape,a.dtype);return jte(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(d.dataId).id,a.shape[3],s,i,o,u),d}var Ctt={kernelName:$p,backendName:"wasm",setupFunc:_tt,kernelFunc:ktt},Ate;function Itt(e){Ate=e.wasm.cwrap(_x,null,["number","number","number","number","number","number","number","number","number"])}function Ett(e){let{inputs:t,backend:r,attrs:n}=e,{x:a,y:s,dy:i}=t,{depthRadius:o,bias:u,alpha:d,beta:c}=n;if(a.dtype!=="float32"||s.dtype!=="float32"||i.dtype!=="float32")throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let h=r.makeOutput(a.shape,a.dtype);return Ate(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(i.dataId).id,r.dataIdMap.get(h.dataId).id,i.shape[3],o,u,d,c),h}var Ttt={kernelName:_x,backendName:"wasm",setupFunc:Itt,kernelFunc:Ett},$te;function jtt(e){$te=e.wasm.cwrap(Rp,null,["number","number","number","number"])}function Att(e){let{backend:t,inputs:r,attrs:n}=e,{reductionIndices:a,keepDims:s}=n,{x:i}=r,o=t.dataIdMap.get(i.dataId).id,u=i,{transposed:d,axes:c,originalAxes:h,inputWasTransposed:p}=ld(i,a,t);if(p){let v=t.dataIdMap.get(d.dataId).id;u=d,o=v}let f=u.shape.length;H.assertAxesAreInnerMostDims("max",c,f);let[g,m]=H.computeOutAndReduceShapes(u.shape,c),x=R.sizeFromShape(m),y=t.makeOutput(g,i.dtype);if(R.sizeFromShape(u.shape)!==0){let v=t.dataIdMap.get(y.dataId).id;$te(o,br[i.dtype],x,v)}if(p&&t.disposeData(d.dataId),s){let v=H.expandShapeToKeepDim(y.shape,h);y.shape=v}return y}var $tt={kernelName:Rp,backendName:"wasm",setupFunc:jtt,kernelFunc:Att},Rtt=qn(Dp),Rte;function Dtt(e){Rte=e.wasm.cwrap(Mp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Mtt(e){let{inputs:t,attrs:r,backend:n}=e,a=t.x,s=n.dataIdMap.get(a.dataId).id;R.assert(a.dtype==="float32",()=>`Error in MaxPool: only float32 input is supported. Got ${a.dtype}.`);let{filterSize:i,strides:o,pad:u,dimRoundingMode:d}=r,c=H.computePool2DInfo(a.shape,i,o,1,u,d),h=c.filterHeight,p=c.filterWidth,f=c.padInfo.top,g=c.padInfo.right,m=c.padInfo.bottom,x=c.padInfo.left,y=c.dilationHeight,v=c.dilationWidth,b=c.strideHeight,N=c.strideWidth,S=c.inChannels,_=c.outChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);let C=n.makeOutput(c.outShape,"float32"),k=n.dataIdMap.get(C.dataId).id;return Rte(s,a.shape[0],a.shape[1],a.shape[2],h,p,f,g,m,x,y,v,b,N,S,_,k),C}var Ftt={kernelName:Mp,backendName:"wasm",setupFunc:Dtt,kernelFunc:Mtt},Dte;function Ott(e){Dte=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Ptt(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,dimRoundingMode:u,dataFormat:d}=n,c=H.computePool3DInfo(a.shape,s,i,1,o,u,d),h=r.makeOutput(c.outShape,a.dtype);return Dte(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(h.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),h}var Ltt={kernelName:kx,backendName:"wasm",setupFunc:Ott,kernelFunc:Ptt},Mte;function ztt(e){Mte=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Btt(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:u,dimRoundingMode:d}=n,c=H.computePool3DInfo(s.shape,i,o,1,u,d),h=r.makeOutput(s.shape,s.dtype);return Mte(r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(h.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),h}var Utt={kernelName:v0,backendName:"wasm",setupFunc:ztt,kernelFunc:Btt},Fte;function Wtt(e){Fte=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Vtt(e){let{inputs:t,backend:r,attrs:n}=e,{dy:a,input:s}=t,{filterSize:i,strides:o,pad:u,dimRoundingMode:d}=n,c=H.computePool2DInfo(s.shape,i,o,1,u,d),h=r.makeOutput(s.shape,s.dtype);return Fte(r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(h.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),h}var Htt={kernelName:y0,backendName:"wasm",setupFunc:Wtt,kernelFunc:Vtt},Ote;function qtt(e){Ote=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Gtt(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:u}=n;R.assert(a.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.shape.length}.`);let d=[1,1];R.assert(H.eitherStridesOrDilationsAreOne(i,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);let c=H.computePool2DInfo(a.shape,s,i,[1,1],o),h=r.makeOutput(c.outShape,a.dtype),p=r.makeOutput(c.outShape,"int32");return Ote(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(h.dataId).id,r.dataIdMap.get(p.dataId).id,br[a.dtype],u,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),[h,p]}var Ktt={kernelName:b0,backendName:"wasm",setupFunc:qtt,kernelFunc:Gtt},Pte;function Qtt(e){Pte=e.wasm.cwrap(Fp,null,["number, number, number"])}function Xtt(e){let{backend:t,inputs:r,attrs:n}=e,{axis:a,keepDims:s}=n,{x:i}=r,o=t.dataIdMap.get(i.dataId).id,u=o,d=i,{transposed:c,axes:h,originalAxes:p,inputWasTransposed:f}=ld(i,a,t),g=h;if(f){let N=t.dataIdMap.get(c.dataId).id;N!==o&&(d=c,u=N,g=H.getInnerMostAxes(g.length,d.shape.length))}H.assertAxesAreInnerMostDims("mean",g,d.shape.length);let[m,x]=H.computeOutAndReduceShapes(d.shape,g),y=R.sizeFromShape(x),v=d;d.dtype!=="float32"&&(v=ud({backend:t,inputs:{x:d},attrs:{dtype:"float32"}}),u=t.dataIdMap.get(v.dataId).id);let b=t.makeOutput(m,"float32");if(R.sizeFromShape(d.shape)!==0){let N=t.dataIdMap.get(b.dataId).id;Pte(u,y,N)}if(f&&t.disposeData(c.dataId),s){let N=H.expandShapeToKeepDim(b.shape,p);b.shape=N}return d.dtype!=="float32"&&t.disposeData(v.dataId),b}var Ytt={kernelName:Fp,backendName:"wasm",setupFunc:Qtt,kernelFunc:Xtt},Lte;function Jtt(e){Lte=e.wasm.cwrap(Op,null,["number","number","number","number"])}function Ztt(e){let{backend:t,inputs:r,attrs:n}=e,{axis:a,keepDims:s}=n,{x:i}=r,o=t.dataIdMap.get(i.dataId).id,u=o,d=i,{transposed:c,axes:h,originalAxes:p,inputWasTransposed:f}=ld(i,a,t);if(f){let b=t.dataIdMap.get(c.dataId).id;b!==o&&(d=c,u=b)}let g=d.shape.length;H.assertAxesAreInnerMostDims("min",h,g);let[m,x]=H.computeOutAndReduceShapes(d.shape,h),y=R.sizeFromShape(x),v=t.makeOutput(m,d.dtype);if(R.sizeFromShape(d.shape)!==0){let b=t.dataIdMap.get(v.dataId).id;Lte(u,br[i.dtype],y,b)}if(f&&t.disposeData(c.dataId),s){let b=H.expandShapeToKeepDim(v.shape,p);v.shape=b}return v}var ert={kernelName:Op,backendName:"wasm",setupFunc:Jtt,kernelFunc:Ztt},trt=qn(Pp),vj;(function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"})(vj||(vj={}));var zte;function rrt(e){zte=e.wasm.cwrap(Lp,null,["number","array","number","number","array","array","number","number"])}function nrt(e){let{inputs:{x:t},backend:r,attrs:{paddings:n,mode:a}}=e,s=n.map((g,m)=>g[0]+t.shape[m]+g[1]),i=r.dataIdMap.get(t.dataId).id,o=r.makeOutput(s,t.dtype),u=r.dataIdMap.get(o.dataId).id,d=new Uint8Array(new Int32Array(t.shape).buffer),c=n.map(g=>g[0]),h=n.map(g=>g[1]),p=new Uint8Array(new Int32Array(c).buffer),f=new Uint8Array(new Int32Array(h).buffer);return zte(i,d,t.shape.length,br[t.dtype],p,f,vj[a],u),o}var art={kernelName:Lp,backendName:"wasm",kernelFunc:nrt,setupFunc:rrt},Bte;function srt(e){Bte=e.wasm.cwrap(cf,null,["number","number","number","number"])}function Ute(e){let{backend:t,inputs:{logits:r},attrs:{dim:n}}=e,a=t.dataIdMap.get(r.dataId).id,s=t.makeOutput(r.shape,r.dtype),i=t.dataIdMap.get(s.dataId).id,o=r.shape[n],u=R.sizeFromShape(r.shape)/o;return R.sizeFromShape(s.shape)===0||Bte(a,i,o,u),s}var irt={kernelName:cf,backendName:"wasm",setupFunc:srt,kernelFunc:Ute},Wte;function ort(e){Wte=e.wasm.cwrap(Cx,null,["number","number","number","number","number","number"])}function lrt(e){let{inputs:t,backend:r,attrs:n}=e,{logits:a}=t,{numSamples:s,seed:i,normalized:o}=n;if(a.dtype!=="float32")throw new Error(`Tensor logits must have dtype float32, got ${a.dtype}`);let u=o?a:Ute({inputs:{logits:a},backend:r,attrs:{dim:a.shape.length-1}}),[d,c]=u.shape,h=r.makeOutput([d,s],"int32");return Wte(r.dataIdMap.get(u.dataId).id,d,c,s,i,r.dataIdMap.get(h.dataId).id),o||r.disposeData(u.dataId),h}var urt={kernelName:Cx,backendName:"wasm",setupFunc:ort,kernelFunc:lrt},crt=qn(zp),drt=qn(Bp),hrt=fr(Ix);function dO(e,t){let r=new Int32Array(e.wasm.HEAPU8.buffer,t,4),n=r[0],a=r[1],s=r[2],i=r[3];return e.wasm._free(t),{pSelectedIndices:n,selectedSize:a,pSelectedScores:s,pValidOutputs:i}}var Vte;function prt(e){Vte=e.wasm.cwrap(Tx,"number",["number","number","number","number","number"])}function frt(e){let{backend:t,inputs:r,attrs:n}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:i}=n,{boxes:o,scores:u}=r,d=t.dataIdMap.get(o.dataId).id,c=t.dataIdMap.get(u.dataId).id,h=Vte(d,c,s,a,i),{pSelectedIndices:p,selectedSize:f,pSelectedScores:g,pValidOutputs:m}=dO(t,h);return t.wasm._free(g),t.wasm._free(m),t.makeOutput([f],"int32",p)}var mrt={kernelName:Tx,backendName:"wasm",setupFunc:prt,kernelFunc:frt},Hte;function grt(e){Hte=e.wasm.cwrap(jx,"number",["number","number","number","number","number","bool"])}function xrt(e){let{backend:t,inputs:r,attrs:n}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:i,padToMaxOutputSize:o}=n,{boxes:u,scores:d}=r,c=t.dataIdMap.get(u.dataId).id,h=t.dataIdMap.get(d.dataId).id,p=Hte(c,h,s,a,i,o),{pSelectedIndices:f,selectedSize:g,pSelectedScores:m,pValidOutputs:x}=dO(t,p);t.wasm._free(m);let y=t.makeOutput([g],"int32",f),v=t.makeOutput([],"int32",x);return[y,v]}var yrt={kernelName:jx,backendName:"wasm",setupFunc:grt,kernelFunc:xrt},qte;function vrt(e){qte=e.wasm.cwrap(Ax,"number",["number","number","number","number","number","number"])}function brt(e){let{backend:t,inputs:r,attrs:n}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:i,softNmsSigma:o}=n,{boxes:u,scores:d}=r,c=t.dataIdMap.get(u.dataId).id,h=t.dataIdMap.get(d.dataId).id,p=qte(c,h,s,a,i,o),{pSelectedIndices:f,selectedSize:g,pSelectedScores:m,pValidOutputs:x}=dO(t,p);t.wasm._free(x);let y=t.makeOutput([g],"int32",f),v=t.makeOutput([g],"float32",m);return[y,v]}var wrt={kernelName:Ax,backendName:"wasm",setupFunc:vrt,kernelFunc:brt},Nrt=!1,Srt=qn(Ex,Nrt,"bool"),Gte;function _rt(e){Gte=e.wasm.cwrap(Up,null,["number","number","number","number","number"])}function krt(e){let{inputs:t,backend:r,attrs:n}=e,{indices:a}=t,{dtype:s,depth:i,onValue:o,offValue:u}=n,d=r.makeOutput([...a.shape,i],s),c=r.dataIdMap.get(d.dataId).id,h=r.dataIdMap.get(a.dataId).id;return Gte(h,i,o,u,c),d}var Crt={kernelName:Up,backendName:"wasm",setupFunc:_rt,kernelFunc:krt};function Irt(e){let{inputs:{x:t},backend:r}=e,n=r.makeOutput(t.shape,t.dtype);return r.typedArrayFromHeap(n).fill(1),n}var Ert={kernelName:$x,backendName:"wasm",kernelFunc:Irt};function Trt(e){let{inputs:t,backend:r,attrs:n}=e,{axis:a}=n;if(t.length===1)return yj({inputs:{input:t[0]},backend:r,attrs:{dim:a}});let s=t[0].shape,i=t[0].dtype;t.forEach(c=>{R.assertShapesMatch(s,c.shape,"All tensors passed to stack must have matching shapes"),R.assert(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],u=t.map(c=>{let h=yj({inputs:{input:c},backend:r,attrs:{dim:a}});return o.push(h),h}),d=ate({inputs:u,backend:r,attrs:{axis:a}});return o.forEach(c=>r.disposeData(c.dataId)),d}var jrt={kernelName:Rx,backendName:"wasm",kernelFunc:Trt},Kte;function Art(e){Kte=e.wasm.cwrap(Wp,null,["number","array","number","number","array","array","number","number"])}function $rt(e){let{inputs:{x:t},backend:r,attrs:{paddings:n,constantValue:a}}=e,s=n.map((g,m)=>g[0]+t.shape[m]+g[1]);if(R.sizeFromShape(t.shape)===0)return wte({backend:r,attrs:{shape:s,value:a,dtype:t.dtype}});let i=r.dataIdMap.get(t.dataId).id,o=r.makeOutput(s,t.dtype),u=r.dataIdMap.get(o.dataId).id,d=new Uint8Array(new Int32Array(t.shape).buffer),c=n.map(g=>g[0]),h=n.map(g=>g[1]),p=new Uint8Array(new Int32Array(c).buffer),f=new Uint8Array(new Int32Array(h).buffer);return Kte(i,d,t.shape.length,br[t.dtype],p,f,a,u),o}var Qte={kernelName:Wp,backendName:"wasm",kernelFunc:$rt,setupFunc:Art},Rrt=qn(Vp),Xte;function Drt(e){Xte=e.wasm.cwrap(Hp,null,["number","number","number"])}function Mrt(e){let{inputs:t,backend:r}=e,{x:n,alpha:a}=t,s=r.dataIdMap.get(n.dataId).id,i=r.dataIdMap.get(a.dataId).id,o=s,u=n,d=u;u.dtype!=="float32"&&(d=ud({backend:r,inputs:{x:n},attrs:{dtype:"float32"}}),o=r.dataIdMap.get(d.dataId).id);let c=r.makeOutput(n.shape,"float32"),h=r.dataIdMap.get(c.dataId).id;return Xte(o,i,h),u.dtype!=="float32"&&r.disposeData(d.dataId),c}var Frt={kernelName:Hp,backendName:"wasm",setupFunc:Drt,kernelFunc:Mrt},Yte;function Ort(e){Yte=e.wasm.cwrap(qp,null,["number","number","number","number"])}function Prt(e){let{backend:t,inputs:r,attrs:n}=e,{axis:a,keepDims:s}=n,{x:i}=r,o=t.dataIdMap.get(i.dataId).id,u=o,d=i,{transposed:c,axes:h,originalAxes:p,inputWasTransposed:f}=ld(i,a,t),g=h;if(f){let b=t.dataIdMap.get(c.dataId).id;b!==o&&(d=c,u=b,g=H.getInnerMostAxes(g.length,d.shape.length))}H.assertAxesAreInnerMostDims("prod",g,d.shape.length);let[m,x]=H.computeOutAndReduceShapes(d.shape,g),y=R.sizeFromShape(x),v=t.makeOutput(m,d.dtype);if(R.sizeFromShape(d.shape)!==0){let b=t.dataIdMap.get(v.dataId).id;Yte(u,y,br[v.dtype],b)}if(f&&t.disposeData(c.dataId),s){let b=H.expandShapeToKeepDim(v.shape,p);v.shape=b}return v}var Lrt={kernelName:qp,backendName:"wasm",setupFunc:Ort,kernelFunc:Prt},zrt=e=>{let{backend:t,attrs:r}=e,{start:n,stop:a,step:s,dtype:i}=r,o=LF(n,a,s,i),u=t.makeOutput([o.length],i);return t.typedArrayFromHeap(u).set(o),u},Brt={kernelName:w0,backendName:"wasm",kernelFunc:zrt},Urt=qn(gp),Wrt=fr(Gp),Vrt=fr(Kp),Hrt=fr(Yp),Jte;function qrt(e){Jte=e.wasm.cwrap(Xp,null,["number","number","number","number","number","number","number","number","number","number"])}function Grt(e){let{backend:t,inputs:r,attrs:n}=e,{images:a}=r,{alignCorners:s,halfPixelCenters:i,size:o}=n,[u,d]=o,[c,h,p,f]=a.shape,g=[c,u,d,f],m=t.dataIdMap.get(a.dataId),x;m.dtype!=="float32"&&(x=ud({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),m=t.dataIdMap.get(x.dataId));let y=m.id,v=t.makeOutput(g,"float32");if(R.sizeFromShape(a.shape)===0)return v;let b=t.dataIdMap.get(v.dataId).id;return Jte(y,c,h,p,f,u,d,s?1:0,i?1:0,b),x!=null&&t.disposeData(x.dataId),v}var Krt={kernelName:Xp,backendName:"wasm",setupFunc:qrt,kernelFunc:Grt},Zte;function Qrt(e){Zte=e.wasm.cwrap(Fx,null,["number","number","number","array","array","boolean"])}function Xrt(e){let{inputs:t,backend:r,attrs:n}=e,{images:a,dy:s}=t,{alignCorners:i}=n,o=r.makeOutput(a.shape,"float32"),u=r.dataIdMap.get(a.dataId),d;return u.dtype!=="float32"&&(d=ud({backend:r,inputs:{x:a},attrs:{dtype:"float32"}}),u=r.dataIdMap.get(d.dataId)),Zte(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),i),d!=null&&r.disposeData(d.dataId),o}var Yrt={kernelName:Fx,backendName:"wasm",setupFunc:Qrt,kernelFunc:Xrt},ere;function Jrt(e){ere=e.wasm.cwrap(Qp,null,["number","number","number","number","number","number","number","number","number","number"])}function Zrt(e){let{backend:t,inputs:r,attrs:n}=e,{images:a}=r,{alignCorners:s,halfPixelCenters:i,size:o}=n,[u,d]=o,[c,h,p,f]=a.shape,g=[c,u,d,f],m=t.makeOutput(g,"float32");if(R.sizeFromShape(a.shape)===0)return m;let x=t.dataIdMap.get(a.dataId),y;x.dtype!=="float32"&&(y=ud({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),x=t.dataIdMap.get(y.dataId));let v=x.id,b=t.dataIdMap.get(m.dataId).id;return ere(v,c,h,p,f,u,d,s?1:0,i?1:0,b),y!=null&&t.disposeData(y.dataId),m}var ent={kernelName:Qp,backendName:"wasm",setupFunc:Jrt,kernelFunc:Zrt},tre;function tnt(e){tre=e.wasm.cwrap(Mx,null,["number","number","number","array","array","boolean"])}function rnt(e){let{inputs:t,backend:r,attrs:n}=e,{images:a,dy:s}=t,{alignCorners:i}=n,o=r.makeOutput(a.shape,"float32"),u=r.dataIdMap.get(a.dataId),d;return u.dtype!=="float32"&&(d=ud({backend:r,inputs:{x:a},attrs:{dtype:"float32"}}),u=r.dataIdMap.get(d.dataId)),tre(r.dataIdMap.get(a.dataId).id,r.dataIdMap.get(s.dataId).id,r.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),i),d!=null&&r.disposeData(d.dataId),o}var nnt={kernelName:Mx,backendName:"wasm",setupFunc:tnt,kernelFunc:rnt},rre;function ant(e){rre=e.wasm.cwrap(Jp,null,["number","array","number","array","number","number"])}function snt(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{dims:s}=n,i=R.parseAxisParam(s,a.shape);if(a.shape.length===0)return MC({inputs:{x:a},backend:r});let o=r.makeOutput(a.shape,a.dtype),u=r.dataIdMap.get(a.dataId).id,d=r.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(i).buffer),h=new Uint8Array(new Int32Array(a.shape).buffer);rre(u,c,i.length,h,a.shape.length,d);let p=xs({inputs:{x:o},attrs:{shape:a.shape},backend:r});return r.disposeData(o.dataId),p}var int={kernelName:Jp,backendName:"wasm",kernelFunc:snt,setupFunc:ant},nre;function ont(e){nre=e.wasm.cwrap(Yx,null,["number","number","number","number","number","number","number","number","array","number","number"])}function lnt(e){let{inputs:t,backend:r,attrs:n}=e,{image:a}=t,{radians:s,fillValue:i,center:o}=n,u=r.makeOutput(a.shape,a.dtype),d=r.dataIdMap.get(a.dataId).id,c=r.dataIdMap.get(u.dataId).id,[h,p,f,g]=a.shape,[m,x]=H.getImageCenter(o,p,f),y=i===0,v=255,b=typeof i=="number"?[i,i,i,y?0:v]:[...i,v],N=new Uint8Array(new Int32Array(b).buffer);return nre(d,h,p,f,g,s,m,x,N,b.length,c),u}var unt={kernelName:Yx,backendName:"wasm",kernelFunc:lnt,setupFunc:ont},cnt=fr(Zp),dnt=fr(ef),are;function hnt(e){are=e.wasm.cwrap(Ox,null,["number","number","number","number","number","number","array","number","number"])}function pnt(e){let{backend:t,inputs:r,attrs:n}=e,{indices:a,updates:s}=r,{shape:i}=n,o=t.makeOutput(i,s.dtype);if(R.sizeFromShape(i)===0)return o;let{sliceRank:u,numUpdates:d,sliceSize:c,strides:h,outputSize:p}=Yk.calculateShapes(s,a,i),f=t.dataIdMap.get(a.dataId).id,g=t.dataIdMap.get(s.dataId).id,m=new Uint8Array(new Int32Array(h).buffer),x=t.dataIdMap.get(o.dataId).id;return are(f,g,br[s.dtype],u,d,c,m,p,x),o}var fnt={kernelName:Ox,backendName:"wasm",setupFunc:hnt,kernelFunc:pnt},sre;function mnt(e){sre=e.wasm.cwrap(Lx,null,["number","number","number","number","number","number","bool","number"])}function gnt(e){let{inputs:t,backend:r,attrs:n}=e,{sortedSequence:a,values:s}=t,{side:i}=n;if(a.dtype!==s.dtype)throw new Error(`SearchSorted error: sorted_sequence must have the same dtype as values. Got ${a.dtype} and ${s.dtype}`);let o=r.makeOutput(s.shape,"int32");function u(d){return r.dataIdMap.get(d.dataId).id}return sre(u(a),u(s),a.shape[0],a.shape[1],s.shape[1],br[a.dtype],i==="left",u(o)),o}var xnt={kernelName:Lx,backendName:"wasm",setupFunc:mnt,kernelFunc:gnt},ire;function ynt(e){ire=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function vnt(e){let{inputs:t,backend:r}=e,{condition:n,t:a,e:s}=t,i=r.dataIdMap.get(n.dataId).id,o=r.dataIdMap.get(a.dataId).id,u=r.dataIdMap.get(s.dataId).id,d=r.makeOutput(a.shape,a.dtype),c=r.dataIdMap.get(d.dataId).id,h=n.shape.length,p=a.shape.length,f=h===0||h>1||p===1?1:R.sizeFromShape(a.shape.slice(1));return ire(i,o,u,f,c),d}var bnt={kernelName:zx,backendName:"wasm",kernelFunc:vnt,setupFunc:ynt},wnt=fr(tf),ore;function Nnt(e){ore=e.wasm.cwrap(sf,null,["number","number"])}function Snt(e){let{backend:t,inputs:{x:r}}=e,n=t.dataIdMap.get(r.dataId).id,a=t.makeOutput(r.shape,r.dtype),s=t.dataIdMap.get(a.dataId).id;return R.sizeFromShape(a.shape)===0||ore(n,s),a}var _nt={kernelName:"Sigmoid",backendName:"wasm",setupFunc:Nnt,kernelFunc:Snt},knt=fr(af),Cnt=fr(rf),Int=fr(nf),Ent=fr(of);function Tnt(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,{blockShape:s,paddings:i}=n,o=R.sizeFromShape(s),u=[[0,0]];u.push(...i);for(let x=1+s.length;x<a.shape.length;++x)u.push([0,0]);let d=Qte.kernelFunc({inputs:{x:a},backend:r,attrs:{paddings:u,constantValue:0}}),c=H.getReshaped(d.shape,s,o,!1),h=H.getPermuted(c.length,s.length,!1),p=H.getReshapedPermuted(d.shape,s,o,!1),f=xs({inputs:{x:d},backend:r,attrs:{shape:c}}),g=Lc({inputs:{x:f},backend:r,attrs:{perm:h}}),m=xs({inputs:{x:g},backend:r,attrs:{shape:p}});return r.disposeData(d.dataId),r.disposeData(f.dataId),r.disposeData(g.dataId),m}var jnt={kernelName:Ux,backendName:"wasm",kernelFunc:Tnt},lre;function Ant(e){lre=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])}function $nt(e){let{backend:t,inputs:r}=e,{indices:n,values:a,denseShape:s,defaultValue:i}=r,o=n.shape[0],u=n.shape[1],d=t.readSync(s.dataId)[0],c=[o+d,u],h=t.dataIdMap.get(n.dataId).id,p=t.dataIdMap.get(a.dataId).id,f=t.dataIdMap.get(i.dataId).id,g=t.makeOutput(c,n.dtype),m=t.dataIdMap.get(g.dataId).id,x=t.makeOutput(c.slice(0,1),a.dtype),y=t.dataIdMap.get(x.dataId).id,v=t.makeOutput([d],"bool"),b=t.dataIdMap.get(v.dataId).id,N=t.makeOutput([o],n.dtype),S=t.dataIdMap.get(N.dataId).id,_=t.makeOutput([4],"int32"),C=t.dataIdMap.get(_.dataId).id,k=lre(h,p,br[a.dtype],o,d,u,f,m,y,b,S,C),I=t.readSync(_.dataId),T;switch(I[0]){case 1:{T=H.getSparseFillEmptyRowsIndicesDenseShapeMismatch(I[1]);break}case 2:{T=H.getSparseFillEmptyRowsNegativeIndexErrorMessage(I[1],I[2]);break}case 3:T=H.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(I[1],I[2],I[3]);break;default:T=""}if(t.disposeData(_.dataId),T)throw t.disposeData(g.dataId),t.disposeData(x.dataId),t.disposeData(v.dataId),t.disposeData(N.dataId),new Error(T);let j=g,E=x;return k!==c[0]&&(j=Lh({inputs:{x:g},attrs:{begin:0,size:[k,u]},backend:t}),E=Lh({inputs:{x},attrs:{begin:0,size:k},backend:t}),t.disposeData(g.dataId),t.disposeData(x.dataId)),[j,E,v,N]}var Rnt={kernelName:N0,backendName:"wasm",setupFunc:Ant,kernelFunc:$nt},ure;function Dnt(e){ure=e.wasm.cwrap(Vx,null,["number","number","number","number","number","number","number"])}function Mnt(e){let{backend:t,inputs:r}=e,{inputIndices:n,inputShape:a,newShape:s}=r;if(n.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${n.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=t.dataIdMap.get(n.dataId).id,o=t.dataIdMap.get(a.dataId).id,u=t.dataIdMap.get(s.dataId).id,d=n.shape[0],c=R.sizeFromShape(s.shape),h=t.makeOutput([d,c],n.dtype),p=t.dataIdMap.get(h.dataId).id,f=t.makeOutput([c],s.dtype),g=t.dataIdMap.get(f.dataId).id,m=t.makeOutput([3],"int32"),x=t.dataIdMap.get(m.dataId).id;ure(i,o,u,d,p,g,x);let y=t.readSync(m.dataId),v;switch(y[0]){case 0:{v=H.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(y[1],y[2]);break}case 1:{v=H.getSparseReshapeNegativeOutputDimErrorMessage(y[1],y[2]);break}case 2:v=H.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let b=Array.from(t.readSync(a.dataId)),N=Array.from(t.readSync(f.dataId));v=H.getSparseReshapeInputOutputMultipleErrorMessage(b,N);break}case 4:{let b=Array.from(t.readSync(a.dataId)),N=Array.from(t.readSync(f.dataId));v=H.getSparseReshapeInputOutputMismatchErrorMessage(b,N);break}default:v=""}if(t.disposeData(m.dataId),v)throw t.disposeData(h.dataId),t.disposeData(f.dataId),new Error(v);return[h,f]}var Fnt={kernelName:Vx,backendName:"wasm",setupFunc:Dnt,kernelFunc:Mnt},cre;function dre(e){cre=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function hre(e,t){let{backend:r,inputs:n}=e,{data:a,indices:s,segmentIds:i}=n,o=s.shape[0],u=r.readSync(i.dataId,o-1,o)[0],d=o>0?u+1:0;if(d<0)throw new Error(H.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let c=a.shape.slice();c[0]=d;let h=r.dataIdMap.get(a.dataId).id,p=r.dataIdMap.get(s.dataId).id,f=r.dataIdMap.get(i.dataId).id,g=r.makeOutput(c,a.dtype),m=r.dataIdMap.get(g.dataId).id,x=r.makeOutput([4],"int32"),y=r.dataIdMap.get(x.dataId).id;cre(h,br[a.dtype],a.shape[0],p,f,m,y,t,0);let v=r.readSync(x.dataId),b;switch(v[0]){case 0:{b=H.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break}case 1:{b=H.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break}case 2:b=H.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(v[1],v[2]);break;case 3:b=H.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v[1],v[2],v[3]);break;default:b=""}if(r.disposeData(x.dataId),b)throw r.disposeData(g.dataId),new Error(b);return g}function Ont(e){return hre(e,!0)}var Pnt={kernelName:S0,backendName:"wasm",setupFunc:dre,kernelFunc:Ont};function Lnt(e){return hre(e,!1)}var znt={kernelName:_0,backendName:"wasm",setupFunc:dre,kernelFunc:Lnt},pre;function Bnt(e){pre=e.wasm.cwrap(Hx,null,["number","number","number","number","number","number","number","number","array","number","number"])}function Unt(e){let{backend:t,inputs:r,attrs:n}=e,{sparseIndices:a,sparseValues:s,defaultValue:i}=r,{outputShape:o}=n,u=t.makeOutput(o,i.dtype);if(R.sizeFromShape(o)===0)return u;let{sliceRank:d,numUpdates:c,sliceSize:h,strides:p,outputSize:f}=H.calculateShapes(s,a,o),g=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(s.dataId).id,x=t.dataIdMap.get(i.dataId).id,y=new Uint8Array(new Int32Array(p).buffer),v=t.dataIdMap.get(u.dataId).id;return pre(g,m,s.shape.length,x,br[i.dtype],d,c,h,y,f,v),u}var Wnt={kernelName:Hx,backendName:"wasm",setupFunc:Bnt,kernelFunc:Unt};function Vnt(e){let{inputs:t,attrs:r,backend:n}=e,{x:a}=t,{numOrSizeSplits:s,axis:i}=r,o=R.parseAxisParam(i,a.shape)[0],u=H.prepareSplitSize(a,s,o),d=new Array(a.shape.length).fill(0),c=a.shape.slice();return u.map(h=>{let p=[...c];p[o]=h;let f=Lh({inputs:{x:a},attrs:{begin:d,size:p},backend:n});return d[o]+=h,f})}var Hnt={kernelName:Wx,backendName:"wasm",kernelFunc:Vnt},qnt=fr(lf),Gnt=fr(k0),Knt=qn(df),fre;function Qnt(e){fre=e.wasm.cwrap(ed,null,["number","number","number","number"])}function Xnt(e){let{backend:t,inputs:r,attrs:n}=e,{alpha:a}=n,{x:s}=r,i=t.dataIdMap.get(s.dataId).id,o=t.makeOutput(s.shape,s.dtype),u=t.dataIdMap.get(o.dataId).id;return fre(i,a,br[s.dtype],u),o}var Ynt={kernelName:ed,backendName:"wasm",setupFunc:Qnt,kernelFunc:Xnt},mre;function Jnt(e){mre=e.wasm.cwrap(qx,null,["number","array","number","array","array","array","array","array","number","number"])}function Znt(e){let{backend:t,inputs:r,attrs:n}=e,{x:a}=r,{begin:s,end:i,strides:o,beginMask:u,endMask:d,ellipsisMask:c,newAxisMask:h,shrinkAxisMask:p}=n,{finalShapeSparse:f,finalShape:g,isIdentity:m,sliceDim0:x,isSimpleSlice:y,begin:v,end:b,strides:N}=Yn.sliceInfo(a.shape,s,i,o,u,d,c,h,p),S;if(m)S=xs({inputs:{x:a},backend:t,attrs:{shape:g}});else if(x||y){R.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let _=Yn.computeOutShape(v,b,N),C=Lh({inputs:{x:a},backend:t,attrs:{begin:v,size:_}});S=xs({inputs:{x:C},backend:t,attrs:{shape:g}}),t.disposeData(C.dataId)}else{let _=t.makeOutput(f,"float32"),C=t.dataIdMap.get(a.dataId).id,k=new Uint8Array(new Int32Array(R.computeStrides(a.shape)).buffer),I=new Uint8Array(new Int32Array(v).buffer),T=new Uint8Array(new Int32Array(b).buffer),j=new Uint8Array(new Int32Array(N).buffer),E=new Uint8Array(new Int32Array(f).buffer),O=new Uint8Array(new Int32Array(R.computeStrides(f)).buffer),M=t.dataIdMap.get(_.dataId).id;mre(C,k,a.shape.length,I,T,j,E,O,f.length,M),S=xs({inputs:{x:_},backend:t,attrs:{shape:g}}),t.disposeData(_.dataId)}return S}var eat={kernelName:qx,backendName:"wasm",setupFunc:Jnt,kernelFunc:Znt};function tat(e){let{backend:t,inputs:r,attrs:n}=e,{data:a,dataSplits:s}=r,{separator:i,nGramWidths:o,leftPad:u,rightPad:d,padWidth:c,preserveShortSequences:h}=n,p=t.readSync(a.dataId),f=t.readSync(s.dataId),[g,m]=BF(p,f,i,o,u,d,c,h),x=t.makeOutput([g.length],"string"),y=t.dataIdMap.get(x.dataId);y.stringBytes=g;let v=t.makeOutput(s.shape,"int32");return t.typedArrayFromHeap(v).set(m),[x,v]}var rat={kernelName:I0,backendName:"wasm",kernelFunc:tat};function nat(e){let{backend:t,inputs:r,attrs:n}=e,{input:a,delimiter:s}=r,{skipEmpty:i}=n,o=t.readSync(a.dataId),u=t.readSync(s.dataId),[d,c,h]=UF(o,u[0],i),p=c.length,f=t.makeOutput([p,2],"int32");t.typedArrayFromHeap(f).set(d);let g=t.makeOutput([p],"string"),m=t.dataIdMap.get(g.dataId);m.stringBytes=c;let x=t.makeOutput([2],"int32");return t.typedArrayFromHeap(x).set(h),[f,g,x]}var aat={kernelName:E0,backendName:"wasm",kernelFunc:nat};function sat(e){let{backend:t,inputs:r,attrs:n}=e,{input:a}=r,{numBuckets:s}=n,i=t.readSync(a.dataId),o=WF(i,s),u=t.makeOutput(a.shape,"int32");return t.typedArrayFromHeap(u).set(o),u}var iat={kernelName:T0,backendName:"wasm",kernelFunc:sat},oat=qn(hf),gre;function lat(e){gre=e.wasm.cwrap(uf,null,["number","number","number","number"])}function uat(e){let{backend:t,inputs:r,attrs:n}=e,{axis:a,keepDims:s}=n,{x:i}=r,o=t.dataIdMap.get(i.dataId).id,u=o,d=i,{transposed:c,axes:h,originalAxes:p,inputWasTransposed:f}=ld(i,a,t),g=h;if(f){let b=t.dataIdMap.get(c.dataId).id;b!==o&&(d=c,u=b,g=H.getInnerMostAxes(g.length,d.shape.length))}H.assertAxesAreInnerMostDims("sum",g,d.shape.length);let[m,x]=H.computeOutAndReduceShapes(d.shape,g),y=R.sizeFromShape(x),v=t.makeOutput(m,d.dtype);if(R.sizeFromShape(d.shape)!==0){let b=t.dataIdMap.get(v.dataId).id;gre(u,y,br[v.dtype],b)}if(f&&t.disposeData(c.dataId),s){let b=H.expandShapeToKeepDim(v.shape,p);v.shape=b}return v}var cat={kernelName:uf,backendName:"wasm",setupFunc:lat,kernelFunc:uat},dat=fr(pf),hat=fr(ff),xre;function pat(e){xre=e.wasm.cwrap(Px,null,["number","number","number","number","number","number","array","number","number","number"])}function fat(e){let{backend:t,inputs:r,attrs:n}=e,{tensor:a,indices:s,updates:i}=r,o=t.makeOutput(a.shape,a.dtype);if(R.sizeFromShape(a.shape)===0)return o;let{sliceRank:u,numUpdates:d,sliceSize:c,strides:h,outputSize:p}=Yk.calculateShapes(i,s,a.shape),f=t.dataIdMap.get(s.dataId).id,g=t.dataIdMap.get(i.dataId).id,m=t.dataIdMap.get(a.dataId).id,x=new Uint8Array(new Int32Array(h).buffer),y=t.dataIdMap.get(o.dataId).id;return xre(f,g,br[i.dtype],u,d,c,x,p,y,m),o}var mat={kernelName:Px,backendName:"wasm",setupFunc:pat,kernelFunc:fat},yre;function gat(e){yre=e.wasm.cwrap(Zc,null,["number","array","number","array","number","number"])}function xat(e){let{inputs:t,backend:r,attrs:n}=e,{x:a}=t,s=r.dataIdMap.get(a.dataId).id,{reps:i}=n,o=new Array(a.shape.length);for(let p=0;p<o.length;p++)o[p]=a.shape[p]*i[p];let u=new Uint8Array(new Int32Array(a.shape).buffer),d=new Uint8Array(new Int32Array(o).buffer),c=r.makeOutput(o,a.dtype),h=r.dataIdMap.get(c.dataId).id;return yre(s,u,a.shape.length,d,o.length,br[c.dtype],h),c}var yat={kernelName:Zc,backendName:"wasm",setupFunc:gat,kernelFunc:xat},vre;function vat(e){vre=e.wasm.cwrap(Gx,null,["number","array","number","number","number","bool","number","number"])}var bat=({inputs:e,backend:t,attrs:r})=>{let{x:n}=e,{k:a,sorted:s}=r,i=t.dataIdMap.get(n.dataId).id,o=new Uint8Array(new Int32Array(n.shape).buffer),u=n.shape.slice();u[u.length-1]=a;let d=t.makeOutput(u,n.dtype),c=t.dataIdMap.get(d.dataId).id,h=t.makeOutput(u,"int32"),p=t.dataIdMap.get(h.dataId).id;return vre(i,o,n.shape.length,br[n.dtype],a,s,c,p),[d,h]},wat={kernelName:Gx,backendName:"wasm",setupFunc:vat,kernelFunc:bat},bre;function Nat(e){bre=e.wasm.cwrap(Kx,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])}function Sat(e){let{backend:t,inputs:r,attrs:n}=e,{image:a,transforms:s}=r,{interpolation:i,fillMode:o,fillValue:u,outputShape:d}=n,[c,h,p,f]=a.shape,[g,m]=d??[h,p],x=[c,g,m,f],y=new Uint8Array(new Int32Array(R.computeStrides(a.shape)).buffer),v=new Uint8Array(new Int32Array(R.computeStrides(x)).buffer),b=t.makeOutput(x,a.dtype),N=t.dataIdMap.get(b.dataId).id,S=t.dataIdMap.get(a.dataId).id,_=t.dataIdMap.get(s.dataId).id,C=i==="nearest"?1:2,k;switch(o){case"constant":k=1;break;case"reflect":k=2;break;case"wrap":k=3;break;case"nearest":k=4;break;default:k=1;break}return bre(S,_,s.shape[0]>1,c,g,m,f,p,h,y,a.shape.length-1,v,x.length-1,C,k,u,N),b}var _at={kernelName:Kx,backendName:"wasm",setupFunc:Nat,kernelFunc:Sat};function kat(e){let{inputs:t,attrs:r,backend:n}=e,{axis:a}=r,{x:s}=t,{outputValues:i,outputShape:o,indices:u}=HF(n.readSync(s.dataId),a,s.shape,s.dtype);return[n.makeOutput(o,s.dtype,void 0,i),n.makeOutput([u.length],"int32",void 0,u)]}var Cat={kernelName:j0,backendName:"wasm",kernelFunc:kat};function Iat(e){let{inputs:t,backend:r,attrs:n}=e,{value:a}=t,{axis:s}=n;s<0&&(s+=a.shape.length);let i=a.shape[s],o=a.shape.length,u=new Array(o-1),d=0;for(let f=0;f<o;f++)f!==s&&(u[d++]=a.shape[f]);let c=new Array(i),h=new Array(o).fill(0),p=a.shape.slice();p[s]=1;for(let f=0;f<c.length;f++)h[s]=f,c[f]=Lh({inputs:{x:a},attrs:{begin:h,size:p},backend:r});return c.map(({dataId:f,dtype:g})=>({dataId:f,dtype:g,shape:u}))}var Eat={kernelName:Qx,backendName:"wasm",kernelFunc:Iat};function Tat(e){let{inputs:{x:t},backend:r}=e,n=r.makeOutput(t.shape,t.dtype);return r.typedArrayFromHeap(n).fill(0),n}var jat={kernelName:Xx,backendName:"wasm",kernelFunc:Tat},Aat=[bJe,wJe,NJe,SJe,_Je,IJe,MJe,PJe,LJe,zJe,BJe,UJe,WJe,VJe,HJe,KJe,nZe,YJe,eZe,oZe,pZe,gZe,xZe,vZe,bZe,wZe,_Ze,kZe,EZe,AZe,DZe,OZe,zZe,BZe,UZe,HZe,KZe,YZe,eet,net,iet,cet,pet,get,vet,bet,_et,Cet,Iet,Eet,Tet,jet,Aet,Det,Met,Fet,Let,Uet,Het,Ket,Yet,Zet,ttt,EJe,rtt,ntt,att,ott,utt,dtt,ftt,gtt,mtt,ytt,vtt,wtt,Stt,Ctt,Ttt,$tt,Rtt,Ftt,Ltt,Utt,Htt,Ktt,Ytt,ert,trt,art,urt,crt,drt,hrt,mrt,yrt,wrt,Srt,Crt,Ert,jrt,Qte,Rrt,Frt,Lrt,Brt,Urt,Wrt,Vrt,Hrt,aZe,Krt,Yrt,ent,nnt,int,unt,cnt,dnt,fnt,xnt,bnt,wnt,_nt,knt,Cnt,Int,dZe,irt,Ent,jnt,Rnt,Fnt,Pnt,znt,Wnt,Hnt,qnt,Gnt,Knt,Ynt,eat,rat,aat,iat,oat,cat,dat,hat,mat,yat,wat,_at,$Je,Cat,Eat,jat];for(let e of Aat)$0(e);var bj=ge();bj.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch{return!1}});bj.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(bj.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}});var $z=Xc(cke()),$at=Xc(dke()),Rz=Xc(hke()),Dz=$z.default||$z,Rat=Rz.default||Rz,wre=class extends u0{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(Nre),wj=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new uk(this,Ai())}write(e,t,r){let n={id:this.dataIdNextNumber++};return this.move(n,e,t,r,1),n}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=R.now();return e(),{kernelMs:R.now()-t}}move(e,t,r,n,a){let s=this.dataIdNextNumber++;if(n==="string"){let d=t;this.dataIdMap.set(e,{id:s,stringBytes:d,shape:r,dtype:n,memoryOffset:null,refCount:a});return}let i=R.sizeFromShape(r),o=i*R.bytesPerElement(n),u=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:s,memoryOffset:u,shape:r,dtype:n,refCount:a}),this.wasm.tfjs.registerTensor(s,i,u),t!=null&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),u)}async read(e){return this.readSync(e)}readSync(e,t,r){let{memoryOffset:n,dtype:a,shape:s,stringBytes:i}=this.dataIdMap.get(e);if(a==="string")return(t==null||t===0)&&(r==null||r>=i.length)?i:i.slice(t,r);t=t||0,r=r||R.sizeFromShape(s);let o=R.bytesPerElement(a),u=this.wasm.HEAPU8.slice(n+t*o,n+r*o);return Fat(u.buffer,a)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){let r=this.dataIdMap.get(e);if(r.refCount--,!t&&r.refCount>0)return!1;this.wasm._free(r.memoryOffset),this.wasm.tfjs.disposeData(r.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);t!=null&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,r,n){let a;if(r==null)a=this.write(n??null,e,t);else{let s=this.dataIdNextNumber++;a={id:s},this.dataIdMap.set(a,{id:s,memoryOffset:r,shape:e,dtype:t,refCount:1});let i=R.sizeFromShape(e);this.wasm.tfjs.registerTensor(s,i,r)}return{dataId:a,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:r}){let n=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(r),s=R.sizeFromShape(e);switch(t){case"float32":return new Float32Array(n,a,s);case"int32":return new Int32Array(n,a,s);case"bool":return new Uint8Array(n,a,s);default:throw new Error(`Unknown dtype ${t}`)}}};function Dat(e){return(t,r)=>(R.fetch(e,{credentials:"same-origin"}).then(n=>{n.ok||t.env.a(`failed to load wasm binary file at '${e}'`),n.arrayBuffer().then(a=>{WebAssembly.instantiate(a,t).then(s=>{r(s.instance,s.module)})})}),{})}function Mz(e,t,r){if(jS!=null)return jS;let n="tfjs-backend-wasm.wasm";return e&&t?n="tfjs-backend-wasm-threaded-simd.wasm":e&&(n="tfjs-backend-wasm-simd.wasm"),_v!=null&&_v[n]!=null?_v[n]:r+n}async function Mat(){let[e,t]=await Promise.all([ge().getAsync("WASM_HAS_SIMD_SUPPORT"),ge().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((r,n)=>{let a={};a.locateFile=(o,u)=>{if(o.endsWith(".worker.js")){let d=$at.wasmWorkerContents.replace(/\n/g,"\\n"),c=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(c)}return o.endsWith(".wasm")?Mz(e,t,lv??u):u+o},hO&&(a.instantiateWasm=Dat(Mz(e,t,lv??"")));let s=!1;a.onAbort=()=>{s||kv||(kv=!0,n({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))};let i;t&&e&&jS==null?(a.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+Dz.toString()],{type:"text/javascript"}),i=Dz(a)):i=Rat(a),i.then(o=>{s=!0,kv=!1;let u=null;o.tfjs={init:o.cwrap("init",null,[]),initWithThreadsCount:o.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:o.cwrap("get_threads_count","number",[]),registerTensor:o.cwrap("register_tensor",null,["number","number","number"]),disposeData:o.cwrap("dispose_data",u,["number"]),dispose:o.cwrap("dispose",u,[])},r({wasm:o})}).catch(n)})}function Fat(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}var Oat=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],jS=null,lv=null,_v={},kv=!1,hO=!1;function Pat(e,t=!1){if(W7("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),kv)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");jS=e,hO=t}function Lat(e,t=!1){if(kv)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if(typeof e=="string")lv=e;else{_v=e;let r=Oat.filter(n=>_v[n]==null);if(r.length>0)throw new Error(`There were no entries found for the following binaries: ${r.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}hO=t}var Nre=-1,wj=-1;function zat(e){Nre=e}function Bat(){if(wj===-1)throw new Error("WASM backend not initialized.");return wj}var Uat="4.22.0",Wat=2;Ik("wasm",async()=>{let{wasm:e}=await Mat();return new wre(e)},Wat);var Fz="4.22.0",Vat="4.22.0",Hat="4.22.0",qat="4.22.0",Gat="4.22.0",Kat={tfjs:Fz,"tfjs-core":Fz,"tfjs-converter":Vat,"tfjs-backend-cpu":Hat,"tfjs-backend-webgl":qat,"tfjs-backend-wasm":Gat},Qat={};bR(Qat,{AnchorPosition:()=>Ore,DrawBox:()=>zre,DrawBoxOptions:()=>Lre,DrawFaceLandmarks:()=>nne,DrawFaceLandmarksOptions:()=>rne,DrawTextField:()=>vO,DrawTextFieldOptions:()=>yO,drawContour:()=>$u,drawDetections:()=>ust,drawFaceExpressions:()=>Sst,drawFaceLandmarks:()=>Cst});function $u(e,t,r=!1){if(e.beginPath(),t.slice(1).forEach(({x:n,y:a},s)=>{let i=t[s];e.moveTo(i.x,i.y),e.lineTo(n,a)}),r){let n=t[t.length-1],a=t[0];if(!n||!a)return;e.moveTo(n.x,n.y),e.lineTo(a.x,a.y)}e.stroke()}var Xat={};bR(Xat,{computeReshapedDimensions:()=>Cre,getCenterPoint:()=>fO,isDimensions:()=>Sj,isEven:()=>Nj,isFloat:()=>kre,isTensor:()=>yy,isTensor1D:()=>Yat,isTensor2D:()=>_re,isTensor3D:()=>dw,isTensor4D:()=>Ql,isValidNumber:()=>nh,isValidProbablitiy:()=>Jat,range:()=>Sg,round:()=>pO});var Am=class Sre{constructor(t,r){if(!nh(t)||!nh(r))throw new Error(`Dimensions.constructor - expected width and height to be valid numbers, instead have ${JSON.stringify({width:t,height:r})}`);this._width=t,this._height=r}get width(){return this._width}get height(){return this._height}reverse(){return new Sre(1/this.width,1/this.height)}};function yy(e,t){return e instanceof Jt&&e.shape.length===t}function Yat(e){return yy(e,1)}function _re(e){return yy(e,2)}function dw(e){return yy(e,3)}function Ql(e){return yy(e,4)}function kre(e){return e%1!==0}function Nj(e){return e%2===0}function pO(e,t=2){let r=10**t;return Math.floor(e*r)/r}function Sj(e){return e&&e.width&&e.height}function Cre({width:e,height:t},r){let n=r/Math.max(t,e);return new Am(Math.round(e*n),Math.round(t*n))}function fO(e){return e.reduce((t,r)=>t.add(r),new Mr(0,0)).div(new Mr(e.length,e.length))}function Sg(e,t,r){return Array(e).fill(0).map((n,a)=>t+a*r)}function nh(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||e===0}function Jat(e){return nh(e)&&e>=0&&e<=1}var Mr=class kd{constructor(t,r){this._x=t,this._y=r}get x(){return this._x}get y(){return this._y}add(t){return new kd(this.x+t.x,this.y+t.y)}sub(t){return new kd(this.x-t.x,this.y-t.y)}mul(t){return new kd(this.x*t.x,this.y*t.y)}div(t){return new kd(this.x/t.x,this.y/t.y)}abs(){return new kd(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new kd(Math.floor(this.x),Math.floor(this.y))}},zh=class ao{static isRect(t){return!!t&&[t.x,t.y,t.width,t.height].every(nh)}static assertIsValidBox(t,r,n=!1){if(!ao.isRect(t))throw new Error(`${r} - invalid box: ${JSON.stringify(t)}, expected object with properties x, y, width, height`);if(!n&&(t.width<0||t.height<0))throw new Error(`${r} - width (${t.width}) and height (${t.height}) must be positive numbers`)}constructor(t,r=!0){let n=t||{},a=[n.left,n.top,n.right,n.bottom].every(nh),s=[n.x,n.y,n.width,n.height].every(nh);if(!s&&!a)throw new Error(`Box.constructor - expected box to be IBoundingBox | IRect, instead have ${JSON.stringify(n)}`);let[i,o,u,d]=s?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top];ao.assertIsValidBox({x:i,y:o,width:u,height:d},"Box.constructor",r),this._x=i,this._y=o,this._width=u,this._height=d}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new Mr(this.left,this.top)}get topRight(){return new Mr(this.right,this.top)}get bottomLeft(){return new Mr(this.left,this.bottom)}get bottomRight(){return new Mr(this.right,this.bottom)}round(){let[t,r,n,a]=[this.x,this.y,this.width,this.height].map(s=>Math.round(s));return new ao({x:t,y:r,width:n,height:a})}floor(){let[t,r,n,a]=[this.x,this.y,this.width,this.height].map(s=>Math.floor(s));return new ao({x:t,y:r,width:n,height:a})}toSquare(){let{x:t,y:r,width:n,height:a}=this,s=Math.abs(n-a);return n<a&&(t-=s/2,n+=s),a<n&&(r-=s/2,a+=s),new ao({x:t,y:r,width:n,height:a})}rescale(t){let r=Sj(t)?t.width:t,n=Sj(t)?t.height:t;return new ao({x:this.x*r,y:this.y*n,width:this.width*r,height:this.height*n})}pad(t,r){let[n,a,s,i]=[this.x-t/2,this.y-r/2,this.width+t,this.height+r];return new ao({x:n,y:a,width:s,height:i})}clipAtImageBorders(t,r){let{x:n,y:a,right:s,bottom:i}=this,o=Math.max(n,0),u=Math.max(a,0),d=s-o,c=i-u,h=Math.min(d,t-o),p=Math.min(c,r-u);return new ao({x:o,y:u,width:h,height:p}).floor()}shift(t,r){let{width:n,height:a}=this,s=this.x+t,i=this.y+r;return new ao({x:s,y:i,width:n,height:a})}padAtBorders(t,r){let n=this.width+1,a=this.height+1,s=1,i=1,o=n,u=a,d=this.left,c=this.top,h=this.right,p=this.bottom;return h>r&&(o=-h+r+n,h=r),p>t&&(u=-p+t+a,p=t),d<1&&(u=2-d,d=1),c<1&&(u=2-c,c=1),{dy:i,edy:u,dx:s,edx:o,y:c,ey:p,x:d,ex:h,w:n,h:a}}calibrate(t){return new ao({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()}},Ire=class extends zh{constructor(e,t,r,n,a=!1){super({left:e,top:t,right:r,bottom:n},a)}},Ere=class Tre{constructor(t,r,n,a,s){this._imageDims=new Am(s.width,s.height),this._score=t,this._classScore=r,this._className=n,this._box=new zh(a).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new zh(this._box).rescale(this.imageDims.reverse())}forSize(t,r){return new Tre(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:r})}},$o=class jre extends Ere{constructor(t,r,n){super(t,t,"",r,n)}forSize(t,r){let{score:n,relativeBox:a,imageDims:s}=super.forSize(t,r);return new jre(n,a,s)}};function Zat(e,t,r=!0){let n=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),s=n*a;return r?s/(e.area+t.area-s):s/Math.min(e.area,t.area)}function est(e){let t=e.map(o=>o.x),r=e.map(o=>o.y),n=t.reduce((o,u)=>u<o?u:o,1/0),a=r.reduce((o,u)=>u<o?u:o,1/0),s=t.reduce((o,u)=>o<u?u:o,0),i=r.reduce((o,u)=>o<u?u:o,0);return new Ire(n,a,s,i)}function tst(e,t,r,n=!0){let a=t.map((i,o)=>({score:i,boxIndex:o})).sort((i,o)=>i.score-o.score).map(i=>i.boxIndex),s=[];for(;a.length>0;){let i=a.pop();s.push(i);let o=a,u=[];for(let d=0;d<o.length;d++){let c=o[d],h=e[i],p=e[c];u.push(Zat(h,p,n))}a=a.filter((d,c)=>u[c]<=r)}return s}function hw(e,t){return ce(()=>{let[r,n,a]=t,s=Qs([...e.shape.slice(0,3),1],r,"float32"),i=Qs([...e.shape.slice(0,3),1],n,"float32"),o=Qs([...e.shape.slice(0,3),1],a,"float32"),u=zr([s,i,o],3);return Ze(e,u)})}function rst(e,t=!1){return ce(()=>{let[r,n]=e.shape.slice(1);if(r===n)return e;let a=Math.abs(r-n),s=Math.round(a*(t?.5:1)),i=r>n?2:1,o=h=>{let p=e.shape.slice();return p[i]=h,Qs(p,0,"float32")},u=o(s),d=a-u.shape[i],c=[t&&d?o(d):null,e,u].filter(h=>!!h).map(h=>Pe(h,"float32"));return zr(c,i)})}function fI(e){return 1/(1+Math.exp(-e))}var Are=class extends zh{constructor(e,t,r,n,a=!1){super({x:e,y:t,width:r,height:n},a)}},nst=.5,ast=.43,sst=.45,AS=class{constructor(e,t,r=new Mr(0,0)){let{width:n,height:a}=t;this._imgDims=new Am(n,a),this._shift=r,this._positions=e.map(s=>s.mul(new Mr(n,a)).add(r))}get shift(){return new Mr(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map(e=>e.sub(this._shift).div(new Mr(this.imageWidth,this.imageHeight)))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Mr(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e,t={}){if(e){let a=e instanceof $o?e.box.floor():new zh(e);return this.shiftBy(a.x,a.y).align(null,t)}let{useDlibAlignment:r,minBoxPadding:n}={useDlibAlignment:!1,minBoxPadding:.2,...t};return r?this.alignDlib():this.alignMinBbox(n)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,r,n]=e,a=c=>n.sub(c).magnitude(),s=(a(t)+a(r))/2,i=Math.floor(s/sst),o=fO(e),u=Math.floor(Math.max(0,o.x-nst*i)),d=Math.floor(Math.max(0,o.y-ast*i));return new Are(u,d,Math.min(i,this.imageWidth+u),Math.min(i,this.imageHeight+d))}alignMinBbox(e){let t=est(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},$re=class extends AS{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(fO)}};function $S(e){return e.detection instanceof $o}function ist(e,t){return{...e,detection:t}}function Rre(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function mO(){return typeof global=="object"&&typeof process<"u"&&process.versions!=null&&process.versions.node!=null}function Dre(e){let t="";if(!e&&mO())try{e=U_e("fs")}catch(r){t=r.toString()}return{readFile:e?r=>new Promise((n,a)=>{e.readFile(r,(s,i)=>s?a(s):n(i))}):()=>{throw new Error(`readFile - failed to require fs in nodejs environment with error: ${t}`)}}}function Mre(){let e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,r=global.Video||global.HTMLVideoElement,n=()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},a=()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},s=()=>{if(r)return new r;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},i=global.fetch,o=Dre();return{Canvas:e||class{},CanvasRenderingContext2D:global.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:global.ImageData||class{},Video:global.HTMLVideoElement||class{},createCanvasElement:n,createImageElement:a,createVideoElement:s,fetch:i,...o}}function Fre(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}var ra;function ost(){if(!ra)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return ra}function _j(e){ra=e}function gO(){return Fre()?_j(Rre()):mO()?_j(Mre()):null}function lst(e){if(ra||gO(),!ra)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=ra.Canvas,Image:r=ra.Image}=e;ra.Canvas=t,ra.Image=r,ra.createCanvasElement=e.createCanvasElement||(()=>new t),ra.createImageElement=e.createImageElement||(()=>new r),ra.ImageData=e.ImageData||ra.ImageData,ra.Video=e.Video||ra.Video,ra.fetch=e.fetch||ra.fetch,ra.readFile=e.readFile||ra.readFile}var ws={getEnv:ost,setEnv:_j,initialize:gO,createBrowserEnv:Rre,createFileSystem:Dre,createNodejsEnv:Mre,monkeyPatch:lst,isBrowser:Fre,isNodejs:mO};gO();function xO(e){return!ws.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function zc(e){let{Canvas:t,CanvasRenderingContext2D:r}=ws.getEnv();if(e instanceof r)return e;let n=xO(e);if(!(n instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let a=n.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}var Ore=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e))(Ore||{}),yO=class{constructor(e={}){let{anchorPosition:t,backgroundColor:r,fontColor:n,fontSize:a,fontStyle:s,padding:i}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=n||"rgba(255, 255, 255, 1)",this.fontSize=a||14,this.fontStyle=s||"Georgia",this.padding=i||4}},vO=class Pre{constructor(t,r,n={}){this.text=typeof t=="string"?[t]:t instanceof Pre?t.text:t,this.anchor=r,this.options=new yO(n)}measureWidth(t){let{padding:r}=this.options;return this.text.map(n=>t.measureText(n).width).reduce((n,a)=>n<a?a:n,0)+2*r}measureHeight(){let{fontSize:t,padding:r}=this.options;return this.text.length*t+2*r}getUpperLeft(t,r){let{anchorPosition:n}=this.options,a=n==="BOTTOM_RIGHT"||n==="TOP_RIGHT",s=n==="BOTTOM_LEFT"||n==="BOTTOM_RIGHT",i=this.measureWidth(t),o=this.measureHeight(),u=a?this.anchor.x-i:this.anchor.x,d=s?this.anchor.y-o:this.anchor.y;if(r){let{width:c,height:h}=r,p=Math.max(Math.min(u,c-i),0),f=Math.max(Math.min(d,h-o),0);return{x:p,y:f}}return{x:u,y:d}}draw(t){let r=xO(t),n=zc(r),{backgroundColor:a,fontColor:s,fontSize:i,fontStyle:o,padding:u}=this.options;n.font=`${i}px ${o}`;let d=this.measureWidth(n),c=this.measureHeight();n.fillStyle=a;let h=this.getUpperLeft(n,r);n.fillRect(h.x,h.y,d,c),n.fillStyle=s,this.text.forEach((p,f)=>{let g=u+h.x,m=u+h.y+(f+1)*i;n.fillText(p,g,m)})}},Lre=class{constructor(e={}){let{boxColor:t,lineWidth:r,label:n,drawLabelOptions:a}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=r||2,this.label=n;let s={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new yO({...s,...a})}},zre=class{constructor(e,t={}){this.box=new zh(e),this.options=new Lre(t)}draw(e){let t=zc(e),{boxColor:r,lineWidth:n}=this.options,{x:a,y:s,width:i,height:o}=this.box;t.strokeStyle=r,t.lineWidth=n,t.strokeRect(a,s,i,o);let{label:u}=this.options;u&&new vO([u],{x:a-n/2,y:s},this.options.drawLabelOptions).draw(e)}};function ust(e,t){(Array.isArray(t)?t:[t]).forEach(r=>{let n=r instanceof $o?r.score:$S(r)?r.detection.score:void 0,a=r instanceof $o?r.box:$S(r)?r.detection.box:new zh(r),s=n?`${pO(n)}`:void 0;new zre(a,{label:s}).draw(e)})}function Bre(e){let{Image:t,Video:r}=ws.getEnv();return e instanceof t&&e.complete||e instanceof r&&e.readyState>=3}function cst(e){return new Promise((t,r)=>{if(e instanceof ws.getEnv().Canvas||Bre(e)){t(null);return}function n(s){s.currentTarget&&(s.currentTarget.removeEventListener("load",a),s.currentTarget.removeEventListener("error",n),r(s))}function a(s){s.currentTarget&&(s.currentTarget.removeEventListener("load",a),s.currentTarget.removeEventListener("error",n),t(s))}e.addEventListener("load",a),e.addEventListener("error",n)})}function Ure(e){let{Image:t,Video:r}=ws.getEnv();return e instanceof t?new Am(e.naturalWidth,e.naturalHeight):e instanceof r?new Am(e.videoWidth,e.videoHeight):new Am(e.width,e.height)}function RS({width:e,height:t}){let{createCanvasElement:r}=ws.getEnv(),n=r();return n.width=e,n.height=t,n}function Wre(e,t){let{ImageData:r}=ws.getEnv();if(!(e instanceof r)&&!Bre(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:n,height:a}=Ure(e),s=RS({width:n,height:a});return e instanceof r?zc(s).putImageData(e,0,0):zc(s).drawImage(e,0,0,n,a),s}async function dst(e,t){let r=t||ws.getEnv().createCanvasElement(),[n,a,s]=e.shape.slice(Ql(e)?1:0),i=ce(()=>e.as3D(n,a,s).toInt());return await Y0.toPixels(i,r),i.dispose(),r}function Oz(e){let{Image:t,Canvas:r,Video:n}=ws.getEnv();return e instanceof t||e instanceof r||e instanceof n}function hst(e,t,r=!1){let{Image:n,Canvas:a}=ws.getEnv();if(!(e instanceof n||e instanceof a))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return RS({width:1,height:1});let s=Ure(e),i=t/Math.max(s.height,s.width),o=i*s.width,u=i*s.height,d=RS({width:t,height:t}),c=e instanceof a?e:Wre(e),h=Math.abs(o-u)/2,p=r&&o<u?h:0,f=r&&u<o?h:0;return c.width>0&&c.height>0&&zc(d).drawImage(c,p,f,o,u),d}var DS=class{constructor(e,t=!1){if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error(`NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ${e}`);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((r,n)=>{if(dw(r)){this._imageTensors[n]=r,this._inputDimensions[n]=r.shape;return}if(Ql(r)){let s=r.shape[0];if(s!==1)throw new Error(`NetInput - tf.Tensor4D with batchSize ${s} passed, but not supported in input array`);this._imageTensors[n]=r,this._inputDimensions[n]=r.shape.slice(1);return}let a=r instanceof ws.getEnv().Canvas?r:Wre(r);this._canvases[n]=a,this._inputDimensions[n]=[a.height,a.width,3]})}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return Sg(this.batchSize,0,1).map((e,t)=>this.getReshapedInputDimensions(t))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");let t=this.getInputWidth(e),r=this.getInputHeight(e);return Cre({width:t,height:r},this.inputSize)}toBatchTensor(e,t=!0){return this._inputSize=e,ce(()=>{let r=Sg(this.batchSize,0,1).map(n=>{let a=this.getInput(n);if(a instanceof Jt){let s=Ql(a)?a:la(a);return s=rst(s,t),(s.shape[1]!==e||s.shape[2]!==e)&&(s=li.resizeBilinear(s,[e,e],!1,!1)),s.as3D(e,e,3)}if(a instanceof ws.getEnv().Canvas)return Y0.fromPixels(hst(a,e,t));throw new Error(`toBatchTensor - at batchIdx ${n}, expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ${a}`)});return Bn(r.map(n=>Pe(n,"float32"))).as4D(this.batchSize,e,e,3)})}};async function ts(e){if(e instanceof DS)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let r=a=>Array.isArray(e)?` at input index ${a}:`:"",n=t.map(xO);return n.forEach((a,s)=>{if(!Oz(a)&&!dw(a)&&!Ql(a))throw typeof t[s]=="string"?new Error(`toNetInput -${r(s)} string passed, but could not resolve HTMLElement for element id ${t[s]}`):new Error(`toNetInput -${r(s)} expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id`);if(Ql(a)){let i=a.shape[0];if(i!==1)throw new Error(`toNetInput -${r(s)} tf.Tensor4D with batchSize ${i} passed, but not supported in input array`)}}),await Promise.all(n.map(a=>Oz(a)&&cst(a))),new DS(n,Array.isArray(e))}async function Vre(e,t){let{Canvas:r}=ws.getEnv(),n=e;if(!(e instanceof r)){let s=await ts(e);if(s.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let i=s.getInput(0);n=i instanceof r?i:await dst(i)}let a=zc(n);return t.map(s=>s instanceof $o?s.forSize(n.width,n.height).box.floor():s).map(s=>s.clipAtImageBorders(n.width,n.height)).map(({x:s,y:i,width:o,height:u})=>{let d=RS({width:o,height:u});return o>0&&u>0&&zc(d).putImageData(a.getImageData(s,i,o,u),0,0),d})}async function Hre(e,t){if(!dw(e)&&!Ql(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ql(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return ce(()=>{let[r,n,a]=e.shape.slice(Ql(e)?1:0);return t.map(s=>s instanceof $o?s.forSize(n,r).box:s).map(s=>s.clipAtImageBorders(n,r)).filter(s=>s.width>0&&s.height>0).map(({x:s,y:i,width:o,height:u})=>ay(e.as3D(r,n,a),[i,s,0],[u,o,a]))})}async function pst(e,t){let{fetch:r}=ws.getEnv(),n=await r(e,t);if(!(n.status<400))throw new Error(`failed to fetch: (${n.status}) ${n.statusText}, from url: ${n.url}`);return n}async function fst(e){return(await pst(e)).json()}function qre(e,t){let r=`${t}-weights_manifest.json`;if(!e)return{modelBaseUri:"",manifestUri:r};if(e==="/")return{modelBaseUri:"/",manifestUri:`/${r}`};let n=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(n,"");let a=e.split("/").filter(o=>o),s=e.endsWith(".json")?a[a.length-1]:r,i=n+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return i=e.startsWith("/")?`/${i}`:i,{modelBaseUri:i,manifestUri:i==="/"?`/${s}`:`${i}/${s}`}}async function mst(e,t){let{manifestUri:r,modelBaseUri:n}=qre(e,t),a=await fst(r);return Na.loadWeights(a,n)}var cd=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:r}=this.traversePropertyPath(e);return t[r]}reassignParamFromPath(e,t){let{obj:r,objProp:n}=this.traversePropertyPath(e);r[n].dispose(),r[n]=t}getParamList(){return this._paramMappings.map(({paramPath:e})=>({path:e,tensor:this.getParamFromPath(e)}))}getTrainableParams(){return this.getParamList().filter(e=>e.tensor instanceof _h)}getFrozenParams(){return this.getParamList().filter(e=>!(e.tensor instanceof _h))}variable(){this.getFrozenParams().forEach(({path:e,tensor:t})=>{this.reassignParamFromPath(e,t.variable())})}freeze(){this.getTrainableParams().forEach(({path:e,tensor:t})=>{let r=Qa(t.dataSync());t.dispose(),this.reassignParamFromPath(e,r)})}dispose(e=!0){this.getParamList().forEach(t=>{if(e&&t.tensor.isDisposed)throw new Error(`param tensor has already been disposed for path ${t.path}`);t.tensor.dispose()}),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map(({tensor:e})=>Array.from(e.dataSync())).reduce((e,t)=>e.concat(t)))}async load(e){if(e instanceof Float32Array){this.extractWeights(e);return}await this.loadFromUri(e)}async loadFromUri(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromUri - expected model uri`);let t=await mst(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromDisk - expected model file path`);let{readFile:t}=ws.getEnv(),{manifestUri:r,modelBaseUri:n}=qre(e,this.getDefaultModelName()),a=u=>Promise.all(u.map(d=>t(d).then(c=>typeof c=="string"?Buffer.from(c):c.buffer))),s=Na.weightsLoaderFactory(a),i=JSON.parse((await t(r)).toString()),o=await s(i,n);this.loadFromWeightMap(o)}loadFromWeightMap(e){let{paramMappings:t,params:r}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=r}extractWeights(e){let{paramMappings:t,params:r}=this.extractParams(e);this._paramMappings=t,this._params=r}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce((a,s)=>{if(!a.nextObj.hasOwnProperty(s))throw new Error(`traversePropertyPath - object does not have property ${s}, for path ${e}`);return{obj:a.nextObj,objProp:s,nextObj:a.nextObj[s]}},{nextObj:this.params}),{obj:r,objProp:n}=t;if(!r||!n||!(r[n]instanceof Jt))throw new Error(`traversePropertyPath - parameter is not a tensor, for path ${e}`);return{obj:r,objProp:n}}};function di(e,t,r){return ce(()=>{let n=ny(e,t.depthwise_filter,t.pointwise_filter,r,"same");return n=Ne(n,t.bias),n})}function mI(e,t,r=!1){return ce(()=>{let n=Tr(r?Ne(Za(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):di(e,t.conv0,[2,2])),a=di(n,t.conv1,[1,1]),s=Tr(Ne(n,a)),i=di(s,t.conv2,[1,1]);return Tr(Ne(n,Ne(a,i)))})}function v1(e,t,r=!1,n=!0){return ce(()=>{let a=Tr(r?Ne(Za(e,t.conv0.filters,n?[2,2]:[1,1],"same"),t.conv0.bias):di(e,t.conv0,n?[2,2]:[1,1])),s=di(a,t.conv1,[1,1]),i=Tr(Ne(a,s)),o=di(i,t.conv2,[1,1]),u=Tr(Ne(a,Ne(s,o))),d=di(u,t.conv3,[1,1]);return Tr(Ne(a,Ne(s,Ne(o,d))))})}function Cv(e,t,r="same",n=!1){return ce(()=>{let a=Ne(Za(e,t.filters,[1,1],r),t.bias);return n?Tr(a):a})}function dd(e,t){Object.keys(e).forEach(r=>{t.some(n=>n.originalPath===r)||e[r].dispose()})}function bO(e,t){return(r,n,a,s)=>{let i=Rc(e(r*n*a*a),[a,a,r,n]),o=Cr(e(n));return t.push({paramPath:`${s}/filters`},{paramPath:`${s}/bias`}),{filters:i,bias:o}}}function Gre(e,t){return(r,n,a)=>{let s=ol(e(r*n),[r,n]),i=Cr(e(n));return t.push({paramPath:`${a}/weights`},{paramPath:`${a}/bias`}),{weights:s,bias:i}}}var Kre=class{constructor(e,t,r){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=r}};function wO(e,t){return(r,n,a)=>{let s=Rc(e(9*r),[3,3,r,1]),i=Rc(e(r*n),[1,1,r,n]),o=Cr(e(n));return t.push({paramPath:`${a}/depthwise_filter`},{paramPath:`${a}/pointwise_filter`},{paramPath:`${a}/bias`}),new Kre(s,i,o)}}function NO(e){return t=>{let r=e(`${t}/depthwise_filter`,4),n=e(`${t}/pointwise_filter`,4),a=e(`${t}/bias`,1);return new Kre(r,n,a)}}function Cf(e,t){return(r,n,a)=>{let s=e[r];if(!yy(s,n))throw new Error(`expected weightMap[${r}] to be a Tensor${n}D, instead have ${s}`);return t.push({originalPath:r,paramPath:a||r}),s}}function hd(e){let t=e;function r(a){let s=t.slice(0,a);return t=t.slice(a),s}function n(){return t}return{extractWeights:r,getRemainingWeights:n}}function Qre(e,t){let r=bO(e,t),n=wO(e,t);function a(i,o,u,d=!1){let c=d?r(i,o,3,`${u}/conv0`):n(i,o,`${u}/conv0`),h=n(o,o,`${u}/conv1`),p=n(o,o,`${u}/conv2`);return{conv0:c,conv1:h,conv2:p}}function s(i,o,u,d=!1){let{conv0:c,conv1:h,conv2:p}=a(i,o,u,d),f=n(o,o,`${u}/conv3`);return{conv0:c,conv1:h,conv2:p,conv3:f}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:s}}function gst(e){let t=[],{extractWeights:r,getRemainingWeights:n}=hd(e),{extractDenseBlock4Params:a}=Qre(r,t),s=a(3,32,"dense0",!0),i=a(32,64,"dense1"),o=a(64,128,"dense2"),u=a(128,256,"dense3");if(n().length!==0)throw new Error(`weights remaing after extract: ${n().length}`);return{paramMappings:t,params:{dense0:s,dense1:i,dense2:o,dense3:u}}}function Xre(e){return t=>{let r=e(`${t}/filters`,4),n=e(`${t}/bias`,1);return{filters:r,bias:n}}}function Yre(e,t){let r=Cf(e,t),n=Xre(r),a=NO(r);function s(o,u=!1){let d=u?n(`${o}/conv0`):a(`${o}/conv0`),c=a(`${o}/conv1`),h=a(`${o}/conv2`);return{conv0:d,conv1:c,conv2:h}}function i(o,u=!1){let d=u?n(`${o}/conv0`):a(`${o}/conv0`),c=a(`${o}/conv1`),h=a(`${o}/conv2`),p=a(`${o}/conv3`);return{conv0:d,conv1:c,conv2:h,conv3:p}}return{extractDenseBlock3Params:s,extractDenseBlock4Params:i}}function xst(e){let t=[],{extractDenseBlock4Params:r}=Yre(e,t),n={dense0:r("dense0",!0),dense1:r("dense1"),dense2:r("dense2"),dense3:r("dense3")};return dd(e,t),{params:n,paramMappings:t}}var Jre=class extends cd{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return ce(()=>{let r=Pe(e.toBatchTensor(112,!0),"float32"),n=hw(r,[122.782,117.001,104.298]).div(255),a=v1(n,t.dense0,!0);return a=v1(a,t.dense1),a=v1(a,t.dense2),a=v1(a,t.dense3),a=hu(a,[7,7],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await ts(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return xst(e)}extractParams(e){return gst(e)}};function kj(e,t){return ce(()=>Ne(Gt(e,t.weights),t.bias))}function yst(e,t,r){let n=[],{extractWeights:a,getRemainingWeights:s}=hd(e),i=Gre(a,n)(t,r,"fc");if(s().length!==0)throw new Error(`weights remaing after extract: ${s().length}`);return{paramMappings:n,params:{fc:i}}}function vst(e){let t=[],r=Cf(e,t);function n(s){let i=r(`${s}/weights`,2),o=r(`${s}/bias`,1);return{weights:i,bias:o}}let a={fc:n("fc")};return dd(e,t),{params:a,paramMappings:t}}function Zre(e){let t={},r={};return Object.keys(e).forEach(n=>{let a=n.startsWith("fc")?r:t;a[n]=e[n]}),{featureExtractorMap:t,classifierMap:r}}var ene=class extends cd{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return ce(()=>{let r=e instanceof DS?this.faceFeatureExtractor.forwardInput(e):e;return kj(r.as2D(r.shape[0],-1),t.fc)})}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:r}=this.extractClassifierParams(e);this._params=t,this._paramMappings=r}extractClassifierParams(e){return yst(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:r}=Zre(e);return this.faceFeatureExtractor.loadFromWeightMap(t),vst(r)}extractParams(e){let t=this.getClassifierChannelsIn(),r=this.getClassifierChannelsOut(),n=r*t+r,a=e.slice(0,e.length-n),s=e.slice(e.length-n);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)}},Pz=["neutral","happy","sad","angry","fearful","disgusted","surprised"],SO=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,e.length!==7)throw new Error(`FaceExpressions.constructor - expected probabilities.length to be 7, have: ${e.length}`);Pz.forEach((t,r)=>{this[t]=e[r]})}asSortedArray(){return Pz.map(e=>({expression:e,probability:this[e]})).sort((e,t)=>t.probability-e.probability)}},bst=class extends ene{constructor(e=new Jre){super("FaceExpressionNet",e)}forwardInput(e){return ce(()=>ad(this.runNet(e)))}async forward(e){return this.forwardInput(await ts(e))}async predictExpressions(e){let t=await ts(e),r=await this.forwardInput(t),n=await Promise.all(Cn(r).map(async s=>{let i=s.dataSync();return s.dispose(),i}));r.dispose();let a=n.map(s=>new SO(s));return t.isBatchInput?a:a[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}};function wst(e){return e.expressions instanceof SO}function Nst(e,t){return{...e,expressions:t}}function Sst(e,t,r=.1,n){(Array.isArray(t)?t:[t]).forEach(a=>{let s=a instanceof SO?a:wst(a)?a.expressions:void 0;if(!s)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let i=s.asSortedArray().filter(u=>u.probability>r),o=$S(a)?a.detection.box.bottomLeft:n||new Mr(0,0);new vO(i.map(u=>`${u.expression} (${pO(u.probability)})`),o).draw(e)})}function tne(e){return $S(e)&&e.landmarks instanceof AS&&e.unshiftedLandmarks instanceof AS&&e.alignedRect instanceof $o}function _st(e){let t=u=>u*180/Math.PI,r=(u,d)=>Math.sqrt((u.x-d.x)**2+(u.y-d.y)**2),n={roll:void 0,pitch:void 0,yaw:void 0},a=(u,d,c)=>{let h=Math.floor(u.x-d.x),p=Math.floor(d.x-c.x);return h-p},s=(u,d)=>{let c=Math.hypot(d.x-u.x,d.y-u.y),h=d.y-u.y,p=Math.asin(h/c),f=t(p),g=Math.floor(90-f),m=d.x-u.x<0?-1:1;return g*m},i=(u,d,c)=>{let h=r(u,c),p=new Mr((u.x+c.x)/2,(u.y+c.y)/2),f=r(d,p),g=Math.atan(f/h),m=Math.floor(t(g)),x=p.y-d.y<0?-1:1;return m*x};if(!e||!e.positions||e.positions.length!==68)return n;let o=e.positions;return n.roll=s(o[27],o[66]),n.pitch=i(o[14],o[30],o[2]),n.yaw=a(o[14],o[33],o[2]),n}function kst(e,t){let{box:r}=e.detection,n=t.shiftBy(r.x,r.y),a=n.align(),{imageDims:s}=e.detection,i=new $o(e.detection.score,a.rescale(s.reverse()),s),o=_st(t);return{...e,landmarks:n,unshiftedLandmarks:t,alignedRect:i,angle:o}}var rne=class{constructor(e={}){let{drawLines:t=!0,drawPoints:r=!0,lineWidth:n,lineColor:a,pointSize:s,pointColor:i}=e;this.drawLines=t,this.drawPoints=r,this.lineWidth=n||1,this.pointSize=s||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=i||"rgba(255, 0, 255, 1)"}},nne=class{constructor(e,t={}){this.faceLandmarks=e,this.options=new rne(t)}draw(e){let t=zc(e),{drawLines:r,drawPoints:n,lineWidth:a,lineColor:s,pointSize:i,pointColor:o}=this.options;if(r&&this.faceLandmarks instanceof $re&&(t.strokeStyle=s,t.lineWidth=a,$u(t,this.faceLandmarks.getJawOutline()),$u(t,this.faceLandmarks.getLeftEyeBrow()),$u(t,this.faceLandmarks.getRightEyeBrow()),$u(t,this.faceLandmarks.getNose()),$u(t,this.faceLandmarks.getLeftEye(),!0),$u(t,this.faceLandmarks.getRightEye(),!0),$u(t,this.faceLandmarks.getMouth(),!0)),n){t.strokeStyle=o,t.fillStyle=o;let u=d=>{t.beginPath(),t.arc(d.x,d.y,i,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(u)}}};function Cst(e,t){(Array.isArray(t)?t:[t]).forEach(r=>{let n=r instanceof AS?r:tne(r)?r.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new nne(n).draw(e)})}function Ist(e,t){let r=bO(e,t),n=wO(e,t);function a(i,o,u){let d=n(i,o,`${u}/separable_conv0`),c=n(o,o,`${u}/separable_conv1`),h=r(i,o,1,`${u}/expansion_conv`);return{separable_conv0:d,separable_conv1:c,expansion_conv:h}}function s(i,o){let u=n(i,i,`${o}/separable_conv0`),d=n(i,i,`${o}/separable_conv1`),c=n(i,i,`${o}/separable_conv2`);return{separable_conv0:u,separable_conv1:d,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:n,extractReductionBlockParams:a,extractMainBlockParams:s}}function Est(e,t){let r=[],{extractWeights:n,getRemainingWeights:a}=hd(e),{extractConvParams:s,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:u}=Ist(n,r),d=s(3,32,3,"entry_flow/conv_in"),c=o(32,64,"entry_flow/reduction_block_0"),h=o(64,128,"entry_flow/reduction_block_1"),p={conv_in:d,reduction_block_0:c,reduction_block_1:h},f={};Sg(t,0,1).forEach(y=>{f[`main_block_${y}`]=u(128,`middle_flow/main_block_${y}`)});let g=o(128,256,"exit_flow/reduction_block"),m=i(256,512,"exit_flow/separable_conv"),x={reduction_block:g,separable_conv:m};if(a().length!==0)throw new Error(`weights remaing after extract: ${a().length}`);return{paramMappings:r,params:{entry_flow:p,middle_flow:f,exit_flow:x}}}function Tst(e,t){let r=Cf(e,t),n=Xre(r),a=NO(r);function s(o){let u=a(`${o}/separable_conv0`),d=a(`${o}/separable_conv1`),c=n(`${o}/expansion_conv`);return{separable_conv0:u,separable_conv1:d,expansion_conv:c}}function i(o){let u=a(`${o}/separable_conv0`),d=a(`${o}/separable_conv1`),c=a(`${o}/separable_conv2`);return{separable_conv0:u,separable_conv1:d,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:s,extractMainBlockParams:i}}function jst(e,t){let r=[],{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:s,extractMainBlockParams:i}=Tst(e,r),o=n("entry_flow/conv_in"),u=s("entry_flow/reduction_block_0"),d=s("entry_flow/reduction_block_1"),c={conv_in:o,reduction_block_0:u,reduction_block_1:d},h={};Sg(t,0,1).forEach(m=>{h[`main_block_${m}`]=i(`middle_flow/main_block_${m}`)});let p=s("exit_flow/reduction_block"),f=a("exit_flow/separable_conv"),g={reduction_block:p,separable_conv:f};return dd(e,r),{params:{entry_flow:c,middle_flow:h,exit_flow:g},paramMappings:r}}function ane(e,t,r){return Ne(Za(e,t.filters,r,"same"),t.bias)}function gI(e,t,r=!0){let n=r?Tr(e):e;return n=di(n,t.separable_conv0,[1,1]),n=di(Tr(n),t.separable_conv1,[1,1]),n=na(n,[3,3],[2,2],"same"),n=Ne(n,ane(e,t.expansion_conv,[2,2])),n}function Ast(e,t){let r=di(Tr(e),t.separable_conv0,[1,1]);return r=di(Tr(r),t.separable_conv1,[1,1]),r=di(Tr(r),t.separable_conv2,[1,1]),r=Ne(r,e),r}var $st=class extends cd{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return ce(()=>{let r=Pe(e.toBatchTensor(112,!0),"float32"),n=hw(r,[122.782,117.001,104.298]).div(255),a=Tr(ane(n,t.entry_flow.conv_in,[2,2]));return a=gI(a,t.entry_flow.reduction_block_0,!1),a=gI(a,t.entry_flow.reduction_block_1),Sg(this._numMainBlocks,0,1).forEach(s=>{a=Ast(a,t.middle_flow[`main_block_${s}`])}),a=gI(a,t.exit_flow.reduction_block),a=Tr(di(a,t.exit_flow.separable_conv,[1,1])),a})}async forward(e){return this.forwardInput(await ts(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return jst(e,this._numMainBlocks)}extractParams(e){return Est(e,this._numMainBlocks)}};function Rst(e){let t=[],{extractWeights:r,getRemainingWeights:n}=hd(e),a=Gre(r,t),s=a(512,1,"fc/age"),i=a(512,2,"fc/gender");if(n().length!==0)throw new Error(`weights remaing after extract: ${n().length}`);return{paramMappings:t,params:{fc:{age:s,gender:i}}}}function Dst(e){let t=[],r=Cf(e,t);function n(s){let i=r(`${s}/weights`,2),o=r(`${s}/bias`,1);return{weights:i,bias:o}}let a={fc:{age:n("fc/age"),gender:n("fc/gender")}};return dd(e,t),{params:a,paramMappings:t}}var Mst=(e=>(e.FEMALE="female",e.MALE="male",e))(Mst||{}),Fst=class extends cd{constructor(e=new $st(2)){super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return ce(()=>{let r=e instanceof DS?this.faceFeatureExtractor.forwardInput(e):e,n=hu(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1),a=kj(n,t.fc.age).as1D(),s=kj(n,t.fc.gender);return{age:a,gender:s}})}forwardInput(e){return ce(()=>{let{age:t,gender:r}=this.runNet(e);return{age:t,gender:ad(r)}})}async forward(e){return this.forwardInput(await ts(e))}async predictAgeAndGender(e){let t=await ts(e),r=await this.forwardInput(t),n=Cn(r.age),a=Cn(r.gender),s=n.map((o,u)=>({ageTensor:o,genderTensor:a[u]})),i=await Promise.all(s.map(async({ageTensor:o,genderTensor:u})=>{let d=o.dataSync()[0],c=u.dataSync()[0],h=c>.5,p=h?"male":"female",f=h?c:1-c;return o.dispose(),u.dispose(),{age:d,gender:p,genderProbability:f}}));return r.age.dispose(),r.gender.dispose(),t.isBatchInput?i:i[0]}getDefaultModelName(){return"age_gender_model"}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:r}=this.extractClassifierParams(e);this._params=t,this._paramMappings=r}extractClassifierParams(e){return Rst(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:r}=Zre(e);return this.faceFeatureExtractor.loadFromWeightMap(t),Dst(r)}extractParams(e){let t=e.slice(0,e.length-1539),r=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(r)}},sne=class extends ene{postProcess(e,t,r){let n=r.map(({width:s,height:i})=>{let o=t/Math.max(i,s);return{width:s*o,height:i*o}}),a=n.length;return ce(()=>{let s=(d,c)=>Bn([Qs([68],d,"float32"),Qs([68],c,"float32")],1).as2D(1,136).as1D(),i=(d,c)=>{let{width:h,height:p}=n[d];return c(h,p)?Math.abs(h-p)/2:0},o=d=>i(d,(c,h)=>c<h),u=d=>i(d,(c,h)=>h<c);return e.mul(Qs([a,136],t,"float32")).sub(Bn(Array.from(Array(a),(d,c)=>s(o(c),u(c))))).div(Bn(Array.from(Array(a),(d,c)=>s(n[c].width,n[c].height))))})}forwardInput(e){return ce(()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map(([r,n])=>({height:r,width:n})))})}async forward(e){return this.forwardInput(await ts(e))}async detectLandmarks(e){let t=await ts(e),r=ce(()=>Cn(this.forwardInput(t))),n=await Promise.all(r.map(async(a,s)=>{let i=Array.from(a.dataSync()),o=i.filter((d,c)=>Nj(c)),u=i.filter((d,c)=>!Nj(c));return new $re(Array(68).fill(0).map((d,c)=>new Mr(o[c],u[c])),{height:t.getInputHeight(s),width:t.getInputWidth(s)})}));return r.forEach(a=>a.dispose()),t.isBatchInput?n:n[0]}getClassifierChannelsOut(){return 136}},Ost=class extends sne{constructor(e=new Jre){super("FaceLandmark68Net",e)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}};function Pst(e){let t=[],{extractDenseBlock3Params:r}=Yre(e,t),n={dense0:r("dense0",!0),dense1:r("dense1"),dense2:r("dense2")};return dd(e,t),{params:n,paramMappings:t}}function Lst(e){let t=[],{extractWeights:r,getRemainingWeights:n}=hd(e),{extractDenseBlock3Params:a}=Qre(r,t),s=a(3,32,"dense0",!0),i=a(32,64,"dense1"),o=a(64,128,"dense2");if(n().length!==0)throw new Error(`weights remaing after extract: ${n().length}`);return{paramMappings:t,params:{dense0:s,dense1:i,dense2:o}}}var zst=class extends cd{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ce(()=>{let r=Pe(e.toBatchTensor(112,!0),"float32"),n=hw(r,[122.782,117.001,104.298]).div(255),a=mI(n,t.dense0,!0);return a=mI(a,t.dense1),a=mI(a,t.dense2),a=hu(a,[14,14],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await ts(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return Pst(e)}extractParams(e){return Lst(e)}},Bst=class extends sne{constructor(e=new zst){super("FaceLandmark68TinyNet",e)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}};function Ust(e,t){return Ne(oe(e,t.weights),t.biases)}function _O(e,t,r,n,a="same"){let{filters:s,bias:i}=t.conv,o=Za(e,s,r,a);return o=Ne(o,i),o=Ust(o,t.scale),n?Tr(o):o}function Wst(e,t){return _O(e,t,[1,1],!0)}function ine(e,t){return _O(e,t,[1,1],!1)}function one(e,t){return _O(e,t,[2,2],!0,"valid")}function Vst(e,t){function r(o,u,d){let c=e(o),h=c.length/(u*d*d);if(kre(h))throw new Error(`depth has to be an integer: ${h}, weights.length: ${c.length}, numFilters: ${u}, filterSize: ${d}`);return ce(()=>Kt(Rc(c,[u,h,d,d]),[2,3,1,0]))}function n(o,u,d,c){let h=r(o,u,d),p=Cr(e(u));return t.push({paramPath:`${c}/filters`},{paramPath:`${c}/bias`}),{filters:h,bias:p}}function a(o,u){let d=Cr(e(o)),c=Cr(e(o));return t.push({paramPath:`${u}/weights`},{paramPath:`${u}/biases`}),{weights:d,biases:c}}function s(o,u,d,c){let h=n(o,u,d,`${c}/conv`),p=a(u,`${c}/scale`);return{conv:h,scale:p}}function i(o,u,d,c,h=!1){let p=s((h?.5:1)*o,u,d,`${c}/conv1`),f=s(o,u,d,`${c}/conv2`);return{conv1:p,conv2:f}}return{extractConvLayerParams:s,extractResidualLayerParams:i}}function Hst(e){let{extractWeights:t,getRemainingWeights:r}=hd(e),n=[],{extractConvLayerParams:a,extractResidualLayerParams:s}=Vst(t,n),i=a(4704,32,7,"conv32_down"),o=s(9216,32,3,"conv32_1"),u=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),c=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),f=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),m=s(147456,128,3,"conv128_1"),x=s(147456,128,3,"conv128_2"),y=s(589824,256,3,"conv256_down",!0),v=s(589824,256,3,"conv256_1"),b=s(589824,256,3,"conv256_2"),N=s(589824,256,3,"conv256_down_out"),S=ce(()=>Kt(ol(t(256*128),[128,256]),[1,0]));if(n.push({paramPath:"fc"}),r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{params:{conv32_down:i,conv32_1:o,conv32_2:u,conv32_3:d,conv64_down:c,conv64_1:h,conv64_2:p,conv64_3:f,conv128_down:g,conv128_1:m,conv128_2:x,conv256_down:y,conv256_1:v,conv256_2:b,conv256_down_out:N,fc:S},paramMappings:n}}function qst(e,t){let r=Cf(e,t);function n(i){let o=r(`${i}/scale/weights`,1),u=r(`${i}/scale/biases`,1);return{weights:o,biases:u}}function a(i){let o=r(`${i}/conv/filters`,4),u=r(`${i}/conv/bias`,1),d=n(i);return{conv:{filters:o,bias:u},scale:d}}function s(i){return{conv1:a(`${i}/conv1`),conv2:a(`${i}/conv2`)}}return{extractConvLayerParams:a,extractResidualLayerParams:s}}function Gst(e){let t=[],{extractConvLayerParams:r,extractResidualLayerParams:n}=qst(e,t),a=r("conv32_down"),s=n("conv32_1"),i=n("conv32_2"),o=n("conv32_3"),u=n("conv64_down"),d=n("conv64_1"),c=n("conv64_2"),h=n("conv64_3"),p=n("conv128_down"),f=n("conv128_1"),g=n("conv128_2"),m=n("conv256_down"),x=n("conv256_1"),y=n("conv256_2"),v=n("conv256_down_out"),{fc:b}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!_re(b))throw new Error(`expected weightMap[fc] to be a Tensor2D, instead have ${b}`);let N={conv32_down:a,conv32_1:s,conv32_2:i,conv32_3:o,conv64_down:u,conv64_1:d,conv64_2:c,conv64_3:h,conv128_down:p,conv128_1:f,conv128_2:g,conv256_down:m,conv256_1:x,conv256_2:y,conv256_down_out:v,fc:b};return dd(e,t),{params:N,paramMappings:t}}function zo(e,t){let r=Wst(e,t.conv1);return r=ine(r,t.conv2),r=Ne(r,e),r=Tr(r),r}function b1(e,t){let r=one(e,t.conv1);r=ine(r,t.conv2);let n=hu(e,2,2,"valid"),a=gn(n.shape),s=n.shape[3]!==r.shape[3];if(n.shape[1]!==r.shape[1]||n.shape[2]!==r.shape[2]){let i=[...r.shape];i[1]=1;let o=gn(i);r=zr([r,o],1);let u=[...r.shape];u[2]=1;let d=gn(u);r=zr([r,d],2)}return n=s?zr([n,a],3):n,r=Ne(n,r),r=Tr(r),r}var Kst=class extends cd{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return ce(()=>{let r=Pe(e.toBatchTensor(150,!0),"float32"),n=hw(r,[122.782,117.001,104.298]).div(255),a=one(n,t.conv32_down);a=na(a,3,2,"valid"),a=zo(a,t.conv32_1),a=zo(a,t.conv32_2),a=zo(a,t.conv32_3),a=b1(a,t.conv64_down),a=zo(a,t.conv64_1),a=zo(a,t.conv64_2),a=zo(a,t.conv64_3),a=b1(a,t.conv128_down),a=zo(a,t.conv128_1),a=zo(a,t.conv128_2),a=b1(a,t.conv256_down),a=zo(a,t.conv256_1),a=zo(a,t.conv256_2),a=b1(a,t.conv256_down_out);let s=a.mean([1,2]);return Gt(s,t.fc)})}async forward(e){return this.forwardInput(await ts(e))}async computeFaceDescriptor(e){var t;if((t=e==null?void 0:e.shape)!=null&&t.some(s=>s<=0))return new Float32Array(128);let r=await ts(e),n=ce(()=>Cn(this.forwardInput(r))),a=await Promise.all(n.map(s=>s.data()));return n.forEach(s=>s.dispose()),r.isBatchInput?a:a[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return Gst(e)}extractParams(e){return Hst(e)}};function Qst(e,t){return{...e,descriptor:t}}function Xst(e,t){return{...e,age:t}}function Yst(e,t,r){return{...e,gender:t,genderProbability:r}}function Jst(e,t){function r(u,d){let c=Rc(e(9*u),[3,3,u,1]),h=Cr(e(u)),p=Cr(e(u)),f=Cr(e(u)),g=Cr(e(u));return t.push({paramPath:`${d}/filters`},{paramPath:`${d}/batch_norm_scale`},{paramPath:`${d}/batch_norm_offset`},{paramPath:`${d}/batch_norm_mean`},{paramPath:`${d}/batch_norm_variance`}),{filters:c,batch_norm_scale:h,batch_norm_offset:p,batch_norm_mean:f,batch_norm_variance:g}}function n(u,d,c,h,p){let f=Rc(e(u*d*c*c),[c,c,u,d]),g=Cr(e(d));return t.push({paramPath:`${h}/filters`},{paramPath:`${h}/${p?"batch_norm_offset":"bias"}`}),{filters:f,bias:g}}function a(u,d,c,h){let{filters:p,bias:f}=n(u,d,c,h,!0);return{filters:p,batch_norm_offset:f}}function s(u,d,c){let h=r(u,`${c}/depthwise_conv`),p=a(u,d,1,`${c}/pointwise_conv`);return{depthwise_conv:h,pointwise_conv:p}}function i(){let u=a(3,32,3,"mobilenetv1/conv_0"),d=s(32,64,"mobilenetv1/conv_1"),c=s(64,128,"mobilenetv1/conv_2"),h=s(128,128,"mobilenetv1/conv_3"),p=s(128,256,"mobilenetv1/conv_4"),f=s(256,256,"mobilenetv1/conv_5"),g=s(256,512,"mobilenetv1/conv_6"),m=s(512,512,"mobilenetv1/conv_7"),x=s(512,512,"mobilenetv1/conv_8"),y=s(512,512,"mobilenetv1/conv_9"),v=s(512,512,"mobilenetv1/conv_10"),b=s(512,512,"mobilenetv1/conv_11"),N=s(512,1024,"mobilenetv1/conv_12"),S=s(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:d,conv_2:c,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:m,conv_8:x,conv_9:y,conv_10:v,conv_11:b,conv_12:N,conv_13:S}}function o(){let u=a(1024,256,1,"prediction_layer/conv_0"),d=a(256,512,3,"prediction_layer/conv_1"),c=a(512,128,1,"prediction_layer/conv_2"),h=a(128,256,3,"prediction_layer/conv_3"),p=a(256,128,1,"prediction_layer/conv_4"),f=a(128,256,3,"prediction_layer/conv_5"),g=a(256,64,1,"prediction_layer/conv_6"),m=a(64,128,3,"prediction_layer/conv_7"),x=n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),y=n(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),v=n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),N=n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),S=n(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),_=n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),C=n(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),k=n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),I=n(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),T=n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),j=n(128,18,1,"prediction_layer/box_predictor_5/class_predictor");return{conv_0:u,conv_1:d,conv_2:c,conv_3:h,conv_4:p,conv_5:f,conv_6:g,conv_7:m,box_predictor_0:{box_encoding_predictor:x,class_predictor:y},box_predictor_1:{box_encoding_predictor:v,class_predictor:b},box_predictor_2:{box_encoding_predictor:N,class_predictor:S},box_predictor_3:{box_encoding_predictor:_,class_predictor:C},box_predictor_4:{box_encoding_predictor:k,class_predictor:I},box_predictor_5:{box_encoding_predictor:T,class_predictor:j}}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:o}}function Zst(e){let t=[],{extractWeights:r,getRemainingWeights:n}=hd(e),{extractMobilenetV1Params:a,extractPredictionLayerParams:s}=Jst(r,t),i=a(),o=s(),u={extra_dim:Xk(r(5118*4),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),n().length!==0)throw new Error(`weights remaing after extract: ${n().length}`);return{params:{mobilenetv1:i,prediction_layer:o,output_layer:u},paramMappings:t}}function eit(e,t){let r=Cf(e,t);function n(d,c,h){let p=r(`${d}/Conv2d_${c}_pointwise/weights`,4,`${h}/filters`),f=r(`${d}/Conv2d_${c}_pointwise/convolution_bn_offset`,1,`${h}/batch_norm_offset`);return{filters:p,batch_norm_offset:f}}function a(d){let c=`mobilenetv1/conv_${d}`,h=`MobilenetV1/Conv2d_${d}_depthwise`,p=`${c}/depthwise_conv`,f=`${c}/pointwise_conv`,g=r(`${h}/depthwise_weights`,4,`${p}/filters`),m=r(`${h}/BatchNorm/gamma`,1,`${p}/batch_norm_scale`),x=r(`${h}/BatchNorm/beta`,1,`${p}/batch_norm_offset`),y=r(`${h}/BatchNorm/moving_mean`,1,`${p}/batch_norm_mean`),v=r(`${h}/BatchNorm/moving_variance`,1,`${p}/batch_norm_variance`);return{depthwise_conv:{filters:g,batch_norm_scale:m,batch_norm_offset:x,batch_norm_mean:y,batch_norm_variance:v},pointwise_conv:n("MobilenetV1",d,f)}}function s(){return{conv_0:n("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function i(d,c){let h=r(`${d}/weights`,4,`${c}/filters`),p=r(`${d}/biases`,1,`${c}/bias`);return{filters:h,bias:p}}function o(d){let c=i(`Prediction/BoxPredictor_${d}/BoxEncodingPredictor`,`prediction_layer/box_predictor_${d}/box_encoding_predictor`),h=i(`Prediction/BoxPredictor_${d}/ClassPredictor`,`prediction_layer/box_predictor_${d}/class_predictor`);return{box_encoding_predictor:c,class_predictor:h}}function u(){return{conv_0:n("Prediction",0,"prediction_layer/conv_0"),conv_1:n("Prediction",1,"prediction_layer/conv_1"),conv_2:n("Prediction",2,"prediction_layer/conv_2"),conv_3:n("Prediction",3,"prediction_layer/conv_3"),conv_4:n("Prediction",4,"prediction_layer/conv_4"),conv_5:n("Prediction",5,"prediction_layer/conv_5"),conv_6:n("Prediction",6,"prediction_layer/conv_6"),conv_7:n("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:u}}function tit(e){let t=[],{extractMobilenetV1Params:r,extractPredictionLayerParams:n}=eit(e,t),a=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!dw(a))throw new Error(`expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ${a}`);let s={mobilenetv1:r(),prediction_layer:n(),output_layer:{extra_dim:a}};return dd(e,t),{params:s,paramMappings:t}}function Vo(e,t,r){return ce(()=>{let n=Za(e,t.filters,r,"same");return n=Ne(n,t.batch_norm_offset),Ma(n,0,6)})}var rit=.0010000000474974513;function nit(e,t,r){return ce(()=>{let n=gf(e,t.filters,r,"same");return n=mf(n,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,rit),Ma(n,0,6)})}function ait(e){return[2,4,6,12].some(t=>t===e)?[2,2]:[1,1]}function sit(e,t){return ce(()=>{let r,n=Vo(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((a,s)=>{let i=s+1,o=ait(i);n=nit(n,a.depthwise_conv,o),n=Vo(n,a.pointwise_conv,[1,1]),i===11&&(r=n)}),r===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:n,conv11:r}})}function iit(e,t,r){let n=e.arraySync(),a=Math.min(n[t][0],n[t][2]),s=Math.min(n[t][1],n[t][3]),i=Math.max(n[t][0],n[t][2]),o=Math.max(n[t][1],n[t][3]),u=Math.min(n[r][0],n[r][2]),d=Math.min(n[r][1],n[r][3]),c=Math.max(n[r][0],n[r][2]),h=Math.max(n[r][1],n[r][3]),p=(i-a)*(o-s),f=(c-u)*(h-d);if(p<=0||f<=0)return 0;let g=Math.max(a,u),m=Math.max(s,d),x=Math.min(i,c),y=Math.min(o,h),v=Math.max(x-g,0)*Math.max(y-m,0);return v/(p+f-v)}function oit(e,t,r,n,a){let s=e.shape[0],i=Math.min(r,s),o=t.map((c,h)=>({score:c,boxIndex:h})).filter(c=>c.score>a).sort((c,h)=>h.score-c.score),u=c=>c<=n?1:0,d=[];return o.forEach(c=>{if(d.length>=i)return;let h=c.score;for(let p=d.length-1;p>=0;--p){let f=iit(e,c.boxIndex,d[p]);if(f!==0&&(c.score*=u(f),c.score<=a))break}h===c.score&&d.push(c.boxIndex)}),d}function lit(e){let t=Cn(Kt(e,[1,0])),r=[Ze(t[2],t[0]),Ze(t[3],t[1])],n=[Ne(t[0],it(r[0],2)),Ne(t[1],it(r[1],2))];return{sizes:r,centers:n}}function uit(e,t){let{sizes:r,centers:n}=lit(e),a=Cn(Kt(t,[1,0])),s=it(oe(Fa(it(a[2],5)),r[0]),2),i=Ne(oe(it(a[0],10),r[0]),n[0]),o=it(oe(Fa(it(a[3],5)),r[1]),2),u=Ne(oe(it(a[1],10),r[1]),n[1]);return Kt(Bn([Ze(i,s),Ze(u,o),Ne(i,s),Ne(u,o)]),[1,0])}function cit(e,t,r){return ce(()=>{let n=e.shape[0],a=uit(ue(Us(r.extra_dim,[n,1,1]),[-1,4]),ue(e,[-1,4]));a=ue(a,[n,a.shape[0]/n,4]);let s=Wi(ir(t,[0,0,1],[-1,-1,-1])),i=ir(s,[0,0,0],[-1,-1,1]);i=ue(i,[n,i.shape[1]]);let o=Cn(a),u=Cn(i);return{boxes:o,scores:u}})}function Wf(e,t){return ce(()=>{let r=e.shape[0],n=ue(Cv(e,t.box_encoding_predictor),[r,-1,1,4]),a=ue(Cv(e,t.class_predictor),[r,-1,3]);return{boxPredictionEncoding:n,classPrediction:a}})}function dit(e,t,r){return ce(()=>{let n=Vo(e,r.conv_0,[1,1]),a=Vo(n,r.conv_1,[2,2]),s=Vo(a,r.conv_2,[1,1]),i=Vo(s,r.conv_3,[2,2]),o=Vo(i,r.conv_4,[1,1]),u=Vo(o,r.conv_5,[2,2]),d=Vo(u,r.conv_6,[1,1]),c=Vo(d,r.conv_7,[2,2]),h=Wf(t,r.box_predictor_0),p=Wf(e,r.box_predictor_1),f=Wf(a,r.box_predictor_2),g=Wf(i,r.box_predictor_3),m=Wf(u,r.box_predictor_4),x=Wf(c,r.box_predictor_5),y=zr([h.boxPredictionEncoding,p.boxPredictionEncoding,f.boxPredictionEncoding,g.boxPredictionEncoding,m.boxPredictionEncoding,x.boxPredictionEncoding],1),v=zr([h.classPrediction,p.classPrediction,f.classPrediction,g.classPrediction,m.classPrediction,x.classPrediction],1);return{boxPredictions:y,classPredictions:v}})}var FC=class{constructor({minConfidence:e,maxResults:t}={}){if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(`${this._name} - expected minConfidence to be a number between 0 and 1`);if(typeof this._maxResults!="number")throw new Error(`${this._name} - expected maxResults to be a number`)}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},hit=class extends cd{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return ce(()=>{let r=Pe(e.toBatchTensor(512,!1),"float32"),n=Ze(it(r,127.5),1),a=sit(n,t.mobilenetv1),{boxPredictions:s,classPredictions:i}=dit(a.out,a.conv11,t.prediction_layer);return cit(s,i,t.output_layer)})}async forward(e){return this.forwardInput(await ts(e))}async locateFaces(e,t={}){let{maxResults:r,minConfidence:n}=new FC(t),a=await ts(e),{boxes:s,scores:i}=this.forwardInput(a),o=s[0],u=i[0];for(let y=1;y<s.length;y++)s[y].dispose(),i[y].dispose();let d=Array.from(u.dataSync()),c=oit(o,d,r,.5,n),h=a.getReshapedInputDimensions(0),p=a.inputSize,f=p/h.width,g=p/h.height,m=o.arraySync(),x=c.map(y=>{let[v,b]=[Math.max(0,m[y][0]),Math.min(1,m[y][2])].map(_=>_*g),[N,S]=[Math.max(0,m[y][1]),Math.min(1,m[y][3])].map(_=>_*f);return new $o(d[y],new Are(N,v,S-N,b-v),{height:a.getInputHeight(0),width:a.getInputWidth(0)})});return o.dispose(),u.dispose(),x}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return tit(e)}extractParams(e){return Zst(e)}},pit=.4,fit=[new Mr(.738768,.874946),new Mr(2.42204,2.65704),new Mr(4.30971,7.04493),new Mr(10.246,4.59428),new Mr(12.6868,11.8741)],mit=[new Mr(1.603231,2.094468),new Mr(6.041143,7.080126),new Mr(2.882459,3.518061),new Mr(4.266906,5.178857),new Mr(9.041765,10.66308)],git=[117.001,114.697,97.404],xit="tiny_yolov2_model",yit="tiny_yolov2_separable_conv_model",w1=e=>typeof e=="number";function vit(e){if(!e)throw new Error(`invalid config: ${e}`);if(typeof e.withSeparableConvs!="boolean")throw new Error(`config.withSeparableConvs has to be a boolean, have: ${e.withSeparableConvs}`);if(!w1(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error(`config.iouThreshold has to be a number between [0, 1], have: ${e.iouThreshold}`);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(t=>typeof t=="string"))throw new Error(`config.classes has to be an array class names: string[], have: ${JSON.stringify(e.classes)}`);if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(t=>t||{}).every(t=>w1(t.x)&&w1(t.y)))throw new Error(`config.anchors has to be an array of { x: number, y: number }, have: ${JSON.stringify(e.anchors)}`);if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(w1)))throw new Error(`config.meanRgb has to be an array of shape [number, number, number], have: ${JSON.stringify(e.meanRgb)}`)}function kO(e){return ce(()=>{let t=oe(e,bt(.10000000149011612));return Ne(Tr(Ze(e,t)),t)})}function ku(e,t){return ce(()=>{let r=Fo(e,[[0,0],[1,1],[1,1],[0,0]]);return r=Za(r,t.conv.filters,[1,1],"valid"),r=Ze(r,t.bn.sub),r=oe(r,t.bn.truediv),r=Ne(r,t.conv.bias),kO(r)})}function Cu(e,t){return ce(()=>{let r=Fo(e,[[0,0],[1,1],[1,1],[0,0]]);return r=ny(r,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),r=Ne(r,t.bias),kO(r)})}function bit(e,t){let r=bO(e,t);function n(i,o){let u=Cr(e(i)),d=Cr(e(i));return t.push({paramPath:`${o}/sub`},{paramPath:`${o}/truediv`}),{sub:u,truediv:d}}function a(i,o,u){let d=r(i,o,3,`${u}/conv`),c=n(o,`${u}/bn`);return{conv:d,bn:c}}let s=wO(e,t);return{extractConvParams:r,extractConvWithBatchNormParams:a,extractSeparableConvParams:s}}function wit(e,t,r,n){let{extractWeights:a,getRemainingWeights:s}=hd(e),i=[],{extractConvParams:o,extractConvWithBatchNormParams:u,extractSeparableConvParams:d}=bit(a,i),c;if(t.withSeparableConvs){let[h,p,f,g,m,x,y,v,b]=n,N=t.isFirstLayerConv2d?o(h,p,3,"conv0"):d(h,p,"conv0"),S=d(p,f,"conv1"),_=d(f,g,"conv2"),C=d(g,m,"conv3"),k=d(m,x,"conv4"),I=d(x,y,"conv5"),T=v?d(y,v,"conv6"):void 0,j=b?d(v,b,"conv7"):void 0,E=o(b||v||y,5*r,1,"conv8");c={conv0:N,conv1:S,conv2:_,conv3:C,conv4:k,conv5:I,conv6:T,conv7:j,conv8:E}}else{let[h,p,f,g,m,x,y,v,b]=n,N=u(h,p,"conv0"),S=u(p,f,"conv1"),_=u(f,g,"conv2"),C=u(g,m,"conv3"),k=u(m,x,"conv4"),I=u(x,y,"conv5"),T=u(y,v,"conv6"),j=u(v,b,"conv7"),E=o(b,5*r,1,"conv8");c={conv0:N,conv1:S,conv2:_,conv3:C,conv4:k,conv5:I,conv6:T,conv7:j,conv8:E}}if(s().length!==0)throw new Error(`weights remaing after extract: ${s().length}`);return{params:c,paramMappings:i}}function Nit(e,t){let r=Cf(e,t);function n(o){let u=r(`${o}/sub`,1),d=r(`${o}/truediv`,1);return{sub:u,truediv:d}}function a(o){let u=r(`${o}/filters`,4),d=r(`${o}/bias`,1);return{filters:u,bias:d}}function s(o){let u=a(`${o}/conv`),d=n(`${o}/bn`);return{conv:u,bn:d}}let i=NO(r);return{extractConvParams:a,extractConvWithBatchNormParams:s,extractSeparableConvParams:i}}function Sit(e,t){let r=[],{extractConvParams:n,extractConvWithBatchNormParams:a,extractSeparableConvParams:s}=Nit(e,r),i;if(t.withSeparableConvs){let o=t.filterSizes&&t.filterSizes.length||9;i={conv0:t.isFirstLayerConv2d?n("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:o>7?s("conv6"):void 0,conv7:o>8?s("conv7"):void 0,conv8:n("conv8")}}else i={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:n("conv8")};return dd(e,r),{params:i,paramMappings:r}}var CO=class{constructor({inputSize:e,scoreThreshold:t}={}){if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(`${this._name} - expected inputSize to be a number divisible by 32`);if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(`${this._name} - expected scoreThreshold to be a number between 0 and 1`)}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},lne=class une extends cd{constructor(t){super("TinyYolov2"),vit(t),this._config=t}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(t,r){let n=ku(t,r.conv0);return n=na(n,[2,2],[2,2],"same"),n=ku(n,r.conv1),n=na(n,[2,2],[2,2],"same"),n=ku(n,r.conv2),n=na(n,[2,2],[2,2],"same"),n=ku(n,r.conv3),n=na(n,[2,2],[2,2],"same"),n=ku(n,r.conv4),n=na(n,[2,2],[2,2],"same"),n=ku(n,r.conv5),n=na(n,[2,2],[1,1],"same"),n=ku(n,r.conv6),n=ku(n,r.conv7),Cv(n,r.conv8,"valid",!1)}runMobilenet(t,r){let n=this.config.isFirstLayerConv2d?kO(Cv(t,r.conv0,"valid",!1)):Cu(t,r.conv0);return n=na(n,[2,2],[2,2],"same"),n=Cu(n,r.conv1),n=na(n,[2,2],[2,2],"same"),n=Cu(n,r.conv2),n=na(n,[2,2],[2,2],"same"),n=Cu(n,r.conv3),n=na(n,[2,2],[2,2],"same"),n=Cu(n,r.conv4),n=na(n,[2,2],[2,2],"same"),n=Cu(n,r.conv5),n=na(n,[2,2],[1,1],"same"),n=r.conv6?Cu(n,r.conv6):n,n=r.conv7?Cu(n,r.conv7):n,Cv(n,r.conv8,"valid",!1)}forwardInput(t,r){let{params:n}=this;if(!n)throw new Error("TinyYolov2 - load model before inference");return ce(()=>{let a=Pe(t.toBatchTensor(r,!1),"float32");return a=this.config.meanRgb?hw(a,this.config.meanRgb):a,a=a.div(255),this.config.withSeparableConvs?this.runMobilenet(a,n):this.runTinyYolov2(a,n)})}async forward(t,r){return this.forwardInput(await ts(t),r)}async detect(t,r={}){let{inputSize:n,scoreThreshold:a}=new CO(r),s=await ts(t),i=await this.forwardInput(s,n),o=ce(()=>Cn(i)[0].expandDims()),u={width:s.getInputWidth(0),height:s.getInputHeight(0)},d=await this.extractBoxes(o,s.getReshapedInputDimensions(0),a);i.dispose(),o.dispose();let c=d.map(g=>g.box),h=d.map(g=>g.score),p=d.map(g=>g.classScore),f=d.map(g=>this.config.classes[g.label]);return tst(c.map(g=>g.rescale(n)),h,this.config.iouThreshold,!0).map(g=>new Ere(h[g],p[g],f[g],c[g],u))}getDefaultModelName(){return""}extractParamsFromWeightMap(t){return Sit(t,this.config)}extractParams(t){let r=this.config.filterSizes||une.DEFAULT_FILTER_SIZES,n=r?r.length:void 0;if(n!==7&&n!==8&&n!==9)throw new Error(`TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ${n} filterSizes in config`);return wit(t,this.config,this.boxEncodingSize,r)}async extractBoxes(t,r,n){let{width:a,height:s}=r,i=Math.max(a,s),o=i/a,u=i/s,d=t.shape[1],c=this.config.anchors.length,[h,p,f]=ce(()=>{let y=t.reshape([d,d,c,this.boxEncodingSize]),v=y.slice([0,0,0,0],[d,d,c,4]),b=y.slice([0,0,0,4],[d,d,c,1]),N=this.withClassScores?ad(y.slice([0,0,0,5],[d,d,c,this.config.classes.length]),3):bt(0);return[v,b,N]}),g=[],m=await p.array(),x=await h.array();for(let y=0;y<d;y++)for(let v=0;v<d;v++)for(let b=0;b<c;b++){let N=fI(m[y][v][b][0]);if(!n||N>n){let S=(v+fI(x[y][v][b][0]))/d*o,_=(y+fI(x[y][v][b][1]))/d*u,C=Math.exp(x[y][v][b][2])*this.config.anchors[b].x/d*o,k=Math.exp(x[y][v][b][3])*this.config.anchors[b].y/d*u,I=S-C/2,T=_-k/2,j={row:y,col:v,anchor:b},{classScore:E,label:O}=this.withClassScores?await this.extractPredictedClass(f,j):{classScore:1,label:0};g.push({box:new Ire(I,T,I+C,T+k),score:N,classScore:N*E,label:O,...j})}}return h.dispose(),p.dispose(),f.dispose(),g}async extractPredictedClass(t,r){let{row:n,col:a,anchor:s}=r,i=await t.array();return Array(this.config.classes.length).fill(0).map((o,u)=>i[n][a][s][u]).map((o,u)=>({classScore:o,label:u})).reduce((o,u)=>o.classScore>u.classScore?o:u)}};lne.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var cne=lne,_it=class extends cne{constructor(e=!0){let t={withSeparableConvs:e,iouThreshold:pit,classes:["face"],...e?{anchors:mit,meanRgb:git}:{anchors:fit,withClassScores:!0}};super(t)}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(r=>new $o(r.score,r.relativeBox,{width:r.imageWidth,height:r.imageHeight}))}getDefaultModelName(){return this.withSeparableConvs?yit:xit}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},dne=class extends CO{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},pw=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function IO(e,t,r,n,a=({alignedRect:s})=>s){let s=e.map(u=>tne(u)?a(u):u.detection),i=n||(t instanceof Jt?await Hre(t,s):await Vre(t,s)),o=await r(i);return i.forEach(u=>u instanceof Jt&&u.dispose()),o}var kit=.4,Cit=[new Mr(1.603231,2.094468),new Mr(6.041143,7.080126),new Mr(2.882459,3.518061),new Mr(4.266906,5.178857),new Mr(9.041765,10.66308)],Iit=[117.001,114.697,97.404],Eit=class extends cne{constructor(){let e={withSeparableConvs:!0,iouThreshold:kit,classes:["face"],anchors:Cit,meanRgb:Iit,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};super(e)}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(r=>new $o(r.score,r.relativeBox,{width:r.imageWidth,height:r.imageHeight}))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},ul={ssdMobilenetv1:new hit,tinyFaceDetector:new Eit,tinyYolov2:new _it,faceLandmark68Net:new Ost,faceLandmark68TinyNet:new Bst,faceRecognitionNet:new Kst,faceExpressionNet:new bst,ageGenderNet:new Fst},Tit=class extends pw{constructor(e,t,r){super(),this.parentTask=e,this.input=t,this.extractedFaces=r}},EO=class extends Tit{async run(){let e=await this.parentTask,t=await IO(e,this.input,async r=>Promise.all(r.map(n=>ul.faceExpressionNet.predictExpressions(n))),this.extractedFaces);return e.map((r,n)=>Nst(r,t[n]))}withAgeAndGender(){return new jO(this,this.input)}},TO=class extends EO{withAgeAndGender(){return new AO(this,this.input)}withFaceDescriptors(){return new $O(this,this.input)}},jit=class extends pw{constructor(e,t,r){super(),this.parentTask=e,this.input=t,this.extractedFaces=r}},jO=class extends jit{async run(){let e=await this.parentTask,t=await IO(e,this.input,async r=>Promise.all(r.map(n=>ul.ageGenderNet.predictAgeAndGender(n))),this.extractedFaces);return e.map((r,n)=>{let{age:a,gender:s,genderProbability:i}=t[n];return Xst(Yst(r,s,i),a)})}withFaceExpressions(){return new EO(this,this.input)}},AO=class extends jO{withFaceExpressions(){return new TO(this,this.input)}withFaceDescriptors(){return new $O(this,this.input)}},Ait=class extends pw{constructor(e,t){super(),this.parentTask=e,this.input=t}},$O=class extends Ait{async run(){let e=await this.parentTask;return(await IO(e,this.input,t=>Promise.all(t.map(r=>ul.faceRecognitionNet.computeFaceDescriptor(r))),null,t=>t.landmarks.align(null,{useDlibAlignment:!0}))).map((t,r)=>Qst(e[r],t))}withFaceExpressions(){return new TO(this,this.input)}withAgeAndGender(){return new AO(this,this.input)}},$it=class extends pw{constructor(e,t,r){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=r}get landmarkNet(){return this.useTinyLandmarkNet?ul.faceLandmark68TinyNet:ul.faceLandmark68Net}},Rit=class extends $it{async run(){let e=await this.parentTask,t=e.map(a=>a.detection),r=this.input instanceof Jt?await Hre(this.input,t):await Vre(this.input,t),n=await Promise.all(r.map(a=>this.landmarkNet.detectLandmarks(a)));return r.forEach(a=>a instanceof Jt&&a.dispose()),e.filter((a,s)=>n[s]).map((a,s)=>kst(a,n[s]))}withFaceExpressions(){return new TO(this,this.input)}withAgeAndGender(){return new AO(this,this.input)}withFaceDescriptors(){return new $O(this,this.input)}},Dit=class extends pw{constructor(e,t=new FC){super(),this.input=e,this.options=t}},Mit=class extends Dit{async run(){let{input:e,options:t}=this,r;if(t instanceof dne)r=ul.tinyFaceDetector.locateFaces(e,t);else if(t instanceof FC)r=ul.ssdMobilenetv1.locateFaces(e,t);else if(t instanceof CO)r=ul.tinyYolov2.locateFaces(e,t);else throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");return r}runAndExtendWithFaceDetections(){return new Promise((e,t)=>{this.run().then(r=>e(r.map(n=>ist({},n)))).catch(r=>t(r))})}withFaceLandmarks(e=!1){return new Rit(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new EO(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new jO(this.runAndExtendWithFaceDetections(),this.input)}};function Fit(e,t=new FC){return new Mit(e,t)}let Lz=!1;const Oit=async()=>{if(!Lz)try{const e="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/model";await Promise.all([ul.tinyFaceDetector.loadFromUri(e),ul.faceLandmark68Net.loadFromUri(e)]),Lz=!0,console.log("Face detection models loaded successfully")}catch(e){throw console.error("Error loading face detection models:",e),new Error("Failed to load face detection models")}},Pit=async e=>{try{await Oit();const t=await Lit(e);return(await Fit(t,new dne).withFaceLandmarks()).length>0}catch(t){return console.error("Error detecting face:",t),!1}},Lit=e=>new Promise((t,r)=>{const n=new Image,a=new FileReader;a.onload=s=>{var i;n.onload=()=>t(n),n.onerror=()=>r(new Error("Failed to load image")),n.src=(i=s.target)==null?void 0:i.result},a.onerror=()=>r(new Error("Failed to read file")),a.readAsDataURL(e)}),zit=()=>{var Y,re,ae;const e=Rn(),t=_s(),{toast:r}=Wt(),{selectedLanguage:n}=vR(),[a,s]=w.useState([]),[i,o]=w.useState([]),[u,d]=w.useState([]),[c,h]=w.useState([]),[p,f]=w.useState([]),[g,m]=w.useState([]),[x,y]=w.useState([]),[v,b]=w.useState(""),[N,S]=w.useState({states:!1,districts:!1,blocks:!1}),[_,C]=w.useState({profileImage:null,imageUrl:"",firstName:"",middleName:"",lastName:"",dateOfBirth:"",whatsappNumber:"",alternateNumber:"",email:"",gender:"",state:"",stateCode:"",district:"",districtCode:"",block:"",blockCode:"",city:"",pinCode:"",currentStatus:"",maximumQualification:"",schoolMedium:"",casteTribe:"",religion:""}),[k,I]=w.useState(null),T=K=>({image_url:K.imageUrl||null,first_name:K.firstName,middle_name:K.middleName,last_name:K.lastName,dob:K.dateOfBirth,whatsapp_number:K.whatsappNumber,phone_number:K.alternateNumber,email:K.email,gender:K.gender,state:K.state,district:K.district,block:K.block,city:K.city,pin_code:K.pinCode,school_medium:K.schoolMedium,current_status_id:Number(K.currentStatus)||null,qualification_id:Number(K.maximumQualification)||null,cast_id:Number(K.casteTribe)||null,religion_id:Number(K.religion)||null}),j=async()=>{try{S(Z=>({...Z,states:!0}));const K=await zg();let J=[];Array.isArray(K)?J=K:K&&Array.isArray(K.data)?J=K.data:K&&K.states?J=K.states:K&&K.result&&(J=K.result),f(J||[])}catch(K){r({title:" Unable to Load States",description:ut(K),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),f([])}finally{S(K=>({...K,states:!1}))}},E=async K=>{if(!K){m([]),y([]);return}try{S(Q=>({...Q,districts:!0}));const J=await Hh(K);let Z=[];Array.isArray(J)?Z=J:J&&Array.isArray(J.data)?Z=J.data:J&&J.districts?Z=J.districts:J&&J.result&&(Z=J.result),m(Z||[])}catch(J){console.error("Error fetching districts:",J),r({title:" Unable to Load Districts",description:ut(J),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),m([])}finally{S(J=>({...J,districts:!1}))}},O=async K=>{if(!K){y([]);return}try{S(Q=>({...Q,blocks:!0}));const J=await Kb(K);let Z=[];Array.isArray(J)?Z=J:J&&Array.isArray(J.data)?Z=J.data:J&&J.blocks?Z=J.blocks:J&&J.result&&(Z=J.result),y(Z||[])}catch(J){r({title:" Unable to Load Blocks",description:ut(J),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"}),y([])}finally{S(J=>({...J,blocks:!1}))}};w.useEffect(()=>{var te;const K=localStorage.getItem("studentFormData"),J=(te=t.state)==null?void 0:te.googleEmail;if(K){const pe=JSON.parse(K);J&&!pe.email&&(pe.email=J),C(pe),pe.stateCode&&E(pe.stateCode),pe.districtCode&&O(pe.districtCode)}else J&&C(pe=>({...pe,email:J}));j(),(async()=>{try{const pe=await Vb();s(pe)}catch{}})(),(async()=>{try{const pe=await qb();o(pe)}catch{}})(),(async()=>{try{const pe=await n$();d(pe)}catch{}})(),(async()=>{try{const pe=await Hb();h(pe)}catch{}})()},[(Y=t.state)==null?void 0:Y.googleEmail]);const M=K=>{const{name:J,value:Z}=K.target;let Q=Z;(J==="firstName"||J==="middleName"||J==="lastName")&&(Q=Z.replace(/[^A-Za-z\s'-]/g,"")),(J==="whatsappNumber"||J==="alternateNumber")&&(Q=Z.replace(/\D/g,"").slice(0,10)),J==="pinCode"&&(Q=Z.replace(/\D/g,"").slice(0,6));let U={..._,[J]:Q};if(J==="stateCode"){const F=p.find(te=>te.state_code===Q);U={...U,stateCode:Q,state:(F==null?void 0:F.state_name)||"",district:"",districtCode:"",block:"",blockCode:""},m([]),y([]),Q&&E(Q)}if(J==="districtCode"){const F=g.find(te=>te.district_code===Q);U={...U,districtCode:Q,district:(F==null?void 0:F.district_name)||"",block:"",blockCode:""},y([]),Q&&O(Q)}if(J==="blockCode"){const F=x.find(te=>String(te.id)===Q);U={...U,blockCode:Q,block:(F==null?void 0:F.block_name)||""}}C(U),localStorage.setItem("studentFormData",JSON.stringify(U)),J==="email"&&(W(Q)?b(""):b("Please enter a valid email address"))},W=K=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(K),q=async K=>{var Z;const J=(Z=K.target.files)==null?void 0:Z[0];if(J){if(r({title:B.verifying||"Verifying...",description:B.verifyingMessage||"Please wait while we verify the image...",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"}),!await Pit(J)){r({variant:"destructive",title:B.noFaceDetected||" No Face Detected",description:B.noFaceMessage||"Please upload an image with a clear human face.",className:"border-red-500 bg-red-50 text-red-900"}),K.target.value="";return}try{const U=await u$(J),F={..._,profileImage:J,imageUrl:U.url};C(F);const te=new FileReader;te.onloadend=()=>{I(te.result)},te.readAsDataURL(J),r({title:B.faceVerified||" Face Verified",description:B.faceVerifiedMessage||"Image uploaded successfully!",variant:"default",className:"border-green-500 bg-green-50 text-green-900"})}catch(U){console.error("Error uploading image:",U),r({variant:"destructive",title:" Upload Failed",description:ut(U),className:"border-red-500 bg-red-50 text-red-900"}),K.target.value=""}}},P=K=>{if(!K)return 0;const J=new Date(K);return(new Date().getTime()-J.getTime())/(1e3*60*60*24*365.25)},A=()=>{const K=P(_.dateOfBirth),J=g.length>0?_.districtCode:!0,Z=x.length>0?_.blockCode:!0;return _.profileImage&&_.firstName&&_.dateOfBirth&&_.whatsappNumber&&_.gender&&_.stateCode&&J&&Z&&_.pinCode&&_.currentStatus&&_.maximumQualification&&_.schoolMedium&&_.casteTribe&&_.religion&&K>=16.5},L=async()=>{var J,Z;const K=P(_.dateOfBirth);if(!_.profileImage)return r({title:" Profile Image Required",description:"Please upload a profile image.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(!_.firstName)return r({title:" First Name Required",description:"Please enter your first name.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(!_.dateOfBirth||K<16.5)return r({title:" Invalid Date of Birth",description:"You must be at least 16.5 years old.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(!_.whatsappNumber||!/^\d{10}$/.test(_.whatsappNumber))return r({title:" Invalid WhatsApp Number",description:"Enter a valid 10-digit WhatsApp number.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(!_.gender)return r({title:" Gender Required",description:"Please select your gender.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(!_.stateCode||!_.pinCode)return r({title:" Address Required",description:"Please fill State and Pin Code.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(g.length>0&&!_.districtCode)return r({title:" District Required",description:"Please select a district.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(x.length>0&&!_.blockCode)return r({title:" Block Required",description:"Please select a block.",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"});if(!_.currentStatus||!_.maximumQualification||!_.schoolMedium||!_.casteTribe||!_.religion)return r({title:"Additional Info Required",description:"Please fill all required additional fields.",variant:"destructive"});try{const Q=T(_),U=await a$(Q);console.log("Student API Response:",U),localStorage.setItem("registrationDone","true"),localStorage.setItem("studentApiResponse",JSON.stringify(U)),localStorage.setItem("studentFormData",JSON.stringify(_));let F=null;U!=null&&U.id?F=U.id:(J=U==null?void 0:U.data)!=null&&J.id?F=U.data.id:(Z=U==null?void 0:U.student)!=null&&Z.id&&(F=U.student.id),F?(localStorage.setItem("studentId",F.toString()),console.log("Student ID stored:",F)):console.warn("Student ID not found in response"),r({title:" Registration Successful",description:"Your registration was successful!",variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),e("/students/test/start")}catch(Q){console.error("Error creating student:",Q),Q instanceof Error&&Q.message,r({title:" Registration Failed",description:ut(Q),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}},z=()=>{e("/students/details/instructions")},$=()=>{const K=new Date;return K.setFullYear(K.getFullYear()-16),K.setMonth(K.getMonth()-6),K.toISOString().split("T")[0]},B=(()=>{switch(n){case"hindi":return{signUp:"  ",addPhoto:" ",basicDetails:" ",contactInfo:" ",firstName:"  *",middleName:" ",lastName:"  ",dateOfBirth:"  *",gender:" *",male:"",female:"",whatsappNumber:"  *",alternateNumber:" ",email:"  ",state:"  *",district:" ",block:" ",city:" *",pinCode:"  *",currentStatus:"  *",maximumQualification:"  *",schoolMedium:"  *",casteTribe:"/ *",religion:" *",back:"",saveContinue:"   ",selectState:" ",selectDistrict:" ",selectBlock:" ",selectOption:" ",selectQualification:" ",selectMedium:" ",selectReligion:" ",enterFirstName:"   ",enterMiddleName:"   ",enterLastName:"   ",enterWhatsapp:"   ",enterAlternate:"   ",enterEmail:"   ",cityExample:". ",pinCodeExample:". 400001",verifying:"   ...",verifyingMessage:"        ...",noFaceDetected:"   ",noFaceMessage:"       ",faceVerified:" ",faceVerifiedMessage:"    !",loading:"   ..."};case"marathi":return{signUp:"  ",addPhoto:" ",basicDetails:" ",contactInfo:" ",firstName:"  *",middleName:" ",lastName:" ",dateOfBirth:"  *",gender:" *",male:"",female:"",whatsappNumber:"  *",alternateNumber:" ",email:"  ",state:"  *",district:" ",block:" ",city:" *",pinCode:"  *",currentStatus:"  *",maximumQualification:"  *",schoolMedium:"  *",casteTribe:"/ *",religion:" *",back:"",saveContinue:"    ",selectState:" ",selectDistrict:" ",selectBlock:" ",selectOption:" ",selectQualification:" ",selectMedium:" ",selectReligion:" ",enterFirstName:"   ",enterMiddleName:"   ",enterLastName:"  ",enterWhatsapp:"   ",enterAlternate:"   ",enterEmail:"   ",cityExample:". ",pinCodeExample:". 411001",verifying:"  ...",verifyingMessage:"       ...",noFaceDetected:"  ",noFaceMessage:"      .",faceVerified:" ",faceVerifiedMessage:"   !",loading:"  ..."};default:return{signUp:"Sign Up",addPhoto:"Add Photo",basicDetails:"Basic Details",contactInfo:"Contact Information",firstName:"First Name *",middleName:"Middle Name",lastName:"Last Name",dateOfBirth:"Date of Birth *",gender:"Gender *",male:"Male",female:"Female",whatsappNumber:"WhatsApp Number *",alternateNumber:"Alternate Number",email:"Email Address",state:"Select State *",district:"Select District",block:"Select Block",pinCode:"Pin Code *",currentStatus:"Current Status *",maximumQualification:"Maximum Qualification *",schoolMedium:"School Medium *",casteTribe:"Caste/Tribe *",religion:"Religion *",back:"Back",saveContinue:"Save & Continue",selectState:"Select State",selectDistrict:"Select District",selectBlock:"Select Block",selectOption:"Select Option",selectQualification:"Select Qualification",selectMedium:"Select Medium",selectReligion:"Select Religion",enterFirstName:"Enter first name",enterMiddleName:"Enter middle name",enterLastName:"Enter last name",enterWhatsapp:"Enter WhatsApp number",enterAlternate:"Enter alternate number",enterEmail:"Enter email address",cityExample:"Ex. Bangalore",pinCodeExample:"Ex. 4402xx",verifying:"Verifying...",verifyingMessage:"Please wait while we verify the image...",noFaceDetected:"No Face Detected",noFaceMessage:"Please upload an image with a clear human face.",faceVerified:"Face Verified",faceVerifiedMessage:"Image uploaded successfully!",loading:"Loading..."}}})();return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx(Kg,{}),l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2 ",children:B.signUp})]}),l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"w-24 h-24 mx-auto border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center bg-gray-50 relative cursor-pointer hover:border-orange-400 transition-colors",children:[k?l.jsx("img",{src:k,alt:"Profile",className:"w-full h-full object-cover rounded-xl"}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center mb-1",children:l.jsx("span",{className:"text-white text-sm",children:""})}),l.jsx("span",{className:"text-xs text-gray-500",children:B.addPhoto})]}),l.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:B.basicDetails}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.firstName}),l.jsx("input",{type:"text",name:"firstName",value:_.firstName,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:B.enterFirstName})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.middleName}),l.jsx("input",{type:"text",name:"middleName",value:_.middleName,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:B.enterMiddleName})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.lastName}),l.jsx("input",{type:"text",name:"lastName",value:_.lastName,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:B.enterLastName})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.dateOfBirth}),l.jsx("div",{className:"relative",children:l.jsx("input",{type:"date",name:"dateOfBirth",value:_.dateOfBirth,onChange:M,max:$(),className:"w-full p-3 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.gender}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"gender",value:"male",checked:_.gender==="male",onChange:M,className:"text-orange-500 focus:ring-orange-500"}),l.jsx("span",{className:"text-sm",children:B.male})]}),l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"gender",value:"female",checked:_.gender==="female",onChange:M,className:"text-orange-500 focus:ring-orange-500"}),l.jsx("span",{className:"text-sm",children:B.female})]})]})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:B.contactInfo}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.whatsappNumber}),l.jsx("input",{type:"tel",name:"whatsappNumber",maxLength:10,pattern:"[0-9]{10}",value:_.whatsappNumber,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:B.enterWhatsapp})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.alternateNumber}),l.jsx("input",{type:"tel",name:"alternateNumber",maxLength:10,pattern:"[0-9]{10}",value:_.alternateNumber,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:B.enterAlternate})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[B.email," *"]}),l.jsx("input",{type:"email",name:"email",value:_.email,onChange:M,disabled:!!((re=t.state)!=null&&re.googleEmail),className:`w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 ${(ae=t.state)!=null&&ae.googleEmail?"bg-gray-100 cursor-not-allowed":""}`,placeholder:B.enterEmail}),v&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:v})]})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Additional Information"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.state}),l.jsx(sr,{options:(p==null?void 0:p.map(K=>({value:K.state_code,label:K.state_name})))||[],value:_.stateCode,onValueChange:K=>{M({target:{name:"stateCode",value:K}})},placeholder:N.states?B.loading:B.selectState,searchPlaceholder:"Search state...",emptyText:"No state found.",disabled:N.states,className:"h-12"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[B.district,g.length>0&&l.jsx("span",{className:"text-red-500",children:" *"})]}),l.jsx(sr,{options:(g==null?void 0:g.map(K=>({value:K.district_code,label:K.district_name})))||[],value:_.districtCode,onValueChange:K=>{M({target:{name:"districtCode",value:K}})},placeholder:N.districts?B.loading:_.stateCode?B.selectDistrict:"Select state first",searchPlaceholder:"Search district...",emptyText:"No district found.",disabled:N.districts||!_.stateCode,className:"h-12"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[B.block,x.length>0&&l.jsx("span",{className:"text-red-500",children:" *"})]}),l.jsx(sr,{options:(x==null?void 0:x.map(K=>({value:String(K.id),label:K.block_name})))||[],value:_.blockCode,onValueChange:K=>{M({target:{name:"blockCode",value:K}})},placeholder:N.blocks?B.loading:_.districtCode?x.length===0?"No blocks available":B.selectBlock:"Select district first",searchPlaceholder:"Search block...",emptyText:"No block found.",disabled:N.blocks||!_.districtCode,className:"h-12"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.pinCode}),l.jsx("input",{type:"text",name:"pinCode",value:_.pinCode,onChange:M,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter pin code"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:B.pinCodeExample})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.currentStatus}),l.jsx(sr,{options:(u==null?void 0:u.map(K=>({value:String(K.id),label:K.current_status_name})))||[],value:_.currentStatus,onValueChange:K=>{M({target:{name:"currentStatus",value:K}})},placeholder:B.selectOption,searchPlaceholder:"Search...",emptyText:"No option found.",className:"h-12"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.maximumQualification}),l.jsx(sr,{options:(i==null?void 0:i.map(K=>({value:String(K.id),label:K.qualification_name})))||[],value:_.maximumQualification,onValueChange:K=>{M({target:{name:"maximumQualification",value:K}})},placeholder:B.selectQualification,searchPlaceholder:"Search...",emptyText:"No qualification found.",className:"h-12"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.schoolMedium}),l.jsx(sr,{options:[{value:"English",label:"English"},{value:"Hindi",label:"Hindi"},{value:"Marathi",label:"Marathi"},{value:"Other",label:"Other"}],value:_.schoolMedium,onValueChange:K=>{M({target:{name:"schoolMedium",value:K}})},placeholder:B.selectMedium,searchPlaceholder:"Search...",emptyText:"No medium found.",className:"h-12"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.casteTribe}),l.jsx(sr,{options:(a==null?void 0:a.map(K=>({value:String(K.id),label:K.cast_name})))||[],value:_.casteTribe,onValueChange:K=>{M({target:{name:"casteTribe",value:K}})},placeholder:B.selectOption,searchPlaceholder:"Search caste...",emptyText:"No caste found.",className:"h-12"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.religion}),l.jsx(sr,{options:(c==null?void 0:c.map(K=>({value:String(K.id),label:K.religion_name})))||[],value:_.religion,onValueChange:K=>{M({target:{name:"religion",value:K}})},placeholder:B.selectReligion,searchPlaceholder:"Search religion...",emptyText:"No religion found.",className:"h-12"})]})]})]}),l.jsxs("div",{className:"flex justify-center space-x-4",children:[l.jsx("button",{onClick:z,className:"px-6 py-2 bg-gray-300 text-gray-500 rounded-lg hover:bg-gray-600 transition duration-200",children:B.back}),l.jsx("button",{onClick:L,className:`px-6 py-2 rounded-lg transition duration-200 ${A()?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:B.saveContinue})]}),l.jsxs("div",{className:"flex justify-center space-x-2 mt-6",children:[l.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),l.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded-full"}),l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"})]})]})})},hne=w.createContext(void 0),zz="tests_data",Bit=({children:e})=>{const[t,r]=w.useState(()=>{const a=localStorage.getItem(zz);return a?JSON.parse(a):[]});w.useEffect(()=>{localStorage.setItem(zz,JSON.stringify(t))},[t]);const n=(a,s)=>r(i=>i.map(o=>o.id===a?{...o,slotBooking:{...o.slotBooking,...s}}:o));return l.jsx(hne.Provider,{value:{tests:t,setTests:r,updateSlot:n},children:e})},OC=()=>{const e=w.useContext(hne);if(!e)throw new Error("useTests must be used inside TestsProvider");return e},pne=w.createContext({student:null,setStudent:()=>{}}),Uit=({children:e})=>{const[t,r]=w.useState(null);return w.useEffect(()=>{const n=localStorage.getItem("studentFormData");if(n)try{const a=JSON.parse(n);r(a)}catch(a){console.error("Error parsing studentFormData:",a)}},[]),l.jsx(pne.Provider,{value:{student:t,setStudent:r},children:e})},fne=()=>w.useContext(pne),Wit=()=>{var yt;const{student:e}=fne(),{tests:t,updateSlot:r}=OC(),{id:n}=Rb(),a=Number(n),i=(yt=_s().state)==null?void 0:yt.slot_type,o=localStorage.getItem("studentId"),u=o?parseInt(o):null,d=t.find(De=>De.id===a),[c,h]=w.useState(!0),[p,f]=w.useState(null),[g,m]=w.useState(!0),[x,y]=w.useState({from:"",to:"",id:null,is_cancelled:!0}),[v,b]=w.useState({from:"",to:"",id:null,is_cancelled:!0}),[N,S]=w.useState(!1),[_,C]=w.useState(()=>{const De=new Date;return De.setDate(De.getDate()+1),De}),[k,I]=w.useState([]),[T,j]=w.useState(!1),[E,O]=w.useState(""),[M,W]=w.useState("success"),[q,P]=w.useState(!1),[A,L]=w.useState(!1),[z,$]=w.useState(!1),[V,B]=w.useState(!1),[Y,re]=w.useState(""),[ae,K]=w.useState(!1),J=Rn(),Z=De=>De.toISOString().split("T")[0],Q=De=>{const[Fe,et]=De.split(":"),Ae=new Date;return Ae.setHours(parseInt(Fe),parseInt(et)),Ae.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},U=De=>De.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),F=(De,Fe)=>{O(De),W(Fe),j(!0),setTimeout(()=>j(!1),5e3)},te=async De=>{try{const Fe=Z(De),et=await b_(Fe,i||"LR");console.log("Fetched timings response:",et);const He=(Array.isArray(et)?et:(et==null?void 0:et.data)||[]).filter(st=>{var kt;return!st.is_booked&&((kt=st.status)==null?void 0:kt.toLowerCase())==="available"}).map(st=>({id:st.id,start_time:st.start_time,end_time:st.end_time,interviewer_id:st.created_by||st.interviewer_id,interviewer_email:st.user_email,interviewer_name:st.user_name,is_booked:st.is_booked||!1,status:st.status||"available"}));I(He),console.log("Available slots for",Fe,":",He)}catch(Fe){console.error("Failed to load timings:",Fe),F(Fe.message||"Failed to load available slots","error"),I([])}};w.useEffect(()=>{te(_),N?b({from:"",to:"",id:null,is_cancelled:!0}):y({from:"",to:"",id:null,is_cancelled:!0})},[_]);const pe=async()=>{try{return L(!0),$(!0),Fu()||(F("Opening Google Sign-in popup... Please allow popups if blocked.","info"),await c7(),P(!0),$(!1),F("Google Sign-in successful!","success")),!0}catch(De){console.error("Google sign-in error:",De),$(!1);let Fe="Failed to sign in with Google. Please try again.";return De.message&&De.message.includes("popup")?Fe="Sign-in popup was closed. Please click the button again and complete the sign-in.":De.message&&De.message.includes("access_denied")?Fe="Access denied. Please grant calendar permissions to continue.":De.message&&(Fe=De.message),F(Fe,"error"),!1}finally{L(!1)}},ve=async De=>{try{const Fe=rS(De.on_date,De.start_time),et=rS(De.on_date,De.end_time_expected),Ae=[De.interviewer_email||"",(p==null?void 0:p.email)||""].filter(Boolean),He={summary:`${De.topic_name} - Interview`,description:`Interview scheduled for ${De.student_name}
Topic: ${De.topic_name}
Interviewer: ${De.interviewer_name||De.interviewer_email}
Student Email: ${(p==null?void 0:p.email)||""}`,startDateTime:Fe,endDateTime:et,attendeeEmail:De.interviewer_email||"",studentName:De.student_name,attendees:Ae},st=await d7(He);return console.log("Calendar event created:",st),st}catch(Fe){throw console.error("Error creating calendar event:",Fe),Fe}},fe=async()=>{var De,Fe,et;if(console.log("Booking attempt - slot:",x,"currentStudent:",p,"test:",d),console.log("Available timings:",k),console.log("studentId:",u),!x.id){F("Please select a slot to book","error");return}if(!p||!p.email){F("Student information not found. Please login again.","error");return}if(!d){F("Test information not found. Please refresh the page.","error");return}if(!u||isNaN(u)){F("Student ID not found. Please login again.","error");return}try{if(L(!0),!Fu()){const ur=await pe();if(console.log("Google sign-in success:",ur),!ur)return;P(!0)}const Ae=k.find(ur=>ur.id===x.id);if(console.log("Selected slot details:",Ae),!Ae){F("Selected slot not found","error");return}if(!Ae.interviewer_email){console.error("Interviewer email missing for slot:",Ae),F("Interviewer email not found","error");return}if(!p||!p.email){F("Student email not found. Please login again.","error");return}const He={...x,is_cancelled:!1,on_date:Z(_),start_time:Ae.start_time,end_time_expected:Ae.end_time,student_name:`${p.firstName} ${p.lastName}`,topic_name:d.name,interviewer_email:Ae.interviewer_email,interviewer_name:Ae.interviewer_name};F("Creating Google Meet...","info");const st=await ve(He);if(console.log("Google Calendar result:",st),!st.meetLink){F("Failed to create Google Meet link","error");return}He.calendar_event_id=st.eventId,He.meet_link=st.meetLink;const kt={student_id:u,slot_id:x.id,title:`${He.topic_name} - Interview`,description:`Interview for ${He.student_name}. Topic: ${He.topic_name}. Interviewer: ${He.interviewer_name||He.interviewer_email}. Student: ${p.email}`,meeting_link:He.meet_link,google_event_id:He.calendar_event_id,created_by:"Student",slot_type:i||"LR"};console.log("Backend payload for scheduling interview:",kt),F("Saving slot to server...","info");const Vt=await l$(kt);console.log("Slot booked successfully:",Vt),(De=Vt==null?void 0:Vt.data)!=null&&De.id?He.scheduled_interview_id=Vt.data.id:Vt!=null&&Vt.id&&(He.scheduled_interview_id=Vt.id),y(He),r(a,{status:"Booked",scheduledTime:`${He.on_date} ${He.start_time}`}),F("Slot Booked! Google Meet link sent to your email.","success"),te(_)}catch(Ae){console.error("Booking error:",Ae);let He="Failed to book slot. Please try again.";(Fe=Ae.message)!=null&&Fe.includes("calendar")?He="Failed to create Google Meet. Check calendar permissions.":(et=Ae.message)!=null&&et.includes("API")?He="Failed to save booking. Please contact support.":Ae.message&&(He=Ae.message),F(He,"error")}finally{L(!1)}},Me=async()=>{if(d){if(!x.scheduled_interview_id){F("Cannot cancel: Interview ID not found. Please contact support.","error");return}S(!0),F("Select a new time slot to reschedule your interview","info")}},je=async()=>{if(!x.scheduled_interview_id){F("Cannot cancel: Interview ID not found. Please contact support.","error");return}if(!Y.trim()){F("Please provide a reason for cancellation","error");return}try{if(K(!0),x.calendar_event_id)try{Fu()||(F("Signing in to Google to delete calendar event...","info"),await pe()||F("Could not sign in to Google. Calendar event may not be deleted.","error")),Fu()&&(console.log("Deleting calendar event ID:",x.calendar_event_id),F("Removing event from Google Calendar...","info"),await G3(x.calendar_event_id),console.log("Google Calendar event deleted successfully"))}catch(De){console.error("Error deleting calendar event:",De),F("Warning: Could not remove event from calendar. Proceeding with cancellation...","info")}await TV(x.scheduled_interview_id,Y.trim()),y({from:"",to:"",id:null,is_cancelled:!0}),r(a,{status:"Cancelled",scheduledTime:void 0}),B(!1),re(""),F("Interview slot cancelled and removed from calendar!","success"),setTimeout(()=>{J("/students/final-result")},2e3)}catch(De){console.error("Cancel error:",De),F(De.message||"Failed to cancel slot. Please try again.","error")}finally{K(!1)}},Qe=async()=>{var De;if(!v.id||!x.scheduled_interview_id||!p||!d){v.id?x.scheduled_interview_id?F("Missing required information","error"):F("Interview ID not found. Please contact support.","error"):F("Please select a new time slot","error");return}try{if(L(!0),!Fu()){const kt=await pe();if(console.log("Google sign-in success:",kt),!kt)return;P(!0)}const Fe=k.find(kt=>kt.id===v.id);if(!Fe){F("New slot not found","error");return}if(!Fe.interviewer_email){F("Interviewer email not found","error");return}if(!p||!p.email){F("Student email not found. Please login again.","error");return}if(x.calendar_event_id)try{await G3(x.calendar_event_id),F("Old Google Meet deleted","info")}catch(kt){console.error("Error deleting old calendar event:",kt)}F("Creating new Google Meet...","info");const et={...v,is_cancelled:!1,on_date:Z(_),start_time:Fe.start_time,end_time_expected:Fe.end_time,student_name:`${p.firstName} ${p.lastName}`,topic_name:d.name,interviewer_email:Fe.interviewer_email,interviewer_name:Fe.interviewer_name},Ae=await ve(et);if(console.log("New Google Calendar result:",Ae),!Ae.meetLink)throw new Error("Failed to create Google Meet link");et.calendar_event_id=Ae.eventId,et.meet_link=Ae.meetLink;const He={slot_id:v.id,title:`${et.topic_name} - Interview (Rescheduled)`,description:`Rescheduled interview for ${et.student_name}. Topic: ${et.topic_name}. Interviewer: ${et.interviewer_name||et.interviewer_email}. Student: ${p.email}`,meeting_link:et.meet_link,google_event_id:et.calendar_event_id};console.log("Rescheduling with:",{scheduledInterviewId:x.scheduled_interview_id,payload:He});const st=await IV(x.scheduled_interview_id,He);console.log("Reschedule response:",st),(De=st==null?void 0:st.data)!=null&&De.id?et.scheduled_interview_id=st.data.id:st!=null&&st.id?et.scheduled_interview_id=st.id:et.scheduled_interview_id=x.scheduled_interview_id,y(et),b({from:"",to:"",id:null,is_cancelled:!0}),S(!1),r(a,{status:"Booked",scheduledTime:`${et.on_date} ${et.start_time}`}),F("Interview Rescheduled Successfully! New Google Meet link sent.","success"),te(_)}catch(Fe){console.error("Rescheduling error:",Fe),F(Fe.message||"Error rescheduling slot. Please try again.","error")}finally{L(!1)}},ft=()=>{S(!1),b({from:"",to:"",id:null,is_cancelled:!0}),F("Rescheduling cancelled","info")},Ot=()=>J("/students/final-result");return w.useEffect(()=>{(async()=>{var Fe,et;try{m(!0);const Ae=localStorage.getItem("user");if(Ae){const st=JSON.parse(Ae).email;if(st){console.log("Fetching student data for email:",st);const kt=await r$(st);if(kt.success&&kt.data.student){const Vt=kt.data.student;console.log("Student data fetched from API:",Vt),f({firstName:Vt.first_name||Vt.firstName||"",lastName:Vt.last_name||Vt.lastName||"",email:Vt.email||"",...Vt});const ur=i==="CFR"?kt.data.interview_schedules_cfr||[]:kt.data.interview_schedules_lr||[];let we=1;i==="LR"?we=a===2?1:a-200+1:i==="CFR"&&(we=a===3?1:a-300+1),console.log("Looking for schedule matching attempt:",we,"testId:",a);const wr=i==="CFR"?"Cultural Fit Round":"Learning Round",nr=ur.filter(Zt=>{const _r=Zt.title||"";return String(Zt.status||"").toLowerCase()==="cancelled"?!1:we===1?!!(!/\(Attempt \d+\)/i.test(_r)&&_r.includes(wr)||/\(Attempt 1\)/i.test(_r)):new RegExp(`\\(Attempt ${we}\\)`,"i").test(_r)}).slice(-1)[0];if(console.log("Matching schedule found:",nr),nr){const Zt=String(nr.status||"").toLowerCase();Zt!=="cancelled"&&Zt!=="expired"?(y({id:nr.slot_id,from:nr.start_time,to:nr.end_time,is_cancelled:!1,on_date:nr.date,start_time:nr.start_time,end_time_expected:nr.end_time,student_name:`${Vt.first_name||""} ${Vt.last_name||""}`,topic_name:i==="CFR"?"Cultural Fit Round":"Learning Round",calendar_event_id:nr.google_event_id,meet_link:nr.meeting_link,interviewer_email:((Fe=nr.slot_details)==null?void 0:Fe.user_email)||"",interviewer_name:((et=nr.slot_details)==null?void 0:et.user_name)||"",scheduled_interview_id:nr.schedule_id,slot_type:i}),console.log("Slot set from API - showing booked view for attempt:",we)):(y({from:"",to:"",id:null,is_cancelled:!0}),console.log("Slot is cancelled/expired - showing booking view"))}else y({from:"",to:"",id:null,is_cancelled:!0}),console.log("No existing schedules - showing booking view")}}else console.error("No email found in user data")}else console.error("No user data in localStorage")}catch(Ae){console.error("Failed to fetch student data:",Ae)}finally{m(!1)}})()},[i]),w.useEffect(()=>{(async()=>{try{await u7(),Fu()&&P(!0)}catch(Fe){console.error("Initialization error:",Fe);const et=Fe.message||"Failed to initialize Google Calendar. Please check console for details.";F(et,"error")}finally{h(!1)}})()},[a]),c||g?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(ya,{className:"w-12 h-12 text-orange-600 animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading student data..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-r from-orange-500 to-red-500 py-8 px-4",children:[T&&l.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-all duration-300 ${M==="success"?"bg-green-500":M==="error"?"bg-red-500":"bg-blue-500"} text-white max-w-md`,children:l.jsxs("div",{className:"flex items-center space-x-2",children:[M==="success"&&l.jsx(Xd,{className:"w-5 h-5"}),M==="error"&&l.jsx(Md,{className:"w-5 h-5"}),M==="info"&&l.jsx($a,{className:"w-5 h-5"}),l.jsx("span",{children:E})]})}),z&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsx("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md mx-4 animate-fade-in",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"flex justify-center mb-4",children:l.jsx(ya,{className:"w-16 h-16 text-orange-600 animate-spin"})}),l.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Sign in with Google"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"A popup window should have opened for Google sign-in."}),l.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:l.jsxs("p",{className:"text-sm text-gray-700",children:[l.jsx("strong",{children:"Popup blocked?"}),l.jsx("br",{}),"Please allow popups for this site and try again."]})}),l.jsx("p",{className:"text-xs text-gray-500",children:"Grant calendar permissions to schedule your interview."})]})})}),l.jsxs("div",{className:"max-w-4xl mx-auto",children:[x.is_cancelled||N?l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[l.jsxs("div",{className:"bg-orange-400 px-8 py-6 text-white",children:[l.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[N?"Reschedule Interview Slot":"Book Interview Slot",i&&l.jsxs("span",{className:"ml-3 text-2xl",children:["(",i==="LR"?"Learning Round":"Culture Fit Round",")"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(yo,{className:"w-5 h-5"}),l.jsxs("span",{className:"text-lg",children:[(p==null?void 0:p.firstName)||""," ",(p==null?void 0:p.lastName)||""]})]}),l.jsx("p",{className:"text-sm mt-1 opacity-90",children:(p==null?void 0:p.email)||""}),N&&l.jsxs("div",{className:"mt-3 bg-orange-500 bg-opacity-50 rounded-lg p-3",children:[l.jsxs("p",{className:"text-sm font-semibold",children:[" Current Slot:"," ",x.on_date&&U(new Date(x.on_date))," ","at ",x.start_time&&Q(x.start_time)]}),l.jsx("p",{className:"text-xs mt-1",children:"Select a new time slot below to reschedule"})]})]}),l.jsxs("div",{className:"p-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx($a,{className:"w-6 h-6 mr-2 text-orange-600"}),"Select Date"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsx("input",{type:"date",value:Z(_),onChange:De=>C(new Date(De.target.value)),min:Z(new Date(Date.now()+24*60*60*1e3)),max:Z(new Date(Date.now()+15*24*60*60*1e3)),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),l.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Selected Date:"}),l.jsx("p",{className:"text-lg font-semibold text-orange-600",children:U(_)})]})]})]}),l.jsxs("div",{className:"mb-8",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(Ya,{className:"w-6 h-6 mr-2 text-orange-600"}),"Available Time Slots"]}),k.length>0?l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(De=>l.jsx("button",{onClick:()=>{N?b({id:De.id,from:De.start_time,to:De.end_time,is_cancelled:!0,interviewer_email:De.interviewer_email,interviewer_name:De.interviewer_name}):y({id:De.id,from:De.start_time,to:De.end_time,is_cancelled:!0,interviewer_email:De.interviewer_email,interviewer_name:De.interviewer_name})},className:`p-4 rounded-lg border-2 transition-all ${(N?v.id:x.id)===De.id?"border-orange-500 bg-orange-50 shadow-md":"border-gray-200 bg-white hover:border-orange-300 hover:shadow-sm"}`,children:l.jsx("div",{className:"text-center",children:l.jsxs("p",{className:"font-semibold text-gray-800",children:[Q(De.start_time)," -"," ",Q(De.end_time)]})})},De.id))}):l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[l.jsx(Ya,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-600 text-base",children:"No slots available for this date."}),l.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please select another date."})]})]}),(N&&v.id||!N&&x.id&&x.is_cancelled)&&l.jsxs("div",{className:"mb-6 bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:N?"New Slot Selected:":"Selected Slot:"}),l.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[l.jsxs("p",{children:[" Date: ",U(_)]}),l.jsxs("p",{children:[" Time:"," ",Q(N?v.from:x.from)," -"," ",Q(N?v.to:x.to)]})]})]}),!q&&(x.id||v.id)&&l.jsx("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(vv,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold text-yellow-900 mb-1",children:"Google Meet Setup Required"}),l.jsx("p",{className:"text-sm text-yellow-700 mb-2",children:"You'll need to sign in with Google to automatically create a Meet link for your interview."}),l.jsx("p",{className:"text-xs text-yellow-600",children:' A popup will open for sign-in when you click "Book Slot"'})]})]})}),q&&(x.id||v.id)&&l.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Xd,{className:"w-5 h-5 text-green-600"}),l.jsx("p",{className:"text-sm text-green-700",children:"Google account connected. Meet link will be created automatically."})]})}),N?l.jsxs("div",{className:"flex gap-4",children:[l.jsx("button",{onClick:ft,disabled:A,className:"flex-1 py-4 px-6 rounded-lg font-semibold text-lg transition-all bg-gray-300 text-gray-700 hover:bg-gray-400 disabled:opacity-50",children:"Cancel"}),l.jsx("button",{onClick:Qe,disabled:!v.id||A,className:`flex-1 py-4 px-6 rounded-lg font-semibold text-lg transition-all ${!v.id||A?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-green-600 to-green-400 text-white hover:from-green-700 hover:to-green-500 shadow-lg hover:shadow-xl"}`,children:A?l.jsxs("span",{className:"flex items-center justify-center",children:[l.jsx(ya,{className:"w-5 h-5 mr-2 animate-spin"}),"Rescheduling..."]}):v.id?"Confirm Reschedule":"Select New Time Slot"})]}):l.jsx("button",{onClick:fe,disabled:!x.id||A,className:`w-full py-4 px-6 rounded-lg font-semibold text-lg transition-all ${!x.id||A?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-orange-600 to-orange-400 text-white hover:from-orange-700 hover:to-orange-500 shadow-lg hover:shadow-xl"}`,children:A?l.jsxs("span",{className:"flex items-center justify-center",children:[l.jsx(ya,{className:"w-5 h-5 mr-2 animate-spin"}),"Booking..."]}):x.id?"Book Selected Slot & Schedule Meet":"Select a Time Slot"})]})]}):l.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[l.jsx("div",{className:"bg-green-500 px-8 py-6 text-white",children:l.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-2",children:[l.jsx(Xd,{className:"w-8 h-8"}),l.jsx("h1",{className:"text-3xl font-bold",children:"Interview Slot Booked"})]})}),l.jsxs("div",{className:"p-8",children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Slot Details"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Student Name"}),l.jsx("p",{className:"text-lg font-semibold",children:x.student_name})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Topic"}),l.jsx("p",{className:"text-lg font-semibold",children:x.topic_name})]}),x.interviewer_name&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Interviewer"}),l.jsx("p",{className:"text-lg font-semibold",children:x.interviewer_name}),l.jsx("p",{className:"text-sm text-gray-500",children:x.interviewer_email})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),l.jsx("p",{className:"text-lg font-semibold",children:x.on_date&&U(new Date(x.on_date))})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Time"}),l.jsx("p",{className:"text-lg font-semibold",children:x.start_time&&x.end_time_expected&&`${Q(x.start_time)} - ${Q(x.end_time_expected)}`})]})]})]}),x.meet_link&&l.jsxs("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center mb-3",children:[l.jsx(vv,{className:"w-6 h-6 text-green-600 mr-2"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Google Meet Link"})]}),l.jsxs("a",{href:x.meet_link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors shadow-md hover:shadow-lg",children:[l.jsx(vv,{className:"w-5 h-5 mr-2"}),"Join Google Meet"]}),l.jsx("p",{className:"text-sm text-gray-600 mt-3",children:"Meeting link has been sent to your email and the interviewer's email."})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx("button",{onClick:Me,disabled:A||ae,className:"flex-1 py-3 px-8 bg-gradient-to-r from-orange-500 to-orange-400 text-white font-semibold rounded-lg hover:from-orange-600 hover:to-orange-500 transition-all shadow-md hover:shadow-lg disabled:opacity-50",children:A?l.jsxs("span",{className:"flex items-center justify-center",children:[l.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Reschedule Slot"}),l.jsx("button",{onClick:()=>B(!0),disabled:A||ae,className:"flex-1 py-3 px-8 bg-gradient-to-r from-red-500 to-red-600 text-white font-semibold rounded-lg hover:from-red-600 hover:to-red-700 transition-all shadow-md hover:shadow-lg disabled:opacity-50",children:"Cancel Slot"}),l.jsx("button",{onClick:Ot,className:"flex-1 py-3 px-8 bg-gradient-to-r from-green-400 to-green-500 text-white font-semibold rounded-lg hover:from-green-500 hover:to-green-600 transition-all shadow-md hover:shadow-lg",children:"View Results"})]})]})]}),V&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(Md,{className:"w-8 h-8 text-red-500 mr-3"}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Cancel Interview Slot"})]}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to cancel your scheduled interview? This action cannot be undone."}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for Cancellation ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("textarea",{value:Y,onChange:De=>re(De.target.value),placeholder:"Please provide a reason for cancelling your interview...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none",rows:4})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>{B(!1),re("")},disabled:ae,className:"flex-1 py-3 px-4 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition-all disabled:opacity-50",children:"Go Back"}),l.jsx("button",{onClick:je,disabled:ae||!Y.trim(),className:`flex-1 py-3 px-4 font-semibold rounded-lg transition-all ${ae||!Y.trim()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-500 text-white hover:bg-red-600"}`,children:ae?l.jsxs("span",{className:"flex items-center justify-center",children:[l.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}),"Cancelling..."]}):"Confirm Cancel"})]})]})})]})]})},Vit=()=>{const{student:e,setStudent:t}=fne();w.useEffect(()=>{const n=setTimeout(()=>{r()},3e3);return()=>clearTimeout(n)},[]);const r=()=>{const n=`Hello! I am ${e==null?void 0:e.firstName}. I have successfully completed the test and booked my interview slot. My phone number is ${e} and email is ${e==null?void 0:e.email}.`,a=`https://wa.me/YOUR_WHATSAPP_NUMBER?text=${encodeURIComponent(n)}`;window.open(a,"_blank")};return l.jsx("div",{className:"whatsapp-redirect",children:l.jsxs("div",{className:"success-message",children:[l.jsx("h2",{children:" Slot Booked Successfully!"}),l.jsxs("p",{children:["Thank you ",e==null?void 0:e.firstName,"! Your interview slot has been confirmed."]}),l.jsx("p",{children:"You will be redirected to WhatsApp to connect with our team."}),l.jsxs("div",{className:"redirect-info",children:[l.jsx("p",{children:"Redirecting in 3 seconds..."}),l.jsx("button",{className:"whatsapp-btn primary-btn",onClick:r,children:"Connect on WhatsApp Now"})]}),l.jsxs("div",{className:"contact-details",children:[l.jsx("h3",{children:"Your Details:"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Name:"})," ",e==null?void 0:e.firstName]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Email:"})," ",e==null?void 0:e.email]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Phone:"})," ",e==null?void 0:e.whatsappNumber]})]})]})})},Tl=[{id:1,image:"https://img.youtube.com/vi/NC2ymm6Sots/maxresdefault.jpg",videoUrl:"https://youtu.be/NC2ymm6Sots",englishCaption:"Interview of Abhishek, Co-founder of Navgurukul",hindiCaption:",   -  ",marathiCaption:",  -  "},{id:2,image:"https://img.youtube.com/vi/vuSwndj5cbs/maxresdefault.jpg",videoUrl:"https://www.youtube.com/watch?time_continue=1&v=vuSwndj5cbs&embeds_referring_euri=https%3A%2F%2Fdev-admissions.navgurukul.org%2F&embeds_referring_origin=https%3A%2F%2Fdev-admissions.navgurukul.org&source_ve_path=Mjg2NjQsMjg2NjY",englishCaption:"Experience of Navgurukul Alumni & Graduates",hindiCaption:"       ",marathiCaption:"   "},{id:3,image:"https://img.youtube.com/vi/sfU1m8MuZ5Y/maxresdefault.jpg",videoUrl:"https://www.youtube.com/watch?v=HjqfZ-Matyk&ab_channel=NavGurukul",englishCaption:"Detailed explanation about Navgurukul",hindiCaption:"     ",marathiCaption:"  "},{id:4,image:"https://img.youtube.com/vi/HjqfZ-Matyk/maxresdefault.jpg",videoUrl:"https://www.youtube.com/watch?v=HjqfZ-Matyk&ab_channel=NavGurukul",englishCaption:"2 mins introduction to NavGurukul",hindiCaption:"  2   ",marathiCaption:" 2  "}],Ti={english:{heading:"Software Engineering Scholarship",title:"Navgurukul",subtitle:"Welcome to",description:"Learn coding, problem-solving, and critical thinking in a thriving community of learners. Take the scholarship test today and begin your journey towards becoming a software engineer.",buttonText:"Get Started",learnMoreText:"Learn More",footerText:"For more queries, email at",footerContact:"hi@navgurukul.org",imageUrl:"https://admissions.navgurukul.org/assets/logo.71054d69.png",features:{realProjects:"Real Projects",community:"Community",mentorship:"Mentorship"}},hindi:{heading:"  ",title:"",subtitle:"   ",description:"     , -,                  ",buttonText:" ",learnMoreText:" ",footerText:"     :",footerContact:"hi@navgurukul.org",imageUrl:"https://admissions.navgurukul.org/assets/logo.71054d69.png",features:{realProjects:" ",community:"",mentorship:""}},marathi:{heading:"  ",title:"",subtitle:"   ",description:",  ,         .            .",buttonText:" ",learnMoreText:"  ",footerText:" ,  :",footerContact:"hi@navgurukul.org",imageUrl:"https://admissions.navgurukul.org/assets/logo.71054d69.png",features:{realProjects:" ",community:"",mentorship:""}}},Hit=()=>{const[e,t]=w.useState(0),{selectedLanguage:r,setSelectedLanguage:n}=vR(),a=Rn(),s=()=>t(o=>(o+1)%Tl.length);w.useEffect(()=>{const o=setInterval(s,5e3);return()=>clearInterval(o)},[]),w.useEffect(()=>{const o=localStorage.getItem("selectedLanguage");o&&n(o)},[n]),w.useEffect(()=>{r&&localStorage.setItem("selectedLanguage",r)},[r]);const i=async()=>{var h;const o=localStorage.getItem("user"),u=localStorage.getItem("testStarted")==="true",d=localStorage.getItem("testCompleted")==="true",c=localStorage.getItem("allowRetest")==="true";if(!o){a("/students/login");return}try{const f=JSON.parse(o).email;if(f){const{getCompleteStudentData:g}=await Vg(async()=>{const{getCompleteStudentData:v}=await Promise.resolve().then(()=>Pfe);return{getCompleteStudentData:v}},void 0),m=await g(f),x=m.data.exam_sessions||[],y=x.length>0?x.reduce((v,b)=>new Date(b.created_at)>new Date(v.created_at)?b:v):null;if(y)if(y.is_passed){const v=m.data.interview_learner_round||[],b=v.length>0?v.reduce((S,_)=>new Date(_.created_at)>new Date(S.created_at)?_:S):null;if((h=b==null?void 0:b.learning_round_status)==null?void 0:h.includes("Pass")){const S=m.data.interview_cultural_fit_round||[],_=S.length>0?S.reduce((C,k)=>new Date(k.created_at)>new Date(C.created_at)?k:C):null;a("/students/final-result");return}else{a("/students/final-result");return}}else if(c){a("/students/test/start");return}else{a("/students/final-result");return}else{if(d&&!c){a("/students/final-result");return}if(u||c){a("/students/test/start");return}a("/students/details/instructions")}}}catch(p){if(console.error("Error fetching student data:",p),d&&!c){a("/students/final-result");return}if(u||c){a("/students/test/start");return}a("/students/details/instructions")}};return l.jsxs("div",{className:"min-h-screen flex flex-col bg-white",children:[l.jsxs("header",{className:"sticky top-0 flex justify-between items-center px-4 md:px-8 lg:px-12 py-3 md:py-4 bg-white border-b border-gray-200 z-50 backdrop-blur-sm bg-white/95",children:[l.jsxs("div",{className:"flex items-center space-x-2 md:space-x-3",children:[l.jsx("img",{src:Ti[r].imageUrl,alt:"NavGurukul Logo",className:"h-8 md:h-10 lg:h-12"}),l.jsx("span",{className:"hidden sm:block text-lg md:text-xl font-bold text-gray-800",children:Ti[r].title})]}),l.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[l.jsxs("select",{value:r,onChange:o=>n(o.target.value),className:"border border-gray-300 rounded-lg px-2 py-1.5 md:px-4 md:py-2 text-gray-700 text-xs md:text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white hover:border-orange-400 transition-colors cursor-pointer",children:[l.jsx("option",{value:"english",children:"English"}),l.jsx("option",{value:"hindi",children:""}),l.jsx("option",{value:"marathi",children:""})]}),l.jsx(le,{onClick:i,size:"sm",className:"hidden sm:flex bg-orange-500 hover:bg-orange-600 text-white text-xs md:text-sm px-3 md:px-4",children:Ti[r].buttonText})]})]}),l.jsx("section",{className:"flex-1 flex items-center py-8 md:py-12 lg:py-16 bg-gradient-to-br from-orange-50 to-orange-100",children:l.jsx("div",{className:"w-full px-4 md:px-6 lg:px-8",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-10 lg:gap-12 items-center max-w-[90rem] mx-auto px-6 md:px-12 lg:px-20",children:[l.jsxs("div",{className:"space-y-4 md:space-y-6 order-2 md:order-1",children:[l.jsx("div",{className:"inline-block",children:l.jsx("span",{className:"bg-orange-500/10 text-orange-600 md:rounded-full text-3xl md:text-3xl lg:text-base font-semibold",children:Ti[r].heading})}),l.jsxs("h1",{className:"text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold leading-tight",children:[Ti[r].subtitle," ",l.jsx("span",{className:"text-orange-500",children:Ti[r].title})]}),l.jsx("p",{className:"text-base md:text-lg lg:text-xl text-gray-600 leading-relaxed",children:Ti[r].description}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4 pt-2 md:pt-4",children:[l.jsxs(le,{onClick:i,className:"bg-orange-500 hover:bg-orange-600 text-white group h-11 md:h-12 px-5 md:px-6 text-sm md:text-base w-full sm:w-auto",children:[Ti[r].buttonText,l.jsx(ele,{className:"ml-2 w-4 h-4 md:w-5 md:h-5 group-hover:translate-x-1 transition-transform"})]}),l.jsx(le,{variant:"outline",className:"h-11 md:h-12 px-5 md:px-6 text-sm md:text-base border-orange-500 text-orange-600 hover:bg-orange-50 w-full sm:w-auto",onClick:()=>{window.open("https://www.navgurukul.org/","_blank")},children:Ti[r].learnMoreText})]})]}),l.jsxs("div",{className:"relative order-1 md:order-2",children:[l.jsx("div",{className:"absolute inset-0 bg-orange-500/5 rounded-2xl blur-3xl"}),l.jsxs("div",{className:"relative w-full overflow-hidden rounded-xl md:rounded-2xl shadow-xl md:shadow-2xl",children:[l.jsx("a",{href:Tl[e].videoUrl,target:"_blank",rel:"noreferrer",children:l.jsx("img",{src:Tl[e].image,alt:r==="english"?Tl[e].englishCaption:r==="hindi"?Tl[e].hindiCaption:Tl[e].marathiCaption,className:"w-full h-auto object-cover aspect-video"})}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black text-white text-center py-2 md:py-3 text-lg md:text-sm lg:text-base px-2",children:r==="english"?Tl[e].englishCaption:r==="hindi"?Tl[e].hindiCaption:Tl[e].marathiCaption})]})]})]})})}),l.jsxs("footer",{className:"bg-gray-100 text-center text-xs md:text-sm py-4 md:py-6 mt-auto px-4",children:[Ti[r].footerText," ",l.jsx("a",{href:`mailto:${Ti[r].footerContact}`,className:"text-blue-600 hover:underline break-all md:break-normal",children:Ti[r].footerContact})]})]})},qit=()=>{const e=Rn(),{selectedLanguage:t}=vR(),[r,n]=w.useState(null),[a,s]=w.useState(3600),[i,o]=w.useState([]),[u,d]=w.useState(!0),c=localStorage.getItem("studentId")||"";w.useEffect(()=>{(async()=>{try{const x=await dV(t,c);o(x||[]),n((x==null?void 0:x.length)||0)}catch(x){console.error("Error fetching exam data:",x)}finally{d(!1)}})()},[t]);const h=m=>{const x=Math.floor(m/3600),y=Math.floor(m%3600/60);return`${x>0?`${x} Hour${x>1?"s":""}`:""} ${y>0?`${y} Minute${y>1?"s":""}`:""}`.trim()},f=(()=>{const m=a?h(a):"...",x=r??"...";switch(t){case"hindi":return{heading:"  :",description1:",            ",description2:"     ",description3:` ${m}  ${x}     `,buttonText:"  "};case"marathi":return{heading:"  :",description1:",      .    .",description2:"   ",description3:` ${m}  ${x}    `,buttonText:"  "};default:return{heading:"One More Thing:",description1:"You will be asked some questions in the test. Answer carefully.",description2:"But also keep an eye on time.",description3:`You have to answer ${x} questions in ${m}.`,buttonText:"START TEST"}}})(),g=()=>{!i.length||!a||(console.log("questions",i),localStorage.setItem("testStarted","true"),localStorage.setItem("testCompleted","false"),localStorage.setItem("allowRetest","false"),e("/students/test/section",{state:{questions:i,duration:a}}))};return u?l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-orange-400 to-red-500",children:l.jsx("p",{className:"text-white text-lg",children:"Loading test details..."})}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center",children:[l.jsx(Kg,{}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full flex flex-col items-center justify-center",children:[l.jsx("h1",{className:"text-2xl font-semibold mb-4",children:f.heading}),l.jsx("p",{className:"text-gray-600 mb-2",children:f.description1}),l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:f.description2}),l.jsx("p",{className:"text-gray-800 font-semibold mb-2",children:f.description3}),l.jsx("button",{onClick:g,className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200 shadow-lg",children:f.buttonText})]})]})},Vf="student_test_progress",Git=e=>{const t=Math.floor(e/60),r=e%60;return`${t}:${r.toString().padStart(2,"0")}`},Kit=()=>{const e=Rn(),t=_s(),{tests:r,setTests:n}=OC(),{questions:a,duration:s}=t.state||{},[i,o]=w.useState(a||[]),[u,d]=w.useState(0),[c,h]=w.useState({}),[p,f]=w.useState(s||null),[g,m]=w.useState(!1);w.useEffect(()=>{if(!a||!s)return;const b=localStorage.getItem(Vf);if(b){const{answers:N,currentIndex:S,examStartTime:_,duration:C}=JSON.parse(b),k=Math.floor((Date.now()-_)/1e3),I=C-k;I>0?(h(N||{}),d(S||0),f(I)):localStorage.removeItem(Vf)}else localStorage.setItem(Vf,JSON.stringify({answers:{},currentIndex:0,examStartTime:Date.now(),duration:s}))},[a,s]),w.useEffect(()=>{if(p===null)return;if(p<=0){y();return}const b=setInterval(()=>f(N=>N!==null?N-1:0),1e3);return()=>clearInterval(b)},[p]),w.useEffect(()=>{if(p===null)return;const b=localStorage.getItem(Vf);if(b){const N=JSON.parse(b);localStorage.setItem(Vf,JSON.stringify({...N,answers:c,currentIndex:u}))}},[c,u,p]);const x=b=>{const N=i[u].id;h({...c,[N]:b})},y=()=>{m(!0)},v=async()=>{m(!1);const b=localStorage.getItem("studentId");if(!b){console.error("Student ID not found"),alert("Error: Student ID not found. Please log in again.");return}const N=i.map(_=>({question_id:_.id,selected_answer:c[_.id]!==void 0?[c[_.id]]:[]})),S={student_id:Number(b),answers:N};try{const _=await sV(S);console.log("Exam submission response:",_);const{exam_session:C,summary:k}=_.data,I=C.obtained_marks,T=C.total_marks,j=C.is_passed;console.log("totalPossibleScore",T,"Score:",I,"Passed:",j,"Summary:",k),localStorage.removeItem(Vf),n(E=>{const O=E.findIndex(M=>M.name==="Screening Test");if(O!==-1){const M=[...E];return M[O]={...M[O],score:I,status:j?"Pass":"Fail",action:"Completed"},M}else return[...E,{id:Date.now(),name:"Screening Test",score:I,status:j?"Pass":"Fail",action:"Completed",slotBooking:{status:null}}]}),localStorage.setItem("testStarted","false"),localStorage.setItem("testCompleted","true"),localStorage.setItem("allowRetest","false"),e("/students/test/result",{state:{score:I,total:T,apiResponse:_.data,summary:k,isPassed:j}})}catch(_){console.error("Error submitting exam:",_),alert("Failed to submit exam. Please try again."),m(!1)}};return p===null||i.length===0?l.jsx("div",{className:"text-center mt-10 text-lg font-semibold",children:"Loading test..."}):l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-3xl flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"font-bold text-xl",children:["Question ",u+1," / ",i.length]}),l.jsxs("div",{className:"bg-red-100 text-red-600 font-bold px-4 py-2 rounded-lg shadow",children:[" ",Git(p)]})]}),l.jsx("div",{className:"border border-gray-300 rounded-xl p-6 mb-6 bg-gray-50 shadow-inner",children:l.jsx("p",{className:"text-lg font-medium text-gray-800 leading-relaxed",children:i[u].question})}),l.jsx("div",{className:"space-y-3",children:i[u].options.map((b,N)=>{const S=i[u].id;return l.jsxs("label",{className:`block border rounded-lg px-4 py-3 cursor-pointer transition ${c[S]===N?"bg-blue-100 border-blue-500":"hover:bg-gray-100 border-gray-300"}`,children:[l.jsx("input",{type:"radio",name:`q-${S}`,checked:c[S]===N,onChange:()=>x(N),className:"hidden"}),b]},N)})}),l.jsxs("div",{className:"mt-8 flex justify-between",children:[l.jsx("button",{disabled:u===0,onClick:()=>d(b=>b-1),className:"px-6 py-2 bg-gray-300 rounded-lg font-medium disabled:opacity-50",children:"Previous"}),u===i.length-1?l.jsxs(Wr,{open:g,onOpenChange:m,children:[l.jsx(Fge,{asChild:!0,children:l.jsx("button",{className:"px-6 py-2 bg-green-600 text-white rounded-lg font-medium shadow hover:bg-green-700",onClick:y,children:"Submit"})}),l.jsxs(Vr,{children:[l.jsxs(Hr,{children:[l.jsx(qr,{children:"Confirm Submission"}),l.jsx(yh,{children:"Are you sure you want to submit the test? You wont be able to change your answers afterwards."})]}),l.jsxs(fo,{className:"flex justify-end gap-4",children:[l.jsx(le,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),l.jsx(le,{onClick:v,children:"Yes, Submit"})]})]})]}):l.jsx("button",{onClick:()=>d(b=>b+1),className:"px-6 py-2 bg-orange-500 text-white rounded-lg font-medium shadow hover:bg-orange-600",children:"Next"})]})]})})},MS="admissions@navgurukul.org",Qit="+919730879683",Xit="+91 97308 79683",Yit=()=>{const{tests:e,setTests:t}=OC(),r=Rn(),n=_s(),{toast:a}=Wt(),[s,i]=w.useState(!1),{score:o=0,total:u=0,isPassed:d=!1}=n.state||{},c=d?"pass":"fail";e.find(p=>p.name==="Screening Test");const h=async()=>{try{i(!0);const p=YA();if(!p||!p.email){a({title:" Login Required",description:"Please login to view your results",variant:"default",className:"border-orange-500 bg-orange-50 text-orange-900"}),r("/student-login");return}const f=await t$(p.email);if(!f){a({title:" Unable to Load Data",description:"Failed to fetch student data",variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"});return}t(g=>g.map(m=>m.name==="Screening Test"?{...m,status:c==="pass"?"Pass":"Fail",score:o}:m)),r("/students/final-result",{state:{studentData:f,fromScreening:!0}})}catch(p){console.error("Error fetching student data:",p),a({title:" Unable to Load Data",description:ut(p),variant:"destructive",className:"border-red-500 bg-red-50 text-red-900"})}finally{i(!1)}};return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:[l.jsx(Kg,{}),l.jsx("div",{className:"bg-white rounded-3xl shadow-2xl p-10 max-w-2xl w-full flex flex-col items-center text-center",children:c==="pass"?l.jsxs(l.Fragment,{children:[l.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Congratulations! "}),l.jsxs("h2",{className:"text-2xl md:text-3xl font-semibold text-gray-800 mb-6",children:["You passed the test with a score of"," ",l.jsx("span",{className:"text-orange-500",children:o})," /"," ",l.jsx("span",{className:"text-orange-500",children:u})]}),l.jsx("p",{className:"text-gray-700 mb-2",children:"Thank you for applying to NavGurukul Program."}),l.jsx("p",{className:"text-gray-700 mb-4",children:"Our admission team will contact you for the next steps."}),l.jsxs("p",{className:"text-gray-700 mb-4",children:["You can send us a mail on "," ",l.jsx("a",{href:`mailto:${MS}`,className:"text-blue-500",children:MS}),"."]}),l.jsx("button",{onClick:h,disabled:s,className:"mt-6 bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:s?l.jsxs(l.Fragment,{children:[l.jsx(ya,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):"Go to Result Section"})]}):l.jsxs(l.Fragment,{children:[l.jsx("h1",{className:"text-3xl font-semibold text-gray-900 mb-6",children:"Oh Sorry!"}),l.jsxs("p",{className:"text-gray-700 mb-4 text-lg",children:["You could not clear the NavGurukul Preliminary Test this time. You have scored ",l.jsx("span",{className:"font-bold",children:o})," marks in the test. Don't worry, you can give the test again after some preparation."]}),l.jsxs("p",{className:"text-gray-700 mb-6",children:["You can use this study guide for more maths practice"," ",l.jsx("a",{href:"https://www.khanacademy.org/math",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 font-medium underline hover:text-blue-800",children:"Click Here"}),". Prepare, Practice and Pass"]}),l.jsx("button",{onClick:h,disabled:s,className:"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:s?l.jsxs(l.Fragment,{children:[l.jsx(ya,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):"OK"})]})})]})};function Jit({student:e}){return l.jsx(Et,{className:"border border-gray-400 bg-white shadow-md p-6 mb-6",children:l.jsxs("div",{className:"flex items-center gap-5",children:[l.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 border border-green-200 flex items-center justify-center text-3xl shadow-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("h2",{className:"text-2xl font-semibold text-gray-900",children:["Congratulations, ",e.first_name,"!"]}),l.jsx("p",{className:"text-sm text-gray-700 mt-1",children:"You have successfully completed all online assessments."}),l.jsx("p",{className:"text-sm font-semibold text-green-600 mt-2",children:"Your offer letter has been sent to your registered email. Please check your inbox for next steps."})]})]})})}const Zit=()=>l.jsx("footer",{className:"w-full bg-gray-100 border-t rounded-b-xl py-4",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 text-sm text-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(uh,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Email:"}),l.jsx("a",{href:`mailto:${MS}`,className:"text-blue-600 hover:underline",children:MS})]}),l.jsx("span",{className:"hidden sm:inline text-gray-400",children:"|"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(wE,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"font-medium",children:"Helpline:"}),l.jsx("a",{href:`tel:${Qit}`,className:"text-blue-600 hover:underline",children:Xit})]})]}),l.jsx("p",{className:"mt-3 text-center text-xs text-gray-500",children:"For any issues related to results or slot booking, contact admissions support."})]})});function eot(){var f,g,m,x,y;const[e,t]=w.useState(null),[r,n]=w.useState(null),[a,s]=w.useState(!0),{tests:i,setTests:o}=OC(),u=Rn(),{toast:d}=Wt(),c=v=>{if(!v)return null;const b=String(v).toLowerCase();return b==="pending"?"Pending":b==="booked"?"Booked":b==="cancelled"?"Cancelled":b==="completed"?"Completed":null};w.useEffect(()=>{(async()=>{var b,N,S,_,C,k,I,T,j,E,O;try{s(!0);const M=localStorage.getItem("user");let W="";if(M&&(W=JSON.parse(M).email),!W){const q=localStorage.getItem("studentData");if(q){const P=JSON.parse(q);W=((b=P==null?void 0:P.student)==null?void 0:b.email)||(P==null?void 0:P.email)||""}}if(W){const q=await r$(W);n(q);const P=(N=q==null?void 0:q.data)==null?void 0:N.student;if(P){t({firstName:P.first_name||"",middleName:P.middle_name||"",lastName:P.last_name||"",email:P.email||"",whatsappNumber:P.whatsapp_number||P.phone_number||"",district:P.district||"",state:P.state||""});const A=[],L=((S=q==null?void 0:q.data)==null?void 0:S.exam_sessions)||[];L.length>0&&(L.sort((Q,U)=>new Date(Q.created_at).getTime()-new Date(U.created_at).getTime()),L.forEach((Q,U)=>{const F=String(Q.status||"").toLowerCase();let te="Fail";F.includes("pass")&&(te="Pass"),A.push({id:100+U,name:L.length>1?`Screening Test (Attempt ${U+1})`:"Screening Test",status:te,score:Q.obtained_marks??null,action:te==="Pass"?"Completed":"Failed",slotBooking:{status:null,scheduledTime:Q.date_of_test||""}})}));const z=L.some(Q=>Q.status&&String(Q.status).toLowerCase().includes("pass")),$=(Q,U,F)=>{const te=U==="LR"?"Learning Round":"Cultural Fit Round",pe=Q.filter(ve=>{var je;const fe=ve.title||"";return((je=ve.status)==null?void 0:je.toLowerCase())==="cancelled"?!1:F===1?!!(!/\(Attempt \d+\)/i.test(fe)&&fe.includes(te)||/\(Attempt 1\)/i.test(fe)):new RegExp(`\\(Attempt ${F}\\)`,"i").test(fe)});return pe.length>0?pe[pe.length-1]:null},V=((_=q==null?void 0:q.data)==null?void 0:_.interview_learner_round)||[],B=((C=q==null?void 0:q.data)==null?void 0:C.interview_schedules_lr)||[];V.sort((Q,U)=>new Date(Q.created_at).getTime()-new Date(U.created_at).getTime()),V.forEach((Q,U)=>{var Qe;const F=Q.learning_round_status||"";let te="Pending";F.toLowerCase().includes("pass")?te="Pass":F.toLowerCase().includes("fail")&&(te="Fail");const pe=U+1,ve=$(B,"LR",pe);let fe="",Me="Completed";ve?(fe=`${ve.date}T${ve.start_time}`,Me=te==="Pending"?c(((Qe=ve.slot_details)==null?void 0:Qe.status)||ve.status):"Completed"):fe=Q.scheduled_time||Q.scheduled_at||"";let je=!1;fe&&(je=new Date(fe)<new Date),A.push({id:200+U,name:V.length>1?`Learning Round (Attempt ${U+1})`:"Learning Round",status:te,score:null,action:te==="Pass"||te==="Fail"||je?"Completed":"slot-book",slotBooking:{status:te==="Pass"||te==="Fail"||je?"Completed":Me,scheduledTime:fe}})});const Y=V.length>0?V[V.length-1]:null;let re="Pending";if(Y){const Q=Y.learning_round_status||"";Q.toLowerCase().includes("pass")?re="Pass":Q.toLowerCase().includes("fail")&&(re="Fail")}if(z&&V.length===0){const Q=$(B,"LR",1);let U="",F=null;Q&&(U=`${Q.date}T${Q.start_time}`,F=new Date(U)<new Date?"Completed":c(((k=Q.slot_details)==null?void 0:k.status)||Q.status));const te=U?new Date(U)<new Date:!1;A.push({id:2,name:"Learning Round",status:"Pending",score:null,action:te?"Completed":"slot-book",slotBooking:{status:F,scheduledTime:U}})}const ae=((I=q==null?void 0:q.data)==null?void 0:I.interview_cultural_fit_round)||[],K=((T=q==null?void 0:q.data)==null?void 0:T.interview_schedules_cfr)||[];ae.sort((Q,U)=>new Date(Q.created_at).getTime()-new Date(U.created_at).getTime()),ae.forEach((Q,U)=>{var Qe;const F=Q.cultural_fit_status||"";let te="Pending";F.toLowerCase().includes("pass")?te="Pass":F.toLowerCase().includes("fail")&&(te="Fail");const pe=U+1,ve=$(K,"CFR",pe);let fe="",Me="Completed";ve?(fe=`${ve.date}T${ve.start_time}`,Me=te==="Pending"?c(((Qe=ve.slot_details)==null?void 0:Qe.status)||ve.status):"Completed"):fe=Q.scheduled_time||Q.scheduled_at||"";let je=!1;fe&&(je=new Date(fe)<new Date),A.push({id:300+U,name:ae.length>1?`Cultural Fit Round (Attempt ${U+1})`:"Cultural Fit Round",status:te,score:null,action:te==="Pass"||te==="Fail"||je?"Completed":"slot-book",slotBooking:{status:te==="Pass"||te==="Fail"||je?"Completed":Me,scheduledTime:fe}})});const J=ae.length>0?ae[ae.length-1]:null;let Z="Pending";if(J){const Q=J.cultural_fit_status||"";Q.toLowerCase().includes("pass")?Z="Pass":Q.toLowerCase().includes("fail")&&(Z="Fail")}if(re==="Pass"&&ae.length===0){const Q=$(K,"CFR",1);let U="",F=null;Q&&(U=`${Q.date}T${Q.start_time}`,F=new Date(U)<new Date?"Completed":c(((j=Q.slot_details)==null?void 0:j.status)||Q.status));const te=U?new Date(U)<new Date:!1;A.push({id:3,name:"Cultural Fit Round",status:"Pending",score:null,action:te?"Completed":"slot-book",slotBooking:{status:F,scheduledTime:U}})}if(re==="Fail"){const Q=V.length+1,U=$(B,"LR",Q);let F="",te=null;U&&(F=`${U.date}T${U.start_time}`,te=new Date(F)<new Date?"Completed":c(((E=U.slot_details)==null?void 0:E.status)||U.status));const pe=F?new Date(F)<new Date:!1;A.push({id:200+V.length,name:`Learning Round (Attempt ${Q})`,status:"Pending",score:null,action:pe?"Completed":"slot-book",slotBooking:{status:te,scheduledTime:F}})}if(Z==="Fail"){const Q=ae.length+1,U=$(K,"CFR",Q);let F="",te=null;U&&(F=`${U.date}T${U.start_time}`,te=new Date(F)<new Date?"Completed":c(((O=U.slot_details)==null?void 0:O.status)||U.status));const pe=F?new Date(F)<new Date:!1;A.push({id:300+ae.length,name:`Cultural Fit Round (Attempt ${Q})`,status:"Pending",score:null,action:pe?"Completed":"slot-book",slotBooking:{status:te,scheduledTime:F}})}o(A)}}else{const q=localStorage.getItem("studentFormData");q&&t(JSON.parse(q))}}catch(M){console.error("Error fetching student data:",M),d({variant:"destructive",title:" Unable to Load Data",description:ut(M),className:"border-red-500 bg-red-50 text-red-900"})}finally{s(!1)}})()},[o,d]);const h=(v,b)=>{let N;b.includes("Learning Round")?N="LR":(b.includes("Cultural Fit Round")||b.includes("Culture Fit Round"))&&(N="CFR"),u(`/students/slot-booking/${v}`,{state:{slot_type:N}})},p=()=>{localStorage.setItem("testStarted","false"),localStorage.setItem("testCompleted","false"),localStorage.setItem("allowRetest","true"),u("/students/test/start",{replace:!0})};return a?l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-orange-400 to-red-500",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),l.jsx("p",{className:"text-white text-lg",children:"Loading student data"})]})}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 p-4 flex flex-col",children:[l.jsx("div",{className:"flex-1 flex",children:l.jsxs("div",{className:"bg-white rounded-t-md shadow-2xl p-6 w-full overflow-y-auto",children:[l.jsxs("header",{className:"mb-6",children:[l.jsx(Kg,{className:"from-orange-400 to-red-500"}),l.jsx("h1",{className:"text-2xl font-bold",children:"Student Results"}),l.jsx("p",{className:"text-gray-600",children:"Track your test results and interview slot booking status."})]}),l.jsxs(Et,{className:"mb-6",children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Student Details"})}),l.jsxs(jt,{className:"grid sm:grid-cols-2 gap-4",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-semibold",children:"Name:"})," ",(e==null?void 0:e.firstName)||"-"," ",(e==null?void 0:e.middleName)||""," ",(e==null?void 0:e.lastName)||""]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-semibold",children:"Email:"})," ",(e==null?void 0:e.email)||"-"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-semibold",children:"Phone Number:"})," ",(e==null?void 0:e.whatsappNumber)||"-"]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-semibold",children:"State:"})," ",e!=null&&e.state?e.state:"-"]})]})]}),((g=(f=r==null?void 0:r.data)==null?void 0:f.final_decisions)==null?void 0:g.length)>0&&((x=(m=r.data.final_decisions.sort((v,b)=>new Date(b.created_at).getTime()-new Date(v.created_at).getTime())[0])==null?void 0:m.offer_letter_status)==null?void 0:x.toLowerCase())==="offer sent"&&l.jsx(Jit,{student:(y=r.data)==null?void 0:y.student}),l.jsxs(Et,{children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Test Results & Slot Booking"})}),l.jsx(jt,{children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full border border-gray-200 text-left rounded-lg",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 border",children:"Stage"}),l.jsx("th",{className:"px-4 py-2 border",children:"Status"}),l.jsx("th",{className:"px-4 py-2 border",children:"Scheduled Time"}),l.jsx("th",{className:"px-4 py-2 border",children:"Actions"}),l.jsx("th",{className:"px-4 py-2 border",children:"Marks"})]})}),l.jsx("tbody",{children:i&&i.length>0?i.map(v=>{var I,T,j;const b=(I=v.slotBooking)==null?void 0:I.status,N=b==="Booked"||b==="Pending",S=b==="Completed",_=b==="Cancelled";let C=!1;(T=v.slotBooking)!=null&&T.scheduledTime&&(C=new Date(v.slotBooking.scheduledTime)<new Date);const k=i.some(E=>v.name.includes("Screening Test")&&E.name.includes("Screening Test")||v.name.includes("Learning Round")&&E.name.includes("Learning Round")||v.name.includes("Cultural Fit Round")&&E.name.includes("Cultural Fit Round")?E.status==="Pass":!1);return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-2 border",children:v.name}),l.jsx("td",{className:"px-4 py-2 border",children:l.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${v.status==="Pass"?"bg-green-100 text-green-700":v.status==="Pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:v.status})}),l.jsx("td",{className:"px-4 py-2 border",children:(j=v.slotBooking)!=null&&j.scheduledTime?new Date(v.slotBooking.scheduledTime).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}):"-"}),l.jsx("td",{className:"px-4 py-2 border",children:v.name.includes("Screening Test")?v.status==="Pass"?l.jsx("p",{className:"text-gray-600",children:"-"}):k?l.jsx(le,{disabled:!0,className:"bg-gray-300 text-gray-500 cursor-not-allowed",children:"Retest"}):v.status==="Fail"?l.jsx(le,{onClick:p,className:"bg-orange-500 hover:bg-orange-600",children:"Retest"}):l.jsx("p",{className:"text-gray-600",children:"-"}):l.jsx(l.Fragment,{children:v.action==="Completed"?l.jsx("p",{className:"text-gray-600",children:"-"}):k?l.jsx(le,{disabled:!0,className:"bg-gray-300 text-gray-500 cursor-not-allowed",variant:"outline",children:N?"Reschedule":"Book Slot"}):C&&!S?l.jsx(le,{disabled:!0,className:"bg-gray-300 text-gray-500 cursor-not-allowed",variant:"outline",children:"Interview Completed"}):N&&!_?l.jsx(le,{onClick:()=>h(v.id,v.name),variant:"outline",children:"Reschedule"}):l.jsx(le,{onClick:()=>h(v.id,v.name),className:"bg-green-600 hover:bg-green-700",children:"Book Slot"})})}),l.jsx("td",{className:"px-4 py-2 border",children:v.score??"-"})]},v.id)}):l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"No test data available"})})})]})})})]})]})}),l.jsx(Zit,{})]})}function tot(){const e=Rn(),{toast:t}=Wt(),{user:r,isAuthenticated:n,loading:a,renderGoogleSignInButton:s}=Do({skipAutoNavigation:!0}),i=w.useRef(null),[o,u]=w.useState({name:"",lastname:"",phone:""}),[d,c]=w.useState(!1),[h,p]=w.useState(!1);w.useEffect(()=>{if(i.current&&!a&&!n){const m=setTimeout(()=>{s("google-signin-button-student")},100);return()=>clearTimeout(m)}},[a,s,n]),w.useEffect(()=>{if(h)return;if(!n){console.log(" Not authenticated yet, waiting...");return}if(!r){console.log(" googleUser is undefined, waiting...");return}(async()=>{let x=localStorage.getItem("authToken");const y=localStorage.getItem("user"),v=sessionStorage.getItem("google_credential");if(!(v!==null)&&!x){console.log(" No fresh login and no existing session - this shouldn't happen"),p(!0);return}if((!x||x==="undefined")&&v){localStorage.setItem("authToken",v),x=v;try{const _=v.split("."),C=JSON.parse(atob(_[1]))}catch(_){console.error(" Error parsing Google token:",_)}}else x&&x!=="undefined"?console.log(" Using backend token (Admin/User)"):console.error(" No valid token available - neither backend nor Google credential");if(r&&!y){const _={id:r.id,name:r.name,email:r.email,profile_pic:r.avatar,user_role_id:3,role_name:"STUDENT"};localStorage.setItem("user",JSON.stringify(_)),console.log(" Stored student user data")}const N=r.role_id,S=r.role_name;if(N===1||N===2||S==="ADMIN"||S==="USER")console.log(" Admin/User detected - navigating to dashboard"),localStorage.setItem("role",S||"user"),localStorage.setItem("userRole",JSON.stringify(S)),t({title:" Welcome!",description:`Successfully signed in as ${r.name}`,variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),p(!0),sessionStorage.removeItem("google_credential"),setTimeout(()=>{e("/")},500);else try{const _=await t$(r.email),C=(_==null?void 0:_.data)??_??null;localStorage.setItem("studentData",JSON.stringify(C));const k=(C==null?void 0:C.student)??C??null,I=(k==null?void 0:k.student_id)??(k==null?void 0:k.id)??r.id;localStorage.setItem("studentId",String(I)),localStorage.setItem("role","student"),localStorage.setItem("userRole",JSON.stringify("student"));const T=!!(k&&k.student_id&&k.dob&&k.gender),j=Array.isArray(C==null?void 0:C.exam_sessions)?C.exam_sessions:[],E=j.length>0,O=j.some(W=>E||!!W.is_passed);console.log("Derived Flags:",{registrationDone:T,testStarted:E});const M=!!((C==null?void 0:C.allow_retest)??!1);if(localStorage.setItem("registrationDone",T?"true":"false"),localStorage.setItem("testStarted",E?"true":"false"),localStorage.setItem("testCompleted",E?"true":"false"),localStorage.setItem("allowRetest",M?"true":"false"),t({title:g().successMessage,description:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx($N,{className:"w-5 h-5 text-green-500"}),l.jsxs("span",{children:["Welcome back, ",r.name,"! "]})]}),variant:"default",className:"border-green-500 bg-green-50 text-green-900"}),p(!0),sessionStorage.removeItem("google_credential"),console.log(T),!T){e("/students/details/instructions",{state:{googleEmail:r.email}});return}if(E&&!O){e("/students/test/start");return}if(O&&!M){e("/students/final-result");return}e("/students/details/instructions",{state:{googleEmail:r.email}})}catch(_){console.error("Error fetching student data:",_),localStorage.setItem("studentData",JSON.stringify(null)),localStorage.setItem("studentId",String(r.id)),localStorage.setItem("role","student"),localStorage.setItem("userRole",JSON.stringify("student")),p(!0),sessionStorage.removeItem("google_credential"),e("/students/details/instructions",{state:{googleEmail:r.email}})}})()},[r,n,e,h]);const f={english:{title:"Login",description:"Sign in with your Google account to continue.",successMessage:"Login Successful!",failureMessage:"Login Failed. Please try again."},hindi:{title:"",description:"     Google     ",successMessage:" !",failureMessage:"     "},marathi:{title:"",description:"   Google    .",successMessage:" !",failureMessage:" .    ."}},g=()=>{switch(localStorage.getItem("selectedLanguage")||"english"){case"hindi":return f.hindi;case"marathi":return f.marathi;case"english":default:return f.english}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center p-4",children:l.jsxs(Et,{className:"w-full max-w-md shadow-lg",children:[l.jsxs(Pt,{className:"space-y-1 text-center",children:[l.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[l.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center",children:l.jsx(yo,{className:"w-6 h-6 text-white"})}),l.jsx(Lt,{className:"text-2xl font-bold",children:g().title})]}),l.jsx(xi,{children:g().description})]}),l.jsx(jt,{className:"space-y-4",children:l.jsx("div",{id:"google-signin-button-student",ref:i,className:"w-full flex justify-center"})})]})})}const N1=({children:e})=>{const r=_s().pathname,n=localStorage.getItem("studentId");localStorage.getItem("testStarted");const a=localStorage.getItem("testCompleted")==="true",s=localStorage.getItem("allowRetest")==="true",i=localStorage.getItem("registrationDone")==="true";return n?!i&&r.startsWith("/students/test")?l.jsx(Jo,{to:"/students/details/instructions",replace:!0}):a&&!s&&!["/students/test/start","/students/test/section","/students/test/result"].includes(r)&&!r.startsWith("/students/final-result")?l.jsx(Jo,{to:"/students/final-result",replace:!0}):s&&r.startsWith("/students/final-result")?l.jsx(Jo,{to:"/students/test/start",replace:!0}):i&&r.startsWith("/students/details/instructions")?l.jsx(Jo,{to:"/students/test/start",replace:!0}):l.jsx(l.Fragment,{children:e}):l.jsx(Jo,{to:"/students",replace:!0})};function rot(){const[e,t]=w.useState([]);w.useEffect(()=>{t([{id:1,name:"Offer_Letter_July.pdf",url:"/mock/offer_july.pdf"},{id:2,name:"Convern_Letter.pdf",url:"/mock/offer_aug.pdf"},{id:3,name:"Required_Items_List_Which_In_Campus.pdf",url:"/mock/offer_aug.pdf"}])},[]);const r=n=>{const a=document.createElement("a");a.href=n.url,a.download=n.name,a.click()};return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-400 to-red-500 flex",children:[l.jsx(Kg,{}),l.jsx("div",{className:"p-6 min-w-full overflow-y-auto",children:l.jsxs(Et,{className:"h-[90vh] rounded-2xl",children:[l.jsx(Pt,{children:l.jsx(Lt,{children:"Documents"})}),l.jsx(jt,{children:e.length>0?l.jsxs("table",{className:"w-full border-collapse text-left text-gray-700",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border px-4 py-2 w-12",children:"#"}),l.jsx("th",{className:"border px-4 py-2",children:"File Name"}),l.jsx("th",{className:"border px-4 py-2 w-32 text-center",children:"Download"})]})}),l.jsx("tbody",{children:e.map((n,a)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border px-4 py-2",children:a+1}),l.jsx("td",{className:"border px-4 py-2",children:n.name}),l.jsx("td",{className:"border px-4 py-2 text-center",children:l.jsx(le,{size:"sm",onClick:()=>r(n),variant:"default",children:"Download"})})]},n.id))})]}):l.jsx("p",{className:"text-gray-500",children:"No documents available."})})]})})]})}const not=()=>l.jsxs(wU,{children:[l.jsx(Mt,{index:!0,element:l.jsx(Hit,{})}),l.jsx(Mt,{path:"login",element:l.jsx(tot,{})}),l.jsx(Mt,{path:"language-selection",element:l.jsx(N1,{children:l.jsx(P_e,{})})}),l.jsxs(Mt,{path:"details",element:l.jsxs(N1,{children:[l.jsx(dE,{})," "]}),children:[l.jsx(Mt,{index:!0,element:l.jsx(Jo,{to:"instructions",replace:!0})}),l.jsx(Mt,{path:"instructions",element:l.jsx(L_e,{})}),l.jsx(Mt,{path:"registration",element:l.jsx(zit,{})})]}),l.jsxs(Mt,{path:"test",element:l.jsx(N1,{children:l.jsx(dE,{})}),children:[l.jsx(Mt,{index:!0,element:l.jsx(Jo,{to:"start",replace:!0})}),l.jsx(Mt,{path:"start",element:l.jsx(qit,{})}),l.jsx(Mt,{path:"section",element:l.jsx(Kit,{})}),l.jsx(Mt,{path:"result",element:l.jsx(Yit,{})})]}),l.jsx(Mt,{path:"final-result",element:l.jsx(N1,{children:l.jsx(eot,{})})}),l.jsx(Mt,{path:"slot-booking/:id",element:l.jsx(Wit,{})}),l.jsx(Mt,{path:"offer-letter",element:l.jsx(rot,{})}),l.jsx(Mt,{path:"whatsapp-redirect",element:l.jsx(Vit,{})}),l.jsx(Mt,{path:"*",element:l.jsx(Jo,{to:".",replace:!0})})]}),aot=new Vhe,sot=()=>l.jsx(Uit,{children:l.jsx(Bit,{children:l.jsx(Qhe,{client:aot,children:l.jsxs(cm,{children:[l.jsx(dce,{}),l.jsx(Wce,{}),l.jsx(__e,{children:l.jsxs(wU,{children:[l.jsx(Mt,{path:"/auth",element:l.jsx(Jo,{to:"/students/login",replace:!0})}),l.jsx(Mt,{path:"/",element:l.jsx(En,{children:l.jsx($9,{})})}),l.jsx(Mt,{path:"/applicants",element:l.jsx(En,{children:l.jsx(r_e,{})})}),l.jsx(Mt,{path:"/interviews",element:l.jsx(En,{children:l.jsx(J9,{})})}),l.jsx(Mt,{path:"/schedule",element:l.jsx(En,{children:l.jsx(l_e,{})})}),l.jsx(Mt,{path:"/sourcing",element:l.jsx(En,{children:l.jsx(u_e,{})})}),l.jsx(Mt,{path:"/screening",element:l.jsx(En,{children:l.jsx(c_e,{})})}),l.jsx(Mt,{path:"/interview-rounds",element:l.jsx(En,{children:l.jsx(d_e,{})})}),l.jsx(Mt,{path:"/decisions",element:l.jsx(En,{children:l.jsx(h_e,{})})}),l.jsx(Mt,{path:"/partners",element:l.jsx(En,{children:l.jsx(K9,{})})}),l.jsx(Mt,{path:"/partners/:id/students",element:l.jsx(En,{children:l.jsx(k_e,{})})}),l.jsx(Mt,{path:"/admin",element:l.jsx(En,{children:l.jsx(WV,{})})}),l.jsx(Mt,{path:"/admin-view",element:l.jsx(En,{children:l.jsx(jG,{})})}),l.jsx(Mt,{path:"/owner",element:l.jsx(En,{children:l.jsx($_e,{})})}),l.jsx(Mt,{path:"/donor",element:l.jsx(En,{children:l.jsx(R9,{})})}),l.jsx(Mt,{path:"/donors/:id/students",element:l.jsx(En,{children:l.jsx(C_e,{})})}),l.jsx(Mt,{path:"/offer-letters",element:l.jsx(En,{children:l.jsx(N_e,{})})}),l.jsx(Mt,{path:"/campus",element:l.jsx(En,{children:l.jsx(Q9,{})})}),l.jsx(Mt,{path:"/campus/:id",element:l.jsx(En,{children:l.jsx(E_e,{})})}),l.jsx(Mt,{path:"/school",element:l.jsx(En,{children:l.jsx(X9,{})})}),l.jsx(Mt,{path:"/school/:id",element:l.jsx(En,{children:l.jsx(T_e,{})})}),l.jsx(Mt,{path:"questions",element:l.jsx(En,{children:l.jsx(a7,{})})}),l.jsxs(Mt,{path:"/settings",element:l.jsx(En,{children:l.jsx(D_e,{})}),children:[l.jsx(Mt,{path:"user-role",element:l.jsx(Y3,{})}),l.jsx(Mt,{path:"caste",element:l.jsx(M_e,{})}),l.jsx(Mt,{path:"religion",element:l.jsx(F_e,{})}),l.jsx(Mt,{path:"qualification",element:l.jsx(O_e,{})}),l.jsx(Mt,{index:!0,element:l.jsx(Y3,{})})]}),l.jsx(Mt,{path:"/students/*",element:l.jsx(not,{})}),l.jsx(Mt,{path:"*",element:l.jsx(ope,{})})]})})]})})})});cU(document.getElementById("root")).render(l.jsx(qe.StrictMode,{children:l.jsx(Bie,{basename:"/Admission-Dashboard/",children:l.jsx(z_e,{children:l.jsx(sot,{})})})}));
